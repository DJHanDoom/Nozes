(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Vv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var um={exports:{}},Ul={},cm={exports:{}},Me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ho=Symbol.for("react.element"),Gv=Symbol.for("react.portal"),Hv=Symbol.for("react.fragment"),zv=Symbol.for("react.strict_mode"),Wv=Symbol.for("react.profiler"),qv=Symbol.for("react.provider"),$v=Symbol.for("react.context"),Jv=Symbol.for("react.forward_ref"),Kv=Symbol.for("react.suspense"),Yv=Symbol.for("react.memo"),jv=Symbol.for("react.lazy"),Dd=Symbol.iterator;function Xv(e){return e===null||typeof e!="object"?null:(e=Dd&&e[Dd]||e["@@iterator"],typeof e=="function"?e:null)}var fm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dm=Object.assign,hm={};function ms(e,t,n){this.props=e,this.context=t,this.refs=hm,this.updater=n||fm}ms.prototype.isReactComponent={};ms.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ms.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function pm(){}pm.prototype=ms.prototype;function ff(e,t,n){this.props=e,this.context=t,this.refs=hm,this.updater=n||fm}var df=ff.prototype=new pm;df.constructor=ff;dm(df,ms.prototype);df.isPureReactComponent=!0;var Ld=Array.isArray,mm=Object.prototype.hasOwnProperty,hf={current:null},gm={key:!0,ref:!0,__self:!0,__source:!0};function xm(e,t,n){var r,i={},s=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)mm.call(t,r)&&!gm.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Ho,type:e,key:s,ref:o,props:i,_owner:hf.current}}function Qv(e,t){return{$$typeof:Ho,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function pf(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ho}function Zv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var bd=/\/+/g;function pu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Zv(""+e.key):t.toString(36)}function Fa(e,t,n,r,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Ho:case Gv:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+pu(o,0):r,Ld(i)?(n="",e!=null&&(n=e.replace(bd,"$&/")+"/"),Fa(i,t,n,"",function(u){return u})):i!=null&&(pf(i)&&(i=Qv(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(bd,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",Ld(e))for(var a=0;a<e.length;a++){s=e[a];var l=r+pu(s,a);o+=Fa(s,t,n,l,i)}else if(l=Xv(e),typeof l=="function")for(e=l.call(e),a=0;!(s=e.next()).done;)s=s.value,l=r+pu(s,a++),o+=Fa(s,t,n,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function sa(e,t,n){if(e==null)return e;var r=[],i=0;return Fa(e,r,"","",function(s){return t.call(n,s,i++)}),r}function ey(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Kt={current:null},Ma={transition:null},ty={ReactCurrentDispatcher:Kt,ReactCurrentBatchConfig:Ma,ReactCurrentOwner:hf};function vm(){throw Error("act(...) is not supported in production builds of React.")}Me.Children={map:sa,forEach:function(e,t,n){sa(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return sa(e,function(){t++}),t},toArray:function(e){return sa(e,function(t){return t})||[]},only:function(e){if(!pf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Me.Component=ms;Me.Fragment=Hv;Me.Profiler=Wv;Me.PureComponent=ff;Me.StrictMode=zv;Me.Suspense=Kv;Me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ty;Me.act=vm;Me.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=dm({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=hf.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)mm.call(t,l)&&!gm.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Ho,type:e.type,key:i,ref:s,props:r,_owner:o}};Me.createContext=function(e){return e={$$typeof:$v,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:qv,_context:e},e.Consumer=e};Me.createElement=xm;Me.createFactory=function(e){var t=xm.bind(null,e);return t.type=e,t};Me.createRef=function(){return{current:null}};Me.forwardRef=function(e){return{$$typeof:Jv,render:e}};Me.isValidElement=pf;Me.lazy=function(e){return{$$typeof:jv,_payload:{_status:-1,_result:e},_init:ey}};Me.memo=function(e,t){return{$$typeof:Yv,type:e,compare:t===void 0?null:t}};Me.startTransition=function(e){var t=Ma.transition;Ma.transition={};try{e()}finally{Ma.transition=t}};Me.unstable_act=vm;Me.useCallback=function(e,t){return Kt.current.useCallback(e,t)};Me.useContext=function(e){return Kt.current.useContext(e)};Me.useDebugValue=function(){};Me.useDeferredValue=function(e){return Kt.current.useDeferredValue(e)};Me.useEffect=function(e,t){return Kt.current.useEffect(e,t)};Me.useId=function(){return Kt.current.useId()};Me.useImperativeHandle=function(e,t,n){return Kt.current.useImperativeHandle(e,t,n)};Me.useInsertionEffect=function(e,t){return Kt.current.useInsertionEffect(e,t)};Me.useLayoutEffect=function(e,t){return Kt.current.useLayoutEffect(e,t)};Me.useMemo=function(e,t){return Kt.current.useMemo(e,t)};Me.useReducer=function(e,t,n){return Kt.current.useReducer(e,t,n)};Me.useRef=function(e){return Kt.current.useRef(e)};Me.useState=function(e){return Kt.current.useState(e)};Me.useSyncExternalStore=function(e,t,n){return Kt.current.useSyncExternalStore(e,t,n)};Me.useTransition=function(){return Kt.current.useTransition()};Me.version="18.3.1";cm.exports=Me;var Ae=cm.exports;const ym=Vv(Ae);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ny=Ae,ry=Symbol.for("react.element"),iy=Symbol.for("react.fragment"),sy=Object.prototype.hasOwnProperty,oy=ny.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ay={key:!0,ref:!0,__self:!0,__source:!0};function Em(e,t,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)sy.call(t,r)&&!ay.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:ry,type:e,key:s,ref:o,props:i,_owner:oy.current}}Ul.Fragment=iy;Ul.jsx=Em;Ul.jsxs=Em;um.exports=Ul;var p=um.exports,ec={},Tm={exports:{}},mn={},_m={exports:{}},Sm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ee,ve){var Se=ee.length;ee.push(ve);e:for(;0<Se;){var Fe=Se-1>>>1,F=ee[Fe];if(0<i(F,ve))ee[Fe]=ve,ee[Se]=F,Se=Fe;else break e}}function n(ee){return ee.length===0?null:ee[0]}function r(ee){if(ee.length===0)return null;var ve=ee[0],Se=ee.pop();if(Se!==ve){ee[0]=Se;e:for(var Fe=0,F=ee.length,H=F>>>1;Fe<H;){var B=2*(Fe+1)-1,O=ee[B],Q=B+1,pe=ee[Q];if(0>i(O,Se))Q<F&&0>i(pe,O)?(ee[Fe]=pe,ee[Q]=Se,Fe=Q):(ee[Fe]=O,ee[B]=Se,Fe=B);else if(Q<F&&0>i(pe,Se))ee[Fe]=pe,ee[Q]=Se,Fe=Q;else break e}}return ve}function i(ee,ve){var Se=ee.sortIndex-ve.sortIndex;return Se!==0?Se:ee.id-ve.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,m=null,h=3,g=!1,v=!1,x=!1,_=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(ee){for(var ve=n(u);ve!==null;){if(ve.callback===null)r(u);else if(ve.startTime<=ee)r(u),ve.sortIndex=ve.expirationTime,t(l,ve);else break;ve=n(u)}}function A(ee){if(x=!1,E(ee),!v)if(n(l)!==null)v=!0,_e(b);else{var ve=n(u);ve!==null&&Ne(A,ve.startTime-ee)}}function b(ee,ve){v=!1,x&&(x=!1,T(L),L=-1),g=!0;var Se=h;try{for(E(ve),m=n(l);m!==null&&(!(m.expirationTime>ve)||ee&&!W());){var Fe=m.callback;if(typeof Fe=="function"){m.callback=null,h=m.priorityLevel;var F=Fe(m.expirationTime<=ve);ve=e.unstable_now(),typeof F=="function"?m.callback=F:m===n(l)&&r(l),E(ve)}else r(l);m=n(l)}if(m!==null)var H=!0;else{var B=n(u);B!==null&&Ne(A,B.startTime-ve),H=!1}return H}finally{m=null,h=Se,g=!1}}var D=!1,C=null,L=-1,P=5,U=-1;function W(){return!(e.unstable_now()-U<P)}function V(){if(C!==null){var ee=e.unstable_now();U=ee;var ve=!0;try{ve=C(!0,ee)}finally{ve?Y():(D=!1,C=null)}}else D=!1}var Y;if(typeof y=="function")Y=function(){y(V)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,ue=le.port2;le.port1.onmessage=V,Y=function(){ue.postMessage(null)}}else Y=function(){_(V,0)};function _e(ee){C=ee,D||(D=!0,Y())}function Ne(ee,ve){L=_(function(){ee(e.unstable_now())},ve)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_continueExecution=function(){v||g||(v=!0,_e(b))},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(ee){switch(h){case 1:case 2:case 3:var ve=3;break;default:ve=h}var Se=h;h=ve;try{return ee()}finally{h=Se}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ee,ve){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var Se=h;h=ee;try{return ve()}finally{h=Se}},e.unstable_scheduleCallback=function(ee,ve,Se){var Fe=e.unstable_now();switch(typeof Se=="object"&&Se!==null?(Se=Se.delay,Se=typeof Se=="number"&&0<Se?Fe+Se:Fe):Se=Fe,ee){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=Se+F,ee={id:d++,callback:ve,priorityLevel:ee,startTime:Se,expirationTime:F,sortIndex:-1},Se>Fe?(ee.sortIndex=Se,t(u,ee),n(l)===null&&ee===n(u)&&(x?(T(L),L=-1):x=!0,Ne(A,Se-Fe))):(ee.sortIndex=F,t(l,ee),v||g||(v=!0,_e(b))),ee},e.unstable_shouldYield=W,e.unstable_wrapCallback=function(ee){var ve=h;return function(){var Se=h;h=ve;try{return ee.apply(this,arguments)}finally{h=Se}}}})(Sm);_m.exports=Sm;var ly=_m.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uy=Ae,hn=ly;function re(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wm=new Set,vo={};function gi(e,t){as(e,t),as(e+"Capture",t)}function as(e,t){for(vo[e]=t,e=0;e<t.length;e++)wm.add(t[e])}var fr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tc=Object.prototype.hasOwnProperty,cy=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ud={},Od={};function fy(e){return tc.call(Od,e)?!0:tc.call(Ud,e)?!1:cy.test(e)?Od[e]=!0:(Ud[e]=!0,!1)}function dy(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function hy(e,t,n,r){if(t===null||typeof t>"u"||dy(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Yt(e,t,n,r,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var Ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ft[e]=new Yt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ft[t]=new Yt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ft[e]=new Yt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ft[e]=new Yt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ft[e]=new Yt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ft[e]=new Yt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ft[e]=new Yt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ft[e]=new Yt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ft[e]=new Yt(e,5,!1,e.toLowerCase(),null,!1,!1)});var mf=/[\-:]([a-z])/g;function gf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(mf,gf);Ft[t]=new Yt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(mf,gf);Ft[t]=new Yt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(mf,gf);Ft[t]=new Yt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ft[e]=new Yt(e,1,!1,e.toLowerCase(),null,!1,!1)});Ft.xlinkHref=new Yt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ft[e]=new Yt(e,1,!1,e.toLowerCase(),null,!0,!0)});function xf(e,t,n,r){var i=Ft.hasOwnProperty(t)?Ft[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(hy(t,n,i,r)&&(n=null),r||i===null?fy(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var vr=uy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,oa=Symbol.for("react.element"),Fi=Symbol.for("react.portal"),Mi=Symbol.for("react.fragment"),vf=Symbol.for("react.strict_mode"),nc=Symbol.for("react.profiler"),Cm=Symbol.for("react.provider"),Am=Symbol.for("react.context"),yf=Symbol.for("react.forward_ref"),rc=Symbol.for("react.suspense"),ic=Symbol.for("react.suspense_list"),Ef=Symbol.for("react.memo"),Cr=Symbol.for("react.lazy"),Nm=Symbol.for("react.offscreen"),Bd=Symbol.iterator;function Us(e){return e===null||typeof e!="object"?null:(e=Bd&&e[Bd]||e["@@iterator"],typeof e=="function"?e:null)}var it=Object.assign,mu;function Ks(e){if(mu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);mu=t&&t[1]||""}return`
`+mu+e}var gu=!1;function xu(e,t){if(!e||gu)return"";gu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=a);break}}}finally{gu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Ks(e):""}function py(e){switch(e.tag){case 5:return Ks(e.type);case 16:return Ks("Lazy");case 13:return Ks("Suspense");case 19:return Ks("SuspenseList");case 0:case 2:case 15:return e=xu(e.type,!1),e;case 11:return e=xu(e.type.render,!1),e;case 1:return e=xu(e.type,!0),e;default:return""}}function sc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Mi:return"Fragment";case Fi:return"Portal";case nc:return"Profiler";case vf:return"StrictMode";case rc:return"Suspense";case ic:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Am:return(e.displayName||"Context")+".Consumer";case Cm:return(e._context.displayName||"Context")+".Provider";case yf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ef:return t=e.displayName||null,t!==null?t:sc(e.type)||"Memo";case Cr:t=e._payload,e=e._init;try{return sc(e(t))}catch{}}return null}function my(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sc(t);case 8:return t===vf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Gr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Im(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function gy(e){var t=Im(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function aa(e){e._valueTracker||(e._valueTracker=gy(e))}function km(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Im(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Ja(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function oc(e,t){var n=t.checked;return it({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Vd(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Gr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Rm(e,t){t=t.checked,t!=null&&xf(e,"checked",t,!1)}function ac(e,t){Rm(e,t);var n=Gr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?lc(e,t.type,n):t.hasOwnProperty("defaultValue")&&lc(e,t.type,Gr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Gd(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function lc(e,t,n){(t!=="number"||Ja(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ys=Array.isArray;function Ji(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Gr(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function uc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(re(91));return it({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Hd(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(re(92));if(Ys(n)){if(1<n.length)throw Error(re(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Gr(n)}}function Pm(e,t){var n=Gr(t.value),r=Gr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function zd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Fm(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Fm(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var la,Mm=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(la=la||document.createElement("div"),la.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=la.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function yo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Zs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xy=["Webkit","ms","Moz","O"];Object.keys(Zs).forEach(function(e){xy.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Zs[t]=Zs[e]})});function Dm(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Zs.hasOwnProperty(e)&&Zs[e]?(""+t).trim():t+"px"}function Lm(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Dm(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var vy=it({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fc(e,t){if(t){if(vy[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(re(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(re(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(re(61))}if(t.style!=null&&typeof t.style!="object")throw Error(re(62))}}function dc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hc=null;function Tf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var pc=null,Ki=null,Yi=null;function Wd(e){if(e=qo(e)){if(typeof pc!="function")throw Error(re(280));var t=e.stateNode;t&&(t=Hl(t),pc(e.stateNode,e.type,t))}}function bm(e){Ki?Yi?Yi.push(e):Yi=[e]:Ki=e}function Um(){if(Ki){var e=Ki,t=Yi;if(Yi=Ki=null,Wd(e),t)for(e=0;e<t.length;e++)Wd(t[e])}}function Om(e,t){return e(t)}function Bm(){}var vu=!1;function Vm(e,t,n){if(vu)return e(t,n);vu=!0;try{return Om(e,t,n)}finally{vu=!1,(Ki!==null||Yi!==null)&&(Bm(),Um())}}function Eo(e,t){var n=e.stateNode;if(n===null)return null;var r=Hl(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(re(231,t,typeof n));return n}var mc=!1;if(fr)try{var Os={};Object.defineProperty(Os,"passive",{get:function(){mc=!0}}),window.addEventListener("test",Os,Os),window.removeEventListener("test",Os,Os)}catch{mc=!1}function yy(e,t,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(d){this.onError(d)}}var eo=!1,Ka=null,Ya=!1,gc=null,Ey={onError:function(e){eo=!0,Ka=e}};function Ty(e,t,n,r,i,s,o,a,l){eo=!1,Ka=null,yy.apply(Ey,arguments)}function _y(e,t,n,r,i,s,o,a,l){if(Ty.apply(this,arguments),eo){if(eo){var u=Ka;eo=!1,Ka=null}else throw Error(re(198));Ya||(Ya=!0,gc=u)}}function xi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Gm(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function qd(e){if(xi(e)!==e)throw Error(re(188))}function Sy(e){var t=e.alternate;if(!t){if(t=xi(e),t===null)throw Error(re(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return qd(i),e;if(s===r)return qd(i),t;s=s.sibling}throw Error(re(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(re(189))}}if(n.alternate!==r)throw Error(re(190))}if(n.tag!==3)throw Error(re(188));return n.stateNode.current===n?e:t}function Hm(e){return e=Sy(e),e!==null?zm(e):null}function zm(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=zm(e);if(t!==null)return t;e=e.sibling}return null}var Wm=hn.unstable_scheduleCallback,$d=hn.unstable_cancelCallback,wy=hn.unstable_shouldYield,Cy=hn.unstable_requestPaint,dt=hn.unstable_now,Ay=hn.unstable_getCurrentPriorityLevel,_f=hn.unstable_ImmediatePriority,qm=hn.unstable_UserBlockingPriority,ja=hn.unstable_NormalPriority,Ny=hn.unstable_LowPriority,$m=hn.unstable_IdlePriority,Ol=null,Xn=null;function Iy(e){if(Xn&&typeof Xn.onCommitFiberRoot=="function")try{Xn.onCommitFiberRoot(Ol,e,void 0,(e.current.flags&128)===128)}catch{}}var Bn=Math.clz32?Math.clz32:Py,ky=Math.log,Ry=Math.LN2;function Py(e){return e>>>=0,e===0?32:31-(ky(e)/Ry|0)|0}var ua=64,ca=4194304;function js(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Xa(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=js(a):(s&=o,s!==0&&(r=js(s)))}else o=n&~i,o!==0?r=js(o):s!==0&&(r=js(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Bn(t),i=1<<n,r|=e[n],t&=~i;return r}function Fy(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function My(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Bn(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=Fy(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}function xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Jm(){var e=ua;return ua<<=1,!(ua&4194240)&&(ua=64),e}function yu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function zo(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Bn(t),e[t]=n}function Dy(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Bn(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}function Sf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Bn(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var ze=0;function Km(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ym,wf,jm,Xm,Qm,vc=!1,fa=[],Mr=null,Dr=null,Lr=null,To=new Map,_o=new Map,Nr=[],Ly="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Jd(e,t){switch(e){case"focusin":case"focusout":Mr=null;break;case"dragenter":case"dragleave":Dr=null;break;case"mouseover":case"mouseout":Lr=null;break;case"pointerover":case"pointerout":To.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":_o.delete(t.pointerId)}}function Bs(e,t,n,r,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},t!==null&&(t=qo(t),t!==null&&wf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function by(e,t,n,r,i){switch(t){case"focusin":return Mr=Bs(Mr,e,t,n,r,i),!0;case"dragenter":return Dr=Bs(Dr,e,t,n,r,i),!0;case"mouseover":return Lr=Bs(Lr,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return To.set(s,Bs(To.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,_o.set(s,Bs(_o.get(s)||null,e,t,n,r,i)),!0}return!1}function Zm(e){var t=ni(e.target);if(t!==null){var n=xi(t);if(n!==null){if(t=n.tag,t===13){if(t=Gm(n),t!==null){e.blockedOn=t,Qm(e.priority,function(){jm(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Da(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=yc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);hc=r,n.target.dispatchEvent(r),hc=null}else return t=qo(n),t!==null&&wf(t),e.blockedOn=n,!1;t.shift()}return!0}function Kd(e,t,n){Da(e)&&n.delete(t)}function Uy(){vc=!1,Mr!==null&&Da(Mr)&&(Mr=null),Dr!==null&&Da(Dr)&&(Dr=null),Lr!==null&&Da(Lr)&&(Lr=null),To.forEach(Kd),_o.forEach(Kd)}function Vs(e,t){e.blockedOn===t&&(e.blockedOn=null,vc||(vc=!0,hn.unstable_scheduleCallback(hn.unstable_NormalPriority,Uy)))}function So(e){function t(i){return Vs(i,e)}if(0<fa.length){Vs(fa[0],e);for(var n=1;n<fa.length;n++){var r=fa[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Mr!==null&&Vs(Mr,e),Dr!==null&&Vs(Dr,e),Lr!==null&&Vs(Lr,e),To.forEach(t),_o.forEach(t),n=0;n<Nr.length;n++)r=Nr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Nr.length&&(n=Nr[0],n.blockedOn===null);)Zm(n),n.blockedOn===null&&Nr.shift()}var ji=vr.ReactCurrentBatchConfig,Qa=!0;function Oy(e,t,n,r){var i=ze,s=ji.transition;ji.transition=null;try{ze=1,Cf(e,t,n,r)}finally{ze=i,ji.transition=s}}function By(e,t,n,r){var i=ze,s=ji.transition;ji.transition=null;try{ze=4,Cf(e,t,n,r)}finally{ze=i,ji.transition=s}}function Cf(e,t,n,r){if(Qa){var i=yc(e,t,n,r);if(i===null)ku(e,t,r,Za,n),Jd(e,r);else if(by(i,e,t,n,r))r.stopPropagation();else if(Jd(e,r),t&4&&-1<Ly.indexOf(e)){for(;i!==null;){var s=qo(i);if(s!==null&&Ym(s),s=yc(e,t,n,r),s===null&&ku(e,t,r,Za,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else ku(e,t,r,null,n)}}var Za=null;function yc(e,t,n,r){if(Za=null,e=Tf(r),e=ni(e),e!==null)if(t=xi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Gm(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Za=e,null}function eg(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ay()){case _f:return 1;case qm:return 4;case ja:case Ny:return 16;case $m:return 536870912;default:return 16}default:return 16}}var kr=null,Af=null,La=null;function tg(){if(La)return La;var e,t=Af,n=t.length,r,i="value"in kr?kr.value:kr.textContent,s=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[s-r];r++);return La=i.slice(e,1<r?1-r:void 0)}function ba(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function da(){return!0}function Yd(){return!1}function gn(e){function t(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?da:Yd,this.isPropagationStopped=Yd,this}return it(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=da)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=da)},persist:function(){},isPersistent:da}),t}var gs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nf=gn(gs),Wo=it({},gs,{view:0,detail:0}),Vy=gn(Wo),Eu,Tu,Gs,Bl=it({},Wo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:If,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Gs&&(Gs&&e.type==="mousemove"?(Eu=e.screenX-Gs.screenX,Tu=e.screenY-Gs.screenY):Tu=Eu=0,Gs=e),Eu)},movementY:function(e){return"movementY"in e?e.movementY:Tu}}),jd=gn(Bl),Gy=it({},Bl,{dataTransfer:0}),Hy=gn(Gy),zy=it({},Wo,{relatedTarget:0}),_u=gn(zy),Wy=it({},gs,{animationName:0,elapsedTime:0,pseudoElement:0}),qy=gn(Wy),$y=it({},gs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jy=gn($y),Ky=it({},gs,{data:0}),Xd=gn(Ky),Yy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qy(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Xy[e])?!!t[e]:!1}function If(){return Qy}var Zy=it({},Wo,{key:function(e){if(e.key){var t=Yy[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ba(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?jy[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:If,charCode:function(e){return e.type==="keypress"?ba(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ba(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),e2=gn(Zy),t2=it({},Bl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qd=gn(t2),n2=it({},Wo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:If}),r2=gn(n2),i2=it({},gs,{propertyName:0,elapsedTime:0,pseudoElement:0}),s2=gn(i2),o2=it({},Bl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),a2=gn(o2),l2=[9,13,27,32],kf=fr&&"CompositionEvent"in window,to=null;fr&&"documentMode"in document&&(to=document.documentMode);var u2=fr&&"TextEvent"in window&&!to,ng=fr&&(!kf||to&&8<to&&11>=to),Zd=" ",e0=!1;function rg(e,t){switch(e){case"keyup":return l2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ig(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Di=!1;function c2(e,t){switch(e){case"compositionend":return ig(t);case"keypress":return t.which!==32?null:(e0=!0,Zd);case"textInput":return e=t.data,e===Zd&&e0?null:e;default:return null}}function f2(e,t){if(Di)return e==="compositionend"||!kf&&rg(e,t)?(e=tg(),La=Af=kr=null,Di=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ng&&t.locale!=="ko"?null:t.data;default:return null}}var d2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function t0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!d2[e.type]:t==="textarea"}function sg(e,t,n,r){bm(r),t=el(t,"onChange"),0<t.length&&(n=new Nf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var no=null,wo=null;function h2(e){gg(e,0)}function Vl(e){var t=Ui(e);if(km(t))return e}function p2(e,t){if(e==="change")return t}var og=!1;if(fr){var Su;if(fr){var wu="oninput"in document;if(!wu){var n0=document.createElement("div");n0.setAttribute("oninput","return;"),wu=typeof n0.oninput=="function"}Su=wu}else Su=!1;og=Su&&(!document.documentMode||9<document.documentMode)}function r0(){no&&(no.detachEvent("onpropertychange",ag),wo=no=null)}function ag(e){if(e.propertyName==="value"&&Vl(wo)){var t=[];sg(t,wo,e,Tf(e)),Vm(h2,t)}}function m2(e,t,n){e==="focusin"?(r0(),no=t,wo=n,no.attachEvent("onpropertychange",ag)):e==="focusout"&&r0()}function g2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Vl(wo)}function x2(e,t){if(e==="click")return Vl(t)}function v2(e,t){if(e==="input"||e==="change")return Vl(t)}function y2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Hn=typeof Object.is=="function"?Object.is:y2;function Co(e,t){if(Hn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!tc.call(t,i)||!Hn(e[i],t[i]))return!1}return!0}function i0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function s0(e,t){var n=i0(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=i0(n)}}function lg(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?lg(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ug(){for(var e=window,t=Ja();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ja(e.document)}return t}function Rf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function E2(e){var t=ug(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&lg(n.ownerDocument.documentElement,n)){if(r!==null&&Rf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=s0(n,s);var o=s0(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var T2=fr&&"documentMode"in document&&11>=document.documentMode,Li=null,Ec=null,ro=null,Tc=!1;function o0(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Tc||Li==null||Li!==Ja(r)||(r=Li,"selectionStart"in r&&Rf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ro&&Co(ro,r)||(ro=r,r=el(Ec,"onSelect"),0<r.length&&(t=new Nf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Li)))}function ha(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var bi={animationend:ha("Animation","AnimationEnd"),animationiteration:ha("Animation","AnimationIteration"),animationstart:ha("Animation","AnimationStart"),transitionend:ha("Transition","TransitionEnd")},Cu={},cg={};fr&&(cg=document.createElement("div").style,"AnimationEvent"in window||(delete bi.animationend.animation,delete bi.animationiteration.animation,delete bi.animationstart.animation),"TransitionEvent"in window||delete bi.transitionend.transition);function Gl(e){if(Cu[e])return Cu[e];if(!bi[e])return e;var t=bi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in cg)return Cu[e]=t[n];return e}var fg=Gl("animationend"),dg=Gl("animationiteration"),hg=Gl("animationstart"),pg=Gl("transitionend"),mg=new Map,a0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $r(e,t){mg.set(e,t),gi(t,[e])}for(var Au=0;Au<a0.length;Au++){var Nu=a0[Au],_2=Nu.toLowerCase(),S2=Nu[0].toUpperCase()+Nu.slice(1);$r(_2,"on"+S2)}$r(fg,"onAnimationEnd");$r(dg,"onAnimationIteration");$r(hg,"onAnimationStart");$r("dblclick","onDoubleClick");$r("focusin","onFocus");$r("focusout","onBlur");$r(pg,"onTransitionEnd");as("onMouseEnter",["mouseout","mouseover"]);as("onMouseLeave",["mouseout","mouseover"]);as("onPointerEnter",["pointerout","pointerover"]);as("onPointerLeave",["pointerout","pointerover"]);gi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gi("onBeforeInput",["compositionend","keypress","textInput","paste"]);gi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),w2=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xs));function l0(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,_y(r,t,void 0,e),e.currentTarget=null}function gg(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;l0(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;l0(i,a,u),s=l}}}if(Ya)throw e=gc,Ya=!1,gc=null,e}function Ye(e,t){var n=t[Ac];n===void 0&&(n=t[Ac]=new Set);var r=e+"__bubble";n.has(r)||(xg(t,e,2,!1),n.add(r))}function Iu(e,t,n){var r=0;t&&(r|=4),xg(n,e,r,t)}var pa="_reactListening"+Math.random().toString(36).slice(2);function Ao(e){if(!e[pa]){e[pa]=!0,wm.forEach(function(n){n!=="selectionchange"&&(w2.has(n)||Iu(n,!1,e),Iu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[pa]||(t[pa]=!0,Iu("selectionchange",!1,t))}}function xg(e,t,n,r){switch(eg(t)){case 1:var i=Oy;break;case 4:i=By;break;default:i=Cf}n=i.bind(null,t,n,e),i=void 0,!mc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function ku(e,t,n,r,i){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=ni(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}Vm(function(){var u=s,d=Tf(n),m=[];e:{var h=mg.get(e);if(h!==void 0){var g=Nf,v=e;switch(e){case"keypress":if(ba(n)===0)break e;case"keydown":case"keyup":g=e2;break;case"focusin":v="focus",g=_u;break;case"focusout":v="blur",g=_u;break;case"beforeblur":case"afterblur":g=_u;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=jd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Hy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=r2;break;case fg:case dg:case hg:g=qy;break;case pg:g=s2;break;case"scroll":g=Vy;break;case"wheel":g=a2;break;case"copy":case"cut":case"paste":g=Jy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Qd}var x=(t&4)!==0,_=!x&&e==="scroll",T=x?h!==null?h+"Capture":null:h;x=[];for(var y=u,E;y!==null;){E=y;var A=E.stateNode;if(E.tag===5&&A!==null&&(E=A,T!==null&&(A=Eo(y,T),A!=null&&x.push(No(y,A,E)))),_)break;y=y.return}0<x.length&&(h=new g(h,v,null,n,d),m.push({event:h,listeners:x}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",h&&n!==hc&&(v=n.relatedTarget||n.fromElement)&&(ni(v)||v[dr]))break e;if((g||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,g?(v=n.relatedTarget||n.toElement,g=u,v=v?ni(v):null,v!==null&&(_=xi(v),v!==_||v.tag!==5&&v.tag!==6)&&(v=null)):(g=null,v=u),g!==v)){if(x=jd,A="onMouseLeave",T="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(x=Qd,A="onPointerLeave",T="onPointerEnter",y="pointer"),_=g==null?h:Ui(g),E=v==null?h:Ui(v),h=new x(A,y+"leave",g,n,d),h.target=_,h.relatedTarget=E,A=null,ni(d)===u&&(x=new x(T,y+"enter",v,n,d),x.target=E,x.relatedTarget=_,A=x),_=A,g&&v)t:{for(x=g,T=v,y=0,E=x;E;E=Ai(E))y++;for(E=0,A=T;A;A=Ai(A))E++;for(;0<y-E;)x=Ai(x),y--;for(;0<E-y;)T=Ai(T),E--;for(;y--;){if(x===T||T!==null&&x===T.alternate)break t;x=Ai(x),T=Ai(T)}x=null}else x=null;g!==null&&u0(m,h,g,x,!1),v!==null&&_!==null&&u0(m,_,v,x,!0)}}e:{if(h=u?Ui(u):window,g=h.nodeName&&h.nodeName.toLowerCase(),g==="select"||g==="input"&&h.type==="file")var b=p2;else if(t0(h))if(og)b=v2;else{b=g2;var D=m2}else(g=h.nodeName)&&g.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(b=x2);if(b&&(b=b(e,u))){sg(m,b,n,d);break e}D&&D(e,h,u),e==="focusout"&&(D=h._wrapperState)&&D.controlled&&h.type==="number"&&lc(h,"number",h.value)}switch(D=u?Ui(u):window,e){case"focusin":(t0(D)||D.contentEditable==="true")&&(Li=D,Ec=u,ro=null);break;case"focusout":ro=Ec=Li=null;break;case"mousedown":Tc=!0;break;case"contextmenu":case"mouseup":case"dragend":Tc=!1,o0(m,n,d);break;case"selectionchange":if(T2)break;case"keydown":case"keyup":o0(m,n,d)}var C;if(kf)e:{switch(e){case"compositionstart":var L="onCompositionStart";break e;case"compositionend":L="onCompositionEnd";break e;case"compositionupdate":L="onCompositionUpdate";break e}L=void 0}else Di?rg(e,n)&&(L="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(L="onCompositionStart");L&&(ng&&n.locale!=="ko"&&(Di||L!=="onCompositionStart"?L==="onCompositionEnd"&&Di&&(C=tg()):(kr=d,Af="value"in kr?kr.value:kr.textContent,Di=!0)),D=el(u,L),0<D.length&&(L=new Xd(L,e,null,n,d),m.push({event:L,listeners:D}),C?L.data=C:(C=ig(n),C!==null&&(L.data=C)))),(C=u2?c2(e,n):f2(e,n))&&(u=el(u,"onBeforeInput"),0<u.length&&(d=new Xd("onBeforeInput","beforeinput",null,n,d),m.push({event:d,listeners:u}),d.data=C))}gg(m,t)})}function No(e,t,n){return{instance:e,listener:t,currentTarget:n}}function el(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Eo(e,n),s!=null&&r.unshift(No(e,s,i)),s=Eo(e,t),s!=null&&r.push(No(e,s,i))),e=e.return}return r}function Ai(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function u0(e,t,n,r,i){for(var s=t._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=Eo(n,s),l!=null&&o.unshift(No(n,l,a))):i||(l=Eo(n,s),l!=null&&o.push(No(n,l,a)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var C2=/\r\n?/g,A2=/\u0000|\uFFFD/g;function c0(e){return(typeof e=="string"?e:""+e).replace(C2,`
`).replace(A2,"")}function ma(e,t,n){if(t=c0(t),c0(e)!==t&&n)throw Error(re(425))}function tl(){}var _c=null,Sc=null;function wc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Cc=typeof setTimeout=="function"?setTimeout:void 0,N2=typeof clearTimeout=="function"?clearTimeout:void 0,f0=typeof Promise=="function"?Promise:void 0,I2=typeof queueMicrotask=="function"?queueMicrotask:typeof f0<"u"?function(e){return f0.resolve(null).then(e).catch(k2)}:Cc;function k2(e){setTimeout(function(){throw e})}function Ru(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),So(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);So(t)}function br(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function d0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var xs=Math.random().toString(36).slice(2),jn="__reactFiber$"+xs,Io="__reactProps$"+xs,dr="__reactContainer$"+xs,Ac="__reactEvents$"+xs,R2="__reactListeners$"+xs,P2="__reactHandles$"+xs;function ni(e){var t=e[jn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[dr]||n[jn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=d0(e);e!==null;){if(n=e[jn])return n;e=d0(e)}return t}e=n,n=e.parentNode}return null}function qo(e){return e=e[jn]||e[dr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ui(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(re(33))}function Hl(e){return e[Io]||null}var Nc=[],Oi=-1;function Jr(e){return{current:e}}function Xe(e){0>Oi||(e.current=Nc[Oi],Nc[Oi]=null,Oi--)}function Je(e,t){Oi++,Nc[Oi]=e.current,e.current=t}var Hr={},Gt=Jr(Hr),Qt=Jr(!1),li=Hr;function ls(e,t){var n=e.type.contextTypes;if(!n)return Hr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Zt(e){return e=e.childContextTypes,e!=null}function nl(){Xe(Qt),Xe(Gt)}function h0(e,t,n){if(Gt.current!==Hr)throw Error(re(168));Je(Gt,t),Je(Qt,n)}function vg(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(re(108,my(e)||"Unknown",i));return it({},n,r)}function rl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Hr,li=Gt.current,Je(Gt,e),Je(Qt,Qt.current),!0}function p0(e,t,n){var r=e.stateNode;if(!r)throw Error(re(169));n?(e=vg(e,t,li),r.__reactInternalMemoizedMergedChildContext=e,Xe(Qt),Xe(Gt),Je(Gt,e)):Xe(Qt),Je(Qt,n)}var ir=null,zl=!1,Pu=!1;function yg(e){ir===null?ir=[e]:ir.push(e)}function F2(e){zl=!0,yg(e)}function Kr(){if(!Pu&&ir!==null){Pu=!0;var e=0,t=ze;try{var n=ir;for(ze=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}ir=null,zl=!1}catch(i){throw ir!==null&&(ir=ir.slice(e+1)),Wm(_f,Kr),i}finally{ze=t,Pu=!1}}return null}var Bi=[],Vi=0,il=null,sl=0,_n=[],Sn=0,ui=null,sr=1,or="";function Zr(e,t){Bi[Vi++]=sl,Bi[Vi++]=il,il=e,sl=t}function Eg(e,t,n){_n[Sn++]=sr,_n[Sn++]=or,_n[Sn++]=ui,ui=e;var r=sr;e=or;var i=32-Bn(r)-1;r&=~(1<<i),n+=1;var s=32-Bn(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,sr=1<<32-Bn(t)+i|n<<i|r,or=s+e}else sr=1<<s|n<<i|r,or=e}function Pf(e){e.return!==null&&(Zr(e,1),Eg(e,1,0))}function Ff(e){for(;e===il;)il=Bi[--Vi],Bi[Vi]=null,sl=Bi[--Vi],Bi[Vi]=null;for(;e===ui;)ui=_n[--Sn],_n[Sn]=null,or=_n[--Sn],_n[Sn]=null,sr=_n[--Sn],_n[Sn]=null}var dn=null,fn=null,Ze=!1,bn=null;function Tg(e,t){var n=Cn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function m0(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,dn=e,fn=br(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,dn=e,fn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ui!==null?{id:sr,overflow:or}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Cn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,dn=e,fn=null,!0):!1;default:return!1}}function Ic(e){return(e.mode&1)!==0&&(e.flags&128)===0}function kc(e){if(Ze){var t=fn;if(t){var n=t;if(!m0(e,t)){if(Ic(e))throw Error(re(418));t=br(n.nextSibling);var r=dn;t&&m0(e,t)?Tg(r,n):(e.flags=e.flags&-4097|2,Ze=!1,dn=e)}}else{if(Ic(e))throw Error(re(418));e.flags=e.flags&-4097|2,Ze=!1,dn=e}}}function g0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;dn=e}function ga(e){if(e!==dn)return!1;if(!Ze)return g0(e),Ze=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!wc(e.type,e.memoizedProps)),t&&(t=fn)){if(Ic(e))throw _g(),Error(re(418));for(;t;)Tg(e,t),t=br(t.nextSibling)}if(g0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(re(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){fn=br(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}fn=null}}else fn=dn?br(e.stateNode.nextSibling):null;return!0}function _g(){for(var e=fn;e;)e=br(e.nextSibling)}function us(){fn=dn=null,Ze=!1}function Mf(e){bn===null?bn=[e]:bn.push(e)}var M2=vr.ReactCurrentBatchConfig;function Hs(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(re(309));var r=n.stateNode}if(!r)throw Error(re(147,e));var i=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(re(284));if(!n._owner)throw Error(re(290,e))}return e}function xa(e,t){throw e=Object.prototype.toString.call(t),Error(re(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function x0(e){var t=e._init;return t(e._payload)}function Sg(e){function t(T,y){if(e){var E=T.deletions;E===null?(T.deletions=[y],T.flags|=16):E.push(y)}}function n(T,y){if(!e)return null;for(;y!==null;)t(T,y),y=y.sibling;return null}function r(T,y){for(T=new Map;y!==null;)y.key!==null?T.set(y.key,y):T.set(y.index,y),y=y.sibling;return T}function i(T,y){return T=Vr(T,y),T.index=0,T.sibling=null,T}function s(T,y,E){return T.index=E,e?(E=T.alternate,E!==null?(E=E.index,E<y?(T.flags|=2,y):E):(T.flags|=2,y)):(T.flags|=1048576,y)}function o(T){return e&&T.alternate===null&&(T.flags|=2),T}function a(T,y,E,A){return y===null||y.tag!==6?(y=Ou(E,T.mode,A),y.return=T,y):(y=i(y,E),y.return=T,y)}function l(T,y,E,A){var b=E.type;return b===Mi?d(T,y,E.props.children,A,E.key):y!==null&&(y.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Cr&&x0(b)===y.type)?(A=i(y,E.props),A.ref=Hs(T,y,E),A.return=T,A):(A=za(E.type,E.key,E.props,null,T.mode,A),A.ref=Hs(T,y,E),A.return=T,A)}function u(T,y,E,A){return y===null||y.tag!==4||y.stateNode.containerInfo!==E.containerInfo||y.stateNode.implementation!==E.implementation?(y=Bu(E,T.mode,A),y.return=T,y):(y=i(y,E.children||[]),y.return=T,y)}function d(T,y,E,A,b){return y===null||y.tag!==7?(y=oi(E,T.mode,A,b),y.return=T,y):(y=i(y,E),y.return=T,y)}function m(T,y,E){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Ou(""+y,T.mode,E),y.return=T,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case oa:return E=za(y.type,y.key,y.props,null,T.mode,E),E.ref=Hs(T,null,y),E.return=T,E;case Fi:return y=Bu(y,T.mode,E),y.return=T,y;case Cr:var A=y._init;return m(T,A(y._payload),E)}if(Ys(y)||Us(y))return y=oi(y,T.mode,E,null),y.return=T,y;xa(T,y)}return null}function h(T,y,E,A){var b=y!==null?y.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return b!==null?null:a(T,y,""+E,A);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case oa:return E.key===b?l(T,y,E,A):null;case Fi:return E.key===b?u(T,y,E,A):null;case Cr:return b=E._init,h(T,y,b(E._payload),A)}if(Ys(E)||Us(E))return b!==null?null:d(T,y,E,A,null);xa(T,E)}return null}function g(T,y,E,A,b){if(typeof A=="string"&&A!==""||typeof A=="number")return T=T.get(E)||null,a(y,T,""+A,b);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case oa:return T=T.get(A.key===null?E:A.key)||null,l(y,T,A,b);case Fi:return T=T.get(A.key===null?E:A.key)||null,u(y,T,A,b);case Cr:var D=A._init;return g(T,y,E,D(A._payload),b)}if(Ys(A)||Us(A))return T=T.get(E)||null,d(y,T,A,b,null);xa(y,A)}return null}function v(T,y,E,A){for(var b=null,D=null,C=y,L=y=0,P=null;C!==null&&L<E.length;L++){C.index>L?(P=C,C=null):P=C.sibling;var U=h(T,C,E[L],A);if(U===null){C===null&&(C=P);break}e&&C&&U.alternate===null&&t(T,C),y=s(U,y,L),D===null?b=U:D.sibling=U,D=U,C=P}if(L===E.length)return n(T,C),Ze&&Zr(T,L),b;if(C===null){for(;L<E.length;L++)C=m(T,E[L],A),C!==null&&(y=s(C,y,L),D===null?b=C:D.sibling=C,D=C);return Ze&&Zr(T,L),b}for(C=r(T,C);L<E.length;L++)P=g(C,T,L,E[L],A),P!==null&&(e&&P.alternate!==null&&C.delete(P.key===null?L:P.key),y=s(P,y,L),D===null?b=P:D.sibling=P,D=P);return e&&C.forEach(function(W){return t(T,W)}),Ze&&Zr(T,L),b}function x(T,y,E,A){var b=Us(E);if(typeof b!="function")throw Error(re(150));if(E=b.call(E),E==null)throw Error(re(151));for(var D=b=null,C=y,L=y=0,P=null,U=E.next();C!==null&&!U.done;L++,U=E.next()){C.index>L?(P=C,C=null):P=C.sibling;var W=h(T,C,U.value,A);if(W===null){C===null&&(C=P);break}e&&C&&W.alternate===null&&t(T,C),y=s(W,y,L),D===null?b=W:D.sibling=W,D=W,C=P}if(U.done)return n(T,C),Ze&&Zr(T,L),b;if(C===null){for(;!U.done;L++,U=E.next())U=m(T,U.value,A),U!==null&&(y=s(U,y,L),D===null?b=U:D.sibling=U,D=U);return Ze&&Zr(T,L),b}for(C=r(T,C);!U.done;L++,U=E.next())U=g(C,T,L,U.value,A),U!==null&&(e&&U.alternate!==null&&C.delete(U.key===null?L:U.key),y=s(U,y,L),D===null?b=U:D.sibling=U,D=U);return e&&C.forEach(function(V){return t(T,V)}),Ze&&Zr(T,L),b}function _(T,y,E,A){if(typeof E=="object"&&E!==null&&E.type===Mi&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case oa:e:{for(var b=E.key,D=y;D!==null;){if(D.key===b){if(b=E.type,b===Mi){if(D.tag===7){n(T,D.sibling),y=i(D,E.props.children),y.return=T,T=y;break e}}else if(D.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Cr&&x0(b)===D.type){n(T,D.sibling),y=i(D,E.props),y.ref=Hs(T,D,E),y.return=T,T=y;break e}n(T,D);break}else t(T,D);D=D.sibling}E.type===Mi?(y=oi(E.props.children,T.mode,A,E.key),y.return=T,T=y):(A=za(E.type,E.key,E.props,null,T.mode,A),A.ref=Hs(T,y,E),A.return=T,T=A)}return o(T);case Fi:e:{for(D=E.key;y!==null;){if(y.key===D)if(y.tag===4&&y.stateNode.containerInfo===E.containerInfo&&y.stateNode.implementation===E.implementation){n(T,y.sibling),y=i(y,E.children||[]),y.return=T,T=y;break e}else{n(T,y);break}else t(T,y);y=y.sibling}y=Bu(E,T.mode,A),y.return=T,T=y}return o(T);case Cr:return D=E._init,_(T,y,D(E._payload),A)}if(Ys(E))return v(T,y,E,A);if(Us(E))return x(T,y,E,A);xa(T,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,y!==null&&y.tag===6?(n(T,y.sibling),y=i(y,E),y.return=T,T=y):(n(T,y),y=Ou(E,T.mode,A),y.return=T,T=y),o(T)):n(T,y)}return _}var cs=Sg(!0),wg=Sg(!1),ol=Jr(null),al=null,Gi=null,Df=null;function Lf(){Df=Gi=al=null}function bf(e){var t=ol.current;Xe(ol),e._currentValue=t}function Rc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Xi(e,t){al=e,Df=Gi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Xt=!0),e.firstContext=null)}function In(e){var t=e._currentValue;if(Df!==e)if(e={context:e,memoizedValue:t,next:null},Gi===null){if(al===null)throw Error(re(308));Gi=e,al.dependencies={lanes:0,firstContext:e}}else Gi=Gi.next=e;return t}var ri=null;function Uf(e){ri===null?ri=[e]:ri.push(e)}function Cg(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Uf(t)):(n.next=i.next,i.next=n),t.interleaved=n,hr(e,r)}function hr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ar=!1;function Of(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ag(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ar(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ur(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,be&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,hr(e,n)}return i=r.interleaved,i===null?(t.next=t,Uf(r)):(t.next=i.next,i.next=t),r.interleaved=t,hr(e,n)}function Ua(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Sf(e,n)}}function v0(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=t:s=s.next=t}else i=s=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ll(e,t,n,r){var i=e.updateQueue;Ar=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var d=e.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(s!==null){var m=i.baseState;o=0,d=u=l=null,a=s;do{var h=a.lane,g=a.eventTime;if((r&h)===h){d!==null&&(d=d.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=e,x=a;switch(h=t,g=n,x.tag){case 1:if(v=x.payload,typeof v=="function"){m=v.call(g,m,h);break e}m=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,h=typeof v=="function"?v.call(g,m,h):v,h==null)break e;m=it({},m,h);break e;case 2:Ar=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else g={eventTime:g,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=g,l=m):d=d.next=g,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(l=m),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);fi|=o,e.lanes=o,e.memoizedState=m}}function y0(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(re(191,i));i.call(r)}}}var $o={},Qn=Jr($o),ko=Jr($o),Ro=Jr($o);function ii(e){if(e===$o)throw Error(re(174));return e}function Bf(e,t){switch(Je(Ro,t),Je(ko,e),Je(Qn,$o),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:cc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=cc(t,e)}Xe(Qn),Je(Qn,t)}function fs(){Xe(Qn),Xe(ko),Xe(Ro)}function Ng(e){ii(Ro.current);var t=ii(Qn.current),n=cc(t,e.type);t!==n&&(Je(ko,e),Je(Qn,n))}function Vf(e){ko.current===e&&(Xe(Qn),Xe(ko))}var nt=Jr(0);function ul(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Fu=[];function Gf(){for(var e=0;e<Fu.length;e++)Fu[e]._workInProgressVersionPrimary=null;Fu.length=0}var Oa=vr.ReactCurrentDispatcher,Mu=vr.ReactCurrentBatchConfig,ci=0,rt=null,vt=null,Et=null,cl=!1,io=!1,Po=0,D2=0;function Lt(){throw Error(re(321))}function Hf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Hn(e[n],t[n]))return!1;return!0}function zf(e,t,n,r,i,s){if(ci=s,rt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Oa.current=e===null||e.memoizedState===null?O2:B2,e=n(r,i),io){s=0;do{if(io=!1,Po=0,25<=s)throw Error(re(301));s+=1,Et=vt=null,t.updateQueue=null,Oa.current=V2,e=n(r,i)}while(io)}if(Oa.current=fl,t=vt!==null&&vt.next!==null,ci=0,Et=vt=rt=null,cl=!1,t)throw Error(re(300));return e}function Wf(){var e=Po!==0;return Po=0,e}function Yn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Et===null?rt.memoizedState=Et=e:Et=Et.next=e,Et}function kn(){if(vt===null){var e=rt.alternate;e=e!==null?e.memoizedState:null}else e=vt.next;var t=Et===null?rt.memoizedState:Et.next;if(t!==null)Et=t,vt=e;else{if(e===null)throw Error(re(310));vt=e,e={memoizedState:vt.memoizedState,baseState:vt.baseState,baseQueue:vt.baseQueue,queue:vt.queue,next:null},Et===null?rt.memoizedState=Et=e:Et=Et.next=e}return Et}function Fo(e,t){return typeof t=="function"?t(e):t}function Du(e){var t=kn(),n=t.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=e;var r=vt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var d=u.lane;if((ci&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var m={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=m,o=r):l=l.next=m,rt.lanes|=d,fi|=d}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Hn(r,t.memoizedState)||(Xt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do s=i.lane,rt.lanes|=s,fi|=s,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Lu(e){var t=kn(),n=t.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);Hn(s,t.memoizedState)||(Xt=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Ig(){}function kg(e,t){var n=rt,r=kn(),i=t(),s=!Hn(r.memoizedState,i);if(s&&(r.memoizedState=i,Xt=!0),r=r.queue,qf(Fg.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||Et!==null&&Et.memoizedState.tag&1){if(n.flags|=2048,Mo(9,Pg.bind(null,n,r,i,t),void 0,null),wt===null)throw Error(re(349));ci&30||Rg(n,t,i)}return i}function Rg(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=rt.updateQueue,t===null?(t={lastEffect:null,stores:null},rt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Pg(e,t,n,r){t.value=n,t.getSnapshot=r,Mg(t)&&Dg(e)}function Fg(e,t,n){return n(function(){Mg(t)&&Dg(e)})}function Mg(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Hn(e,n)}catch{return!0}}function Dg(e){var t=hr(e,1);t!==null&&Vn(t,e,1,-1)}function E0(e){var t=Yn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fo,lastRenderedState:e},t.queue=e,e=e.dispatch=U2.bind(null,rt,e),[t.memoizedState,e]}function Mo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=rt.updateQueue,t===null?(t={lastEffect:null,stores:null},rt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Lg(){return kn().memoizedState}function Ba(e,t,n,r){var i=Yn();rt.flags|=e,i.memoizedState=Mo(1|t,n,void 0,r===void 0?null:r)}function Wl(e,t,n,r){var i=kn();r=r===void 0?null:r;var s=void 0;if(vt!==null){var o=vt.memoizedState;if(s=o.destroy,r!==null&&Hf(r,o.deps)){i.memoizedState=Mo(t,n,s,r);return}}rt.flags|=e,i.memoizedState=Mo(1|t,n,s,r)}function T0(e,t){return Ba(8390656,8,e,t)}function qf(e,t){return Wl(2048,8,e,t)}function bg(e,t){return Wl(4,2,e,t)}function Ug(e,t){return Wl(4,4,e,t)}function Og(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Bg(e,t,n){return n=n!=null?n.concat([e]):null,Wl(4,4,Og.bind(null,t,e),n)}function $f(){}function Vg(e,t){var n=kn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Hf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Gg(e,t){var n=kn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Hf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Hg(e,t,n){return ci&21?(Hn(n,t)||(n=Jm(),rt.lanes|=n,fi|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Xt=!0),e.memoizedState=n)}function L2(e,t){var n=ze;ze=n!==0&&4>n?n:4,e(!0);var r=Mu.transition;Mu.transition={};try{e(!1),t()}finally{ze=n,Mu.transition=r}}function zg(){return kn().memoizedState}function b2(e,t,n){var r=Br(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Wg(e))qg(t,n);else if(n=Cg(e,t,n,r),n!==null){var i=$t();Vn(n,e,r,i),$g(n,t,r)}}function U2(e,t,n){var r=Br(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Wg(e))qg(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Hn(a,o)){var l=t.interleaved;l===null?(i.next=i,Uf(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}n=Cg(e,t,i,r),n!==null&&(i=$t(),Vn(n,e,r,i),$g(n,t,r))}}function Wg(e){var t=e.alternate;return e===rt||t!==null&&t===rt}function qg(e,t){io=cl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function $g(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Sf(e,n)}}var fl={readContext:In,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useInsertionEffect:Lt,useLayoutEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useMutableSource:Lt,useSyncExternalStore:Lt,useId:Lt,unstable_isNewReconciler:!1},O2={readContext:In,useCallback:function(e,t){return Yn().memoizedState=[e,t===void 0?null:t],e},useContext:In,useEffect:T0,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Ba(4194308,4,Og.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ba(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ba(4,2,e,t)},useMemo:function(e,t){var n=Yn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Yn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=b2.bind(null,rt,e),[r.memoizedState,e]},useRef:function(e){var t=Yn();return e={current:e},t.memoizedState=e},useState:E0,useDebugValue:$f,useDeferredValue:function(e){return Yn().memoizedState=e},useTransition:function(){var e=E0(!1),t=e[0];return e=L2.bind(null,e[1]),Yn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=rt,i=Yn();if(Ze){if(n===void 0)throw Error(re(407));n=n()}else{if(n=t(),wt===null)throw Error(re(349));ci&30||Rg(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,T0(Fg.bind(null,r,s,e),[e]),r.flags|=2048,Mo(9,Pg.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=Yn(),t=wt.identifierPrefix;if(Ze){var n=or,r=sr;n=(r&~(1<<32-Bn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Po++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=D2++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},B2={readContext:In,useCallback:Vg,useContext:In,useEffect:qf,useImperativeHandle:Bg,useInsertionEffect:bg,useLayoutEffect:Ug,useMemo:Gg,useReducer:Du,useRef:Lg,useState:function(){return Du(Fo)},useDebugValue:$f,useDeferredValue:function(e){var t=kn();return Hg(t,vt.memoizedState,e)},useTransition:function(){var e=Du(Fo)[0],t=kn().memoizedState;return[e,t]},useMutableSource:Ig,useSyncExternalStore:kg,useId:zg,unstable_isNewReconciler:!1},V2={readContext:In,useCallback:Vg,useContext:In,useEffect:qf,useImperativeHandle:Bg,useInsertionEffect:bg,useLayoutEffect:Ug,useMemo:Gg,useReducer:Lu,useRef:Lg,useState:function(){return Lu(Fo)},useDebugValue:$f,useDeferredValue:function(e){var t=kn();return vt===null?t.memoizedState=e:Hg(t,vt.memoizedState,e)},useTransition:function(){var e=Lu(Fo)[0],t=kn().memoizedState;return[e,t]},useMutableSource:Ig,useSyncExternalStore:kg,useId:zg,unstable_isNewReconciler:!1};function Dn(e,t){if(e&&e.defaultProps){t=it({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Pc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:it({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ql={isMounted:function(e){return(e=e._reactInternals)?xi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=$t(),i=Br(e),s=ar(r,i);s.payload=t,n!=null&&(s.callback=n),t=Ur(e,s,i),t!==null&&(Vn(t,e,i,r),Ua(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=$t(),i=Br(e),s=ar(r,i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=Ur(e,s,i),t!==null&&(Vn(t,e,i,r),Ua(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=$t(),r=Br(e),i=ar(n,r);i.tag=2,t!=null&&(i.callback=t),t=Ur(e,i,r),t!==null&&(Vn(t,e,r,n),Ua(t,e,r))}};function _0(e,t,n,r,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,o):t.prototype&&t.prototype.isPureReactComponent?!Co(n,r)||!Co(i,s):!0}function Jg(e,t,n){var r=!1,i=Hr,s=t.contextType;return typeof s=="object"&&s!==null?s=In(s):(i=Zt(t)?li:Gt.current,r=t.contextTypes,s=(r=r!=null)?ls(e,i):Hr),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ql,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function S0(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ql.enqueueReplaceState(t,t.state,null)}function Fc(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Of(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=In(s):(s=Zt(t)?li:Gt.current,i.context=ls(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Pc(e,t,s,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&ql.enqueueReplaceState(i,i.state,null),ll(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function ds(e,t){try{var n="",r=t;do n+=py(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function bu(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Mc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var G2=typeof WeakMap=="function"?WeakMap:Map;function Kg(e,t,n){n=ar(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){hl||(hl=!0,zc=r),Mc(e,t)},n}function Yg(e,t,n){n=ar(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){Mc(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Mc(e,t),typeof r!="function"&&(Or===null?Or=new Set([this]):Or.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function w0(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new G2;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=tE.bind(null,e,t,n),t.then(e,e))}function C0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function A0(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=ar(-1,1),t.tag=2,Ur(n,t,1))),n.lanes|=1),e)}var H2=vr.ReactCurrentOwner,Xt=!1;function zt(e,t,n,r){t.child=e===null?wg(t,null,n,r):cs(t,e.child,n,r)}function N0(e,t,n,r,i){n=n.render;var s=t.ref;return Xi(t,i),r=zf(e,t,n,r,s,i),n=Wf(),e!==null&&!Xt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,pr(e,t,i)):(Ze&&n&&Pf(t),t.flags|=1,zt(e,t,r,i),t.child)}function I0(e,t,n,r,i){if(e===null){var s=n.type;return typeof s=="function"&&!ed(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,jg(e,t,s,r,i)):(e=za(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Co,n(o,r)&&e.ref===t.ref)return pr(e,t,i)}return t.flags|=1,e=Vr(s,r),e.ref=t.ref,e.return=t,t.child=e}function jg(e,t,n,r,i){if(e!==null){var s=e.memoizedProps;if(Co(s,r)&&e.ref===t.ref)if(Xt=!1,t.pendingProps=r=s,(e.lanes&i)!==0)e.flags&131072&&(Xt=!0);else return t.lanes=e.lanes,pr(e,t,i)}return Dc(e,t,n,r,i)}function Xg(e,t,n){var r=t.pendingProps,i=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(zi,an),an|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Je(zi,an),an|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Je(zi,an),an|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,Je(zi,an),an|=r;return zt(e,t,i,n),t.child}function Qg(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Dc(e,t,n,r,i){var s=Zt(n)?li:Gt.current;return s=ls(t,s),Xi(t,i),n=zf(e,t,n,r,s,i),r=Wf(),e!==null&&!Xt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,pr(e,t,i)):(Ze&&r&&Pf(t),t.flags|=1,zt(e,t,n,i),t.child)}function k0(e,t,n,r,i){if(Zt(n)){var s=!0;rl(t)}else s=!1;if(Xi(t,i),t.stateNode===null)Va(e,t),Jg(t,n,r),Fc(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=In(u):(u=Zt(n)?li:Gt.current,u=ls(t,u));var d=n.getDerivedStateFromProps,m=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&S0(t,o,r,u),Ar=!1;var h=t.memoizedState;o.state=h,ll(t,r,o,i),l=t.memoizedState,a!==r||h!==l||Qt.current||Ar?(typeof d=="function"&&(Pc(t,n,d,r),l=t.memoizedState),(a=Ar||_0(t,n,a,r,h,l,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Ag(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:Dn(t.type,a),o.props=u,m=t.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=In(l):(l=Zt(n)?li:Gt.current,l=ls(t,l));var g=n.getDerivedStateFromProps;(d=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||h!==l)&&S0(t,o,r,l),Ar=!1,h=t.memoizedState,o.state=h,ll(t,r,o,i);var v=t.memoizedState;a!==m||h!==v||Qt.current||Ar?(typeof g=="function"&&(Pc(t,n,g,r),v=t.memoizedState),(u=Ar||_0(t,n,u,r,h,v,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,v,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,v,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=v),o.props=r,o.state=v,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Lc(e,t,n,r,s,i)}function Lc(e,t,n,r,i,s){Qg(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&p0(t,n,!1),pr(e,t,s);r=t.stateNode,H2.current=t;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=cs(t,e.child,null,s),t.child=cs(t,null,a,s)):zt(e,t,a,s),t.memoizedState=r.state,i&&p0(t,n,!0),t.child}function Zg(e){var t=e.stateNode;t.pendingContext?h0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&h0(e,t.context,!1),Bf(e,t.containerInfo)}function R0(e,t,n,r,i){return us(),Mf(i),t.flags|=256,zt(e,t,n,r),t.child}var bc={dehydrated:null,treeContext:null,retryLane:0};function Uc(e){return{baseLanes:e,cachePool:null,transitions:null}}function e1(e,t,n){var r=t.pendingProps,i=nt.current,s=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Je(nt,i&1),e===null)return kc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,s?(r=t.mode,s=t.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Kl(o,r,0,null),e=oi(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Uc(n),t.memoizedState=bc,e):Jf(t,o));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return z2(e,t,o,r,a,i,n);if(s){s=r.fallback,o=t.mode,i=e.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=Vr(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Vr(a,s):(s=oi(s,o,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,o=e.child.memoizedState,o=o===null?Uc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~n,t.memoizedState=bc,r}return s=e.child,e=s.sibling,r=Vr(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Jf(e,t){return t=Kl({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function va(e,t,n,r){return r!==null&&Mf(r),cs(t,e.child,null,n),e=Jf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function z2(e,t,n,r,i,s,o){if(n)return t.flags&256?(t.flags&=-257,r=bu(Error(re(422))),va(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Kl({mode:"visible",children:r.children},i,0,null),s=oi(s,i,o,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&cs(t,e.child,null,o),t.child.memoizedState=Uc(o),t.memoizedState=bc,s);if(!(t.mode&1))return va(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(re(419)),r=bu(s,r,void 0),va(e,t,o,r)}if(a=(o&e.childLanes)!==0,Xt||a){if(r=wt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,hr(e,i),Vn(r,e,i,-1))}return Zf(),r=bu(Error(re(421))),va(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=nE.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,fn=br(i.nextSibling),dn=t,Ze=!0,bn=null,e!==null&&(_n[Sn++]=sr,_n[Sn++]=or,_n[Sn++]=ui,sr=e.id,or=e.overflow,ui=t),t=Jf(t,r.children),t.flags|=4096,t)}function P0(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Rc(e.return,t,n)}function Uu(e,t,n,r,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function t1(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(zt(e,t,r.children,n),r=nt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&P0(e,n,t);else if(e.tag===19)P0(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Je(nt,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&ul(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Uu(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&ul(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Uu(t,!0,n,null,s);break;case"together":Uu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Va(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function pr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),fi|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(re(153));if(t.child!==null){for(e=t.child,n=Vr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Vr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function W2(e,t,n){switch(t.tag){case 3:Zg(t),us();break;case 5:Ng(t);break;case 1:Zt(t.type)&&rl(t);break;case 4:Bf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Je(ol,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Je(nt,nt.current&1),t.flags|=128,null):n&t.child.childLanes?e1(e,t,n):(Je(nt,nt.current&1),e=pr(e,t,n),e!==null?e.sibling:null);Je(nt,nt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return t1(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Je(nt,nt.current),r)break;return null;case 22:case 23:return t.lanes=0,Xg(e,t,n)}return pr(e,t,n)}var n1,Oc,r1,i1;n1=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Oc=function(){};r1=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,ii(Qn.current);var s=null;switch(n){case"input":i=oc(e,i),r=oc(e,r),s=[];break;case"select":i=it({},i,{value:void 0}),r=it({},r,{value:void 0}),s=[];break;case"textarea":i=uc(e,i),r=uc(e,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=tl)}fc(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(vo.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(vo.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ye("scroll",e),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};i1=function(e,t,n,r){n!==r&&(t.flags|=4)};function zs(e,t){if(!Ze)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function bt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function q2(e,t,n){var r=t.pendingProps;switch(Ff(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(t),null;case 1:return Zt(t.type)&&nl(),bt(t),null;case 3:return r=t.stateNode,fs(),Xe(Qt),Xe(Gt),Gf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ga(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,bn!==null&&($c(bn),bn=null))),Oc(e,t),bt(t),null;case 5:Vf(t);var i=ii(Ro.current);if(n=t.type,e!==null&&t.stateNode!=null)r1(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(re(166));return bt(t),null}if(e=ii(Qn.current),ga(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[jn]=t,r[Io]=s,e=(t.mode&1)!==0,n){case"dialog":Ye("cancel",r),Ye("close",r);break;case"iframe":case"object":case"embed":Ye("load",r);break;case"video":case"audio":for(i=0;i<Xs.length;i++)Ye(Xs[i],r);break;case"source":Ye("error",r);break;case"img":case"image":case"link":Ye("error",r),Ye("load",r);break;case"details":Ye("toggle",r);break;case"input":Vd(r,s),Ye("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ye("invalid",r);break;case"textarea":Hd(r,s),Ye("invalid",r)}fc(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&ma(r.textContent,a,e),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&ma(r.textContent,a,e),i=["children",""+a]):vo.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ye("scroll",r)}switch(n){case"input":aa(r),Gd(r,s,!0);break;case"textarea":aa(r),zd(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=tl)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Fm(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[jn]=t,e[Io]=r,n1(e,t,!1,!1),t.stateNode=e;e:{switch(o=dc(n,r),n){case"dialog":Ye("cancel",e),Ye("close",e),i=r;break;case"iframe":case"object":case"embed":Ye("load",e),i=r;break;case"video":case"audio":for(i=0;i<Xs.length;i++)Ye(Xs[i],e);i=r;break;case"source":Ye("error",e),i=r;break;case"img":case"image":case"link":Ye("error",e),Ye("load",e),i=r;break;case"details":Ye("toggle",e),i=r;break;case"input":Vd(e,r),i=oc(e,r),Ye("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=it({},r,{value:void 0}),Ye("invalid",e);break;case"textarea":Hd(e,r),i=uc(e,r),Ye("invalid",e);break;default:i=r}fc(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Lm(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Mm(e,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&yo(e,l):typeof l=="number"&&yo(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(vo.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ye("scroll",e):l!=null&&xf(e,s,l,o))}switch(n){case"input":aa(e),Gd(e,r,!1);break;case"textarea":aa(e),zd(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Gr(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?Ji(e,!!r.multiple,s,!1):r.defaultValue!=null&&Ji(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=tl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return bt(t),null;case 6:if(e&&t.stateNode!=null)i1(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(re(166));if(n=ii(Ro.current),ii(Qn.current),ga(t)){if(r=t.stateNode,n=t.memoizedProps,r[jn]=t,(s=r.nodeValue!==n)&&(e=dn,e!==null))switch(e.tag){case 3:ma(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ma(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[jn]=t,t.stateNode=r}return bt(t),null;case 13:if(Xe(nt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ze&&fn!==null&&t.mode&1&&!(t.flags&128))_g(),us(),t.flags|=98560,s=!1;else if(s=ga(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(re(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(re(317));s[jn]=t}else us(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;bt(t),s=!1}else bn!==null&&($c(bn),bn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||nt.current&1?yt===0&&(yt=3):Zf())),t.updateQueue!==null&&(t.flags|=4),bt(t),null);case 4:return fs(),Oc(e,t),e===null&&Ao(t.stateNode.containerInfo),bt(t),null;case 10:return bf(t.type._context),bt(t),null;case 17:return Zt(t.type)&&nl(),bt(t),null;case 19:if(Xe(nt),s=t.memoizedState,s===null)return bt(t),null;if(r=(t.flags&128)!==0,o=s.rendering,o===null)if(r)zs(s,!1);else{if(yt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=ul(e),o!==null){for(t.flags|=128,zs(s,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Je(nt,nt.current&1|2),t.child}e=e.sibling}s.tail!==null&&dt()>hs&&(t.flags|=128,r=!0,zs(s,!1),t.lanes=4194304)}else{if(!r)if(e=ul(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),zs(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ze)return bt(t),null}else 2*dt()-s.renderingStartTime>hs&&n!==1073741824&&(t.flags|=128,r=!0,zs(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(n=s.last,n!==null?n.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=dt(),t.sibling=null,n=nt.current,Je(nt,r?n&1|2:n&1),t):(bt(t),null);case 22:case 23:return Qf(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?an&1073741824&&(bt(t),t.subtreeFlags&6&&(t.flags|=8192)):bt(t),null;case 24:return null;case 25:return null}throw Error(re(156,t.tag))}function $2(e,t){switch(Ff(t),t.tag){case 1:return Zt(t.type)&&nl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return fs(),Xe(Qt),Xe(Gt),Gf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Vf(t),null;case 13:if(Xe(nt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(re(340));us()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Xe(nt),null;case 4:return fs(),null;case 10:return bf(t.type._context),null;case 22:case 23:return Qf(),null;case 24:return null;default:return null}}var ya=!1,Ut=!1,J2=typeof WeakSet=="function"?WeakSet:Set,xe=null;function Hi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){lt(e,t,r)}else n.current=null}function Bc(e,t,n){try{n()}catch(r){lt(e,t,r)}}var F0=!1;function K2(e,t){if(_c=Qa,e=ug(),Rf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,m=e,h=null;t:for(;;){for(var g;m!==n||i!==0&&m.nodeType!==3||(a=o+i),m!==s||r!==0&&m.nodeType!==3||(l=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(g=m.firstChild)!==null;)h=m,m=g;for(;;){if(m===e)break t;if(h===n&&++u===i&&(a=o),h===s&&++d===r&&(l=o),(g=m.nextSibling)!==null)break;m=h,h=m.parentNode}m=g}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Sc={focusedElem:e,selectionRange:n},Qa=!1,xe=t;xe!==null;)if(t=xe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,xe=e;else for(;xe!==null;){t=xe;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,_=v.memoizedState,T=t.stateNode,y=T.getSnapshotBeforeUpdate(t.elementType===t.type?x:Dn(t.type,x),_);T.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var E=t.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(re(163))}}catch(A){lt(t,t.return,A)}if(e=t.sibling,e!==null){e.return=t.return,xe=e;break}xe=t.return}return v=F0,F0=!1,v}function so(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&Bc(t,n,s)}i=i.next}while(i!==r)}}function $l(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Vc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function s1(e){var t=e.alternate;t!==null&&(e.alternate=null,s1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[jn],delete t[Io],delete t[Ac],delete t[R2],delete t[P2])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function o1(e){return e.tag===5||e.tag===3||e.tag===4}function M0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||o1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Gc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=tl));else if(r!==4&&(e=e.child,e!==null))for(Gc(e,t,n),e=e.sibling;e!==null;)Gc(e,t,n),e=e.sibling}function Hc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Hc(e,t,n),e=e.sibling;e!==null;)Hc(e,t,n),e=e.sibling}var At=null,Ln=!1;function Sr(e,t,n){for(n=n.child;n!==null;)a1(e,t,n),n=n.sibling}function a1(e,t,n){if(Xn&&typeof Xn.onCommitFiberUnmount=="function")try{Xn.onCommitFiberUnmount(Ol,n)}catch{}switch(n.tag){case 5:Ut||Hi(n,t);case 6:var r=At,i=Ln;At=null,Sr(e,t,n),At=r,Ln=i,At!==null&&(Ln?(e=At,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):At.removeChild(n.stateNode));break;case 18:At!==null&&(Ln?(e=At,n=n.stateNode,e.nodeType===8?Ru(e.parentNode,n):e.nodeType===1&&Ru(e,n),So(e)):Ru(At,n.stateNode));break;case 4:r=At,i=Ln,At=n.stateNode.containerInfo,Ln=!0,Sr(e,t,n),At=r,Ln=i;break;case 0:case 11:case 14:case 15:if(!Ut&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Bc(n,t,o),i=i.next}while(i!==r)}Sr(e,t,n);break;case 1:if(!Ut&&(Hi(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){lt(n,t,a)}Sr(e,t,n);break;case 21:Sr(e,t,n);break;case 22:n.mode&1?(Ut=(r=Ut)||n.memoizedState!==null,Sr(e,t,n),Ut=r):Sr(e,t,n);break;default:Sr(e,t,n)}}function D0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new J2),t.forEach(function(r){var i=rE.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Pn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:At=a.stateNode,Ln=!1;break e;case 3:At=a.stateNode.containerInfo,Ln=!0;break e;case 4:At=a.stateNode.containerInfo,Ln=!0;break e}a=a.return}if(At===null)throw Error(re(160));a1(s,o,i),At=null,Ln=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){lt(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)l1(t,e),t=t.sibling}function l1(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Pn(t,e),$n(e),r&4){try{so(3,e,e.return),$l(3,e)}catch(x){lt(e,e.return,x)}try{so(5,e,e.return)}catch(x){lt(e,e.return,x)}}break;case 1:Pn(t,e),$n(e),r&512&&n!==null&&Hi(n,n.return);break;case 5:if(Pn(t,e),$n(e),r&512&&n!==null&&Hi(n,n.return),e.flags&32){var i=e.stateNode;try{yo(i,"")}catch(x){lt(e,e.return,x)}}if(r&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=n!==null?n.memoizedProps:s,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Rm(i,s),dc(a,o);var u=dc(a,s);for(o=0;o<l.length;o+=2){var d=l[o],m=l[o+1];d==="style"?Lm(i,m):d==="dangerouslySetInnerHTML"?Mm(i,m):d==="children"?yo(i,m):xf(i,d,m,u)}switch(a){case"input":ac(i,s);break;case"textarea":Pm(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?Ji(i,!!s.multiple,g,!1):h!==!!s.multiple&&(s.defaultValue!=null?Ji(i,!!s.multiple,s.defaultValue,!0):Ji(i,!!s.multiple,s.multiple?[]:"",!1))}i[Io]=s}catch(x){lt(e,e.return,x)}}break;case 6:if(Pn(t,e),$n(e),r&4){if(e.stateNode===null)throw Error(re(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(x){lt(e,e.return,x)}}break;case 3:if(Pn(t,e),$n(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{So(t.containerInfo)}catch(x){lt(e,e.return,x)}break;case 4:Pn(t,e),$n(e);break;case 13:Pn(t,e),$n(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(jf=dt())),r&4&&D0(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(Ut=(u=Ut)||d,Pn(t,e),Ut=u):Pn(t,e),$n(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(xe=e,d=e.child;d!==null;){for(m=xe=d;xe!==null;){switch(h=xe,g=h.child,h.tag){case 0:case 11:case 14:case 15:so(4,h,h.return);break;case 1:Hi(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(x){lt(r,n,x)}}break;case 5:Hi(h,h.return);break;case 22:if(h.memoizedState!==null){b0(m);continue}}g!==null?(g.return=h,xe=g):b0(m)}d=d.sibling}e:for(d=null,m=e;;){if(m.tag===5){if(d===null){d=m;try{i=m.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=m.stateNode,l=m.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Dm("display",o))}catch(x){lt(e,e.return,x)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(x){lt(e,e.return,x)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Pn(t,e),$n(e),r&4&&D0(e);break;case 21:break;default:Pn(t,e),$n(e)}}function $n(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(o1(n)){var r=n;break e}n=n.return}throw Error(re(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(yo(i,""),r.flags&=-33);var s=M0(e);Hc(e,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=M0(e);Gc(e,a,o);break;default:throw Error(re(161))}}catch(l){lt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Y2(e,t,n){xe=e,u1(e)}function u1(e,t,n){for(var r=(e.mode&1)!==0;xe!==null;){var i=xe,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||ya;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Ut;a=ya;var u=Ut;if(ya=o,(Ut=l)&&!u)for(xe=i;xe!==null;)o=xe,l=o.child,o.tag===22&&o.memoizedState!==null?U0(i):l!==null?(l.return=o,xe=l):U0(i);for(;s!==null;)xe=s,u1(s),s=s.sibling;xe=i,ya=a,Ut=u}L0(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,xe=s):L0(e)}}function L0(e){for(;xe!==null;){var t=xe;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ut||$l(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Ut)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:Dn(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&y0(t,s,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}y0(t,o,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&So(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(re(163))}Ut||t.flags&512&&Vc(t)}catch(h){lt(t,t.return,h)}}if(t===e){xe=null;break}if(n=t.sibling,n!==null){n.return=t.return,xe=n;break}xe=t.return}}function b0(e){for(;xe!==null;){var t=xe;if(t===e){xe=null;break}var n=t.sibling;if(n!==null){n.return=t.return,xe=n;break}xe=t.return}}function U0(e){for(;xe!==null;){var t=xe;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{$l(4,t)}catch(l){lt(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(l){lt(t,i,l)}}var s=t.return;try{Vc(t)}catch(l){lt(t,s,l)}break;case 5:var o=t.return;try{Vc(t)}catch(l){lt(t,o,l)}}}catch(l){lt(t,t.return,l)}if(t===e){xe=null;break}var a=t.sibling;if(a!==null){a.return=t.return,xe=a;break}xe=t.return}}var j2=Math.ceil,dl=vr.ReactCurrentDispatcher,Kf=vr.ReactCurrentOwner,An=vr.ReactCurrentBatchConfig,be=0,wt=null,pt=null,Rt=0,an=0,zi=Jr(0),yt=0,Do=null,fi=0,Jl=0,Yf=0,oo=null,jt=null,jf=0,hs=1/0,rr=null,hl=!1,zc=null,Or=null,Ea=!1,Rr=null,pl=0,ao=0,Wc=null,Ga=-1,Ha=0;function $t(){return be&6?dt():Ga!==-1?Ga:Ga=dt()}function Br(e){return e.mode&1?be&2&&Rt!==0?Rt&-Rt:M2.transition!==null?(Ha===0&&(Ha=Jm()),Ha):(e=ze,e!==0||(e=window.event,e=e===void 0?16:eg(e.type)),e):1}function Vn(e,t,n,r){if(50<ao)throw ao=0,Wc=null,Error(re(185));zo(e,n,r),(!(be&2)||e!==wt)&&(e===wt&&(!(be&2)&&(Jl|=n),yt===4&&Ir(e,Rt)),en(e,r),n===1&&be===0&&!(t.mode&1)&&(hs=dt()+500,zl&&Kr()))}function en(e,t){var n=e.callbackNode;My(e,t);var r=Xa(e,e===wt?Rt:0);if(r===0)n!==null&&$d(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&$d(n),t===1)e.tag===0?F2(O0.bind(null,e)):yg(O0.bind(null,e)),I2(function(){!(be&6)&&Kr()}),n=null;else{switch(Km(r)){case 1:n=_f;break;case 4:n=qm;break;case 16:n=ja;break;case 536870912:n=$m;break;default:n=ja}n=x1(n,c1.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function c1(e,t){if(Ga=-1,Ha=0,be&6)throw Error(re(327));var n=e.callbackNode;if(Qi()&&e.callbackNode!==n)return null;var r=Xa(e,e===wt?Rt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=ml(e,r);else{t=r;var i=be;be|=2;var s=d1();(wt!==e||Rt!==t)&&(rr=null,hs=dt()+500,si(e,t));do try{Z2();break}catch(a){f1(e,a)}while(!0);Lf(),dl.current=s,be=i,pt!==null?t=0:(wt=null,Rt=0,t=yt)}if(t!==0){if(t===2&&(i=xc(e),i!==0&&(r=i,t=qc(e,i))),t===1)throw n=Do,si(e,0),Ir(e,r),en(e,dt()),n;if(t===6)Ir(e,r);else{if(i=e.current.alternate,!(r&30)&&!X2(i)&&(t=ml(e,r),t===2&&(s=xc(e),s!==0&&(r=s,t=qc(e,s))),t===1))throw n=Do,si(e,0),Ir(e,r),en(e,dt()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(re(345));case 2:ei(e,jt,rr);break;case 3:if(Ir(e,r),(r&130023424)===r&&(t=jf+500-dt(),10<t)){if(Xa(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){$t(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Cc(ei.bind(null,e,jt,rr),t);break}ei(e,jt,rr);break;case 4:if(Ir(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-Bn(r);s=1<<o,o=t[o],o>i&&(i=o),r&=~s}if(r=i,r=dt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*j2(r/1960))-r,10<r){e.timeoutHandle=Cc(ei.bind(null,e,jt,rr),r);break}ei(e,jt,rr);break;case 5:ei(e,jt,rr);break;default:throw Error(re(329))}}}return en(e,dt()),e.callbackNode===n?c1.bind(null,e):null}function qc(e,t){var n=oo;return e.current.memoizedState.isDehydrated&&(si(e,t).flags|=256),e=ml(e,t),e!==2&&(t=jt,jt=n,t!==null&&$c(t)),e}function $c(e){jt===null?jt=e:jt.push.apply(jt,e)}function X2(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Hn(s(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ir(e,t){for(t&=~Yf,t&=~Jl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Bn(t),r=1<<n;e[n]=-1,t&=~r}}function O0(e){if(be&6)throw Error(re(327));Qi();var t=Xa(e,0);if(!(t&1))return en(e,dt()),null;var n=ml(e,t);if(e.tag!==0&&n===2){var r=xc(e);r!==0&&(t=r,n=qc(e,r))}if(n===1)throw n=Do,si(e,0),Ir(e,t),en(e,dt()),n;if(n===6)throw Error(re(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ei(e,jt,rr),en(e,dt()),null}function Xf(e,t){var n=be;be|=1;try{return e(t)}finally{be=n,be===0&&(hs=dt()+500,zl&&Kr())}}function di(e){Rr!==null&&Rr.tag===0&&!(be&6)&&Qi();var t=be;be|=1;var n=An.transition,r=ze;try{if(An.transition=null,ze=1,e)return e()}finally{ze=r,An.transition=n,be=t,!(be&6)&&Kr()}}function Qf(){an=zi.current,Xe(zi)}function si(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,N2(n)),pt!==null)for(n=pt.return;n!==null;){var r=n;switch(Ff(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&nl();break;case 3:fs(),Xe(Qt),Xe(Gt),Gf();break;case 5:Vf(r);break;case 4:fs();break;case 13:Xe(nt);break;case 19:Xe(nt);break;case 10:bf(r.type._context);break;case 22:case 23:Qf()}n=n.return}if(wt=e,pt=e=Vr(e.current,null),Rt=an=t,yt=0,Do=null,Yf=Jl=fi=0,jt=oo=null,ri!==null){for(t=0;t<ri.length;t++)if(n=ri[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}ri=null}return e}function f1(e,t){do{var n=pt;try{if(Lf(),Oa.current=fl,cl){for(var r=rt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}cl=!1}if(ci=0,Et=vt=rt=null,io=!1,Po=0,Kf.current=null,n===null||n.return===null){yt=1,Do=t,pt=null;break}e:{var s=e,o=n.return,a=n,l=t;if(t=Rt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=C0(o);if(g!==null){g.flags&=-257,A0(g,o,a,s,t),g.mode&1&&w0(s,u,t),t=g,l=u;var v=t.updateQueue;if(v===null){var x=new Set;x.add(l),t.updateQueue=x}else v.add(l);break e}else{if(!(t&1)){w0(s,u,t),Zf();break e}l=Error(re(426))}}else if(Ze&&a.mode&1){var _=C0(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),A0(_,o,a,s,t),Mf(ds(l,a));break e}}s=l=ds(l,a),yt!==4&&(yt=2),oo===null?oo=[s]:oo.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var T=Kg(s,l,t);v0(s,T);break e;case 1:a=l;var y=s.type,E=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Or===null||!Or.has(E)))){s.flags|=65536,t&=-t,s.lanes|=t;var A=Yg(s,a,t);v0(s,A);break e}}s=s.return}while(s!==null)}p1(n)}catch(b){t=b,pt===n&&n!==null&&(pt=n=n.return);continue}break}while(!0)}function d1(){var e=dl.current;return dl.current=fl,e===null?fl:e}function Zf(){(yt===0||yt===3||yt===2)&&(yt=4),wt===null||!(fi&268435455)&&!(Jl&268435455)||Ir(wt,Rt)}function ml(e,t){var n=be;be|=2;var r=d1();(wt!==e||Rt!==t)&&(rr=null,si(e,t));do try{Q2();break}catch(i){f1(e,i)}while(!0);if(Lf(),be=n,dl.current=r,pt!==null)throw Error(re(261));return wt=null,Rt=0,yt}function Q2(){for(;pt!==null;)h1(pt)}function Z2(){for(;pt!==null&&!wy();)h1(pt)}function h1(e){var t=g1(e.alternate,e,an);e.memoizedProps=e.pendingProps,t===null?p1(e):pt=t,Kf.current=null}function p1(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=$2(n,t),n!==null){n.flags&=32767,pt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{yt=6,pt=null;return}}else if(n=q2(n,t,an),n!==null){pt=n;return}if(t=t.sibling,t!==null){pt=t;return}pt=t=e}while(t!==null);yt===0&&(yt=5)}function ei(e,t,n){var r=ze,i=An.transition;try{An.transition=null,ze=1,eE(e,t,n,r)}finally{An.transition=i,ze=r}return null}function eE(e,t,n,r){do Qi();while(Rr!==null);if(be&6)throw Error(re(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(re(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(Dy(e,s),e===wt&&(pt=wt=null,Rt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ea||(Ea=!0,x1(ja,function(){return Qi(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=An.transition,An.transition=null;var o=ze;ze=1;var a=be;be|=4,Kf.current=null,K2(e,n),l1(n,e),E2(Sc),Qa=!!_c,Sc=_c=null,e.current=n,Y2(n),Cy(),be=a,ze=o,An.transition=s}else e.current=n;if(Ea&&(Ea=!1,Rr=e,pl=i),s=e.pendingLanes,s===0&&(Or=null),Iy(n.stateNode),en(e,dt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(hl)throw hl=!1,e=zc,zc=null,e;return pl&1&&e.tag!==0&&Qi(),s=e.pendingLanes,s&1?e===Wc?ao++:(ao=0,Wc=e):ao=0,Kr(),null}function Qi(){if(Rr!==null){var e=Km(pl),t=An.transition,n=ze;try{if(An.transition=null,ze=16>e?16:e,Rr===null)var r=!1;else{if(e=Rr,Rr=null,pl=0,be&6)throw Error(re(331));var i=be;for(be|=4,xe=e.current;xe!==null;){var s=xe,o=s.child;if(xe.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(xe=u;xe!==null;){var d=xe;switch(d.tag){case 0:case 11:case 15:so(8,d,s)}var m=d.child;if(m!==null)m.return=d,xe=m;else for(;xe!==null;){d=xe;var h=d.sibling,g=d.return;if(s1(d),d===u){xe=null;break}if(h!==null){h.return=g,xe=h;break}xe=g}}}var v=s.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var _=x.sibling;x.sibling=null,x=_}while(x!==null)}}xe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,xe=o;else e:for(;xe!==null;){if(s=xe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:so(9,s,s.return)}var T=s.sibling;if(T!==null){T.return=s.return,xe=T;break e}xe=s.return}}var y=e.current;for(xe=y;xe!==null;){o=xe;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,xe=E;else e:for(o=y;xe!==null;){if(a=xe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:$l(9,a)}}catch(b){lt(a,a.return,b)}if(a===o){xe=null;break e}var A=a.sibling;if(A!==null){A.return=a.return,xe=A;break e}xe=a.return}}if(be=i,Kr(),Xn&&typeof Xn.onPostCommitFiberRoot=="function")try{Xn.onPostCommitFiberRoot(Ol,e)}catch{}r=!0}return r}finally{ze=n,An.transition=t}}return!1}function B0(e,t,n){t=ds(n,t),t=Kg(e,t,1),e=Ur(e,t,1),t=$t(),e!==null&&(zo(e,1,t),en(e,t))}function lt(e,t,n){if(e.tag===3)B0(e,e,n);else for(;t!==null;){if(t.tag===3){B0(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Or===null||!Or.has(r))){e=ds(n,e),e=Yg(t,e,1),t=Ur(t,e,1),e=$t(),t!==null&&(zo(t,1,e),en(t,e));break}}t=t.return}}function tE(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=$t(),e.pingedLanes|=e.suspendedLanes&n,wt===e&&(Rt&n)===n&&(yt===4||yt===3&&(Rt&130023424)===Rt&&500>dt()-jf?si(e,0):Yf|=n),en(e,t)}function m1(e,t){t===0&&(e.mode&1?(t=ca,ca<<=1,!(ca&130023424)&&(ca=4194304)):t=1);var n=$t();e=hr(e,t),e!==null&&(zo(e,t,n),en(e,n))}function nE(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),m1(e,n)}function rE(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(re(314))}r!==null&&r.delete(t),m1(e,n)}var g1;g1=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Qt.current)Xt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Xt=!1,W2(e,t,n);Xt=!!(e.flags&131072)}else Xt=!1,Ze&&t.flags&1048576&&Eg(t,sl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Va(e,t),e=t.pendingProps;var i=ls(t,Gt.current);Xi(t,n),i=zf(null,t,r,e,i,n);var s=Wf();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Zt(r)?(s=!0,rl(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Of(t),i.updater=ql,t.stateNode=i,i._reactInternals=t,Fc(t,r,e,n),t=Lc(null,t,r,!0,s,n)):(t.tag=0,Ze&&s&&Pf(t),zt(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Va(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=sE(r),e=Dn(r,e),i){case 0:t=Dc(null,t,r,e,n);break e;case 1:t=k0(null,t,r,e,n);break e;case 11:t=N0(null,t,r,e,n);break e;case 14:t=I0(null,t,r,Dn(r.type,e),n);break e}throw Error(re(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Dn(r,i),Dc(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Dn(r,i),k0(e,t,r,i,n);case 3:e:{if(Zg(t),e===null)throw Error(re(387));r=t.pendingProps,s=t.memoizedState,i=s.element,Ag(e,t),ll(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=ds(Error(re(423)),t),t=R0(e,t,r,n,i);break e}else if(r!==i){i=ds(Error(re(424)),t),t=R0(e,t,r,n,i);break e}else for(fn=br(t.stateNode.containerInfo.firstChild),dn=t,Ze=!0,bn=null,n=wg(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(us(),r===i){t=pr(e,t,n);break e}zt(e,t,r,n)}t=t.child}return t;case 5:return Ng(t),e===null&&kc(t),r=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,wc(r,i)?o=null:s!==null&&wc(r,s)&&(t.flags|=32),Qg(e,t),zt(e,t,o,n),t.child;case 6:return e===null&&kc(t),null;case 13:return e1(e,t,n);case 4:return Bf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=cs(t,null,r,n):zt(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Dn(r,i),N0(e,t,r,i,n);case 7:return zt(e,t,t.pendingProps,n),t.child;case 8:return zt(e,t,t.pendingProps.children,n),t.child;case 12:return zt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Je(ol,r._currentValue),r._currentValue=o,s!==null)if(Hn(s.value,o)){if(s.children===i.children&&!Qt.current){t=pr(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=ar(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Rc(s.return,n,t),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(re(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Rc(o,n,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}zt(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Xi(t,n),i=In(i),r=r(i),t.flags|=1,zt(e,t,r,n),t.child;case 14:return r=t.type,i=Dn(r,t.pendingProps),i=Dn(r.type,i),I0(e,t,r,i,n);case 15:return jg(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Dn(r,i),Va(e,t),t.tag=1,Zt(r)?(e=!0,rl(t)):e=!1,Xi(t,n),Jg(t,r,i),Fc(t,r,i,n),Lc(null,t,r,!0,e,n);case 19:return t1(e,t,n);case 22:return Xg(e,t,n)}throw Error(re(156,t.tag))};function x1(e,t){return Wm(e,t)}function iE(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cn(e,t,n,r){return new iE(e,t,n,r)}function ed(e){return e=e.prototype,!(!e||!e.isReactComponent)}function sE(e){if(typeof e=="function")return ed(e)?1:0;if(e!=null){if(e=e.$$typeof,e===yf)return 11;if(e===Ef)return 14}return 2}function Vr(e,t){var n=e.alternate;return n===null?(n=Cn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function za(e,t,n,r,i,s){var o=2;if(r=e,typeof e=="function")ed(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Mi:return oi(n.children,i,s,t);case vf:o=8,i|=8;break;case nc:return e=Cn(12,n,t,i|2),e.elementType=nc,e.lanes=s,e;case rc:return e=Cn(13,n,t,i),e.elementType=rc,e.lanes=s,e;case ic:return e=Cn(19,n,t,i),e.elementType=ic,e.lanes=s,e;case Nm:return Kl(n,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Cm:o=10;break e;case Am:o=9;break e;case yf:o=11;break e;case Ef:o=14;break e;case Cr:o=16,r=null;break e}throw Error(re(130,e==null?e:typeof e,""))}return t=Cn(o,n,t,i),t.elementType=e,t.type=r,t.lanes=s,t}function oi(e,t,n,r){return e=Cn(7,e,r,t),e.lanes=n,e}function Kl(e,t,n,r){return e=Cn(22,e,r,t),e.elementType=Nm,e.lanes=n,e.stateNode={isHidden:!1},e}function Ou(e,t,n){return e=Cn(6,e,null,t),e.lanes=n,e}function Bu(e,t,n){return t=Cn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function oE(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yu(0),this.expirationTimes=yu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yu(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function td(e,t,n,r,i,s,o,a,l){return e=new oE(e,t,n,a,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Cn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Of(s),e}function aE(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function v1(e){if(!e)return Hr;e=e._reactInternals;e:{if(xi(e)!==e||e.tag!==1)throw Error(re(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Zt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(re(171))}if(e.tag===1){var n=e.type;if(Zt(n))return vg(e,n,t)}return t}function y1(e,t,n,r,i,s,o,a,l){return e=td(n,r,!0,e,i,s,o,a,l),e.context=v1(null),n=e.current,r=$t(),i=Br(n),s=ar(r,i),s.callback=t??null,Ur(n,s,i),e.current.lanes=i,zo(e,i,r),en(e,r),e}function Yl(e,t,n,r){var i=t.current,s=$t(),o=Br(i);return n=v1(n),t.context===null?t.context=n:t.pendingContext=n,t=ar(s,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Ur(i,t,o),e!==null&&(Vn(e,i,o,s),Ua(e,i,o)),o}function gl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function V0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function nd(e,t){V0(e,t),(e=e.alternate)&&V0(e,t)}function lE(){return null}var E1=typeof reportError=="function"?reportError:function(e){console.error(e)};function rd(e){this._internalRoot=e}jl.prototype.render=rd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(re(409));Yl(e,t,null,null)};jl.prototype.unmount=rd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;di(function(){Yl(null,e,null,null)}),t[dr]=null}};function jl(e){this._internalRoot=e}jl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Xm();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Nr.length&&t!==0&&t<Nr[n].priority;n++);Nr.splice(n,0,e),n===0&&Zm(e)}};function id(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Xl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function G0(){}function uE(e,t,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=gl(o);s.call(u)}}var o=y1(t,r,e,0,null,!1,!1,"",G0);return e._reactRootContainer=o,e[dr]=o.current,Ao(e.nodeType===8?e.parentNode:e),di(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=gl(l);a.call(u)}}var l=td(e,0,!1,null,null,!1,!1,"",G0);return e._reactRootContainer=l,e[dr]=l.current,Ao(e.nodeType===8?e.parentNode:e),di(function(){Yl(t,l,n,r)}),l}function Ql(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=gl(o);a.call(l)}}Yl(t,o,e,i)}else o=uE(n,t,e,i,r);return gl(o)}Ym=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=js(t.pendingLanes);n!==0&&(Sf(t,n|1),en(t,dt()),!(be&6)&&(hs=dt()+500,Kr()))}break;case 13:di(function(){var r=hr(e,1);if(r!==null){var i=$t();Vn(r,e,1,i)}}),nd(e,1)}};wf=function(e){if(e.tag===13){var t=hr(e,134217728);if(t!==null){var n=$t();Vn(t,e,134217728,n)}nd(e,134217728)}};jm=function(e){if(e.tag===13){var t=Br(e),n=hr(e,t);if(n!==null){var r=$t();Vn(n,e,t,r)}nd(e,t)}};Xm=function(){return ze};Qm=function(e,t){var n=ze;try{return ze=e,t()}finally{ze=n}};pc=function(e,t,n){switch(t){case"input":if(ac(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Hl(r);if(!i)throw Error(re(90));km(r),ac(r,i)}}}break;case"textarea":Pm(e,n);break;case"select":t=n.value,t!=null&&Ji(e,!!n.multiple,t,!1)}};Om=Xf;Bm=di;var cE={usingClientEntryPoint:!1,Events:[qo,Ui,Hl,bm,Um,Xf]},Ws={findFiberByHostInstance:ni,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fE={bundleType:Ws.bundleType,version:Ws.version,rendererPackageName:Ws.rendererPackageName,rendererConfig:Ws.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Hm(e),e===null?null:e.stateNode},findFiberByHostInstance:Ws.findFiberByHostInstance||lE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ta=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ta.isDisabled&&Ta.supportsFiber)try{Ol=Ta.inject(fE),Xn=Ta}catch{}}mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cE;mn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!id(t))throw Error(re(200));return aE(e,t,null,n)};mn.createRoot=function(e,t){if(!id(e))throw Error(re(299));var n=!1,r="",i=E1;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=td(e,1,!1,null,null,n,!1,r,i),e[dr]=t.current,Ao(e.nodeType===8?e.parentNode:e),new rd(t)};mn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(re(188)):(e=Object.keys(e).join(","),Error(re(268,e)));return e=Hm(t),e=e===null?null:e.stateNode,e};mn.flushSync=function(e){return di(e)};mn.hydrate=function(e,t,n){if(!Xl(t))throw Error(re(200));return Ql(null,e,t,!0,n)};mn.hydrateRoot=function(e,t,n){if(!id(e))throw Error(re(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=E1;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=y1(t,null,e,1,n??null,i,!1,s,o),e[dr]=t.current,Ao(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new jl(t)};mn.render=function(e,t,n){if(!Xl(t))throw Error(re(200));return Ql(null,e,t,!1,n)};mn.unmountComponentAtNode=function(e){if(!Xl(e))throw Error(re(40));return e._reactRootContainer?(di(function(){Ql(null,null,e,!1,function(){e._reactRootContainer=null,e[dr]=null})}),!0):!1};mn.unstable_batchedUpdates=Xf;mn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xl(n))throw Error(re(200));if(e==null||e._reactInternals===void 0)throw Error(re(38));return Ql(e,t,n,!1,r)};mn.version="18.3.1-next-f1338f8080-20240426";function T1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(T1)}catch(e){console.error(e)}}T1(),Tm.exports=mn;var dE=Tm.exports,H0=dE;ec.createRoot=H0.createRoot,ec.hydrateRoot=H0.hydrateRoot;/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hE=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),_1=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var pE={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mE=Ae.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...a},l)=>Ae.createElement("svg",{ref:l,...pE,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:_1("lucide",i),...a},[...o.map(([u,d])=>Ae.createElement(u,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=(e,t)=>{const n=Ae.forwardRef(({className:r,...i},s)=>Ae.createElement(mE,{ref:s,iconNode:t,className:_1(`lucide-${hE(e)}`,r),...i}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z0=Ce("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gE=Ce("Baby",[["path",{d:"M9 12h.01",key:"157uk2"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"5yv0yz"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xE=Ce("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vE=Ce("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=Ce("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yE=Ce("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EE=Ce("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TE=Ce("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _E=Ce("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SE=Ce("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wE=Ce("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W0=Ce("Combine",[["path",{d:"M10 18H5a3 3 0 0 1-3-3v-1",key:"ru65g8"}],["path",{d:"M14 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"e30een"}],["path",{d:"M20 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"2ahx8o"}],["path",{d:"m7 21 3-3-3-3",key:"127cv2"}],["rect",{x:"14",y:"14",width:"8",height:"8",rx:"2",key:"1b0bso"}],["rect",{x:"2",y:"2",width:"8",height:"8",rx:"2",key:"1x09vl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CE=Ce("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jc=Ce("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AE=Ce("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xl=Ce("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=Ce("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NE=Ce("FileSearch",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=Ce("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vu=Ce("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=Ce("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IE=Ce("Flower2",[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zi=Ce("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kE=Ce("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S1=Ce("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $0=Ce("Hammer",[["path",{d:"m15 12-8.373 8.373a1 1 0 1 1-3-3L12 9",key:"eefl8a"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172V7l-2.26-2.26a6 6 0 0 0-4.202-1.756L9 2.96l.92.82A6.18 6.18 0 0 1 12 8.4V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"b7pghm"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wi=Ce("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w1=Ce("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J0=Ce("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RE=Ce("LayoutList",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K0=Ce("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=Ce("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PE=Ce("ListPlus",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=Ce("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FE=Ce("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=Ce("Microscope",[["path",{d:"M6 18h8",key:"1borvv"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M14 22a7 7 0 1 0 0-14h-1",key:"1jwaiy"}],["path",{d:"M9 14h2",key:"197e7h"}],["path",{d:"M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z",key:"1bmzmy"}],["path",{d:"M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3",key:"1drr47"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=Ce("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jc=Ce("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=Ce("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DE=Ce("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=Ce("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=Ce("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zu=Ce("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j0=Ce("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LE=Ce("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wu=Ce("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bE=Ce("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UE=Ce("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OE=Ce("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=Ce("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ri=Ce("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X0=Ce("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=Ce("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var vl={};vl.version="0.18.5";var C1=1252,BE=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],A1=function(e){BE.indexOf(e)!=-1&&(C1=e)};function VE(){A1(1252)}var Lo=function(e){A1(e)};function GE(){Lo(1200),VE()}var wa=function(t){return String.fromCharCode(t)},Q0=function(t){return String.fromCharCode(t)},yl,Pr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function bo(e){for(var t="",n=0,r=0,i=0,s=0,o=0,a=0,l=0,u=0;u<e.length;)n=e.charCodeAt(u++),s=n>>2,r=e.charCodeAt(u++),o=(n&3)<<4|r>>4,i=e.charCodeAt(u++),a=(r&15)<<2|i>>6,l=i&63,isNaN(r)?a=l=64:isNaN(i)&&(l=64),t+=Pr.charAt(s)+Pr.charAt(o)+Pr.charAt(a)+Pr.charAt(l);return t}function mr(e){var t="",n=0,r=0,i=0,s=0,o=0,a=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=Pr.indexOf(e.charAt(u++)),o=Pr.indexOf(e.charAt(u++)),n=s<<2|o>>4,t+=String.fromCharCode(n),a=Pr.indexOf(e.charAt(u++)),r=(o&15)<<4|a>>2,a!==64&&(t+=String.fromCharCode(r)),l=Pr.indexOf(e.charAt(u++)),i=(a&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Be=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),yr=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function hi(e){return Be?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Z0(e){return Be?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Un=function(t){return Be?yr(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function Zl(e){if(typeof ArrayBuffer>"u")return Un(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=e.charCodeAt(r)&255;return t}function Jo(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function HE(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var It=Be?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:yr(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),i=0;for(t=0,n=0;t<e.length;n+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function zE(e){for(var t=[],n=0,r=e.length+250,i=hi(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[n++]=o;else if(o<2048)i[n++]=192|o>>6&31,i[n++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=e.charCodeAt(++s)&1023;i[n++]=240|o>>8&7,i[n++]=128|o>>2&63,i[n++]=128|a>>6&15|(o&3)<<4,i[n++]=128|a&63}else i[n++]=224|o>>12&15,i[n++]=128|o>>6&63,i[n++]=128|o&63;n>r&&(t.push(i.slice(0,n)),n=0,i=hi(65535),r=65530)}return t.push(i.slice(0,n)),It(t)}var co=/\u0000/g,Ca=/[\u0001-\u0006]/g;function es(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function On(e,t){var n=""+e;return n.length>=t?n:ut("0",t-n.length)+n}function sd(e,t){var n=""+e;return n.length>=t?n:ut(" ",t-n.length)+n}function El(e,t){var n=""+e;return n.length>=t?n:n+ut(" ",t-n.length)}function WE(e,t){var n=""+Math.round(e);return n.length>=t?n:ut("0",t-n.length)+n}function qE(e,t){var n=""+e;return n.length>=t?n:ut("0",t-n.length)+n}var eh=Math.pow(2,32);function Ni(e,t){if(e>eh||e<-eh)return WE(e,t);var n=Math.round(e);return qE(n,t)}function Tl(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var th=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],qu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $E(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ct={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},nh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},JE={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _l(e,t,n){for(var r=e<0?-1:1,i=e*r,s=0,o=1,a=0,l=1,u=0,d=0,m=Math.floor(i);u<t&&(m=Math.floor(i),a=m*o+s,d=m*u+l,!(i-m<5e-8));)i=1/(i-m),s=o,o=a,l=u,u=d;if(d>t&&(u>t?(d=l,a=s):(d=u,a=o)),!n)return[0,r*a,d];var h=Math.floor(r*a/d);return[h,r*a-h*d,d]}function Aa(e,t,n){if(e>2958465||e<0)return null;var r=e|0,i=Math.floor(86400*(e-r)),s=0,o=[],a={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(r+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++r,++a.D)),r===60)o=n?[1317,10,29]:[1900,2,29],s=3;else if(r===0)o=n?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),n&&(s=eT(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var N1=new Date(1899,11,31,0,0,0),KE=N1.getTime(),YE=new Date(1900,2,1,0,0,0);function I1(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=YE&&(n+=24*60*60*1e3),(n-(KE+(e.getTimezoneOffset()-N1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function od(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function jE(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function XE(e){var t=e<0?12:11,n=od(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function QE(e){var t=od(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ZE(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=XE(e):t===10?n=e.toFixed(10).substr(0,12):n=QE(e),od(jE(n.toUpperCase()))}function Xc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ZE(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return zr(14,I1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function eT(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function tT(e,t,n,r){var i="",s=0,o=0,a=n.y,l,u=0;switch(e){case 98:a=n.y+543;case 121:switch(t.length){case 1:case 2:l=a%100,u=2;break;default:l=a%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=n.m,u=t.length;break;case 3:return qu[n.m-1][1];case 5:return qu[n.m-1][0];default:return qu[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=n.d,u=t.length;break;case 3:return th[n.q][0];default:return th[n.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(n.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=n.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=n.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?On(n.S,t.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,s=Math.round(o*(n.S+n.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=On(s,2+r),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=n.D*24+n.H;break;case"[m]":case"[mm]":l=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":l=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=a,u=1;break}var d=u>0?On(l,u):"";return d}function Fr(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,r=e.substr(0,n);n!=e.length;n+=t)r+=(r.length>0?",":"")+e.substr(n,t);return r}var k1=/%/g;function nT(e,t,n){var r=t.replace(k1,""),i=t.length-r.length;return lr(e,r,n*Math.pow(10,2*i))+ut("%",i)}function rT(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return lr(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function R1(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+R1(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),n.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,d){return l+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var P1=/# (\?+)( ?)\/( ?)(\d+)/;function iT(e,t,n){var r=parseInt(e[4],10),i=Math.round(t*r),s=Math.floor(i/r),o=i-s*r,a=r;return n+(s===0?"":""+s)+" "+(o===0?ut(" ",e[1].length+1+e[4].length):sd(o,e[1].length)+e[2]+"/"+e[3]+On(a,e[4].length))}function sT(e,t,n){return n+(t===0?"":""+t)+ut(" ",e[1].length+2+e[4].length)}var F1=/^#*0*\.([0#]+)/,M1=/\).*[0#]/,D1=/\(###\) ###\\?-####/;function Wt(e){for(var t="",n,r=0;r!=e.length;++r)switch(n=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function rh(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function ih(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function oT(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function aT(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function yn(e,t,n){if(e.charCodeAt(0)===40&&!t.match(M1)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?yn("n",r,n):"("+yn("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return rT(e,t,n);if(t.indexOf("%")!==-1)return nT(e,t,n);if(t.indexOf("E")!==-1)return R1(t,n);if(t.charCodeAt(0)===36)return"$"+yn(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,o,a,l=Math.abs(n),u=n<0?"-":"";if(t.match(/^00+$/))return u+Ni(l,t.length);if(t.match(/^[#?]+$/))return i=Ni(n,0),i==="0"&&(i=""),i.length>t.length?i:Wt(t.substr(0,t.length-i.length))+i;if(s=t.match(P1))return iT(s,l,u);if(t.match(/^#+0+$/))return u+Ni(l,t.length-t.indexOf("0"));if(s=t.match(F1))return i=rh(n,s[1].length).replace(/^([^\.]+)$/,"$1."+Wt(s[1])).replace(/\.$/,"."+Wt(s[1])).replace(/\.(\d*)$/,function(v,x){return"."+x+ut("0",Wt(s[1]).length-x.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+rh(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Fr(Ni(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+yn(e,t,-n):Fr(""+(Math.floor(n)+oT(n,s[1].length)))+"."+On(ih(n,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return yn(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=es(yn(e,t.replace(/[\\-]/g,""),n)),o=0,es(es(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(t.match(D1))return i=yn(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=_l(l,Math.pow(10,o)-1,!1),i=""+u,d=lr("n",s[1],a[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=El(a[2],o),d.length<s[4].length&&(d=Wt(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=_l(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?sd(a[1],o)+s[2]+"/"+s[3]+El(a[2],o):ut(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Ni(n,0),t.length<=i.length?i:Wt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,h=t.length-i.length-m;return Wt(t.substr(0,m)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=ih(n,s[1].length),n<0?"-"+yn(e,t,-n):Fr(aT(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?On(0,3-v.length):"")+v})+"."+On(o,s[1].length);switch(t){case"###,##0.00":return yn(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var g=Fr(Ni(l,0));return g!=="0"?u+g:"";case"###,###.00":return yn(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return yn(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function lT(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return lr(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function uT(e,t,n){var r=t.replace(k1,""),i=t.length-r.length;return lr(e,r,n*Math.pow(10,2*i))+ut("%",i)}function L1(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+L1(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!n.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,d){return l+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Jn(e,t,n){if(e.charCodeAt(0)===40&&!t.match(M1)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Jn("n",r,n):"("+Jn("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return lT(e,t,n);if(t.indexOf("%")!==-1)return uT(e,t,n);if(t.indexOf("E")!==-1)return L1(t,n);if(t.charCodeAt(0)===36)return"$"+Jn(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,o,a,l=Math.abs(n),u=n<0?"-":"";if(t.match(/^00+$/))return u+On(l,t.length);if(t.match(/^[#?]+$/))return i=""+n,n===0&&(i=""),i.length>t.length?i:Wt(t.substr(0,t.length-i.length))+i;if(s=t.match(P1))return sT(s,l,u);if(t.match(/^#+0+$/))return u+On(l,t.length-t.indexOf("0"));if(s=t.match(F1))return i=(""+n).replace(/^([^\.]+)$/,"$1."+Wt(s[1])).replace(/\.$/,"."+Wt(s[1])),i=i.replace(/\.(\d*)$/,function(v,x){return"."+x+ut("0",Wt(s[1]).length-x.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Fr(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Jn(e,t,-n):Fr(""+n)+"."+ut("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Jn(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=es(Jn(e,t.replace(/[\\-]/g,""),n)),o=0,es(es(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(t.match(D1))return i=Jn(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=_l(l,Math.pow(10,o)-1,!1),i=""+u,d=lr("n",s[1],a[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=El(a[2],o),d.length<s[4].length&&(d=Wt(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=_l(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?sd(a[1],o)+s[2]+"/"+s[3]+El(a[2],o):ut(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+n,t.length<=i.length?i:Wt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,h=t.length-i.length-m;return Wt(t.substr(0,m)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Jn(e,t,-n):Fr(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?On(0,3-v.length):"")+v})+"."+On(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=Fr(""+l);return g!=="0"?u+g:"";default:if(t.match(/\.[0#?]*$/))return Jn(e,t.slice(0,t.lastIndexOf(".")),n)+Wt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function lr(e,t,n){return(n|0)===n?Jn(e,t,n):yn(e,t,n)}function cT(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var b1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function U1(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":Tl(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=n;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(b1))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function fT(e,t,n,r){for(var i=[],s="",o=0,a="",l="t",u,d,m,h="H";o<e.length;)switch(a=e.charAt(o)){case"G":if(!Tl(e,o))throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(m=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(m);i[i.length]={t:"t",v:s},++o;break;case"\\":var g=e.charAt(++o),v=g==="("||g===")"?g:"t";i[i.length]={t:v,v:g},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Aa(t,n,e.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Aa(t,n),u==null))return"";for(s=a;++o<e.length&&e.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=h),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"":var x={t:a,v:a};if(u==null&&(u=Aa(t,n)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",o+=5,h="h"):(x.t="t",++o),u==null&&x.t==="T")return"";i[i.length]=x,l=a;break;case"[":for(s=a;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(b1)){if(u==null&&(u=Aa(t,n),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",U1(e)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=a;++o<e.length&&(a=e.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<e.length&&"0#?.,E+-%".indexOf(a=e.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;e.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:r===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"t",v:a},++o;break}var _=0,T=0,y;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=h,l="h",_<1&&(_=1);break;case"s":(y=i[o].v.match(/\.0+$/))&&(T=Math.max(T,y[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[o].v.match(/[Hh]/)&&(_=1),_<2&&i[o].v.match(/[Mm]/)&&(_=2),_<3&&i[o].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var E="",A;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=tT(i[o].t.charCodeAt(0),i[o].v,u,T),i[o].t="t";break;case"n":case"?":for(A=o+1;i[A]!=null&&((a=i[A].t)==="?"||a==="D"||(a===" "||a==="t")&&i[A+1]!=null&&(i[A+1].t==="?"||i[A+1].t==="t"&&i[A+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[A].v==="/"||i[A].v===" "&&i[A+1]!=null&&i[A+1].t=="?"));)i[o].v+=i[A].v,i[A]={v:"",t:";"},++A;E+=i[o].v,o=A-1;break;case"G":i[o].t="t",i[o].v=Xc(t,n);break}var b="",D,C;if(E.length>0){E.charCodeAt(0)==40?(D=t<0&&E.charCodeAt(0)===45?-t:t,C=lr("n",E,D)):(D=t<0&&r>1?-t:t,C=lr("n",E,D),D<0&&i[0]&&i[0].t=="t"&&(C=C.substr(1),i[0].v="-"+i[0].v)),A=C.length-1;var L=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){L=o;break}var P=i.length;if(L===i.length&&C.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(A>=i[o].v.length-1?(A-=i[o].v.length,i[o].v=C.substr(A+1,i[o].v.length)):A<0?i[o].v="":(i[o].v=C.substr(0,A+1),A=-1),i[o].t="t",P=o);A>=0&&P<i.length&&(i[P].v=C.substr(0,A+1)+i[P].v)}else if(L!==i.length&&C.indexOf("E")===-1){for(A=C.indexOf(".")-1,o=L;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(d=i[o].v.indexOf(".")>-1&&o===L?i[o].v.indexOf(".")-1:i[o].v.length-1,b=i[o].v.substr(d+1);d>=0;--d)A>=0&&(i[o].v.charAt(d)==="0"||i[o].v.charAt(d)==="#")&&(b=C.charAt(A--)+b);i[o].v=b,i[o].t="t",P=o}for(A>=0&&P<i.length&&(i[P].v=C.substr(0,A+1)+i[P].v),A=C.indexOf(".")+1,o=L;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==L)){for(d=i[o].v.indexOf(".")>-1&&o===L?i[o].v.indexOf(".")+1:0,b=i[o].v.substr(0,d);d<i[o].v.length;++d)A<C.length&&(b+=C.charAt(A++));i[o].v=b,i[o].t="t",P=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(D=r>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=lr(i[o].t,i[o].v,D),i[o].t="t");var U="";for(o=0;o!==i.length;++o)i[o]!=null&&(U+=i[o].v);return U}var sh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function oh(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function dT(e,t){var n=cT(e),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var s=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,s];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var o=n[0].match(sh),a=n[1].match(sh);return oh(t,o)?[r,n[0]]:oh(t,a)?[r,n[1]]:[r,n[o!=null&&a!=null?2:1]]}return[r,s]}function zr(e,t,n){n==null&&(n={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?r=n.dateNF:r=e;break;case"number":e==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:ct)[e],r==null&&(r=n.table&&n.table[nh[e]]||ct[nh[e]]),r==null&&(r=JE[e]||"General");break}if(Tl(r,0))return Xc(t,n);t instanceof Date&&(t=I1(t,n.date1904));var i=dT(r,t);if(Tl(i[1]))return Xc(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return fT(i[1],t,n,i[0])}function O1(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(ct[n]==null){t<0&&(t=n);continue}if(ct[n]==e){t=n;break}}t<0&&(t=391)}return ct[t]=e,t}function eu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&O1(e[t],t)}function tu(){ct=$E()}var B1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function hT(e){var t=typeof e=="number"?ct[e]:e;return t=t.replace(B1,"(\\d+)"),new RegExp("^"+t+"$")}function pT(e,t,n){var r=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(t.match(B1)||[]).forEach(function(m,h){var g=parseInt(n[h+1],10);switch(m.toLowerCase().charAt(0)){case"y":r=g;break;case"d":s=g;break;case"h":o=g;break;case"s":l=g;break;case"m":o>=0?a=g:i=g;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var u=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?u:r==-1&&i==-1&&s==-1?d:u+"T"+d}var mT=function(){var e={};e.version="1.2.0";function t(){for(var C=0,L=new Array(256),P=0;P!=256;++P)C=P,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,L[P]=C;return typeof Int32Array<"u"?new Int32Array(L):L}var n=t();function r(C){var L=0,P=0,U=0,W=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)W[U]=C[U];for(U=0;U!=256;++U)for(P=C[U],L=256+U;L<4096;L+=256)P=W[L]=P>>>8^C[P&255];var V=[];for(U=1;U!=16;++U)V[U-1]=typeof Int32Array<"u"?W.subarray(U*256,U*256+256):W.slice(U*256,U*256+256);return V}var i=r(n),s=i[0],o=i[1],a=i[2],l=i[3],u=i[4],d=i[5],m=i[6],h=i[7],g=i[8],v=i[9],x=i[10],_=i[11],T=i[12],y=i[13],E=i[14];function A(C,L){for(var P=L^-1,U=0,W=C.length;U<W;)P=P>>>8^n[(P^C.charCodeAt(U++))&255];return~P}function b(C,L){for(var P=L^-1,U=C.length-15,W=0;W<U;)P=E[C[W++]^P&255]^y[C[W++]^P>>8&255]^T[C[W++]^P>>16&255]^_[C[W++]^P>>>24]^x[C[W++]]^v[C[W++]]^g[C[W++]]^h[C[W++]]^m[C[W++]]^d[C[W++]]^u[C[W++]]^l[C[W++]]^a[C[W++]]^o[C[W++]]^s[C[W++]]^n[C[W++]];for(U+=15;W<U;)P=P>>>8^n[(P^C[W++])&255];return~P}function D(C,L){for(var P=L^-1,U=0,W=C.length,V=0,Y=0;U<W;)V=C.charCodeAt(U++),V<128?P=P>>>8^n[(P^V)&255]:V<2048?(P=P>>>8^n[(P^(192|V>>6&31))&255],P=P>>>8^n[(P^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,Y=C.charCodeAt(U++)&1023,P=P>>>8^n[(P^(240|V>>8&7))&255],P=P>>>8^n[(P^(128|V>>2&63))&255],P=P>>>8^n[(P^(128|Y>>6&15|(V&3)<<4))&255],P=P>>>8^n[(P^(128|Y&63))&255]):(P=P>>>8^n[(P^(224|V>>12&15))&255],P=P>>>8^n[(P^(128|V>>6&63))&255],P=P>>>8^n[(P^(128|V&63))&255]);return~P}return e.table=n,e.bstr=A,e.buf=b,e.str=D,e}(),$e=function(){var t={};t.version="1.2.1";function n(S,I){for(var w=S.split("/"),N=I.split("/"),k=0,R=0,z=Math.min(w.length,N.length);k<z;++k){if(R=w[k].length-N[k].length)return R;if(w[k]!=N[k])return w[k]<N[k]?-1:1}return w.length-N.length}function r(S){if(S.charAt(S.length-1)=="/")return S.slice(0,-1).indexOf("/")===-1?S:r(S.slice(0,-1));var I=S.lastIndexOf("/");return I===-1?S:S.slice(0,I+1)}function i(S){if(S.charAt(S.length-1)=="/")return i(S.slice(0,-1));var I=S.lastIndexOf("/");return I===-1?S:S.slice(I+1)}function s(S,I){typeof I=="string"&&(I=new Date(I));var w=I.getHours();w=w<<6|I.getMinutes(),w=w<<5|I.getSeconds()>>>1,S.write_shift(2,w);var N=I.getFullYear()-1980;N=N<<4|I.getMonth()+1,N=N<<5|I.getDate(),S.write_shift(2,N)}function o(S){var I=S.read_shift(2)&65535,w=S.read_shift(2)&65535,N=new Date,k=w&31;w>>>=5;var R=w&15;w>>>=4,N.setMilliseconds(0),N.setFullYear(w+1980),N.setMonth(R-1),N.setDate(k);var z=I&31;I>>>=5;var X=I&63;return I>>>=6,N.setHours(I),N.setMinutes(X),N.setSeconds(z<<1),N}function a(S){ln(S,0);for(var I={},w=0;S.l<=S.length-4;){var N=S.read_shift(2),k=S.read_shift(2),R=S.l+k,z={};switch(N){case 21589:w=S.read_shift(1),w&1&&(z.mtime=S.read_shift(4)),k>5&&(w&2&&(z.atime=S.read_shift(4)),w&4&&(z.ctime=S.read_shift(4))),z.mtime&&(z.mt=new Date(z.mtime*1e3));break}S.l=R,I[N]=z}return I}var l;function u(){return l||(l={})}function d(S,I){if(S[0]==80&&S[1]==75)return Fs(S,I);if((S[0]|32)==109&&(S[1]|32)==105)return ot(S,I);if(S.length<512)throw new Error("CFB file size "+S.length+" < 512");var w=3,N=512,k=0,R=0,z=0,X=0,G=0,q=[],J=S.slice(0,512);ln(J,0);var ne=m(J);switch(w=ne[0],w){case 3:N=512;break;case 4:N=4096;break;case 0:if(ne[1]==0)return Fs(S,I);default:throw new Error("Major Version: Expected 3 or 4 saw "+w)}N!==512&&(J=S.slice(0,N),ln(J,28));var fe=S.slice(0,N);h(J,w);var me=J.read_shift(4,"i");if(w===3&&me!==0)throw new Error("# Directory Sectors: Expected 0 saw "+me);J.l+=4,z=J.read_shift(4,"i"),J.l+=4,J.chk("00100000","Mini Stream Cutoff Size: "),X=J.read_shift(4,"i"),k=J.read_shift(4,"i"),G=J.read_shift(4,"i"),R=J.read_shift(4,"i");for(var se=-1,he=0;he<109&&(se=J.read_shift(4,"i"),!(se<0));++he)q[he]=se;var Re=g(S,N);_(G,R,Re,N,q);var et=y(Re,z,q,N);et[z].name="!Directory",k>0&&X!==Y&&(et[X].name="!MiniFAT"),et[q[0]].name="!FAT",et.fat_addrs=q,et.ssz=N;var tt={},Dt=[],Ds=[],Ls=[];E(z,et,Re,Dt,k,tt,Ds,X),v(Ds,Ls,Dt),Dt.shift();var bs={FileIndex:Ds,FullPaths:Ls};return I&&I.raw&&(bs.raw={header:fe,sectors:Re}),bs}function m(S){if(S[S.l]==80&&S[S.l+1]==75)return[0,0];S.chk(le,"Header Signature: "),S.l+=16;var I=S.read_shift(2,"u");return[S.read_shift(2,"u"),I]}function h(S,I){var w=9;switch(S.l+=2,w=S.read_shift(2)){case 9:if(I!=3)throw new Error("Sector Shift: Expected 9 saw "+w);break;case 12:if(I!=4)throw new Error("Sector Shift: Expected 12 saw "+w);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+w)}S.chk("0600","Mini Sector Shift: "),S.chk("000000000000","Reserved: ")}function g(S,I){for(var w=Math.ceil(S.length/I)-1,N=[],k=1;k<w;++k)N[k-1]=S.slice(k*I,(k+1)*I);return N[w-1]=S.slice(w*I),N}function v(S,I,w){for(var N=0,k=0,R=0,z=0,X=0,G=w.length,q=[],J=[];N<G;++N)q[N]=J[N]=N,I[N]=w[N];for(;X<J.length;++X)N=J[X],k=S[N].L,R=S[N].R,z=S[N].C,q[N]===N&&(k!==-1&&q[k]!==k&&(q[N]=q[k]),R!==-1&&q[R]!==R&&(q[N]=q[R])),z!==-1&&(q[z]=N),k!==-1&&N!=q[N]&&(q[k]=q[N],J.lastIndexOf(k)<X&&J.push(k)),R!==-1&&N!=q[N]&&(q[R]=q[N],J.lastIndexOf(R)<X&&J.push(R));for(N=1;N<G;++N)q[N]===N&&(R!==-1&&q[R]!==R?q[N]=q[R]:k!==-1&&q[k]!==k&&(q[N]=q[k]));for(N=1;N<G;++N)if(S[N].type!==0){if(X=N,X!=q[X])do X=q[X],I[N]=I[X]+"/"+I[N];while(X!==0&&q[X]!==-1&&X!=q[X]);q[N]=-1}for(I[0]+="/",N=1;N<G;++N)S[N].type!==2&&(I[N]+="/")}function x(S,I,w){for(var N=S.start,k=S.size,R=[],z=N;w&&k>0&&z>=0;)R.push(I.slice(z*V,z*V+V)),k-=V,z=ti(w,z*4);return R.length===0?j(0):It(R).slice(0,S.size)}function _(S,I,w,N,k){var R=Y;if(S===Y){if(I!==0)throw new Error("DIFAT chain shorter than expected")}else if(S!==-1){var z=w[S],X=(N>>>2)-1;if(!z)return;for(var G=0;G<X&&(R=ti(z,G*4))!==Y;++G)k.push(R);_(ti(z,N-4),I-1,w,N,k)}}function T(S,I,w,N,k){var R=[],z=[];k||(k=[]);var X=N-1,G=0,q=0;for(G=I;G>=0;){k[G]=!0,R[R.length]=G,z.push(S[G]);var J=w[Math.floor(G*4/N)];if(q=G*4&X,N<4+q)throw new Error("FAT boundary crossed: "+G+" 4 "+N);if(!S[J])break;G=ti(S[J],q)}return{nodes:R,data:ph([z])}}function y(S,I,w,N){var k=S.length,R=[],z=[],X=[],G=[],q=N-1,J=0,ne=0,fe=0,me=0;for(J=0;J<k;++J)if(X=[],fe=J+I,fe>=k&&(fe-=k),!z[fe]){G=[];var se=[];for(ne=fe;ne>=0;){se[ne]=!0,z[ne]=!0,X[X.length]=ne,G.push(S[ne]);var he=w[Math.floor(ne*4/N)];if(me=ne*4&q,N<4+me)throw new Error("FAT boundary crossed: "+ne+" 4 "+N);if(!S[he]||(ne=ti(S[he],me),se[ne]))break}R[fe]={nodes:X,data:ph([G])}}return R}function E(S,I,w,N,k,R,z,X){for(var G=0,q=N.length?2:0,J=I[S].data,ne=0,fe=0,me;ne<J.length;ne+=128){var se=J.slice(ne,ne+128);ln(se,64),fe=se.read_shift(2),me=fd(se,0,fe-q),N.push(me);var he={name:me,type:se.read_shift(1),color:se.read_shift(1),L:se.read_shift(4,"i"),R:se.read_shift(4,"i"),C:se.read_shift(4,"i"),clsid:se.read_shift(16),state:se.read_shift(4,"i"),start:0,size:0},Re=se.read_shift(2)+se.read_shift(2)+se.read_shift(2)+se.read_shift(2);Re!==0&&(he.ct=A(se,se.l-8));var et=se.read_shift(2)+se.read_shift(2)+se.read_shift(2)+se.read_shift(2);et!==0&&(he.mt=A(se,se.l-8)),he.start=se.read_shift(4,"i"),he.size=se.read_shift(4,"i"),he.size<0&&he.start<0&&(he.size=he.type=0,he.start=Y,he.name=""),he.type===5?(G=he.start,k>0&&G!==Y&&(I[G].name="!StreamData")):he.size>=4096?(he.storage="fat",I[he.start]===void 0&&(I[he.start]=T(w,he.start,I.fat_addrs,I.ssz)),I[he.start].name=he.name,he.content=I[he.start].data.slice(0,he.size)):(he.storage="minifat",he.size<0?he.size=0:G!==Y&&he.start!==Y&&I[G]&&(he.content=x(he,I[G].data,(I[X]||{}).data))),he.content&&ln(he.content,0),R[me]=he,z.push(he)}}function A(S,I){return new Date((cn(S,I+4)/1e7*Math.pow(2,32)+cn(S,I)/1e7-11644473600)*1e3)}function b(S,I){return u(),d(l.readFileSync(S),I)}function D(S,I){var w=I&&I.type;switch(w||Be&&Buffer.isBuffer(S)&&(w="buffer"),w||"base64"){case"file":return b(S,I);case"base64":return d(Un(mr(S)),I);case"binary":return d(Un(S),I)}return d(S,I)}function C(S,I){var w=I||{},N=w.root||"Root Entry";if(S.FullPaths||(S.FullPaths=[]),S.FileIndex||(S.FileIndex=[]),S.FullPaths.length!==S.FileIndex.length)throw new Error("inconsistent CFB structure");S.FullPaths.length===0&&(S.FullPaths[0]=N+"/",S.FileIndex[0]={name:N,type:5}),w.CLSID&&(S.FileIndex[0].clsid=w.CLSID),L(S)}function L(S){var I="Sh33tJ5";if(!$e.find(S,"/"+I)){var w=j(4);w[0]=55,w[1]=w[3]=50,w[2]=54,S.FileIndex.push({name:I,type:2,content:w,size:4,L:69,R:69,C:69}),S.FullPaths.push(S.FullPaths[0]+I),P(S)}}function P(S,I){C(S);for(var w=!1,N=!1,k=S.FullPaths.length-1;k>=0;--k){var R=S.FileIndex[k];switch(R.type){case 0:N?w=!0:(S.FileIndex.pop(),S.FullPaths.pop());break;case 1:case 2:case 5:N=!0,isNaN(R.R*R.L*R.C)&&(w=!0),R.R>-1&&R.L>-1&&R.R==R.L&&(w=!0);break;default:w=!0;break}}if(!(!w&&!I)){var z=new Date(1987,1,19),X=0,G=Object.create?Object.create(null):{},q=[];for(k=0;k<S.FullPaths.length;++k)G[S.FullPaths[k]]=!0,S.FileIndex[k].type!==0&&q.push([S.FullPaths[k],S.FileIndex[k]]);for(k=0;k<q.length;++k){var J=r(q[k][0]);N=G[J],N||(q.push([J,{name:i(J).replace("/",""),type:1,clsid:_e,ct:z,mt:z,content:null}]),G[J]=!0)}for(q.sort(function(me,se){return n(me[0],se[0])}),S.FullPaths=[],S.FileIndex=[],k=0;k<q.length;++k)S.FullPaths[k]=q[k][0],S.FileIndex[k]=q[k][1];for(k=0;k<q.length;++k){var ne=S.FileIndex[k],fe=S.FullPaths[k];if(ne.name=i(fe).replace("/",""),ne.L=ne.R=ne.C=-(ne.color=1),ne.size=ne.content?ne.content.length:0,ne.start=0,ne.clsid=ne.clsid||_e,k===0)ne.C=q.length>1?1:-1,ne.size=0,ne.type=5;else if(fe.slice(-1)=="/"){for(X=k+1;X<q.length&&r(S.FullPaths[X])!=fe;++X);for(ne.C=X>=q.length?-1:X,X=k+1;X<q.length&&r(S.FullPaths[X])!=r(fe);++X);ne.R=X>=q.length?-1:X,ne.type=1}else r(S.FullPaths[k+1]||"")==r(fe)&&(ne.R=k+1),ne.type=2}}}function U(S,I){var w=I||{};if(w.fileType=="mad")return at(S,w);switch(P(S),w.fileType){case"zip":return K(S,w)}var N=function(me){for(var se=0,he=0,Re=0;Re<me.FileIndex.length;++Re){var et=me.FileIndex[Re];if(et.content){var tt=et.content.length;tt>0&&(tt<4096?se+=tt+63>>6:he+=tt+511>>9)}}for(var Dt=me.FullPaths.length+3>>2,Ds=se+7>>3,Ls=se+127>>7,bs=Ds+he+Dt+Ls,Qr=bs+127>>7,hu=Qr<=109?0:Math.ceil((Qr-109)/127);bs+Qr+hu+127>>7>Qr;)hu=++Qr<=109?0:Math.ceil((Qr-109)/127);var nr=[1,hu,Qr,Ls,Dt,he,se,0];return me.FileIndex[0].size=se<<6,nr[7]=(me.FileIndex[0].start=nr[0]+nr[1]+nr[2]+nr[3]+nr[4]+nr[5])+(nr[6]+7>>3),nr}(S),k=j(N[7]<<9),R=0,z=0;{for(R=0;R<8;++R)k.write_shift(1,ue[R]);for(R=0;R<8;++R)k.write_shift(2,0);for(k.write_shift(2,62),k.write_shift(2,3),k.write_shift(2,65534),k.write_shift(2,9),k.write_shift(2,6),R=0;R<3;++R)k.write_shift(2,0);for(k.write_shift(4,0),k.write_shift(4,N[2]),k.write_shift(4,N[0]+N[1]+N[2]+N[3]-1),k.write_shift(4,0),k.write_shift(4,4096),k.write_shift(4,N[3]?N[0]+N[1]+N[2]-1:Y),k.write_shift(4,N[3]),k.write_shift(-4,N[1]?N[0]-1:Y),k.write_shift(4,N[1]),R=0;R<109;++R)k.write_shift(-4,R<N[2]?N[1]+R:-1)}if(N[1])for(z=0;z<N[1];++z){for(;R<236+z*127;++R)k.write_shift(-4,R<N[2]?N[1]+R:-1);k.write_shift(-4,z===N[1]-1?Y:z+1)}var X=function(me){for(z+=me;R<z-1;++R)k.write_shift(-4,R+1);me&&(++R,k.write_shift(-4,Y))};for(z=R=0,z+=N[1];R<z;++R)k.write_shift(-4,Ne.DIFSECT);for(z+=N[2];R<z;++R)k.write_shift(-4,Ne.FATSECT);X(N[3]),X(N[4]);for(var G=0,q=0,J=S.FileIndex[0];G<S.FileIndex.length;++G)J=S.FileIndex[G],J.content&&(q=J.content.length,!(q<4096)&&(J.start=z,X(q+511>>9)));for(X(N[6]+7>>3);k.l&511;)k.write_shift(-4,Ne.ENDOFCHAIN);for(z=R=0,G=0;G<S.FileIndex.length;++G)J=S.FileIndex[G],J.content&&(q=J.content.length,!(!q||q>=4096)&&(J.start=z,X(q+63>>6)));for(;k.l&511;)k.write_shift(-4,Ne.ENDOFCHAIN);for(R=0;R<N[4]<<2;++R){var ne=S.FullPaths[R];if(!ne||ne.length===0){for(G=0;G<17;++G)k.write_shift(4,0);for(G=0;G<3;++G)k.write_shift(4,-1);for(G=0;G<12;++G)k.write_shift(4,0);continue}J=S.FileIndex[R],R===0&&(J.start=J.size?J.start-1:Y);var fe=R===0&&w.root||J.name;if(q=2*(fe.length+1),k.write_shift(64,fe,"utf16le"),k.write_shift(2,q),k.write_shift(1,J.type),k.write_shift(1,J.color),k.write_shift(-4,J.L),k.write_shift(-4,J.R),k.write_shift(-4,J.C),J.clsid)k.write_shift(16,J.clsid,"hex");else for(G=0;G<4;++G)k.write_shift(4,0);k.write_shift(4,J.state||0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,J.start),k.write_shift(4,J.size),k.write_shift(4,0)}for(R=1;R<S.FileIndex.length;++R)if(J=S.FileIndex[R],J.size>=4096)if(k.l=J.start+1<<9,Be&&Buffer.isBuffer(J.content))J.content.copy(k,k.l,0,J.size),k.l+=J.size+511&-512;else{for(G=0;G<J.size;++G)k.write_shift(1,J.content[G]);for(;G&511;++G)k.write_shift(1,0)}for(R=1;R<S.FileIndex.length;++R)if(J=S.FileIndex[R],J.size>0&&J.size<4096)if(Be&&Buffer.isBuffer(J.content))J.content.copy(k,k.l,0,J.size),k.l+=J.size+63&-64;else{for(G=0;G<J.size;++G)k.write_shift(1,J.content[G]);for(;G&63;++G)k.write_shift(1,0)}if(Be)k.l=k.length;else for(;k.l<k.length;)k.write_shift(1,0);return k}function W(S,I){var w=S.FullPaths.map(function(G){return G.toUpperCase()}),N=w.map(function(G){var q=G.split("/");return q[q.length-(G.slice(-1)=="/"?2:1)]}),k=!1;I.charCodeAt(0)===47?(k=!0,I=w[0].slice(0,-1)+I):k=I.indexOf("/")!==-1;var R=I.toUpperCase(),z=k===!0?w.indexOf(R):N.indexOf(R);if(z!==-1)return S.FileIndex[z];var X=!R.match(Ca);for(R=R.replace(co,""),X&&(R=R.replace(Ca,"!")),z=0;z<w.length;++z)if((X?w[z].replace(Ca,"!"):w[z]).replace(co,"")==R||(X?N[z].replace(Ca,"!"):N[z]).replace(co,"")==R)return S.FileIndex[z];return null}var V=64,Y=-2,le="d0cf11e0a1b11ae1",ue=[208,207,17,224,161,177,26,225],_e="00000000000000000000000000000000",Ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:_e,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ee(S,I,w){u();var N=U(S,w);l.writeFileSync(I,N)}function ve(S){for(var I=new Array(S.length),w=0;w<S.length;++w)I[w]=String.fromCharCode(S[w]);return I.join("")}function Se(S,I){var w=U(S,I);switch(I&&I.type||"buffer"){case"file":return u(),l.writeFileSync(I.filename,w),w;case"binary":return typeof w=="string"?w:ve(w);case"base64":return bo(typeof w=="string"?w:ve(w));case"buffer":if(Be)return Buffer.isBuffer(w)?w:yr(w);case"array":return typeof w=="string"?Un(w):w}return w}var Fe;function F(S){try{var I=S.InflateRaw,w=new I;if(w._processChunk(new Uint8Array([3,0]),w._finishFlushFlag),w.bytesRead)Fe=S;else throw new Error("zlib does not expose bytesRead")}catch(N){console.error("cannot use native zlib: "+(N.message||N))}}function H(S,I){if(!Fe)return Rs(S,I);var w=Fe.InflateRaw,N=new w,k=N._processChunk(S.slice(S.l),N._finishFlushFlag);return S.l+=N.bytesRead,k}function B(S){return Fe?Fe.deflateRawSync(S):Zo(S)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Te(S){var I=(S<<1|S<<11)&139536|(S<<5|S<<15)&558144;return(I>>16|I>>8|I)&255}for(var Ee=typeof Uint8Array<"u",ce=Ee?new Uint8Array(256):[],qe=0;qe<256;++qe)ce[qe]=Te(qe);function De(S,I){var w=ce[S&255];return I<=8?w>>>8-I:(w=w<<8|ce[S>>8&255],I<=16?w>>>16-I:(w=w<<8|ce[S>>16&255],w>>>24-I))}function ft(S,I){var w=I&7,N=I>>>3;return(S[N]|(w<=6?0:S[N+1]<<8))>>>w&3}function Le(S,I){var w=I&7,N=I>>>3;return(S[N]|(w<=5?0:S[N+1]<<8))>>>w&7}function xn(S,I){var w=I&7,N=I>>>3;return(S[N]|(w<=4?0:S[N+1]<<8))>>>w&15}function Ke(S,I){var w=I&7,N=I>>>3;return(S[N]|(w<=3?0:S[N+1]<<8))>>>w&31}function ye(S,I){var w=I&7,N=I>>>3;return(S[N]|(w<=1?0:S[N+1]<<8))>>>w&127}function Ht(S,I,w){var N=I&7,k=I>>>3,R=(1<<w)-1,z=S[k]>>>N;return w<8-N||(z|=S[k+1]<<8-N,w<16-N)||(z|=S[k+2]<<16-N,w<24-N)||(z|=S[k+3]<<24-N),z&R}function vn(S,I,w){var N=I&7,k=I>>>3;return N<=5?S[k]|=(w&7)<<N:(S[k]|=w<<N&255,S[k+1]=(w&7)>>8-N),I+3}function Wn(S,I,w){var N=I&7,k=I>>>3;return w=(w&1)<<N,S[k]|=w,I+1}function _r(S,I,w){var N=I&7,k=I>>>3;return w<<=N,S[k]|=w&255,w>>>=8,S[k+1]=w,I+8}function Cs(S,I,w){var N=I&7,k=I>>>3;return w<<=N,S[k]|=w&255,w>>>=8,S[k+1]=w&255,S[k+2]=w>>>8,I+16}function As(S,I){var w=S.length,N=2*w>I?2*w:I+5,k=0;if(w>=I)return S;if(Be){var R=Z0(N);if(S.copy)S.copy(R);else for(;k<S.length;++k)R[k]=S[k];return R}else if(Ee){var z=new Uint8Array(N);if(z.set)z.set(S);else for(;k<w;++k)z[k]=S[k];return z}return S.length=N,S}function sn(S){for(var I=new Array(S),w=0;w<S;++w)I[w]=0;return I}function wi(S,I,w){var N=1,k=0,R=0,z=0,X=0,G=S.length,q=Ee?new Uint16Array(32):sn(32);for(R=0;R<32;++R)q[R]=0;for(R=G;R<w;++R)S[R]=0;G=S.length;var J=Ee?new Uint16Array(G):sn(G);for(R=0;R<G;++R)q[k=S[R]]++,N<k&&(N=k),J[R]=0;for(q[0]=0,R=1;R<=N;++R)q[R+16]=X=X+q[R-1]<<1;for(R=0;R<G;++R)X=S[R],X!=0&&(J[R]=q[X+16]++);var ne=0;for(R=0;R<G;++R)if(ne=S[R],ne!=0)for(X=De(J[R],N)>>N-ne,z=(1<<N+4-ne)-1;z>=0;--z)I[X|z<<ne]=ne&15|R<<4;return N}var Ci=Ee?new Uint16Array(512):sn(512),Ns=Ee?new Uint16Array(32):sn(32);if(!Ee){for(var er=0;er<512;++er)Ci[er]=0;for(er=0;er<32;++er)Ns[er]=0}(function(){for(var S=[],I=0;I<32;I++)S.push(5);wi(S,Ns,32);var w=[];for(I=0;I<=143;I++)w.push(8);for(;I<=255;I++)w.push(9);for(;I<=279;I++)w.push(7);for(;I<=287;I++)w.push(8);wi(w,Ci,288)})();var fu=function(){for(var I=Ee?new Uint8Array(32768):[],w=0,N=0;w<pe.length-1;++w)for(;N<pe[w+1];++N)I[N]=w;for(;N<32768;++N)I[N]=29;var k=Ee?new Uint8Array(259):[];for(w=0,N=0;w<Q.length-1;++w)for(;N<Q[w+1];++N)k[N]=w;function R(X,G){for(var q=0;q<X.length;){var J=Math.min(65535,X.length-q),ne=q+J==X.length;for(G.write_shift(1,+ne),G.write_shift(2,J),G.write_shift(2,~J&65535);J-- >0;)G[G.l++]=X[q++]}return G.l}function z(X,G){for(var q=0,J=0,ne=Ee?new Uint16Array(32768):[];J<X.length;){var fe=Math.min(65535,X.length-J);if(fe<10){for(q=vn(G,q,+(J+fe==X.length)),q&7&&(q+=8-(q&7)),G.l=q/8|0,G.write_shift(2,fe),G.write_shift(2,~fe&65535);fe-- >0;)G[G.l++]=X[J++];q=G.l*8;continue}q=vn(G,q,+(J+fe==X.length)+2);for(var me=0;fe-- >0;){var se=X[J];me=(me<<5^se)&32767;var he=-1,Re=0;if((he=ne[me])&&(he|=J&-32768,he>J&&(he-=32768),he<J))for(;X[he+Re]==X[J+Re]&&Re<250;)++Re;if(Re>2){se=k[Re],se<=22?q=_r(G,q,ce[se+1]>>1)-1:(_r(G,q,3),q+=5,_r(G,q,ce[se-23]>>5),q+=3);var et=se<8?0:se-4>>2;et>0&&(Cs(G,q,Re-Q[se]),q+=et),se=I[J-he],q=_r(G,q,ce[se]>>3),q-=3;var tt=se<4?0:se-2>>1;tt>0&&(Cs(G,q,J-he-pe[se]),q+=tt);for(var Dt=0;Dt<Re;++Dt)ne[me]=J&32767,me=(me<<5^X[J])&32767,++J;fe-=Re-1}else se<=143?se=se+48:q=Wn(G,q,1),q=_r(G,q,ce[se]),ne[me]=J&32767,++J}q=_r(G,q,0)-1}return G.l=(q+7)/8|0,G.l}return function(G,q){return G.length<8?R(G,q):z(G,q)}}();function Zo(S){var I=j(50+Math.floor(S.length*1.1)),w=fu(S,I);return I.slice(0,w)}var Is=Ee?new Uint16Array(32768):sn(32768),ea=Ee?new Uint16Array(32768):sn(32768),ta=Ee?new Uint16Array(128):sn(128),ks=1,na=1;function ra(S,I){var w=Ke(S,I)+257;I+=5;var N=Ke(S,I)+1;I+=5;var k=xn(S,I)+4;I+=4;for(var R=0,z=Ee?new Uint8Array(19):sn(19),X=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],G=1,q=Ee?new Uint8Array(8):sn(8),J=Ee?new Uint8Array(8):sn(8),ne=z.length,fe=0;fe<k;++fe)z[O[fe]]=R=Le(S,I),G<R&&(G=R),q[R]++,I+=3;var me=0;for(q[0]=0,fe=1;fe<=G;++fe)J[fe]=me=me+q[fe-1]<<1;for(fe=0;fe<ne;++fe)(me=z[fe])!=0&&(X[fe]=J[me]++);var se=0;for(fe=0;fe<ne;++fe)if(se=z[fe],se!=0){me=ce[X[fe]]>>8-se;for(var he=(1<<7-se)-1;he>=0;--he)ta[me|he<<se]=se&7|fe<<3}var Re=[];for(G=1;Re.length<w+N;)switch(me=ta[ye(S,I)],I+=me&7,me>>>=3){case 16:for(R=3+ft(S,I),I+=2,me=Re[Re.length-1];R-- >0;)Re.push(me);break;case 17:for(R=3+Le(S,I),I+=3;R-- >0;)Re.push(0);break;case 18:for(R=11+ye(S,I),I+=7;R-- >0;)Re.push(0);break;default:Re.push(me),G<me&&(G=me);break}var et=Re.slice(0,w),tt=Re.slice(w);for(fe=w;fe<286;++fe)et[fe]=0;for(fe=N;fe<30;++fe)tt[fe]=0;return ks=wi(et,Is,286),na=wi(tt,ea,30),I}function ia(S,I){if(S[0]==3&&!(S[1]&3))return[hi(I),2];for(var w=0,N=0,k=Z0(I||1<<18),R=0,z=k.length>>>0,X=0,G=0;!(N&1);){if(N=Le(S,w),w+=3,N>>>1)N>>1==1?(X=9,G=5):(w=ra(S,w),X=ks,G=na);else{w&7&&(w+=8-(w&7));var q=S[w>>>3]|S[(w>>>3)+1]<<8;if(w+=32,q>0)for(!I&&z<R+q&&(k=As(k,R+q),z=k.length);q-- >0;)k[R++]=S[w>>>3],w+=8;continue}for(;;){!I&&z<R+32767&&(k=As(k,R+32767),z=k.length);var J=Ht(S,w,X),ne=N>>>1==1?Ci[J]:Is[J];if(w+=ne&15,ne>>>=4,!(ne>>>8&255))k[R++]=ne;else{if(ne==256)break;ne-=257;var fe=ne<8?0:ne-4>>2;fe>5&&(fe=0);var me=R+Q[ne];fe>0&&(me+=Ht(S,w,fe),w+=fe),J=Ht(S,w,G),ne=N>>>1==1?Ns[J]:ea[J],w+=ne&15,ne>>>=4;var se=ne<4?0:ne-2>>1,he=pe[ne];for(se>0&&(he+=Ht(S,w,se),w+=se),!I&&z<me&&(k=As(k,me+100),z=k.length);R<me;)k[R]=k[R-he],++R}}}return I?[k,w+7>>>3]:[k.slice(0,R),w+7>>>3]}function Rs(S,I){var w=S.slice(S.l||0),N=ia(w,I);return S.l+=N[1],N[0]}function Ps(S,I){if(S)typeof console<"u"&&console.error(I);else throw new Error(I)}function Fs(S,I){var w=S;ln(w,0);var N=[],k=[],R={FileIndex:N,FullPaths:k};C(R,{root:I.root});for(var z=w.length-4;(w[z]!=80||w[z+1]!=75||w[z+2]!=5||w[z+3]!=6)&&z>=0;)--z;w.l=z+4,w.l+=4;var X=w.read_shift(2);w.l+=6;var G=w.read_shift(4);for(w.l=G,z=0;z<X;++z){w.l+=20;var q=w.read_shift(4),J=w.read_shift(4),ne=w.read_shift(2),fe=w.read_shift(2),me=w.read_shift(2);w.l+=8;var se=w.read_shift(4),he=a(w.slice(w.l+ne,w.l+ne+fe));w.l+=ne+fe+me;var Re=w.l;w.l=se+4,M(w,q,J,R,he),w.l=Re}return R}function M(S,I,w,N,k){S.l+=2;var R=S.read_shift(2),z=S.read_shift(2),X=o(S);if(R&8257)throw new Error("Unsupported ZIP encryption");for(var G=S.read_shift(4),q=S.read_shift(4),J=S.read_shift(4),ne=S.read_shift(2),fe=S.read_shift(2),me="",se=0;se<ne;++se)me+=String.fromCharCode(S[S.l++]);if(fe){var he=a(S.slice(S.l,S.l+fe));(he[21589]||{}).mt&&(X=he[21589].mt),((k||{})[21589]||{}).mt&&(X=k[21589].mt)}S.l+=fe;var Re=S.slice(S.l,S.l+q);switch(z){case 8:Re=H(S,J);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+z)}var et=!1;R&8&&(G=S.read_shift(4),G==134695760&&(G=S.read_shift(4),et=!0),q=S.read_shift(4),J=S.read_shift(4)),q!=I&&Ps(et,"Bad compressed size: "+I+" != "+q),J!=w&&Ps(et,"Bad uncompressed size: "+w+" != "+J),qn(N,me,Re,{unsafe:!0,mt:X})}function K(S,I){var w=I||{},N=[],k=[],R=j(1),z=w.compression?8:0,X=0,G=0,q=0,J=0,ne=0,fe=S.FullPaths[0],me=fe,se=S.FileIndex[0],he=[],Re=0;for(G=1;G<S.FullPaths.length;++G)if(me=S.FullPaths[G].slice(fe.length),se=S.FileIndex[G],!(!se.size||!se.content||me=="Sh33tJ5")){var et=J,tt=j(me.length);for(q=0;q<me.length;++q)tt.write_shift(1,me.charCodeAt(q)&127);tt=tt.slice(0,tt.l),he[ne]=mT.buf(se.content,0);var Dt=se.content;z==8&&(Dt=B(Dt)),R=j(30),R.write_shift(4,67324752),R.write_shift(2,20),R.write_shift(2,X),R.write_shift(2,z),se.mt?s(R,se.mt):R.write_shift(4,0),R.write_shift(-4,he[ne]),R.write_shift(4,Dt.length),R.write_shift(4,se.content.length),R.write_shift(2,tt.length),R.write_shift(2,0),J+=R.length,N.push(R),J+=tt.length,N.push(tt),J+=Dt.length,N.push(Dt),R=j(46),R.write_shift(4,33639248),R.write_shift(2,0),R.write_shift(2,20),R.write_shift(2,X),R.write_shift(2,z),R.write_shift(4,0),R.write_shift(-4,he[ne]),R.write_shift(4,Dt.length),R.write_shift(4,se.content.length),R.write_shift(2,tt.length),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(4,0),R.write_shift(4,et),Re+=R.l,k.push(R),Re+=tt.length,k.push(tt),++ne}return R=j(22),R.write_shift(4,101010256),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,ne),R.write_shift(2,ne),R.write_shift(4,Re),R.write_shift(4,J),R.write_shift(2,0),It([It(N),It(k),R])}var te={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(S,I){if(S.ctype)return S.ctype;var w=S.name||"",N=w.match(/\.([^\.]+)$/);return N&&te[N[1]]||I&&(N=(w=I).match(/[\.\\]([^\.\\])+$/),N&&te[N[1]])?te[N[1]]:"application/octet-stream"}function ge(S){for(var I=bo(S),w=[],N=0;N<I.length;N+=76)w.push(I.slice(N,N+76));return w.join(`\r
`)+`\r
`}function we(S){var I=S.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(q){var J=q.charCodeAt(0).toString(16).toUpperCase();return"="+(J.length==1?"0"+J:J)});I=I.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),I.charAt(0)==`
`&&(I="=0D"+I.slice(1)),I=I.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var w=[],N=I.split(`\r
`),k=0;k<N.length;++k){var R=N[k];if(R.length==0){w.push("");continue}for(var z=0;z<R.length;){var X=76,G=R.slice(z,z+X);G.charAt(X-1)=="="?X--:G.charAt(X-2)=="="?X-=2:G.charAt(X-3)=="="&&(X-=3),G=R.slice(z,z+X),z+=X,z<R.length&&(G+="="),w.push(G)}}return w.join(`\r
`)}function Ie(S){for(var I=[],w=0;w<S.length;++w){for(var N=S[w];w<=S.length&&N.charAt(N.length-1)=="=";)N=N.slice(0,N.length-1)+S[++w];I.push(N)}for(var k=0;k<I.length;++k)I[k]=I[k].replace(/[=][0-9A-Fa-f]{2}/g,function(R){return String.fromCharCode(parseInt(R.slice(1),16))});return Un(I.join(`\r
`))}function st(S,I,w){for(var N="",k="",R="",z,X=0;X<10;++X){var G=I[X];if(!G||G.match(/^\s*$/))break;var q=G.match(/^(.*?):\s*([^\s].*)$/);if(q)switch(q[1].toLowerCase()){case"content-location":N=q[2].trim();break;case"content-type":R=q[2].trim();break;case"content-transfer-encoding":k=q[2].trim();break}}switch(++X,k.toLowerCase()){case"base64":z=Un(mr(I.slice(X).join("")));break;case"quoted-printable":z=Ie(I.slice(X));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+k)}var J=qn(S,N.slice(w.length),z,{unsafe:!0});R&&(J.ctype=R)}function ot(S,I){if(ve(S.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var w=I&&I.root||"",N=(Be&&Buffer.isBuffer(S)?S.toString("binary"):ve(S)).split(`\r
`),k=0,R="";for(k=0;k<N.length;++k)if(R=N[k],!!/^Content-Location:/i.test(R)&&(R=R.slice(R.indexOf("file")),w||(w=R.slice(0,R.lastIndexOf("/")+1)),R.slice(0,w.length)!=w))for(;w.length>0&&(w=w.slice(0,w.length-1),w=w.slice(0,w.lastIndexOf("/")+1),R.slice(0,w.length)!=w););var z=(N[1]||"").match(/boundary="(.*?)"/);if(!z)throw new Error("MAD cannot find boundary");var X="--"+(z[1]||""),G=[],q=[],J={FileIndex:G,FullPaths:q};C(J);var ne,fe=0;for(k=0;k<N.length;++k){var me=N[k];me!==X&&me!==X+"--"||(fe++&&st(J,N.slice(ne,k),w),ne=k)}return J}function at(S,I){var w=I||{},N=w.boundary||"SheetJS";N="------="+N;for(var k=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+N.slice(2)+'"',"","",""],R=S.FullPaths[0],z=R,X=S.FileIndex[0],G=1;G<S.FullPaths.length;++G)if(z=S.FullPaths[G].slice(R.length),X=S.FileIndex[G],!(!X.size||!X.content||z=="Sh33tJ5")){z=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Re){return"_x"+Re.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Re){return"_u"+Re.charCodeAt(0).toString(16)+"_"});for(var q=X.content,J=Be&&Buffer.isBuffer(q)?q.toString("binary"):ve(q),ne=0,fe=Math.min(1024,J.length),me=0,se=0;se<=fe;++se)(me=J.charCodeAt(se))>=32&&me<128&&++ne;var he=ne>=fe*4/5;k.push(N),k.push("Content-Location: "+(w.root||"file:///C:/SheetJS/")+z),k.push("Content-Transfer-Encoding: "+(he?"quoted-printable":"base64")),k.push("Content-Type: "+ie(X,z)),k.push(""),k.push(he?we(J):ge(J))}return k.push(N+`--\r
`),k.join(`\r
`)}function tr(S){var I={};return C(I,S),I}function qn(S,I,w,N){var k=N&&N.unsafe;k||C(S);var R=!k&&$e.find(S,I);if(!R){var z=S.FullPaths[0];I.slice(0,z.length)==z?z=I:(z.slice(-1)!="/"&&(z+="/"),z=(z+I).replace("//","/")),R={name:i(I),type:2},S.FileIndex.push(R),S.FullPaths.push(z),k||$e.utils.cfb_gc(S)}return R.content=w,R.size=w?w.length:0,N&&(N.CLSID&&(R.clsid=N.CLSID),N.mt&&(R.mt=N.mt),N.ct&&(R.ct=N.ct)),R}function Xr(S,I){C(S);var w=$e.find(S,I);if(w){for(var N=0;N<S.FileIndex.length;++N)if(S.FileIndex[N]==w)return S.FileIndex.splice(N,1),S.FullPaths.splice(N,1),!0}return!1}function du(S,I,w){C(S);var N=$e.find(S,I);if(N){for(var k=0;k<S.FileIndex.length;++k)if(S.FileIndex[k]==N)return S.FileIndex[k].name=i(w),S.FullPaths[k]=w,!0}return!1}function Ms(S){P(S,!0)}return t.find=W,t.read=D,t.parse=d,t.write=Se,t.writeFile=ee,t.utils={cfb_new:tr,cfb_add:qn,cfb_del:Xr,cfb_mov:du,cfb_gc:Ms,ReadShift:ho,CheckField:rx,prep_blob:ln,bconcat:It,use_zlib:F,_deflateRaw:Zo,_inflateRaw:Rs,consts:Ne},t}();function gT(e){return typeof e=="string"?Zl(e):Array.isArray(e)?HE(e):e}function Ko(e,t,n){if(typeof Deno<"u"){if(n&&typeof t=="string")switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=Zl(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r=n=="utf8"?Oo(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var i=new Blob([gT(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(e);return a.open("w"),a.encoding="binary",Array.isArray(t)&&(t=Jo(t)),a.write(t),a.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Mt(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function ah(e,t){for(var n=[],r=Mt(e),i=0;i!==r.length;++i)n[e[r[i]][t]]==null&&(n[e[r[i]][t]]=r[i]);return n}function ad(e){for(var t=[],n=Mt(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function nu(e){for(var t=[],n=Mt(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}function xT(e){for(var t=[],n=Mt(e),r=0;r!==n.length;++r)t[e[n[r]]]==null&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}var Sl=new Date(1899,11,30,0,0,0);function nn(e,t){var n=e.getTime(),r=Sl.getTime()+(e.getTimezoneOffset()-Sl.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var V1=new Date,vT=Sl.getTime()+(V1.getTimezoneOffset()-Sl.getTimezoneOffset())*6e4,lh=V1.getTimezoneOffset();function G1(e){var t=new Date;return t.setTime(e*24*60*60*1e3+vT),t.getTimezoneOffset()!==lh&&t.setTime(t.getTime()+(t.getTimezoneOffset()-lh)*6e4),t}var uh=new Date("2017-02-19T19:06:09.000Z"),H1=isNaN(uh.getFullYear())?new Date("2/19/17"):uh,yT=H1.getFullYear()==2017;function Jt(e,t){var n=new Date(e);if(yT)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(H1.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ru(e,t){if(Be&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return n[s]||s})}catch{}for(var r=[],i=0;i!=e.length;++i)r.push(String.fromCharCode(e[i]));return r.join("")}function rn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=rn(e[n]));return t}function ut(e,t){for(var n="";n.length<t;)n+=e;return n}function ur(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return n=-n,s}),!isNaN(t=Number(r)))?t/n:t}var ET=["january","february","march","april","may","june","july","august","september","october","november","december"];function Uo(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return n;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&ET.indexOf(o)==-1)return n}else if(o.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||s>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}function Pe(e,t,n){if(e.FullPaths){if(typeof n=="string"){var r;return Be?r=yr(n):r=zE(n),$e.utils.cfb_add(e,t,r)}$e.utils.cfb_add(e,t,n)}else e.file(t,n)}function ld(){return $e.utils.cfb_new()}var gt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,TT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ud=ad(TT),cd=/[&<>'"]/g,_T=/[\u0000-\u0008\u000b-\u001f]/g;function He(e){var t=e+"";return t.replace(cd,function(n){return ud[n]}).replace(_T,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ch(e){return He(e).replace(/ /g,"_x0020_")}var z1=/[\u0000-\u001f]/g;function ST(e){var t=e+"";return t.replace(cd,function(n){return ud[n]}).replace(/\n/g,"<br/>").replace(z1,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function wT(e){var t=e+"";return t.replace(cd,function(n){return ud[n]}).replace(z1,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}function CT(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function AT(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function $u(e){for(var t="",n=0,r=0,i=0,s=0,o=0,a=0;n<e.length;){if(r=e.charCodeAt(n++),r<128){t+=String.fromCharCode(r);continue}if(i=e.charCodeAt(n++),r>191&&r<224){o=(r&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(n++),r<240){t+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(n++),a=((r&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(a&1023))}return t}function fh(e){var t=hi(2*e.length),n,r,i=1,s=0,o=0,a;for(r=0;r<e.length;r+=i)i=1,(a=e.charCodeAt(r))<128?n=a:a<224?(n=(a&31)*64+(e.charCodeAt(r+1)&63),i=2):a<240?(n=(a&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),i=3):(i=4,n=(a&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),n-=65536,o=55296+(n>>>10&1023),n=56320+(n&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=n%256,t[s++]=n>>>8;return t.slice(0,s).toString("ucs2")}function dh(e){return yr(e,"binary").toString("utf8")}var Na="foo bar baz",fo=Be&&(dh(Na)==$u(Na)&&dh||fh(Na)==$u(Na)&&fh)||$u,Oo=Be?function(e){return yr(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,i=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},NT=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)r=r.replace(e[i][0],e[i][1]);return r}}(),W1=/(^\s|\s$|\n)/;function kt(e,t){return"<"+e+(t.match(W1)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Bo(e){return Mt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function oe(e,t,n){return"<"+e+(n!=null?Bo(n):"")+(t!=null?(t.match(W1)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Qc(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function IT(e,t){switch(typeof e){case"string":var n=oe("vt:lpwstr",He(e));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return oe((e|0)==e?"vt:i4":"vt:r8",He(String(e)));case"boolean":return oe("vt:bool",e?"true":"false")}if(e instanceof Date)return oe("vt:filetime",Qc(e));throw new Error("Unable to serialize "+e)}var Tt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},vs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],un={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function kT(e,t){for(var n=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return r==2047?i==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}function RT(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=r?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var a=0;a<=5;++a,s/=256)e[n+a]=s&255;e[n+6]=(i&15)<<4|s&15,e[n+7]=i>>4|r}var hh=function(e){for(var t=[],n=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var i=0,s=e[0][r].length;i<s;i+=n)t.push.apply(t,e[0][r].slice(i,i+n));return t},ph=Be?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:yr(t)})):hh(e)}:hh,mh=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(Qs(e,i)));return r.join("").replace(co,"")},fd=Be?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(co,""):mh(e,t,n)}:mh,gh=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},q1=Be?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):gh(e,t,n)}:gh,xh=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(Pi(e,i)));return r.join("")},Yo=Be?function(t,n,r){return Buffer.isBuffer(t)?t.toString("utf8",n,r):xh(t,n,r)}:xh,$1=function(e,t){var n=cn(e,t);return n>0?Yo(e,t+4,t+4+n-1):""},J1=$1,K1=function(e,t){var n=cn(e,t);return n>0?Yo(e,t+4,t+4+n-1):""},Y1=K1,j1=function(e,t){var n=2*cn(e,t);return n>0?Yo(e,t+4,t+4+n-1):""},X1=j1,Q1=function(t,n){var r=cn(t,n);return r>0?fd(t,n+4,n+4+r):""},Z1=Q1,ex=function(e,t){var n=cn(e,t);return n>0?Yo(e,t+4,t+4+n):""},tx=ex,nx=function(e,t){return kT(e,t)},wl=nx,dd=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Be&&(J1=function(t,n){if(!Buffer.isBuffer(t))return $1(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},Y1=function(t,n){if(!Buffer.isBuffer(t))return K1(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},X1=function(t,n){if(!Buffer.isBuffer(t))return j1(t,n);var r=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r-1)},Z1=function(t,n){if(!Buffer.isBuffer(t))return Q1(t,n);var r=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r)},tx=function(t,n){if(!Buffer.isBuffer(t))return ex(t,n);var r=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+r)},wl=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):nx(t,n)},dd=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Pi=function(e,t){return e[t]},Qs=function(e,t){return e[t+1]*256+e[t]},PT=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},cn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ti=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},FT=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ho(e,t){var n="",r,i,s=[],o,a,l,u;switch(t){case"dbcs":if(u=this.l,Be&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)n+=String.fromCharCode(Qs(this,u)),u+=2;e*=2;break;case"utf8":n=Yo(this,this.l,this.l+e);break;case"utf16le":e*=2,n=fd(this,this.l,this.l+e);break;case"wstr":return ho.call(this,e,"dbcs");case"lpstr-ansi":n=J1(this,this.l),e=4+cn(this,this.l);break;case"lpstr-cp":n=Y1(this,this.l),e=4+cn(this,this.l);break;case"lpwstr":n=X1(this,this.l),e=4+2*cn(this,this.l);break;case"lpp4":e=4+cn(this,this.l),n=Z1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+cn(this,this.l),n=tx(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(o=Pi(this,this.l+e++))!==0;)s.push(wa(o));n=s.join("");break;case"_wstr":for(e=0,n="";(o=Qs(this,this.l+e))!==0;)s.push(wa(o)),e+=2;e+=2,n=s.join("");break;case"dbcs-cont":for(n="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Pi(this,u),this.l=u+1,a=ho.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(wa(Qs(this,u))),u+=2}n=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Pi(this,u),this.l=u+1,a=ho.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(wa(Pi(this,u))),u+=1}n=s.join("");break;default:switch(e){case 1:return r=Pi(this,this.l),this.l++,r;case 2:return r=(t==="i"?PT:Qs)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(r=(e>0?ti:FT)(this,this.l),this.l+=4,r):(i=cn(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=wl(this,this.l):i=wl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:n=q1(this,this.l,e);break}}return this.l+=e,n}var MT=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},DT=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},LT=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function bT(e,t,n){var r=0,i=0;if(n==="dbcs"){for(i=0;i!=t.length;++i)LT(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;r=t.length}else if(n==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(n==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,MT(this,t,this.l);break;case 8:if(r=8,n==="f"){RT(this,t,this.l);break}case 16:break;case-4:r=4,DT(this,t,this.l);break}return this.l+=r,this}function rx(e,t){var n=q1(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function ln(e,t){e.l=t,e.read_shift=ho,e.chk=rx,e.write_shift=bT}function Zn(e,t){e.l+=t}function j(e){var t=hi(e);return ln(t,0),t}function tn(){var e=[],t=Be?256:2048,n=function(u){var d=j(u);return ln(d,0),d},r=n(t),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},s=function(u){return r&&u<r.length-r.l?r:(i(),r=n(Math.max(u+1,t)))},o=function(){return i(),It(e)},a=function(u){i(),r=u,r.l==null&&(r.l=r.length),s(t)};return{next:s,push:a,end:o,_bufs:e}}function Z(e,t,n,r){var i=+t,s;if(!isNaN(i)){r||(r=kN[i].p||(n||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var o=e.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&dd(n)&&e.push(n)}}function po(e,t,n){var r=rn(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function vh(e,t,n){var r=rn(e);return r.s=po(r.s,t.s,n),r.e=po(r.e,t.s,n),r}function mo(e,t){if(e.cRel&&e.c<0)for(e=rn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=rn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=We(e);return!e.cRel&&e.cRel!=null&&(n=BT(n)),!e.rRel&&e.rRel!=null&&(n=UT(n)),n}function Ju(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Bt(e.s.c)+":"+(e.e.cRel?"":"$")+Bt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Pt(e.s.r)+":"+(e.e.rRel?"":"$")+Pt(e.e.r):mo(e.s,t.biff)+":"+mo(e.e,t.biff)}function hd(e){return parseInt(OT(e),10)-1}function Pt(e){return""+(e+1)}function UT(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function OT(e){return e.replace(/\$(\d+)$/,"$1")}function pd(e){for(var t=VT(e),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function Bt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function BT(e){return e.replace(/^([A-Z])/,"$$$1")}function VT(e){return e.replace(/^\$([A-Z])/,"$1")}function GT(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function _t(e){for(var t=0,n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function We(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function pn(e){var t=e.indexOf(":");return t==-1?{s:_t(e),e:_t(e)}:{s:_t(e.slice(0,t)),e:_t(e.slice(t+1))}}function mt(e,t){return typeof t>"u"||typeof t=="number"?mt(e.s,e.e):(typeof e!="string"&&(e=We(e)),typeof t!="string"&&(t=We(t)),e==t?e:e+":"+t)}function Qe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,s=e.length;for(n=0;r<s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.s.c=--n,n=0;r<s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(t.s.r=--n,r===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return t.e.r=--n,t}function yh(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=zr(e.z,n?nn(t):t)}catch{}try{return e.w=zr((e.XF||{}).numFmtId||(n?14:0),n?nn(t):t)}catch{return""+t}}function gr(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?jo[e.v]||e.v:t==null?yh(e,e.v):yh(e,t))}function vi(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function ix(e,t,n){var r=n||{},i=e?Array.isArray(e):r.dense,s=e||(i?[]:{}),o=0,a=0;if(s&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?_t(r.origin):r.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Qe(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[m].length;++h)if(!(typeof t[m][h]>"u")){var g={v:t[m][h]},v=o+m,x=a+h;if(u.s.r>v&&(u.s.r=v),u.s.c>x&&(u.s.c=x),u.e.r<v&&(u.e.r=v),u.e.c<x&&(u.e.c=x),t[m][h]&&typeof t[m][h]=="object"&&!Array.isArray(t[m][h])&&!(t[m][h]instanceof Date))g=t[m][h];else if(Array.isArray(g.v)&&(g.f=t[m][h][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(r.nullError)g.t="e",g.v=0;else if(r.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=r.dateNF||ct[14],r.cellDates?(g.t="d",g.w=zr(g.z,nn(g.v))):(g.t="n",g.v=nn(g.v),g.w=zr(g.z,g.v))):g.t="s";if(i)s[v]||(s[v]=[]),s[v][x]&&s[v][x].z&&(g.z=s[v][x].z),s[v][x]=g;else{var _=We({c:x,r:v});s[_]&&s[_].z&&(g.z=s[_].z),s[_]=g}}}return u.s.c<1e7&&(s["!ref"]=mt(u)),s}function ys(e,t){return ix(null,e,t)}function HT(e){return e.read_shift(4,"i")}function Gn(e,t){return t||(t=j(4)),t.write_shift(4,e),t}function Vt(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function St(e,t){var n=!1;return t==null&&(n=!0,t=j(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function zT(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function WT(e,t){return t||(t=j(4)),t.write_shift(2,0),t.write_shift(2,0),t}function md(e,t){var n=e.l,r=e.read_shift(1),i=Vt(e),s=[],o={t:i,h:i};if(r&1){for(var a=e.read_shift(4),l=0;l!=a;++l)s.push(zT(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=n+t,o}function qT(e,t){var n=!1;return t==null&&(n=!0,t=j(15+4*e.t.length)),t.write_shift(1,0),St(e.t,t),n?t.slice(0,t.l):t}var $T=md;function JT(e,t){var n=!1;return t==null&&(n=!0,t=j(23+4*e.t.length)),t.write_shift(1,1),St(e.t,t),t.write_shift(4,1),WT({},t),n?t.slice(0,t.l):t}function Rn(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function yi(e,t){return t==null&&(t=j(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ei(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ti(e,t){return t==null&&(t=j(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var KT=Vt,sx=St;function gd(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Cl(e,t){var n=!1;return t==null&&(n=!0,t=j(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var YT=Vt,Zc=gd,xd=Cl;function ox(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,r=t[0]&2;e.l+=4;var i=r===0?wl([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ti(t,0)>>2;return n?i/100:i}function ax(e,t){t==null&&(t=j(4));var n=0,r=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,n=1),r)t.write_shift(-4,((n?i:e)<<2)+(n+2));else throw new Error("unsupported RkNumber "+e)}function lx(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function jT(e,t){return t||(t=j(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var _i=lx,Es=jT;function Ts(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function pi(e,t){return(t||j(8)).write_shift(8,e,"f")}function XT(e){var t={},n=e.read_shift(1),r=n>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),a=e.read_shift(1),l=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=i;var u=o_[i];u&&(t.rgb=Rh(u));break;case 2:t.rgb=Rh([o,a,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Al(e,t){if(t||(t=j(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}return t}function QT(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function ZT(e,t){t||(t=j(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,n),t.write_shift(1,0),t}var ux=2,on=3,Ia=11,Nl=19,ka=64,e_=65,t_=71,n_=4108,r_=4126,Nt=80,Eh={1:{n:"CodePage",t:ux},2:{n:"Category",t:Nt},3:{n:"PresentationFormat",t:Nt},4:{n:"ByteCount",t:on},5:{n:"LineCount",t:on},6:{n:"ParagraphCount",t:on},7:{n:"SlideCount",t:on},8:{n:"NoteCount",t:on},9:{n:"HiddenCount",t:on},10:{n:"MultimediaClipCount",t:on},11:{n:"ScaleCrop",t:Ia},12:{n:"HeadingPairs",t:n_},13:{n:"TitlesOfParts",t:r_},14:{n:"Manager",t:Nt},15:{n:"Company",t:Nt},16:{n:"LinksUpToDate",t:Ia},17:{n:"CharacterCount",t:on},19:{n:"SharedDoc",t:Ia},22:{n:"HyperlinksChanged",t:Ia},23:{n:"AppVersion",t:on,p:"version"},24:{n:"DigSig",t:e_},26:{n:"ContentType",t:Nt},27:{n:"ContentStatus",t:Nt},28:{n:"Language",t:Nt},29:{n:"Version",t:Nt},255:{},2147483648:{n:"Locale",t:Nl},2147483651:{n:"Behavior",t:Nl},1919054434:{}},Th={1:{n:"CodePage",t:ux},2:{n:"Title",t:Nt},3:{n:"Subject",t:Nt},4:{n:"Author",t:Nt},5:{n:"Keywords",t:Nt},6:{n:"Comments",t:Nt},7:{n:"Template",t:Nt},8:{n:"LastAuthor",t:Nt},9:{n:"RevNumber",t:Nt},10:{n:"EditTime",t:ka},11:{n:"LastPrinted",t:ka},12:{n:"CreatedDate",t:ka},13:{n:"ModifiedDate",t:ka},14:{n:"PageCount",t:on},15:{n:"WordCount",t:on},16:{n:"CharCount",t:on},17:{n:"Thumbnail",t:t_},18:{n:"Application",t:Nt},19:{n:"DocSecurity",t:on},255:{},2147483648:{n:"Locale",t:Nl},2147483651:{n:"Behavior",t:Nl},1919054434:{}};function i_(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var s_=i_([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),o_=rn(s_),jo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},a_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ra={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function cx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function fx(e,t){var n=xT(a_),r=[],i;r[r.length]=gt,r[r.length]=oe("Types",null,{xmlns:Tt.CT,"xmlns:xsd":Tt.xsd,"xmlns:xsi":Tt.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return oe("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],r[r.length]=oe("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Ra[l][t.bookType]||Ra[l].xlsx}))},o=function(l){(e[l]||[]).forEach(function(u){r[r.length]=oe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Ra[l][t.bookType]||Ra[l].xlsx})})},a=function(l){(e[l]||[]).forEach(function(u){r[r.length]=oe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:n[l][0]})})};return s("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var Ue={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function dx(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ts(e){var t=[gt,oe("Relationships",null,{xmlns:Tt.RELS})];return Mt(e["!id"]).forEach(function(n){t[t.length]=oe("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ge(e,t,n,r,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=n,[Ue.HLINK,Ue.XPATH,Ue.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function l_(e){var t=[gt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function _h(e,t,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function u_(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function c_(e){var t=[gt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=e.length;++n)t.push(_h(e[n][0],e[n][1])),t.push(u_("",e[n][0]));return t.push(_h("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function hx(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+vl.version+"</meta:generator></office:meta></office:document-meta>"}var ai=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Ku(e,t,n,r,i){i[e]!=null||t==null||t===""||(i[e]=t,t=He(t),r[r.length]=n?oe(e,t,n):kt(e,t))}function px(e,t){var n=t||{},r=[gt,oe("cp:coreProperties",null,{"xmlns:cp":Tt.CORE_PROPS,"xmlns:dc":Tt.dc,"xmlns:dcterms":Tt.dcterms,"xmlns:dcmitype":Tt.dcmitype,"xmlns:xsi":Tt.xsi})],i={};if(!e&&!n.Props)return r.join("");e&&(e.CreatedDate!=null&&Ku("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Qc(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),e.ModifiedDate!=null&&Ku("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Qc(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=ai.length;++s){var o=ai[s],a=n.Props&&n.Props[o[1]]!=null?n.Props[o[1]]:e?e[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&Ku(o[0],a,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var ns=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],mx=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function gx(e){var t=[],n=oe;return e||(e={}),e.Application="SheetJS",t[t.length]=gt,t[t.length]=oe("Properties",null,{xmlns:Tt.EXT_PROPS,"xmlns:vt":Tt.vt}),ns.forEach(function(r){if(e[r[1]]!==void 0){var i;switch(r[2]){case"string":i=He(String(e[r[1]]));break;case"bool":i=e[r[1]]?"true":"false";break}i!==void 0&&(t[t.length]=n(r[0],i))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+He(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function xx(e){var t=[gt,oe("Properties",null,{xmlns:Tt.CUST_PROPS,"xmlns:vt":Tt.vt})];if(!e)return t.join("");var n=1;return Mt(e).forEach(function(i){++n,t[t.length]=oe("property",IT(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:He(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Sh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function f_(e,t){var n=[];return Mt(Sh).map(function(r){for(var i=0;i<ai.length;++i)if(ai[i][1]==r)return ai[i];for(i=0;i<ns.length;++i)if(ns[i][1]==r)return ns[i];throw r}).forEach(function(r){if(e[r[1]]!=null){var i=t&&t.Props&&t.Props[r[1]]!=null?t.Props[r[1]]:e[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(kt(Sh[r[1]]||r[1],i))}}),oe("DocumentProperties",n.join(""),{xmlns:un.o})}function d_(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return e&&Mt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<ai.length;++o)if(s==ai[o][1])return;for(o=0;o<ns.length;++o)if(s==ns[o][1])return;for(o=0;o<n.length;++o)if(s==n[o])return;var a=e[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(oe(ch(s),a,{"dt:dt":l}))}}),t&&Mt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(oe(ch(s),o,{"dt:dt":a}))}}),"<"+r+' xmlns="'+un.o+'">'+i.join("")+"</"+r+">"}function h_(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,n=t.getTime()/1e3+11644473600,r=n%Math.pow(2,32),i=(n-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var o=j(8);return o.write_shift(4,r),o.write_shift(4,i),o}function wh(e,t){var n=j(4),r=j(4);switch(n.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,t);break;case 5:r=j(8),r.write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=h_(t);break;case 31:case 80:for(r=j(4+2*(t.length+1)+(t.length%2?0:2)),r.write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return It([n,r])}var vx=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function p_(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Ch(e,t,n){var r=j(8),i=[],s=[],o=8,a=0,l=j(8),u=j(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),o+=8+l.length,!t){u=j(8),u.write_shift(4,0),i.unshift(u);var d=[j(4)];for(d[0].write_shift(4,e.length),a=0;a<e.length;++a){var m=e[a][0];for(l=j(8+2*(m.length+1)+(m.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,m.length+1),l.write_shift(0,m,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=It(d),s.unshift(l),o+=8+l.length}for(a=0;a<e.length;++a)if(!(t&&!t[e[a][0]])&&!(vx.indexOf(e[a][0])>-1||mx.indexOf(e[a][0])>-1)&&e[a][1]!=null){var h=e[a][1],g=0;if(t){g=+t[e[a][0]];var v=n[g];if(v.p=="version"&&typeof h=="string"){var x=h.split(".");h=(+x[0]<<16)+(+x[1]||0)}l=wh(v.t,h)}else{var _=p_(h);_==-1&&(_=31,h=String(h)),l=wh(_,h)}s.push(l),u=j(8),u.write_shift(4,t?g:2+a),i.push(u),o+=8+l.length}var T=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,T),T+=s[a].length;return r.write_shift(4,o),r.write_shift(4,s.length),It([r].concat(i).concat(s))}function Ah(e,t,n,r,i,s){var o=j(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,$e.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var l=Ch(e,n,r);if(a.push(l),i){var u=Ch(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+l.length),a.push(u)}return It(a)}function m_(e,t){t||(t=j(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}function g_(e,t){return e.read_shift(t)===1}function qt(e,t){return t||(t=j(2)),t.write_shift(2,+!!e),t}function yx(e){return e.read_shift(2,"u")}function Tn(e,t){return t||(t=j(2)),t.write_shift(2,e),t}function Ex(e,t,n){return n||(n=j(2)),n.write_shift(1,t=="e"?+e:+!!e),n.write_shift(1,t=="e"?1:0),n}function Tx(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else n.biff==12&&(i="wstr");n.biff>=2&&n.biff<=5&&(i="cpstr");var o=r?e.read_shift(r,i):"";return o}function x_(e){var t=e.t||"",n=j(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=j(2*t.length);r.write_shift(2*t.length,t,"utf16le");var i=[n,r];return It(i)}function v_(e,t,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function y_(e,t,n){var r=e.read_shift(n&&n.biff==2?1:2);return r===0?(e.l++,""):v_(e,r,n)}function E_(e,t,n){if(n.biff>5)return y_(e,t,n);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function _x(e,t,n){return n||(n=j(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function Nh(e,t){t||(t=j(6+e.length*2)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function T_(e){var t=j(512),n=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(n=0;n<o.length;++n)t.write_shift(4,o[n]);if(s==28)r=r.slice(1),Nh(r,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));var a=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(a.length+1)),n=0;n<a.length;++n)t.write_shift(2,a.charCodeAt(n));t.write_shift(2,0),s&8&&Nh(i>-1?r.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,r.charCodeAt(n+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function mi(e,t,n,r){return r||(r=j(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function __(e,t,n){var r=n.biff>8?4:2,i=e.read_shift(r),s=e.read_shift(r,"i"),o=e.read_shift(r,"i");return[i,s,o]}function S_(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2);return{s:{c:r,r:t},e:{c:i,r:n}}}function Sx(e,t){return t||(t=j(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function vd(e,t,n){var r=1536,i=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=j(i);return s.write_shift(2,r),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function w_(e,t){var n=!t||t.biff==8,r=j(n?112:54);for(r.write_shift(t.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function C_(e,t){var n=!t||t.biff>=8?2:1,r=j(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function A_(e,t){var n=j(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var r=[],i=0;i<e.length;++i)r[i]=x_(e[i]);var s=It([n].concat(r));return s.parts=[n.length].concat(r.map(function(o){return o.length})),s}function N_(){var e=j(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function I_(e){var t=j(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function k_(e,t){var n=e.name||"Arial",r=t&&t.biff==5,i=r?15+n.length:16+2*n.length,s=j(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,n.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),s}function R_(e,t,n,r){var i=j(10);return mi(e,t,r,i),i.write_shift(4,n),i}function P_(e,t,n,r,i){var s=!i||i.biff==8,o=j(8+ +s+(1+s)*n.length);return mi(e,t,r,o),o.write_shift(2,n.length),s&&o.write_shift(1,1),o.write_shift((1+s)*n.length,n,s?"utf16le":"sbcs"),o}function F_(e,t,n,r){var i=n&&n.biff==5;r||(r=j(i?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function M_(e,t){var n=t.biff==8||!t.biff?4:2,r=j(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function Ih(e,t,n,r){var i=n&&n.biff==5;r||(r=j(i?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function D_(e){var t=j(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function L_(e,t,n,r,i,s){var o=j(8);return mi(e,t,r,o),Ex(n,s,o),o}function b_(e,t,n,r){var i=j(14);return mi(e,t,r,i),pi(n,i),i}function U_(e,t,n){if(n.biff<8)return O_(e,t,n);for(var r=[],i=e.l+t,s=e.read_shift(n.biff>8?4:2);s--!==0;)r.push(__(e,n.biff>8?12:6,n));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function O_(e,t,n){e[e.l+1]==3&&e[e.l]++;var r=Tx(e,t,n);return r.charCodeAt(0)==3?r.slice(1):r}function B_(e){var t=j(2+e.length*8);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)Sx(e[n],t);return t}function V_(e){var t=j(24),n=_t(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return It([t,T_(e[1])])}function G_(e){var t=e[1].Tooltip,n=j(10+2*(t.length+1));n.write_shift(2,2048);var r=_t(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<t.length;++i)n.write_shift(2,t.charCodeAt(i));return n.write_shift(2,0),n}function H_(e){return e||(e=j(4)),e.write_shift(2,1),e.write_shift(2,1),e}function z_(e,t,n){if(!n.cellStyles)return Zn(e,t);var r=n&&n.biff>=12?4:2,i=e.read_shift(r),s=e.read_shift(r),o=e.read_shift(r),a=e.read_shift(r),l=e.read_shift(2);r==2&&(e.l+=2);var u={s:i,e:s,w:o,ixfe:a,flags:l};return(n.biff>=5||!n.biff)&&(u.level=l>>8&7),u}function W_(e,t){var n=j(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,e.width*256),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function q_(e){for(var t=j(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}function $_(e,t,n){var r=j(15);return Qo(r,e,t),r.write_shift(8,n,"f"),r}function J_(e,t,n){var r=j(9);return Qo(r,e,t),r.write_shift(2,n),r}var K_=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ad({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(a,l){var u=[],d=hi(1);switch(l.type){case"base64":d=Un(mr(a));break;case"binary":d=Un(a);break;case"buffer":case"array":d=a;break}ln(d,0);var m=d.read_shift(1),h=!!(m&136),g=!1,v=!1;switch(m){case 2:break;case 3:break;case 48:g=!0,h=!0;break;case 49:g=!0,h=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var x=0,_=521;m==2&&(x=d.read_shift(2)),d.l+=3,m!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),m!=2&&(_=d.read_shift(2));var T=d.read_shift(2),y=l.codepage||1252;m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=e[d[d.l]]),d.l+=1,d.l+=2),v&&(d.l+=36);for(var E=[],A={},b=Math.min(d.length,m==2?521:_-10-(g?264:0)),D=v?32:11;d.l<b&&d[d.l]!=13;)switch(A={},A.name=yl.utils.decode(y,d.slice(d.l,d.l+D)).replace(/[\u0000\r\n].*$/g,""),d.l+=D,A.type=String.fromCharCode(d.read_shift(1)),m!=2&&!v&&(A.offset=d.read_shift(4)),A.len=d.read_shift(1),m==2&&(A.offset=d.read_shift(2)),A.dec=d.read_shift(1),A.name.length&&E.push(A),m!=2&&(d.l+=v?13:14),A.type){case"B":(!g||A.len!=8)&&l.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(d[d.l]!==13&&(d.l=_-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=_;var C=0,L=0;for(u[0]=[],L=0;L!=E.length;++L)u[0][L]=E[L].name;for(;x-- >0;){if(d[d.l]===42){d.l+=T;continue}for(++d.l,u[++C]=[],L=0,L=0;L!=E.length;++L){var P=d.slice(d.l,d.l+E[L].len);d.l+=E[L].len,ln(P,0);var U=yl.utils.decode(y,P);switch(E[L].type){case"C":U.trim().length&&(u[C][L]=U.replace(/\s+$/,""));break;case"D":U.length===8?u[C][L]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):u[C][L]=U;break;case"F":u[C][L]=parseFloat(U.trim());break;case"+":case"I":u[C][L]=v?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":u[C][L]=!0;break;case"N":case"F":u[C][L]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));u[C][L]="##MEMO##"+(v?parseInt(U.trim(),10):P.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(u[C][L]=+U||0);break;case"@":u[C][L]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[C][L]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[C][L]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[C][L]=-P.read_shift(-8,"f");break;case"B":if(g&&E[L].len==8){u[C][L]=P.read_shift(8,"f");break}case"G":case"P":P.l+=E[L].len;break;case"0":if(E[L].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[L].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=E,u}function r(a,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var d=ys(n(a,u),u);return d["!cols"]=u.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete u.DBF,d}function i(a,l){try{return vi(r(a,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var u=l||{};if(+u.codepage>=0&&Lo(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=tn(),m=Fl(a,{header:1,raw:!0,cellDates:!0}),h=m[0],g=m.slice(1),v=a["!cols"]||[],x=0,_=0,T=0,y=1;for(x=0;x<h.length;++x){if(((v[x]||{}).DBF||{}).name){h[x]=v[x].DBF.name,++T;continue}if(h[x]!=null){if(++T,typeof h[x]=="number"&&(h[x]=h[x].toString(10)),typeof h[x]!="string")throw new Error("DBF Invalid column name "+h[x]+" |"+typeof h[x]+"|");if(h.indexOf(h[x])!==x){for(_=0;_<1024;++_)if(h.indexOf(h[x]+"_"+_)==-1){h[x]+="_"+_;break}}}}var E=Qe(a["!ref"]),A=[],b=[],D=[];for(x=0;x<=E.e.c-E.s.c;++x){var C="",L="",P=0,U=[];for(_=0;_<g.length;++_)g[_][x]!=null&&U.push(g[_][x]);if(U.length==0||h[x]==null){A[x]="?";continue}for(_=0;_<U.length;++_){switch(typeof U[_]){case"number":L="B";break;case"string":L="C";break;case"boolean":L="L";break;case"object":L=U[_]instanceof Date?"D":"C";break;default:L="C"}P=Math.max(P,String(U[_]).length),C=C&&C!=L?"C":L}P>250&&(P=250),L=((v[x]||{}).DBF||{}).type,L=="C"&&v[x].DBF.len>P&&(P=v[x].DBF.len),C=="B"&&L=="N"&&(C="N",D[x]=v[x].DBF.dec,P=v[x].DBF.len),b[x]=C=="C"||L=="N"?P:s[C]||0,y+=b[x],A[x]=C}var W=d.next(32);for(W.write_shift(4,318902576),W.write_shift(4,g.length),W.write_shift(2,296+32*T),W.write_shift(2,y),x=0;x<4;++x)W.write_shift(4,0);for(W.write_shift(4,0|(+t[C1]||3)<<8),x=0,_=0;x<h.length;++x)if(h[x]!=null){var V=d.next(32),Y=(h[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,Y,"sbcs"),V.write_shift(1,A[x]=="?"?"C":A[x],"sbcs"),V.write_shift(4,_),V.write_shift(1,b[x]||s[A[x]]||0),V.write_shift(1,D[x]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),_+=b[x]||s[A[x]]||0}var le=d.next(264);for(le.write_shift(4,13),x=0;x<65;++x)le.write_shift(4,0);for(x=0;x<g.length;++x){var ue=d.next(y);for(ue.write_shift(1,0),_=0;_<h.length;++_)if(h[_]!=null)switch(A[_]){case"L":ue.write_shift(1,g[x][_]==null?63:g[x][_]?84:70);break;case"B":ue.write_shift(8,g[x][_]||0,"f");break;case"N":var _e="0";for(typeof g[x][_]=="number"&&(_e=g[x][_].toFixed(D[_]||0)),T=0;T<b[_]-_e.length;++T)ue.write_shift(1,32);ue.write_shift(1,_e,"sbcs");break;case"D":g[x][_]?(ue.write_shift(4,("0000"+g[x][_].getFullYear()).slice(-4),"sbcs"),ue.write_shift(2,("00"+(g[x][_].getMonth()+1)).slice(-2),"sbcs"),ue.write_shift(2,("00"+g[x][_].getDate()).slice(-2),"sbcs")):ue.write_shift(8,"00000000","sbcs");break;case"C":var Ne=String(g[x][_]!=null?g[x][_]:"").slice(0,b[_]);for(ue.write_shift(1,Ne,"sbcs"),T=0;T<b[_]-Ne.length;++T)ue.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:r,from_sheet:o}}(),Y_=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Mt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(h,g){var v=e[g];return typeof v=="number"?Q0(v):v},r=function(h,g,v){var x=g.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return x==59?h:Q0(x)};e["|"]=254;function i(h,g){switch(g.type){case"base64":return s(mr(h),g);case"binary":return s(h,g);case"buffer":return s(Be&&Buffer.isBuffer(h)?h.toString("binary"):Jo(h),g);case"array":return s(ru(h),g)}throw new Error("Unrecognized type "+g.type)}function s(h,g){var v=h.split(/[\n\r]+/),x=-1,_=-1,T=0,y=0,E=[],A=[],b=null,D={},C=[],L=[],P=[],U=0,W;for(+g.codepage>=0&&Lo(+g.codepage);T!==v.length;++T){U=0;var V=v[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),Y=V.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),le=Y[0],ue;if(V.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&A.push(V.slice(3).replace(/;;/g,";"));break;case"C":var _e=!1,Ne=!1,ee=!1,ve=!1,Se=-1,Fe=-1;for(y=1;y<Y.length;++y)switch(Y[y].charAt(0)){case"A":break;case"X":_=parseInt(Y[y].slice(1))-1,Ne=!0;break;case"Y":for(x=parseInt(Y[y].slice(1))-1,Ne||(_=0),W=E.length;W<=x;++W)E[W]=[];break;case"K":ue=Y[y].slice(1),ue.charAt(0)==='"'?ue=ue.slice(1,ue.length-1):ue==="TRUE"?ue=!0:ue==="FALSE"?ue=!1:isNaN(ur(ue))?isNaN(Uo(ue).getDate())||(ue=Jt(ue)):(ue=ur(ue),b!==null&&U1(b)&&(ue=G1(ue))),_e=!0;break;case"E":ve=!0;var F=JS(Y[y].slice(1),{r:x,c:_});E[x][_]=[E[x][_],F];break;case"S":ee=!0,E[x][_]=[E[x][_],"S5S"];break;case"G":break;case"R":Se=parseInt(Y[y].slice(1))-1;break;case"C":Fe=parseInt(Y[y].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+V)}if(_e&&(E[x][_]&&E[x][_].length==2?E[x][_][0]=ue:E[x][_]=ue,b=null),ee){if(ve)throw new Error("SYLK shared formula cannot have own formula");var H=Se>-1&&E[Se][Fe];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");E[x][_][1]=KS(H[1],{r:x-Se,c:_-Fe})}break;case"F":var B=0;for(y=1;y<Y.length;++y)switch(Y[y].charAt(0)){case"X":_=parseInt(Y[y].slice(1))-1,++B;break;case"Y":for(x=parseInt(Y[y].slice(1))-1,W=E.length;W<=x;++W)E[W]=[];break;case"M":U=parseInt(Y[y].slice(1))/20;break;case"F":break;case"G":break;case"P":b=A[parseInt(Y[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=Y[y].slice(1).split(" "),W=parseInt(P[0],10);W<=parseInt(P[1],10);++W)U=parseInt(P[2],10),L[W-1]=U===0?{hidden:!0}:{wch:U},yd(L[W-1]);break;case"C":_=parseInt(Y[y].slice(1))-1,L[_]||(L[_]={});break;case"R":x=parseInt(Y[y].slice(1))-1,C[x]||(C[x]={}),U>0?(C[x].hpt=U,C[x].hpx=Ix(U)):U===0&&(C[x].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+V)}B<1&&(b=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+V)}}return C.length>0&&(D["!rows"]=C),L.length>0&&(D["!cols"]=L),g&&g.sheetRows&&(E=E.slice(0,g.sheetRows)),[E,D]}function o(h,g){var v=i(h,g),x=v[0],_=v[1],T=ys(x,g);return Mt(_).forEach(function(y){T[y]=_[y]}),T}function a(h,g){return vi(o(h,g),g)}function l(h,g,v,x){var _="C;Y"+(v+1)+";X"+(x+1)+";K";switch(h.t){case"n":_+=h.v||0,h.f&&!h.F&&(_+=";E"+Td(h.f,{r:v,c:x}));break;case"b":_+=h.v?"TRUE":"FALSE";break;case"e":_+=h.w||h.v;break;case"d":_+='"'+(h.w||h.v)+'"';break;case"s":_+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function u(h,g){g.forEach(function(v,x){var _="F;W"+(x+1)+" "+(x+1)+" ";v.hidden?_+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Il(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=kl(v.wpx)),typeof v.wch=="number"&&(_+=Math.round(v.wch))),_.charAt(_.length-1)!=" "&&h.push(_)})}function d(h,g){g.forEach(function(v,x){var _="F;";v.hidden?_+="M0;":v.hpt?_+="M"+20*v.hpt+";":v.hpx&&(_+="M"+20*Rl(v.hpx)+";"),_.length>2&&h.push(_+"R"+(x+1))})}function m(h,g){var v=["ID;PWXL;N;E"],x=[],_=Qe(h["!ref"]),T,y=Array.isArray(h),E=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),h["!cols"]&&u(v,h["!cols"]),h["!rows"]&&d(v,h["!rows"]),v.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var A=_.s.r;A<=_.e.r;++A)for(var b=_.s.c;b<=_.e.c;++b){var D=We({r:A,c:b});T=y?(h[A]||[])[b]:h[D],!(!T||T.v==null&&(!T.f||T.F))&&x.push(l(T,h,A,b))}return v.join(E)+E+x.join(E)+E+"E"+E}return{to_workbook:a,to_sheet:o,from_sheet:m}}(),j_=function(){function e(s,o){switch(o.type){case"base64":return t(mr(s),o);case"binary":return t(s,o);case"buffer":return t(Be&&Buffer.isBuffer(s)?s.toString("binary"):Jo(s),o);case"array":return t(ru(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var a=s.split(`
`),l=-1,u=-1,d=0,m=[];d!==a.length;++d){if(a[d].trim()==="BOT"){m[++l]=[],u=0;continue}if(!(l<0)){var h=a[d].trim().split(","),g=h[0],v=h[1];++d;for(var x=a[d]||"";(x.match(/["]/g)||[]).length&1&&d<a.length-1;)x+=`
`+a[++d];switch(x=x.trim(),+g){case-1:if(x==="BOT"){m[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?m[l][u]=!0:x==="FALSE"?m[l][u]=!1:isNaN(ur(v))?isNaN(Uo(v).getDate())?m[l][u]=v:m[l][u]=Jt(v):m[l][u]=ur(v),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),m[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function n(s,o){return ys(e(s,o),o)}function r(s,o){return vi(n(s,o),o)}var i=function(){var s=function(l,u,d,m,h){l.push(u),l.push(d+","+m),l.push('"'+h.replace(/"/g,'""')+'"')},o=function(l,u,d,m){l.push(u+","+d),l.push(u==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(l){var u=[],d=Qe(l["!ref"]),m,h=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var g=d.s.r;g<=d.e.r;++g){o(u,-1,0,"BOT");for(var v=d.s.c;v<=d.e.c;++v){var x=We({r:g,c:v});if(m=h?(l[g]||[])[v]:l[x],!m){o(u,1,0,"");continue}switch(m.t){case"n":var _=m.w;!_&&m.v!=null&&(_=m.v),_==null?m.f&&!m.F?o(u,1,0,"="+m.f):o(u,1,0,""):o(u,0,_,"V");break;case"b":o(u,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=zr(m.z||ct[14],nn(Jt(m.v)))),o(u,0,m.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var T=`\r
`,y=u.join(T);return y}}();return{to_workbook:r,to_sheet:n,from_sheet:i}}(),wx=function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(m,h){for(var g=m.split(`
`),v=-1,x=-1,_=0,T=[];_!==g.length;++_){var y=g[_].trim().split(":");if(y[0]==="cell"){var E=_t(y[1]);if(T.length<=E.r)for(v=T.length;v<=E.r;++v)T[v]||(T[v]=[]);switch(v=E.r,x=E.c,y[2]){case"t":T[v][x]=e(y[3]);break;case"v":T[v][x]=+y[3];break;case"vtf":var A=y[y.length-1];case"vtc":switch(y[3]){case"nl":T[v][x]=!!+y[4];break;default:T[v][x]=+y[4];break}y[2]=="vtf"&&(T[v][x]=[T[v][x],A])}}}return h&&h.sheetRows&&(T=T.slice(0,h.sheetRows)),T}function r(m,h){return ys(n(m,h),h)}function i(m,h){return vi(r(m,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(m){if(!m||!m["!ref"])return"";for(var h=[],g=[],v,x="",_=pn(m["!ref"]),T=Array.isArray(m),y=_.s.r;y<=_.e.r;++y)for(var E=_.s.c;E<=_.e.c;++E)if(x=We({r:y,c:E}),v=T?(m[y]||[])[E]:m[x],!(!v||v.v==null||v.t==="z")){switch(g=["cell",x,"t"],v.t){case"s":case"str":g.push(t(v.v));break;case"n":v.f?(g[2]="vtf",g[3]="n",g[4]=v.v,g[5]=t(v.f)):(g[2]="v",g[3]=v.v);break;case"b":g[2]="vt"+(v.f?"f":"c"),g[3]="nl",g[4]=v.v?"1":"0",g[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var A=nn(Jt(v.v));g[2]="vtc",g[3]="nd",g[4]=""+A,g[5]=v.w||zr(v.z||ct[14],A);break;case"e":continue}h.push(g.join(":"))}return h.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(m){return[s,o,a,o,u(m),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:d}}(),X_=function(){function e(d,m,h,g,v){v.raw?m[h][g]=d:d===""||(d==="TRUE"?m[h][g]=!0:d==="FALSE"?m[h][g]=!1:isNaN(ur(d))?isNaN(Uo(d).getDate())?m[h][g]=d:m[h][g]=Jt(d):m[h][g]=ur(d))}function t(d,m){var h=m||{},g=[];if(!d||d.length===0)return g;for(var v=d.split(/[\r\n]/),x=v.length-1;x>=0&&v[x].length===0;)--x;for(var _=10,T=0,y=0;y<=x;++y)T=v[y].indexOf(" "),T==-1?T=v[y].length:T++,_=Math.max(_,T);for(y=0;y<=x;++y){g[y]=[];var E=0;for(e(v[y].slice(0,_).trim(),g,y,E,h),E=1;E<=(v[y].length-_)/10+1;++E)e(v[y].slice(_+(E-1)*10,_+E*10).trim(),g,y,E,h)}return h.sheetRows&&(g=g.slice(0,h.sheetRows)),g}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(d){for(var m={},h=!1,g=0,v=0;g<d.length;++g)(v=d.charCodeAt(g))==34?h=!h:!h&&v in n&&(m[v]=(m[v]||0)+1);v=[];for(g in m)Object.prototype.hasOwnProperty.call(m,g)&&v.push([m[g],g]);if(!v.length){m=r;for(g in m)Object.prototype.hasOwnProperty.call(m,g)&&v.push([m[g],g])}return v.sort(function(x,_){return x[0]-_[0]||r[x[1]]-r[_[1]]}),n[v.pop()[1]]||44}function s(d,m){var h=m||{},g="",v=h.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(g=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(g=d.charAt(4),d=d.slice(6)):g=i(d.slice(0,1024)):h&&h.FS?g=h.FS:g=i(d.slice(0,1024));var _=0,T=0,y=0,E=0,A=0,b=g.charCodeAt(0),D=!1,C=0,L=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var P=h.dateNF!=null?hT(h.dateNF):null;function U(){var W=d.slice(E,A),V={};if(W.charAt(0)=='"'&&W.charAt(W.length-1)=='"'&&(W=W.slice(1,-1).replace(/""/g,'"')),W.length===0)V.t="z";else if(h.raw)V.t="s",V.v=W;else if(W.trim().length===0)V.t="s",V.v=W;else if(W.charCodeAt(0)==61)W.charCodeAt(1)==34&&W.charCodeAt(W.length-1)==34?(V.t="s",V.v=W.slice(2,-1).replace(/""/g,'"')):YS(W)?(V.t="n",V.f=W.slice(1)):(V.t="s",V.v=W);else if(W=="TRUE")V.t="b",V.v=!0;else if(W=="FALSE")V.t="b",V.v=!1;else if(!isNaN(y=ur(W)))V.t="n",h.cellText!==!1&&(V.w=W),V.v=y;else if(!isNaN(Uo(W).getDate())||P&&W.match(P)){V.z=h.dateNF||ct[14];var Y=0;P&&W.match(P)&&(W=pT(W,h.dateNF,W.match(P)||[]),Y=1),h.cellDates?(V.t="d",V.v=Jt(W,Y)):(V.t="n",V.v=nn(Jt(W,Y))),h.cellText!==!1&&(V.w=zr(V.z,V.v instanceof Date?nn(V.v):V.v)),h.cellNF||delete V.z}else V.t="s",V.v=W;if(V.t=="z"||(h.dense?(v[_]||(v[_]=[]),v[_][T]=V):v[We({c:T,r:_})]=V),E=A+1,L=d.charCodeAt(E),x.e.c<T&&(x.e.c=T),x.e.r<_&&(x.e.r=_),C==b)++T;else if(T=0,++_,h.sheetRows&&h.sheetRows<=_)return!0}e:for(;A<d.length;++A)switch(C=d.charCodeAt(A)){case 34:L===34&&(D=!D);break;case b:case 10:case 13:if(!D&&U())break e;break}return A-E>0&&U(),v["!ref"]=mt(x),v}function o(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,m):ys(t(d,m),m)}function a(d,m){var h="",g=m.type=="string"?[0,0,0,0]:uI(d,m);switch(m.type){case"base64":h=mr(d);break;case"binary":h=d;break;case"buffer":m.codepage==65001?h=d.toString("utf8"):m.codepage&&typeof yl<"u"||(h=Be&&Buffer.isBuffer(d)?d.toString("binary"):Jo(d));break;case"array":h=ru(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+m.type)}return g[0]==239&&g[1]==187&&g[2]==191?h=fo(h.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?h=fo(h):m.type=="binary"&&typeof yl<"u",h.slice(0,19)=="socialcalc:version:"?wx.to_sheet(m.type=="string"?h:fo(h),m):o(h,m)}function l(d,m){return vi(a(d,m),m)}function u(d){for(var m=[],h=Qe(d["!ref"]),g,v=Array.isArray(d),x=h.s.r;x<=h.e.r;++x){for(var _=[],T=h.s.c;T<=h.e.c;++T){var y=We({r:x,c:T});if(g=v?(d[x]||[])[T]:d[y],!g||g.v==null){_.push("          ");continue}for(var E=(g.w||(gr(g),g.w)||"").slice(0,10);E.length<10;)E+=" ";_.push(E+(T===0?" ":""))}m.push(_.join(""))}return m.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:u}}(),kh=function(){function e(F,H,B){if(F){ln(F,F.l||0);for(var O=B.Enum||Se;F.l<F.length;){var Q=F.read_shift(2),pe=O[Q]||O[65535],Te=F.read_shift(2),Ee=F.l+Te,ce=pe.f&&pe.f(F,Te,B);if(F.l=Ee,H(ce,pe,Q))return}}}function t(F,H){switch(H.type){case"base64":return n(Un(mr(F)),H);case"binary":return n(Un(F),H);case"buffer":case"array":return n(F,H)}throw"Unsupported type "+H.type}function n(F,H){if(!F)return F;var B=H||{},O=B.dense?[]:{},Q="Sheet1",pe="",Te=0,Ee={},ce=[],qe=[],De={s:{r:0,c:0},e:{r:0,c:0}},ft=B.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)B.Enum=Se,e(F,function(ye,Ht,vn){switch(vn){case 0:B.vers=ye,ye>=4096&&(B.qpro=!0);break;case 6:De=ye;break;case 204:ye&&(pe=ye);break;case 222:pe=ye;break;case 15:case 51:B.qpro||(ye[1].v=ye[1].v.slice(1));case 13:case 14:case 16:vn==14&&(ye[2]&112)==112&&(ye[2]&15)>1&&(ye[2]&15)<15&&(ye[1].z=B.dateNF||ct[14],B.cellDates&&(ye[1].t="d",ye[1].v=G1(ye[1].v))),B.qpro&&ye[3]>Te&&(O["!ref"]=mt(De),Ee[Q]=O,ce.push(Q),O=B.dense?[]:{},De={s:{r:0,c:0},e:{r:0,c:0}},Te=ye[3],Q=pe||"Sheet"+(Te+1),pe="");var Wn=B.dense?(O[ye[0].r]||[])[ye[0].c]:O[We(ye[0])];if(Wn){Wn.t=ye[1].t,Wn.v=ye[1].v,ye[1].z!=null&&(Wn.z=ye[1].z),ye[1].f!=null&&(Wn.f=ye[1].f);break}B.dense?(O[ye[0].r]||(O[ye[0].r]=[]),O[ye[0].r][ye[0].c]=ye[1]):O[We(ye[0])]=ye[1];break}},B);else if(F[2]==26||F[2]==14)B.Enum=Fe,F[2]==14&&(B.qpro=!0,F.l=0),e(F,function(ye,Ht,vn){switch(vn){case 204:Q=ye;break;case 22:ye[1].v=ye[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ye[3]>Te&&(O["!ref"]=mt(De),Ee[Q]=O,ce.push(Q),O=B.dense?[]:{},De={s:{r:0,c:0},e:{r:0,c:0}},Te=ye[3],Q="Sheet"+(Te+1)),ft>0&&ye[0].r>=ft)break;B.dense?(O[ye[0].r]||(O[ye[0].r]=[]),O[ye[0].r][ye[0].c]=ye[1]):O[We(ye[0])]=ye[1],De.e.c<ye[0].c&&(De.e.c=ye[0].c),De.e.r<ye[0].r&&(De.e.r=ye[0].r);break;case 27:ye[14e3]&&(qe[ye[14e3][0]]=ye[14e3][1]);break;case 1537:qe[ye[0]]=ye[1],ye[0]==Te&&(Q=ye[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(O["!ref"]=mt(De),Ee[pe||Q]=O,ce.push(pe||Q),!qe.length)return{SheetNames:ce,Sheets:Ee};for(var Le={},xn=[],Ke=0;Ke<qe.length;++Ke)Ee[ce[Ke]]?(xn.push(qe[Ke]||ce[Ke]),Le[qe[Ke]]=Ee[qe[Ke]]||Ee[ce[Ke]]):(xn.push(qe[Ke]),Le[qe[Ke]]={"!ref":"A1"});return{SheetNames:xn,Sheets:Le}}function r(F,H){var B=H||{};if(+B.codepage>=0&&Lo(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var O=tn(),Q=Qe(F["!ref"]),pe=Array.isArray(F),Te=[];ae(O,0,s(1030)),ae(O,6,l(Q));for(var Ee=Math.min(Q.e.r,8191),ce=Q.s.r;ce<=Ee;++ce)for(var qe=Pt(ce),De=Q.s.c;De<=Q.e.c;++De){ce===Q.s.r&&(Te[De]=Bt(De));var ft=Te[De]+qe,Le=pe?(F[ce]||[])[De]:F[ft];if(!(!Le||Le.t=="z"))if(Le.t=="n")(Le.v|0)==Le.v&&Le.v>=-32768&&Le.v<=32767?ae(O,13,g(ce,De,Le.v)):ae(O,14,x(ce,De,Le.v));else{var xn=gr(Le);ae(O,15,m(ce,De,xn.slice(0,239)))}}return ae(O,1),O.end()}function i(F,H){var B=H||{};if(+B.codepage>=0&&Lo(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var O=tn();ae(O,0,o(F));for(var Q=0,pe=0;Q<F.SheetNames.length;++Q)(F.Sheets[F.SheetNames[Q]]||{})["!ref"]&&ae(O,27,ve(F.SheetNames[Q],pe++));var Te=0;for(Q=0;Q<F.SheetNames.length;++Q){var Ee=F.Sheets[F.SheetNames[Q]];if(!(!Ee||!Ee["!ref"])){for(var ce=Qe(Ee["!ref"]),qe=Array.isArray(Ee),De=[],ft=Math.min(ce.e.r,8191),Le=ce.s.r;Le<=ft;++Le)for(var xn=Pt(Le),Ke=ce.s.c;Ke<=ce.e.c;++Ke){Le===ce.s.r&&(De[Ke]=Bt(Ke));var ye=De[Ke]+xn,Ht=qe?(Ee[Le]||[])[Ke]:Ee[ye];if(!(!Ht||Ht.t=="z"))if(Ht.t=="n")ae(O,23,U(Le,Ke,Te,Ht.v));else{var vn=gr(Ht);ae(O,22,C(Le,Ke,Te,vn.slice(0,239)))}}++Te}}return ae(O,1),O.end()}function s(F){var H=j(2);return H.write_shift(2,F),H}function o(F){var H=j(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var B=0,O=0,Q=0,pe=0;pe<F.SheetNames.length;++pe){var Te=F.SheetNames[pe],Ee=F.Sheets[Te];if(!(!Ee||!Ee["!ref"])){++Q;var ce=pn(Ee["!ref"]);B<ce.e.r&&(B=ce.e.r),O<ce.e.c&&(O=ce.e.c)}}return B>8191&&(B=8191),H.write_shift(2,B),H.write_shift(1,Q),H.write_shift(1,O),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function a(F,H,B){var O={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&B.qpro?(O.s.c=F.read_shift(1),F.l++,O.s.r=F.read_shift(2),O.e.c=F.read_shift(1),F.l++,O.e.r=F.read_shift(2),O):(O.s.c=F.read_shift(2),O.s.r=F.read_shift(2),H==12&&B.qpro&&(F.l+=2),O.e.c=F.read_shift(2),O.e.r=F.read_shift(2),H==12&&B.qpro&&(F.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function l(F){var H=j(8);return H.write_shift(2,F.s.c),H.write_shift(2,F.s.r),H.write_shift(2,F.e.c),H.write_shift(2,F.e.r),H}function u(F,H,B){var O=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(O[0].c=F.read_shift(1),O[3]=F.read_shift(1),O[0].r=F.read_shift(2),F.l+=2):(O[2]=F.read_shift(1),O[0].c=F.read_shift(2),O[0].r=F.read_shift(2)),O}function d(F,H,B){var O=F.l+H,Q=u(F,H,B);if(Q[1].t="s",B.vers==20768){F.l++;var pe=F.read_shift(1);return Q[1].v=F.read_shift(pe,"utf8"),Q}return B.qpro&&F.l++,Q[1].v=F.read_shift(O-F.l,"cstr"),Q}function m(F,H,B){var O=j(7+B.length);O.write_shift(1,255),O.write_shift(2,H),O.write_shift(2,F),O.write_shift(1,39);for(var Q=0;Q<O.length;++Q){var pe=B.charCodeAt(Q);O.write_shift(1,pe>=128?95:pe)}return O.write_shift(1,0),O}function h(F,H,B){var O=u(F,H,B);return O[1].v=F.read_shift(2,"i"),O}function g(F,H,B){var O=j(7);return O.write_shift(1,255),O.write_shift(2,H),O.write_shift(2,F),O.write_shift(2,B,"i"),O}function v(F,H,B){var O=u(F,H,B);return O[1].v=F.read_shift(8,"f"),O}function x(F,H,B){var O=j(13);return O.write_shift(1,255),O.write_shift(2,H),O.write_shift(2,F),O.write_shift(8,B,"f"),O}function _(F,H,B){var O=F.l+H,Q=u(F,H,B);if(Q[1].v=F.read_shift(8,"f"),B.qpro)F.l=O;else{var pe=F.read_shift(2);A(F.slice(F.l,F.l+pe),Q),F.l+=pe}return Q}function T(F,H,B){var O=H&32768;return H&=-32769,H=(O?F:0)+(H>=8192?H-16384:H),(O?"":"$")+(B?Bt(H):Pt(H))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(F,H){ln(F,0);for(var B=[],O=0,Q="",pe="",Te="",Ee="";F.l<F.length;){var ce=F[F.l++];switch(ce){case 0:B.push(F.read_shift(8,"f"));break;case 1:pe=T(H[0].c,F.read_shift(2),!0),Q=T(H[0].r,F.read_shift(2),!1),B.push(pe+Q);break;case 2:{var qe=T(H[0].c,F.read_shift(2),!0),De=T(H[0].r,F.read_shift(2),!1);pe=T(H[0].c,F.read_shift(2),!0),Q=T(H[0].r,F.read_shift(2),!1),B.push(qe+De+":"+pe+Q)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(F.read_shift(2));break;case 6:{for(var ft="";ce=F[F.l++];)ft+=String.fromCharCode(ce);B.push('"'+ft.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:Ee=B.pop(),Te=B.pop(),B.push(["AND","OR"][ce-20]+"("+Te+","+Ee+")");break;default:if(ce<32&&E[ce])Ee=B.pop(),Te=B.pop(),B.push(Te+E[ce]+Ee);else if(y[ce]){if(O=y[ce][1],O==69&&(O=F[F.l++]),O>B.length){console.error("WK1 bad formula parse 0x"+ce.toString(16)+":|"+B.join("|")+"|");return}var Le=B.slice(-O);B.length-=O,B.push(y[ce][0]+"("+Le.join(",")+")")}else return ce<=7?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=24?console.error("WK1 unsupported op "+ce.toString(16)):ce<=30?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=115?console.error("WK1 unsupported function opcode "+ce.toString(16)):console.error("WK1 unrecognized opcode "+ce.toString(16))}}B.length==1?H[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function b(F){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=F.read_shift(2),H[3]=F[F.l++],H[0].c=F[F.l++],H}function D(F,H){var B=b(F);return B[1].t="s",B[1].v=F.read_shift(H-4,"cstr"),B}function C(F,H,B,O){var Q=j(6+O.length);Q.write_shift(2,F),Q.write_shift(1,B),Q.write_shift(1,H),Q.write_shift(1,39);for(var pe=0;pe<O.length;++pe){var Te=O.charCodeAt(pe);Q.write_shift(1,Te>=128?95:Te)}return Q.write_shift(1,0),Q}function L(F,H){var B=b(F);B[1].v=F.read_shift(2);var O=B[1].v>>1;if(B[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return B[1].v=O,B}function P(F,H){var B=b(F),O=F.read_shift(4),Q=F.read_shift(4),pe=F.read_shift(2);if(pe==65535)return O===0&&Q===3221225472?(B[1].t="e",B[1].v=15):O===0&&Q===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var Te=pe&32768;return pe=(pe&32767)-16446,B[1].v=(1-Te*2)*(Q*Math.pow(2,pe+32)+O*Math.pow(2,pe)),B}function U(F,H,B,O){var Q=j(14);if(Q.write_shift(2,F),Q.write_shift(1,B),Q.write_shift(1,H),O==0)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var pe=0,Te=0,Ee=0,ce=0;return O<0&&(pe=1,O=-O),Te=Math.log2(O)|0,O/=Math.pow(2,Te-31),ce=O>>>0,ce&2147483648||(O/=2,++Te,ce=O>>>0),O-=ce,ce|=2147483648,ce>>>=0,O*=Math.pow(2,32),Ee=O>>>0,Q.write_shift(4,Ee),Q.write_shift(4,ce),Te+=16383+(pe?32768:0),Q.write_shift(2,Te),Q}function W(F,H){var B=P(F);return F.l+=H-14,B}function V(F,H){var B=b(F),O=F.read_shift(4);return B[1].v=O>>6,B}function Y(F,H){var B=b(F),O=F.read_shift(8,"f");return B[1].v=O,B}function le(F,H){var B=Y(F);return F.l+=H-10,B}function ue(F,H){return F[F.l+H-1]==0?F.read_shift(H,"cstr"):""}function _e(F,H){var B=F[F.l++];B>H-1&&(B=H-1);for(var O="";O.length<B;)O+=String.fromCharCode(F[F.l++]);return O}function Ne(F,H,B){if(!(!B.qpro||H<21)){var O=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var Q=F.read_shift(H-21,"cstr");return[O,Q]}}function ee(F,H){for(var B={},O=F.l+H;F.l<O;){var Q=F.read_shift(2);if(Q==14e3){for(B[Q]=[0,""],B[Q][0]=F.read_shift(2);F[F.l];)B[Q][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return B}function ve(F,H){var B=j(5+F.length);B.write_shift(2,14e3),B.write_shift(2,H);for(var O=0;O<F.length;++O){var Q=F.charCodeAt(O);B[B.l++]=Q>127?95:Q}return B[B.l++]=0,B}var Se={0:{n:"BOF",f:yx},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ue},222:{n:"SHEETNAMELP",f:_e},65535:{n:""}},Fe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:L},25:{n:"FORMULA19",f:W},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ue},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:t}}(),Q_=/^\s|\s$|[\t\n\r]/;function Cx(e,t){if(!t.bookSST)return"";var n=[gt];n[n.length]=oe("sst",null,{xmlns:vs[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var i=e[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(Q_)&&(s+=' xml:space="preserve"'),s+=">"+He(i.t)+"</t>"),s+="</si>",n[n.length]=s}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function Z_(e){return[e.read_shift(4),e.read_shift(4)]}function eS(e,t){return t||(t=j(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var tS=qT;function nS(e){var t=tn();Z(t,159,eS(e));for(var n=0;n<e.length;++n)Z(t,19,tS(e[n]));return Z(t,160),t.end()}function rS(e){for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function Ax(e){var t=0,n,r=rS(e),i=r.length+1,s,o,a,l,u;for(n=hi(i),n[0]=r.length,s=1;s!=i;++s)n[s]=r[s-1];for(s=i-1;s>=0;--s)o=n[s],a=t&16384?1:0,l=t<<1&32767,u=a|l,t=u^o;return t^52811}var iS=function(){function e(i,s){switch(s.type){case"base64":return t(mr(i),s);case"binary":return t(i,s);case"buffer":return t(Be&&Buffer.isBuffer(i)?i.toString("binary"):Jo(i),s);case"array":return t(ru(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,m){Array.isArray(a)&&(a[m]=[]);for(var h=/\\\w+\b/g,g=0,v,x=-1;v=h.exec(d);){switch(v[0]){case"\\cell":var _=d.slice(g,h.lastIndex-v[0].length);if(_[0]==" "&&(_=_.slice(1)),++x,_.length){var T={v:_,t:"s"};Array.isArray(a)?a[m][x]=T:a[We({r:m,c:x})]=T}break}g=h.lastIndex}x>u.e.c&&(u.e.c=x)}),a["!ref"]=mt(u),a}function n(i,s){return vi(e(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],o=Qe(i["!ref"]),a,l=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var m=We({r:u,c:d});a=l?(i[u]||[])[d]:i[m],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(gr(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:r}}();function Rh(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}var sS=6,cr=sS;function Il(e){return Math.floor((e+Math.round(128/cr)/256)*cr)}function kl(e){return Math.floor((e-5)/cr*100+.5)/100}function ef(e){return Math.round((e*cr+5)/cr*256)/256}function yd(e){e.width?(e.wpx=Il(e.width),e.wch=kl(e.wpx),e.MDW=cr):e.wpx?(e.wch=kl(e.wpx),e.width=ef(e.wch),e.MDW=cr):typeof e.wch=="number"&&(e.width=ef(e.wch),e.wpx=Il(e.width),e.MDW=cr),e.customWidth&&delete e.customWidth}var oS=96,Nx=oS;function Rl(e){return e*96/Nx}function Ix(e){return e*Nx/96}function aS(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)e[r]!=null&&(t[t.length]=oe("numFmt",null,{numFmtId:r,formatCode:He(e[r])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=oe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function lS(e){var t=[];return t[t.length]=oe("cellXfs",null),e.forEach(function(n){t[t.length]=oe("xf",null,n)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=oe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function kx(e,t){var n=[gt,oe("styleSheet",null,{xmlns:vs[0],"xmlns:vt":Tt.vt})],r;return e.SSF&&(r=aS(e.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=lS(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function uS(e,t){var n=e.read_shift(2),r=Vt(e);return[n,r]}function cS(e,t,n){n||(n=j(6+4*t.length)),n.write_shift(2,e),St(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function fS(e,t,n){var r={};r.sz=e.read_shift(2)/20;var i=QT(e);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=e.read_shift(2);switch(s===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(r.underline=o);var a=e.read_shift(1);a>0&&(r.family=a);var l=e.read_shift(1);switch(l>0&&(r.charset=l),e.l++,r.color=XT(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Vt(e),r}function dS(e,t){t||(t=j(25+4*32)),t.write_shift(2,e.sz*20),ZT(e,t),t.write_shift(2,e.bold?700:400);var n=0;e.vertAlign=="superscript"?n=1:e.vertAlign=="subscript"&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Al(e.color,t);var r=0;return r=2,t.write_shift(1,r),St(e.name,t),t.length>t.l?t.slice(0,t.l):t}var hS=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Yu,pS=Zn;function Ph(e,t){t||(t=j(4*3+8*7+16*1)),Yu||(Yu=ad(hS));var n=Yu[e.patternType];n==null&&(n=40),t.write_shift(4,n);var r=0;if(n!=40)for(Al({auto:1},t),Al({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function mS(e,t){var n=e.l+t,r=e.read_shift(2),i=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:i}}function Rx(e,t,n){n||(n=j(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function qs(e,t){return t||(t=j(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var gS=Zn;function xS(e,t){return t||(t=j(51)),t.write_shift(1,0),qs(null,t),qs(null,t),qs(null,t),qs(null,t),qs(null,t),t.length>t.l?t.slice(0,t.l):t}function vS(e,t){return t||(t=j(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Cl(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function yS(e,t,n){var r=j(2052);return r.write_shift(4,e),Cl(t,r),Cl(n,r),r.length>r.l?r.slice(0,r.l):r}function ES(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&++n}),n!=0&&(Z(e,615,Gn(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&Z(e,44,cS(i,t[i]))}),Z(e,616))}}function TS(e){var t=1;Z(e,611,Gn(t)),Z(e,43,dS({sz:12,color:{theme:1},name:"Calibri",family:2})),Z(e,612)}function _S(e){var t=2;Z(e,603,Gn(t)),Z(e,45,Ph({patternType:"none"})),Z(e,45,Ph({patternType:"gray125"})),Z(e,604)}function SS(e){var t=1;Z(e,613,Gn(t)),Z(e,46,xS()),Z(e,614)}function wS(e){var t=1;Z(e,626,Gn(t)),Z(e,47,Rx({numFmtId:0},65535)),Z(e,627)}function CS(e,t){Z(e,617,Gn(t.length)),t.forEach(function(n){Z(e,47,Rx(n,0))}),Z(e,618)}function AS(e){var t=1;Z(e,619,Gn(t)),Z(e,48,vS({xfId:0,name:"Normal"})),Z(e,620)}function NS(e){var t=0;Z(e,505,Gn(t)),Z(e,506)}function IS(e){var t=0;Z(e,508,yS(t,"TableStyleMedium9","PivotStyleMedium4")),Z(e,509)}function kS(e,t){var n=tn();return Z(n,278),ES(n,e.SSF),TS(n),_S(n),SS(n),wS(n),CS(n,t.cellXfs),AS(n),NS(n),IS(n),Z(n,279),n.end()}function Px(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var n=[gt];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function RS(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Vt(e)}}function PS(e){var t=j(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),St(e.name,t),t.slice(0,t.l)}function FS(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function MS(e){var t=j(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}function DS(e,t){var n=j(8+2*t.length);return n.write_shift(4,e),St(t,n),n.slice(0,n.l)}function LS(e){return e.l+=4,e.read_shift(4)!=0}function bS(e,t){var n=j(8);return n.write_shift(4,e),n.write_shift(4,1),n}function US(){var e=tn();return Z(e,332),Z(e,334,Gn(1)),Z(e,335,PS({name:"XLDAPR",version:12e4,flags:3496657072})),Z(e,336),Z(e,339,DS(1,"XLDAPR")),Z(e,52),Z(e,35,Gn(514)),Z(e,4096,Gn(0)),Z(e,4097,Tn(1)),Z(e,36),Z(e,53),Z(e,340),Z(e,337,bS(1)),Z(e,51,MS([[1,0]])),Z(e,338),Z(e,333),e.end()}function Fx(){var e=[gt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function OS(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=We(n);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}var qi=1024;function Mx(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[oe("xml",null,{"xmlns:v":un.v,"xmlns:o":un.o,"xmlns:x":un.x,"xmlns:mv":un.mv}).replace(/\/>/,">"),oe("o:shapelayout",oe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),oe("v:shapetype",[oe("v:stroke",null,{joinstyle:"miter"}),oe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];qi<e*1e3;)qi+=1e3;return t.forEach(function(s){var o=_t(s[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?oe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=oe("v:fill",l,a),d={on:"t",obscured:"t"};++qi,i=i.concat(["<v:shape"+Bo({id:"_x0000_s"+qi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,oe("v:shadow",null,d),oe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",kt("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),kt("x:AutoFill","False"),kt("x:Row",String(o.r)),kt("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Dx(e){var t=[gt,oe("comments",null,{xmlns:vs[0]})],n=[];return t.push("<authors>"),e.forEach(function(r){r[1].forEach(function(i){var s=He(i.a);n.indexOf(s)==-1&&(n.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&n.indexOf("tc="+i.ID)==-1&&(n.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=n.indexOf(He(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(kt("t",He(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,a=1;a<s.length;++a)o+=`Reply:
    `+s[a]+`
`;t.push(kt("t",He(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function BS(e,t,n){var r=[gt,oe("ThreadedComments",null,{xmlns:Tt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};a==0?s=l.id:l.parentId=s,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),r.push(oe("threadedComment",kt("text",o.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function VS(e){var t=[gt,oe("personList",null,{xmlns:Tt.TCMNT,"xmlns:x":vs[0]}).replace(/[\/]>/,">")];return e.forEach(function(n,r){t.push(oe("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),t.push("</personList>"),t.join("")}function GS(e){var t={};t.iauthor=e.read_shift(4);var n=_i(e);return t.rfx=n.s,t.ref=We(n.s),e.l+=16,t}function HS(e,t){return t==null&&(t=j(36)),t.write_shift(4,e[1].iauthor),Es(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var zS=Vt;function WS(e){return St(e.slice(0,54))}function qS(e){var t=tn(),n=[];return Z(t,628),Z(t,630),e.forEach(function(r){r[1].forEach(function(i){n.indexOf(i.a)>-1||(n.push(i.a.slice(0,54)),Z(t,632,WS(i.a)))})}),Z(t,631),Z(t,633),e.forEach(function(r){r[1].forEach(function(i){i.iauthor=n.indexOf(i.a);var s={s:_t(r[0]),e:_t(r[0])};Z(t,635,HS([s,i])),i.t&&i.t.length>0&&Z(t,637,JT(i)),Z(t,636),delete i.iauthor})}),Z(t,634),Z(t,629),t.end()}function $S(e,t){t.FullPaths.forEach(function(n,r){if(r!=0){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&$e.utils.cfb_add(e,i,t.FileIndex[r].content)}})}var Lx=["xlsb","xlsm","xlam","biff8","xla"],JS=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(r,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return a?d+=t.c:--d,l?u+=t.r:--u,i+(a?"":"$")+Bt(d)+(l?"":"$")+Pt(u)}return function(i,s){return t=s,i.replace(e,n)}}(),Ed=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Td=function(){return function(t,n){return t.replace(Ed,function(r,i,s,o,a,l){var u=pd(o)-(s?0:n.c),d=hd(l)-(a?0:n.r),m=d==0?"":a?d+1:"["+d+"]",h=u==0?"":s?u+1:"["+u+"]";return i+"R"+m+"C"+h})}}();function KS(e,t){return e.replace(Ed,function(n,r,i,s,o,a){return r+(i=="$"?i+s:Bt(pd(s)+t.c))+(o=="$"?o+a:Pt(hd(a)+t.r))})}function YS(e){return e.length!=1}function ht(e){e.l+=1}function Wr(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function bx(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return Ux(e);n.biff==12&&(r=4)}var i=e.read_shift(r),s=e.read_shift(r),o=Wr(e),a=Wr(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function Ux(e){var t=Wr(e),n=Wr(e),r=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function jS(e,t,n){if(n.biff<8)return Ux(e);var r=e.read_shift(n.biff==12?4:2),i=e.read_shift(n.biff==12?4:2),s=Wr(e),o=Wr(e);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Ox(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return XS(e);var r=e.read_shift(n&&n.biff==12?4:2),i=Wr(e);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function XS(e){var t=Wr(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function QS(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function ZS(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return ew(e);var i=e.read_shift(r>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function ew(e){var t=e.read_shift(2),n=e.read_shift(1),r=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),i==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:i,rRel:r}}function tw(e,t,n){var r=(e[e.l++]&96)>>5,i=bx(e,n.biff>=2&&n.biff<=5?6:8,n);return[r,i]}function nw(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=bx(e,s,n);return[r,i,o]}function rw(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function iw(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[r,i]}function sw(e,t,n){var r=(e[e.l++]&96)>>5,i=jS(e,t-1,n);return[r,i]}function ow(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[r]}function Fh(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function aw(e,t,n){e.l+=2;for(var r=e.read_shift(n&&n.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(e.read_shift(n&&n.biff==2?1:2));return i}function lw(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function uw(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function cw(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function fw(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[r]}function Bx(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function dw(e){return e.read_shift(2),Bx(e)}function hw(e){return e.read_shift(2),Bx(e)}function pw(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=Ox(e,0,n);return[r,i]}function mw(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=ZS(e,0,n);return[r,i]}function gw(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var s=Ox(e,0,n);return[r,i,s]}function xw(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(n&&n.biff<=3?1:2);return[xC[i],Hx[i],r]}function vw(e,t,n){var r=e[e.l++],i=e.read_shift(1),s=n&&n.biff<=3?[r==88?-1:0,e.read_shift(1)]:yw(e);return[i,(s[0]===0?Hx:gC)[s[1]]]}function yw(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Ew(e,t,n){e.l+=n&&n.biff==2?3:4}function Tw(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function _w(e){return e.l++,jo[e.read_shift(1)]}function Sw(e){return e.l++,e.read_shift(2)}function ww(e){return e.l++,e.read_shift(1)!==0}function Cw(e){return e.l++,Ts(e)}function Aw(e,t,n){return e.l++,Tx(e,t-1,n)}function Nw(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=g_(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=jo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=Ts(e);break;case 2:n[1]=E_(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function Iw(e,t,n){for(var r=e.read_shift(n.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((n.biff==12?_i:S_)(e));return i}function kw(e,t,n){var r=0,i=0;n.biff==12?(r=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--i==0&&(i=256));for(var s=0,o=[];s!=r&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=Nw(e,n.biff);return o}function Rw(e,t,n){var r=e.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,s=e.read_shift(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,s]}function Pw(e,t,n){if(n.biff==5)return Fw(e);var r=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[r,i,s]}function Fw(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}function Mw(e,t,n){var r=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function Dw(e,t,n){var r=e.read_shift(1)>>>5&3,i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function Lw(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[r]}function bw(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[r,i]}var Uw=Zn,Ow=Zn,Bw=Zn;function Xo(e,t,n){return e.l+=2,[QS(e)]}function _d(e){return e.l+=6,[]}var Vw=Xo,Gw=_d,Hw=_d,zw=Xo;function Vx(e){return e.l+=2,[yx(e),e.read_shift(2)&1]}var Ww=Xo,qw=Vx,$w=_d,Jw=Xo,Kw=Xo,Yw=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function jw(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=Yw[n>>2&31];return{ixti:t,coltype:n&3,rt:o,idx:r,c:i,C:s}}function Xw(e){return e.l+=2,[e.read_shift(4)]}function Qw(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function Zw(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function eC(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function tC(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function nC(e){return e.l+=4,[0,0]}var Mh={1:{n:"PtgExp",f:Tw},2:{n:"PtgTbl",f:Bw},3:{n:"PtgAdd",f:ht},4:{n:"PtgSub",f:ht},5:{n:"PtgMul",f:ht},6:{n:"PtgDiv",f:ht},7:{n:"PtgPower",f:ht},8:{n:"PtgConcat",f:ht},9:{n:"PtgLt",f:ht},10:{n:"PtgLe",f:ht},11:{n:"PtgEq",f:ht},12:{n:"PtgGe",f:ht},13:{n:"PtgGt",f:ht},14:{n:"PtgNe",f:ht},15:{n:"PtgIsect",f:ht},16:{n:"PtgUnion",f:ht},17:{n:"PtgRange",f:ht},18:{n:"PtgUplus",f:ht},19:{n:"PtgUminus",f:ht},20:{n:"PtgPercent",f:ht},21:{n:"PtgParen",f:ht},22:{n:"PtgMissArg",f:ht},23:{n:"PtgStr",f:Aw},26:{n:"PtgSheet",f:Qw},27:{n:"PtgEndSheet",f:Zw},28:{n:"PtgErr",f:_w},29:{n:"PtgBool",f:ww},30:{n:"PtgInt",f:Sw},31:{n:"PtgNum",f:Cw},32:{n:"PtgArray",f:ow},33:{n:"PtgFunc",f:xw},34:{n:"PtgFuncVar",f:vw},35:{n:"PtgName",f:Rw},36:{n:"PtgRef",f:pw},37:{n:"PtgArea",f:tw},38:{n:"PtgMemArea",f:Mw},39:{n:"PtgMemErr",f:Uw},40:{n:"PtgMemNoMem",f:Ow},41:{n:"PtgMemFunc",f:Dw},42:{n:"PtgRefErr",f:Lw},43:{n:"PtgAreaErr",f:rw},44:{n:"PtgRefN",f:mw},45:{n:"PtgAreaN",f:sw},46:{n:"PtgMemAreaN",f:eC},47:{n:"PtgMemNoMemN",f:tC},57:{n:"PtgNameX",f:Pw},58:{n:"PtgRef3d",f:gw},59:{n:"PtgArea3d",f:nw},60:{n:"PtgRefErr3d",f:bw},61:{n:"PtgAreaErr3d",f:iw},255:{}},rC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},iC={1:{n:"PtgElfLel",f:Vx},2:{n:"PtgElfRw",f:Jw},3:{n:"PtgElfCol",f:Vw},6:{n:"PtgElfRwV",f:Kw},7:{n:"PtgElfColV",f:zw},10:{n:"PtgElfRadical",f:Ww},11:{n:"PtgElfRadicalS",f:$w},13:{n:"PtgElfColS",f:Gw},15:{n:"PtgElfColSV",f:Hw},16:{n:"PtgElfRadicalLel",f:qw},25:{n:"PtgList",f:jw},29:{n:"PtgSxName",f:Xw},255:{}},sC={0:{n:"PtgAttrNoop",f:nC},1:{n:"PtgAttrSemi",f:fw},2:{n:"PtgAttrIf",f:uw},4:{n:"PtgAttrChoose",f:aw},8:{n:"PtgAttrGoto",f:lw},16:{n:"PtgAttrSum",f:Ew},32:{n:"PtgAttrBaxcel",f:Fh},33:{n:"PtgAttrBaxcel",f:Fh},64:{n:"PtgAttrSpace",f:dw},65:{n:"PtgAttrSpaceSemi",f:hw},128:{n:"PtgAttrIfError",f:cw},255:{}};function oC(e,t,n,r){if(r.biff<8)return Zn(e,t);for(var i=e.l+t,s=[],o=0;o!==n.length;++o)switch(n[o][0]){case"PtgArray":n[o][1]=kw(e,0,r),s.push(n[o][1]);break;case"PtgMemArea":n[o][2]=Iw(e,n[o][1],r),s.push(n[o][2]);break;case"PtgExp":r&&r.biff==12&&(n[o][1][1]=e.read_shift(4),s.push(n[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[o][0]}return t=i-e.l,t!==0&&s.push(Zn(e,t)),s}function aC(e,t,n){for(var r=e.l+t,i,s,o=[];r!=e.l;)t=r-e.l,s=e[e.l],i=Mh[s]||Mh[rC[s]],(s===24||s===25)&&(i=(s===24?iC:sC)[e[e.l+1]]),!i||!i.f?Zn(e,t):o.push([i.n,i.f(e,t,n)]);return o}function lC(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],i=[],s=0;s<r.length;++s){var o=r[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var uC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function cC(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Gx(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(e[r[0]][0]){case 357:return i=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[r[0]][0][3]?(i=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Dh(e,t,n){var r=Gx(e,t,n);return r=="#REF"?r:cC(r,n)}function ps(e,t,n,r,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},a=[],l,u,d,m=0,h=0,g,v="";if(!e[0]||!e[0][0])return"";for(var x=-1,_="",T=0,y=e[0].length;T<y;++T){var E=e[0][T];switch(E[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),u=a.pop(),x>=0){switch(e[0][x][1][0]){case 0:_=ut(" ",e[0][x][1][1]);break;case 1:_=ut("\r",e[0][x][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}u=u+_,x=-1}a.push(u+uC[E[0]]+l);break;case"PtgIsect":l=a.pop(),u=a.pop(),a.push(u+" "+l);break;case"PtgUnion":l=a.pop(),u=a.pop(),a.push(u+","+l);break;case"PtgRange":l=a.pop(),u=a.pop(),a.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=po(E[1][1],o,i),a.push(mo(d,s));break;case"PtgRefN":d=n?po(E[1][1],n,i):E[1][1],a.push(mo(d,s));break;case"PtgRef3d":m=E[1][1],d=po(E[1][2],o,i),v=Dh(r,m,i),a.push(v+"!"+mo(d,s));break;case"PtgFunc":case"PtgFuncVar":var A=E[1][0],b=E[1][1];A||(A=0),A&=127;var D=A==0?[]:a.slice(-A);a.length-=A,b==="User"&&(b=D.shift()),a.push(b+"("+D.join(",")+")");break;case"PtgBool":a.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(E[1]);break;case"PtgNum":a.push(String(E[1]));break;case"PtgStr":a.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(E[1]);break;case"PtgAreaN":g=vh(E[1][1],n?{s:n}:o,i),a.push(Ju(g,i));break;case"PtgArea":g=vh(E[1][1],o,i),a.push(Ju(g,i));break;case"PtgArea3d":m=E[1][1],g=E[1][2],v=Dh(r,m,i),a.push(v+"!"+Ju(g,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=E[1][2];var C=(r.names||[])[h-1]||(r[0]||[])[h],L=C?C.Name:"SH33TJSNAME"+String(h);L&&L.slice(0,6)=="_xlfn."&&!i.xlfn&&(L=L.slice(6)),a.push(L);break;case"PtgNameX":var P=E[1][1];h=E[1][2];var U;if(i.biff<=5)P<0&&(P=-P),r[P]&&(U=r[P][h]);else{var W="";if(((r[P]||[])[0]||[])[0]==14849||(((r[P]||[])[0]||[])[0]==1025?r[P][h]&&r[P][h].itab>0&&(W=r.SheetNames[r[P][h].itab-1]+"!"):W=r.SheetNames[h-1]+"!"),r[P]&&r[P][h])W+=r[P][h].Name;else if(r[0]&&r[0][h])W+=r[0][h].Name;else{var V=(Gx(r,P,i)||"").split(";;");V[h-1]?W=V[h-1]:W+="SH33TJSERRX"}a.push(W);break}U||(U={Name:"SH33TJSERRY"}),a.push(U.Name);break;case"PtgParen":var Y="(",le=")";if(x>=0){switch(_="",e[0][x][1][0]){case 2:Y=ut(" ",e[0][x][1][1])+Y;break;case 3:Y=ut("\r",e[0][x][1][1])+Y;break;case 4:le=ut(" ",e[0][x][1][1])+le;break;case 5:le=ut("\r",e[0][x][1][1])+le;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}a.push(Y+a.pop()+le);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":d={c:E[1][1],r:E[1][0]};var ue={c:n.c,r:n.r};if(r.sharedf[We(d)]){var _e=r.sharedf[We(d)];a.push(ps(_e,o,ue,r,i))}else{var Ne=!1;for(l=0;l!=r.arrayf.length;++l)if(u=r.arrayf[l],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){a.push(ps(u[1],o,ue,r,i)),Ne=!0;break}Ne||a.push(E[1])}break;case"PtgArray":a.push("{"+lC(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&ee.indexOf(e[0][T][0])==-1){E=e[0][x];var ve=!0;switch(E[1][0]){case 4:ve=!1;case 0:_=ut(" ",E[1][1]);break;case 5:ve=!1;case 1:_=ut("\r",E[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}a.push((ve?_:"")+a.pop()+(ve?"":_)),x=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function fC(e){if(e==null){var t=j(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return pi(e);return pi(0)}function dC(e,t,n,r,i){var s=mi(t,n,i),o=fC(e.v),a=j(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var u=j(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var m=It([s,o,a,u]);return m}function iu(e,t,n){var r=e.read_shift(4),i=aC(e,r,n),s=e.read_shift(4),o=s>0?oC(e,s,i,n):null;return[i,o]}var hC=iu,su=iu,pC=iu,mC=iu,gC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Hx={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},xC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function vC(e){var t="of:="+e.replace(Ed,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function yC(e){return e.replace(/\./,"!")}var go=typeof Map<"u";function Sd(e,t,n){var r=0,i=e.length;if(n){if(go?n.has(t):Object.prototype.hasOwnProperty.call(n,t)){for(var s=go?n.get(t):n[t];r<s.length;++r)if(e[s[r]].t===t)return e.Count++,s[r]}}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t},e.Count++,e.Unique++,n&&(go?(n.has(t)||n.set(t,[]),n.get(t).push(i)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(i))),i}function ou(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(cr=t.MDW),t.width!=null?n.customWidth=1:t.wpx!=null?r=kl(t.wpx):t.wch!=null&&(r=t.wch),r>-1?(n.width=ef(r),n.customWidth=1):t.width!=null&&(n.width=t.width),t.hidden&&(n.hidden=!0),t.level!=null&&(n.outlineLevel=n.level=t.level),n}function zx(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function Yr(e,t,n){var r=n.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(r==null&&n.ssf){for(;i<392;++i)if(n.ssf[i]==null){O1(t.z,i),n.ssf[i]=t.z,n.revssf[t.z]=r=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===r)return i;return e[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function EC(e,t,n){if(e&&e["!ref"]){var r=Qe(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}function TC(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+mt(e[n])+'"/>';return t+"</mergeCells>"}function _C(e,t,n,r,i){var s=!1,o={},a=null;if(r.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch{}s=!0,o.codeName=Oo(He(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),a=(a||"")+oe("outlinePr",null,u)}!s&&!a||(i[i.length]=oe("sheetPr",a,o))}var SC=["objects","scenarios","selectLockedCells","selectUnlockedCells"],wC=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function CC(e){var t={sheet:1};return SC.forEach(function(n){e[n]!=null&&e[n]&&(t[n]="1")}),wC.forEach(function(n){e[n]!=null&&!e[n]&&(t[n]="0")}),e.password&&(t.password=Ax(e.password).toString(16).toUpperCase()),oe("sheetProtection",null,t)}function AC(e){return zx(e),oe("pageMargins",null,e)}function NC(e,t){for(var n=["<cols>"],r,i=0;i!=t.length;++i)(r=t[i])&&(n[n.length]=oe("col",null,ou(i,r)));return n[n.length]="</cols>",n.join("")}function IC(e,t,n,r){var i=typeof e.ref=="string"?e.ref:mt(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,o=pn(i);o.s.r==o.e.r&&(o.e.r=pn(t["!ref"]).e.r,i=mt(o));for(var a=0;a<s.length;++a){var l=s[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),oe("autoFilter",null,{ref:i})}function kC(e,t,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),oe("sheetViews",oe("sheetView",null,i),{})}function RC(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=jo[e.v];break;case"d":r&&r.cellDates?i=Jt(e.v,-1).toISOString():(e=rn(e),e.t="n",i=""+(e.v=nn(Jt(e.v)))),typeof e.z>"u"&&(e.z=ct[14]);break;default:i=e.v;break}var a=kt("v",He(i)),l={r:t},u=Yr(r.cellXfs,e,r);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){a=kt("v",""+Sd(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;a=oe("f",He(e.f),d)+(e.v!=null?a:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),oe("c",a,l)}function PC(e,t,n,r){var i=[],s=[],o=Qe(e["!ref"]),a="",l,u="",d=[],m=0,h=0,g=e["!rows"],v=Array.isArray(e),x={r:u},_,T=-1;for(h=o.s.c;h<=o.e.c;++h)d[h]=Bt(h);for(m=o.s.r;m<=o.e.r;++m){for(s=[],u=Pt(m),h=o.s.c;h<=o.e.c;++h){l=d[h]+u;var y=v?(e[m]||[])[h]:e[l];y!==void 0&&(a=RC(y,l,e,t))!=null&&s.push(a)}(s.length>0||g&&g[m])&&(x={r:u},g&&g[m]&&(_=g[m],_.hidden&&(x.hidden=1),T=-1,_.hpx?T=Rl(_.hpx):_.hpt&&(T=_.hpt),T>-1&&(x.ht=T,x.customHeight=1),_.level&&(x.outlineLevel=_.level)),i[i.length]=oe("row",s.join(""),x))}if(g)for(;m<g.length;++m)g&&g[m]&&(x={r:m+1},_=g[m],_.hidden&&(x.hidden=1),T=-1,_.hpx?T=Rl(_.hpx):_.hpt&&(T=_.hpt),T>-1&&(x.ht=T,x.customHeight=1),_.level&&(x.outlineLevel=_.level),i[i.length]=oe("row","",x));return i.join("")}function Wx(e,t,n,r){var i=[gt,oe("worksheet",null,{xmlns:vs[0],"xmlns:r":Tt.r})],s=n.SheetNames[e],o=0,a="",l=n.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",d=Qe(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=mt(d)}r||(r={}),l["!comments"]=[];var m=[];_C(l,n,e,t,i),i[i.length]=oe("dimension",null,{ref:u}),i[i.length]=kC(l,t,e,n),t.sheetFormat&&(i[i.length]=oe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=NC(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=PC(l,t),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=CC(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=IC(l["!autofilter"],l,n,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=TC(l["!merges"]));var h=-1,g,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(g={ref:x[0]},x[1].Target.charAt(0)!="#"&&(v=Ge(r,-1,He(x[1].Target).replace(/#.*$/,""),Ue.HLINK),g["r:id"]="rId"+v),(h=x[1].Target.indexOf("#"))>-1&&(g.location=He(x[1].Target.slice(h+1))),x[1].Tooltip&&(g.tooltip=He(x[1].Tooltip)),i[i.length]=oe("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=AC(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=kt("ignoredErrors",oe("ignoredError",null,{numberStoredAsText:1,sqref:u}))),m.length>0&&(v=Ge(r,-1,"../drawings/drawing"+(e+1)+".xml",Ue.DRAW),i[i.length]=oe("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=m),l["!comments"].length>0&&(v=Ge(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ue.VML),i[i.length]=oe("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function FC(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=r,s&7&&(n.level=s&7),s&16&&(n.hidden=!0),s&32&&(n.hpt=i/20),n}function MC(e,t,n){var r=j(145),i=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var s=320;i.hpx?s=Rl(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var a=0,l=r.l;r.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var m=-1,h=-1,g=d<<10;g<d+1<<10;++g){u.c=g;var v=Array.isArray(n)?(n[u.r]||[])[u.c]:n[We(u)];v&&(m<0&&(m=g),h=g)}m<0||(++a,r.write_shift(4,m),r.write_shift(4,h))}var x=r.l;return r.l=l,r.write_shift(4,a),r.l=x,r.length>r.l?r.slice(0,r.l):r}function DC(e,t,n,r){var i=MC(r,n,t);(i.length>17||(t["!rows"]||[])[r])&&Z(e,0,i)}var LC=_i,bC=Es;function UC(){}function OC(e,t){var n={},r=e[e.l];return++e.l,n.above=!(r&64),n.left=!(r&128),e.l+=18,n.name=KT(e),n}function BC(e,t,n){n==null&&(n=j(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return Al({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),sx(e,n),n.slice(0,n.l)}function VC(e){var t=Rn(e);return[t]}function GC(e,t,n){return n==null&&(n=j(8)),yi(t,n)}function HC(e){var t=Ei(e);return[t]}function zC(e,t,n){return n==null&&(n=j(4)),Ti(t,n)}function WC(e){var t=Rn(e),n=e.read_shift(1);return[t,n,"b"]}function qC(e,t,n){return n==null&&(n=j(9)),yi(t,n),n.write_shift(1,e.v?1:0),n}function $C(e){var t=Ei(e),n=e.read_shift(1);return[t,n,"b"]}function JC(e,t,n){return n==null&&(n=j(5)),Ti(t,n),n.write_shift(1,e.v?1:0),n}function KC(e){var t=Rn(e),n=e.read_shift(1);return[t,n,"e"]}function YC(e,t,n){return n==null&&(n=j(9)),yi(t,n),n.write_shift(1,e.v),n}function jC(e){var t=Ei(e),n=e.read_shift(1);return[t,n,"e"]}function XC(e,t,n){return n==null&&(n=j(8)),Ti(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}function QC(e){var t=Rn(e),n=e.read_shift(4);return[t,n,"s"]}function ZC(e,t,n){return n==null&&(n=j(12)),yi(t,n),n.write_shift(4,t.v),n}function eA(e){var t=Ei(e),n=e.read_shift(4);return[t,n,"s"]}function tA(e,t,n){return n==null&&(n=j(8)),Ti(t,n),n.write_shift(4,t.v),n}function nA(e){var t=Rn(e),n=Ts(e);return[t,n,"n"]}function rA(e,t,n){return n==null&&(n=j(16)),yi(t,n),pi(e.v,n),n}function iA(e){var t=Ei(e),n=Ts(e);return[t,n,"n"]}function sA(e,t,n){return n==null&&(n=j(12)),Ti(t,n),pi(e.v,n),n}function oA(e){var t=Rn(e),n=ox(e);return[t,n,"n"]}function aA(e,t,n){return n==null&&(n=j(12)),yi(t,n),ax(e.v,n),n}function lA(e){var t=Ei(e),n=ox(e);return[t,n,"n"]}function uA(e,t,n){return n==null&&(n=j(8)),Ti(t,n),ax(e.v,n),n}function cA(e){var t=Rn(e),n=md(e);return[t,n,"is"]}function fA(e){var t=Rn(e),n=Vt(e);return[t,n,"str"]}function dA(e,t,n){return n==null&&(n=j(12+4*e.v.length)),yi(t,n),St(e.v,n),n.length>n.l?n.slice(0,n.l):n}function hA(e){var t=Ei(e),n=Vt(e);return[t,n,"str"]}function pA(e,t,n){return n==null&&(n=j(8+4*e.v.length)),Ti(t,n),St(e.v,n),n.length>n.l?n.slice(0,n.l):n}function mA(e,t,n){var r=e.l+t,i=Rn(e);i.r=n["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(n.cellFormula){e.l+=2;var a=su(e,r-e.l,n);o[3]=ps(a,null,i,n.supbooks,n)}else e.l=r;return o}function gA(e,t,n){var r=e.l+t,i=Rn(e);i.r=n["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(n.cellFormula){e.l+=2;var a=su(e,r-e.l,n);o[3]=ps(a,null,i,n.supbooks,n)}else e.l=r;return o}function xA(e,t,n){var r=e.l+t,i=Rn(e);i.r=n["!row"];var s=Ts(e),o=[i,s,"n"];if(n.cellFormula){e.l+=2;var a=su(e,r-e.l,n);o[3]=ps(a,null,i,n.supbooks,n)}else e.l=r;return o}function vA(e,t,n){var r=e.l+t,i=Rn(e);i.r=n["!row"];var s=Vt(e),o=[i,s,"str"];if(n.cellFormula){e.l+=2;var a=su(e,r-e.l,n);o[3]=ps(a,null,i,n.supbooks,n)}else e.l=r;return o}var yA=_i,EA=Es;function TA(e,t){return t==null&&(t=j(4)),t.write_shift(4,e),t}function _A(e,t){var n=e.l+t,r=_i(e),i=gd(e),s=Vt(e),o=Vt(e),a=Vt(e);e.l=n;var l={rfx:r,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function SA(e,t){var n=j(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Es({s:_t(e[0]),e:_t(e[0])},n),xd("rId"+t,n);var r=e[1].Target.indexOf("#"),i=r==-1?"":e[1].Target.slice(r+1);return St(i||"",n),St(e[1].Tooltip||"",n),St("",n),n.slice(0,n.l)}function wA(){}function CA(e,t,n){var r=e.l+t,i=lx(e),s=e.read_shift(1),o=[i];if(o[2]=s,n.cellFormula){var a=hC(e,r-e.l,n);o[1]=a}else e.l=r;return o}function AA(e,t,n){var r=e.l+t,i=_i(e),s=[i];if(n.cellFormula){var o=mC(e,r-e.l,n);s[1]=o,e.l=r}else e.l=r;return s}function NA(e,t,n){n==null&&(n=j(18));var r=ou(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),n.write_shift(2,i),n}var qx=["left","right","top","bottom","header","footer"];function IA(e){var t={};return qx.forEach(function(n){t[n]=Ts(e)}),t}function kA(e,t){return t==null&&(t=j(6*8)),zx(e),qx.forEach(function(n){pi(e[n],t)}),t}function RA(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function PA(e,t,n){n==null&&(n=j(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function FA(e){var t=j(24);return t.write_shift(4,4),t.write_shift(4,1),Es(e,t),t}function MA(e,t){return t==null&&(t=j(16*4+2)),t.write_shift(2,e.password?Ax(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?t.write_shift(4,e[n[0]]!=null&&!e[n[0]]?1:0):t.write_shift(4,e[n[0]]!=null&&e[n[0]]?0:1)}),t}function DA(){}function LA(){}function bA(e,t,n,r,i,s,o){if(t.v===void 0)return!1;var a="";switch(t.t){case"b":a=t.v?"1":"0";break;case"d":t=rn(t),t.z=t.z||ct[14],t.v=nn(Jt(t.v)),t.t="n";break;case"n":case"e":a=""+t.v;break;default:a=t.v;break}var l={r:n,c:r};switch(l.s=Yr(i.cellXfs,t,i),t.l&&s["!links"].push([We(l),t.l]),t.c&&s["!comments"].push([We(l),t.c]),t.t){case"s":case"str":return i.bookSST?(a=Sd(i.Strings,t.v,i.revStrings),l.t="s",l.v=a,o?Z(e,18,tA(t,l)):Z(e,7,ZC(t,l))):(l.t="str",o?Z(e,17,pA(t,l)):Z(e,6,dA(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Z(e,13,uA(t,l)):Z(e,2,aA(t,l)):o?Z(e,16,sA(t,l)):Z(e,5,rA(t,l)),!0;case"b":return l.t="b",o?Z(e,15,JC(t,l)):Z(e,4,qC(t,l)),!0;case"e":return l.t="e",o?Z(e,14,XC(t,l)):Z(e,3,YC(t,l)),!0}return o?Z(e,12,zC(t,l)):Z(e,1,GC(t,l)),!0}function UA(e,t,n,r){var i=Qe(t["!ref"]||"A1"),s,o="",a=[];Z(e,145);var l=Array.isArray(t),u=i.e.r;t["!rows"]&&(u=Math.max(i.e.r,t["!rows"].length-1));for(var d=i.s.r;d<=u;++d){o=Pt(d),DC(e,t,i,d);var m=!1;if(d<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){d===i.s.r&&(a[h]=Bt(h)),s=a[h]+o;var g=l?(t[d]||[])[h]:t[s];if(!g){m=!1;continue}m=bA(e,g,d,h,r,t,m)}}Z(e,146)}function OA(e,t){!t||!t["!merges"]||(Z(e,177,TA(t["!merges"].length)),t["!merges"].forEach(function(n){Z(e,176,EA(n))}),Z(e,178))}function BA(e,t){!t||!t["!cols"]||(Z(e,390),t["!cols"].forEach(function(n,r){n&&Z(e,60,NA(r,n))}),Z(e,391))}function VA(e,t){!t||!t["!ref"]||(Z(e,648),Z(e,649,FA(Qe(t["!ref"]))),Z(e,650))}function GA(e,t,n){t["!links"].forEach(function(r){if(r[1].Target){var i=Ge(n,-1,r[1].Target.replace(/#.*$/,""),Ue.HLINK);Z(e,494,SA(r,i))}}),delete t["!links"]}function HA(e,t,n,r){if(t["!comments"].length>0){var i=Ge(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Ue.VML);Z(e,551,xd("rId"+i)),t["!legacy"]=i}}function zA(e,t,n,r){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:mt(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,a=pn(s);a.s.r==a.e.r&&(a.e.r=pn(t["!ref"]).e.r,s=mt(a));for(var l=0;l<o.length;++l){var u=o[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+n.SheetNames[r]+"'!"+s;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+s}),Z(e,161,Es(Qe(s))),Z(e,162)}}function WA(e,t,n){Z(e,133),Z(e,137,PA(t,n)),Z(e,138),Z(e,134)}function qA(e,t){t["!protect"]&&Z(e,535,MA(t["!protect"]))}function $A(e,t,n,r){var i=tn(),s=n.SheetNames[e],o=n.Sheets[s]||{},a=s;try{n&&n.Workbook&&(a=n.Workbook.Sheets[e].CodeName||a)}catch{}var l=Qe(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Z(i,129),(n.vbaraw||o["!outline"])&&Z(i,147,BC(a,o["!outline"])),Z(i,148,bC(l)),WA(i,o,n.Workbook),BA(i,o),UA(i,o,e,t),qA(i,o),zA(i,o,n,e),OA(i,o),GA(i,o,r),o["!margins"]&&Z(i,476,kA(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&VA(i,o),HA(i,o,e,r),Z(i,130),i.end()}function JA(e,t){e.l+=10;var n=Vt(e);return{name:n}}var KA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function YA(e){return!e.Workbook||!e.Workbook.WBProps?"false":AT(e.Workbook.WBProps.date1904)?"true":"false"}var jA="][*?/\\".split("");function $x(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return jA.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function XA(e,t,n){e.forEach(function(r,i){$x(r);for(var s=0;s<i;++s)if(r==e[s])throw new Error("Duplicate Sheet Name: "+r);if(n){var o=t&&t[i]&&t[i].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function QA(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];XA(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)EC(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}function Jx(e){var t=[gt];t[t.length]=oe("workbook",null,{xmlns:vs[0],"xmlns:r":Tt.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(KA.forEach(function(a){e.Workbook.WBProps[a[0]]!=null&&e.Workbook.WBProps[a[0]]!=a[1]&&(r[a[0]]=e.Workbook.WBProps[a[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=oe("workbookPr",null,r);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:He(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=oe("sheet",null,o)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(t[t.length]=oe("definedName",He(a.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function ZA(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=Zc(e),n.name=Vt(e),n}function eN(e,t){return t||(t=j(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),xd(e.strRelID,t),St(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function tN(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var i=t>8?Vt(e):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function nN(e,t){t||(t=j(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),sx(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function rN(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=YT(e),o=pC(e,0,n),a=gd(e);e.l=r;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function iN(e,t){Z(e,143);for(var n=0;n!=t.SheetNames.length;++n){var r=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,i={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]};Z(e,156,eN(i))}Z(e,144)}function sN(e,t){t||(t=j(127));for(var n=0;n!=4;++n)t.write_shift(4,0);return St("SheetJS",t),St(vl.version,t),St(vl.version,t),St("7262",t),t.length>t.l?t.slice(0,t.l):t}function oN(e,t){t||(t=j(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var n=120;return t.write_shift(1,n),t.length>t.l?t.slice(0,t.l):t}function aN(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var n=t.Workbook.Sheets,r=0,i=-1,s=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&i==-1?i=r:n[r].Hidden==1&&s==-1&&(s=r);s>i||(Z(e,135),Z(e,158,oN(i)),Z(e,136))}}function lN(e,t){var n=tn();return Z(n,131),Z(n,128,sN()),Z(n,153,nN(e.Workbook&&e.Workbook.WBProps||null)),aN(n,e),iN(n,e),Z(n,132),n.end()}function uN(e,t,n){return(t.slice(-4)===".bin"?lN:Jx)(e)}function cN(e,t,n,r,i){return(t.slice(-4)===".bin"?$A:Wx)(e,n,r,i)}function fN(e,t,n){return(t.slice(-4)===".bin"?kS:kx)(e,n)}function dN(e,t,n){return(t.slice(-4)===".bin"?nS:Cx)(e,n)}function hN(e,t,n){return(t.slice(-4)===".bin"?qS:Dx)(e)}function pN(e){return(e.slice(-4)===".bin"?US:Fx)()}function mN(e,t){var n=[];return e.Props&&n.push(f_(e.Props,t)),e.Custprops&&n.push(d_(e.Props,e.Custprops)),n.join("")}function gN(){return""}function xN(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(r,i){var s=[];s.push(oe("NumberFormat",null,{"ss:Format":He(ct[r.numFmtId])}));var o={"ss:ID":"s"+(21+i)};n.push(oe("Style",s.join(""),o))}),oe("Styles",n.join(""))}function Kx(e){return oe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Td(e.Ref,{r:0,c:0})})}function vN(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var i=t[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||n.push(Kx(i)))}return oe("Names",n.join(""))}function yN(e,t,n,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==n&&(a.Name.match(/^_xlfn\./)||s.push(Kx(a)))}return s.join("")}function EN(e,t,n,r){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(oe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(oe("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(oe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(oe("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<n&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(kt("ProtectContents","True")),e["!protect"].objects&&i.push(kt("ProtectObjects","True")),e["!protect"].scenarios&&i.push(kt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(kt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(kt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":oe("WorksheetOptions",i.join(""),{xmlns:un.x})}function TN(e){return e.map(function(t){var n=CT(t.t||""),r=oe("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return oe("Comment",r,{"ss:Author":t.a})}).join("")}function _N(e,t,n,r,i,s,o){if(!e||e.v==null&&e.f==null)return"";var a={};if(e.f&&(a["ss:Formula"]="="+He(Td(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var l=_t(e.F.slice(t.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(e.l&&e.l.Target&&(a["ss:HRef"]=He(e.l.Target),e.l.Tooltip&&(a["x:HRefScreenTip"]=He(e.l.Tooltip))),n["!merges"])for(var u=n["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(a["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(a["ss:MergeDown"]=u[d].e.r-u[d].s.r));var m="",h="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":m="Number",h=String(e.v);break;case"b":m="Boolean",h=e.v?"1":"0";break;case"e":m="Error",h=jo[e.v];break;case"d":m="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ct[14]);break;case"s":m="String",h=wT(e.v||"");break}var g=Yr(r.cellXfs,e,r);a["ss:StyleID"]="s"+(21+g),a["ss:Index"]=o.c+1;var v=e.v!=null?h:"",x=e.t=="z"?"":'<Data ss:Type="'+m+'">'+v+"</Data>";return(e.c||[]).length>0&&(x+=TN(e.c)),oe("Cell",x,a)}function SN(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ix(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function wN(e,t,n,r){if(!e["!ref"])return"";var i=Qe(e["!ref"]),s=e["!merges"]||[],o=0,a=[];e["!cols"]&&e["!cols"].forEach(function(_,T){yd(_);var y=!!_.width,E=ou(T,_),A={"ss:Index":T+1};y&&(A["ss:Width"]=Il(E.width)),_.hidden&&(A["ss:Hidden"]="1"),a.push(oe("Column",null,A))});for(var l=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var d=[SN(u,(e["!rows"]||[])[u])],m=i.s.c;m<=i.e.c;++m){var h=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>m)&&!(s[o].s.r>u)&&!(s[o].e.c<m)&&!(s[o].e.r<u)){(s[o].s.c!=m||s[o].s.r!=u)&&(h=!0);break}if(!h){var g={r:u,c:m},v=We(g),x=l?(e[u]||[])[m]:e[v];d.push(_N(x,v,e,t,n,r,g))}}d.push("</Row>"),d.length>2&&a.push(d.join(""))}return a.join("")}function CN(e,t,n){var r=[],i=n.SheetNames[e],s=n.Sheets[i],o=s?yN(s,t,e,n):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=s?wN(s,t,e,n):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(EN(s,t,e,n)),r.join("")}function AN(e,t){t||(t={}),e.SSF||(e.SSF=rn(ct)),e.SSF&&(tu(),eu(e.SSF),t.revssf=nu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Yr(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(mN(e,t)),n.push(gN()),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(oe("Worksheet",CN(r,t,e),{"ss:Name":He(e.SheetNames[r])}));return n[2]=xN(e,t),n[3]=vN(e),gt+oe("Workbook",n.join(""),{xmlns:un.ss,"xmlns:o":un.o,"xmlns:x":un.x,"xmlns:ss":un.ss,"xmlns:dt":un.dt,"xmlns:html":un.html})}var ju={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function NN(e,t){var n=[],r=[],i=[],s=0,o,a=ah(Eh,"n"),l=ah(Th,"n");if(e.Props)for(o=Mt(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(a,o[s])?n:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=Mt(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(a,o[s])?n:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],e.Custprops[o[s]]]);var u=[];for(s=0;s<i.length;++s)vx.indexOf(i[s][0])>-1||mx.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);r.length&&$e.utils.cfb_add(t,"/SummaryInformation",Ah(r,ju.SI,l,Th)),(n.length||u.length)&&$e.utils.cfb_add(t,"/DocumentSummaryInformation",Ah(n,ju.DSI,a,Eh,u.length?u:null,ju.UDI))}function IN(e,t){var n=t||{},r=$e.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return $e.utils.cfb_add(r,i,Yx(e,n)),n.biff==8&&(e.Props||e.Custprops)&&NN(e,r),n.biff==8&&e.vbaraw&&$S(r,$e.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var kN={0:{f:FC},1:{f:VC},2:{f:oA},3:{f:KC},4:{f:WC},5:{f:nA},6:{f:fA},7:{f:QC},8:{f:vA},9:{f:xA},10:{f:mA},11:{f:gA},12:{f:HC},13:{f:lA},14:{f:jC},15:{f:$C},16:{f:iA},17:{f:hA},18:{f:eA},19:{f:md},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:rN},40:{},42:{},43:{f:fS},44:{f:uS},45:{f:pS},46:{f:gS},47:{f:mS},48:{},49:{f:HT},50:{},51:{f:FS},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:z_},62:{f:cA},63:{f:OS},64:{f:DA},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Zn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:RA},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:OC},148:{f:LC,p:16},151:{f:wA},152:{},153:{f:tN},154:{},155:{},156:{f:ZA},157:{},158:{},159:{T:1,f:Z_},160:{T:-1},161:{T:1,f:_i},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yA},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:RS},336:{T:-1},337:{f:LS,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Zc},357:{},358:{},359:{},360:{T:1},361:{},362:{f:U_},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:CA},427:{f:AA},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:IA},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:UC},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:_A},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Zc},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zS},633:{T:1},634:{T:-1},635:{T:1,f:GS},636:{T:-1},637:{f:$T},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:JA},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:LA},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ae(e,t,n,r){var i=t;if(!isNaN(i)){var s=r||(n||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&dd(n)&&e.push(n)}}function RN(e,t,n,r){var i=(n||[]).length||0;if(i<=8224)return ae(e,t,n,i);var s=t;if(!isNaN(s)){for(var o=n.parts||[],a=0,l=0,u=0;u+(o[a]||8224)<=8224;)u+=o[a]||8224,a++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,u),e.push(n.slice(l,l+u)),l+=u;l<i;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[a]||8224)<=8224;)u+=o[a]||8224,a++;d.write_shift(2,u),e.push(n.slice(l,l+u)),l+=u}}}function Qo(e,t,n){return e||(e=j(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function PN(e,t,n,r){var i=j(9);return Qo(i,e,t),Ex(n,r||"b",i),i}function FN(e,t,n){var r=j(8+2*n.length);return Qo(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function MN(e,t,n,r){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?nn(Jt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?ae(e,2,J_(n,r,i)):ae(e,3,$_(n,r,i));return;case"b":case"e":ae(e,5,PN(n,r,t.v,t.t));return;case"s":case"str":ae(e,4,FN(n,r,(t.v||"").slice(0,255)));return}ae(e,1,Qo(null,n,r))}function DN(e,t,n,r){var i=Array.isArray(t),s=Qe(t["!ref"]||"A1"),o,a="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=mt(s)}for(var u=s.s.r;u<=s.e.r;++u){a=Pt(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(l[d]=Bt(d)),o=l[d]+a;var m=i?(t[u]||[])[d]:t[o];m&&MN(e,m,u,d)}}}function LN(e,t){for(var n=t||{},r=tn(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==n.sheet&&(i=s);if(i==0&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return ae(r,n.biff==4?1033:n.biff==3?521:9,vd(e,16,n)),DN(r,e.Sheets[e.SheetNames[i]],i,n),ae(r,10),r.end()}function bN(e,t,n){ae(e,49,k_({sz:12,name:"Arial"},n))}function UN(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&ae(e,1054,F_(i,t[i],n))})}function ON(e,t){var n=j(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),ae(e,2151,n),n=j(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),Sx(Qe(t["!ref"]||"A1"),n),n.write_shift(4,4),ae(e,2152,n)}function BN(e,t){for(var n=0;n<16;++n)ae(e,224,Ih({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){ae(e,224,Ih(r,0,t))})}function VN(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];ae(e,440,V_(r)),r[1].Tooltip&&ae(e,2048,G_(r))}delete t["!links"]}function GN(e,t){if(t){var n=0;t.forEach(function(r,i){++n<=256&&r&&ae(e,125,W_(ou(i,r),i))})}}function HN(e,t,n,r,i){var s=16+Yr(i.cellXfs,t,i);if(t.v==null&&!t.bf){ae(e,513,mi(n,r,s));return}if(t.bf)ae(e,6,dC(t,n,r,i,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?nn(Jt(t.v)):t.v;ae(e,515,b_(n,r,o,s));break;case"b":case"e":ae(e,517,L_(n,r,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var a=Sd(i.Strings,t.v,i.revStrings);ae(e,253,R_(n,r,a,s))}else ae(e,516,P_(n,r,(t.v||"").slice(0,255),s,i));break;default:ae(e,513,mi(n,r,s))}}function zN(e,t,n){var r=tn(),i=n.SheetNames[e],s=n.Sheets[i]||{},o=(n||{}).Workbook||{},a=(o.Sheets||[])[e]||{},l=Array.isArray(s),u=t.biff==8,d,m="",h=[],g=Qe(s["!ref"]||"A1"),v=u?65536:16384;if(g.e.c>255||g.e.r>=v){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,v-1)}ae(r,2057,vd(n,16,t)),ae(r,13,Tn(1)),ae(r,12,Tn(100)),ae(r,15,qt(!0)),ae(r,17,qt(!1)),ae(r,16,pi(.001)),ae(r,95,qt(!0)),ae(r,42,qt(!1)),ae(r,43,qt(!1)),ae(r,130,Tn(1)),ae(r,128,D_()),ae(r,131,qt(!1)),ae(r,132,qt(!1)),u&&GN(r,s["!cols"]),ae(r,512,M_(g,t)),u&&(s["!links"]=[]);for(var x=g.s.r;x<=g.e.r;++x){m=Pt(x);for(var _=g.s.c;_<=g.e.c;++_){x===g.s.r&&(h[_]=Bt(_)),d=h[_]+m;var T=l?(s[x]||[])[_]:s[d];T&&(HN(r,T,x,_,t),u&&T.l&&s["!links"].push([d,T.l]))}}var y=a.CodeName||a.name||i;return u&&ae(r,574,I_((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&ae(r,229,B_(s["!merges"])),u&&VN(r,s),ae(r,442,_x(y)),u&&ON(r,s),ae(r,10),r.end()}function WN(e,t,n){var r=tn(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=n.biff==8,l=n.biff==5;if(ae(r,2057,vd(e,5,n)),n.bookType=="xla"&&ae(r,135),ae(r,225,a?Tn(1200):null),ae(r,193,m_(2)),l&&ae(r,191),l&&ae(r,192),ae(r,226),ae(r,92,w_("SheetJS",n)),ae(r,66,Tn(a?1200:1252)),a&&ae(r,353,Tn(0)),a&&ae(r,448),ae(r,317,q_(e.SheetNames.length)),a&&e.vbaraw&&ae(r,211),a&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";ae(r,442,_x(u))}ae(r,156,Tn(17)),ae(r,25,qt(!1)),ae(r,18,qt(!1)),ae(r,19,Tn(0)),a&&ae(r,431,qt(!1)),a&&ae(r,444,Tn(0)),ae(r,61,N_()),ae(r,64,qt(!1)),ae(r,141,Tn(0)),ae(r,34,qt(YA(e)=="true")),ae(r,14,qt(!0)),a&&ae(r,439,qt(!1)),ae(r,218,Tn(0)),bN(r,e,n),UN(r,e.SSF,n),BN(r,n),a&&ae(r,352,qt(!1));var d=r.end(),m=tn();a&&ae(m,140,H_()),a&&n.Strings&&RN(m,252,A_(n.Strings)),ae(m,10);var h=m.end(),g=tn(),v=0,x=0;for(x=0;x<e.SheetNames.length;++x)v+=(a?12:11)+(a?2:1)*e.SheetNames[x].length;var _=d.length+v+h.length;for(x=0;x<e.SheetNames.length;++x){var T=s[x]||{};ae(g,133,C_({pos:_,hs:T.Hidden||0,dt:0,name:e.SheetNames[x]},n)),_+=t[x].length}var y=g.end();if(v!=y.length)throw new Error("BS8 "+v+" != "+y.length);var E=[];return d.length&&E.push(d),y.length&&E.push(y),h.length&&E.push(h),It(E)}function qN(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=rn(ct)),e&&e.SSF&&(tu(),eu(e.SSF),n.revssf=nu(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,wd(n),n.cellXfs=[],Yr(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)r[r.length]=zN(i,n,e);return r.unshift(WN(e,r,n)),It(r)}function Yx(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(!(!r||!r["!ref"])){var i=pn(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return qN(e,t);case 4:case 3:case 2:return LN(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function $N(e,t,n,r){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var a=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>n||i[u].s.c>o)&&!(i[u].e.r<n||i[u].e.c<o)){if(i[u].s.r<n||i[u].s.c<o){a=-1;break}a=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(a<0)){var d=We({r:n,c:o}),m=r.dense?(e[n]||[])[o]:e[d],h=m&&m.v!=null&&(m.h||ST(m.w||(gr(m),m.w)||""))||"",g={};a>1&&(g.rowspan=a),l>1&&(g.colspan=l),r.editable?h='<span contenteditable="true">'+h+"</span>":m&&(g["data-t"]=m&&m.t||"z",m.v!=null&&(g["data-v"]=m.v),m.z!=null&&(g["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+m.l.Target+'">'+h+"</a>")),g.id=(r.id||"sjs")+"-"+d,s.push(oe("td",h,g))}}var v="<tr>";return v+s.join("")+"</tr>"}var JN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',KN="</body></html>";function YN(e,t,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function jx(e,t){var n=t||{},r=n.header!=null?n.header:JN,i=n.footer!=null?n.footer:KN,s=[r],o=pn(e["!ref"]);n.dense=Array.isArray(e),s.push(YN(e,o,n));for(var a=o.s.r;a<=o.e.r;++a)s.push($N(e,o,a,n));return s.push("</table>"+i),s.join("")}function Xx(e,t,n){var r=n||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var o=typeof r.origin=="string"?_t(r.origin):r.origin;i=o.r,s=o.c}var a=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,a.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var d=pn(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),i==-1&&(u.e.r=i=d.e.r+1)}var m=[],h=0,g=e["!rows"]||(e["!rows"]=[]),v=0,x=0,_=0,T=0,y=0,E=0;for(e["!cols"]||(e["!cols"]=[]);v<a.length&&x<l;++v){var A=a[v];if(Lh(A)){if(r.display)continue;g[x]={hidden:!0}}var b=A.children;for(_=T=0;_<b.length;++_){var D=b[_];if(!(r.display&&Lh(D))){var C=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):NT(D.innerHTML),L=D.getAttribute("data-z")||D.getAttribute("z");for(h=0;h<m.length;++h){var P=m[h];P.s.c==T+s&&P.s.r<x+i&&x+i<=P.e.r&&(T=P.e.c+1-s,h=-1)}E=+D.getAttribute("colspan")||1,((y=+D.getAttribute("rowspan")||1)>1||E>1)&&m.push({s:{r:x+i,c:T+s},e:{r:x+i+(y||1)-1,c:T+s+(E||1)-1}});var U={t:"s",v:C},W=D.getAttribute("data-t")||D.getAttribute("t")||"";C!=null&&(C.length==0?U.t=W||"z":r.raw||C.trim().length==0||W=="s"||(C==="TRUE"?U={t:"b",v:!0}:C==="FALSE"?U={t:"b",v:!1}:isNaN(ur(C))?isNaN(Uo(C).getDate())||(U={t:"d",v:Jt(C)},r.cellDates||(U={t:"n",v:nn(U.v)}),U.z=r.dateNF||ct[14]):U={t:"n",v:ur(C)})),U.z===void 0&&L!=null&&(U.z=L);var V="",Y=D.getElementsByTagName("A");if(Y&&Y.length)for(var le=0;le<Y.length&&!(Y[le].hasAttribute("href")&&(V=Y[le].getAttribute("href"),V.charAt(0)!="#"));++le);V&&V.charAt(0)!="#"&&(U.l={Target:V}),r.dense?(e[x+i]||(e[x+i]=[]),e[x+i][T+s]=U):e[We({c:T+s,r:x+i})]=U,u.e.c<T+s&&(u.e.c=T+s),T+=E}}++x}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),u.e.r=Math.max(u.e.r,x-1+i),e["!ref"]=mt(u),x>=l&&(e["!fullref"]=mt((u.e.r=a.length-v+x-1+i,u))),e}function Qx(e,t){var n=t||{},r=n.dense?[]:{};return Xx(r,e,t)}function jN(e,t){return vi(Qx(e,t),t)}function Lh(e){var t="",n=XN(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function XN(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var QN=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Bo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return gt+t}}(),bh=function(){var e=function(s){return He(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(s,o,a){var l=[];l.push('      <table:table table:name="'+He(o.SheetNames[a])+`" table:style-name="ta1">
`);var u=0,d=0,m=pn(s["!ref"]||"A1"),h=s["!merges"]||[],g=0,v=Array.isArray(s);if(s["!cols"])for(d=0;d<=m.e.c;++d)l.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",_=s["!rows"]||[];for(u=0;u<m.s.r;++u)x=_[u]?' table:style-name="ro'+_[u].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=m.e.r;++u){for(x=_[u]?' table:style-name="ro'+_[u].ods+'"':"",l.push("        <table:table-row"+x+`>
`),d=0;d<m.s.c;++d)l.push(t);for(;d<=m.e.c;++d){var T=!1,y={},E="";for(g=0;g!=h.length;++g)if(!(h[g].s.c>d)&&!(h[g].s.r>u)&&!(h[g].e.c<d)&&!(h[g].e.r<u)){(h[g].s.c!=d||h[g].s.r!=u)&&(T=!0),y["table:number-columns-spanned"]=h[g].e.c-h[g].s.c+1,y["table:number-rows-spanned"]=h[g].e.r-h[g].s.r+1;break}if(T){l.push(n);continue}var A=We({r:u,c:d}),b=v?(s[u]||[])[d]:s[A];if(b&&b.f&&(y["table:formula"]=He(vC(b.f)),b.F&&b.F.slice(0,A.length)==A)){var D=pn(b.F);y["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,y["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!b){l.push(t);continue}switch(b.t){case"b":E=b.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=b.v?"true":"false";break;case"n":E=b.w||String(b.v||0),y["office:value-type"]="float",y["office:value"]=b.v||0;break;case"s":case"str":E=b.v==null?"":b.v,y["office:value-type"]="string";break;case"d":E=b.w||Jt(b.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Jt(b.v).toISOString(),y["table:style-name"]="ce1";break;default:l.push(t);continue}var C=e(E);if(b.l&&b.l.Target){var L=b.l.Target;L=L.charAt(0)=="#"?"#"+yC(L.slice(1)):L,L.charAt(0)!="#"&&!L.match(/^\w+:/)&&(L="../"+L),C=oe("text:a",C,{"xlink:href":L.replace(/&/g,"&amp;")})}l.push("          "+oe("table:table-cell",oe("text:p",C,{}),y)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var m=u["!cols"][d];if(m.width==null&&m.wpx==null&&m.wch==null)continue;yd(m),m.ods=a;var h=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=l;var m=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,a){var l=[gt],u=Bo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Bo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+u+d+`>
`),l.push(hx().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var m=0;m!=o.SheetNames.length;++m)l.push(r(o.Sheets[o.SheetNames[m]],o,m));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function Zx(e,t){if(t.bookType=="fods")return bh(e,t);var n=ld(),r="",i=[],s=[];return r="mimetype",Pe(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",Pe(n,r,bh(e,t)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",Pe(n,r,QN(e,t)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",Pe(n,r,gt+hx()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",Pe(n,r,c_(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",Pe(n,r,l_(i)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Pl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ZN(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Un(Oo(e))}function eI(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}function qr(e){var t=e.reduce(function(i,s){return i+s.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(i){n.set(i,r),r+=i.length}),n}function tI(e,t,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=n>=0?0:128}function Vo(e,t){var n=t?t[0]:0,r=e[n]&127;e:if(e[n++]>=128&&(r|=(e[n]&127)<<7,e[n++]<128||(r|=(e[n]&127)<<14,e[n++]<128)||(r|=(e[n]&127)<<21,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),r}function Ve(e){var t=new Uint8Array(7);t[0]=e&127;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383||(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)||(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)||(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)||(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103))break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function rs(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function xt(e){for(var t=[],n=[0];n[0]<e.length;){var r=n[0],i=Vo(e,n),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=n[0];e[n[0]++]>=128;);a=e.slice(l,n[0])}break;case 5:o=4,a=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,a=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=Vo(e,n),a=e.slice(n[0],n[0]+o),n[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var u={data:a,type:s};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function Ct(e){var t=[];return e.forEach(function(n,r){n.forEach(function(i){i.data&&(t.push(Ve(r*8+i.type)),i.type==2&&t.push(Ve(i.data.length)),t.push(i.data))})}),qr(t)}function Fn(e){for(var t,n=[],r=[0];r[0]<e.length;){var i=Vo(e,r),s=xt(e.slice(r[0],r[0]+i));r[0]+=i;var o={id:rs(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=xt(a.data),u=rs(l[3][0].data);o.messages.push({meta:l,data:e.slice(r[0],r[0]+u)}),r[0]+=u}),(t=s[3])!=null&&t[0]&&(o.merge=rs(s[3][0].data)>>>0>0),n.push(o)}return n}function Ii(e){var t=[];return e.forEach(function(n){var r=[];r[1]=[{data:Ve(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:Ve(+!!n.merge),type:0}]);var i=[];n.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Ve(o.data.length)}],r[2].push({data:Ct(o.meta),type:2})});var s=Ct(r);t.push(Ve(s.length)),t.push(s),i.forEach(function(o){return t.push(o)})}),qr(t)}function nI(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=Vo(t,n),i=[];n[0]<t.length;){var s=t[n[0]]&3;if(s==0){var o=t[n[0]++]>>2;if(o<60)++o;else{var a=o-59;o=t[n[0]],a>1&&(o|=t[n[0]+1]<<8),a>2&&(o|=t[n[0]+2]<<16),a>3&&(o|=t[n[0]+3]<<24),o>>>=0,o++,n[0]+=a}i.push(t.slice(n[0],n[0]+o)),n[0]+=o;continue}else{var l=0,u=0;if(s==1?(u=(t[n[0]]>>2&7)+4,l=(t[n[0]++]&224)<<3,l|=t[n[0]++]):(u=(t[n[0]++]>>2)+1,s==2?(l=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(l=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),i=[qr(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var d=qr(i);if(d.length!=r)throw new Error("Unexpected length: ".concat(d.length," != ").concat(r));return d}function Mn(e){for(var t=[],n=0;n<e.length;){var r=e[n++],i=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(nI(r,e.slice(n,n+i))),n+=i}if(n!==e.length)throw new Error("data is not a valid framed stream!");return qr(t)}function ki(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),i=new Uint8Array(4);t.push(i);var s=Ve(r),o=s.length;t.push(s),r<=60?(o++,t.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),o+=r,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,n+=r}return qr(t)}function Xu(e,t){var n=new Uint8Array(32),r=Pl(n),i=12,s=0;switch(n[0]=5,e.t){case"n":n[1]=2,tI(n,i,e.v),s|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,s,!0),n.slice(0,i)}function Qu(e,t){var n=new Uint8Array(32),r=Pl(n),i=12,s=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,s,!0),n.slice(0,i)}function wr(e){var t=xt(e);return Vo(t[1][0].data)}function rI(e,t,n){var r,i,s,o;if(!((r=e[6])!=null&&r[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&rs(e[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,u=Pl(e[7][0].data),d=0,m=[],h=Pl(e[4][0].data),g=0,v=[],x=0;x<t.length;++x){if(t[x]==null){u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535);continue}u.setUint16(x*2,d,!0),h.setUint16(x*2,g,!0);var _,T;switch(typeof t[x]){case"string":_=Xu({t:"s",v:t[x]},n),T=Qu({t:"s",v:t[x]},n);break;case"number":_=Xu({t:"n",v:t[x]},n),T=Qu({t:"n",v:t[x]},n);break;case"boolean":_=Xu({t:"b",v:t[x]},n),T=Qu({t:"b",v:t[x]},n);break;default:throw new Error("Unsupported value "+t[x])}m.push(_),d+=_.length,v.push(T),g+=T.length,++l}for(e[2][0].data=Ve(l);x<e[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535,!0);return e[6][0].data=qr(m),e[3][0].data=qr(v),l}function iI(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=pn(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(mt(r)));var s=Fl(n,{range:r,header:1}),o=["~Sh33tJ5~"];s.forEach(function(H){return H.forEach(function(B){typeof B=="string"&&o.push(B)})});var a={},l=[],u=$e.read(t.numbers,{type:"base64"});u.FileIndex.map(function(H,B){return[H,u.FullPaths[B]]}).forEach(function(H){var B=H[0],O=H[1];if(B.type==2&&B.name.match(/\.iwa/)){var Q=B.content,pe=Mn(Q),Te=Fn(pe);Te.forEach(function(Ee){l.push(Ee.id),a[Ee.id]={deps:[],location:O,type:rs(Ee.messages[0].meta[1][0].data)}})}}),l.sort(function(H,B){return H-B});var d=l.filter(function(H){return H>1}).map(function(H){return[H,Ve(H)]});u.FileIndex.map(function(H,B){return[H,u.FullPaths[B]]}).forEach(function(H){var B=H[0];if(H[1],!!B.name.match(/\.iwa/)){var O=Fn(Mn(B.content));O.forEach(function(Q){Q.messages.forEach(function(pe){d.forEach(function(Te){Q.messages.some(function(Ee){return rs(Ee.meta[1][0].data)!=11006&&eI(Ee.data,Te[1])})&&a[Te[0]].deps.push(Q.id)})})})}});for(var m=$e.find(u,a[1].location),h=Fn(Mn(m.content)),g,v=0;v<h.length;++v){var x=h[v];x.id==1&&(g=x)}var _=wr(xt(g.messages[0].data)[1][0].data);for(m=$e.find(u,a[_].location),h=Fn(Mn(m.content)),v=0;v<h.length;++v)x=h[v],x.id==_&&(g=x);for(_=wr(xt(g.messages[0].data)[2][0].data),m=$e.find(u,a[_].location),h=Fn(Mn(m.content)),v=0;v<h.length;++v)x=h[v],x.id==_&&(g=x);for(_=wr(xt(g.messages[0].data)[2][0].data),m=$e.find(u,a[_].location),h=Fn(Mn(m.content)),v=0;v<h.length;++v)x=h[v],x.id==_&&(g=x);var T=xt(g.messages[0].data);{T[6][0].data=Ve(r.e.r+1),T[7][0].data=Ve(r.e.c+1);var y=wr(T[46][0].data),E=$e.find(u,a[y].location),A=Fn(Mn(E.content));{for(var b=0;b<A.length&&A[b].id!=y;++b);if(A[b].id!=y)throw"Bad ColumnRowUIDMapArchive";var D=xt(A[b].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var C=0;C<=r.e.c;++C){var L=[];L[1]=L[2]=[{type:0,data:Ve(C+420690)}],D[1].push({type:2,data:Ct(L)}),D[2].push({type:0,data:Ve(C)}),D[3].push({type:0,data:Ve(C)})}D[4]=[],D[5]=[],D[6]=[];for(var P=0;P<=r.e.r;++P)L=[],L[1]=L[2]=[{type:0,data:Ve(P+726270)}],D[4].push({type:2,data:Ct(L)}),D[5].push({type:0,data:Ve(P)}),D[6].push({type:0,data:Ve(P)});A[b].messages[0].data=Ct(D)}E.content=ki(Ii(A)),E.size=E.content.length,delete T[46];var U=xt(T[4][0].data);{U[7][0].data=Ve(r.e.r+1);var W=xt(U[1][0].data),V=wr(W[2][0].data);E=$e.find(u,a[V].location),A=Fn(Mn(E.content));{if(A[0].id!=V)throw"Bad HeaderStorageBucket";var Y=xt(A[0].messages[0].data);for(P=0;P<s.length;++P){var le=xt(Y[2][0].data);le[1][0].data=Ve(P),le[4][0].data=Ve(s[P].length),Y[2][P]={type:Y[2][0].type,data:Ct(le)}}A[0].messages[0].data=Ct(Y)}E.content=ki(Ii(A)),E.size=E.content.length;var ue=wr(U[2][0].data);E=$e.find(u,a[ue].location),A=Fn(Mn(E.content));{if(A[0].id!=ue)throw"Bad HeaderStorageBucket";for(Y=xt(A[0].messages[0].data),C=0;C<=r.e.c;++C)le=xt(Y[2][0].data),le[1][0].data=Ve(C),le[4][0].data=Ve(r.e.r+1),Y[2][C]={type:Y[2][0].type,data:Ct(le)};A[0].messages[0].data=Ct(Y)}E.content=ki(Ii(A)),E.size=E.content.length;var _e=wr(U[4][0].data);(function(){for(var H=$e.find(u,a[_e].location),B=Fn(Mn(H.content)),O,Q=0;Q<B.length;++Q){var pe=B[Q];pe.id==_e&&(O=pe)}var Te=xt(O.messages[0].data);{Te[3]=[];var Ee=[];o.forEach(function(De,ft){Ee[1]=[{type:0,data:Ve(ft)}],Ee[2]=[{type:0,data:Ve(1)}],Ee[3]=[{type:2,data:ZN(De)}],Te[3].push({type:2,data:Ct(Ee)})})}O.messages[0].data=Ct(Te);var ce=Ii(B),qe=ki(ce);H.content=qe,H.size=H.content.length})();var Ne=xt(U[3][0].data);{var ee=Ne[1][0];delete Ne[2];var ve=xt(ee.data);{var Se=wr(ve[2][0].data);(function(){for(var H=$e.find(u,a[Se].location),B=Fn(Mn(H.content)),O,Q=0;Q<B.length;++Q){var pe=B[Q];pe.id==Se&&(O=pe)}var Te=xt(O.messages[0].data);{delete Te[6],delete Ne[7];var Ee=new Uint8Array(Te[5][0].data);Te[5]=[];for(var ce=0,qe=0;qe<=r.e.r;++qe){var De=xt(Ee);ce+=rI(De,s[qe],o),De[1][0].data=Ve(qe),Te[5].push({data:Ct(De),type:2})}Te[1]=[{type:0,data:Ve(r.e.c+1)}],Te[2]=[{type:0,data:Ve(r.e.r+1)}],Te[3]=[{type:0,data:Ve(ce)}],Te[4]=[{type:0,data:Ve(r.e.r+1)}]}O.messages[0].data=Ct(Te);var ft=Ii(B),Le=ki(ft);H.content=Le,H.size=H.content.length})()}ee.data=Ct(ve)}U[3][0].data=Ct(Ne)}T[4][0].data=Ct(U)}g.messages[0].data=Ct(T);var Fe=Ii(h),F=ki(Fe);return m.content=F,m.size=m.content.length,u}function sI(e){return function(n){for(var r=0;r!=e.length;++r){var i=e[r];n[i[0]]===void 0&&(n[i[0]]=i[1]),i[2]==="n"&&(n[i[0]]=Number(n[i[0]]))}}}function wd(e){sI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function oI(e,t){return t.bookType=="ods"?Zx(e,t):t.bookType=="numbers"?iI(e,t):t.bookType=="xlsb"?aI(e,t):lI(e,t)}function aI(e,t){qi=1024,e&&!e.SSF&&(e.SSF=rn(ct)),e&&e.SSF&&(tu(),eu(e.SSF),t.revssf=nu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,go?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n=t.bookType=="xlsb"?"bin":"xml",r=Lx.indexOf(t.bookType)>-1,i=cx();wd(t=t||{});var s=ld(),o="",a=0;if(t.cellXfs=[],Yr(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Pe(s,o,px(e.Props,t)),i.coreprops.push(o),Ge(t.rels,2,o,Ue.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Pe(s,o,gx(e.Props)),i.extprops.push(o),Ge(t.rels,3,o,Ue.EXT_PROPS),e.Custprops!==e.Props&&Mt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Pe(s,o,xx(e.Custprops)),i.custprops.push(o),Ge(t.rels,4,o,Ue.CUST_PROPS)),a=1;a<=e.SheetNames.length;++a){var d={"!id":{}},m=e.Sheets[e.SheetNames[a-1]],h=(m||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+a+"."+n,Pe(s,o,cN(a-1,o,t,e,d)),i.sheets.push(o),Ge(t.wbrels,-1,"worksheets/sheet"+a+"."+n,Ue.WS[0])}if(m){var g=m["!comments"],v=!1,x="";g&&g.length>0&&(x="xl/comments"+a+"."+n,Pe(s,x,hN(g,x)),i.comments.push(x),Ge(d,-1,"../comments"+a+"."+n,Ue.CMNT),v=!0),m["!legacy"]&&v&&Pe(s,"xl/drawings/vmlDrawing"+a+".vml",Mx(a,m["!comments"])),delete m["!comments"],delete m["!legacy"]}d["!id"].rId1&&Pe(s,dx(o),ts(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,Pe(s,o,dN(t.Strings,o,t)),i.strs.push(o),Ge(t.wbrels,-1,"sharedStrings."+n,Ue.SST)),o="xl/workbook."+n,Pe(s,o,uN(e,o)),i.workbooks.push(o),Ge(t.rels,1,o,Ue.WB),o="xl/theme/theme1.xml",Pe(s,o,Px(e.Themes,t)),i.themes.push(o),Ge(t.wbrels,-1,"theme/theme1.xml",Ue.THEME),o="xl/styles."+n,Pe(s,o,fN(e,o,t)),i.styles.push(o),Ge(t.wbrels,-1,"styles."+n,Ue.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",Pe(s,o,e.vbaraw),i.vba.push(o),Ge(t.wbrels,-1,"vbaProject.bin",Ue.VBA)),o="xl/metadata."+n,Pe(s,o,pN(o)),i.metadata.push(o),Ge(t.wbrels,-1,"metadata."+n,Ue.XLMETA),Pe(s,"[Content_Types].xml",fx(i,t)),Pe(s,"_rels/.rels",ts(t.rels)),Pe(s,"xl/_rels/workbook."+n+".rels",ts(t.wbrels)),delete t.revssf,delete t.ssf,s}function lI(e,t){qi=1024,e&&!e.SSF&&(e.SSF=rn(ct)),e&&e.SSF&&(tu(),eu(e.SSF),t.revssf=nu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,go?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=Lx.indexOf(t.bookType)>-1,i=cx();wd(t=t||{});var s=ld(),o="",a=0;if(t.cellXfs=[],Yr(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Pe(s,o,px(e.Props,t)),i.coreprops.push(o),Ge(t.rels,2,o,Ue.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Pe(s,o,gx(e.Props)),i.extprops.push(o),Ge(t.rels,3,o,Ue.EXT_PROPS),e.Custprops!==e.Props&&Mt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Pe(s,o,xx(e.Custprops)),i.custprops.push(o),Ge(t.rels,4,o,Ue.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,a=1;a<=e.SheetNames.length;++a){var m={"!id":{}},h=e.Sheets[e.SheetNames[a-1]],g=(h||{})["!type"]||"sheet";switch(g){case"chart":default:o="xl/worksheets/sheet"+a+"."+n,Pe(s,o,Wx(a-1,t,e,m)),i.sheets.push(o),Ge(t.wbrels,-1,"worksheets/sheet"+a+"."+n,Ue.WS[0])}if(h){var v=h["!comments"],x=!1,_="";if(v&&v.length>0){var T=!1;v.forEach(function(y){y[1].forEach(function(E){E.T==!0&&(T=!0)})}),T&&(_="xl/threadedComments/threadedComment"+a+"."+n,Pe(s,_,BS(v,d,t)),i.threadedcomments.push(_),Ge(m,-1,"../threadedComments/threadedComment"+a+"."+n,Ue.TCMNT)),_="xl/comments"+a+"."+n,Pe(s,_,Dx(v)),i.comments.push(_),Ge(m,-1,"../comments"+a+"."+n,Ue.CMNT),x=!0}h["!legacy"]&&x&&Pe(s,"xl/drawings/vmlDrawing"+a+".vml",Mx(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}m["!id"].rId1&&Pe(s,dx(o),ts(m))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,Pe(s,o,Cx(t.Strings,t)),i.strs.push(o),Ge(t.wbrels,-1,"sharedStrings."+n,Ue.SST)),o="xl/workbook."+n,Pe(s,o,Jx(e)),i.workbooks.push(o),Ge(t.rels,1,o,Ue.WB),o="xl/theme/theme1.xml",Pe(s,o,Px(e.Themes,t)),i.themes.push(o),Ge(t.wbrels,-1,"theme/theme1.xml",Ue.THEME),o="xl/styles."+n,Pe(s,o,kx(e,t)),i.styles.push(o),Ge(t.wbrels,-1,"styles."+n,Ue.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",Pe(s,o,e.vbaraw),i.vba.push(o),Ge(t.wbrels,-1,"vbaProject.bin",Ue.VBA)),o="xl/metadata."+n,Pe(s,o,Fx()),i.metadata.push(o),Ge(t.wbrels,-1,"metadata."+n,Ue.XLMETA),d.length>1&&(o="xl/persons/person.xml",Pe(s,o,VS(d)),i.people.push(o),Ge(t.wbrels,-1,"persons/person.xml",Ue.PEOPLE)),Pe(s,"[Content_Types].xml",fx(i,t)),Pe(s,"_rels/.rels",ts(t.rels)),Pe(s,"xl/_rels/workbook."+n+".rels",ts(t.wbrels)),delete t.revssf,delete t.ssf,s}function uI(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=mr(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function ev(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Ko(t.file,$e.write(e,{type:Be?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return $e.write(e,t)}function cI(e,t){var n=rn(t||{}),r=oI(e,n);return fI(r,n)}function fI(e,t){var n={},r=Be?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?$e.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Zl(i))}return t.password&&typeof encrypt_agile<"u"?ev(encrypt_agile(i,t.password),t):t.type==="file"?Ko(t.file,i):t.type=="string"?fo(i):i}function dI(e,t){var n=t||{},r=IN(e,n);return ev(r,n)}function Kn(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return bo(Oo(r));case"binary":return Oo(r);case"string":return e;case"file":return Ko(t.file,r,"utf8");case"buffer":return Be?yr(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Kn(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function hI(e,t){switch(t.type){case"base64":return bo(e);case"binary":return e;case"string":return e;case"file":return Ko(t.file,e,"binary");case"buffer":return Be?yr(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Pa(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return t.type=="base64"?bo(n):t.type=="string"?fo(n):n;case"file":return Ko(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function tv(e,t){GE(),QA(e);var n=rn(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=tv(e,n);return n.type="array",Zl(r)}var i=0;if(n.sheet&&(typeof n.sheet=="number"?i=n.sheet:i=e.SheetNames.indexOf(n.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return Kn(AN(e,n),n);case"slk":case"sylk":return Kn(Y_.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"htm":case"html":return Kn(jx(e.Sheets[e.SheetNames[i]],n),n);case"txt":return hI(rv(e.Sheets[e.SheetNames[i]],n),n);case"csv":return Kn(Cd(e.Sheets[e.SheetNames[i]],n),n,"\uFEFF");case"dif":return Kn(j_.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"dbf":return Pa(K_.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"prn":return Kn(X_.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"rtf":return Kn(iS.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"eth":return Kn(wx.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"fods":return Kn(Zx(e,n),n);case"wk1":return Pa(kh.sheet_to_wk1(e.Sheets[e.SheetNames[i]],n),n);case"wk3":return Pa(kh.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),Pa(Yx(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),dI(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return cI(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function pI(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(e.bookType=n.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function nv(e,t,n){var r={};return r.type="file",r.file=t,pI(r),tv(e,r)}function mI(e,t,n,r,i,s,o,a){var l=Pt(n),u=a.defval,d=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),m=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:n,enumerable:!1})}catch{h.__rowNum__=n}else h.__rowNum__=n;if(!o||e[n])for(var g=t.s.c;g<=t.e.c;++g){var v=o?e[n][g]:e[r[g]+l];if(v===void 0||v.t===void 0){if(u===void 0)continue;s[g]!=null&&(h[s[g]]=u);continue}var x=v.v;switch(v.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[g]!=null){if(x==null)if(v.t=="e"&&x===null)h[s[g]]=null;else if(u!==void 0)h[s[g]]=u;else if(d&&x===null)h[s[g]]=null;else continue;else h[s[g]]=d&&(v.t!=="n"||v.t==="n"&&a.rawNumbers!==!1)?x:gr(v,x,a);x!=null&&(m=!1)}}return{row:h,isempty:m}}function Fl(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},r=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?r=1:u.header==="A"?r=2:Array.isArray(u.header)?r=3:u.header==null&&(r=0),typeof d){case"string":l=Qe(d);break;case"number":l=Qe(e["!ref"]),l.s.r=d;break;default:l=d}r>0&&(i=0);var m=Pt(l.s.r),h=[],g=[],v=0,x=0,_=Array.isArray(e),T=l.s.r,y=0,E={};_&&!e[T]&&(e[T]=[]);var A=u.skipHidden&&e["!cols"]||[],b=u.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(A[y]||{}).hidden)switch(h[y]=Bt(y),n=_?e[T][y]:e[h[y]+m],r){case 1:s[y]=y-l.s.c;break;case 2:s[y]=h[y];break;case 3:s[y]=u.header[y-l.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),a=o=gr(n,null,u),x=E[o]||0,!x)E[o]=1;else{do a=o+"_"+x++;while(E[a]);E[o]=x,E[a]=1}s[y]=a}for(T=l.s.r+i;T<=l.e.r;++T)if(!(b[T]||{}).hidden){var D=mI(e,l,T,h,r,s,_,u);(D.isempty===!1||(r===1?u.blankrows!==!1:u.blankrows))&&(g[v++]=D.row)}return g.length=v,g}var Uh=/"/g;function gI(e,t,n,r,i,s,o,a){for(var l=!0,u=[],d="",m=Pt(n),h=t.s.c;h<=t.e.c;++h)if(r[h]){var g=a.dense?(e[n]||[])[h]:e[r[h]+m];if(g==null)d="";else if(g.v!=null){l=!1,d=""+(a.rawNumbers&&g.t=="n"?g.v:gr(g,null,a));for(var v=0,x=0;v!==d.length;++v)if((x=d.charCodeAt(v))===i||x===s||x===34||a.forceQuotes){d='"'+d.replace(Uh,'""')+'"';break}d=="ID"&&(d='"ID"')}else g.f!=null&&!g.F?(l=!1,d="="+g.f,d.indexOf(",")>=0&&(d='"'+d.replace(Uh,'""')+'"')):d="";u.push(d)}return a.blankrows===!1&&l?null:u.join(o)}function Cd(e,t){var n=[],r=t??{};if(e==null||e["!ref"]==null)return"";var i=Qe(e["!ref"]),s=r.FS!==void 0?r.FS:",",o=s.charCodeAt(0),a=r.RS!==void 0?r.RS:`
`,l=a.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",m=[];r.dense=Array.isArray(e);for(var h=r.skipHidden&&e["!cols"]||[],g=r.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(h[v]||{}).hidden||(m[v]=Bt(v));for(var x=0,_=i.s.r;_<=i.e.r;++_)(g[_]||{}).hidden||(d=gI(e,i,_,m,o,l,s,r),d!=null&&(r.strip&&(d=d.replace(u,"")),(d||r.blankrows!==!1)&&n.push((x++?a:"")+d)));return delete r.dense,n.join("")}function rv(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=Cd(e,t);return n}function xI(e){var t="",n,r="";if(e==null||e["!ref"]==null)return[];var i=Qe(e["!ref"]),s="",o=[],a,l=[],u=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)o[a]=Bt(a);for(var d=i.s.r;d<=i.e.r;++d)for(s=Pt(d),a=i.s.c;a<=i.e.c;++a)if(t=o[a]+s,n=u?(e[d]||[])[a]:e[t],r="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;r=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}l[l.length]=t+"="+r}return l}function iv(e,t,n){var r=n||{},i=+!r.skipHeader,s=e||{},o=0,a=0;if(s&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?_t(r.origin):r.origin;o=l.r,a=l.c}var u,d={s:{c:0,r:0},e:{c:a,r:o+t.length-1+i}};if(s["!ref"]){var m=Qe(s["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),o==-1&&(o=m.e.r+1,d.e.r=o+t.length-1+i)}else o==-1&&(o=0,d.e.r=t.length-1+i);var h=r.header||[],g=0;t.forEach(function(x,_){Mt(x).forEach(function(T){(g=h.indexOf(T))==-1&&(h[g=h.length]=T);var y=x[T],E="z",A="",b=We({c:a+g,r:o+_+i});u=Go(s,b),y&&typeof y=="object"&&!(y instanceof Date)?s[b]=y:(typeof y=="number"?E="n":typeof y=="boolean"?E="b":typeof y=="string"?E="s":y instanceof Date?(E="d",r.cellDates||(E="n",y=nn(y)),A=r.dateNF||ct[14]):y===null&&r.nullError&&(E="e",y=0),u?(u.t=E,u.v=y,delete u.w,delete u.R,A&&(u.z=A)):s[b]=u={t:E,v:y},A&&(u.z=A))})}),d.e.c=Math.max(d.e.c,a+h.length-1);var v=Pt(o);if(i)for(g=0;g<h.length;++g)s[Bt(g+a)+v]={t:"s",v:h[g]};return s["!ref"]=mt(d),s}function vI(e,t){return iv(null,e,t)}function Go(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var r=_t(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Go(e,We(t)):Go(e,We({r:t,c:n||0}))}function yI(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function EI(){return{SheetNames:[],Sheets:{}}}function TI(e,t,n,r){var i=1;if(!n)for(;i<=65535&&e.SheetNames.indexOf(n="Sheet"+i)!=-1;++i,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||n;for(++i;i<=65535&&e.SheetNames.indexOf(n=o+i)!=-1;++i);}if($x(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function _I(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=yI(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n}function SI(e,t){return e.z=t,e}function sv(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function wI(e,t,n){return sv(e,"#"+t,n)}function CI(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function AI(e,t,n,r){for(var i=typeof t!="string"?t:Qe(t),s=typeof t=="string"?t:mt(t),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=Go(e,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=n,r&&(l.D=!0))}return e}var En={encode_col:Bt,encode_row:Pt,encode_cell:We,encode_range:mt,decode_col:pd,decode_row:hd,split_cell:GT,decode_cell:_t,decode_range:pn,format_cell:gr,sheet_add_aoa:ix,sheet_add_json:iv,sheet_add_dom:Xx,aoa_to_sheet:ys,json_to_sheet:vI,table_to_sheet:Qx,table_to_book:jN,sheet_to_csv:Cd,sheet_to_txt:rv,sheet_to_json:Fl,sheet_to_html:jx,sheet_to_formulae:xI,sheet_to_row_object_array:Fl,sheet_get_cell:Go,book_new:EI,book_append_sheet:TI,book_set_sheet_visibility:_I,cell_set_number_format:SI,cell_set_hyperlink:sv,cell_set_internal_link:wI,cell_add_comment:CI,sheet_set_array_formula:AI,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const NI={en:{player:"PLAYER",restart:"Restart",exit:"Exit",features:"Features",selected:"selected",matches:"Matches",discarded:"Discarded",identified:"1 Entity identified",potential:"potential matches",excluded:"Excluded by selection",noMatches:"No matches found.",tryUnselecting:"Try unselecting some features.",speciesDetails:"Species Details",morphology:"Morphology & Traits",close:"Close",resources:"Resources",viewResults:"View Results",openSaved:"Open",editKey:"Edit",exportJson:"JSON",exportXlsx:"XLSX"},pt:{player:"PLAYER",restart:"Reiniciar",exit:"Sair",features:"Caractersticas",selected:"selecionado(s)",matches:"Compatveis",discarded:"Descartados",identified:"1 Entidade identificada",potential:"matches potenciais",excluded:"Excludo pela seleo",noMatches:"Nenhum resultado.",tryUnselecting:"Tente remover selees.",speciesDetails:"Detalhes da Espcie",morphology:"Morfologia & Caractersticas",close:"Fechar",resources:"Recursos Adicionais",viewResults:"Ver Resultados",openSaved:"Abrir",editKey:"Editar",exportJson:"JSON",exportXlsx:"XLSX"}},II=({project:e,onBack:t,language:n,onOpenSaved:r,onEditKey:i})=>{const s=NI[n],[o,a]=Ae.useState({}),[l,u]=Ae.useState(!1),[d,m]=Ae.useState(null),[h,g]=Ae.useState(null),[v,x]=Ae.useState("FILTERS"),_=(C,L)=>{a(P=>{const U=P[C]||[],W=U.includes(L);let V;if(W?V=U.filter(Y=>Y!==L):V=[...U,L],V.length===0){const{[C]:Y,...le}=P;return le}return{...P,[C]:V}})},T=()=>a({}),{remaining:y,discarded:E}=Ae.useMemo(()=>{const C=[],L=[];return e.entities.forEach(P=>{let U=!0;for(const[W,V]of Object.entries(o)){const Y=P.traits[W]||[];if(!V.some(ue=>Y.includes(ue))){U=!1;break}}U?C.push(P):L.push(P)}),{remaining:C,discarded:L}},[e.entities,o]),A=Object.values(o).reduce((C,L)=>C+L.length,0),b=()=>{const C=JSON.stringify(e,null,2),L=new Blob([C],{type:"application/json"}),P=URL.createObjectURL(L),U=document.createElement("a");U.href=P,U.download=`${e.name.replace(/\s+/g,"_")}.json`,U.click(),URL.revokeObjectURL(P)},D=()=>{new Map(e.features.map(V=>[V.id,V]));const C=["Entity",...e.features.map(V=>V.name)],L=e.entities.map(V=>{const Y=[V.name];return e.features.forEach(le=>{const _e=(V.traits[le.id]||[]).map(Ne=>{var ee;return((ee=le.states.find(ve=>ve.id===Ne))==null?void 0:ee.label)||""}).filter(Boolean).join(", ");Y.push(_e)}),Y}),P=[C,...L],U=En.aoa_to_sheet(P),W=En.book_new();En.book_append_sheet(W,U,"Matrix"),nv(W,`${e.name.replace(/\s+/g,"_")}.xlsx`)};return p.jsxs("div",{className:"flex flex-col h-full bg-slate-100 font-sans absolute inset-0",children:[p.jsxs("header",{className:"bg-white border-b px-4 py-3 flex justify-between items-center shadow-sm z-30 shrink-0",children:[p.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[p.jsx("button",{onClick:t,className:"md:hidden p-2 -ml-2 text-slate-500 hover:bg-slate-100 rounded-full",children:p.jsx(z0,{size:20})}),p.jsx("div",{className:"overflow-hidden",children:p.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2 truncate",children:[p.jsx("span",{className:"hidden sm:inline-block bg-emerald-600 text-white text-xs px-2 py-1 rounded",children:s.player}),p.jsx("span",{className:"truncate",children:e.name})]})})]}),p.jsxs("div",{className:"flex gap-1 sm:gap-2 shrink-0",children:[r&&p.jsxs("button",{onClick:r,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",title:s.openSaved,children:[p.jsx(Zi,{size:18})," ",p.jsx("span",{className:"hidden lg:inline",children:s.openSaved})]}),i&&p.jsxs("button",{onClick:i,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",title:s.editKey,children:[p.jsx(bE,{size:18})," ",p.jsx("span",{className:"hidden lg:inline",children:s.editKey})]}),p.jsxs("button",{onClick:b,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",title:s.exportJson,children:[p.jsx(Jc,{size:18})," ",p.jsx("span",{className:"hidden lg:inline",children:s.exportJson})]}),p.jsxs("button",{onClick:D,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",title:s.exportXlsx,children:[p.jsx(Kc,{size:18})," ",p.jsx("span",{className:"hidden lg:inline",children:s.exportXlsx})]}),p.jsxs("button",{onClick:T,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",title:s.restart,children:[p.jsx(DE,{size:18})," ",p.jsx("span",{className:"hidden lg:inline",children:s.restart})]}),p.jsxs("button",{onClick:t,className:"hidden md:flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-600 hover:text-slate-900 transition-colors",children:[p.jsx(z0,{size:16})," ",s.exit]})]})]}),p.jsxs("div",{className:"md:hidden flex border-b bg-white z-20 shrink-0",children:[p.jsxs("button",{onClick:()=>x("FILTERS"),className:`flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 transition-colors relative ${v==="FILTERS"?"text-emerald-600":"text-slate-500 bg-slate-50"}`,children:[p.jsx(Gu,{size:16}),s.features,A>0&&p.jsx("span",{className:"bg-emerald-600 text-white text-[10px] w-5 h-5 flex items-center justify-center rounded-full",children:A}),v==="FILTERS"&&p.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-600"})]}),p.jsxs("button",{onClick:()=>x("RESULTS"),className:`flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 transition-colors relative ${v==="RESULTS"?"text-emerald-600":"text-slate-500 bg-slate-50"}`,children:[p.jsx(S1,{size:16}),s.matches,p.jsx("span",{className:"bg-slate-200 text-slate-700 text-[10px] px-1.5 py-0.5 rounded-full font-bold",children:y.length}),v==="RESULTS"&&p.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-600"})]})]}),p.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row relative",children:[p.jsxs("div",{className:`w-full md:w-1/3 lg:w-1/4 bg-white md:border-r flex flex-col h-full relative z-20 ${v==="FILTERS"?"flex":"hidden md:flex"}`,children:[p.jsx("div",{className:"hidden md:block p-4 border-b bg-slate-50",children:p.jsxs("h3",{className:"font-semibold text-slate-700 flex items-center gap-2",children:[p.jsx(Gu,{size:18})," ",s.features]})}),p.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 pb-24 md:pb-4 custom-scrollbar",children:e.features.map(C=>{const L=o[C.id]||[],P=L.length>0;return p.jsxs("div",{className:"space-y-2 relative",children:[p.jsxs("div",{className:"flex justify-between items-center sticky top-0 bg-white/95 backdrop-blur-sm py-1 z-10",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("h4",{className:`font-medium ${P?"text-emerald-600":"text-slate-700"}`,children:C.name}),C.imageUrl&&p.jsx(p.Fragment,{children:p.jsx("button",{className:"text-slate-400 hover:text-emerald-500 transition-colors p-1",onClick:U=>{U.stopPropagation(),m(d===C.id?null:C.id)},children:p.jsx(Wi,{size:14})})})]}),P&&p.jsx("span",{className:"text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full",children:L.length})]}),d===C.id&&C.imageUrl&&p.jsxs("div",{className:"mb-2 rounded-lg overflow-hidden border border-slate-200 shadow-sm animate-in fade-in zoom-in-95",children:[p.jsx("img",{src:C.imageUrl,alt:C.name,className:"w-full h-32 object-cover"}),p.jsx("div",{className:"bg-slate-50 p-1 text-center",children:p.jsx("button",{onClick:()=>m(null),className:"text-xs text-slate-500 underline",children:"Fechar"})})]}),p.jsx("div",{className:"grid grid-cols-1 gap-1",children:C.states.map(U=>{const W=L.includes(U.id);return p.jsxs("button",{onClick:()=>_(C.id,U.id),className:`w-full text-left px-3 py-3 md:py-2 text-sm rounded-lg transition-all flex items-center justify-between group active:scale-[0.98] touch-manipulation ${W?"bg-emerald-600 text-white shadow-md":"bg-slate-50 text-slate-600 border border-transparent hover:bg-slate-100 hover:border-slate-200"}`,children:[p.jsx("span",{className:"leading-tight",children:U.label}),W&&p.jsx(TE,{size:16,className:"shrink-0"})]},U.id)})})]},C.id)})}),p.jsx("div",{className:"md:hidden absolute bottom-4 left-4 right-4 z-30",children:p.jsxs("button",{onClick:()=>x("RESULTS"),className:"w-full bg-slate-900 text-white font-bold py-3 rounded-xl shadow-lg shadow-slate-900/20 flex items-center justify-center gap-2 animate-in slide-in-from-bottom-5",children:[s.viewResults," (",y.length,")"]})})]}),p.jsxs("div",{className:`flex-1 bg-slate-100 flex-col h-full overflow-hidden ${v==="RESULTS"?"flex":"hidden md:flex"}`,children:[p.jsxs("div",{className:"p-3 md:p-4 bg-white border-b flex justify-between items-center shadow-sm shrink-0",children:[p.jsxs("div",{className:"flex gap-2 md:gap-4 w-full md:w-auto bg-slate-100 p-1 rounded-lg",children:[p.jsxs("button",{className:`flex-1 md:flex-none text-xs md:text-sm font-medium px-3 py-1.5 rounded-md transition-all ${l?"text-slate-500":"bg-white text-slate-800 shadow-sm"}`,onClick:()=>u(!1),children:[s.matches," (",y.length,")"]}),p.jsxs("button",{className:`flex-1 md:flex-none text-xs md:text-sm font-medium px-3 py-1.5 rounded-md transition-all ${l?"bg-white text-slate-800 shadow-sm":"text-slate-500"}`,onClick:()=>u(!0),children:[s.discarded," (",E.length,")"]})]}),p.jsx("div",{className:"text-xs text-slate-400 hidden sm:block",children:y.length===1?s.identified:`${y.length} ${s.potential}`})]}),p.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 custom-scrollbar",onClick:()=>m(null),children:p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 pb-20 md:pb-0",children:[(l?E:y).map(C=>p.jsxs("div",{onClick:()=>g(C),className:`bg-white rounded-xl overflow-hidden shadow-sm hover:shadow-lg transition-all border cursor-pointer active:scale-[0.98] touch-manipulation ${l?"opacity-60 grayscale":""}`,children:[p.jsxs("div",{className:"h-48 md:h-40 bg-slate-200 relative group",children:[p.jsx("img",{src:C.imageUrl||"https://picsum.photos/400/300",alt:C.name,className:"w-full h-full object-cover",loading:"lazy"}),p.jsxs("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2 text-white font-medium",children:[p.jsx(q0,{size:20})," ",p.jsx("span",{className:"hidden md:inline",children:"Ver Detalhes"})]}),p.jsx("div",{className:"md:hidden absolute bottom-2 right-2 bg-black/50 text-white p-1.5 rounded-full backdrop-blur-sm",children:p.jsx(q0,{size:16})})]}),p.jsxs("div",{className:"p-4",children:[p.jsxs("h3",{className:"font-bold text-slate-800 text-lg mb-1 flex justify-between items-center",children:[C.name,p.jsx(w1,{size:16,className:"text-slate-300"})]}),p.jsx("p",{className:"text-slate-500 text-xs line-clamp-3",children:C.description}),l&&p.jsxs("div",{className:"mt-3 pt-2 border-t border-slate-100 text-xs text-red-500 flex items-center gap-1",children:[p.jsx(wn,{size:12})," ",s.excluded]})]})]},C.id)),!l&&y.length===0&&p.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-20 text-slate-400 px-4 text-center",children:[p.jsx(Gu,{size:48,className:"mb-4 opacity-50"}),p.jsx("p",{className:"text-lg font-medium text-slate-600",children:s.noMatches}),p.jsx("p",{className:"text-sm",children:s.tryUnselecting}),p.jsx("button",{onClick:T,className:"mt-6 px-6 py-2 bg-slate-200 text-slate-700 rounded-lg font-medium hover:bg-slate-300",children:s.restart})]})]})})]})]}),h&&p.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-0 md:p-4 animate-in fade-in duration-200",children:p.jsxs("div",{className:"bg-white md:rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col h-full md:h-auto md:max-h-[90vh] overflow-hidden",children:[p.jsxs("div",{className:"relative h-64 md:h-64 shrink-0 bg-slate-900",children:[h.imageUrl?p.jsx("img",{src:h.imageUrl,className:"w-full h-full object-cover opacity-90",alt:h.name}):p.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-600 bg-slate-200",children:p.jsx(Wi,{size:48})}),p.jsx("button",{onClick:()=>g(null),className:"absolute top-4 right-4 bg-black/40 hover:bg-black/60 text-white p-2 rounded-full transition-colors z-10 backdrop-blur-sm",children:p.jsx(wn,{size:24})}),p.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 via-black/50 to-transparent p-6 pt-12",children:p.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white shadow-sm leading-tight",children:h.name})})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8 custom-scrollbar bg-white",children:[p.jsxs("div",{children:[p.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-3",children:[p.jsx(xE,{size:14})," ",s.speciesDetails]}),p.jsx("p",{className:"text-slate-800 leading-relaxed text-base md:text-lg font-serif",children:h.description})]}),h.links&&h.links.length>0&&p.jsxs("div",{children:[p.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-3",children:[p.jsx(Yc,{size:14})," ",s.resources]}),p.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:h.links.map((C,L)=>p.jsxs("a",{href:C.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 rounded-lg border border-slate-200 bg-slate-50 hover:bg-slate-100 hover:border-emerald-300 transition-all group active:scale-[0.98]",children:[p.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm text-slate-400 group-hover:text-emerald-600",children:p.jsx(xl,{size:16})}),p.jsx("span",{className:"text-sm font-medium text-slate-700 group-hover:text-emerald-700 truncate flex-1",children:C.label||C.url})]},L))})]}),p.jsx("div",{className:"border-t border-slate-100"}),p.jsxs("div",{children:[p.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-4",children:[p.jsx(UE,{size:14})," ",s.morphology]}),p.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4",children:e.features.map(C=>{const L=h.traits[C.id];if(!L||L.length===0)return null;const P=L.map(U=>{const W=C.states.find(V=>V.id===U);return W?W.label:"?"}).join(", ");return p.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 flex flex-col",children:[p.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:C.name}),p.jsx("span",{className:"text-sm font-semibold text-slate-800",children:P})]},C.id)})}),Object.keys(h.traits).length===0&&p.jsx("p",{className:"text-slate-400 text-sm italic",children:"Nenhuma caracterstica registrada."})]})]}),p.jsx("div",{className:"p-4 border-t bg-slate-50 shrink-0 safe-area-bottom",children:p.jsx("button",{onClick:()=>g(null),className:"w-full py-3 bg-slate-900 text-white font-bold rounded-xl hover:bg-slate-800 transition-colors shadow-lg",children:s.close})})]})})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let kI,RI;function PI(){return{geminiUrl:kI,vertexUrl:RI}}function FI(e,t,n,r){var i,s;if(!(e!=null&&e.baseUrl)){const o=PI();return t?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Er{}function de(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(t,i)){const s=t[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function f(e,t,n){for(let s=0;s<t.length-1;s++){const o=t[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in e))if(Array.isArray(n))e[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(e[a])){const l=e[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const d=l[u];f(d,t.slice(s+1),n[u])}else for(const u of l)f(u,t.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in e||(e[a]=[{}]);const l=e[a];f(l[0],t.slice(s+1),n);return}(!e[o]||typeof e[o]!="object")&&(e[o]={}),e=e[o]}const r=t[t.length-1],i=e[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(e,n):e[r]=n}function c(e,t,n=void 0){try{if(t.length===1&&t[0]==="_self")return e;for(let r=0;r<t.length;r++){if(typeof e!="object"||e===null)return n;const i=t[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in e){const o=e[s];return Array.isArray(o)?o.map(a=>c(a,t.slice(r+1),n)):n}else return n}else e=e[i]}return e}catch(r){if(r instanceof TypeError)return n;throw r}}function MI(e,t){for(const[n,r]of Object.entries(t)){const i=n.split("."),s=r.split("."),o=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const u=s[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}tf(e,i,s,0,o)}}function tf(e,t,n,r,i){if(r>=t.length||typeof e!="object"||e===null)return;const s=t[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=e;if(o in a&&Array.isArray(a[o]))for(const l of a[o])tf(l,t,n,r+1,i)}else if(s==="*"){if(typeof e=="object"&&e!==null&&!Array.isArray(e)){const o=e,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!i.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,d]of Object.entries(l)){const m=[];for(const h of n.slice(r))h==="*"?m.push(u):m.push(h);f(o,m,d)}for(const u of a)delete o[u]}}else{const o=e;s in o&&tf(o[s],t,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ad(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DI(e){const t={},n=c(e,["operationName"]);n!=null&&f(t,["operationName"],n);const r=c(e,["resourceName"]);return r!=null&&f(t,["_url","resourceName"],r),t}function LI(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["metadata"]);r!=null&&f(t,["metadata"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);s!=null&&f(t,["error"],s);const o=c(e,["response","generateVideoResponse"]);return o!=null&&f(t,["response"],UI(o)),t}function bI(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["metadata"]);r!=null&&f(t,["metadata"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);s!=null&&f(t,["error"],s);const o=c(e,["response"]);return o!=null&&f(t,["response"],OI(o)),t}function UI(e){const t={},n=c(e,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>BI(o))),f(t,["generatedVideos"],s)}const r=c(e,["raiMediaFilteredCount"]);r!=null&&f(t,["raiMediaFilteredCount"],r);const i=c(e,["raiMediaFilteredReasons"]);return i!=null&&f(t,["raiMediaFilteredReasons"],i),t}function OI(e){const t={},n=c(e,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>VI(o))),f(t,["generatedVideos"],s)}const r=c(e,["raiMediaFilteredCount"]);r!=null&&f(t,["raiMediaFilteredCount"],r);const i=c(e,["raiMediaFilteredReasons"]);return i!=null&&f(t,["raiMediaFilteredReasons"],i),t}function BI(e){const t={},n=c(e,["video"]);return n!=null&&f(t,["video"],$I(n)),t}function VI(e){const t={},n=c(e,["_self"]);return n!=null&&f(t,["video"],JI(n)),t}function GI(e){const t={},n=c(e,["operationName"]);return n!=null&&f(t,["_url","operationName"],n),t}function HI(e){const t={},n=c(e,["operationName"]);return n!=null&&f(t,["_url","operationName"],n),t}function zI(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["metadata"]);r!=null&&f(t,["metadata"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);s!=null&&f(t,["error"],s);const o=c(e,["response"]);return o!=null&&f(t,["response"],WI(o)),t}function WI(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["parent"]);r!=null&&f(t,["parent"],r);const i=c(e,["documentName"]);return i!=null&&f(t,["documentName"],i),t}function ov(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["metadata"]);r!=null&&f(t,["metadata"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);s!=null&&f(t,["error"],s);const o=c(e,["response"]);return o!=null&&f(t,["response"],qI(o)),t}function qI(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["parent"]);r!=null&&f(t,["parent"],r);const i=c(e,["documentName"]);return i!=null&&f(t,["documentName"],i),t}function $I(e){const t={},n=c(e,["uri"]);n!=null&&f(t,["uri"],n);const r=c(e,["encodedVideo"]);r!=null&&f(t,["videoBytes"],Ad(r));const i=c(e,["encoding"]);return i!=null&&f(t,["mimeType"],i),t}function JI(e){const t={},n=c(e,["gcsUri"]);n!=null&&f(t,["uri"],n);const r=c(e,["bytesBase64Encoded"]);r!=null&&f(t,["videoBytes"],Ad(r));const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Oh;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Oh||(Oh={}));var Bh;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(Bh||(Bh={}));var Vh;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(Vh||(Vh={}));var ke;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(ke||(ke={}));var Gh;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(Gh||(Gh={}));var Hh;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Hh||(Hh={}));var zh;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(zh||(zh={}));var Wh;(function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Wh||(Wh={}));var qh;(function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(qh||(qh={}));var $h;(function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.HIGH="HIGH"})($h||($h={}));var Jh;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Jh||(Jh={}));var Kh;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(Kh||(Kh={}));var Yh;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(Yh||(Yh={}));var jh;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE"})(jh||(jh={}));var Xh;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(Xh||(Xh={}));var Qh;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Qh||(Qh={}));var Zh;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Zh||(Zh={}));var ep;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"})(ep||(ep={}));var tp;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(tp||(tp={}));var Ml;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Ml||(Ml={}));var np;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(np||(np={}));var rp;(function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(rp||(rp={}));var ip;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(ip||(ip={}));var nf;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(nf||(nf={}));var sp;(function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"})(sp||(sp={}));var op;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(op||(op={}));var ap;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(ap||(ap={}));var lp;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(lp||(lp={}));var up;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(up||(up={}));var cp;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(cp||(cp={}));var fp;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"})(fp||(fp={}));var dp;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(dp||(dp={}));var hp;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(hp||(hp={}));var pp;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(pp||(pp={}));var mp;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(mp||(mp={}));var gp;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(gp||(gp={}));var xp;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(xp||(xp={}));var vp;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(vp||(vp={}));var yp;(function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"})(yp||(yp={}));var Ep;(function(e){e.ASSET="ASSET",e.STYLE="STYLE"})(Ep||(Ep={}));var Tp;(function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"})(Tp||(Tp={}));var _p;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(_p||(_p={}));var Sp;(function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING"})(Sp||(Sp={}));var wp;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"})(wp||(wp={}));var Cp;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(Cp||(Cp={}));var Ap;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(Ap||(Ap={}));var Np;(function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Np||(Np={}));var Ip;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(Ip||(Ip={}));var kp;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(kp||(kp={}));var Rp;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Rp||(Rp={}));var Pp;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(Pp||(Pp={}));var Fp;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Fp||(Fp={}));var Mp;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Mp||(Mp={}));var Dp;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})(Dp||(Dp={}));var $i;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})($i||($i={}));class rf{constructor(t){const n={};for(const r of t.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class $s{get text(){var t,n,r,i,s,o,a,l;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",d=!1;const m=[];for(const h of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[g,v]of Object.entries(h))g!=="text"&&g!=="thought"&&g!=="thoughtSignature"&&(v!==null||v!==void 0)&&m.push(g);if(typeof h.text=="string"){if(typeof h.thought=="boolean"&&h.thought)continue;d=!0,u+=h.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?u:void 0}get data(){var t,n,r,i,s,o,a,l;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const d=[];for(const m of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[h,g]of Object.entries(m))h!=="inlineData"&&(g!==null||g!==void 0)&&d.push(h);m.inlineData&&typeof m.inlineData.data=="string"&&(u+=atob(m.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var t,n,r,i,s,o,a,l;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var t,n,r,i,s,o,a,l,u;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var t,n,r,i,s,o,a,l,u;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.output}}class Lp{}class bp{}class KI{}class YI{}class jI{}class XI{}class Up{}class Op{}class Bp{}class QI{}class Dl{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new Dl;let i;const s=t;return n?i=bI(s):i=LI(s),Object.assign(r,i),r}}class Vp{}class Gp{}class Hp{}class ZI{}class e4{}class t4{}class Nd{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new Nd,s=zI(t);return Object.assign(r,s),r}}class n4{}class r4{}class i4{}class zp{}class s4{get text(){var t,n,r;let i="",s=!1;const o=[];for(const a of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var t,n,r;let i="";const s=[];for(const o of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class o4{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Id{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new Id,s=ov(t);return Object.assign(r,s),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Oe(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function av(e,t){const n=Oe(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function lv(e){return Array.isArray(e)?e.map(t=>Ll(t)):[Ll(e)]}function Ll(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function uv(e){const t=Ll(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function cv(e){const t=Ll(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Wp(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function fv(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>Wp(t)):[Wp(e)]}function sf(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function qp(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function $p(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Ot(e){if(e==null)throw new Error("ContentUnion is required");return sf(e)?e:{role:"user",parts:fv(e)}}function kd(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const r=Ot(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const n=Ot(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>Ot(n)):[Ot(t)]}function Nn(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(qp(e)||$p(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ot(e)]}const t=[],n=[],r=sf(e[0]);for(const i of e){const s=sf(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)t.push(i);else{if(qp(i)||$p(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||t.push({role:"user",parts:fv(n)}),t}function a4(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(r=>r!=="null");if(n.length===1)t.type=Object.values(ke).includes(n[0].toUpperCase())?n[0].toUpperCase():ke.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const r of n)t.anyOf.push({type:Object.values(ke).includes(r.toUpperCase())?r.toUpperCase():ke.TYPE_UNSPECIFIED})}}function is(e){const t={},n=["items"],r=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=e.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(t.nullable=!0,e=s[1]):s[1].type==="null"&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&a4(e.type,t);for(const[o,a]of Object.entries(e))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;t.type=Object.values(ke).includes(a.toUpperCase())?a.toUpperCase():ke.TYPE_UNSPECIFIED}else if(n.includes(o))t[o]=is(a);else if(r.includes(o)){const l=[];for(const u of a){if(u.type=="null"){t.nullable=!0;continue}l.push(is(u))}t[o]=l}else if(i.includes(o)){const l={};for(const[u,d]of Object.entries(a))l[u]=is(d);t[o]=l}else{if(o==="additionalProperties")continue;t[o]=a}return t}function Rd(e){return is(e)}function Pd(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function Fd(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function _s(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=is(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=is(t.response));return e}function Ss(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function l4(e,t,n,r=1){const i=!t.startsWith(`${n}/`)&&t.split("/").length===r;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:i?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:i?`${n}/${t}`:t}function Tr(e,t){if(typeof t!="string")throw new Error("name must be a string");return l4(e,t,"cachedContents")}function dv(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function jr(e){return Ad(e)}function u4(e){return e!=null&&typeof e=="object"&&"name"in e}function c4(e){return e!=null&&typeof e=="object"&&"video"in e}function f4(e){return e!=null&&typeof e=="object"&&"uri"in e}function hv(e){var t;let n;if(u4(e)&&(n=e.name),!(f4(e)&&(n=e.uri,n===void 0))&&!(c4(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function pv(e,t){let n;return e.isVertexAI()?n=t?"publishers/google/models":"models":n=t?"models":"tunedModels",n}function mv(e){for(const t of["models","tunedModels","publisherModels"])if(d4(e,t))return e[t];return[]}function d4(e,t){return e!==null&&typeof e=="object"&&t in e}function h4(e,t={}){const n=e,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),t.behavior&&(r.behavior=t.behavior),{functionDeclarations:[r]}}function p4(e,t={}){const n=[],r=new Set;for(const i of e){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=h4(i,t);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function gv(e,t){let n;if(typeof t=="string")if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))n={format:"bigquery",bigqueryUri:t};else throw new Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))n={fileName:t};else throw new Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function m4(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function xv(e){if(typeof e!="object"||e===null)return{};const t=e,n=t.inlinedResponses;if(typeof n!="object"||n===null)return e;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return e;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function ws(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function vv(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function g4(e){const t={},n=c(e,["responsesFile"]);n!=null&&f(t,["fileName"],n);const r=c(e,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>j4(o))),f(t,["inlinedResponses"],s)}const i=c(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(t,["inlinedEmbedContentResponses"],s)}return t}function x4(e){const t={},n=c(e,["predictionsFormat"]);n!=null&&f(t,["format"],n);const r=c(e,["gcsDestination","outputUriPrefix"]);r!=null&&f(t,["gcsUri"],r);const i=c(e,["bigqueryDestination","outputUri"]);return i!=null&&f(t,["bigqueryUri"],i),t}function v4(e){const t={},n=c(e,["format"]);n!=null&&f(t,["predictionsFormat"],n);const r=c(e,["gcsUri"]);r!=null&&f(t,["gcsDestination","outputUriPrefix"],r);const i=c(e,["bigqueryUri"]);if(i!=null&&f(t,["bigqueryDestination","outputUri"],i),c(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(c(e,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}function qa(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["metadata","displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["metadata","state"]);i!=null&&f(t,["state"],vv(i));const s=c(e,["metadata","createTime"]);s!=null&&f(t,["createTime"],s);const o=c(e,["metadata","endTime"]);o!=null&&f(t,["endTime"],o);const a=c(e,["metadata","updateTime"]);a!=null&&f(t,["updateTime"],a);const l=c(e,["metadata","model"]);l!=null&&f(t,["model"],l);const u=c(e,["metadata","output"]);return u!=null&&f(t,["dest"],g4(xv(u))),t}function of(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["state"]);i!=null&&f(t,["state"],vv(i));const s=c(e,["error"]);s!=null&&f(t,["error"],s);const o=c(e,["createTime"]);o!=null&&f(t,["createTime"],o);const a=c(e,["startTime"]);a!=null&&f(t,["startTime"],a);const l=c(e,["endTime"]);l!=null&&f(t,["endTime"],l);const u=c(e,["updateTime"]);u!=null&&f(t,["updateTime"],u);const d=c(e,["model"]);d!=null&&f(t,["model"],d);const m=c(e,["inputConfig"]);m!=null&&f(t,["src"],y4(m));const h=c(e,["outputConfig"]);h!=null&&f(t,["dest"],x4(xv(h)));const g=c(e,["completionStats"]);return g!=null&&f(t,["completionStats"],g),t}function y4(e){const t={},n=c(e,["instancesFormat"]);n!=null&&f(t,["format"],n);const r=c(e,["gcsSource","uris"]);r!=null&&f(t,["gcsUri"],r);const i=c(e,["bigquerySource","inputUri"]);return i!=null&&f(t,["bigqueryUri"],i),t}function E4(e,t){const n={};if(c(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=c(t,["fileName"]);r!=null&&f(n,["fileName"],r);const i=c(t,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Y4(e,o))),f(n,["requests","requests"],s)}return n}function T4(e){const t={},n=c(e,["format"]);n!=null&&f(t,["instancesFormat"],n);const r=c(e,["gcsUri"]);r!=null&&f(t,["gcsSource","uris"],r);const i=c(e,["bigqueryUri"]);if(i!=null&&f(t,["bigquerySource","inputUri"],i),c(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function _4(e){const t={},n=c(e,["data"]);if(n!=null&&f(t,["data"],n),c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function S4(e,t){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],ws(e,r)),n}function w4(e,t){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],ws(e,r)),n}function C4(e){const t={},n=c(e,["content"]);n!=null&&f(t,["content"],n);const r=c(e,["citationMetadata"]);r!=null&&f(t,["citationMetadata"],A4(r));const i=c(e,["tokenCount"]);i!=null&&f(t,["tokenCount"],i);const s=c(e,["finishReason"]);s!=null&&f(t,["finishReason"],s);const o=c(e,["avgLogprobs"]);o!=null&&f(t,["avgLogprobs"],o);const a=c(e,["groundingMetadata"]);a!=null&&f(t,["groundingMetadata"],a);const l=c(e,["index"]);l!=null&&f(t,["index"],l);const u=c(e,["logprobsResult"]);u!=null&&f(t,["logprobsResult"],u);const d=c(e,["safetyRatings"]);if(d!=null){let h=d;Array.isArray(h)&&(h=h.map(g=>g)),f(t,["safetyRatings"],h)}const m=c(e,["urlContextMetadata"]);return m!=null&&f(t,["urlContextMetadata"],m),t}function A4(e){const t={},n=c(e,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),f(t,["citations"],r)}return t}function yv(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>rk(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function N4(e,t){const n={},r=c(e,["displayName"]);if(t!==void 0&&r!=null&&f(t,["batch","displayName"],r),c(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function I4(e,t){const n={},r=c(e,["displayName"]);t!==void 0&&r!=null&&f(t,["displayName"],r);const i=c(e,["dest"]);return t!==void 0&&i!=null&&f(t,["outputConfig"],v4(m4(i))),n}function Jp(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["src"]);i!=null&&f(n,["batch","inputConfig"],E4(e,gv(e,i)));const s=c(t,["config"]);return s!=null&&N4(s,n),n}function k4(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["model"],Oe(e,r));const i=c(t,["src"]);i!=null&&f(n,["inputConfig"],T4(gv(e,i)));const s=c(t,["config"]);return s!=null&&I4(s,n),n}function R4(e,t){const n={},r=c(e,["displayName"]);return t!==void 0&&r!=null&&f(t,["batch","displayName"],r),n}function P4(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["src"]);i!=null&&f(n,["batch","inputConfig"],O4(e,i));const s=c(t,["config"]);return s!=null&&R4(s,n),n}function F4(e,t){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],ws(e,r)),n}function M4(e,t){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],ws(e,r)),n}function D4(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);return s!=null&&f(t,["error"],s),t}function L4(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);return s!=null&&f(t,["error"],s),t}function b4(e,t){const n={},r=c(t,["contents"]);if(r!=null){let s=kd(e,r);Array.isArray(s)&&(s=s.map(o=>o)),f(n,["requests[]","request","content"],s)}const i=c(t,["config"]);return i!=null&&(f(n,["_self"],U4(i,n)),MI(n,{"requests[].*":"requests[].request.*"})),n}function U4(e,t){const n={},r=c(e,["taskType"]);t!==void 0&&r!=null&&f(t,["requests[]","taskType"],r);const i=c(e,["title"]);t!==void 0&&i!=null&&f(t,["requests[]","title"],i);const s=c(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&f(t,["requests[]","outputDimensionality"],s),c(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function O4(e,t){const n={},r=c(t,["fileName"]);r!=null&&f(n,["file_name"],r);const i=c(t,["inlinedRequests"]);return i!=null&&f(n,["requests"],b4(e,i)),n}function B4(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function V4(e){const t={},n=c(e,["id"]);n!=null&&f(t,["id"],n);const r=c(e,["args"]);r!=null&&f(t,["args"],r);const i=c(e,["name"]);if(i!=null&&f(t,["name"],i),c(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function G4(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["allowedFunctionNames"]);if(r!=null&&f(t,["allowedFunctionNames"],r),c(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function H4(e,t,n){const r={},i=c(t,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],yv(Ot(i)));const s=c(t,["temperature"]);s!=null&&f(r,["temperature"],s);const o=c(t,["topP"]);o!=null&&f(r,["topP"],o);const a=c(t,["topK"]);a!=null&&f(r,["topK"],a);const l=c(t,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const u=c(t,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const d=c(t,["stopSequences"]);d!=null&&f(r,["stopSequences"],d);const m=c(t,["responseLogprobs"]);m!=null&&f(r,["responseLogprobs"],m);const h=c(t,["logprobs"]);h!=null&&f(r,["logprobs"],h);const g=c(t,["presencePenalty"]);g!=null&&f(r,["presencePenalty"],g);const v=c(t,["frequencyPenalty"]);v!=null&&f(r,["frequencyPenalty"],v);const x=c(t,["seed"]);x!=null&&f(r,["seed"],x);const _=c(t,["responseMimeType"]);_!=null&&f(r,["responseMimeType"],_);const T=c(t,["responseSchema"]);T!=null&&f(r,["responseSchema"],Rd(T));const y=c(t,["responseJsonSchema"]);if(y!=null&&f(r,["responseJsonSchema"],y),c(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const E=c(t,["safetySettings"]);if(n!==void 0&&E!=null){let V=E;Array.isArray(V)&&(V=V.map(Y=>ik(Y))),f(n,["safetySettings"],V)}const A=c(t,["tools"]);if(n!==void 0&&A!=null){let V=Ss(A);Array.isArray(V)&&(V=V.map(Y=>ok(_s(Y)))),f(n,["tools"],V)}const b=c(t,["toolConfig"]);if(n!==void 0&&b!=null&&f(n,["toolConfig"],sk(b)),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const D=c(t,["cachedContent"]);n!==void 0&&D!=null&&f(n,["cachedContent"],Tr(e,D));const C=c(t,["responseModalities"]);C!=null&&f(r,["responseModalities"],C);const L=c(t,["mediaResolution"]);L!=null&&f(r,["mediaResolution"],L);const P=c(t,["speechConfig"]);if(P!=null&&f(r,["speechConfig"],Pd(P)),c(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const U=c(t,["thinkingConfig"]);U!=null&&f(r,["thinkingConfig"],U);const W=c(t,["imageConfig"]);return W!=null&&f(r,["imageConfig"],K4(W)),r}function z4(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>C4(u))),f(t,["candidates"],l)}const i=c(e,["modelVersion"]);i!=null&&f(t,["modelVersion"],i);const s=c(e,["promptFeedback"]);s!=null&&f(t,["promptFeedback"],s);const o=c(e,["responseId"]);o!=null&&f(t,["responseId"],o);const a=c(e,["usageMetadata"]);return a!=null&&f(t,["usageMetadata"],a),t}function W4(e,t){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],ws(e,r)),n}function q4(e,t){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],ws(e,r)),n}function $4(e){const t={};if(c(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(e,["enableWidget"]);return n!=null&&f(t,["enableWidget"],n),t}function J4(e){const t={};if(c(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],n),t}function K4(e){const t={},n=c(e,["aspectRatio"]);n!=null&&f(t,["aspectRatio"],n);const r=c(e,["imageSize"]);if(r!=null&&f(t,["imageSize"],r),c(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(c(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function Y4(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["request","model"],Oe(e,r));const i=c(t,["contents"]);if(i!=null){let a=Nn(i);Array.isArray(a)&&(a=a.map(l=>yv(l))),f(n,["request","contents"],a)}const s=c(t,["metadata"]);s!=null&&f(n,["metadata"],s);const o=c(t,["config"]);return o!=null&&f(n,["request","generationConfig"],H4(e,o,c(n,["request"],{}))),n}function j4(e){const t={},n=c(e,["response"]);n!=null&&f(t,["response"],z4(n));const r=c(e,["error"]);return r!=null&&f(t,["error"],r),t}function X4(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);if(t!==void 0&&i!=null&&f(t,["_query","pageToken"],i),c(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function Q4(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);t!==void 0&&i!=null&&f(t,["_query","pageToken"],i);const s=c(e,["filter"]);return t!==void 0&&s!=null&&f(t,["_query","filter"],s),n}function Z4(e){const t={},n=c(e,["config"]);return n!=null&&X4(n,t),t}function ek(e){const t={},n=c(e,["config"]);return n!=null&&Q4(n,t),t}function tk(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>qa(o))),f(t,["batchJobs"],s)}return t}function nk(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>of(o))),f(t,["batchJobs"],s)}return t}function rk(e){const t={},n=c(e,["mediaResolution"]);n!=null&&f(t,["mediaResolution"],n);const r=c(e,["codeExecutionResult"]);r!=null&&f(t,["codeExecutionResult"],r);const i=c(e,["executableCode"]);i!=null&&f(t,["executableCode"],i);const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],B4(s));const o=c(e,["functionCall"]);o!=null&&f(t,["functionCall"],V4(o));const a=c(e,["functionResponse"]);a!=null&&f(t,["functionResponse"],a);const l=c(e,["inlineData"]);l!=null&&f(t,["inlineData"],_4(l));const u=c(e,["text"]);u!=null&&f(t,["text"],u);const d=c(e,["thought"]);d!=null&&f(t,["thought"],d);const m=c(e,["thoughtSignature"]);m!=null&&f(t,["thoughtSignature"],m);const h=c(e,["videoMetadata"]);return h!=null&&f(t,["videoMetadata"],h),t}function ik(e){const t={},n=c(e,["category"]);if(n!=null&&f(t,["category"],n),c(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=c(e,["threshold"]);return r!=null&&f(t,["threshold"],r),t}function sk(e){const t={},n=c(e,["functionCallingConfig"]);n!=null&&f(t,["functionCallingConfig"],G4(n));const r=c(e,["retrievalConfig"]);return r!=null&&f(t,["retrievalConfig"],r),t}function ok(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(m=>m)),f(t,["functionDeclarations"],d)}if(c(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(e,["googleSearchRetrieval"]);r!=null&&f(t,["googleSearchRetrieval"],r);const i=c(e,["computerUse"]);i!=null&&f(t,["computerUse"],i);const s=c(e,["fileSearch"]);s!=null&&f(t,["fileSearch"],s);const o=c(e,["codeExecution"]);if(o!=null&&f(t,["codeExecution"],o),c(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(e,["googleMaps"]);a!=null&&f(t,["googleMaps"],$4(a));const l=c(e,["googleSearch"]);l!=null&&f(t,["googleSearch"],J4(l));const u=c(e,["urlContext"]);return u!=null&&f(t,["urlContext"],u),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var xr;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"})(xr||(xr={}));class Si{constructor(t,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,r,i)}init(t,n,r){var i,s;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ak extends Er{constructor(t){super(),this.apiClient=t,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new Si(xr.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(t){const n=Jp(this.apiClient,t),r=n._url,i=de("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const d of l){const m=Object.assign({},d);if(m.systemInstruction){const h=m.systemInstruction;delete m.systemInstruction;const g=m.request;g.systemInstruction=h,m.request=g}u.push(m)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(t){if(typeof t=="string")return t.startsWith("gs://")?t:void 0;if(!Array.isArray(t)&&t.gcsUri&&t.gcsUri.length>0)return t.gcsUri[0]}getBigqueryUri(t){if(typeof t=="string")return t.startsWith("bq://")?t:void 0;if(!Array.isArray(t))return t.bigqueryUri}formatDestination(t,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(t),o=this.getBigqueryUri(t);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=k4(this.apiClient,t);return a=de("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>of(d))}else{const u=Jp(this.apiClient,t);return a=de("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>qa(d))}}async createEmbeddingsInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=P4(this.apiClient,t);return s=de("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>qa(l))}}async get(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=q4(this.apiClient,t);return a=de("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>of(d))}else{const u=W4(this.apiClient,t);return a=de("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>qa(d))}}async cancel(t){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=w4(this.apiClient,t);o=de("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=S4(this.apiClient,t);o=de("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=ek(t);return a=de("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=nk(d),h=new zp;return Object.assign(h,m),h})}else{const u=Z4(t);return a=de("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=tk(d),h=new zp;return Object.assign(h,m),h})}}async delete(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=M4(this.apiClient,t);return a=de("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>L4(d))}else{const u=F4(this.apiClient,t);return a=de("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>D4(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lk(e){const t={},n=c(e,["data"]);if(n!=null&&f(t,["data"],n),c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function Kp(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Pk(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function uk(e,t){const n={},r=c(e,["ttl"]);t!==void 0&&r!=null&&f(t,["ttl"],r);const i=c(e,["expireTime"]);t!==void 0&&i!=null&&f(t,["expireTime"],i);const s=c(e,["displayName"]);t!==void 0&&s!=null&&f(t,["displayName"],s);const o=c(e,["contents"]);if(t!==void 0&&o!=null){let d=Nn(o);Array.isArray(d)&&(d=d.map(m=>Kp(m))),f(t,["contents"],d)}const a=c(e,["systemInstruction"]);t!==void 0&&a!=null&&f(t,["systemInstruction"],Kp(Ot(a)));const l=c(e,["tools"]);if(t!==void 0&&l!=null){let d=l;Array.isArray(d)&&(d=d.map(m=>Mk(m))),f(t,["tools"],d)}const u=c(e,["toolConfig"]);if(t!==void 0&&u!=null&&f(t,["toolConfig"],Fk(u)),c(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function ck(e,t){const n={},r=c(e,["ttl"]);t!==void 0&&r!=null&&f(t,["ttl"],r);const i=c(e,["expireTime"]);t!==void 0&&i!=null&&f(t,["expireTime"],i);const s=c(e,["displayName"]);t!==void 0&&s!=null&&f(t,["displayName"],s);const o=c(e,["contents"]);if(t!==void 0&&o!=null){let m=Nn(o);Array.isArray(m)&&(m=m.map(h=>h)),f(t,["contents"],m)}const a=c(e,["systemInstruction"]);t!==void 0&&a!=null&&f(t,["systemInstruction"],Ot(a));const l=c(e,["tools"]);if(t!==void 0&&l!=null){let m=l;Array.isArray(m)&&(m=m.map(h=>Dk(h))),f(t,["tools"],m)}const u=c(e,["toolConfig"]);t!==void 0&&u!=null&&f(t,["toolConfig"],u);const d=c(e,["kmsKeyName"]);return t!==void 0&&d!=null&&f(t,["encryption_spec","kmsKeyName"],d),n}function fk(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["model"],av(e,r));const i=c(t,["config"]);return i!=null&&uk(i,n),n}function dk(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["model"],av(e,r));const i=c(t,["config"]);return i!=null&&ck(i,n),n}function hk(e,t){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],Tr(e,r)),n}function pk(e,t){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],Tr(e,r)),n}function mk(e){const t={},n=c(e,["sdkHttpResponse"]);return n!=null&&f(t,["sdkHttpResponse"],n),t}function gk(e){const t={},n=c(e,["sdkHttpResponse"]);return n!=null&&f(t,["sdkHttpResponse"],n),t}function xk(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function vk(e){const t={},n=c(e,["id"]);n!=null&&f(t,["id"],n);const r=c(e,["args"]);r!=null&&f(t,["args"],r);const i=c(e,["name"]);if(i!=null&&f(t,["name"],i),c(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function yk(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["allowedFunctionNames"]);if(r!=null&&f(t,["allowedFunctionNames"],r),c(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function Ek(e){const t={};if(c(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(e,["description"]);n!=null&&f(t,["description"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["parameters"]);i!=null&&f(t,["parameters"],i);const s=c(e,["parametersJsonSchema"]);s!=null&&f(t,["parametersJsonSchema"],s);const o=c(e,["response"]);o!=null&&f(t,["response"],o);const a=c(e,["responseJsonSchema"]);return a!=null&&f(t,["responseJsonSchema"],a),t}function Tk(e,t){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],Tr(e,r)),n}function _k(e,t){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],Tr(e,r)),n}function Sk(e){const t={};if(c(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(e,["enableWidget"]);return n!=null&&f(t,["enableWidget"],n),t}function wk(e){const t={};if(c(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],n),t}function Ck(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);return t!==void 0&&i!=null&&f(t,["_query","pageToken"],i),n}function Ak(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);return t!==void 0&&i!=null&&f(t,["_query","pageToken"],i),n}function Nk(e){const t={},n=c(e,["config"]);return n!=null&&Ck(n,t),t}function Ik(e){const t={},n=c(e,["config"]);return n!=null&&Ak(n,t),t}function kk(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(t,["cachedContents"],s)}return t}function Rk(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(t,["cachedContents"],s)}return t}function Pk(e){const t={},n=c(e,["mediaResolution"]);n!=null&&f(t,["mediaResolution"],n);const r=c(e,["codeExecutionResult"]);r!=null&&f(t,["codeExecutionResult"],r);const i=c(e,["executableCode"]);i!=null&&f(t,["executableCode"],i);const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],xk(s));const o=c(e,["functionCall"]);o!=null&&f(t,["functionCall"],vk(o));const a=c(e,["functionResponse"]);a!=null&&f(t,["functionResponse"],a);const l=c(e,["inlineData"]);l!=null&&f(t,["inlineData"],lk(l));const u=c(e,["text"]);u!=null&&f(t,["text"],u);const d=c(e,["thought"]);d!=null&&f(t,["thought"],d);const m=c(e,["thoughtSignature"]);m!=null&&f(t,["thoughtSignature"],m);const h=c(e,["videoMetadata"]);return h!=null&&f(t,["videoMetadata"],h),t}function Fk(e){const t={},n=c(e,["functionCallingConfig"]);n!=null&&f(t,["functionCallingConfig"],yk(n));const r=c(e,["retrievalConfig"]);return r!=null&&f(t,["retrievalConfig"],r),t}function Mk(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(m=>m)),f(t,["functionDeclarations"],d)}if(c(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(e,["googleSearchRetrieval"]);r!=null&&f(t,["googleSearchRetrieval"],r);const i=c(e,["computerUse"]);i!=null&&f(t,["computerUse"],i);const s=c(e,["fileSearch"]);s!=null&&f(t,["fileSearch"],s);const o=c(e,["codeExecution"]);if(o!=null&&f(t,["codeExecution"],o),c(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(e,["googleMaps"]);a!=null&&f(t,["googleMaps"],Sk(a));const l=c(e,["googleSearch"]);l!=null&&f(t,["googleSearch"],wk(l));const u=c(e,["urlContext"]);return u!=null&&f(t,["urlContext"],u),t}function Dk(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(h=>Ek(h))),f(t,["functionDeclarations"],m)}const r=c(e,["retrieval"]);r!=null&&f(t,["retrieval"],r);const i=c(e,["googleSearchRetrieval"]);i!=null&&f(t,["googleSearchRetrieval"],i);const s=c(e,["computerUse"]);if(s!=null&&f(t,["computerUse"],s),c(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=c(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const a=c(e,["enterpriseWebSearch"]);a!=null&&f(t,["enterpriseWebSearch"],a);const l=c(e,["googleMaps"]);l!=null&&f(t,["googleMaps"],l);const u=c(e,["googleSearch"]);u!=null&&f(t,["googleSearch"],u);const d=c(e,["urlContext"]);return d!=null&&f(t,["urlContext"],d),t}function Lk(e,t){const n={},r=c(e,["ttl"]);t!==void 0&&r!=null&&f(t,["ttl"],r);const i=c(e,["expireTime"]);return t!==void 0&&i!=null&&f(t,["expireTime"],i),n}function bk(e,t){const n={},r=c(e,["ttl"]);t!==void 0&&r!=null&&f(t,["ttl"],r);const i=c(e,["expireTime"]);return t!==void 0&&i!=null&&f(t,["expireTime"],i),n}function Uk(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Tr(e,r));const i=c(t,["config"]);return i!=null&&Lk(i,n),n}function Ok(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Tr(e,r));const i=c(t,["config"]);return i!=null&&bk(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Bk extends Er{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Si(xr.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=dk(this.apiClient,t);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>d)}else{const u=fk(this.apiClient,t);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>d)}}async get(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=_k(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>d)}else{const u=Tk(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>d)}}async delete(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=pk(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=gk(d),h=new Gp;return Object.assign(h,m),h})}else{const u=hk(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=mk(d),h=new Gp;return Object.assign(h,m),h})}}async update(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Ok(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>d)}else{const u=Uk(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>d)}}async listInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Ik(t);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=Rk(d),h=new Hp;return Object.assign(h,m),h})}else{const u=Nk(t);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=kk(d),h=new Hp;return Object.assign(h,m),h})}}}function Yp(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function je(e){return this instanceof je?(this.v=e,this):new je(e)}function ss(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(g){return function(v){return Promise.resolve(v).then(g,m)}}function a(g,v){r[g]&&(i[g]=function(x){return new Promise(function(_,T){s.push([g,x,_,T])>1||l(g,x)})},v&&(i[g]=v(i[g])))}function l(g,v){try{u(r[g](v))}catch(x){h(s[0][3],x)}}function u(g){g.value instanceof je?Promise.resolve(g.value.v).then(d,m):h(s[0][2],g)}function d(g){l("next",g)}function m(g){l("throw",g)}function h(g,v){g(v),s.shift(),s.length&&l(s[0][0],s[0][1])}}function xo(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Yp=="function"?Yp(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(o){return new Promise(function(a,l){o=e[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vk(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:Ev(n)}function Ev(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0)return!1;return!0}function Gk(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function jp(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let r=0;for(;r<n;)if(e[r].role==="user")t.push(e[r]),r++;else{const i=[];let s=!0;for(;r<n&&e[r].role==="model";)i.push(e[r]),s&&!Ev(e[r])&&(s=!1),r++;s?t.push(...i):t.pop()}return t}class Hk{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new zk(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class zk{constructor(t,n,r,i={},s=[]){this.apiClient=t,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),Gk(s)}async sendMessage(t){var n;await this.sendPromise;const r=Ot(t.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const l=await i,u=(o=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,d=l.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let h=[];d!=null&&(h=(a=d.slice(m))!==null&&a!==void 0?a:[]);const g=u?[u]:[];this.recordHistory(r,g,h)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(t){var n;await this.sendPromise;const r=Ot(t.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(t=!1){const n=t?jp(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){var r,i;return ss(this,arguments,function*(){var o,a,l,u;const d=[];try{for(var m=!0,h=xo(t),g;g=yield je(h.next()),o=g.done,!o;m=!0){u=g.value,m=!1;const v=u;if(Vk(v)){const x=(i=(r=v.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;x!==void 0&&d.push(x)}yield yield je(v)}}catch(v){a={error:v}}finally{try{!m&&!o&&(l=h.return)&&(yield je(l.call(h)))}finally{if(a)throw a.error}}this.recordHistory(n,d)})}recordHistory(t,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...jp(r)):this.history.push(t),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class au extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,au.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Wk(e){const t={},n=c(e,["file"]);return n!=null&&f(t,["file"],n),t}function qk(e){const t={},n=c(e,["sdkHttpResponse"]);return n!=null&&f(t,["sdkHttpResponse"],n),t}function $k(e){const t={},n=c(e,["name"]);return n!=null&&f(t,["_url","file"],hv(n)),t}function Jk(e){const t={},n=c(e,["sdkHttpResponse"]);return n!=null&&f(t,["sdkHttpResponse"],n),t}function Kk(e){const t={},n=c(e,["name"]);return n!=null&&f(t,["_url","file"],hv(n)),t}function Yk(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);return t!==void 0&&i!=null&&f(t,["_query","pageToken"],i),n}function jk(e){const t={},n=c(e,["config"]);return n!=null&&Yk(n,t),t}function Xk(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(t,["files"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qk extends Er{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Si(xr.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>n)}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=jk(t);return s=de("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const u=Xk(l),d=new n4;return Object.assign(d,u),d})}}async createInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Wk(t);return s=de("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=qk(l),d=new r4;return Object.assign(d,u),d})}}async get(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Kk(t);return s=de("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=$k(t);return s=de("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const u=Jk(l),d=new i4;return Object.assign(d,u),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $a(e){const t={},n=c(e,["data"]);if(n!=null&&f(t,["data"],n),c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function Zk(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>mR(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function eR(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function tR(e){const t={},n=c(e,["id"]);n!=null&&f(t,["id"],n);const r=c(e,["args"]);r!=null&&f(t,["args"],r);const i=c(e,["name"]);if(i!=null&&f(t,["name"],i),c(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function nR(e){const t={};if(c(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(e,["description"]);n!=null&&f(t,["description"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["parameters"]);i!=null&&f(t,["parameters"],i);const s=c(e,["parametersJsonSchema"]);s!=null&&f(t,["parametersJsonSchema"],s);const o=c(e,["response"]);o!=null&&f(t,["response"],o);const a=c(e,["responseJsonSchema"]);return a!=null&&f(t,["responseJsonSchema"],a),t}function rR(e){const t={},n=c(e,["modelSelectionConfig"]);n!=null&&f(t,["modelConfig"],n);const r=c(e,["responseJsonSchema"]);r!=null&&f(t,["responseJsonSchema"],r);const i=c(e,["audioTimestamp"]);i!=null&&f(t,["audioTimestamp"],i);const s=c(e,["candidateCount"]);s!=null&&f(t,["candidateCount"],s);const o=c(e,["enableAffectiveDialog"]);o!=null&&f(t,["enableAffectiveDialog"],o);const a=c(e,["frequencyPenalty"]);a!=null&&f(t,["frequencyPenalty"],a);const l=c(e,["logprobs"]);l!=null&&f(t,["logprobs"],l);const u=c(e,["maxOutputTokens"]);u!=null&&f(t,["maxOutputTokens"],u);const d=c(e,["mediaResolution"]);d!=null&&f(t,["mediaResolution"],d);const m=c(e,["presencePenalty"]);m!=null&&f(t,["presencePenalty"],m);const h=c(e,["responseLogprobs"]);h!=null&&f(t,["responseLogprobs"],h);const g=c(e,["responseMimeType"]);g!=null&&f(t,["responseMimeType"],g);const v=c(e,["responseModalities"]);v!=null&&f(t,["responseModalities"],v);const x=c(e,["responseSchema"]);x!=null&&f(t,["responseSchema"],x);const _=c(e,["routingConfig"]);_!=null&&f(t,["routingConfig"],_);const T=c(e,["seed"]);T!=null&&f(t,["seed"],T);const y=c(e,["speechConfig"]);y!=null&&f(t,["speechConfig"],Tv(y));const E=c(e,["stopSequences"]);E!=null&&f(t,["stopSequences"],E);const A=c(e,["temperature"]);A!=null&&f(t,["temperature"],A);const b=c(e,["thinkingConfig"]);b!=null&&f(t,["thinkingConfig"],b);const D=c(e,["topK"]);D!=null&&f(t,["topK"],D);const C=c(e,["topP"]);if(C!=null&&f(t,["topP"],C),c(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function iR(e){const t={};if(c(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(e,["enableWidget"]);return n!=null&&f(t,["enableWidget"],n),t}function sR(e){const t={};if(c(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],n),t}function oR(e,t){const n={},r=c(e,["generationConfig"]);t!==void 0&&r!=null&&f(t,["setup","generationConfig"],r);const i=c(e,["responseModalities"]);t!==void 0&&i!=null&&f(t,["setup","generationConfig","responseModalities"],i);const s=c(e,["temperature"]);t!==void 0&&s!=null&&f(t,["setup","generationConfig","temperature"],s);const o=c(e,["topP"]);t!==void 0&&o!=null&&f(t,["setup","generationConfig","topP"],o);const a=c(e,["topK"]);t!==void 0&&a!=null&&f(t,["setup","generationConfig","topK"],a);const l=c(e,["maxOutputTokens"]);t!==void 0&&l!=null&&f(t,["setup","generationConfig","maxOutputTokens"],l);const u=c(e,["mediaResolution"]);t!==void 0&&u!=null&&f(t,["setup","generationConfig","mediaResolution"],u);const d=c(e,["seed"]);t!==void 0&&d!=null&&f(t,["setup","generationConfig","seed"],d);const m=c(e,["speechConfig"]);t!==void 0&&m!=null&&f(t,["setup","generationConfig","speechConfig"],Fd(m));const h=c(e,["thinkingConfig"]);t!==void 0&&h!=null&&f(t,["setup","generationConfig","thinkingConfig"],h);const g=c(e,["enableAffectiveDialog"]);t!==void 0&&g!=null&&f(t,["setup","generationConfig","enableAffectiveDialog"],g);const v=c(e,["systemInstruction"]);t!==void 0&&v!=null&&f(t,["setup","systemInstruction"],Zk(Ot(v)));const x=c(e,["tools"]);if(t!==void 0&&x!=null){let D=Ss(x);Array.isArray(D)&&(D=D.map(C=>xR(_s(C)))),f(t,["setup","tools"],D)}const _=c(e,["sessionResumption"]);t!==void 0&&_!=null&&f(t,["setup","sessionResumption"],gR(_));const T=c(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&f(t,["setup","inputAudioTranscription"],T);const y=c(e,["outputAudioTranscription"]);t!==void 0&&y!=null&&f(t,["setup","outputAudioTranscription"],y);const E=c(e,["realtimeInputConfig"]);t!==void 0&&E!=null&&f(t,["setup","realtimeInputConfig"],E);const A=c(e,["contextWindowCompression"]);t!==void 0&&A!=null&&f(t,["setup","contextWindowCompression"],A);const b=c(e,["proactivity"]);return t!==void 0&&b!=null&&f(t,["setup","proactivity"],b),n}function aR(e,t){const n={},r=c(e,["generationConfig"]);t!==void 0&&r!=null&&f(t,["setup","generationConfig"],rR(r));const i=c(e,["responseModalities"]);t!==void 0&&i!=null&&f(t,["setup","generationConfig","responseModalities"],i);const s=c(e,["temperature"]);t!==void 0&&s!=null&&f(t,["setup","generationConfig","temperature"],s);const o=c(e,["topP"]);t!==void 0&&o!=null&&f(t,["setup","generationConfig","topP"],o);const a=c(e,["topK"]);t!==void 0&&a!=null&&f(t,["setup","generationConfig","topK"],a);const l=c(e,["maxOutputTokens"]);t!==void 0&&l!=null&&f(t,["setup","generationConfig","maxOutputTokens"],l);const u=c(e,["mediaResolution"]);t!==void 0&&u!=null&&f(t,["setup","generationConfig","mediaResolution"],u);const d=c(e,["seed"]);t!==void 0&&d!=null&&f(t,["setup","generationConfig","seed"],d);const m=c(e,["speechConfig"]);t!==void 0&&m!=null&&f(t,["setup","generationConfig","speechConfig"],Tv(Fd(m)));const h=c(e,["thinkingConfig"]);t!==void 0&&h!=null&&f(t,["setup","generationConfig","thinkingConfig"],h);const g=c(e,["enableAffectiveDialog"]);t!==void 0&&g!=null&&f(t,["setup","generationConfig","enableAffectiveDialog"],g);const v=c(e,["systemInstruction"]);t!==void 0&&v!=null&&f(t,["setup","systemInstruction"],Ot(v));const x=c(e,["tools"]);if(t!==void 0&&x!=null){let D=Ss(x);Array.isArray(D)&&(D=D.map(C=>vR(_s(C)))),f(t,["setup","tools"],D)}const _=c(e,["sessionResumption"]);t!==void 0&&_!=null&&f(t,["setup","sessionResumption"],_);const T=c(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&f(t,["setup","inputAudioTranscription"],T);const y=c(e,["outputAudioTranscription"]);t!==void 0&&y!=null&&f(t,["setup","outputAudioTranscription"],y);const E=c(e,["realtimeInputConfig"]);t!==void 0&&E!=null&&f(t,["setup","realtimeInputConfig"],E);const A=c(e,["contextWindowCompression"]);t!==void 0&&A!=null&&f(t,["setup","contextWindowCompression"],A);const b=c(e,["proactivity"]);return t!==void 0&&b!=null&&f(t,["setup","proactivity"],b),n}function lR(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["setup","model"],Oe(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],oR(i,n)),n}function uR(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["setup","model"],Oe(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],aR(i,n)),n}function cR(e){const t={},n=c(e,["musicGenerationConfig"]);return n!=null&&f(t,["musicGenerationConfig"],n),t}function fR(e){const t={},n=c(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),f(t,["weightedPrompts"],r)}return t}function dR(e){const t={},n=c(e,["media"]);if(n!=null){let u=lv(n);Array.isArray(u)&&(u=u.map(d=>$a(d))),f(t,["mediaChunks"],u)}const r=c(e,["audio"]);r!=null&&f(t,["audio"],$a(cv(r)));const i=c(e,["audioStreamEnd"]);i!=null&&f(t,["audioStreamEnd"],i);const s=c(e,["video"]);s!=null&&f(t,["video"],$a(uv(s)));const o=c(e,["text"]);o!=null&&f(t,["text"],o);const a=c(e,["activityStart"]);a!=null&&f(t,["activityStart"],a);const l=c(e,["activityEnd"]);return l!=null&&f(t,["activityEnd"],l),t}function hR(e){const t={},n=c(e,["media"]);if(n!=null){let u=lv(n);Array.isArray(u)&&(u=u.map(d=>d)),f(t,["mediaChunks"],u)}const r=c(e,["audio"]);r!=null&&f(t,["audio"],cv(r));const i=c(e,["audioStreamEnd"]);i!=null&&f(t,["audioStreamEnd"],i);const s=c(e,["video"]);s!=null&&f(t,["video"],uv(s));const o=c(e,["text"]);o!=null&&f(t,["text"],o);const a=c(e,["activityStart"]);a!=null&&f(t,["activityStart"],a);const l=c(e,["activityEnd"]);return l!=null&&f(t,["activityEnd"],l),t}function pR(e){const t={},n=c(e,["setupComplete"]);n!=null&&f(t,["setupComplete"],n);const r=c(e,["serverContent"]);r!=null&&f(t,["serverContent"],r);const i=c(e,["toolCall"]);i!=null&&f(t,["toolCall"],i);const s=c(e,["toolCallCancellation"]);s!=null&&f(t,["toolCallCancellation"],s);const o=c(e,["usageMetadata"]);o!=null&&f(t,["usageMetadata"],yR(o));const a=c(e,["goAway"]);a!=null&&f(t,["goAway"],a);const l=c(e,["sessionResumptionUpdate"]);return l!=null&&f(t,["sessionResumptionUpdate"],l),t}function mR(e){const t={},n=c(e,["mediaResolution"]);n!=null&&f(t,["mediaResolution"],n);const r=c(e,["codeExecutionResult"]);r!=null&&f(t,["codeExecutionResult"],r);const i=c(e,["executableCode"]);i!=null&&f(t,["executableCode"],i);const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],eR(s));const o=c(e,["functionCall"]);o!=null&&f(t,["functionCall"],tR(o));const a=c(e,["functionResponse"]);a!=null&&f(t,["functionResponse"],a);const l=c(e,["inlineData"]);l!=null&&f(t,["inlineData"],$a(l));const u=c(e,["text"]);u!=null&&f(t,["text"],u);const d=c(e,["thought"]);d!=null&&f(t,["thought"],d);const m=c(e,["thoughtSignature"]);m!=null&&f(t,["thoughtSignature"],m);const h=c(e,["videoMetadata"]);return h!=null&&f(t,["videoMetadata"],h),t}function gR(e){const t={},n=c(e,["handle"]);if(n!=null&&f(t,["handle"],n),c(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function Tv(e){const t={},n=c(e,["languageCode"]);n!=null&&f(t,["languageCode"],n);const r=c(e,["voiceConfig"]);if(r!=null&&f(t,["voiceConfig"],r),c(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function xR(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(m=>m)),f(t,["functionDeclarations"],d)}if(c(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(e,["googleSearchRetrieval"]);r!=null&&f(t,["googleSearchRetrieval"],r);const i=c(e,["computerUse"]);i!=null&&f(t,["computerUse"],i);const s=c(e,["fileSearch"]);s!=null&&f(t,["fileSearch"],s);const o=c(e,["codeExecution"]);if(o!=null&&f(t,["codeExecution"],o),c(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(e,["googleMaps"]);a!=null&&f(t,["googleMaps"],iR(a));const l=c(e,["googleSearch"]);l!=null&&f(t,["googleSearch"],sR(l));const u=c(e,["urlContext"]);return u!=null&&f(t,["urlContext"],u),t}function vR(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(h=>nR(h))),f(t,["functionDeclarations"],m)}const r=c(e,["retrieval"]);r!=null&&f(t,["retrieval"],r);const i=c(e,["googleSearchRetrieval"]);i!=null&&f(t,["googleSearchRetrieval"],i);const s=c(e,["computerUse"]);if(s!=null&&f(t,["computerUse"],s),c(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=c(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const a=c(e,["enterpriseWebSearch"]);a!=null&&f(t,["enterpriseWebSearch"],a);const l=c(e,["googleMaps"]);l!=null&&f(t,["googleMaps"],l);const u=c(e,["googleSearch"]);u!=null&&f(t,["googleSearch"],u);const d=c(e,["urlContext"]);return d!=null&&f(t,["urlContext"],d),t}function yR(e){const t={},n=c(e,["promptTokenCount"]);n!=null&&f(t,["promptTokenCount"],n);const r=c(e,["cachedContentTokenCount"]);r!=null&&f(t,["cachedContentTokenCount"],r);const i=c(e,["candidatesTokenCount"]);i!=null&&f(t,["responseTokenCount"],i);const s=c(e,["toolUsePromptTokenCount"]);s!=null&&f(t,["toolUsePromptTokenCount"],s);const o=c(e,["thoughtsTokenCount"]);o!=null&&f(t,["thoughtsTokenCount"],o);const a=c(e,["totalTokenCount"]);a!=null&&f(t,["totalTokenCount"],a);const l=c(e,["promptTokensDetails"]);if(l!=null){let g=l;Array.isArray(g)&&(g=g.map(v=>v)),f(t,["promptTokensDetails"],g)}const u=c(e,["cacheTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(v=>v)),f(t,["cacheTokensDetails"],g)}const d=c(e,["candidatesTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(v=>v)),f(t,["responseTokensDetails"],g)}const m=c(e,["toolUsePromptTokensDetails"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(v=>v)),f(t,["toolUsePromptTokensDetails"],g)}const h=c(e,["trafficType"]);return h!=null&&f(t,["trafficType"],h),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ER(e){const t={},n=c(e,["data"]);if(n!=null&&f(t,["data"],n),c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function TR(e){const t={},n=c(e,["content"]);n!=null&&f(t,["content"],n);const r=c(e,["citationMetadata"]);r!=null&&f(t,["citationMetadata"],_R(r));const i=c(e,["tokenCount"]);i!=null&&f(t,["tokenCount"],i);const s=c(e,["finishReason"]);s!=null&&f(t,["finishReason"],s);const o=c(e,["avgLogprobs"]);o!=null&&f(t,["avgLogprobs"],o);const a=c(e,["groundingMetadata"]);a!=null&&f(t,["groundingMetadata"],a);const l=c(e,["index"]);l!=null&&f(t,["index"],l);const u=c(e,["logprobsResult"]);u!=null&&f(t,["logprobsResult"],u);const d=c(e,["safetyRatings"]);if(d!=null){let h=d;Array.isArray(h)&&(h=h.map(g=>g)),f(t,["safetyRatings"],h)}const m=c(e,["urlContextMetadata"]);return m!=null&&f(t,["urlContextMetadata"],m),t}function _R(e){const t={},n=c(e,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),f(t,["citations"],r)}return t}function SR(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["contents"]);if(i!=null){let s=Nn(i);Array.isArray(s)&&(s=s.map(o=>o)),f(n,["contents"],s)}return n}function wR(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),f(t,["tokensInfo"],i)}return t}function CR(e){const t={},n=c(e,["values"]);n!=null&&f(t,["values"],n);const r=c(e,["statistics"]);return r!=null&&f(t,["statistics"],AR(r)),t}function AR(e){const t={},n=c(e,["truncated"]);n!=null&&f(t,["truncated"],n);const r=c(e,["token_count"]);return r!=null&&f(t,["tokenCount"],r),t}function lu(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>L3(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function NR(e){const t={},n=c(e,["controlType"]);n!=null&&f(t,["controlType"],n);const r=c(e,["enableControlImageComputation"]);return r!=null&&f(t,["computeControl"],r),t}function IR(e){const t={};if(c(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(c(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(c(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function kR(e,t){const n={},r=c(e,["systemInstruction"]);t!==void 0&&r!=null&&f(t,["systemInstruction"],Ot(r));const i=c(e,["tools"]);if(t!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>Av(a))),f(t,["tools"],o)}const s=c(e,["generationConfig"]);return t!==void 0&&s!=null&&f(t,["generationConfig"],E3(s)),n}function RR(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["contents"]);if(i!=null){let o=Nn(i);Array.isArray(o)&&(o=o.map(a=>lu(a))),f(n,["contents"],o)}const s=c(t,["config"]);return s!=null&&IR(s),n}function PR(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["contents"]);if(i!=null){let o=Nn(i);Array.isArray(o)&&(o=o.map(a=>a)),f(n,["contents"],o)}const s=c(t,["config"]);return s!=null&&kR(s,n),n}function FR(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["totalTokens"]);r!=null&&f(t,["totalTokens"],r);const i=c(e,["cachedContentTokenCount"]);return i!=null&&f(t,["cachedContentTokenCount"],i),t}function MR(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["totalTokens"]);return r!=null&&f(t,["totalTokens"],r),t}function DR(e,t){const n={},r=c(t,["model"]);return r!=null&&f(n,["_url","name"],Oe(e,r)),n}function LR(e,t){const n={},r=c(t,["model"]);return r!=null&&f(n,["_url","name"],Oe(e,r)),n}function bR(e){const t={},n=c(e,["sdkHttpResponse"]);return n!=null&&f(t,["sdkHttpResponse"],n),t}function UR(e){const t={},n=c(e,["sdkHttpResponse"]);return n!=null&&f(t,["sdkHttpResponse"],n),t}function OR(e,t){const n={},r=c(e,["outputGcsUri"]);t!==void 0&&r!=null&&f(t,["parameters","storageUri"],r);const i=c(e,["negativePrompt"]);t!==void 0&&i!=null&&f(t,["parameters","negativePrompt"],i);const s=c(e,["numberOfImages"]);t!==void 0&&s!=null&&f(t,["parameters","sampleCount"],s);const o=c(e,["aspectRatio"]);t!==void 0&&o!=null&&f(t,["parameters","aspectRatio"],o);const a=c(e,["guidanceScale"]);t!==void 0&&a!=null&&f(t,["parameters","guidanceScale"],a);const l=c(e,["seed"]);t!==void 0&&l!=null&&f(t,["parameters","seed"],l);const u=c(e,["safetyFilterLevel"]);t!==void 0&&u!=null&&f(t,["parameters","safetySetting"],u);const d=c(e,["personGeneration"]);t!==void 0&&d!=null&&f(t,["parameters","personGeneration"],d);const m=c(e,["includeSafetyAttributes"]);t!==void 0&&m!=null&&f(t,["parameters","includeSafetyAttributes"],m);const h=c(e,["includeRaiReason"]);t!==void 0&&h!=null&&f(t,["parameters","includeRaiReason"],h);const g=c(e,["language"]);t!==void 0&&g!=null&&f(t,["parameters","language"],g);const v=c(e,["outputMimeType"]);t!==void 0&&v!=null&&f(t,["parameters","outputOptions","mimeType"],v);const x=c(e,["outputCompressionQuality"]);t!==void 0&&x!=null&&f(t,["parameters","outputOptions","compressionQuality"],x);const _=c(e,["addWatermark"]);t!==void 0&&_!=null&&f(t,["parameters","addWatermark"],_);const T=c(e,["labels"]);t!==void 0&&T!=null&&f(t,["labels"],T);const y=c(e,["editMode"]);t!==void 0&&y!=null&&f(t,["parameters","editMode"],y);const E=c(e,["baseSteps"]);return t!==void 0&&E!=null&&f(t,["parameters","editConfig","baseSteps"],E),n}function BR(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(t,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>G3(l))),f(n,["instances[0]","referenceImages"],a)}const o=c(t,["config"]);return o!=null&&OR(o,n),n}function VR(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>uu(s))),f(t,["generatedImages"],i)}return t}function GR(e,t){const n={},r=c(e,["taskType"]);t!==void 0&&r!=null&&f(t,["requests[]","taskType"],r);const i=c(e,["title"]);t!==void 0&&i!=null&&f(t,["requests[]","title"],i);const s=c(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&f(t,["requests[]","outputDimensionality"],s),c(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function HR(e,t){const n={},r=c(e,["taskType"]);t!==void 0&&r!=null&&f(t,["instances[]","task_type"],r);const i=c(e,["title"]);t!==void 0&&i!=null&&f(t,["instances[]","title"],i);const s=c(e,["outputDimensionality"]);t!==void 0&&s!=null&&f(t,["parameters","outputDimensionality"],s);const o=c(e,["mimeType"]);t!==void 0&&o!=null&&f(t,["instances[]","mimeType"],o);const a=c(e,["autoTruncate"]);return t!==void 0&&a!=null&&f(t,["parameters","autoTruncate"],a),n}function zR(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["contents"]);if(i!=null){let a=kd(e,i);Array.isArray(a)&&(a=a.map(l=>l)),f(n,["requests[]","content"],a)}const s=c(t,["config"]);s!=null&&GR(s,n);const o=c(t,["model"]);return o!==void 0&&f(n,["requests[]","model"],Oe(e,o)),n}function WR(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["contents"]);if(i!=null){let o=kd(e,i);Array.isArray(o)&&(o=o.map(a=>a)),f(n,["instances[]","content"],o)}const s=c(t,["config"]);return s!=null&&HR(s,n),n}function qR(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),f(t,["embeddings"],s)}const i=c(e,["metadata"]);return i!=null&&f(t,["metadata"],i),t}function $R(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>CR(o))),f(t,["embeddings"],s)}const i=c(e,["metadata"]);return i!=null&&f(t,["metadata"],i),t}function JR(e){const t={},n=c(e,["endpoint"]);n!=null&&f(t,["name"],n);const r=c(e,["deployedModelId"]);return r!=null&&f(t,["deployedModelId"],r),t}function KR(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function YR(e){const t={},n=c(e,["id"]);n!=null&&f(t,["id"],n);const r=c(e,["args"]);r!=null&&f(t,["args"],r);const i=c(e,["name"]);if(i!=null&&f(t,["name"],i),c(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function jR(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["allowedFunctionNames"]);if(r!=null&&f(t,["allowedFunctionNames"],r),c(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function XR(e){const t={};if(c(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(e,["description"]);n!=null&&f(t,["description"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["parameters"]);i!=null&&f(t,["parameters"],i);const s=c(e,["parametersJsonSchema"]);s!=null&&f(t,["parametersJsonSchema"],s);const o=c(e,["response"]);o!=null&&f(t,["response"],o);const a=c(e,["responseJsonSchema"]);return a!=null&&f(t,["responseJsonSchema"],a),t}function QR(e,t,n){const r={},i=c(t,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],lu(Ot(i)));const s=c(t,["temperature"]);s!=null&&f(r,["temperature"],s);const o=c(t,["topP"]);o!=null&&f(r,["topP"],o);const a=c(t,["topK"]);a!=null&&f(r,["topK"],a);const l=c(t,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const u=c(t,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const d=c(t,["stopSequences"]);d!=null&&f(r,["stopSequences"],d);const m=c(t,["responseLogprobs"]);m!=null&&f(r,["responseLogprobs"],m);const h=c(t,["logprobs"]);h!=null&&f(r,["logprobs"],h);const g=c(t,["presencePenalty"]);g!=null&&f(r,["presencePenalty"],g);const v=c(t,["frequencyPenalty"]);v!=null&&f(r,["frequencyPenalty"],v);const x=c(t,["seed"]);x!=null&&f(r,["seed"],x);const _=c(t,["responseMimeType"]);_!=null&&f(r,["responseMimeType"],_);const T=c(t,["responseSchema"]);T!=null&&f(r,["responseSchema"],Rd(T));const y=c(t,["responseJsonSchema"]);if(y!=null&&f(r,["responseJsonSchema"],y),c(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const E=c(t,["safetySettings"]);if(n!==void 0&&E!=null){let V=E;Array.isArray(V)&&(V=V.map(Y=>H3(Y))),f(n,["safetySettings"],V)}const A=c(t,["tools"]);if(n!==void 0&&A!=null){let V=Ss(A);Array.isArray(V)&&(V=V.map(Y=>Y3(_s(Y)))),f(n,["tools"],V)}const b=c(t,["toolConfig"]);if(n!==void 0&&b!=null&&f(n,["toolConfig"],K3(b)),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const D=c(t,["cachedContent"]);n!==void 0&&D!=null&&f(n,["cachedContent"],Tr(e,D));const C=c(t,["responseModalities"]);C!=null&&f(r,["responseModalities"],C);const L=c(t,["mediaResolution"]);L!=null&&f(r,["mediaResolution"],L);const P=c(t,["speechConfig"]);if(P!=null&&f(r,["speechConfig"],Pd(P)),c(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const U=c(t,["thinkingConfig"]);U!=null&&f(r,["thinkingConfig"],U);const W=c(t,["imageConfig"]);return W!=null&&f(r,["imageConfig"],C3(W)),r}function ZR(e,t,n){const r={},i=c(t,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],Ot(i));const s=c(t,["temperature"]);s!=null&&f(r,["temperature"],s);const o=c(t,["topP"]);o!=null&&f(r,["topP"],o);const a=c(t,["topK"]);a!=null&&f(r,["topK"],a);const l=c(t,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const u=c(t,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const d=c(t,["stopSequences"]);d!=null&&f(r,["stopSequences"],d);const m=c(t,["responseLogprobs"]);m!=null&&f(r,["responseLogprobs"],m);const h=c(t,["logprobs"]);h!=null&&f(r,["logprobs"],h);const g=c(t,["presencePenalty"]);g!=null&&f(r,["presencePenalty"],g);const v=c(t,["frequencyPenalty"]);v!=null&&f(r,["frequencyPenalty"],v);const x=c(t,["seed"]);x!=null&&f(r,["seed"],x);const _=c(t,["responseMimeType"]);_!=null&&f(r,["responseMimeType"],_);const T=c(t,["responseSchema"]);T!=null&&f(r,["responseSchema"],Rd(T));const y=c(t,["responseJsonSchema"]);y!=null&&f(r,["responseJsonSchema"],y);const E=c(t,["routingConfig"]);E!=null&&f(r,["routingConfig"],E);const A=c(t,["modelSelectionConfig"]);A!=null&&f(r,["modelConfig"],A);const b=c(t,["safetySettings"]);if(n!==void 0&&b!=null){let _e=b;Array.isArray(_e)&&(_e=_e.map(Ne=>Ne)),f(n,["safetySettings"],_e)}const D=c(t,["tools"]);if(n!==void 0&&D!=null){let _e=Ss(D);Array.isArray(_e)&&(_e=_e.map(Ne=>Av(_s(Ne)))),f(n,["tools"],_e)}const C=c(t,["toolConfig"]);n!==void 0&&C!=null&&f(n,["toolConfig"],C);const L=c(t,["labels"]);n!==void 0&&L!=null&&f(n,["labels"],L);const P=c(t,["cachedContent"]);n!==void 0&&P!=null&&f(n,["cachedContent"],Tr(e,P));const U=c(t,["responseModalities"]);U!=null&&f(r,["responseModalities"],U);const W=c(t,["mediaResolution"]);W!=null&&f(r,["mediaResolution"],W);const V=c(t,["speechConfig"]);V!=null&&f(r,["speechConfig"],Cv(Pd(V)));const Y=c(t,["audioTimestamp"]);Y!=null&&f(r,["audioTimestamp"],Y);const le=c(t,["thinkingConfig"]);le!=null&&f(r,["thinkingConfig"],le);const ue=c(t,["imageConfig"]);return ue!=null&&f(r,["imageConfig"],A3(ue)),r}function Xp(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["contents"]);if(i!=null){let o=Nn(i);Array.isArray(o)&&(o=o.map(a=>lu(a))),f(n,["contents"],o)}const s=c(t,["config"]);return s!=null&&f(n,["generationConfig"],QR(e,s,n)),n}function Qp(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["contents"]);if(i!=null){let o=Nn(i);Array.isArray(o)&&(o=o.map(a=>a)),f(n,["contents"],o)}const s=c(t,["config"]);return s!=null&&f(n,["generationConfig"],ZR(e,s,n)),n}function Zp(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>TR(u))),f(t,["candidates"],l)}const i=c(e,["modelVersion"]);i!=null&&f(t,["modelVersion"],i);const s=c(e,["promptFeedback"]);s!=null&&f(t,["promptFeedback"],s);const o=c(e,["responseId"]);o!=null&&f(t,["responseId"],o);const a=c(e,["usageMetadata"]);return a!=null&&f(t,["usageMetadata"],a),t}function em(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>d)),f(t,["candidates"],u)}const i=c(e,["createTime"]);i!=null&&f(t,["createTime"],i);const s=c(e,["modelVersion"]);s!=null&&f(t,["modelVersion"],s);const o=c(e,["promptFeedback"]);o!=null&&f(t,["promptFeedback"],o);const a=c(e,["responseId"]);a!=null&&f(t,["responseId"],a);const l=c(e,["usageMetadata"]);return l!=null&&f(t,["usageMetadata"],l),t}function e3(e,t){const n={};if(c(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=c(e,["numberOfImages"]);t!==void 0&&r!=null&&f(t,["parameters","sampleCount"],r);const i=c(e,["aspectRatio"]);t!==void 0&&i!=null&&f(t,["parameters","aspectRatio"],i);const s=c(e,["guidanceScale"]);if(t!==void 0&&s!=null&&f(t,["parameters","guidanceScale"],s),c(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=c(e,["safetyFilterLevel"]);t!==void 0&&o!=null&&f(t,["parameters","safetySetting"],o);const a=c(e,["personGeneration"]);t!==void 0&&a!=null&&f(t,["parameters","personGeneration"],a);const l=c(e,["includeSafetyAttributes"]);t!==void 0&&l!=null&&f(t,["parameters","includeSafetyAttributes"],l);const u=c(e,["includeRaiReason"]);t!==void 0&&u!=null&&f(t,["parameters","includeRaiReason"],u);const d=c(e,["language"]);t!==void 0&&d!=null&&f(t,["parameters","language"],d);const m=c(e,["outputMimeType"]);t!==void 0&&m!=null&&f(t,["parameters","outputOptions","mimeType"],m);const h=c(e,["outputCompressionQuality"]);if(t!==void 0&&h!=null&&f(t,["parameters","outputOptions","compressionQuality"],h),c(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const g=c(e,["imageSize"]);if(t!==void 0&&g!=null&&f(t,["parameters","sampleImageSize"],g),c(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function t3(e,t){const n={},r=c(e,["outputGcsUri"]);t!==void 0&&r!=null&&f(t,["parameters","storageUri"],r);const i=c(e,["negativePrompt"]);t!==void 0&&i!=null&&f(t,["parameters","negativePrompt"],i);const s=c(e,["numberOfImages"]);t!==void 0&&s!=null&&f(t,["parameters","sampleCount"],s);const o=c(e,["aspectRatio"]);t!==void 0&&o!=null&&f(t,["parameters","aspectRatio"],o);const a=c(e,["guidanceScale"]);t!==void 0&&a!=null&&f(t,["parameters","guidanceScale"],a);const l=c(e,["seed"]);t!==void 0&&l!=null&&f(t,["parameters","seed"],l);const u=c(e,["safetyFilterLevel"]);t!==void 0&&u!=null&&f(t,["parameters","safetySetting"],u);const d=c(e,["personGeneration"]);t!==void 0&&d!=null&&f(t,["parameters","personGeneration"],d);const m=c(e,["includeSafetyAttributes"]);t!==void 0&&m!=null&&f(t,["parameters","includeSafetyAttributes"],m);const h=c(e,["includeRaiReason"]);t!==void 0&&h!=null&&f(t,["parameters","includeRaiReason"],h);const g=c(e,["language"]);t!==void 0&&g!=null&&f(t,["parameters","language"],g);const v=c(e,["outputMimeType"]);t!==void 0&&v!=null&&f(t,["parameters","outputOptions","mimeType"],v);const x=c(e,["outputCompressionQuality"]);t!==void 0&&x!=null&&f(t,["parameters","outputOptions","compressionQuality"],x);const _=c(e,["addWatermark"]);t!==void 0&&_!=null&&f(t,["parameters","addWatermark"],_);const T=c(e,["labels"]);t!==void 0&&T!=null&&f(t,["labels"],T);const y=c(e,["imageSize"]);t!==void 0&&y!=null&&f(t,["parameters","sampleImageSize"],y);const E=c(e,["enhancePrompt"]);return t!==void 0&&E!=null&&f(t,["parameters","enhancePrompt"],E),n}function n3(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(t,["config"]);return s!=null&&e3(s,n),n}function r3(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(t,["config"]);return s!=null&&t3(s,n),n}function i3(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>g3(o))),f(t,["generatedImages"],s)}const i=c(e,["positivePromptSafetyAttributes"]);return i!=null&&f(t,["positivePromptSafetyAttributes"],Sv(i)),t}function s3(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>uu(o))),f(t,["generatedImages"],s)}const i=c(e,["positivePromptSafetyAttributes"]);return i!=null&&f(t,["positivePromptSafetyAttributes"],wv(i)),t}function o3(e,t){const n={},r=c(e,["numberOfVideos"]);if(t!==void 0&&r!=null&&f(t,["parameters","sampleCount"],r),c(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=c(e,["durationSeconds"]);if(t!==void 0&&i!=null&&f(t,["parameters","durationSeconds"],i),c(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=c(e,["aspectRatio"]);t!==void 0&&s!=null&&f(t,["parameters","aspectRatio"],s);const o=c(e,["resolution"]);t!==void 0&&o!=null&&f(t,["parameters","resolution"],o);const a=c(e,["personGeneration"]);if(t!==void 0&&a!=null&&f(t,["parameters","personGeneration"],a),c(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=c(e,["negativePrompt"]);t!==void 0&&l!=null&&f(t,["parameters","negativePrompt"],l);const u=c(e,["enhancePrompt"]);if(t!==void 0&&u!=null&&f(t,["parameters","enhancePrompt"],u),c(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const d=c(e,["lastFrame"]);t!==void 0&&d!=null&&f(t,["instances[0]","lastFrame"],cu(d));const m=c(e,["referenceImages"]);if(t!==void 0&&m!=null){let h=m;Array.isArray(h)&&(h=h.map(g=>lP(g))),f(t,["instances[0]","referenceImages"],h)}if(c(e,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(c(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function a3(e,t){const n={},r=c(e,["numberOfVideos"]);t!==void 0&&r!=null&&f(t,["parameters","sampleCount"],r);const i=c(e,["outputGcsUri"]);t!==void 0&&i!=null&&f(t,["parameters","storageUri"],i);const s=c(e,["fps"]);t!==void 0&&s!=null&&f(t,["parameters","fps"],s);const o=c(e,["durationSeconds"]);t!==void 0&&o!=null&&f(t,["parameters","durationSeconds"],o);const a=c(e,["seed"]);t!==void 0&&a!=null&&f(t,["parameters","seed"],a);const l=c(e,["aspectRatio"]);t!==void 0&&l!=null&&f(t,["parameters","aspectRatio"],l);const u=c(e,["resolution"]);t!==void 0&&u!=null&&f(t,["parameters","resolution"],u);const d=c(e,["personGeneration"]);t!==void 0&&d!=null&&f(t,["parameters","personGeneration"],d);const m=c(e,["pubsubTopic"]);t!==void 0&&m!=null&&f(t,["parameters","pubsubTopic"],m);const h=c(e,["negativePrompt"]);t!==void 0&&h!=null&&f(t,["parameters","negativePrompt"],h);const g=c(e,["enhancePrompt"]);t!==void 0&&g!=null&&f(t,["parameters","enhancePrompt"],g);const v=c(e,["generateAudio"]);t!==void 0&&v!=null&&f(t,["parameters","generateAudio"],v);const x=c(e,["lastFrame"]);t!==void 0&&x!=null&&f(t,["instances[0]","lastFrame"],zn(x));const _=c(e,["referenceImages"]);if(t!==void 0&&_!=null){let E=_;Array.isArray(E)&&(E=E.map(A=>uP(A))),f(t,["instances[0]","referenceImages"],E)}const T=c(e,["mask"]);t!==void 0&&T!=null&&f(t,["instances[0]","mask"],aP(T));const y=c(e,["compressionQuality"]);return t!==void 0&&y!=null&&f(t,["parameters","compressionQuality"],y),n}function l3(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["metadata"]);r!=null&&f(t,["metadata"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);s!=null&&f(t,["error"],s);const o=c(e,["response","generateVideoResponse"]);return o!=null&&f(t,["response"],d3(o)),t}function u3(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["metadata"]);r!=null&&f(t,["metadata"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);s!=null&&f(t,["error"],s);const o=c(e,["response"]);return o!=null&&f(t,["response"],h3(o)),t}function c3(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(t,["image"]);s!=null&&f(n,["instances[0]","image"],cu(s));const o=c(t,["video"]);o!=null&&f(n,["instances[0]","video"],Nv(o));const a=c(t,["source"]);a!=null&&p3(a,n);const l=c(t,["config"]);return l!=null&&o3(l,n),n}function f3(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(t,["image"]);s!=null&&f(n,["instances[0]","image"],zn(s));const o=c(t,["video"]);o!=null&&f(n,["instances[0]","video"],Iv(o));const a=c(t,["source"]);a!=null&&m3(a,n);const l=c(t,["config"]);return l!=null&&a3(l,n),n}function d3(e){const t={},n=c(e,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>v3(o))),f(t,["generatedVideos"],s)}const r=c(e,["raiMediaFilteredCount"]);r!=null&&f(t,["raiMediaFilteredCount"],r);const i=c(e,["raiMediaFilteredReasons"]);return i!=null&&f(t,["raiMediaFilteredReasons"],i),t}function h3(e){const t={},n=c(e,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>y3(o))),f(t,["generatedVideos"],s)}const r=c(e,["raiMediaFilteredCount"]);r!=null&&f(t,["raiMediaFilteredCount"],r);const i=c(e,["raiMediaFilteredReasons"]);return i!=null&&f(t,["raiMediaFilteredReasons"],i),t}function p3(e,t){const n={},r=c(e,["prompt"]);t!==void 0&&r!=null&&f(t,["instances[0]","prompt"],r);const i=c(e,["image"]);t!==void 0&&i!=null&&f(t,["instances[0]","image"],cu(i));const s=c(e,["video"]);return t!==void 0&&s!=null&&f(t,["instances[0]","video"],Nv(s)),n}function m3(e,t){const n={},r=c(e,["prompt"]);t!==void 0&&r!=null&&f(t,["instances[0]","prompt"],r);const i=c(e,["image"]);t!==void 0&&i!=null&&f(t,["instances[0]","image"],zn(i));const s=c(e,["video"]);return t!==void 0&&s!=null&&f(t,["instances[0]","video"],Iv(s)),n}function g3(e){const t={},n=c(e,["_self"]);n!=null&&f(t,["image"],N3(n));const r=c(e,["raiFilteredReason"]);r!=null&&f(t,["raiFilteredReason"],r);const i=c(e,["_self"]);return i!=null&&f(t,["safetyAttributes"],Sv(i)),t}function uu(e){const t={},n=c(e,["_self"]);n!=null&&f(t,["image"],_v(n));const r=c(e,["raiFilteredReason"]);r!=null&&f(t,["raiFilteredReason"],r);const i=c(e,["_self"]);i!=null&&f(t,["safetyAttributes"],wv(i));const s=c(e,["prompt"]);return s!=null&&f(t,["enhancedPrompt"],s),t}function x3(e){const t={},n=c(e,["_self"]);n!=null&&f(t,["mask"],_v(n));const r=c(e,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),f(t,["labels"],i)}return t}function v3(e){const t={},n=c(e,["video"]);return n!=null&&f(t,["video"],sP(n)),t}function y3(e){const t={},n=c(e,["_self"]);return n!=null&&f(t,["video"],oP(n)),t}function E3(e){const t={},n=c(e,["modelSelectionConfig"]);n!=null&&f(t,["modelConfig"],n);const r=c(e,["responseJsonSchema"]);r!=null&&f(t,["responseJsonSchema"],r);const i=c(e,["audioTimestamp"]);i!=null&&f(t,["audioTimestamp"],i);const s=c(e,["candidateCount"]);s!=null&&f(t,["candidateCount"],s);const o=c(e,["enableAffectiveDialog"]);o!=null&&f(t,["enableAffectiveDialog"],o);const a=c(e,["frequencyPenalty"]);a!=null&&f(t,["frequencyPenalty"],a);const l=c(e,["logprobs"]);l!=null&&f(t,["logprobs"],l);const u=c(e,["maxOutputTokens"]);u!=null&&f(t,["maxOutputTokens"],u);const d=c(e,["mediaResolution"]);d!=null&&f(t,["mediaResolution"],d);const m=c(e,["presencePenalty"]);m!=null&&f(t,["presencePenalty"],m);const h=c(e,["responseLogprobs"]);h!=null&&f(t,["responseLogprobs"],h);const g=c(e,["responseMimeType"]);g!=null&&f(t,["responseMimeType"],g);const v=c(e,["responseModalities"]);v!=null&&f(t,["responseModalities"],v);const x=c(e,["responseSchema"]);x!=null&&f(t,["responseSchema"],x);const _=c(e,["routingConfig"]);_!=null&&f(t,["routingConfig"],_);const T=c(e,["seed"]);T!=null&&f(t,["seed"],T);const y=c(e,["speechConfig"]);y!=null&&f(t,["speechConfig"],Cv(y));const E=c(e,["stopSequences"]);E!=null&&f(t,["stopSequences"],E);const A=c(e,["temperature"]);A!=null&&f(t,["temperature"],A);const b=c(e,["thinkingConfig"]);b!=null&&f(t,["thinkingConfig"],b);const D=c(e,["topK"]);D!=null&&f(t,["topK"],D);const C=c(e,["topP"]);if(C!=null&&f(t,["topP"],C),c(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function T3(e,t){const n={},r=c(t,["model"]);return r!=null&&f(n,["_url","name"],Oe(e,r)),n}function _3(e,t){const n={},r=c(t,["model"]);return r!=null&&f(n,["_url","name"],Oe(e,r)),n}function S3(e){const t={};if(c(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(e,["enableWidget"]);return n!=null&&f(t,["enableWidget"],n),t}function w3(e){const t={};if(c(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],n),t}function C3(e){const t={},n=c(e,["aspectRatio"]);n!=null&&f(t,["aspectRatio"],n);const r=c(e,["imageSize"]);if(r!=null&&f(t,["imageSize"],r),c(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(c(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function A3(e){const t={},n=c(e,["aspectRatio"]);n!=null&&f(t,["aspectRatio"],n);const r=c(e,["imageSize"]);r!=null&&f(t,["imageSize"],r);const i=c(e,["outputMimeType"]);i!=null&&f(t,["imageOutputOptions","mimeType"],i);const s=c(e,["outputCompressionQuality"]);return s!=null&&f(t,["imageOutputOptions","compressionQuality"],s),t}function N3(e){const t={},n=c(e,["bytesBase64Encoded"]);n!=null&&f(t,["imageBytes"],jr(n));const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function _v(e){const t={},n=c(e,["gcsUri"]);n!=null&&f(t,["gcsUri"],n);const r=c(e,["bytesBase64Encoded"]);r!=null&&f(t,["imageBytes"],jr(r));const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function cu(e){const t={};if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=c(e,["imageBytes"]);n!=null&&f(t,["bytesBase64Encoded"],jr(n));const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function zn(e){const t={},n=c(e,["gcsUri"]);n!=null&&f(t,["gcsUri"],n);const r=c(e,["imageBytes"]);r!=null&&f(t,["bytesBase64Encoded"],jr(r));const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function I3(e,t,n){const r={},i=c(t,["pageSize"]);n!==void 0&&i!=null&&f(n,["_query","pageSize"],i);const s=c(t,["pageToken"]);n!==void 0&&s!=null&&f(n,["_query","pageToken"],s);const o=c(t,["filter"]);n!==void 0&&o!=null&&f(n,["_query","filter"],o);const a=c(t,["queryBase"]);return n!==void 0&&a!=null&&f(n,["_url","models_url"],pv(e,a)),r}function k3(e,t,n){const r={},i=c(t,["pageSize"]);n!==void 0&&i!=null&&f(n,["_query","pageSize"],i);const s=c(t,["pageToken"]);n!==void 0&&s!=null&&f(n,["_query","pageToken"],s);const o=c(t,["filter"]);n!==void 0&&o!=null&&f(n,["_query","filter"],o);const a=c(t,["queryBase"]);return n!==void 0&&a!=null&&f(n,["_url","models_url"],pv(e,a)),r}function R3(e,t){const n={},r=c(t,["config"]);return r!=null&&I3(e,r,n),n}function P3(e,t){const n={},r=c(t,["config"]);return r!=null&&k3(e,r,n),n}function F3(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["_self"]);if(i!=null){let s=mv(i);Array.isArray(s)&&(s=s.map(o=>af(o))),f(t,["models"],s)}return t}function M3(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["_self"]);if(i!=null){let s=mv(i);Array.isArray(s)&&(s=s.map(o=>lf(o))),f(t,["models"],s)}return t}function D3(e){const t={},n=c(e,["maskMode"]);n!=null&&f(t,["maskMode"],n);const r=c(e,["segmentationClasses"]);r!=null&&f(t,["maskClasses"],r);const i=c(e,["maskDilation"]);return i!=null&&f(t,["dilation"],i),t}function af(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["description"]);i!=null&&f(t,["description"],i);const s=c(e,["version"]);s!=null&&f(t,["version"],s);const o=c(e,["_self"]);o!=null&&f(t,["tunedModelInfo"],j3(o));const a=c(e,["inputTokenLimit"]);a!=null&&f(t,["inputTokenLimit"],a);const l=c(e,["outputTokenLimit"]);l!=null&&f(t,["outputTokenLimit"],l);const u=c(e,["supportedGenerationMethods"]);u!=null&&f(t,["supportedActions"],u);const d=c(e,["temperature"]);d!=null&&f(t,["temperature"],d);const m=c(e,["maxTemperature"]);m!=null&&f(t,["maxTemperature"],m);const h=c(e,["topP"]);h!=null&&f(t,["topP"],h);const g=c(e,["topK"]);g!=null&&f(t,["topK"],g);const v=c(e,["thinking"]);return v!=null&&f(t,["thinking"],v),t}function lf(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["description"]);i!=null&&f(t,["description"],i);const s=c(e,["versionId"]);s!=null&&f(t,["version"],s);const o=c(e,["deployedModels"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(h=>JR(h))),f(t,["endpoints"],m)}const a=c(e,["labels"]);a!=null&&f(t,["labels"],a);const l=c(e,["_self"]);l!=null&&f(t,["tunedModelInfo"],X3(l));const u=c(e,["defaultCheckpointId"]);u!=null&&f(t,["defaultCheckpointId"],u);const d=c(e,["checkpoints"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(h=>h)),f(t,["checkpoints"],m)}return t}function L3(e){const t={},n=c(e,["mediaResolution"]);n!=null&&f(t,["mediaResolution"],n);const r=c(e,["codeExecutionResult"]);r!=null&&f(t,["codeExecutionResult"],r);const i=c(e,["executableCode"]);i!=null&&f(t,["executableCode"],i);const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],KR(s));const o=c(e,["functionCall"]);o!=null&&f(t,["functionCall"],YR(o));const a=c(e,["functionResponse"]);a!=null&&f(t,["functionResponse"],a);const l=c(e,["inlineData"]);l!=null&&f(t,["inlineData"],ER(l));const u=c(e,["text"]);u!=null&&f(t,["text"],u);const d=c(e,["thought"]);d!=null&&f(t,["thought"],d);const m=c(e,["thoughtSignature"]);m!=null&&f(t,["thoughtSignature"],m);const h=c(e,["videoMetadata"]);return h!=null&&f(t,["videoMetadata"],h),t}function b3(e){const t={},n=c(e,["productImage"]);return n!=null&&f(t,["image"],zn(n)),t}function U3(e,t){const n={},r=c(e,["numberOfImages"]);t!==void 0&&r!=null&&f(t,["parameters","sampleCount"],r);const i=c(e,["baseSteps"]);t!==void 0&&i!=null&&f(t,["parameters","baseSteps"],i);const s=c(e,["outputGcsUri"]);t!==void 0&&s!=null&&f(t,["parameters","storageUri"],s);const o=c(e,["seed"]);t!==void 0&&o!=null&&f(t,["parameters","seed"],o);const a=c(e,["safetyFilterLevel"]);t!==void 0&&a!=null&&f(t,["parameters","safetySetting"],a);const l=c(e,["personGeneration"]);t!==void 0&&l!=null&&f(t,["parameters","personGeneration"],l);const u=c(e,["addWatermark"]);t!==void 0&&u!=null&&f(t,["parameters","addWatermark"],u);const d=c(e,["outputMimeType"]);t!==void 0&&d!=null&&f(t,["parameters","outputOptions","mimeType"],d);const m=c(e,["outputCompressionQuality"]);t!==void 0&&m!=null&&f(t,["parameters","outputOptions","compressionQuality"],m);const h=c(e,["enhancePrompt"]);t!==void 0&&h!=null&&f(t,["parameters","enhancePrompt"],h);const g=c(e,["labels"]);return t!==void 0&&g!=null&&f(t,["labels"],g),n}function O3(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["source"]);i!=null&&V3(i,n);const s=c(t,["config"]);return s!=null&&U3(s,n),n}function B3(e){const t={},n=c(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>uu(i))),f(t,["generatedImages"],r)}return t}function V3(e,t){const n={},r=c(e,["prompt"]);t!==void 0&&r!=null&&f(t,["instances[0]","prompt"],r);const i=c(e,["personImage"]);t!==void 0&&i!=null&&f(t,["instances[0]","personImage","image"],zn(i));const s=c(e,["productImages"]);if(t!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>b3(a))),f(t,["instances[0]","productImages"],o)}return n}function G3(e){const t={},n=c(e,["referenceImage"]);n!=null&&f(t,["referenceImage"],zn(n));const r=c(e,["referenceId"]);r!=null&&f(t,["referenceId"],r);const i=c(e,["referenceType"]);i!=null&&f(t,["referenceType"],i);const s=c(e,["maskImageConfig"]);s!=null&&f(t,["maskImageConfig"],D3(s));const o=c(e,["controlImageConfig"]);o!=null&&f(t,["controlImageConfig"],NR(o));const a=c(e,["styleImageConfig"]);a!=null&&f(t,["styleImageConfig"],a);const l=c(e,["subjectImageConfig"]);return l!=null&&f(t,["subjectImageConfig"],l),t}function Sv(e){const t={},n=c(e,["safetyAttributes","categories"]);n!=null&&f(t,["categories"],n);const r=c(e,["safetyAttributes","scores"]);r!=null&&f(t,["scores"],r);const i=c(e,["contentType"]);return i!=null&&f(t,["contentType"],i),t}function wv(e){const t={},n=c(e,["safetyAttributes","categories"]);n!=null&&f(t,["categories"],n);const r=c(e,["safetyAttributes","scores"]);r!=null&&f(t,["scores"],r);const i=c(e,["contentType"]);return i!=null&&f(t,["contentType"],i),t}function H3(e){const t={},n=c(e,["category"]);if(n!=null&&f(t,["category"],n),c(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=c(e,["threshold"]);return r!=null&&f(t,["threshold"],r),t}function z3(e){const t={},n=c(e,["image"]);return n!=null&&f(t,["image"],zn(n)),t}function W3(e,t){const n={},r=c(e,["mode"]);t!==void 0&&r!=null&&f(t,["parameters","mode"],r);const i=c(e,["maxPredictions"]);t!==void 0&&i!=null&&f(t,["parameters","maxPredictions"],i);const s=c(e,["confidenceThreshold"]);t!==void 0&&s!=null&&f(t,["parameters","confidenceThreshold"],s);const o=c(e,["maskDilation"]);t!==void 0&&o!=null&&f(t,["parameters","maskDilation"],o);const a=c(e,["binaryColorThreshold"]);t!==void 0&&a!=null&&f(t,["parameters","binaryColorThreshold"],a);const l=c(e,["labels"]);return t!==void 0&&l!=null&&f(t,["labels"],l),n}function q3(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["source"]);i!=null&&J3(i,n);const s=c(t,["config"]);return s!=null&&W3(s,n),n}function $3(e){const t={},n=c(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>x3(i))),f(t,["generatedMasks"],r)}return t}function J3(e,t){const n={},r=c(e,["prompt"]);t!==void 0&&r!=null&&f(t,["instances[0]","prompt"],r);const i=c(e,["image"]);t!==void 0&&i!=null&&f(t,["instances[0]","image"],zn(i));const s=c(e,["scribbleImage"]);return t!==void 0&&s!=null&&f(t,["instances[0]","scribble"],z3(s)),n}function Cv(e){const t={},n=c(e,["languageCode"]);n!=null&&f(t,["languageCode"],n);const r=c(e,["voiceConfig"]);if(r!=null&&f(t,["voiceConfig"],r),c(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function K3(e){const t={},n=c(e,["functionCallingConfig"]);n!=null&&f(t,["functionCallingConfig"],jR(n));const r=c(e,["retrievalConfig"]);return r!=null&&f(t,["retrievalConfig"],r),t}function Y3(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(m=>m)),f(t,["functionDeclarations"],d)}if(c(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(e,["googleSearchRetrieval"]);r!=null&&f(t,["googleSearchRetrieval"],r);const i=c(e,["computerUse"]);i!=null&&f(t,["computerUse"],i);const s=c(e,["fileSearch"]);s!=null&&f(t,["fileSearch"],s);const o=c(e,["codeExecution"]);if(o!=null&&f(t,["codeExecution"],o),c(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(e,["googleMaps"]);a!=null&&f(t,["googleMaps"],S3(a));const l=c(e,["googleSearch"]);l!=null&&f(t,["googleSearch"],w3(l));const u=c(e,["urlContext"]);return u!=null&&f(t,["urlContext"],u),t}function Av(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(h=>XR(h))),f(t,["functionDeclarations"],m)}const r=c(e,["retrieval"]);r!=null&&f(t,["retrieval"],r);const i=c(e,["googleSearchRetrieval"]);i!=null&&f(t,["googleSearchRetrieval"],i);const s=c(e,["computerUse"]);if(s!=null&&f(t,["computerUse"],s),c(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=c(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const a=c(e,["enterpriseWebSearch"]);a!=null&&f(t,["enterpriseWebSearch"],a);const l=c(e,["googleMaps"]);l!=null&&f(t,["googleMaps"],l);const u=c(e,["googleSearch"]);u!=null&&f(t,["googleSearch"],u);const d=c(e,["urlContext"]);return d!=null&&f(t,["urlContext"],d),t}function j3(e){const t={},n=c(e,["baseModel"]);n!=null&&f(t,["baseModel"],n);const r=c(e,["createTime"]);r!=null&&f(t,["createTime"],r);const i=c(e,["updateTime"]);return i!=null&&f(t,["updateTime"],i),t}function X3(e){const t={},n=c(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&f(t,["baseModel"],n);const r=c(e,["createTime"]);r!=null&&f(t,["createTime"],r);const i=c(e,["updateTime"]);return i!=null&&f(t,["updateTime"],i),t}function Q3(e,t){const n={},r=c(e,["displayName"]);t!==void 0&&r!=null&&f(t,["displayName"],r);const i=c(e,["description"]);t!==void 0&&i!=null&&f(t,["description"],i);const s=c(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&f(t,["defaultCheckpointId"],s),n}function Z3(e,t){const n={},r=c(e,["displayName"]);t!==void 0&&r!=null&&f(t,["displayName"],r);const i=c(e,["description"]);t!==void 0&&i!=null&&f(t,["description"],i);const s=c(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&f(t,["defaultCheckpointId"],s),n}function eP(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","name"],Oe(e,r));const i=c(t,["config"]);return i!=null&&Q3(i,n),n}function tP(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["config"]);return i!=null&&Z3(i,n),n}function nP(e,t){const n={},r=c(e,["outputGcsUri"]);t!==void 0&&r!=null&&f(t,["parameters","storageUri"],r);const i=c(e,["safetyFilterLevel"]);t!==void 0&&i!=null&&f(t,["parameters","safetySetting"],i);const s=c(e,["personGeneration"]);t!==void 0&&s!=null&&f(t,["parameters","personGeneration"],s);const o=c(e,["includeRaiReason"]);t!==void 0&&o!=null&&f(t,["parameters","includeRaiReason"],o);const a=c(e,["outputMimeType"]);t!==void 0&&a!=null&&f(t,["parameters","outputOptions","mimeType"],a);const l=c(e,["outputCompressionQuality"]);t!==void 0&&l!=null&&f(t,["parameters","outputOptions","compressionQuality"],l);const u=c(e,["enhanceInputImage"]);t!==void 0&&u!=null&&f(t,["parameters","upscaleConfig","enhanceInputImage"],u);const d=c(e,["imagePreservationFactor"]);t!==void 0&&d!=null&&f(t,["parameters","upscaleConfig","imagePreservationFactor"],d);const m=c(e,["labels"]);t!==void 0&&m!=null&&f(t,["labels"],m);const h=c(e,["numberOfImages"]);t!==void 0&&h!=null&&f(t,["parameters","sampleCount"],h);const g=c(e,["mode"]);return t!==void 0&&g!=null&&f(t,["parameters","mode"],g),n}function rP(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],Oe(e,r));const i=c(t,["image"]);i!=null&&f(n,["instances[0]","image"],zn(i));const s=c(t,["upscaleFactor"]);s!=null&&f(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=c(t,["config"]);return o!=null&&nP(o,n),n}function iP(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>uu(s))),f(t,["generatedImages"],i)}return t}function sP(e){const t={},n=c(e,["uri"]);n!=null&&f(t,["uri"],n);const r=c(e,["encodedVideo"]);r!=null&&f(t,["videoBytes"],jr(r));const i=c(e,["encoding"]);return i!=null&&f(t,["mimeType"],i),t}function oP(e){const t={},n=c(e,["gcsUri"]);n!=null&&f(t,["uri"],n);const r=c(e,["bytesBase64Encoded"]);r!=null&&f(t,["videoBytes"],jr(r));const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function aP(e){const t={},n=c(e,["image"]);n!=null&&f(t,["_self"],zn(n));const r=c(e,["maskMode"]);return r!=null&&f(t,["maskMode"],r),t}function lP(e){const t={},n=c(e,["image"]);n!=null&&f(t,["image"],cu(n));const r=c(e,["referenceType"]);return r!=null&&f(t,["referenceType"],r),t}function uP(e){const t={},n=c(e,["image"]);n!=null&&f(t,["image"],zn(n));const r=c(e,["referenceType"]);return r!=null&&f(t,["referenceType"],r),t}function Nv(e){const t={},n=c(e,["uri"]);n!=null&&f(t,["uri"],n);const r=c(e,["videoBytes"]);r!=null&&f(t,["encodedVideo"],jr(r));const i=c(e,["mimeType"]);return i!=null&&f(t,["encoding"],i),t}function Iv(e){const t={},n=c(e,["uri"]);n!=null&&f(t,["gcsUri"],n);const r=c(e,["videoBytes"]);r!=null&&f(t,["bytesBase64Encoded"],jr(r));const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cP="Content-Type",fP="X-Server-Timeout",dP="User-Agent",uf="x-goog-api-client",hP="1.30.0",pP=`google-genai-sdk/${hP}`,mP="v1beta1",gP="v1beta",tm=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class xP{constructor(t){var n,r;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:mP,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:gP,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&r.push(t.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),t!==""&&i.push(t),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);if(t.queryParams)for(const[o,a]of Object.entries(t.queryParams))i.searchParams.append(o,String(a));let s={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=t.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),t.abortSignal),this.unaryApiCall(i,s,t.httpMethod)}patchHttpOptions(t,n){const r=JSON.parse(JSON.stringify(t));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=t.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),t.abortSignal),this.streamApiCall(i,s,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,r,i){if(n&&n.timeout||i){const s=new AbortController,o=s.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>s.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),t.signal=o}return n&&n.extraBody!==null&&vP(t,n.extraBody),t.headers=await this.getHeadersInternal(n,r),t}async unaryApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await nm(i),new rf(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await nm(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(t){var n;return ss(this,arguments,function*(){const i=(n=t==null?void 0:t.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield je(i.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=s.decode(l,{stream:!0});try{const m=JSON.parse(u);if("error"in m){const h=JSON.parse(JSON.stringify(m.error)),g=h.status,v=h.code,x=`got status: ${g}. ${JSON.stringify(m)}`;if(v>=400&&v<600)throw new au({message:x,status:v})}}catch(m){if(m.name==="ApiError")throw m}o+=u;let d=o.match(tm);for(;d;){const m=d[1];try{const h=new Response(m,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield je(new rf(h)),o=o.slice(d[0].length),d=o.match(tm)}catch(h){throw new Error(`exception parsing stream chunk ${m}. ${h}`)}}}}finally{i.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const t={},n=pP+" "+this.clientOptions.userAgentExtra;return t[dP]=n,t[uf]=n,t[cP]="application/json",t}async getHeadersInternal(t,n){const r=new Headers;if(t&&t.headers){for(const[i,s]of Object.entries(t.headers))r.append(i,s);t.timeout&&t.timeout>0&&r.append(fP,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(t){var n;let r="";return typeof t=="string"&&(r=t.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(t,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(t);i.sizeBytes=String(o.size);const a=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const l={file:i},u=this.getFileName(t),d=de("upload/v1beta/files",l._url),m=await this.fetchUploadUrl(d,i.sizeBytes,i.mimeType,u,l,n==null?void 0:n.httpOptions);return s.upload(t,m,this)}async uploadFileToFileSearchStore(t,n,r){var i;const s=this.clientOptions.uploader,o=await s.stat(n),a=String(o.size),l=(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const u=`upload/v1beta/${t}:uploadToFileSearchStore`,d=this.getFileName(n),m={};r!=null&&r.customMetadata&&(m.customMetadata=r.customMetadata),r!=null&&r.chunkingConfig&&(m.chunkingConfig=r.chunkingConfig);const h=await this.fetchUploadUrl(u,a,l,d,m,r==null?void 0:r.httpOptions);return s.uploadToFileSearchStore(n,h,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,n,r,i,s,o){var a;let l={};o?l=o:l={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},i?{"X-Goog-Upload-File-Name":i}:{})};const u=await this.request({path:t,body:JSON.stringify(s),httpMethod:"POST",httpOptions:l});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(a=u==null?void 0:u.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function nm(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const n=e.status;let r;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?r=await e.json():r={error:{message:await e.text(),code:e.status,status:e.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new au({message:i,status:n}):new Error(i)}}function vP(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof e.body=="string"&&e.body.length>0)try{const s=JSON.parse(e.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],d=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&d&&typeof d=="object"&&!Array.isArray(d)?a[l]=r(d,u):(d&&u&&typeof d!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof d}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const i=r(n,t);e.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yP="mcp_used/unknown";let EP=!1;function kv(e){for(const t of e)if(TP(t)||typeof t=="object"&&"inputSchema"in t)return!0;return EP}function Rv(e){var t;const n=(t=e[uf])!==null&&t!==void 0?t:"";e[uf]=(n+` ${yP}`).trimStart()}function TP(e){return e!==null&&typeof e=="object"&&e instanceof Md}function _P(e,t=100){return ss(this,arguments,function*(){let r,i=0;for(;i<t;){const s=yield je(e.listTools({cursor:r}));for(const o of s.tools)yield yield je(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class Md{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new Md(t,n)}async initialize(){var t,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const d of this.mcpClients)try{for(var a=!0,l=(n=void 0,xo(_P(d))),u;u=await l.next(),t=u.done,!t;a=!0){i=u.value,a=!1;const m=i;o.push(m);const h=m.name;if(s[h])throw new Error(`Duplicate function name ${h} found in MCP tools. Please ensure function names are unique.`);s[h]=d}}catch(m){n={error:m}}finally{try{!a&&!t&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),p4(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const r of t)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function SP(e,t,n){const r=new o4;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),t(r)}class wP{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r}async connect(t){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=NP(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const d=new Promise(E=>{u=E}),m=t.callbacks,h=function(){u({})},g=this.apiClient,v={onopen:h,onmessage:E=>{SP(g,m.onmessage,E)},onerror:(n=m==null?void 0:m.onerror)!==null&&n!==void 0?n:function(E){},onclose:(r=m==null?void 0:m.onclose)!==null&&r!==void 0?r:function(E){}},x=this.webSocketFactory.create(l,AP(o),v);x.connect(),await d;const y={setup:{model:Oe(this.apiClient,t.model)}};return x.send(JSON.stringify(y)),new CP(x,this.apiClient)}}class CP{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=fR(t);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=cR(t);this.conn.send(JSON.stringify(n))}sendPlaybackControl(t){const n={playbackControl:t};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl($i.PLAY)}pause(){this.sendPlaybackControl($i.PAUSE)}stop(){this.sendPlaybackControl($i.STOP)}resetContext(){this.sendPlaybackControl($i.RESET_CONTEXT)}close(){this.conn.close()}}function AP(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function NP(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const IP="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function kP(e,t,n){const r=new s4;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(e.isVertexAI()){const o=pR(s);Object.assign(r,o)}else Object.assign(r,s);t(r)}class RP{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r,this.music=new wP(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,r,i,s,o,a;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let d;const m=this.apiClient.getHeaders();t.config&&t.config.tools&&kv(t.config.tools)&&Rv(m);const h=DP(m);if(this.apiClient.isVertexAI())d=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(h,d);else{const P=this.apiClient.getApiKey();let U="BidiGenerateContent",W="key";P!=null&&P.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),U="BidiGenerateContentConstrained",W="access_token"),d=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${U}?${W}=${P}`}let g=()=>{};const v=new Promise(P=>{g=P}),x=t.callbacks,_=function(){var P;(P=x==null?void 0:x.onopen)===null||P===void 0||P.call(x),g({})},T=this.apiClient,y={onopen:_,onmessage:P=>{kP(T,x.onmessage,P)},onerror:(n=x==null?void 0:x.onerror)!==null&&n!==void 0?n:function(P){},onclose:(r=x==null?void 0:x.onclose)!==null&&r!==void 0?r:function(P){}},E=this.webSocketFactory.create(d,MP(h),y);E.connect(),await v;let A=Oe(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&A.startsWith("publishers/")){const P=this.apiClient.getProject(),U=this.apiClient.getLocation();A=`projects/${P}/locations/${U}/`+A}let b={};this.apiClient.isVertexAI()&&((i=t.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[Ml.AUDIO]}:t.config.responseModalities=[Ml.AUDIO]),!((s=t.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const D=(a=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],C=[];for(const P of D)if(this.isCallableTool(P)){const U=P;C.push(await U.tool())}else C.push(P);C.length>0&&(t.config.tools=C);const L={model:A,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?b=uR(this.apiClient,L):b=lR(this.apiClient,L),delete b.config,E.send(JSON.stringify(b)),new FP(E,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const PP={turnComplete:!0};class FP{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Nn(n.turns),t.isVertexAI()||(r=r.map(i=>lu(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!t.isVertexAI()&&!("id"in s))throw new Error(IP)}return{toolResponse:{functionResponses:r}}}sendClientContent(t){t=Object.assign(Object.assign({},PP),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:hR(t)}:n={realtimeInput:dR(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function MP(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function DP(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rm=10;function im(e){var t,n,r;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let i=!1;for(const o of(n=e==null?void 0:e.tools)!==null&&n!==void 0?n:[])if(os(o)){i=!0;break}if(!i)return!0;const s=(r=e==null?void 0:e.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function os(e){return"callTool"in e&&typeof e.callTool=="function"}function LP(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(i=>os(i)))!==null&&r!==void 0?r:!1}function sm(e){var t;const n=[];return!((t=e==null?void 0:e.config)===null||t===void 0)&&t.tools&&e.config.tools.forEach((r,i)=>{if(os(r))return;const s=r;s.functionDeclarations&&s.functionDeclarations.length>0&&n.push(i)}),n}function om(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bP extends Er{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>{var r,i,s,o,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!LP(n)||im(n.config))return await this.generateContentInternal(l);const u=sm(n);if(u.length>0){const x=u.map(_=>`tools[${_}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${x}.`)}let d,m;const h=Nn(l.contents),g=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:rm;let v=0;for(;v<g&&(d=await this.generateContentInternal(l),!(!d.functionCalls||d.functionCalls.length===0));){const x=d.candidates[0].content,_=[];for(const T of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(os(T)){const E=await T.callTool(d.functionCalls);_.push(...E)}v++,m={role:"user",parts:_},l.contents=Nn(l.contents),l.contents.push(x),l.contents.push(m),om(l.config)&&(h.push(x),h.push(m))}return om(l.config)&&(d.automaticFunctionCallingHistory=h),d},this.generateContentStream=async n=>{var r,i,s,o,a;if(this.maybeMoveToResponseJsonSchem(n),im(n.config)){const m=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(m)}const l=sm(n);if(l.length>0){const m=l.map(h=>`tools[${h}]`).join(", ");throw new Error(`Incompatible tools found at ${m}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const u=(s=(i=(r=n==null?void 0:n.config)===null||r===void 0?void 0:r.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,d=(a=(o=n==null?void 0:n.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(u&&!d)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:o.push(l);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Si(xr.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,s,o,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var n,r,i;const s=(n=t.config)===null||n===void 0?void 0:n.tools;if(!s)return t;const o=await Promise.all(s.map(async l=>os(l)?await l.tool():l)),a={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:o})};if(a.config.tools=o,t.config&&t.config.tools&&kv(t.config.tools)){const l=(i=(r=t.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),Rv(u),a.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(t){var n,r,i;const s=new Map;for(const o of(r=(n=t.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(os(o)){const a=o,l=await a.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,a)}}return s}async processAfcStream(t){var n,r,i;const s=(i=(r=(n=t.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:rm;let o=!1,a=0;const l=await this.initAfcToolsMap(t);return function(u,d,m){var h,g;return ss(this,arguments,function*(){for(var v,x,_,T;a<s;){o&&(a++,o=!1);const b=yield je(u.processParamsMaybeAddMcpUsage(m)),D=yield je(u.generateContentStreamInternal(b)),C=[],L=[];try{for(var y=!0,E=(x=void 0,xo(D)),A;A=yield je(E.next()),v=A.done,!v;y=!0){T=A.value,y=!1;const P=T;if(yield yield je(P),P.candidates&&(!((h=P.candidates[0])===null||h===void 0)&&h.content)){L.push(P.candidates[0].content);for(const U of(g=P.candidates[0].content.parts)!==null&&g!==void 0?g:[])if(a<s&&U.functionCall){if(!U.functionCall.name)throw new Error("Function call name was not returned by the model.");if(d.has(U.functionCall.name)){const W=yield je(d.get(U.functionCall.name).callTool([U.functionCall]));C.push(...W)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${d.keys()}, mising tool: ${U.functionCall.name}`)}}}}catch(P){x={error:P}}finally{try{!y&&!v&&(_=E.return)&&(yield je(_.call(E)))}finally{if(x)throw x.error}}if(C.length>0){o=!0;const P=new $s;P.candidates=[{content:{role:"user",parts:C}}],yield yield je(P);const U=[];U.push(...L),U.push({role:"user",parts:C});const W=Nn(m.contents).concat(U);m.contents=W}else break}})}(this,l,t)}async generateContentInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Qp(this.apiClient,t);return a=de("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=em(d),h=new $s;return Object.assign(h,m),h})}else{const u=Xp(this.apiClient,t);return a=de("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=Zp(d),h=new $s;return Object.assign(h,m),h})}}async generateContentStreamInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Qp(this.apiClient,t);return a=de("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(m){return ss(this,arguments,function*(){var h,g,v,x;try{for(var _=!0,T=xo(m),y;y=yield je(T.next()),h=y.done,!h;_=!0){x=y.value,_=!1;const E=x,A=em(yield je(E.json()));A.sdkHttpResponse={headers:E.headers};const b=new $s;Object.assign(b,A),yield yield je(b)}}catch(E){g={error:E}}finally{try{!_&&!h&&(v=T.return)&&(yield je(v.call(T)))}finally{if(g)throw g.error}}})})}else{const u=Xp(this.apiClient,t);return a=de("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(m){return ss(this,arguments,function*(){var h,g,v,x;try{for(var _=!0,T=xo(m),y;y=yield je(T.next()),h=y.done,!h;_=!0){x=y.value,_=!1;const E=x,A=Zp(yield je(E.json()));A.sdkHttpResponse={headers:E.headers};const b=new $s;Object.assign(b,A),yield yield je(b)}}catch(E){g={error:E}}finally{try{!_&&!h&&(v=T.return)&&(yield je(v.call(T)))}finally{if(g)throw g.error}}})})}}async embedContent(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=WR(this.apiClient,t);return a=de("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=$R(d),h=new Lp;return Object.assign(h,m),h})}else{const u=zR(this.apiClient,t);return a=de("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=qR(d),h=new Lp;return Object.assign(h,m),h})}}async generateImagesInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=r3(this.apiClient,t);return a=de("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=s3(d),h=new bp;return Object.assign(h,m),h})}else{const u=n3(this.apiClient,t);return a=de("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=i3(d),h=new bp;return Object.assign(h,m),h})}}async editImageInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=BR(this.apiClient,t);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const u=VR(l),d=new KI;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=rP(this.apiClient,t);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const u=iP(l),d=new YI;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=O3(this.apiClient,t);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=B3(l),d=new jI;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=q3(this.apiClient,t);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=$3(l),d=new XI;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=_3(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>lf(d))}else{const u=T3(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>af(d))}}async listInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=P3(this.apiClient,t);return a=de("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=M3(d),h=new Up;return Object.assign(h,m),h})}else{const u=R3(this.apiClient,t);return a=de("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=F3(d),h=new Up;return Object.assign(h,m),h})}}async update(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=tP(this.apiClient,t);return a=de("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>lf(d))}else{const u=eP(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>af(d))}}async delete(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=LR(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=UR(d),h=new Op;return Object.assign(h,m),h})}else{const u=DR(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=bR(d),h=new Op;return Object.assign(h,m),h})}}async countTokens(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=PR(this.apiClient,t);return a=de("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=MR(d),h=new Bp;return Object.assign(h,m),h})}else{const u=RR(this.apiClient,t);return a=de("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=FR(d),h=new Bp;return Object.assign(h,m),h})}}async computeTokens(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=SR(this.apiClient,t);return s=de("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const u=wR(l),d=new QI;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=f3(this.apiClient,t);return a=de("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const m=u3(d),h=new Dl;return Object.assign(h,m),h})}else{const u=c3(this.apiClient,t);return a=de("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>{const m=l3(d),h=new Dl;return Object.assign(h,m),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class UP extends Er{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=HI(t);return a=de("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o}else{const u=GI(t);return a=de("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o}}async fetchPredictVideosOperationInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=DI(t);return s=de("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function OP(e){const t={},n=c(e,["data"]);if(n!=null&&f(t,["data"],n),c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function BP(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>KP(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function VP(e,t,n){const r={},i=c(t,["expireTime"]);n!==void 0&&i!=null&&f(n,["expireTime"],i);const s=c(t,["newSessionExpireTime"]);n!==void 0&&s!=null&&f(n,["newSessionExpireTime"],s);const o=c(t,["uses"]);n!==void 0&&o!=null&&f(n,["uses"],o);const a=c(t,["liveConnectConstraints"]);n!==void 0&&a!=null&&f(n,["bidiGenerateContentSetup"],JP(e,a));const l=c(t,["lockAdditionalFields"]);return n!==void 0&&l!=null&&f(n,["fieldMask"],l),r}function GP(e,t){const n={},r=c(t,["config"]);return r!=null&&f(n,["config"],VP(e,r,n)),n}function HP(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function zP(e){const t={},n=c(e,["id"]);n!=null&&f(t,["id"],n);const r=c(e,["args"]);r!=null&&f(t,["args"],r);const i=c(e,["name"]);if(i!=null&&f(t,["name"],i),c(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function WP(e){const t={};if(c(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(e,["enableWidget"]);return n!=null&&f(t,["enableWidget"],n),t}function qP(e){const t={};if(c(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],n),t}function $P(e,t){const n={},r=c(e,["generationConfig"]);t!==void 0&&r!=null&&f(t,["setup","generationConfig"],r);const i=c(e,["responseModalities"]);t!==void 0&&i!=null&&f(t,["setup","generationConfig","responseModalities"],i);const s=c(e,["temperature"]);t!==void 0&&s!=null&&f(t,["setup","generationConfig","temperature"],s);const o=c(e,["topP"]);t!==void 0&&o!=null&&f(t,["setup","generationConfig","topP"],o);const a=c(e,["topK"]);t!==void 0&&a!=null&&f(t,["setup","generationConfig","topK"],a);const l=c(e,["maxOutputTokens"]);t!==void 0&&l!=null&&f(t,["setup","generationConfig","maxOutputTokens"],l);const u=c(e,["mediaResolution"]);t!==void 0&&u!=null&&f(t,["setup","generationConfig","mediaResolution"],u);const d=c(e,["seed"]);t!==void 0&&d!=null&&f(t,["setup","generationConfig","seed"],d);const m=c(e,["speechConfig"]);t!==void 0&&m!=null&&f(t,["setup","generationConfig","speechConfig"],Fd(m));const h=c(e,["thinkingConfig"]);t!==void 0&&h!=null&&f(t,["setup","generationConfig","thinkingConfig"],h);const g=c(e,["enableAffectiveDialog"]);t!==void 0&&g!=null&&f(t,["setup","generationConfig","enableAffectiveDialog"],g);const v=c(e,["systemInstruction"]);t!==void 0&&v!=null&&f(t,["setup","systemInstruction"],BP(Ot(v)));const x=c(e,["tools"]);if(t!==void 0&&x!=null){let D=Ss(x);Array.isArray(D)&&(D=D.map(C=>jP(_s(C)))),f(t,["setup","tools"],D)}const _=c(e,["sessionResumption"]);t!==void 0&&_!=null&&f(t,["setup","sessionResumption"],YP(_));const T=c(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&f(t,["setup","inputAudioTranscription"],T);const y=c(e,["outputAudioTranscription"]);t!==void 0&&y!=null&&f(t,["setup","outputAudioTranscription"],y);const E=c(e,["realtimeInputConfig"]);t!==void 0&&E!=null&&f(t,["setup","realtimeInputConfig"],E);const A=c(e,["contextWindowCompression"]);t!==void 0&&A!=null&&f(t,["setup","contextWindowCompression"],A);const b=c(e,["proactivity"]);return t!==void 0&&b!=null&&f(t,["setup","proactivity"],b),n}function JP(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["setup","model"],Oe(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],$P(i,n)),n}function KP(e){const t={},n=c(e,["mediaResolution"]);n!=null&&f(t,["mediaResolution"],n);const r=c(e,["codeExecutionResult"]);r!=null&&f(t,["codeExecutionResult"],r);const i=c(e,["executableCode"]);i!=null&&f(t,["executableCode"],i);const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],HP(s));const o=c(e,["functionCall"]);o!=null&&f(t,["functionCall"],zP(o));const a=c(e,["functionResponse"]);a!=null&&f(t,["functionResponse"],a);const l=c(e,["inlineData"]);l!=null&&f(t,["inlineData"],OP(l));const u=c(e,["text"]);u!=null&&f(t,["text"],u);const d=c(e,["thought"]);d!=null&&f(t,["thought"],d);const m=c(e,["thoughtSignature"]);m!=null&&f(t,["thoughtSignature"],m);const h=c(e,["videoMetadata"]);return h!=null&&f(t,["videoMetadata"],h),t}function YP(e){const t={},n=c(e,["handle"]);if(n!=null&&f(t,["handle"],n),c(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function jP(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(m=>m)),f(t,["functionDeclarations"],d)}if(c(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(e,["googleSearchRetrieval"]);r!=null&&f(t,["googleSearchRetrieval"],r);const i=c(e,["computerUse"]);i!=null&&f(t,["computerUse"],i);const s=c(e,["fileSearch"]);s!=null&&f(t,["fileSearch"],s);const o=c(e,["codeExecution"]);if(o!=null&&f(t,["codeExecution"],o),c(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(e,["googleMaps"]);a!=null&&f(t,["googleMaps"],WP(a));const l=c(e,["googleSearch"]);l!=null&&f(t,["googleSearch"],qP(l));const u=c(e,["urlContext"]);return u!=null&&f(t,["urlContext"],u),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XP(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);t.push(...i)}else t.push(n)}return t.join(",")}function QP(e,t){let n=null;const r=e.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(e.bidiGenerateContentSetup=s,n=s):delete e.bidiGenerateContentSetup}else r!==void 0&&delete e.bidiGenerateContentSetup;const i=e.fieldMask;if(n){const s=XP(n);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)s?e.fieldMask=s:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?e.fieldMask=l.join(","):delete e.fieldMask}else delete e.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}class ZP extends Er{constructor(t){super(),this.apiClient=t}async create(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=GP(this.apiClient,t);s=de("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=QP(a,t.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eF(e,t){const n={},r=c(e,["displayName"]);return t!==void 0&&r!=null&&f(t,["displayName"],r),n}function tF(e){const t={},n=c(e,["config"]);return n!=null&&eF(n,t),t}function nF(e,t){const n={},r=c(e,["force"]);return t!==void 0&&r!=null&&f(t,["_query","force"],r),n}function rF(e){const t={},n=c(e,["name"]);n!=null&&f(t,["_url","name"],n);const r=c(e,["config"]);return r!=null&&nF(r,t),t}function iF(e){const t={},n=c(e,["name"]);return n!=null&&f(t,["_url","name"],n),t}function sF(e,t){const n={},r=c(e,["customMetadata"]);if(t!==void 0&&r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),f(t,["customMetadata"],s)}const i=c(e,["chunkingConfig"]);return t!==void 0&&i!=null&&f(t,["chunkingConfig"],i),n}function oF(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["metadata"]);r!=null&&f(t,["metadata"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);s!=null&&f(t,["error"],s);const o=c(e,["response"]);return o!=null&&f(t,["response"],lF(o)),t}function aF(e){const t={},n=c(e,["fileSearchStoreName"]);n!=null&&f(t,["_url","file_search_store_name"],n);const r=c(e,["fileName"]);r!=null&&f(t,["fileName"],r);const i=c(e,["config"]);return i!=null&&sF(i,t),t}function lF(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["parent"]);r!=null&&f(t,["parent"],r);const i=c(e,["documentName"]);return i!=null&&f(t,["documentName"],i),t}function uF(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);return t!==void 0&&i!=null&&f(t,["_query","pageToken"],i),n}function cF(e){const t={},n=c(e,["config"]);return n!=null&&uF(n,t),t}function fF(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["fileSearchStores"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(t,["fileSearchStores"],s)}return t}function dF(e,t){const n={},r=c(e,["mimeType"]);t!==void 0&&r!=null&&f(t,["mimeType"],r);const i=c(e,["displayName"]);t!==void 0&&i!=null&&f(t,["displayName"],i);const s=c(e,["customMetadata"]);if(t!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),f(t,["customMetadata"],a)}const o=c(e,["chunkingConfig"]);return t!==void 0&&o!=null&&f(t,["chunkingConfig"],o),n}function hF(e){const t={},n=c(e,["fileSearchStoreName"]);n!=null&&f(t,["_url","file_search_store_name"],n);const r=c(e,["config"]);return r!=null&&dF(r,t),t}function pF(e){const t={},n=c(e,["sdkHttpResponse"]);return n!=null&&f(t,["sdkHttpResponse"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mF(e,t){const n={},r=c(e,["force"]);return t!==void 0&&r!=null&&f(t,["_query","force"],r),n}function gF(e){const t={},n=c(e,["name"]);n!=null&&f(t,["_url","name"],n);const r=c(e,["config"]);return r!=null&&mF(r,t),t}function xF(e){const t={},n=c(e,["name"]);return n!=null&&f(t,["_url","name"],n),t}function vF(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);return t!==void 0&&i!=null&&f(t,["_query","pageToken"],i),n}function yF(e){const t={},n=c(e,["parent"]);n!=null&&f(t,["_url","parent"],n);const r=c(e,["config"]);return r!=null&&vF(r,t),t}function EF(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["documents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(t,["documents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class TF extends Er{constructor(t){super(),this.apiClient=t,this.list=async n=>new Si(xr.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=xF(t);return s=de("{name}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(t){var n,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=gF(t);i=de("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=yF(t);return s=de("{parent}/documents",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=EF(l),d=new ZI;return Object.assign(d,u),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _F extends Er{constructor(t,n=new TF(t)){super(),this.apiClient=t,this.documents=n,this.list=async(r={})=>new Si(xr.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(r),r)}async uploadToFileSearchStore(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(t.fileSearchStoreName,t.file,t.config)}async create(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=tF(t);return s=de("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async get(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=iF(t);return s=de("{name}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(t){var n,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=rF(t);i=de("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=cF(t);return s=de("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=fF(l),d=new e4;return Object.assign(d,u),d})}}async uploadToFileSearchStoreInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=hF(t);return s=de("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=pF(l),d=new t4;return Object.assign(d,u),d})}}async importFile(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=aF(t);return s=de("{file_search_store_name}:importFile",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=oF(l),d=new Nd;return Object.assign(d,u),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SF(e,t){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],r),n}function wF(e,t){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],r),n}function CF(e,t,n){const r={};if(c(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=c(e,["tunedModelDisplayName"]);if(t!==void 0&&i!=null&&f(t,["displayName"],i),c(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=c(e,["epochCount"]);t!==void 0&&s!=null&&f(t,["tuningTask","hyperparameters","epochCount"],s);const o=c(e,["learningRateMultiplier"]);if(o!=null&&f(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),c(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(c(e,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(c(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=c(e,["batchSize"]);t!==void 0&&a!=null&&f(t,["tuningTask","hyperparameters","batchSize"],a);const l=c(e,["learningRate"]);if(t!==void 0&&l!=null&&f(t,["tuningTask","hyperparameters","learningRate"],l),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(c(e,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function AF(e,t,n){const r={};let i=c(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const g=c(e,["validationDataset"]);t!==void 0&&g!=null&&f(t,["supervisedTuningSpec"],am(g))}else if(i==="PREFERENCE_TUNING"){const g=c(e,["validationDataset"]);t!==void 0&&g!=null&&f(t,["preferenceOptimizationSpec"],am(g))}const s=c(e,["tunedModelDisplayName"]);t!==void 0&&s!=null&&f(t,["tunedModelDisplayName"],s);const o=c(e,["description"]);t!==void 0&&o!=null&&f(t,["description"],o);let a=c(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const g=c(e,["epochCount"]);t!==void 0&&g!=null&&f(t,["supervisedTuningSpec","hyperParameters","epochCount"],g)}else if(a==="PREFERENCE_TUNING"){const g=c(e,["epochCount"]);t!==void 0&&g!=null&&f(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],g)}let l=c(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const g=c(e,["learningRateMultiplier"]);t!==void 0&&g!=null&&f(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],g)}else if(l==="PREFERENCE_TUNING"){const g=c(e,["learningRateMultiplier"]);t!==void 0&&g!=null&&f(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],g)}let u=c(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const g=c(e,["exportLastCheckpointOnly"]);t!==void 0&&g!=null&&f(t,["supervisedTuningSpec","exportLastCheckpointOnly"],g)}else if(u==="PREFERENCE_TUNING"){const g=c(e,["exportLastCheckpointOnly"]);t!==void 0&&g!=null&&f(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],g)}let d=c(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const g=c(e,["adapterSize"]);t!==void 0&&g!=null&&f(t,["supervisedTuningSpec","hyperParameters","adapterSize"],g)}else if(d==="PREFERENCE_TUNING"){const g=c(e,["adapterSize"]);t!==void 0&&g!=null&&f(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],g)}if(c(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(c(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const m=c(e,["labels"]);t!==void 0&&m!=null&&f(t,["labels"],m);const h=c(e,["beta"]);return t!==void 0&&h!=null&&f(t,["preferenceOptimizationSpec","hyperParameters","beta"],h),r}function NF(e,t){const n={},r=c(e,["baseModel"]);r!=null&&f(n,["baseModel"],r);const i=c(e,["preTunedModel"]);i!=null&&f(n,["preTunedModel"],i);const s=c(e,["trainingDataset"]);s!=null&&OF(s);const o=c(e,["config"]);return o!=null&&CF(o,n),n}function IF(e,t){const n={},r=c(e,["baseModel"]);r!=null&&f(n,["baseModel"],r);const i=c(e,["preTunedModel"]);i!=null&&f(n,["preTunedModel"],i);const s=c(e,["trainingDataset"]);s!=null&&BF(s,n,t);const o=c(e,["config"]);return o!=null&&AF(o,n,t),n}function kF(e,t){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],r),n}function RF(e,t){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],r),n}function PF(e,t,n){const r={},i=c(e,["pageSize"]);t!==void 0&&i!=null&&f(t,["_query","pageSize"],i);const s=c(e,["pageToken"]);t!==void 0&&s!=null&&f(t,["_query","pageToken"],s);const o=c(e,["filter"]);return t!==void 0&&o!=null&&f(t,["_query","filter"],o),r}function FF(e,t,n){const r={},i=c(e,["pageSize"]);t!==void 0&&i!=null&&f(t,["_query","pageSize"],i);const s=c(e,["pageToken"]);t!==void 0&&s!=null&&f(t,["_query","pageToken"],s);const o=c(e,["filter"]);return t!==void 0&&o!=null&&f(t,["_query","filter"],o),r}function MF(e,t){const n={},r=c(e,["config"]);return r!=null&&PF(r,n),n}function DF(e,t){const n={},r=c(e,["config"]);return r!=null&&FF(r,n),n}function LF(e,t){const n={},r=c(e,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=c(e,["nextPageToken"]);i!=null&&f(n,["nextPageToken"],i);const s=c(e,["tunedModels"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Pv(a))),f(n,["tuningJobs"],o)}return n}function bF(e,t){const n={},r=c(e,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=c(e,["nextPageToken"]);i!=null&&f(n,["nextPageToken"],i);const s=c(e,["tuningJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>cf(a))),f(n,["tuningJobs"],o)}return n}function UF(e,t){const n={},r=c(e,["name"]);r!=null&&f(n,["model"],r);const i=c(e,["name"]);return i!=null&&f(n,["endpoint"],i),n}function OF(e,t){const n={};if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=c(e,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),f(n,["examples","examples"],i)}return n}function BF(e,t,n){const r={};let i=c(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const o=c(e,["gcsUri"]);t!==void 0&&o!=null&&f(t,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(i==="PREFERENCE_TUNING"){const o=c(e,["gcsUri"]);t!==void 0&&o!=null&&f(t,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let s=c(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=c(e,["vertexDatasetResource"]);t!==void 0&&o!=null&&f(t,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=c(e,["vertexDatasetResource"]);t!==void 0&&o!=null&&f(t,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(c(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function Pv(e,t){const n={},r=c(e,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=c(e,["name"]);i!=null&&f(n,["name"],i);const s=c(e,["state"]);s!=null&&f(n,["state"],dv(s));const o=c(e,["createTime"]);o!=null&&f(n,["createTime"],o);const a=c(e,["tuningTask","startTime"]);a!=null&&f(n,["startTime"],a);const l=c(e,["tuningTask","completeTime"]);l!=null&&f(n,["endTime"],l);const u=c(e,["updateTime"]);u!=null&&f(n,["updateTime"],u);const d=c(e,["description"]);d!=null&&f(n,["description"],d);const m=c(e,["baseModel"]);m!=null&&f(n,["baseModel"],m);const h=c(e,["_self"]);return h!=null&&f(n,["tunedModel"],UF(h)),n}function cf(e,t){const n={},r=c(e,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=c(e,["name"]);i!=null&&f(n,["name"],i);const s=c(e,["state"]);s!=null&&f(n,["state"],dv(s));const o=c(e,["createTime"]);o!=null&&f(n,["createTime"],o);const a=c(e,["startTime"]);a!=null&&f(n,["startTime"],a);const l=c(e,["endTime"]);l!=null&&f(n,["endTime"],l);const u=c(e,["updateTime"]);u!=null&&f(n,["updateTime"],u);const d=c(e,["error"]);d!=null&&f(n,["error"],d);const m=c(e,["description"]);m!=null&&f(n,["description"],m);const h=c(e,["baseModel"]);h!=null&&f(n,["baseModel"],h);const g=c(e,["tunedModel"]);g!=null&&f(n,["tunedModel"],g);const v=c(e,["preTunedModel"]);v!=null&&f(n,["preTunedModel"],v);const x=c(e,["supervisedTuningSpec"]);x!=null&&f(n,["supervisedTuningSpec"],x);const _=c(e,["preferenceOptimizationSpec"]);_!=null&&f(n,["preferenceOptimizationSpec"],_);const T=c(e,["tuningDataStats"]);T!=null&&f(n,["tuningDataStats"],T);const y=c(e,["encryptionSpec"]);y!=null&&f(n,["encryptionSpec"],y);const E=c(e,["partnerModelTuningSpec"]);E!=null&&f(n,["partnerModelTuningSpec"],E);const A=c(e,["customBaseModel"]);A!=null&&f(n,["customBaseModel"],A);const b=c(e,["experiment"]);b!=null&&f(n,["experiment"],b);const D=c(e,["labels"]);D!=null&&f(n,["labels"],D);const C=c(e,["outputUri"]);C!=null&&f(n,["outputUri"],C);const L=c(e,["pipelineJob"]);L!=null&&f(n,["pipelineJob"],L);const P=c(e,["serviceAccount"]);P!=null&&f(n,["serviceAccount"],P);const U=c(e,["tunedModelDisplayName"]);U!=null&&f(n,["tunedModelDisplayName"],U);const W=c(e,["veoTuningSpec"]);return W!=null&&f(n,["veoTuningSpec"],W),n}function VF(e,t){const n={},r=c(e,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=c(e,["name"]);i!=null&&f(n,["name"],i);const s=c(e,["metadata"]);s!=null&&f(n,["metadata"],s);const o=c(e,["done"]);o!=null&&f(n,["done"],o);const a=c(e,["error"]);return a!=null&&f(n,["error"],a),n}function am(e,t){const n={},r=c(e,["gcsUri"]);r!=null&&f(n,["validationDatasetUri"],r);const i=c(e,["vertexDatasetResource"]);return i!=null&&f(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GF extends Er{constructor(t){super(),this.apiClient=t,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Si(xr.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:nf.JOB_STATE_QUEUED}}}}async getInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=RF(t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>cf(d))}else{const u=kF(t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>Pv(d))}}async listInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=DF(t);return a=de("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=bF(d),h=new Vp;return Object.assign(h,m),h})}else{const u=MF(t);return a=de("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:d.headers},h})),o.then(d=>{const m=LF(d),h=new Vp;return Object.assign(h,m),h})}}async cancel(t){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=wF(t);o=de("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=SF(t);o=de("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=IF(t,t);return s=de("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>cf(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=NF(t);return s=de("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>VF(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class HF{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const zF=1024*1024*8,WF=3,qF=1e3,$F=2,bl="x-goog-upload-status";async function JF(e,t,n){var r;const i=await Fv(e,t,n),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[bl])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function KF(e,t,n){var r;const i=await Fv(e,t,n),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[bl])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const o=ov(s),a=new Id;return Object.assign(a,o),a}async function Fv(e,t,n){var r,i;let s=0,o=0,a=new rf(new Response),l="upload";for(s=e.size;o<s;){const u=Math.min(zF,s-o),d=e.slice(o,o+u);o+u>=s&&(l+=", finalize");let m=0,h=qF;for(;m<WF&&(a=await n.request({path:"",body:d,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(o),"Content-Length":String(u)}}}),!(!((r=a==null?void 0:a.headers)===null||r===void 0)&&r[bl]));)m++,await jF(h),h=h*$F;if(o+=u,((i=a==null?void 0:a.headers)===null||i===void 0?void 0:i[bl])!=="active")break;if(s<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function YF(e){return{size:e.size,type:e.type}}function jF(e){return new Promise(t=>setTimeout(t,e))}class XF{async upload(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await JF(t,n,r)}async uploadToFileSearchStore(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await KF(t,n,r)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await YF(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class QF{create(t,n,r){return new ZF(t,n,r)}}class ZF{constructor(t,n,r){this.url=t,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lm="x-goog-api-key";class eM{constructor(t){this.apiKey=t}async addAuthHeaders(t,n){if(t.get(lm)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(lm,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tM="gl-node/";class Mv{constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const r=FI(t.httpOptions,t.vertexai,void 0,void 0);r&&(t.httpOptions?t.httpOptions.baseUrl=r:t.httpOptions={baseUrl:r}),this.apiVersion=t.apiVersion;const i=new eM(this.apiKey);this.apiClient=new xP({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:tM+"web",uploader:new XF,downloader:new HF}),this.models=new bP(this.apiClient),this.live=new RP(this.apiClient,i,new QF),this.batches=new ak(this.apiClient),this.chats=new Hk(this.models,this.apiClient),this.caches=new Bk(this.apiClient),this.files=new Qk(this.apiClient),this.operations=new UP(this.apiClient),this.authTokens=new ZP(this.apiClient),this.tunings=new GF(this.apiClient),this.fileSearchStores=new _F(this.apiClient)}}const Js=()=>Math.random().toString(36).substr(2,9),nM=e=>{try{return JSON.parse(e)}catch(t){console.warn("JSON truncated. Attempting repair...");let n=e.trim().replace(/,$/,"");(n.match(/"/g)||[]).length%2!==0&&(n+='"');const i=[];for(const s of n)s==="{"?i.push("}"):s==="["?i.push("]"):(s==="}"||s==="]")&&i[i.length-1]===s&&i.pop();n+=i.reverse().join("");try{return JSON.parse(n)}catch(s){throw console.error("Repair failed",s),t}}},Dv={type:ke.OBJECT,properties:{name:{type:ke.STRING,description:"Name of the feature (e.g., 'Wing Color')"},imageUrl:{type:ke.STRING,description:"URL for feature illustration"},states:{type:ke.ARRAY,items:{type:ke.STRING,description:"A state description (e.g., 'Blue')"}}},required:["name","states"]},Lv={type:ke.OBJECT,properties:{label:{type:ke.STRING,description:"Title of the link (e.g., 'Wikipedia', 'GBIF')"},url:{type:ke.STRING,description:"Full URL"}},required:["label","url"]},bv={type:ke.OBJECT,properties:{projectName:{type:ke.STRING},projectDescription:{type:ke.STRING},features:{type:ke.ARRAY,items:Dv},entities:{type:ke.ARRAY,items:{type:ke.OBJECT,properties:{name:{type:ke.STRING},description:{type:ke.STRING},imageUrl:{type:ke.STRING,description:"URL for species image."},links:{type:ke.ARRAY,items:Lv,description:"External resources"},traits:{type:ke.ARRAY,items:{type:ke.OBJECT,properties:{featureName:{type:ke.STRING,description:"Must match one of the feature names exactly"},stateValue:{type:ke.STRING,description:"Must match one of the state values for that feature exactly"}},required:["featureName","stateValue"]}}},required:["name","description","traits"]}}},required:["projectName","projectDescription","features","entities"]},rM={type:ke.OBJECT,properties:{projectName:{type:ke.STRING},projectDescription:{type:ke.STRING},features:{type:ke.ARRAY,items:Dv},entities:{type:ke.ARRAY,items:{type:ke.OBJECT,properties:{name:{type:ke.STRING},description:{type:ke.STRING},imageUrl:{type:ke.STRING,description:"URL if found, else empty."},links:{type:ke.ARRAY,items:Lv,description:"External resources"},traits:{type:ke.ARRAY,items:{type:ke.OBJECT,properties:{featureName:{type:ke.STRING,description:"Must match one of the feature names exactly"},stateValue:{type:ke.STRING,description:"Must match one of the state values for that feature exactly"}},required:["featureName","stateValue"]}}},required:["name","description","traits"]}}},required:["projectName","projectDescription","features","entities"]},Uv=e=>{const t=e.language==="pt"?"All content (Project Name, Description, Features, States, Entities, Descriptions) MUST be in Portuguese (Brazil).":"All content must be in English.";let n=e.includeSpeciesImages?"For each entity, provide a valid, DIRECT public URL to an image file (must end in .jpg, .jpeg, or .png) representing the species. The URL must point directly to the image binary, not a landing page.":"Leave `imageUrl` empty for entities.",r=e.includeFeatureImages?"For each feature, provide a valid, DIRECT public URL to an image file (must end in .jpg, .jpeg, or .png) illustrating the trait. The URL must point directly to the image binary, not a landing page.":"Leave `imageUrl` empty for features.",i=e.includeLinks?"For each entity, provide 1-2 reputable external links (e.g., Wikipedia, IUCN, GBIF, Flora e Funga do Brasil) in the 'links' array.":"Leave the 'links' array empty.";if(e.importedFile){let u="Extract ALL distinctive features found in the text.";e.featureFocus==="vegetative"?u="STRICTLY EXTRACT ONLY VEGETATIVE features (leaves, bark, stem, roots, growth habit). IGNORE reproductive features (flowers, fruits, seeds).":e.featureFocus==="reproductive"&&(u="STRICTLY EXTRACT ONLY REPRODUCTIVE features (flowers, fruits, seeds, inflorescence). IGNORE vegetative features.");let d="Maintain the descriptions as close to the original text as possible (Balanced).";e.detailLevel===1?d="SIMPLIFY the descriptions. Use shorter, easier sentences. Remove excessive jargon.":e.detailLevel===3&&(d="MAXIMIZE DETAIL. Keep all scientific terms, measurements, and nuances found in the text.");const m=`
      You are an expert biologist and data analyst.
      Your task is to analyze the provided document (PDF, Text, or Image) and extract a structured Matrix Identification Key.
      
      **Goal**: Extract entities and features to build a matrix.
      
      **CRITICAL INSTRUCTIONS**: 
      1. You must extract **EVERY SINGLE** species/entity found in the text. DO NOT truncate the list.
      2. **FILTER**: ${u}
      3. **DETAIL**: ${d}
      4. **MEDIA**: 
         - Species Images: ${n}
         - Feature Images: ${r}
         - External Links: ${i}
      5. ${t}
      
      **Format**: Return valid JSON.
      **IMPORTANT**: Do not include markdown code fences (\`\`\`json ... \`\`\`). Return raw JSON only. Ensure all keys and string values are properly escaped.
    `,h=`
      Analyze the attached file. Extract a comprehensive biological identification key.
      
      - Project Name: Derive from document title.
      - Description: Summary of content.
      - Entities: Extract ALL entities found.
      - Features: Extract distinctive traits based on the focus setting.
      - Matrix: Map traits to entities.
      
      If analyzing a Dichotomous Key, flatten the logic: assign all traits accumulated along the path to the species.
    `,g=[{inlineData:{mimeType:e.importedFile.mimeType,data:e.importedFile.data}},{text:h}];return{systemInstruction:m,prompt:h,parts:g,schema:rM}}let s="";e.featureFocus==="reproductive"?s="Focus primarily on reproductive features (e.g., flowers, fruits, seeds, cones, spores, inflorescence).":e.featureFocus==="vegetative"?s="Focus primarily on vegetative features (e.g., leaves, bark, stem, roots, growth habit, phyllo taxis).":s="Use a balanced mix of vegetative and reproductive features.";let o="";e.detailLevel===1?o="AUDIENCE: Children or General Public. Use simple, common language. Short descriptions. Avoid complex jargon.":e.detailLevel===3?o="AUDIENCE: Experts/Scientists. Use precise botanical/zoological terminology. Comprehensive descriptions. High detail.":o="AUDIENCE: Students/Enthusiasts. Balanced use of scientific terms with clear explanations.";const a=`
    You are an expert taxonomist and biologist. 
    Your task is to create an interactive identification key (matrix key) based strictly on the user's constraints.
    
    Constraints:
    1.  **Language**: ${t}
    2.  **Topic**: The general subject.
    3.  **Geography**: Restrict entities to this region/biome.
    4.  **Taxonomy**: Restrict to this Family/Genus/Order if specified.
    5.  **Quantity**: Generate exactly or close to the requested number of entities and features.
    6.  **Focus**: ${s}
    7.  **Detail Level**: ${o}
    8.  **Media**: 
        - Species Images: ${n}
        - Feature Images: ${r}
        - External Links: ${i}

    Output Requirements:
    1.  List of distinctive features. Each feature must have 2+ states.
    2.  List of entities.
    3.  Matrix: Assign correct states.
    4.  **Scientific Accuracy**: Ensure traits are factual.

    The response must be a structured JSON object.
    **IMPORTANT**: Do not include markdown code fences (\`\`\`json ... \`\`\`). Return raw JSON only. Ensure all keys and string values are properly escaped.
  `,l=`
    Create an identification key for: "${e.topic}".
    
    Constraints:
    - Language: ${e.language==="pt"?"Portuguese":"English"}
    - Geographic Scope: ${e.geography||"Global"}
    - Taxonomic Context: ${e.taxonomy||"General"}
    - Target Number of Entities: ${e.count}
    - Target Number of Features: ${e.featureCount}
    - Feature Focus: ${e.featureFocus}
    - Complexity Level: ${e.detailLevel}/3

    Ensure the features allow for effective separation of these entities.
  `;return{systemInstruction:a,prompt:l,schema:bv,parts:void 0}},iM=async(e,t,n)=>{if(!t)throw new Error("API Key is missing");const r=new Mv({apiKey:t}),{systemInstruction:i,prompt:s,parts:o,schema:a}=Uv(e);n&&n(`SYSTEM:
${i}

USER PROMPT:
${s}`);const l=o||s;return await Ov(r,e.model,l,i,a)},Zu=async(e,t,n="gemini-2.5-flash")=>{if(!t)throw new Error("API Key is missing");const r=new Mv({apiKey:t});return await Ov(r,n,e,"You are an expert biologist. Return ONLY valid JSON matching the schema. Do not include markdown code fences.",bv)};async function Ov(e,t,n,r,i){const s=async o=>{var a,l;try{return await e.models.generateContent({model:o.trim(),contents:n,config:{systemInstruction:r,responseMimeType:"application/json",responseSchema:i,maxOutputTokens:65536}})}catch(u){if((a=u.message)!=null&&a.includes("404")||(l=u.message)!=null&&l.includes("NOT_FOUND")){const d="gemini-2.5-flash";if(o!==d)return console.warn(`Model ${o} not found, falling back to ${d}`),await s(d)}throw u}};try{const a=await s(t||"gemini-2.5-flash"),l=nM(a.text||"{}");if(!l.projectName)throw new Error("Invalid AI response");const u=l.features.map(m=>({id:Js(),name:m.name,imageUrl:m.imageUrl||"",states:m.states.map(h=>({id:Js(),label:h}))})),d=l.entities.map(m=>{const h={};m.traits.forEach(_=>{let T="",y="";if(typeof _=="string"){const E=_.indexOf(":");E>-1&&(T=_.substring(0,E).trim(),y=_.substring(E+1).trim())}else typeof _=="object"&&_!==null&&(T=_.featureName,y=_.stateValue);if(T&&y){const E=u.find(A=>A.name.toLowerCase()===T.toLowerCase());if(E){const A=E.states.find(b=>b.label.toLowerCase()===y.toLowerCase());A&&(h[E.id]||(h[E.id]=[]),h[E.id].push(A.id))}}});const g=m.imageUrl?m.imageUrl.trim():"",v=g.startsWith("http"),x=Array.isArray(m.links)?m.links:[];return{id:Js(),name:m.name,description:m.description,imageUrl:v?g:`https://picsum.photos/seed/${encodeURIComponent(m.name)}/400/300`,links:x.map(_=>({id:Js(),label:_.label||"Link",url:_.url||"#"})),traits:h}});return{id:Js(),name:l.projectName,description:l.projectDescription,features:u,entities:d}}catch(o){throw console.error("Gemini Generation Error:",o),o}}const sM={en:{builder:"Builder",aiWizard:"Nuts AI",savePlay:"Save & Play",exit:"Exit",save:"Save",open:"Open",export:"Export Project",exportXLSX:"Export XLSX",import:"Import Project",general:"General",features:"Features",entities:"Entities",matrix:"Matrix Scoring",projectName:"Project Name",description:"Description",definedFeatures:"Defined Features",definedFeaturesDesc:"Define traits and their possible states.",addFeature:"Add Feature",featureName:"Feature Name",imageURL:"Image URL (optional)",states:"States",addState:"Add State",manageEntities:"Entities",manageEntitiesDesc:"Manage the taxa included in your key.",addEntity:"Add Entity",scoringMatrix:"Scoring Matrix",scoringMatrixDesc:"Click cells to toggle state association",taxaFeatures:"Taxa / Features",aiTitle:"Nuts AI Wizard",aiDesc:"Generate or Extract keys using Gemini AI.",topic:"Key Topic / Subject",topicPlace:"e.g. Freshwater Fishes, Garden Weeds",geography:"Geography / Biome",taxonomy:"Taxonomy Filter",numEntities:"Approx. # of Entities",numFeatures:"Approx. # of Features",generating:"Nozes IA is thinking... (15-45s)",cancel:"Cancel",generate:"Generate Key",savedMsg:"Project saved to browser storage!",errGen:"Failed to generate key. Check console.",featureFocus:"Feature Focus",focusGeneral:"General (All)",focusRepro:"Reproductive Only",focusVeg:"Vegetative Only",options:"Options",fetchSpeciesImg:"Fetch Species Images",fetchFeatureImg:"Fetch Feature Images",fetchLinks:"Fetch External Links",detailLevel:"Detail Level",detailSimple:"Simplified",detailBalanced:"Balanced",detailExpert:"Expert / High",detailOriginal:"Original Fidelity",noSaved:"No saved projects.",close:"Close",modeTopic:"Generate from Topic",modeImport:"Import from File",uploadLabel:"Upload PDF, Image, or Text",uploadDesc:"The AI will study the document and extract entities and features automatically.",supportedFormats:"Supports: .pdf, .txt, .jpg, .png",dropFile:"Drop file here",removeFile:"Remove file",analyzing:"Analyzing document...",promptCopied:"Prompt copied to clipboard!",configSettings:"Configuration",links:"Additional Links / Resources",addLink:"Add Link",editTraits:"Edit Characteristics",traitEditor:"Trait Editor",copyPrompt:"Copy",missingKey:"Missing API Key. Please configure it in the main menu Settings.",modeRefine:"Expand/Refine",refineTitle:"Enhance Current Key",refineDesc:"Use AI to expand or refine your existing identification key.",actionExpand:"Expand Entities",actionExpandDesc:"Add new species/entities similar to existing ones",actionRefine:"Refine Features",actionRefineDesc:"Improve feature descriptions and add discriminating traits",actionClean:"Clean & Optimize",actionCleanDesc:"Remove redundant features, fix inconsistencies",expandCount:"# New Entities to Add",keepExisting:"Preserve existing entities",addFeatures:"Add new discriminating features",improveDescriptions:"Improve descriptions",fillGaps:"Fill missing trait data",removeRedundant:"Remove redundant features",fixInconsistencies:"Fix inconsistencies",currentProject:"Current Project",noProjectLoaded:"No project loaded. Create or load a project first.",entitiesCount:"entities",featuresCount:"features",completePhotos:"Complete Photo Collection",completePhotosDesc:"Fill missing images with valid URLs",photoTargetEntities:"Entity Images",photoTargetFeatures:"Feature Images",photoTargetBoth:"Both",actionPhotos:"Complete Photos",actionPhotosDesc:"Fill all missing images with real URLs",photosActionDesc:"Select which images to complete with valid URLs",modeMerge:"Merge Keys",mergeTitle:"Combine Two Keys",mergeDesc:"Import two JSON keys and merge them into one optimized key.",mergeKey1:"First Key (JSON)",mergeKey2:"Second Key (JSON)",uploadKey1:"Upload Key 1 (JSON)",uploadKey2:"Upload Key 2 (JSON)",mergeStrategy:"Merge Strategy",strategyUnion:"Union (All-inclusive)",strategyUnionDesc:"Include all features and entities from both keys",strategyIntersection:"Intersection (Common)",strategyIntersectionDesc:"Focus on shared characteristics between keys",strategyPrimary:"Primary (Key 1 base)",strategyPrimaryDesc:"Use Key 1 as base, add unique elements from Key 2",remove:"Remove",mergeAction:"Merge Keys",mergeLoaded:"loaded"},pt:{builder:"Construtor",aiWizard:"Nozes IA",savePlay:"Salvar & Testar",exit:"Sair",save:"Salvar",open:"Abrir",export:"Exportar Projeto",exportXLSX:"Exportar XLSX",import:"Importar Projeto",general:"Geral",features:"Caractersticas",entities:"Entidades",matrix:"Matriz",projectName:"Nome do Projeto",description:"Descrio",definedFeatures:"Caractersticas Definidas",definedFeaturesDesc:"Defina caractersticas e seus estados possveis.",addFeature:"Adicionar Caracterstica",featureName:"Nome",imageURL:"URL da Imagem (opcional)",states:"Estados",addState:"Adicionar Estado",manageEntities:"Entidades",manageEntitiesDesc:"Gerencie os txons includos na chave.",addEntity:"Adicionar Entidade",scoringMatrix:"Matriz de Pontuao",scoringMatrixDesc:"Clique nas clulas para associar estados",taxaFeatures:"Txons / Caractersticas",aiTitle:"Assistente Nozes IA",aiDesc:"Gere ou Extraia chaves usando Gemini IA.",topic:"Tpico / Assunto",topicPlace:"ex: Peixes de gua Doce, Ervas Daninhas",geography:"Geografia / Bioma",taxonomy:"Filtro Taxonmico",numEntities:"Aprox. # de Entidades",numFeatures:"Aprox. # de Caractersticas",generating:"Nozes IA est pensando... (15-45s)",cancel:"Cancelar",generate:"Gerar Chave",savedMsg:"Projeto salvo no navegador!",errGen:"Falha ao gerar chave. Verifique o console.",featureFocus:"Foco das Caractersticas",focusGeneral:"Geral (Todas)",focusRepro:"Apenas Reprodutivas",focusVeg:"Apenas Vegetativas",options:"Opes",fetchSpeciesImg:"Buscar Imagens de Espcies",fetchFeatureImg:"Buscar Imagens de Caractersticas",fetchLinks:"Buscar Links/Materiais",detailLevel:"Nvel de Detalhe",detailSimple:"Simplificado",detailBalanced:"Equilibrado",detailExpert:"Especialista / Alto",detailOriginal:"Fidelidade Original",noSaved:"Nenhum projeto salvo.",close:"Fechar",modeTopic:"Gerar por Tpico",modeImport:"Importar Arquivo",uploadLabel:"Upload PDF, Imagem ou Texto",uploadDesc:"A IA estudar o documento e extrair entidades e caractersticas automaticamente.",supportedFormats:"Suporta: .pdf, .txt, .jpg, .png",dropFile:"Solte o arquivo aqui",removeFile:"Remover arquivo",analyzing:"Analisando documento...",promptCopied:"Prompt copiado para a rea de transferncia!",configSettings:"Configurao",links:"Links Adicionais / Materiais",addLink:"Adicionar Link",editTraits:"Editar Caractersticas",traitEditor:"Editor de Caractersticas",copyPrompt:"Copiar",missingKey:"Falta a Chave da API. Configure-a nas Configuraes do menu principal.",modeRefine:"Expandir/Refinar",refineTitle:"Aprimorar Chave Atual",refineDesc:"Use IA para expandir ou refinar sua chave de identificao existente.",actionExpand:"Expandir Entidades",actionExpandDesc:"Adicionar novas espcies/entidades similares s existentes",actionRefine:"Refinar Caractersticas",actionRefineDesc:"Melhorar descries e adicionar caractersticas discriminantes",actionClean:"Limpar & Otimizar",actionCleanDesc:"Remover caractersticas redundantes, corrigir inconsistncias",expandCount:"# Novas Entidades a Adicionar",keepExisting:"Preservar entidades existentes",addFeatures:"Adicionar novas caractersticas discriminantes",improveDescriptions:"Melhorar descries",fillGaps:"Preencher dados de caractersticas faltantes",removeRedundant:"Remover caractersticas redundantes",fixInconsistencies:"Corrigir inconsistncias",currentProject:"Projeto Atual",noProjectLoaded:"Nenhum projeto carregado. Crie ou carregue um projeto primeiro.",entitiesCount:"entidades",featuresCount:"caractersticas",completePhotos:"Completar Acervo Fotogrfico",completePhotosDesc:"Preencher imagens faltantes com URLs vlidas",photoTargetEntities:"Imagens de Entidades",photoTargetFeatures:"Imagens de Caractersticas",photoTargetBoth:"Ambos",actionPhotos:"Completar Fotos",actionPhotosDesc:"Preencher todas as imagens faltantes com URLs reais",photosActionDesc:"Selecione quais imagens completar com URLs vlidas",modeMerge:"Combinar",mergeTitle:"Combinar Duas Chaves",mergeDesc:"Importe dois JSONs e combine-os em uma chave otimizada.",mergeKey1:"Primeira Chave (JSON)",mergeKey2:"Segunda Chave (JSON)",uploadKey1:"Carregar Chave 1 (JSON)",uploadKey2:"Carregar Chave 2 (JSON)",mergeStrategy:"Estratgia de Combinao",strategyUnion:"Unio (Tudo includo)",strategyUnionDesc:"Incluir todas as caractersticas e entidades de ambas as chaves",strategyIntersection:"Interseo (Comum)",strategyIntersectionDesc:"Focar nas caractersticas compartilhadas entre as chaves",strategyPrimary:"Primria (Base Chave 1)",strategyPrimaryDesc:"Usar Chave 1 como base, adicionar elementos nicos da Chave 2",remove:"Remover",mergeAction:"Combinar Chaves",mergeLoaded:"carregado"}},oM=({initialProject:e,onSave:t,onCancel:n,language:r,defaultModel:i,apiKey:s,onOpenSettings:o})=>{var ra,ia,Rs,Ps,Fs;const a=sM[r],[l,u]=Ae.useState(e||{id:Math.random().toString(36).substr(2,9),name:r==="pt"?"Nova Chave":"New Key",description:"",features:[],entities:[]}),[d,m]=Ae.useState("GENERAL"),[h,g]=Ae.useState({topic:"",count:10,featureCount:5,geography:"",taxonomy:"",language:r,featureFocus:"general",includeSpeciesImages:!0,includeFeatureImages:!0,includeLinks:!0,model:i,detailLevel:2}),[v,x]=Ae.useState(!1),[_,T]=Ae.useState(!1),[y,E]=Ae.useState("TOPIC"),[A,b]=Ae.useState(null),[D,C]=Ae.useState([]),[L,P]=Ae.useState(!1),[U,W]=Ae.useState(!1),[V,Y]=Ae.useState("EXPAND"),[le,ue]=Ae.useState({expandCount:10,keepExisting:!0,addFeatures:!0,improveDescriptions:!0,fillGaps:!0,removeRedundant:!1,fixInconsistencies:!0,completePhotos:!1,photoTarget:"both"}),[_e,Ne]=Ae.useState(null),[ee,ve]=Ae.useState(null),[Se,Fe]=Ae.useState("union"),[F,H]=Ae.useState(!1),[B,O]=Ae.useState(""),[Q,pe]=Ae.useState(null),[Te,Ee]=Ae.useState(l.features.length>0?l.features[0].id:null),ce=ym.useRef(null),[qe,De]=Ae.useState(!1),ft=M=>{const K=Te!==M;Ee(te=>te===M?null:M),K&&ce.current&&setTimeout(()=>{const te=ce.current;if(!te)return;const ie=l.features.findIndex(ot=>ot.id===M);if(ie===-1)return;let ge=200;for(let ot=0;ot<ie;ot++)ge+=70;const we=te.clientWidth,Ie=l.features[ie].states.length*90,st=ge-we/2+Ie/2;te.scrollTo({left:Math.max(0,st),behavior:"smooth"})},100)},Le=M=>{const K=l.features.findIndex(ie=>ie.id===Te);if(K===-1)return;const te=M==="prev"?(K-1+l.features.length)%l.features.length:(K+1)%l.features.length;ft(l.features[te].id)};Ae.useEffect(()=>{g(M=>({...M,language:r}))},[r]),Ae.useEffect(()=>{g(M=>({...M,model:i}))},[i]),Ae.useEffect(()=>{const M=ce.current;if(!M)return;const K=()=>{De(M.scrollTop>0)};return M.addEventListener("scroll",K),()=>M.removeEventListener("scroll",K)},[]),Ae.useEffect(()=>{const M=localStorage.getItem("lucidgen_projects");if(M)try{C(JSON.parse(M))}catch{console.error("Failed to load local projects")}},[]);const xn=M=>u(K=>({...K,...M})),Ke=()=>{const M=[l,...D.filter(K=>K.id!==l.id)];C(M),localStorage.setItem("lucidgen_projects",JSON.stringify(M)),alert(a.savedMsg)},ye=M=>{u(M),P(!1)},Ht=()=>{const M="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(l)),K=document.createElement("a");K.setAttribute("href",M),K.setAttribute("download",`${l.name.replace(/\s+/g,"_")}.json`),document.body.appendChild(K),K.click(),K.remove()},vn=()=>{const M=En.book_new(),K=l.entities.map(at=>{var tr,qn;return{ID:at.id,Name:at.name,Description:at.description,ImageURL:at.imageUrl,LinkLabels:((tr=at.links)==null?void 0:tr.map(Xr=>Xr.label).join("; "))||"",LinkURLs:((qn=at.links)==null?void 0:qn.map(Xr=>Xr.url).join("; "))||""}}),te=En.json_to_sheet(K);En.book_append_sheet(M,te,"Entities");const ie=l.features.map(at=>({ID:at.id,Name:at.name,ImageURL:at.imageUrl,States:at.states.map(tr=>tr.label).join("; ")})),ge=En.json_to_sheet(ie);En.book_append_sheet(M,ge,"Features");const we=l.entities.map(at=>{const tr={Entity:at.name};return l.features.forEach(qn=>{const Xr=at.traits[qn.id]||[],du=qn.states.filter(Ms=>Xr.includes(Ms.id)).map(Ms=>Ms.label).join(", ");tr[qn.name]=du}),tr}),Ie=En.json_to_sheet(we);En.book_append_sheet(M,Ie,"Matrix");const st=[{Name:l.name,Description:l.description,ExportDate:new Date().toISOString().split("T")[0],TotalEntities:l.entities.length,TotalFeatures:l.features.length}],ot=En.json_to_sheet(st);En.book_append_sheet(M,ot,"Project Info"),nv(M,`${l.name.replace(/\s+/g,"_")}.xlsx`)},Wn=M=>{const K=new FileReader;M.target.files&&M.target.files[0]&&(K.readAsText(M.target.files[0],"UTF-8"),K.onload=te=>{var ie;try{const ge=JSON.parse((ie=te.target)==null?void 0:ie.result);ge.name&&ge.features&&ge.entities?u(ge):alert("Invalid project file format.")}catch{alert("Error parsing JSON file.")}})},_r=M=>{M.target.files&&M.target.files[0]&&b(M.target.files[0])},Cs=M=>new Promise((K,te)=>{const ie=new FileReader;ie.onload=()=>{const we=ie.result.split(",")[1];K(we)},ie.onerror=ge=>te(ge),ie.readAsDataURL(M)}),As=async()=>{if(!s){alert(a.missingKey);return}x(!0);try{let M={...h};if(y==="IMPORT"&&A){const te=await Cs(A);M.importedFile={data:te,mimeType:A.type},M.topic=`Imported: ${A.name}`}else if(y==="TOPIC"){if(!M.topic.trim())return;M.importedFile=void 0}const K=await iM(M,s,te=>{navigator.clipboard.writeText(te).then(()=>{console.log("Prompt copied")}).catch(ie=>console.error("Could not copy prompt",ie))});u(K),T(!1),m("MATRIX")}catch(M){console.error(M),alert(a.errGen)}finally{x(!1)}},sn=()=>{const M=JSON.stringify({name:l.name,description:l.description,features:l.features.map(te=>({name:te.name,imageUrl:te.imageUrl||"",states:te.states.map(ie=>ie.label)})),entities:l.entities.map(te=>({name:te.name,description:te.description,imageUrl:te.imageUrl||"",traits:Object.entries(te.traits).map(([ie,ge])=>{const we=l.features.find(Ie=>Ie.id===ie);return ge.map(Ie=>{const st=we==null?void 0:we.states.find(ot=>ot.id===Ie);return{featureName:(we==null?void 0:we.name)||"",stateValue:(st==null?void 0:st.label)||""}})}).flat()}))},null,2);let K="";if(V==="PHOTOS"){const te=le.photoTarget==="entities"||le.photoTarget==="both",ie=le.photoTarget==="features"||le.photoTarget==="both";K=`
You are an expert biologist with access to scientific image databases.

CURRENT KEY (JSON):
${M}

TASK: Complete the photo collection for this identification key.

YOUR ONLY TASK IS TO FIND AND ADD VALID IMAGE URLs. DO NOT CHANGE ANY OTHER DATA.

CRITICAL REQUIREMENTS:
${te?`
FOR ENTITIES (Species/Taxa):
- Check each entity's imageUrl field
- If empty or invalid, find a REAL, DIRECT image URL showing this species
- Sources to use (in order of preference):
  1. Wikimedia Commons (format: https://upload.wikimedia.org/wikipedia/commons/X/XX/Species_name.jpg)
  2. Encyclopedia of Life (eol.org)
  3. iNaturalist static images
  4. GBIF image repository
  5. Flora e Funga do Brasil (for Brazilian species)
- The URL MUST end in .jpg, .jpeg, .png, or .webp
- The URL MUST be a DIRECT link to the image binary, NOT a webpage
- DO NOT use Google Images or Pinterest URLs
`:""}
${ie?`
FOR FEATURES (Characteristics):
- Check each feature's imageUrl field
- If empty or invalid, find a REAL, DIRECT image URL illustrating this trait
- Use botanical/zoological illustration databases or Wikipedia diagrams
- The URL MUST end in .jpg, .jpeg, .png, or .webp
- The URL MUST be a DIRECT link to the image binary
`:""}

FALLBACK: If you absolutely cannot find a real image, use:
https://picsum.photos/seed/[entity-or-feature-name-encoded]/400/300

PRESERVE: Keep ALL existing data exactly as-is. Only add/update imageUrl fields.
LANGUAGE: ${r==="pt"?"Portuguese":"English"}

OUTPUT: Return the complete JSON with all imageUrls filled in.
`}else V==="EXPAND"?K=`
You are an expert taxonomist. I have an existing identification key that I want to EXPAND with more entities.

CURRENT KEY (JSON):
${M}

TASK: Add ${le.expandCount} NEW entities (species/taxa) to this key.

CRITICAL RULES:
1. DO NOT repeat any of the existing ${l.entities.length} entities. Each new entity MUST be unique.
2. New entities should be taxonomically related or similar to existing ones (same family/genus/habitat).
3. ${le.keepExisting?"PRESERVE all existing entities in the output.":"Replace existing entities with new ones."}
4. ${le.addFeatures?"You MAY add 1-3 new discriminating features if needed to distinguish new species.":"Use ONLY the existing features."}
5. For each new entity, assign appropriate trait values using the existing feature states.
6. Maintain the same level of detail and language (${r==="pt"?"Portuguese":"English"}).

OUTPUT: Return a complete JSON with the expanded key including all entities (existing + new).
`:V==="REFINE"?K=`
You are an expert taxonomist. I have an existing identification key that I want to REFINE and improve.

CURRENT KEY (JSON):
${M}

TASK: Improve and refine this identification key.

IMPROVEMENTS TO MAKE:
${le.improveDescriptions?"- Improve entity descriptions with more accurate biological information.":""}
${le.fillGaps?"- Fill in missing trait data where entities lack assignments.":""}
${le.addFeatures?"- Add 2-4 new discriminating features that help better distinguish between entities.":""}

RULES:
1. Keep all existing entities.
2. Maintain the same language (${r==="pt"?"Portuguese":"English"}).
3. Ensure scientific accuracy.
4. Make features more discriminating (each state should ideally apply to different subsets of entities).

OUTPUT: Return the improved JSON key.
`:K=`
You are an expert taxonomist. I have an existing identification key that I want to CLEAN and optimize.

CURRENT KEY (JSON):
${M}

TASK: Clean and optimize this identification key.

OPTIMIZATIONS TO MAKE:
${le.removeRedundant?"- Remove redundant features (features where all entities have the same state).":""}
${le.fixInconsistencies?"- Fix any inconsistencies in trait assignments.":""}
- Ensure each feature has meaningful variation across entities.
- Remove empty or meaningless states.

RULES:
1. Keep all entities.
2. Maintain the same language (${r==="pt"?"Portuguese":"English"}).
3. Only remove features that provide no discriminating value.

OUTPUT: Return the cleaned JSON key.
`;return K},wi=()=>{if(!_e||!ee)return"";const M=JSON.stringify({name:_e.name,description:_e.description,features:_e.features.map(ie=>({name:ie.name,states:ie.states.map(ge=>ge.label)})),entities:_e.entities.map(ie=>({name:ie.name,description:ie.description,traits:Object.entries(ie.traits).map(([ge,we])=>{const Ie=_e.features.find(st=>st.id===ge);return we.map(st=>{const ot=Ie==null?void 0:Ie.states.find(at=>at.id===st);return{featureName:(Ie==null?void 0:Ie.name)||"",stateValue:(ot==null?void 0:ot.label)||""}})}).flat()}))},null,2),K=JSON.stringify({name:ee.name,description:ee.description,features:ee.features.map(ie=>({name:ie.name,states:ie.states.map(ge=>ge.label)})),entities:ee.entities.map(ie=>({name:ie.name,description:ie.description,traits:Object.entries(ie.traits).map(([ge,we])=>{const Ie=ee.features.find(st=>st.id===ge);return we.map(st=>{const ot=Ie==null?void 0:Ie.states.find(at=>at.id===st);return{featureName:(Ie==null?void 0:Ie.name)||"",stateValue:(ot==null?void 0:ot.label)||""}})}).flat()}))},null,2);let te="";return Se==="union"?te=`
MERGE STRATEGY: UNION (All-inclusive)
- Include ALL features from BOTH keys
- Include ALL entities from BOTH keys
- Merge similar features where possible, keeping all unique states
- For duplicate entities, combine traits from both sources`:Se==="intersection"?te=`
MERGE STRATEGY: INTERSECTION (Common elements)
- Keep only features that are present in BOTH keys (or semantically equivalent)
- Include ALL entities from both keys, but focus on shared characteristics
- Prioritize traits that appear in both keys for duplicate entities`:te=`
MERGE STRATEGY: PRIMARY (Key 1 priority)
- Use KEY 1 as the primary structure base
- Add entities from KEY 2 that don't exist in KEY 1
- For duplicate entities, prefer KEY 1's trait assignments
- Add features from KEY 2 only if they add discrimination value`,`
You are an expert taxonomist specializing in identification key design and optimization.

TASK: Merge two identification keys into ONE comprehensive, optimized key.

KEY 1 (${_e.entities.length} entities, ${_e.features.length} features):
${M}

KEY 2 (${ee.entities.length} entities, ${ee.features.length} features):
${K}

${te}

CRITICAL REQUIREMENTS:
1. PRESERVE ALL ENTITIES from BOTH keys. The merged key must include every single species/entity.
2. Create a unified feature set that can describe ALL entities
3. Assign appropriate traits to every entity for every feature in the merged key
4. Merge semantically similar features (e.g., "Leaf Shape" and "Leaf Form")
5. Maintain language: ${r==="pt"?"Portuguese":"English"}

PROCESS:
1. First, identify all unique entities from both keys
2. Analyze features from both keys for similarities
3. Create unified feature set based on merge strategy
4. Map all entities to the new feature set
5. Ensure every entity has trait assignments for every feature

OUTPUT: Return a single merged JSON identification key with:
- Combined name and description
- Unified feature set
- ALL entities from both keys with complete trait mappings
`},Ci=M=>{const K=document.createElement("input");K.type="file",K.accept=".json",K.onchange=async te=>{var ge;const ie=(ge=te.target.files)==null?void 0:ge[0];if(ie)try{const we=await ie.text(),Ie=JSON.parse(we);if(!Ie.features||!Ie.entities){alert(r==="pt"?"JSON invlido. Deve conter features e entities.":"Invalid JSON. Must contain features and entities.");return}M===1?Ne(Ie):ve(Ie)}catch{alert(r==="pt"?"Erro ao ler arquivo JSON.":"Error reading JSON file.")}},K.click()},Ns=async()=>{if(!s){alert(a.missingKey);return}if(!_e||!ee){alert(r==="pt"?"Carregue ambas as chaves JSON primeiro.":"Load both JSON keys first.");return}x(!0);try{const M=wi(),K=await Zu(M,s,h.model);u(K),T(!1),m("MATRIX")}catch(M){console.error(M),alert(a.errGen)}finally{x(!1)}},er=async()=>{if(!s){alert(a.missingKey);return}if(l.entities.length===0){alert(r==="pt"?"Carregue um projeto primeiro.":"Load a project first.");return}x(!0);try{const M=sn(),K=await Zu(M,s,h.model);u(K),T(!1),m("MATRIX")}catch(M){console.error(M),alert(a.errGen)}finally{x(!1)}},fu=async()=>{try{if(y==="REFINE"){if(l.entities.length===0){alert(r==="pt"?"Carregue um projeto primeiro.":"Load a project first.");return}const ge=sn();O(ge),H(!0),T(!1);return}let M={...h};if(y==="IMPORT"&&A){const ge=await Cs(A);M.importedFile={data:ge,mimeType:A.type},M.topic=`Imported: ${A.name}`}else if(y==="TOPIC"){if(!M.topic.trim()){alert("Please enter a topic first.");return}M.importedFile=void 0}const{systemInstruction:K,prompt:te}=Uv(M),ie=`SYSTEM:
${K}

USER PROMPT:
${te}`;O(ie),H(!0),T(!1)}catch(M){console.error("Failed to build prompt",M)}},Zo=async()=>{if(!s){alert(a.missingKey);return}x(!0),H(!1);try{const M=await Zu(B,s,h.model);u(M),m("MATRIX")}catch(M){console.error(M),alert(a.errGen)}finally{x(!1)}},Is=()=>{H(!1),T(!0)},ea=()=>{const M={id:Math.random().toString(36).substr(2,9),name:r==="pt"?"Nova Caracterstica":"New Feature",imageUrl:"",states:[{id:Math.random().toString(36).substr(2,9),label:r==="pt"?"Estado 1":"State 1"}]};u(K=>({...K,features:[...K.features,M]}))},ta=()=>{const M={id:Math.random().toString(36).substr(2,9),name:r==="pt"?"Nova Entidade":"New Entity",description:"...",links:[],traits:{}};u(K=>({...K,entities:[...K.entities,M]}))},ks=(M,K,te)=>{u(ie=>{const ge=ie.entities.map(we=>{if(we.id!==M)return we;const Ie=we.traits[K]||[],st=Ie.includes(te);let ot;return st?ot=Ie.filter(at=>at!==te):ot=[...Ie,te],{...we,traits:{...we.traits,[K]:ot}}});return{...ie,entities:ge}})},na=M=>M===1?a.detailSimple:M===3?a.detailExpert:y==="IMPORT"?a.detailOriginal:a.detailBalanced;return p.jsxs("div",{className:"flex flex-col h-full bg-white font-sans absolute inset-0",children:[p.jsxs("div",{className:"border-b px-4 py-3 flex justify-between items-center bg-slate-900 text-white shadow-md z-30 shrink-0",children:[p.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[p.jsx("button",{onClick:()=>W(!U),className:"md:hidden text-slate-300 hover:text-white",children:p.jsx(FE,{size:24})}),p.jsxs("h2",{className:"text-base md:text-xl font-bold flex items-center gap-2 truncate",children:[p.jsx("span",{className:"bg-emerald-500 text-[10px] md:text-xs text-white px-2 py-1 rounded uppercase tracking-wider shadow-sm hidden sm:inline-block",children:a.builder}),p.jsx("span",{className:"truncate max-w-[150px] md:max-w-[300px]",children:l.name})]}),p.jsx("div",{className:"h-6 w-px bg-slate-700 mx-2 hidden md:block"}),p.jsxs("div",{className:"hidden md:flex items-center gap-1 text-sm",children:[p.jsxs("button",{onClick:Ke,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:a.save,children:[p.jsx(uo,{size:14})," ",p.jsx("span",{className:"hidden sm:inline",children:a.save})]}),p.jsxs("button",{onClick:()=>P(!0),className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:a.open,children:[p.jsx(Zi,{size:14})," ",p.jsx("span",{className:"hidden sm:inline",children:a.open})]}),p.jsxs("button",{onClick:Ht,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:a.export,children:[p.jsx(Jc,{size:14})," ",p.jsx("span",{className:"hidden sm:inline",children:a.export})]}),p.jsxs("button",{onClick:vn,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:a.exportXLSX,children:[p.jsx(Kc,{size:14})," ",p.jsx("span",{className:"hidden sm:inline",children:a.exportXLSX})]}),p.jsxs("label",{className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white cursor-pointer",title:a.import,children:[p.jsx(Ri,{size:14})," ",p.jsx("span",{className:"hidden sm:inline",children:a.import}),p.jsx("input",{type:"file",accept:".json",onChange:Wn,className:"hidden"})]})]})]}),p.jsxs("div",{className:"flex gap-2 md:gap-3",children:[p.jsxs("button",{onClick:()=>T(!0),className:"flex items-center gap-2 px-3 py-1.5 md:px-4 md:py-2 bg-gradient-to-r from-amber-500 to-yellow-500 hover:from-amber-400 hover:to-yellow-400 text-white rounded-lg transition-all shadow-lg shadow-amber-900/30 text-xs md:text-sm font-bold border border-amber-400/20 group",children:[p.jsx(lo,{size:16,className:"text-white fill-white/20 group-hover:scale-110 transition-transform"})," ",p.jsx("span",{className:"hidden sm:inline",children:a.aiWizard}),p.jsx("span",{className:"sm:hidden",children:"IA"})]}),p.jsxs("button",{onClick:()=>t(l),className:"flex items-center gap-2 px-3 py-1.5 md:px-5 md:py-2 bg-emerald-600 hover:bg-emerald-500 rounded-lg transition-all text-xs md:text-sm font-semibold shadow-lg shadow-emerald-900/30 text-white",children:[p.jsx(jc,{size:16})," ",p.jsx("span",{className:"hidden sm:inline",children:a.savePlay})]}),p.jsxs("button",{onClick:n,className:"px-2 py-1.5 md:px-4 md:py-2 text-slate-400 hover:text-white transition-colors text-xs md:text-sm font-medium",children:[p.jsx(wn,{size:20,className:"md:hidden"})," ",p.jsx("span",{className:"hidden md:inline",children:a.exit})]})]})]}),U&&p.jsxs("div",{className:"md:hidden bg-slate-800 text-slate-200 border-b border-slate-700 p-2 grid grid-cols-4 gap-2 text-xs font-medium z-20",children:[p.jsxs("button",{onClick:()=>{Ke(),W(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[p.jsx(uo,{size:18})," ",a.save]}),p.jsxs("button",{onClick:()=>{P(!0),W(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[p.jsx(Zi,{size:18})," ",a.open]}),p.jsxs("button",{onClick:()=>{Ht(),W(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[p.jsx(Jc,{size:18})," ",a.export]}),p.jsxs("button",{onClick:()=>{vn(),W(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[p.jsx(Kc,{size:18})," ",a.exportXLSX]}),p.jsxs("label",{className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded cursor-pointer",children:[p.jsx(Ri,{size:18})," ",a.import,p.jsx("input",{type:"file",accept:".json",onChange:Wn,className:"hidden"})]})]}),p.jsx("div",{className:"flex border-b bg-white overflow-x-auto whitespace-nowrap shrink-0",children:[{id:"GENERAL",label:a.general,icon:vE},{id:"FEATURES",label:a.features,icon:RE},{id:"ENTITIES",label:a.entities,icon:S1},{id:"MATRIX",label:a.matrix,icon:Wu}].map(M=>p.jsxs("button",{onClick:()=>m(M.id),className:`flex items-center gap-2 px-4 py-3 md:py-4 text-xs md:text-sm font-medium transition-all border-b-2 relative top-[2px] min-w-fit ${d===M.id?"border-emerald-600 text-emerald-600 bg-emerald-50/50 rounded-t-lg":"border-transparent text-slate-500 hover:text-slate-800 hover:bg-slate-50/50"}`,children:[p.jsx(M.icon,{size:16})," ",M.label]},M.id))}),p.jsx("div",{className:"flex-1 overflow-auto bg-slate-50 p-4 md:p-6 pb-20 md:pb-6",children:p.jsxs("div",{className:`mx-auto bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden ${d==="MATRIX"?"max-w-none":"max-w-6xl"}`,children:[d==="GENERAL"&&p.jsx("div",{className:"p-6 md:p-8 space-y-8 max-w-2xl",children:p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 border-b pb-2",children:a.general}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1",children:a.projectName}),p.jsx("input",{value:l.name,onChange:M=>xn({name:M.target.value}),className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all font-medium text-slate-800"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1",children:a.description}),p.jsx("textarea",{value:l.description,onChange:M=>xn({description:M.target.value}),className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all h-32 text-slate-700"})]})]})]})}),d==="FEATURES"&&p.jsxs("div",{className:"p-4 md:p-8",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:a.definedFeatures}),p.jsx("p",{className:"text-xs md:text-sm text-slate-500",children:a.definedFeaturesDesc})]}),p.jsxs("button",{onClick:ea,className:"flex items-center gap-2 text-sm bg-slate-900 text-white px-4 py-2 rounded-lg hover:bg-slate-700 shadow-md transition-all",children:[p.jsx(Sa,{size:16})," ",p.jsx("span",{className:"hidden sm:inline",children:a.addFeature})]})]}),p.jsx("div",{className:"grid gap-6 md:grid-cols-2 xl:grid-cols-3",children:l.features.map((M,K)=>p.jsxs("div",{className:"border border-slate-200 rounded-xl p-5 bg-white relative group hover:border-emerald-300 hover:shadow-md transition-all",children:[p.jsx("button",{className:"absolute top-3 right-3 text-slate-300 hover:text-red-500 md:opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-red-50 rounded",onClick:()=>{const te=l.features.filter(ie=>ie.id!==M.id);u(ie=>({...ie,features:te}))},children:p.jsx(Wa,{size:16})}),p.jsxs("div",{className:"mb-4 space-y-2",children:[p.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:a.featureName}),p.jsx("input",{value:M.name,onChange:te=>{const ie=[...l.features];ie[K].name=te.target.value,u(ge=>({...ge,features:ie}))},className:"font-bold text-lg text-slate-800 bg-transparent border-b border-transparent hover:border-slate-300 focus:border-emerald-500 outline-none w-full pb-1"}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Wi,{size:14,className:"text-slate-400"}),p.jsx("input",{value:M.imageUrl||"",onChange:te=>{const ie=[...l.features];ie[K].imageUrl=te.target.value,u(ge=>({...ge,features:ie}))},className:"text-xs flex-1 bg-slate-50 border border-slate-200 rounded px-2 py-1 outline-none focus:border-emerald-400",placeholder:a.imageURL})]})]}),p.jsxs("div",{className:"space-y-2 pl-3 border-l-2 border-slate-100",children:[p.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider block mb-1",children:a.states}),M.states.map((te,ie)=>p.jsxs("div",{className:"flex items-center gap-2 group/state",children:[p.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-300 group-focus-within/state:bg-emerald-400"}),p.jsx("input",{value:te.label,onChange:ge=>{const we=[...l.features];we[K].states[ie].label=ge.target.value,u(Ie=>({...Ie,features:we}))},className:"text-sm bg-transparent outline-none w-full text-slate-600 focus:text-slate-900 focus:font-medium"}),p.jsx("button",{onClick:()=>{const ge=[...l.features];ge[K].states=ge[K].states.filter(we=>we.id!==te.id),u(we=>({...we,features:ge}))},className:"text-slate-300 hover:text-red-400 md:opacity-0 group-hover/state:opacity-100 transition-opacity",children:p.jsx(wn,{size:12})})]},te.id)),p.jsxs("button",{onClick:()=>{const te=[...l.features];te[K].states.push({id:Math.random().toString(36).substr(2,9),label:"..."}),u(ie=>({...ie,features:te}))},className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium mt-3 flex items-center gap-1 bg-emerald-50 w-fit px-2 py-1 rounded",children:[p.jsx(Sa,{size:10})," ",a.addState]})]})]},M.id))})]}),d==="ENTITIES"&&p.jsxs("div",{className:"p-4 md:p-8",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:a.manageEntities}),p.jsx("p",{className:"text-xs md:text-sm text-slate-500",children:a.manageEntitiesDesc})]}),p.jsxs("button",{onClick:ta,className:"flex items-center gap-2 text-sm bg-slate-900 text-white px-4 py-2 rounded-lg hover:bg-slate-700 shadow-md transition-all",children:[p.jsx(Sa,{size:16})," ",p.jsx("span",{className:"hidden sm:inline",children:a.addEntity})]})]}),p.jsx("div",{className:"space-y-4",children:l.entities.map((M,K)=>p.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 items-start border border-slate-200 p-4 md:p-6 rounded-xl bg-white hover:shadow-md transition-shadow",children:[p.jsxs("div",{className:"w-full sm:w-48 space-y-2 flex-shrink-0",children:[p.jsx("div",{className:"aspect-[4/3] bg-slate-100 rounded-lg overflow-hidden border border-slate-200",children:M.imageUrl?p.jsx("img",{src:M.imageUrl,className:"w-full h-full object-cover",alt:"preview"}):p.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-300",children:p.jsx(Wi,{size:32})})}),p.jsx("input",{value:M.imageUrl||"",onChange:te=>{const ie=[...l.entities];ie[K].imageUrl=te.target.value,u(ge=>({...ge,entities:ie}))},className:"text-xs w-full px-2 py-1.5 bg-slate-50 border border-slate-200 rounded outline-none focus:border-emerald-500 text-slate-600",placeholder:a.imageURL}),p.jsxs("button",{onClick:()=>pe(M.id),className:"w-full flex items-center justify-center gap-2 text-xs bg-slate-100 hover:bg-slate-200 text-slate-700 py-3 md:py-2 rounded-lg font-medium transition-colors border border-slate-200",children:[p.jsx(_a,{size:12})," ",a.editTraits]})]}),p.jsxs("div",{className:"flex-1 space-y-4 w-full",children:[p.jsxs("div",{className:"flex justify-between items-start gap-2",children:[p.jsx("input",{value:M.name,onChange:te=>{const ie=[...l.entities];ie[K].name=te.target.value,u(ge=>({...ge,entities:ie}))},className:"text-xl font-bold bg-transparent border-b border-transparent hover:border-slate-300 focus:border-emerald-500 outline-none w-full pb-1 text-slate-800"}),p.jsx("button",{onClick:()=>{const te=l.entities.filter(ie=>ie.id!==M.id);u(ie=>({...ie,entities:te}))},className:"text-slate-300 hover:text-red-500 p-2 hover:bg-red-50 rounded transition-colors",children:p.jsx(Wa,{size:18})})]}),p.jsx("textarea",{value:M.description,onChange:te=>{const ie=[...l.entities];ie[K].description=te.target.value,u(ge=>({...ge,entities:ie}))},className:"text-sm text-slate-600 bg-slate-50 border border-transparent focus:bg-white focus:border-emerald-500 w-full h-24 outline-none resize-none rounded-lg p-3 transition-colors"}),p.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100",children:[p.jsxs("h5",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 flex items-center gap-2",children:[p.jsx(Yc,{size:12})," ",a.links]}),p.jsxs("div",{className:"space-y-2",children:[(M.links||[]).map((te,ie)=>p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{placeholder:"Label",value:te.label,onChange:ge=>{const we=[...l.entities];we[K].links||(we[K].links=[]),we[K].links[ie].label=ge.target.value,u(Ie=>({...Ie,entities:we}))},className:"text-xs flex-1 px-2 py-1 border border-slate-200 rounded outline-none focus:border-emerald-400"}),p.jsx("input",{placeholder:"URL",value:te.url,onChange:ge=>{const we=[...l.entities];we[K].links||(we[K].links=[]),we[K].links[ie].url=ge.target.value,u(Ie=>({...Ie,entities:we}))},className:"text-xs flex-[2] px-2 py-1 border border-slate-200 rounded outline-none focus:border-emerald-400"}),p.jsx("button",{onClick:()=>{const ge=[...l.entities];ge[K].links||(ge[K].links=[]),ge[K].links=ge[K].links.filter((we,Ie)=>Ie!==ie),u(we=>({...we,entities:ge}))},className:"text-slate-400 hover:text-red-500",children:p.jsx(wn,{size:14})})]},te.id||ie)),p.jsxs("button",{onClick:()=>{const te=[...l.entities];te[K].links||(te[K].links=[]),te[K].links.push({id:Math.random().toString(36).substr(2,9),label:"",url:""}),u(ie=>({...ie,entities:te}))},className:"text-xs flex items-center gap-1 text-emerald-600 hover:text-emerald-700 font-medium",children:[p.jsx(Sa,{size:12})," ",a.addLink]})]})]})]})]},M.id))})]}),d==="MATRIX"&&p.jsxs("div",{className:"flex flex-col h-full bg-slate-50 min-h-[500px]",children:[p.jsxs("div",{className:"p-4 border-b bg-white",children:[p.jsxs("div",{className:"flex justify-between items-center mb-3",children:[p.jsx("h3",{className:"font-semibold text-slate-700",children:a.scoringMatrix}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"text-xs text-slate-400 hidden sm:inline",children:a.scoringMatrixDesc}),l.features.length>1&&p.jsxs("div",{className:"flex gap-1 border-l pl-2 ml-2",children:[p.jsx("button",{onClick:()=>Le("prev"),className:"p-1.5 hover:bg-slate-100 rounded transition-colors text-slate-600",title:"Caracterstica Anterior",children:p.jsx(_E,{size:16})}),p.jsx("button",{onClick:()=>Le("next"),className:"p-1.5 hover:bg-slate-100 rounded transition-colors text-slate-600",title:"Prxima Caracterstica",children:p.jsx(SE,{size:16})})]})]})]}),p.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 custom-scrollbar",children:l.features.map((M,K)=>p.jsx("button",{onClick:()=>ft(M.id),className:`shrink-0 px-3 py-1.5 rounded-full text-xs font-medium transition-all ${Te===M.id?"bg-emerald-600 text-white shadow-md":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:M.name},M.id))})]}),p.jsx("div",{className:"flex-1 overflow-hidden bg-gradient-to-br from-slate-100 to-slate-200 relative",children:p.jsx("div",{ref:ce,className:"absolute inset-0 overflow-auto custom-scrollbar",children:p.jsxs("table",{className:"border-collapse w-max",children:[p.jsxs("thead",{className:"sticky top-0 z-40",children:[p.jsxs("tr",{className:"bg-gradient-to-r from-slate-800 to-slate-900",children:[p.jsx("th",{rowSpan:2,className:"sticky left-0 z-50 bg-gradient-to-br from-slate-800 to-slate-900 text-white px-3 py-2 font-bold border-r border-b border-slate-600 text-left align-bottom",style:{minWidth:"180px",maxWidth:"180px"},children:p.jsx("span",{className:"text-xs font-semibold tracking-wide",children:a.taxaFeatures})}),l.features.map(M=>{const K=Te===M.id,te=K?M.states.length:1;return p.jsx("th",{colSpan:te,className:`px-1 py-1.5 font-semibold border-r border-b text-center align-middle cursor-pointer transition-all duration-200 ${K?"bg-gradient-to-br from-emerald-500 to-emerald-700 border-emerald-400 text-white shadow-lg":"bg-gradient-to-b from-slate-600 to-slate-700 border-slate-500 text-slate-100 hover:from-slate-500 hover:to-slate-600"}`,style:{minWidth:K?`${te*80}px`:"60px"},onClick:()=>ft(M.id),title:M.name,children:p.jsxs("div",{className:"flex items-center justify-center gap-1",children:[K&&p.jsx("button",{onClick:ie=>{ie.stopPropagation(),Ee(null)},className:"p-0.5 hover:bg-emerald-400/50 rounded transition-colors flex-shrink-0",children:p.jsx(wn,{size:12})}),p.jsx("span",{className:`font-semibold leading-tight ${K?"text-[10px]":"text-[9px]"}`,children:M.name})]})},`header-${M.id}`)})]}),p.jsx("tr",{children:l.features.map(M=>Te===M.id?M.states.map(te=>p.jsx("th",{className:"bg-gradient-to-b from-emerald-600 to-emerald-700 text-white px-1 py-1.5 border-r border-b border-emerald-500 text-center align-top",style:{minWidth:"80px",maxWidth:"100px"},title:te.label,children:p.jsx("div",{className:"text-[8px] font-medium leading-snug px-0.5 break-words",style:{wordBreak:"break-word",hyphens:"auto"},children:te.label})},`state-${te.id}`)):p.jsx("th",{className:"bg-gradient-to-b from-slate-500 to-slate-600 text-slate-200 px-1 py-1.5 border-r border-b border-slate-400 text-center cursor-pointer hover:from-slate-400 hover:to-slate-500 transition-all",style:{minWidth:"60px",maxWidth:"60px"},onClick:()=>ft(M.id),children:p.jsxs("div",{className:"flex flex-col items-center gap-0",children:[p.jsx("span",{className:"text-[8px] opacity-80",children:"expandir"}),p.jsxs("span",{className:"text-[10px] font-bold",children:["(",M.states.length,")"]})]})},`expand-${M.id}`))})]}),p.jsx("tbody",{children:l.entities.map((M,K)=>p.jsxs("tr",{className:K%2===0?"bg-white":"bg-slate-50/80",children:[p.jsx("td",{className:`sticky left-0 z-20 px-2 py-1.5 border-r-2 border-b border-slate-200 ${K%2===0?"bg-white":"bg-slate-50"}`,style:{minWidth:"180px",maxWidth:"180px",boxShadow:"2px 0 6px rgba(0,0,0,0.08)"},children:p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"w-6 h-6 rounded bg-slate-200 overflow-hidden flex-shrink-0",children:M.imageUrl&&p.jsx("img",{src:M.imageUrl,className:"w-full h-full object-cover",alt:""})}),p.jsx("span",{className:"text-[11px] font-medium text-slate-700 line-clamp-2 leading-tight",title:M.name,children:M.name})]})}),l.features.map(te=>{const ie=Te===te.id,ge=M.traits[te.id]||[],we=ge.length;return ie?te.states.map(Ie=>{const st=ge.includes(Ie.id);return p.jsx("td",{className:`border-b border-r border-slate-200 text-center hover:bg-emerald-50 transition-colors p-1 ${K%2===0?"bg-white":"bg-slate-50/80"}`,style:{minWidth:"80px",maxWidth:"100px"},children:p.jsx("button",{onClick:()=>ks(M.id,te.id,Ie.id),className:`w-7 h-7 rounded-md flex items-center justify-center transition-all mx-auto ${st?"bg-gradient-to-br from-emerald-400 to-emerald-600 text-white shadow-sm":"bg-slate-100 text-slate-300 hover:bg-slate-200"}`,children:st&&p.jsx(Wu,{size:14,strokeWidth:2.5})})},`${M.id}-${Ie.id}`)}):p.jsx("td",{className:`border-b border-r border-slate-200 text-center cursor-pointer hover:bg-slate-100 transition-colors p-1 ${K%2===0?"bg-white":"bg-slate-50/80"}`,style:{minWidth:"60px",maxWidth:"60px"},onClick:()=>ft(te.id),title:`${we} de ${te.states.length}`,children:p.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-bold mx-auto ${we>0?"bg-gradient-to-br from-emerald-100 to-emerald-200 text-emerald-700":"bg-slate-100 text-slate-400"}`,children:we})},`${M.id}-${te.id}-collapsed`)})]},M.id))})]})})})]})]})}),Q&&p.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:p.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col max-h-[90vh] animate-in fade-in zoom-in-95 overflow-hidden",children:[p.jsxs("div",{className:"bg-slate-50 p-4 border-b flex justify-between items-center",children:[p.jsxs("h3",{className:"font-bold text-slate-800 text-lg flex items-center gap-2 truncate",children:[p.jsx(_a,{size:18,className:"text-emerald-600"}),p.jsxs("span",{className:"truncate",children:[a.traitEditor,": ",p.jsx("span",{className:"text-emerald-600",children:(ra=l.entities.find(M=>M.id===Q))==null?void 0:ra.name})]})]}),p.jsx("button",{onClick:()=>pe(null),className:"text-slate-400 hover:text-slate-600 p-1",children:p.jsx(wn,{size:20})})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 space-y-6 custom-scrollbar",children:[l.features.map(M=>p.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4",children:[p.jsxs("h4",{className:"font-bold text-slate-700 mb-3 flex items-center gap-2",children:[M.name,M.imageUrl&&p.jsx("a",{href:M.imageUrl,target:"_blank",rel:"noopener noreferrer",className:"text-slate-400 hover:text-emerald-500",children:p.jsx(xl,{size:12})})]}),p.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:M.states.map(K=>{var ie,ge;const te=(ge=(ie=l.entities.find(we=>we.id===Q))==null?void 0:ie.traits[M.id])==null?void 0:ge.includes(K.id);return p.jsxs("button",{onClick:()=>ks(Q,M.id,K.id),className:`text-sm px-3 py-3 md:py-2 rounded-lg border text-left flex items-center justify-between transition-all touch-manipulation active:scale-[0.98] ${te?"bg-emerald-600 text-white border-emerald-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-emerald-300 hover:text-emerald-600"}`,children:[p.jsx("span",{className:"truncate mr-2 text-xs md:text-sm",children:K.label}),te&&p.jsx(Wu,{size:14})]},K.id)})})]},M.id)),l.features.length===0&&p.jsx("div",{className:"text-center text-slate-400 py-10",children:"Nenhuma caracterstica definida no projeto."})]}),p.jsx("div",{className:"p-4 border-t bg-slate-50 shrink-0",children:p.jsx("button",{onClick:()=>pe(null),className:"w-full py-3 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-500 shadow-lg shadow-emerald-900/10",children:a.close})})]})}),_&&p.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:p.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full overflow-hidden animate-in fade-in zoom-in-95 duration-200 border border-slate-200 max-h-[90vh] flex flex-col",children:[p.jsxs("div",{className:"bg-gradient-to-r from-amber-500 to-yellow-500 p-4 md:p-6 text-white shrink-0",children:[p.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[p.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:p.jsx(lo,{size:24,className:"text-white"})}),p.jsx("h3",{className:"text-xl md:text-2xl font-bold flex-1",children:a.aiTitle}),o&&p.jsx("button",{onClick:()=>{T(!1),o()},className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",title:r==="pt"?"Configurar Chave de API":"Configure API Key",children:p.jsx(Hu,{size:18,className:"text-white"})})]}),p.jsx("p",{className:"text-amber-50 text-xs md:text-sm font-medium drop-shadow-sm",children:a.aiDesc})]}),p.jsxs("div",{className:"flex border-b border-slate-200 bg-slate-50 shrink-0",children:[p.jsx("button",{onClick:()=>E("TOPIC"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${y==="TOPIC"?"border-amber-500 text-amber-600 bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:p.jsxs("span",{className:"flex items-center justify-center gap-1",children:[p.jsx(X0,{size:14})," ",p.jsx("span",{className:"hidden sm:inline",children:a.modeTopic}),p.jsx("span",{className:"sm:hidden",children:"Gerar"})]})}),p.jsx("button",{onClick:()=>E("IMPORT"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${y==="IMPORT"?"border-amber-500 text-amber-600 bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:p.jsxs("span",{className:"flex items-center justify-center gap-1",children:[p.jsx(NE,{size:14})," ",p.jsx("span",{className:"hidden sm:inline",children:a.modeImport}),p.jsx("span",{className:"sm:hidden",children:"Importar"})]})}),p.jsx("button",{onClick:()=>E("REFINE"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${y==="REFINE"?"border-amber-500 text-amber-600 bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:p.jsxs("span",{className:"flex items-center justify-center gap-1",children:[p.jsx(j0,{size:14})," ",p.jsx("span",{className:"hidden sm:inline",children:a.modeRefine}),p.jsx("span",{className:"sm:hidden",children:"Refinar"})]})}),p.jsx("button",{onClick:()=>E("MERGE"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${y==="MERGE"?"border-amber-500 text-amber-600 bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:p.jsxs("span",{className:"flex items-center justify-center gap-1",children:[p.jsx(W0,{size:14})," ",p.jsx("span",{className:"hidden sm:inline",children:a.modeMerge}),p.jsx("span",{className:"sm:hidden",children:"Combinar"})]})})]}),p.jsxs("div",{className:"p-4 md:p-6 space-y-5 overflow-y-auto custom-scrollbar flex-1 bg-white",children:[y==="TOPIC"?p.jsxs(p.Fragment,{children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:a.topic}),p.jsx("input",{value:h.topic,onChange:M=>g(K=>({...K,topic:M.target.value})),placeholder:a.topicPlace,className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-amber-500 focus:border-amber-500 outline-none text-base md:text-lg",disabled:v})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-1.5",children:a.geography}),p.jsx("input",{value:h.geography,onChange:M=>g(K=>({...K,geography:M.target.value})),placeholder:"e.g. Amazon",className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-500 outline-none text-sm",disabled:v})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-1.5",children:a.taxonomy}),p.jsx("input",{value:h.taxonomy,onChange:M=>g(K=>({...K,taxonomy:M.target.value})),placeholder:"e.g. Felidae",className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-500 outline-none text-sm",disabled:v})]})]})]}):y==="IMPORT"?p.jsxs("div",{className:"flex flex-col gap-4",children:[p.jsxs("div",{className:"text-center space-y-2 mb-2",children:[p.jsx("h4",{className:"font-bold text-slate-800 text-lg",children:a.uploadLabel}),p.jsx("p",{className:"text-slate-500 text-sm",children:a.uploadDesc})]}),p.jsx("div",{className:`border-2 border-dashed rounded-xl p-6 flex flex-col items-center justify-center transition-all bg-slate-50 ${A?"border-amber-500 bg-amber-50/30":"border-slate-300 hover:border-amber-400"}`,children:A?p.jsxs("div",{className:"flex flex-col items-center gap-3",children:[p.jsx(Vu,{size:48,className:"text-amber-600"}),p.jsx("span",{className:"font-bold text-slate-800 text-sm text-center break-all",children:A.name}),p.jsxs("span",{className:"text-xs text-slate-400",children:[(A.size/1024).toFixed(1)," KB"]}),p.jsxs("button",{onClick:()=>b(null),className:"mt-2 text-red-500 text-xs font-bold hover:underline flex items-center gap-1 p-2",children:[p.jsx(Wa,{size:12})," ",a.removeFile]})]}):p.jsxs("label",{className:"cursor-pointer flex flex-col items-center gap-3 w-full h-full",children:[p.jsx("div",{className:"p-4 bg-white rounded-full shadow-sm",children:p.jsx(Ri,{size:24,className:"text-amber-500"})}),p.jsx("span",{className:"font-bold text-slate-600",children:a.dropFile}),p.jsx("span",{className:"text-xs text-slate-400",children:a.supportedFormats}),p.jsx("input",{type:"file",className:"hidden",accept:".pdf,.txt,.jpg,.jpeg,.png",onChange:_r})]})})]}):y==="REFINE"?p.jsxs("div",{className:"flex flex-col gap-4",children:[p.jsxs("div",{className:"bg-gradient-to-r from-emerald-50 to-teal-50 p-4 rounded-xl border border-emerald-200",children:[p.jsx("h5",{className:"text-xs font-bold text-emerald-700 uppercase mb-2",children:a.currentProject}),l.entities.length>0||l.features.length>0?p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"font-bold text-slate-800 truncate",children:l.name}),p.jsxs("p",{className:"text-xs text-slate-500",children:[l.entities.length," ",a.entitiesCount,"  ",l.features.length," ",a.featuresCount]})]}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("span",{className:"bg-emerald-100 text-emerald-700 text-xs font-bold px-2 py-1 rounded",children:l.entities.length}),p.jsx("span",{className:"bg-teal-100 text-teal-700 text-xs font-bold px-2 py-1 rounded",children:l.features.length})]})]}):p.jsx("p",{className:"text-sm text-amber-600 italic",children:a.noProjectLoaded})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("button",{onClick:()=>Y("EXPAND"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${V==="EXPAND"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:`p-2 rounded-lg ${V==="EXPAND"?"bg-amber-500 text-white":"bg-slate-100 text-slate-500"}`,children:p.jsx(PE,{size:20})}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"font-bold text-slate-800",children:a.actionExpand}),p.jsx("p",{className:"text-xs text-slate-500",children:a.actionExpandDesc})]})]})}),p.jsx("button",{onClick:()=>Y("REFINE"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${V==="REFINE"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:`p-2 rounded-lg ${V==="REFINE"?"bg-amber-500 text-white":"bg-slate-100 text-slate-500"}`,children:p.jsx(OE,{size:20})}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"font-bold text-slate-800",children:a.actionRefine}),p.jsx("p",{className:"text-xs text-slate-500",children:a.actionRefineDesc})]})]})}),p.jsx("button",{onClick:()=>Y("CLEAN"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${V==="CLEAN"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:`p-2 rounded-lg ${V==="CLEAN"?"bg-amber-500 text-white":"bg-slate-100 text-slate-500"}`,children:p.jsx(AE,{size:20})}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"font-bold text-slate-800",children:a.actionClean}),p.jsx("p",{className:"text-xs text-slate-500",children:a.actionCleanDesc})]})]})}),p.jsx("button",{onClick:()=>Y("PHOTOS"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${V==="PHOTOS"?"border-blue-500 bg-blue-50":"border-slate-200 hover:border-blue-300"}`,children:p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:`p-2 rounded-lg ${V==="PHOTOS"?"bg-blue-500 text-white":"bg-slate-100 text-slate-500"}`,children:p.jsx(EE,{size:20})}),p.jsxs("div",{className:"flex-1",children:[p.jsx("p",{className:"font-bold text-slate-800",children:a.actionPhotos}),p.jsx("p",{className:"text-xs text-slate-500",children:a.actionPhotosDesc})]})]})})]}),V==="EXPAND"&&p.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-4",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[p.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:a.expandCount}),p.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:le.expandCount})]}),p.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:le.expandCount,onChange:M=>ue(K=>({...K,expandCount:parseInt(M.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500",disabled:v})]}),p.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[p.jsx("input",{type:"checkbox",checked:le.keepExisting,onChange:M=>ue(K=>({...K,keepExisting:M.target.checked})),className:"w-4 h-4 accent-amber-500"}),p.jsx("span",{className:"text-sm text-slate-700",children:a.keepExisting})]}),p.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[p.jsx("input",{type:"checkbox",checked:le.addFeatures,onChange:M=>ue(K=>({...K,addFeatures:M.target.checked})),className:"w-4 h-4 accent-amber-500"}),p.jsx("span",{className:"text-sm text-slate-700",children:a.addFeatures})]})]}),V==="REFINE"&&p.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-3",children:[p.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[p.jsx("input",{type:"checkbox",checked:le.improveDescriptions,onChange:M=>ue(K=>({...K,improveDescriptions:M.target.checked})),className:"w-4 h-4 accent-amber-500"}),p.jsx("span",{className:"text-sm text-slate-700",children:a.improveDescriptions})]}),p.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[p.jsx("input",{type:"checkbox",checked:le.fillGaps,onChange:M=>ue(K=>({...K,fillGaps:M.target.checked})),className:"w-4 h-4 accent-amber-500"}),p.jsx("span",{className:"text-sm text-slate-700",children:a.fillGaps})]}),p.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[p.jsx("input",{type:"checkbox",checked:le.addFeatures,onChange:M=>ue(K=>({...K,addFeatures:M.target.checked})),className:"w-4 h-4 accent-amber-500"}),p.jsx("span",{className:"text-sm text-slate-700",children:a.addFeatures})]})]}),V==="CLEAN"&&p.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-3",children:[p.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[p.jsx("input",{type:"checkbox",checked:le.removeRedundant,onChange:M=>ue(K=>({...K,removeRedundant:M.target.checked})),className:"w-4 h-4 accent-amber-500"}),p.jsx("span",{className:"text-sm text-slate-700",children:a.removeRedundant})]}),p.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[p.jsx("input",{type:"checkbox",checked:le.fixInconsistencies,onChange:M=>ue(K=>({...K,fixInconsistencies:M.target.checked})),className:"w-4 h-4 accent-amber-500"}),p.jsx("span",{className:"text-sm text-slate-700",children:a.fixInconsistencies})]})]}),V==="PHOTOS"&&p.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-xl border border-blue-200 space-y-3",children:[p.jsx("p",{className:"text-sm text-blue-700",children:a.photosActionDesc}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{onClick:()=>ue(M=>({...M,photoTarget:"entities"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${le.photoTarget==="entities"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:a.photoTargetEntities}),p.jsx("button",{onClick:()=>ue(M=>({...M,photoTarget:"features"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${le.photoTarget==="features"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:a.photoTargetFeatures}),p.jsx("button",{onClick:()=>ue(M=>({...M,photoTarget:"both"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${le.photoTarget==="both"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:a.photoTargetBoth})]})]}),V!=="PHOTOS"&&p.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-xl border border-blue-200 space-y-3",children:[p.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[p.jsx("input",{type:"checkbox",checked:le.completePhotos,onChange:M=>ue(K=>({...K,completePhotos:M.target.checked})),className:"w-4 h-4 accent-blue-500"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("span",{className:"text-sm font-semibold text-blue-800",children:a.completePhotos}),p.jsx("p",{className:"text-xs text-blue-600",children:a.completePhotosDesc})]}),p.jsx(Wi,{size:20,className:"text-blue-400"})]}),le.completePhotos&&p.jsxs("div",{className:"flex gap-2 pl-6",children:[p.jsx("button",{onClick:()=>ue(M=>({...M,photoTarget:"entities"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${le.photoTarget==="entities"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:a.photoTargetEntities}),p.jsx("button",{onClick:()=>ue(M=>({...M,photoTarget:"features"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${le.photoTarget==="features"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:a.photoTargetFeatures}),p.jsx("button",{onClick:()=>ue(M=>({...M,photoTarget:"both"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${le.photoTarget==="both"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:a.photoTargetBoth})]})]})]}):null,y==="MERGE"&&p.jsxs("div",{className:"flex flex-col gap-4",children:[p.jsxs("div",{className:"text-center space-y-2 mb-2",children:[p.jsx("h4",{className:"font-bold text-slate-800 text-lg",children:a.mergeTitle}),p.jsx("p",{className:"text-slate-500 text-sm",children:a.mergeDesc})]}),p.jsx("div",{className:`border-2 border-dashed rounded-xl p-4 flex flex-col items-center justify-center transition-all ${_e?"border-amber-500 bg-amber-50/30":"border-slate-300 hover:border-amber-400 bg-slate-50"}`,children:_e?p.jsxs("div",{className:"flex flex-col items-center gap-2 w-full",children:[p.jsx(Vu,{size:32,className:"text-amber-600"}),p.jsx("span",{className:"font-bold text-slate-800 text-sm text-center",children:_e.name||"Key 1"}),p.jsxs("span",{className:"text-xs text-slate-500",children:[((ia=_e.entities)==null?void 0:ia.length)||0," ",a.entities,"  ",((Rs=_e.features)==null?void 0:Rs.length)||0," ",a.features]}),p.jsx("button",{onClick:()=>Ne(null),className:"text-xs text-red-500 hover:text-red-700 underline",children:a.remove})]}):p.jsxs("button",{onClick:()=>Ci(1),className:"flex flex-col items-center gap-2 p-2 w-full",children:[p.jsx(Ri,{size:32,className:"text-slate-400"}),p.jsx("span",{className:"text-sm font-medium text-slate-600",children:a.uploadKey1})]})}),p.jsx("div",{className:`border-2 border-dashed rounded-xl p-4 flex flex-col items-center justify-center transition-all ${ee?"border-amber-500 bg-amber-50/30":"border-slate-300 hover:border-amber-400 bg-slate-50"}`,children:ee?p.jsxs("div",{className:"flex flex-col items-center gap-2 w-full",children:[p.jsx(Vu,{size:32,className:"text-amber-600"}),p.jsx("span",{className:"font-bold text-slate-800 text-sm text-center",children:ee.name||"Key 2"}),p.jsxs("span",{className:"text-xs text-slate-500",children:[((Ps=ee.entities)==null?void 0:Ps.length)||0," ",a.entities,"  ",((Fs=ee.features)==null?void 0:Fs.length)||0," ",a.features]}),p.jsx("button",{onClick:()=>ve(null),className:"text-xs text-red-500 hover:text-red-700 underline",children:a.remove})]}):p.jsxs("button",{onClick:()=>Ci(2),className:"flex flex-col items-center gap-2 p-2 w-full",children:[p.jsx(Ri,{size:32,className:"text-slate-400"}),p.jsx("span",{className:"text-sm font-medium text-slate-600",children:a.uploadKey2})]})}),p.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-3",children:[p.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-2",children:a.mergeStrategy}),p.jsxs("div",{className:"space-y-2",children:[p.jsxs("button",{onClick:()=>Fe("union"),className:`w-full p-3 rounded-lg border-2 text-left transition-all ${Se==="union"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:[p.jsx("p",{className:"font-bold text-slate-800 text-sm",children:a.strategyUnion}),p.jsx("p",{className:"text-xs text-slate-500",children:a.strategyUnionDesc})]}),p.jsxs("button",{onClick:()=>Fe("intersection"),className:`w-full p-3 rounded-lg border-2 text-left transition-all ${Se==="intersection"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:[p.jsx("p",{className:"font-bold text-slate-800 text-sm",children:a.strategyIntersection}),p.jsx("p",{className:"text-xs text-slate-500",children:a.strategyIntersectionDesc})]}),p.jsxs("button",{onClick:()=>Fe("primary"),className:`w-full p-3 rounded-lg border-2 text-left transition-all ${Se==="primary"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:[p.jsx("p",{className:"font-bold text-slate-800 text-sm",children:a.strategyPrimary}),p.jsx("p",{className:"text-xs text-slate-500",children:a.strategyPrimaryDesc})]})]})]})]}),(y==="TOPIC"||y==="IMPORT")&&p.jsxs("div",{className:"pt-4 border-t border-slate-100 space-y-5",children:[p.jsxs("h5",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[p.jsx(Hu,{size:12})," ",a.configSettings]}),p.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase flex items-center gap-1",children:[p.jsx(ME,{size:14})," ",a.detailLevel]}),p.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-100 px-2 py-1 rounded",children:na(h.detailLevel)})]}),p.jsx("input",{type:"range",min:"1",max:"3",step:"1",value:h.detailLevel,onChange:M=>g(K=>({...K,detailLevel:parseInt(M.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500 mb-2",disabled:v}),p.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 font-medium uppercase tracking-wide",children:[p.jsxs("span",{className:`flex flex-col items-center gap-1 ${h.detailLevel===1?"text-amber-600":""}`,children:[p.jsx(gE,{size:16})," Simple"]}),p.jsxs("span",{className:`flex flex-col items-center gap-1 ${h.detailLevel===2?"text-amber-600":""}`,children:[p.jsx(lo,{size:16})," Bal."]}),p.jsxs("span",{className:`flex flex-col items-center gap-1 ${h.detailLevel===3?"text-amber-600":""}`,children:[p.jsx(kE,{size:16})," Expert"]})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-2",children:a.featureFocus}),p.jsx("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:["general","reproductive","vegetative"].map(M=>p.jsx("button",{onClick:()=>g(K=>({...K,featureFocus:M})),className:`flex-1 py-2 rounded-md text-[10px] md:text-xs font-medium transition-all ${h.featureFocus===M?"bg-white text-amber-600 shadow-sm":"text-slate-500 hover:text-slate-800"}`,disabled:v,children:M==="general"?a.focusGeneral:M==="reproductive"?a.focusRepro:a.focusVeg},M))})]}),y==="TOPIC"&&p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[p.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:a.numEntities}),p.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:h.count})]}),p.jsx("input",{type:"range",min:"3",max:"30",step:"1",value:h.count,onChange:M=>g(K=>({...K,count:parseInt(M.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500",disabled:v})]}),p.jsxs("div",{children:[p.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[p.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:a.numFeatures}),p.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:h.featureCount})]}),p.jsx("input",{type:"range",min:"2",max:"10",step:"1",value:h.featureCount,onChange:M=>g(K=>({...K,featureCount:parseInt(M.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500",disabled:v})]})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Wi,{size:16,className:"text-slate-400 group-hover:text-amber-500 transition-colors"}),p.jsx("span",{className:"text-sm font-medium text-slate-700",children:a.fetchSpeciesImg})]}),p.jsx("div",{className:`w-11 h-6 flex items-center rounded-full p-1 transition-colors ${h.includeSpeciesImages?"bg-amber-500":"bg-slate-300"}`,children:p.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${h.includeSpeciesImages?"translate-x-5":""}`})}),p.jsx("input",{type:"checkbox",className:"hidden",checked:h.includeSpeciesImages,onChange:M=>g(K=>({...K,includeSpeciesImages:M.target.checked})),disabled:v})]}),p.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Hu,{size:16,className:"text-slate-400 group-hover:text-amber-500 transition-colors"}),p.jsx("span",{className:"text-sm font-medium text-slate-700",children:a.fetchFeatureImg})]}),p.jsx("div",{className:`w-11 h-6 flex items-center rounded-full p-1 transition-colors ${h.includeFeatureImages?"bg-amber-500":"bg-slate-300"}`,children:p.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${h.includeFeatureImages?"translate-x-5":""}`})}),p.jsx("input",{type:"checkbox",className:"hidden",checked:h.includeFeatureImages,onChange:M=>g(K=>({...K,includeFeatureImages:M.target.checked})),disabled:v})]}),p.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Yc,{size:16,className:"text-slate-400 group-hover:text-amber-500 transition-colors"}),p.jsx("span",{className:"text-sm font-medium text-slate-700",children:a.fetchLinks})]}),p.jsx("div",{className:`w-11 h-6 flex items-center rounded-full p-1 transition-colors ${h.includeLinks?"bg-amber-500":"bg-slate-300"}`,children:p.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${h.includeLinks?"translate-x-5":""}`})}),p.jsx("input",{type:"checkbox",className:"hidden",checked:h.includeLinks,onChange:M=>g(K=>({...K,includeLinks:M.target.checked})),disabled:v})]})]})]}),v&&p.jsxs("div",{className:"bg-amber-50 text-amber-700 p-3 rounded-lg text-sm flex items-center justify-center gap-2",children:[p.jsx(Y0,{className:"animate-spin",size:16})," ",y==="IMPORT"?a.analyzing:a.generating]})]}),p.jsxs("div",{className:"p-4 bg-slate-50 border-t flex gap-3 shrink-0 safe-area-bottom",children:[p.jsx("button",{onClick:()=>T(!1),className:"flex-none w-16 md:w-20 py-2.5 text-slate-600 font-medium hover:bg-slate-200 rounded-xl transition-colors text-center text-xs md:text-sm",disabled:v,children:a.cancel}),p.jsxs("button",{onClick:fu,className:"w-auto px-3 py-2 text-xs bg-white border border-slate-300 text-slate-700 font-bold rounded-xl hover:bg-slate-50 hover:border-amber-400 hover:text-amber-600 shadow-sm transition-all flex items-center justify-center gap-2",disabled:v||y==="TOPIC"&&!h.topic||y==="IMPORT"&&!A||y==="REFINE"&&l.entities.length===0||y==="MERGE"&&(!_e||!ee),title:"View and edit the prompt before sending",children:[p.jsx(_a,{size:14})," ",p.jsx("span",{className:"hidden sm:inline",children:"View/Edit Prompt"})]}),y==="REFINE"?p.jsxs("button",{onClick:er,className:"flex-1 py-2.5 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 text-sm",disabled:v||l.entities.length===0,children:[V==="EXPAND"?a.actionExpand:V==="REFINE"?a.actionRefine:V==="CLEAN"?a.actionClean:a.actionPhotos," ",p.jsx(j0,{size:16,className:"opacity-70"})]}):y==="MERGE"?p.jsxs("button",{onClick:Ns,className:"flex-1 py-2.5 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 text-sm",disabled:v||!_e||!ee,children:[a.mergeAction," ",p.jsx(W0,{size:16,className:"opacity-70"})]}):p.jsxs("button",{onClick:As,className:"flex-1 py-2.5 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 text-sm",disabled:v||y==="TOPIC"&&!h.topic||y==="IMPORT"&&!A,children:[a.generate," ",p.jsx(X0,{size:16,className:"opacity-70"})]})]})]})}),F&&p.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-[60] flex items-center justify-center p-4",children:p.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col h-[80vh] max-h-[90vh] animate-in fade-in zoom-in-95 overflow-hidden",children:[p.jsxs("div",{className:"bg-slate-800 p-4 border-b border-slate-700 flex justify-between items-center text-white shrink-0",children:[p.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[p.jsx(_a,{size:18,className:"text-amber-400"}),"Prompt Editor"]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(B),alert(a.promptCopied)},className:"flex items-center gap-1.5 px-3 py-1.5 text-xs hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",children:[p.jsx(CE,{size:12})," ",a.copyPrompt]}),p.jsx("button",{onClick:Is,className:"text-slate-400 hover:text-white p-1",children:p.jsx(wn,{size:20})})]})]}),p.jsx("div",{className:"flex-1 p-2 bg-slate-100 min-h-0",children:p.jsx("textarea",{value:B,onChange:M=>O(M.target.value),className:"w-full h-full p-4 bg-slate-900 text-slate-200 font-mono text-sm rounded-lg resize-none outline-none border-2 border-transparent focus:border-amber-500",spellCheck:"false"})}),p.jsxs("div",{className:"p-4 border-t bg-slate-50 shrink-0 flex items-center justify-end gap-4",children:[p.jsx("button",{onClick:Is,className:"px-6 py-2 text-slate-600 font-medium hover:bg-slate-200 rounded-xl transition-colors",disabled:v,children:a.cancel}),p.jsx("button",{onClick:Zo,className:"px-6 py-2 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 flex items-center gap-2",disabled:v,children:v?p.jsxs(p.Fragment,{children:[p.jsx(Y0,{className:"animate-spin",size:16})," ",a.generating]}):p.jsx(p.Fragment,{children:a.generate})})]})]})}),L&&p.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:p.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",children:[p.jsxs("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[p.jsx(Zi,{className:"text-emerald-600",size:20}),a.open]}),p.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto mb-4 custom-scrollbar",children:D.length===0?p.jsx("p",{className:"text-slate-500 text-sm text-center py-8 border-2 border-dashed border-slate-200 rounded-lg",children:a.noSaved}):D.map(M=>p.jsxs("button",{onClick:()=>ye(M),className:"w-full text-left p-3 hover:bg-emerald-50 rounded-lg border border-slate-100 hover:border-emerald-200 group transition-all",children:[p.jsx("div",{className:"font-medium text-slate-800 group-hover:text-emerald-700",children:M.name}),p.jsx("div",{className:"text-xs text-slate-400 truncate",children:M.description||"No description"})]},M.id))}),p.jsx("button",{onClick:()=>P(!1),className:"w-full py-2.5 bg-slate-100 text-slate-600 rounded-xl font-medium hover:bg-slate-200 transition-colors",children:a.close})]})})]})},aM=()=>{const[e,t]=Ae.useState("HOME"),[n,r]=Ae.useState(null),[i,s]=Ae.useState("pt"),[o,a]=Ae.useState([]),[l,u]=Ae.useState(!1),[d,m]=Ae.useState(!1),[h,g]=Ae.useState(!1),[v,x]=Ae.useState("ABOUT"),[_,T]=Ae.useState("gemini-2.5-flash"),[y,E]=Ae.useState("");Ae.useEffect(()=>{const Y=localStorage.getItem("nozesia_projects");if(Y)try{a(JSON.parse(Y))}catch{console.error("Failed to load local projects")}const le=localStorage.getItem("nozesia_settings");if(le)try{const ue=JSON.parse(le);ue.model&&T(ue.model),ue.apiKey&&E(ue.apiKey)}catch{console.error("Failed to load settings")}},[]);const A=()=>{const Y=_.trim(),le=y.trim();localStorage.setItem("nozesia_settings",JSON.stringify({model:Y,apiKey:le})),m(!1)},b={id:"demo-1",name:"Exemplo: Grandes Felinos",description:"Identifique espcies comuns de grandes felinos.",features:[{id:"f1",name:"Padro da Pelagem",states:[{id:"s1",label:"Listras"},{id:"s2",label:"Manchas"},{id:"s3",label:"Liso"}]},{id:"f2",name:"Habitat",states:[{id:"s4",label:"Selva"},{id:"s5",label:"Savana"}]}],entities:[{id:"e1",name:"Tigre",description:"O maior dos felinos.",imageUrl:"https://picsum.photos/id/237/400/300",links:[],traits:{f1:["s1"],f2:["s4"]}},{id:"e2",name:"Leo",description:"O rei da selva.",imageUrl:"https://picsum.photos/id/1003/400/300",links:[],traits:{f1:["s3"],f2:["s5"]}},{id:"e3",name:"Leopardo",description:"Escalador especialista.",imageUrl:"https://picsum.photos/id/1074/400/300",links:[],traits:{f1:["s2"],f2:["s4","s5"]}}]},D={en:{subtitle:"v2.1 Tropical",tagline:"Biological Identification AI",desc:"Create and share professional matrix identification keys. Powered by Gemini AI for instant taxonomy generation.",createNew:"Create / Edit Key",openSaved:"Open Saved",importJson:"Import Project",demo:"Try Demo",savedProj:"Saved Projects",close:"Close",noSaved:"No saved projects found.",invalid:"Invalid project file.",settings:"Settings",aiModel:"AI Model",apiKey:"Gemini API Key",getKey:"Get Key",save:"Save",apiKeyNotice:"Your API Key is stored locally in your browser and used only to communicate with Google.",help:"About & Help",helpContent:{intro:"NOZES is an intelligent platform for creating and using matrix identification keys, designed for biologists, students, and nature enthusiasts.",step1Title:"1. Nozes AI Wizard",step1Desc:"Use the 'Nuts AI' button in the builder to automatically generate a key. You can describe a topic (e.g., 'Brazilian Cerrado Trees') OR upload a PDF/Image reference. The AI will study the material and create species, features, and the scoring matrix for you.",step2Title:"2. The Builder",step2Desc:"Refine your key manually. You can add new features, upload images for species, and adjust the matrix relationships between taxa and traits. Use the 'Export Project' button to save your work as a JSON file, which is essential for backups.",step3Title:"3. The Player",step3Desc:"This is the end-user view. Select observed features to filter down the list of species until you identify your specimen.",importExportTitle:"4. Import & Export",importExportDesc:"Always save your work by clicking 'Export Project'. This downloads a .json file. To resume work later or on another device, use 'Import Project' and select that file. You can also export to Excel (XLSX) for spreadsheets."}},pt:{subtitle:"v2.1 Tropical",tagline:"Inteligncia para Identificao Biolgica",desc:"Crie e compartilhe chaves de identificao matriciais profissionais. Poder da Gemini AI para gerao instantnea de taxonomia.",createNew:"Criar / Editar Chave",openSaved:"Abrir Chave",importJson:"Importar Projeto",demo:"Ver Demo",savedProj:"Projetos Salvos",close:"Fechar",noSaved:"Nenhum projeto salvo.",invalid:"Arquivo invlido.",settings:"Configuraes",aiModel:"Modelo IA",apiKey:"Chave API Gemini",getKey:"Obter Chave",save:"Salvar",apiKeyNotice:"Sua API Key  salva localmente no navegador e usada apenas para comunicar com o Google.",help:"Sobre e Ajuda",helpContent:{intro:"O NOZES  uma plataforma inteligente para criao e uso de chaves de identificao matriciais, projetada para bilogos, estudantes e entusiastas da natureza.",step1Title:"1. Assistente Nozes IA",step1Desc:"Use o boto 'Nozes IA' no construtor para gerar uma chave automaticamente. Voc pode descrever um tpico (ex: 'rvores do Cerrado') OU fazer upload de um PDF/Imagem de referncia. A IA estudar o material e criar espcies, caractersticas e a matriz para voc.",step2Title:"2. O Construtor",step2Desc:"Refine sua chave manualmente. Adicione novas caractersticas, insira imagens e ajuste a matriz. Use o boto 'Exportar Projeto' para salvar seu trabalho em arquivo JSON (backup essencial).",step3Title:"3. O Player",step3Desc:"Esta  a viso do usurio final. Selecione as caractersticas observadas para filtrar a lista de espcies at identificar seu espcime.",importExportTitle:"4. Importar & Exportar",importExportDesc:"Sempre salve seu trabalho clicando em 'Exportar Projeto'. Isso baixa um arquivo .json. Para continuar depois ou em outro dispositivo, use 'Importar Projeto' e selecione esse arquivo. Voc tambm pode exportar para Excel (XLSX)."}}}[i],C=()=>{t("BUILDER")},L=()=>{r(b),t("PLAYER")},P=Y=>{const le=localStorage.getItem("nozesia_projects");let ue=[];if(le)try{ue=JSON.parse(le)}catch(Ne){console.error("Failed to parse projects",Ne)}const _e=[Y,...ue.filter(Ne=>Ne.id!==Y.id)];localStorage.setItem("nozesia_projects",JSON.stringify(_e)),a(_e),r(Y),t("PLAYER")},U=Y=>{r(Y),t("PLAYER"),u(!1)},W=Y=>{const le=new FileReader;Y.target.files&&Y.target.files[0]&&(le.readAsText(Y.target.files[0],"UTF-8"),le.onload=ue=>{var _e;try{const Ne=JSON.parse((_e=ue.target)==null?void 0:_e.result);Ne.name&&Ne.features&&Ne.entities?(r(Ne),t("PLAYER")):alert(D.invalid)}catch{alert(D.invalid)}})},V=()=>d&&p.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:p.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[p.jsx(zu,{className:"text-emerald-600",size:20}),D.settings]}),p.jsx("button",{onClick:()=>m(!1),className:"text-slate-400 hover:text-slate-600 p-2",children:p.jsx(wn,{size:24})})]}),p.jsxs("div",{className:"space-y-4 mb-6",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"flex justify-between items-center mb-2",children:[p.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:D.apiKey}),p.jsxs("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-xs font-medium text-emerald-600 hover:text-emerald-700 hover:underline flex items-center gap-1",children:[D.getKey," ",p.jsx(xl,{size:12})]})]}),p.jsxs("div",{className:"relative",children:[p.jsx(J0,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),p.jsx("input",{type:"password",value:y,onChange:Y=>E(Y.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none",placeholder:"AIzaSy..."})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:D.aiModel}),p.jsx("input",{value:_,onChange:Y=>T(Y.target.value),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none",placeholder:"gemini-2.5-flash"}),p.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Default: gemini-2.5-flash"})]}),p.jsx("div",{className:"bg-amber-50 p-3 rounded-lg border border-amber-100",children:p.jsx("p",{className:"text-xs text-amber-700",children:D.apiKeyNotice})})]}),p.jsxs("button",{onClick:A,className:"w-full py-3 bg-emerald-600 text-white rounded-xl font-bold hover:bg-emerald-500 transition-colors flex items-center justify-center gap-2",children:[p.jsx(uo,{size:16})," ",D.save]})]})});return e==="PLAYER"&&n?p.jsxs(p.Fragment,{children:[p.jsx(II,{project:n,onBack:()=>t("HOME"),language:i,onOpenSaved:()=>u(!0),onEditKey:()=>t("BUILDER")}),V()]}):e==="BUILDER"?p.jsxs(p.Fragment,{children:[p.jsx(oM,{initialProject:n,onSave:P,onCancel:()=>t("HOME"),language:i,defaultModel:_,apiKey:y,onOpenSettings:()=>m(!0)}),V()]}):p.jsxs("div",{className:"min-h-screen bg-[#0f2e24] flex items-center justify-center p-4 md:p-6 relative overflow-hidden font-sans",children:[p.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden pointer-events-none",children:[p.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[400px] md:w-[600px] h-[400px] md:h-[600px] bg-emerald-600/20 rounded-full blur-[80px] md:blur-[120px]"}),p.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[300px] md:w-[500px] h-[300px] md:h-[500px] bg-teal-500/20 rounded-full blur-[80px] md:blur-[100px]"}),p.jsx(K0,{className:"absolute top-[10%] right-[15%] text-emerald-800/20 w-20 h-20 md:w-32 md:h-32 rotate-12"}),p.jsx(LE,{className:"absolute bottom-[20%] left-[10%] text-emerald-800/20 w-32 h-32 md:w-48 md:h-48 -rotate-12"})]}),p.jsxs("div",{className:"max-w-6xl w-full grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12 items-center z-10",children:[p.jsxs("div",{className:"text-white space-y-6 md:space-y-8",children:[p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsx("div",{className:"inline-flex items-center gap-2 bg-emerald-900/50 text-emerald-300 px-3 py-1 rounded-full text-[10px] md:text-xs font-semibold tracking-wider uppercase border border-emerald-500/30 backdrop-blur-sm",children:D.subtitle}),p.jsxs("div",{className:"flex gap-2",children:[p.jsxs("div",{className:"flex bg-emerald-900/50 rounded-lg p-1 border border-emerald-500/30 backdrop-blur-sm",children:[p.jsx("button",{onClick:()=>s("pt"),className:`px-3 py-1 rounded text-xs font-bold transition-colors ${i==="pt"?"bg-emerald-500 text-white":"text-emerald-400 hover:text-white"}`,children:"PT"}),p.jsx("button",{onClick:()=>s("en"),className:`px-3 py-1 rounded text-xs font-bold transition-colors ${i==="en"?"bg-emerald-500 text-white":"text-emerald-400 hover:text-white"}`,children:"EN"})]}),p.jsx("button",{onClick:()=>g(!0),className:"bg-emerald-900/50 rounded-lg p-1.5 border border-emerald-500/30 backdrop-blur-sm text-emerald-400 hover:text-white hover:bg-emerald-800/50 transition-colors",title:D.help,children:p.jsx(wE,{size:20})}),p.jsx("button",{onClick:()=>m(!0),className:`bg-emerald-900/50 rounded-lg p-1.5 border backdrop-blur-sm transition-colors ${y?"border-emerald-500/30 text-emerald-400 hover:text-white hover:bg-emerald-800/50":"border-amber-500 text-amber-500 animate-pulse"}`,title:D.settings,children:p.jsx(zu,{size:20})})]})]}),p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center gap-3 md:gap-4 mb-2",children:[p.jsx("div",{className:"bg-amber-800/20 p-2 md:p-3 rounded-2xl border-2 border-amber-600/30 backdrop-blur-md shadow-[0_0_30px_rgba(217,119,6,0.2)]",children:p.jsx(lo,{className:"text-amber-500 w-12 h-12 md:w-20 md:h-20",strokeWidth:1.5})}),p.jsx("h1",{className:"text-5xl md:text-7xl font-black tracking-tight leading-none text-transparent bg-clip-text bg-gradient-to-br from-amber-300 via-amber-500 to-orange-400 drop-shadow-sm",children:"NOZES"})]}),p.jsx("h2",{className:"text-lg md:text-2xl text-emerald-100/80 font-light pl-2",children:D.tagline})]}),p.jsx("p",{className:"text-slate-300 text-base md:text-lg leading-relaxed max-w-lg border-l-4 border-amber-500/50 pl-4 md:pl-6",children:D.desc}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 md:gap-4 pt-2",children:[p.jsxs("button",{onClick:C,className:"col-span-1 sm:col-span-2 flex items-center justify-center gap-3 px-8 py-4 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white rounded-xl font-bold transition-all shadow-xl shadow-emerald-900/50 hover:scale-[1.02] text-lg border-t border-emerald-400/20 active:scale-95",children:[p.jsx($0,{className:"w-5 h-5"}),D.createNew]}),p.jsxs("button",{onClick:()=>u(!0),className:"flex items-center justify-center gap-2 px-6 py-3 bg-emerald-900/40 hover:bg-emerald-800/40 text-emerald-100 rounded-xl font-medium transition-all border border-emerald-500/20 hover:border-emerald-500/50 backdrop-blur-sm active:scale-95",children:[p.jsx(Zi,{className:"w-4 h-4"}),D.openSaved]}),p.jsxs("label",{className:"flex items-center justify-center gap-2 px-6 py-3 bg-emerald-900/40 hover:bg-emerald-800/40 text-emerald-100 rounded-xl font-medium transition-all border border-emerald-500/20 hover:border-emerald-500/50 backdrop-blur-sm cursor-pointer active:scale-95",children:[p.jsx(Ri,{className:"w-4 h-4"}),D.importJson,p.jsx("input",{type:"file",accept:".json",onChange:W,className:"hidden"})]}),p.jsxs("button",{onClick:L,className:"col-span-1 sm:col-span-2 mt-2 text-sm text-emerald-400 hover:text-emerald-200 flex items-center justify-center gap-2 font-medium py-2",children:[p.jsx(jc,{className:"w-3 h-3"}),D.demo]})]})]}),p.jsx("div",{className:"relative hidden lg:block transform perspective-1000 hover:rotate-y-2 transition-transform duration-700",children:p.jsxs("div",{className:"relative bg-gradient-to-br from-emerald-900/80 to-teal-900/80 backdrop-blur-md border border-emerald-500/20 p-8 rounded-3xl shadow-2xl",children:[p.jsx("div",{className:"absolute -top-10 -right-10 text-emerald-400/10",children:p.jsx(IE,{size:200})}),p.jsxs("div",{className:"flex items-center gap-3 mb-8 border-b border-emerald-500/20 pb-6",children:[p.jsx("div",{className:"w-3 h-3 rounded-full bg-red-400/80"}),p.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-400/80"}),p.jsx("div",{className:"w-3 h-3 rounded-full bg-green-400/80"}),p.jsx("div",{className:"ml-auto text-xs text-amber-500/80 font-mono tracking-widest font-bold",children:"NOZES.IA-v2"})]}),p.jsx("div",{className:"space-y-6 opacity-90",children:p.jsxs("div",{className:"flex gap-6",children:[p.jsxs("div",{className:"w-1/3 space-y-3",children:[p.jsx("div",{className:"h-2 bg-emerald-700/50 rounded w-1/2 mb-4"}),p.jsxs("div",{className:"h-10 bg-emerald-500/20 border-l-2 border-emerald-400 rounded-r flex items-center px-3 text-emerald-200 text-xs gap-2",children:[p.jsx(K0,{size:12})," Folhas"]}),p.jsx("div",{className:"h-10 bg-emerald-900/30 rounded flex items-center px-3 text-emerald-600/50 text-xs",children:"Flores"}),p.jsx("div",{className:"h-10 bg-emerald-900/30 rounded flex items-center px-3 text-emerald-600/50 text-xs",children:"Caule"})]}),p.jsx("div",{className:"w-2/3 grid grid-cols-2 gap-3",children:[1,2,3,4].map(Y=>p.jsxs("div",{className:"bg-emerald-950/50 rounded-lg p-3 border border-emerald-500/10 flex flex-col gap-2",children:[p.jsx("div",{className:"aspect-video bg-emerald-900/50 rounded flex items-center justify-center",children:p.jsx(yE,{className:"text-emerald-700/50",size:20})}),p.jsx("div",{className:"h-1.5 bg-emerald-800/50 rounded w-3/4"}),p.jsx("div",{className:"h-1.5 bg-emerald-800/30 rounded w-1/2"})]},Y))})]})}),p.jsxs("div",{className:"mt-8 pt-6 border-t border-emerald-500/20 flex justify-between items-center text-emerald-400/40 text-xs",children:[p.jsx("span",{children:"Gemini 2.5 Flash Integrated"}),p.jsx("span",{children:"100% Client-Side"})]})]})})]}),d&&p.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:p.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[p.jsx(zu,{className:"text-emerald-600",size:20}),D.settings]}),p.jsx("button",{onClick:()=>m(!1),className:"text-slate-400 hover:text-slate-600 p-2",children:p.jsx(wn,{size:24})})]}),p.jsxs("div",{className:"space-y-4 mb-6",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"flex justify-between items-center mb-2",children:[p.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:D.apiKey}),p.jsxs("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-xs font-medium text-emerald-600 hover:text-emerald-700 hover:underline flex items-center gap-1",children:[D.getKey," ",p.jsx(xl,{size:12})]})]}),p.jsxs("div",{className:"relative",children:[p.jsx(J0,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),p.jsx("input",{type:"password",value:y,onChange:Y=>E(Y.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none",placeholder:"AIzaSy..."})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:D.aiModel}),p.jsx("input",{value:_,onChange:Y=>T(Y.target.value),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none",placeholder:"gemini-2.5-flash"}),p.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Default: gemini-2.5-flash"})]}),p.jsx("div",{className:"bg-amber-50 p-3 rounded-lg border border-amber-100",children:p.jsx("p",{className:"text-xs text-amber-700",children:D.apiKeyNotice})})]}),p.jsxs("button",{onClick:A,className:"w-full py-3 bg-emerald-600 text-white rounded-xl font-bold hover:bg-emerald-500 transition-colors flex items-center justify-center gap-2",children:[p.jsx(uo,{size:16})," ",D.save]})]})}),h&&p.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:p.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-0 overflow-hidden animate-in fade-in zoom-in-95 flex flex-col max-h-[85vh]",children:[p.jsxs("div",{className:"p-4 md:p-6 border-b flex justify-between items-center bg-slate-50",children:[p.jsxs("div",{className:"flex gap-4 items-center",children:[p.jsxs("h3",{className:"text-lg md:text-xl font-bold text-slate-800 flex items-center gap-2",children:[p.jsx(w1,{className:"text-emerald-600",size:24}),D.help]}),p.jsxs("div",{className:"flex bg-slate-200/50 p-1 rounded-lg",children:[p.jsx("button",{onClick:()=>x("ABOUT"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${v==="ABOUT"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Sobre"}),p.jsx("button",{onClick:()=>x("HELP"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${v==="HELP"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Ajuda"})]})]}),p.jsx("button",{onClick:()=>g(!1),className:"text-slate-400 hover:text-slate-600 p-2",children:p.jsx(wn,{size:24})})]}),p.jsx("div",{className:"p-4 md:p-6 overflow-y-auto custom-scrollbar space-y-6 md:space-y-8",children:v==="ABOUT"?p.jsxs(p.Fragment,{children:[p.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:" Sobre o Criador"}),p.jsxs("div",{className:"creator-info space-y-4 text-slate-700",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-xl font-semibold text-emerald-700",children:"Diogo Bueno Kanoute"}),p.jsx("p",{className:"font-medium",children:"Parabotnico e Dendrlogo em Inventrio Florestal"}),p.jsx("p",{className:"text-sm md:text-base mt-2",children:"Desenvolvedor especializado em Tecnologias de Inteligncia Artificial e Banco de Dados para Inventrio Florestal, Ecologia, Botnica, Dendrometria e Dendrologia."})]}),p.jsx("h4",{className:"text-lg font-bold text-slate-800 mt-8 border-t pt-4",children:" Links e Contatos"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[p.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:"Identificao Botnica"}),p.jsx("a",{href:"https://go.hotmart.com/G103222293V",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"Curso Online na Hotmart"})]}),p.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[p.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" Fototeca DBK no SPLink"}),p.jsx("a",{href:"https://specieslink.net/col/FDBK",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"specieslink.net/col/FDBK"})]}),p.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[p.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" Instagram Cientfico"}),p.jsx("a",{href:"https://instagram.com/fotografandomato",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"@fotografandomato"})]}),p.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[p.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" Biblioteca Botnica"}),p.jsx("a",{href:"https://drive.google.com/drive/folders/0B4wGMi_KVTvOWm51UzNnNVJjaEk?resourcekey=0-8e69zvcLn2zMXuphNmC56A&usp=drive_link",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"PDFs e Material de Referncia"})]}),p.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[p.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" E-mail"}),p.jsx("a",{href:"mailto:diogokanoute@gmail.com",className:"text-emerald-600 hover:underline font-medium",children:"diogokanoute@gmail.com"})]}),p.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[p.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" WhatsApp Cientfico"}),p.jsx("a",{href:"https://wa.me/5521998501623",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"+55 21 998501623"})]})]}),p.jsx("p",{className:"text-sm text-slate-500 italic mt-6 bg-amber-50 p-4 rounded-lg border border-amber-100",children:"Entre em contato para dvidas sobre o app, cursos de Identificao Botnica, tecnologias de IA aplicadas  Dendrologia ou servios de Inventrio Florestal (Mata Atlntica, Cerrado, Amaznia e Caatinga)."})]})]}):p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"bg-emerald-50 p-4 rounded-xl border border-emerald-100 text-slate-700 leading-relaxed text-sm md:text-base",children:D.helpContent.intro}),p.jsxs("div",{className:"grid gap-6",children:[p.jsxs("div",{className:"flex gap-4",children:[p.jsx("div",{className:"bg-amber-100 p-3 rounded-full h-fit text-amber-600 shrink-0",children:p.jsx(lo,{size:24})}),p.jsxs("div",{children:[p.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:D.helpContent.step1Title}),p.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:D.helpContent.step1Desc})]})]}),p.jsxs("div",{className:"flex gap-4",children:[p.jsx("div",{className:"bg-blue-100 p-3 rounded-full h-fit text-blue-600 shrink-0",children:p.jsx($0,{size:24})}),p.jsxs("div",{children:[p.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:D.helpContent.step2Title}),p.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:D.helpContent.step2Desc})]})]}),p.jsxs("div",{className:"flex gap-4",children:[p.jsx("div",{className:"bg-emerald-100 p-3 rounded-full h-fit text-emerald-600 shrink-0",children:p.jsx(jc,{size:24})}),p.jsxs("div",{children:[p.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:D.helpContent.step3Title}),p.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:D.helpContent.step3Desc})]})]}),p.jsxs("div",{className:"flex gap-4",children:[p.jsx("div",{className:"bg-purple-100 p-3 rounded-full h-fit text-purple-600 shrink-0",children:p.jsx(uo,{size:24})}),p.jsxs("div",{children:[p.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:D.helpContent.importExportTitle}),p.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:D.helpContent.importExportDesc})]})]})]})]})}),p.jsx("div",{className:"p-4 bg-slate-50 border-t",children:p.jsx("button",{onClick:()=>g(!1),className:"w-full py-3 bg-emerald-600 text-white rounded-xl font-bold hover:bg-emerald-500 transition-colors",children:D.close})})]})}),l&&p.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:p.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[p.jsx(Zi,{className:"text-emerald-600",size:20}),D.openSaved]}),p.jsx("button",{onClick:()=>u(!1),className:"text-slate-400 hover:text-slate-600 p-1",children:p.jsx(wn,{size:20})})]}),p.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto mb-4 custom-scrollbar",children:o.length===0?p.jsx("p",{className:"text-slate-500 text-sm text-center py-8 border-2 border-dashed border-slate-200 rounded-lg",children:D.noSaved}):o.map(Y=>p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs("button",{onClick:()=>U(Y),className:"flex-1 text-left p-3 hover:bg-emerald-50 rounded-lg border border-slate-100 hover:border-emerald-200 group transition-all",children:[p.jsx("div",{className:"font-medium text-slate-800 group-hover:text-emerald-700",children:Y.name}),p.jsx("div",{className:"text-xs text-slate-400 truncate",children:Y.description||"No description"})]}),p.jsx("button",{onClick:le=>{if(le.stopPropagation(),confirm(i==="pt"?`Excluir "${Y.name}"?`:`Delete "${Y.name}"?`)){const ue=o.filter(_e=>_e.id!==Y.id);a(ue),localStorage.setItem("nozesia_projects",JSON.stringify(ue))}},className:"p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors shrink-0",title:i==="pt"?"Excluir":"Delete",children:p.jsx(Wa,{size:18})})]},Y.id))}),p.jsx("button",{onClick:()=>u(!1),className:"w-full py-3 bg-slate-100 text-slate-600 rounded-xl font-medium hover:bg-slate-200 transition-colors",children:D.close})]})})]})},Bv=document.getElementById("root");if(!Bv)throw new Error("Could not find root element to mount to");const lM=ec.createRoot(Bv);lM.render(p.jsx(ym.StrictMode,{children:p.jsx(aM,{})}));

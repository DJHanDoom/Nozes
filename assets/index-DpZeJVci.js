(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Jv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var pm={exports:{}},Dl={},mm={exports:{}},Re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mo=Symbol.for("react.element"),Kv=Symbol.for("react.portal"),Yv=Symbol.for("react.fragment"),Xv=Symbol.for("react.strict_mode"),Qv=Symbol.for("react.profiler"),Zv=Symbol.for("react.provider"),ey=Symbol.for("react.context"),ty=Symbol.for("react.forward_ref"),ny=Symbol.for("react.suspense"),ry=Symbol.for("react.memo"),iy=Symbol.for("react.lazy"),Ld=Symbol.iterator;function sy(e){return e===null||typeof e!="object"?null:(e=Ld&&e[Ld]||e["@@iterator"],typeof e=="function"?e:null)}var gm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xm=Object.assign,vm={};function hs(e,t,n){this.props=e,this.context=t,this.refs=vm,this.updater=n||gm}hs.prototype.isReactComponent={};hs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};hs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function ym(){}ym.prototype=hs.prototype;function df(e,t,n){this.props=e,this.context=t,this.refs=vm,this.updater=n||gm}var hf=df.prototype=new ym;hf.constructor=df;xm(hf,hs.prototype);hf.isPureReactComponent=!0;var Od=Array.isArray,Em=Object.prototype.hasOwnProperty,pf={current:null},Tm={key:!0,ref:!0,__self:!0,__source:!0};function _m(e,t,n){var r,i={},s=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)Em.call(t,r)&&!Tm.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Mo,type:e,key:s,ref:o,props:i,_owner:pf.current}}function oy(e,t){return{$$typeof:Mo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function mf(e){return typeof e=="object"&&e!==null&&e.$$typeof===Mo}function ay(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Ud=/\/+/g;function xu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?ay(""+e.key):t.toString(36)}function Aa(e,t,n,r,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Mo:case Kv:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+xu(o,0):r,Od(i)?(n="",e!=null&&(n=e.replace(Ud,"$&/")+"/"),Aa(i,t,n,"",function(u){return u})):i!=null&&(mf(i)&&(i=oy(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Ud,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",Od(e))for(var a=0;a<e.length;a++){s=e[a];var l=r+xu(s,a);o+=Aa(s,t,n,l,i)}else if(l=sy(e),typeof l=="function")for(e=l.call(e),a=0;!(s=e.next()).done;)s=s.value,l=r+xu(s,a++),o+=Aa(s,t,n,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Zo(e,t,n){if(e==null)return e;var r=[],i=0;return Aa(e,r,"","",function(s){return t.call(n,s,i++)}),r}function ly(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var jt={current:null},Na={transition:null},uy={ReactCurrentDispatcher:jt,ReactCurrentBatchConfig:Na,ReactCurrentOwner:pf};function Sm(){throw Error("act(...) is not supported in production builds of React.")}Re.Children={map:Zo,forEach:function(e,t,n){Zo(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Zo(e,function(){t++}),t},toArray:function(e){return Zo(e,function(t){return t})||[]},only:function(e){if(!mf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Re.Component=hs;Re.Fragment=Yv;Re.Profiler=Qv;Re.PureComponent=df;Re.StrictMode=Xv;Re.Suspense=ny;Re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uy;Re.act=Sm;Re.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=xm({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=pf.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)Em.call(t,l)&&!Tm.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Mo,type:e.type,key:i,ref:s,props:r,_owner:o}};Re.createContext=function(e){return e={$$typeof:ey,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Zv,_context:e},e.Consumer=e};Re.createElement=_m;Re.createFactory=function(e){var t=_m.bind(null,e);return t.type=e,t};Re.createRef=function(){return{current:null}};Re.forwardRef=function(e){return{$$typeof:ty,render:e}};Re.isValidElement=mf;Re.lazy=function(e){return{$$typeof:iy,_payload:{_status:-1,_result:e},_init:ly}};Re.memo=function(e,t){return{$$typeof:ry,type:e,compare:t===void 0?null:t}};Re.startTransition=function(e){var t=Na.transition;Na.transition={};try{e()}finally{Na.transition=t}};Re.unstable_act=Sm;Re.useCallback=function(e,t){return jt.current.useCallback(e,t)};Re.useContext=function(e){return jt.current.useContext(e)};Re.useDebugValue=function(){};Re.useDeferredValue=function(e){return jt.current.useDeferredValue(e)};Re.useEffect=function(e,t){return jt.current.useEffect(e,t)};Re.useId=function(){return jt.current.useId()};Re.useImperativeHandle=function(e,t,n){return jt.current.useImperativeHandle(e,t,n)};Re.useInsertionEffect=function(e,t){return jt.current.useInsertionEffect(e,t)};Re.useLayoutEffect=function(e,t){return jt.current.useLayoutEffect(e,t)};Re.useMemo=function(e,t){return jt.current.useMemo(e,t)};Re.useReducer=function(e,t,n){return jt.current.useReducer(e,t,n)};Re.useRef=function(e){return jt.current.useRef(e)};Re.useState=function(e){return jt.current.useState(e)};Re.useSyncExternalStore=function(e,t,n){return jt.current.useSyncExternalStore(e,t,n)};Re.useTransition=function(){return jt.current.useTransition()};Re.version="18.3.1";mm.exports=Re;var Te=mm.exports;const Ia=Jv(Te);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cy=Te,fy=Symbol.for("react.element"),dy=Symbol.for("react.fragment"),hy=Object.prototype.hasOwnProperty,py=cy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,my={key:!0,ref:!0,__self:!0,__source:!0};function wm(e,t,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)hy.call(t,r)&&!my.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:fy,type:e,key:s,ref:o,props:i,_owner:py.current}}Dl.Fragment=dy;Dl.jsx=wm;Dl.jsxs=wm;pm.exports=Dl;var h=pm.exports,ec={},Cm={exports:{}},hn={},Am={exports:{}},Nm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ae,z){var se=ae.length;ae.push(z);e:for(;0<se;){var ye=se-1>>>1,L=ae[ye];if(0<i(L,z))ae[ye]=z,ae[se]=L,se=ye;else break e}}function n(ae){return ae.length===0?null:ae[0]}function r(ae){if(ae.length===0)return null;var z=ae[0],se=ae.pop();if(se!==z){ae[0]=se;e:for(var ye=0,L=ae.length,W=L>>>1;ye<W;){var H=2*(ye+1)-1,V=ae[H],ne=H+1,ce=ae[ne];if(0>i(V,se))ne<L&&0>i(ce,V)?(ae[ye]=ce,ae[ne]=se,ye=ne):(ae[ye]=V,ae[H]=se,ye=H);else if(ne<L&&0>i(ce,se))ae[ye]=ce,ae[ne]=se,ye=ne;else break e}}return z}function i(ae,z){var se=ae.sortIndex-z.sortIndex;return se!==0?se:ae.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,p=null,m=3,g=!1,y=!1,x=!1,S=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(ae){for(var z=n(u);z!==null;){if(z.callback===null)r(u);else if(z.startTime<=ae)r(u),z.sortIndex=z.expirationTime,t(l,z);else break;z=n(u)}}function N(ae){if(x=!1,_(ae),!y)if(n(l)!==null)y=!0,Ne(B);else{var z=n(u);z!==null&&ge(N,z.startTime-ae)}}function B(ae,z){y=!1,x&&(x=!1,T(D),D=-1),g=!0;var se=m;try{for(_(z),p=n(l);p!==null&&(!(p.expirationTime>z)||ae&&!J());){var ye=p.callback;if(typeof ye=="function"){p.callback=null,m=p.priorityLevel;var L=ye(p.expirationTime<=z);z=e.unstable_now(),typeof L=="function"?p.callback=L:p===n(l)&&r(l),_(z)}else r(l);p=n(l)}if(p!==null)var W=!0;else{var H=n(u);H!==null&&ge(N,H.startTime-z),W=!1}return W}finally{p=null,m=se,g=!1}}var G=!1,k=null,D=-1,b=5,O=-1;function J(){return!(e.unstable_now()-O<b)}function X(){if(k!==null){var ae=e.unstable_now();O=ae;var z=!0;try{z=k(!0,ae)}finally{z?re():(G=!1,k=null)}}else G=!1}var re;if(typeof E=="function")re=function(){E(X)};else if(typeof MessageChannel<"u"){var we=new MessageChannel,_e=we.port2;we.port1.onmessage=X,re=function(){_e.postMessage(null)}}else re=function(){S(X,0)};function Ne(ae){k=ae,G||(G=!0,re())}function ge(ae,z){D=S(function(){ae(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ae){ae.callback=null},e.unstable_continueExecution=function(){y||g||(y=!0,Ne(B))},e.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<ae?Math.floor(1e3/ae):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(ae){switch(m){case 1:case 2:case 3:var z=3;break;default:z=m}var se=m;m=z;try{return ae()}finally{m=se}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ae,z){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var se=m;m=ae;try{return z()}finally{m=se}},e.unstable_scheduleCallback=function(ae,z,se){var ye=e.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?ye+se:ye):se=ye,ae){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=se+L,ae={id:c++,callback:z,priorityLevel:ae,startTime:se,expirationTime:L,sortIndex:-1},se>ye?(ae.sortIndex=se,t(u,ae),n(l)===null&&ae===n(u)&&(x?(T(D),D=-1):x=!0,ge(N,se-ye))):(ae.sortIndex=L,t(l,ae),y||g||(y=!0,Ne(B))),ae},e.unstable_shouldYield=J,e.unstable_wrapCallback=function(ae){var z=m;return function(){var se=m;m=z;try{return ae.apply(this,arguments)}finally{m=se}}}})(Nm);Am.exports=Nm;var gy=Am.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xy=Te,fn=gy;function oe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Im=new Set,lo={};function pi(e,t){ss(e,t),ss(e+"Capture",t)}function ss(e,t){for(lo[e]=t,e=0;e<t.length;e++)Im.add(t[e])}var ur=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tc=Object.prototype.hasOwnProperty,vy=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bd={},Gd={};function yy(e){return tc.call(Gd,e)?!0:tc.call(Bd,e)?!1:vy.test(e)?Gd[e]=!0:(Bd[e]=!0,!1)}function Ey(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Ty(e,t,n,r){if(t===null||typeof t>"u"||Ey(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Wt(e,t,n,r,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var It={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){It[e]=new Wt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];It[t]=new Wt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){It[e]=new Wt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){It[e]=new Wt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){It[e]=new Wt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){It[e]=new Wt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){It[e]=new Wt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){It[e]=new Wt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){It[e]=new Wt(e,5,!1,e.toLowerCase(),null,!1,!1)});var gf=/[\-:]([a-z])/g;function xf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(gf,xf);It[t]=new Wt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(gf,xf);It[t]=new Wt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(gf,xf);It[t]=new Wt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){It[e]=new Wt(e,1,!1,e.toLowerCase(),null,!1,!1)});It.xlinkHref=new Wt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){It[e]=new Wt(e,1,!1,e.toLowerCase(),null,!0,!0)});function vf(e,t,n,r){var i=It.hasOwnProperty(t)?It[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Ty(t,n,i,r)&&(n=null),r||i===null?yy(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var gr=xy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ea=Symbol.for("react.element"),ki=Symbol.for("react.portal"),Ri=Symbol.for("react.fragment"),yf=Symbol.for("react.strict_mode"),nc=Symbol.for("react.profiler"),km=Symbol.for("react.provider"),Rm=Symbol.for("react.context"),Ef=Symbol.for("react.forward_ref"),rc=Symbol.for("react.suspense"),ic=Symbol.for("react.suspense_list"),Tf=Symbol.for("react.memo"),Cr=Symbol.for("react.lazy"),Pm=Symbol.for("react.offscreen"),Vd=Symbol.iterator;function Rs(e){return e===null||typeof e!="object"?null:(e=Vd&&e[Vd]||e["@@iterator"],typeof e=="function"?e:null)}var nt=Object.assign,vu;function Vs(e){if(vu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);vu=t&&t[1]||""}return`
`+vu+e}var yu=!1;function Eu(e,t){if(!e||yu)return"";yu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=a);break}}}finally{yu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Vs(e):""}function _y(e){switch(e.tag){case 5:return Vs(e.type);case 16:return Vs("Lazy");case 13:return Vs("Suspense");case 19:return Vs("SuspenseList");case 0:case 2:case 15:return e=Eu(e.type,!1),e;case 11:return e=Eu(e.type.render,!1),e;case 1:return e=Eu(e.type,!0),e;default:return""}}function sc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ri:return"Fragment";case ki:return"Portal";case nc:return"Profiler";case yf:return"StrictMode";case rc:return"Suspense";case ic:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Rm:return(e.displayName||"Context")+".Consumer";case km:return(e._context.displayName||"Context")+".Provider";case Ef:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Tf:return t=e.displayName||null,t!==null?t:sc(e.type)||"Memo";case Cr:t=e._payload,e=e._init;try{return sc(e(t))}catch{}}return null}function Sy(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sc(t);case 8:return t===yf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Vr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Fm(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function wy(e){var t=Fm(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ta(e){e._valueTracker||(e._valueTracker=wy(e))}function Mm(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Fm(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Ha(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function oc(e,t){var n=t.checked;return nt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Hd(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Vr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function bm(e,t){t=t.checked,t!=null&&vf(e,"checked",t,!1)}function ac(e,t){bm(e,t);var n=Vr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?lc(e,t.type,n):t.hasOwnProperty("defaultValue")&&lc(e,t.type,Vr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function $d(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function lc(e,t,n){(t!=="number"||Ha(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Hs=Array.isArray;function zi(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Vr(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function uc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(oe(91));return nt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function zd(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(oe(92));if(Hs(n)){if(1<n.length)throw Error(oe(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Vr(n)}}function Dm(e,t){var n=Vr(t.value),r=Vr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function jd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Lm(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Lm(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var na,Om=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(na=na||document.createElement("div"),na.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=na.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function uo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Ws={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Cy=["Webkit","ms","Moz","O"];Object.keys(Ws).forEach(function(e){Cy.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ws[t]=Ws[e]})});function Um(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Ws.hasOwnProperty(e)&&Ws[e]?(""+t).trim():t+"px"}function Bm(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Um(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var Ay=nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fc(e,t){if(t){if(Ay[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(oe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(oe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(oe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(oe(62))}}function dc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hc=null;function _f(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var pc=null,ji=null,Wi=null;function Wd(e){if(e=Lo(e)){if(typeof pc!="function")throw Error(oe(280));var t=e.stateNode;t&&(t=Gl(t),pc(e.stateNode,e.type,t))}}function Gm(e){ji?Wi?Wi.push(e):Wi=[e]:ji=e}function Vm(){if(ji){var e=ji,t=Wi;if(Wi=ji=null,Wd(e),t)for(e=0;e<t.length;e++)Wd(t[e])}}function Hm(e,t){return e(t)}function $m(){}var Tu=!1;function zm(e,t,n){if(Tu)return e(t,n);Tu=!0;try{return Hm(e,t,n)}finally{Tu=!1,(ji!==null||Wi!==null)&&($m(),Vm())}}function co(e,t){var n=e.stateNode;if(n===null)return null;var r=Gl(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(oe(231,t,typeof n));return n}var mc=!1;if(ur)try{var Ps={};Object.defineProperty(Ps,"passive",{get:function(){mc=!0}}),window.addEventListener("test",Ps,Ps),window.removeEventListener("test",Ps,Ps)}catch{mc=!1}function Ny(e,t,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var qs=!1,$a=null,za=!1,gc=null,Iy={onError:function(e){qs=!0,$a=e}};function ky(e,t,n,r,i,s,o,a,l){qs=!1,$a=null,Ny.apply(Iy,arguments)}function Ry(e,t,n,r,i,s,o,a,l){if(ky.apply(this,arguments),qs){if(qs){var u=$a;qs=!1,$a=null}else throw Error(oe(198));za||(za=!0,gc=u)}}function mi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function jm(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function qd(e){if(mi(e)!==e)throw Error(oe(188))}function Py(e){var t=e.alternate;if(!t){if(t=mi(e),t===null)throw Error(oe(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return qd(i),e;if(s===r)return qd(i),t;s=s.sibling}throw Error(oe(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(oe(189))}}if(n.alternate!==r)throw Error(oe(190))}if(n.tag!==3)throw Error(oe(188));return n.stateNode.current===n?e:t}function Wm(e){return e=Py(e),e!==null?qm(e):null}function qm(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=qm(e);if(t!==null)return t;e=e.sibling}return null}var Jm=fn.unstable_scheduleCallback,Jd=fn.unstable_cancelCallback,Fy=fn.unstable_shouldYield,My=fn.unstable_requestPaint,ot=fn.unstable_now,by=fn.unstable_getCurrentPriorityLevel,Sf=fn.unstable_ImmediatePriority,Km=fn.unstable_UserBlockingPriority,ja=fn.unstable_NormalPriority,Dy=fn.unstable_LowPriority,Ym=fn.unstable_IdlePriority,Ll=null,Yn=null;function Ly(e){if(Yn&&typeof Yn.onCommitFiberRoot=="function")try{Yn.onCommitFiberRoot(Ll,e,void 0,(e.current.flags&128)===128)}catch{}}var Bn=Math.clz32?Math.clz32:By,Oy=Math.log,Uy=Math.LN2;function By(e){return e>>>=0,e===0?32:31-(Oy(e)/Uy|0)|0}var ra=64,ia=4194304;function $s(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Wa(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=$s(a):(s&=o,s!==0&&(r=$s(s)))}else o=n&~i,o!==0?r=$s(o):s!==0&&(r=$s(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Bn(t),i=1<<n,r|=e[n],t&=~i;return r}function Gy(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vy(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Bn(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=Gy(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}function xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Xm(){var e=ra;return ra<<=1,!(ra&4194240)&&(ra=64),e}function _u(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function bo(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Bn(t),e[t]=n}function Hy(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Bn(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}function wf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Bn(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Ve=0;function Qm(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Zm,Cf,eg,tg,ng,vc=!1,sa=[],Mr=null,br=null,Dr=null,fo=new Map,ho=new Map,Nr=[],$y="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Kd(e,t){switch(e){case"focusin":case"focusout":Mr=null;break;case"dragenter":case"dragleave":br=null;break;case"mouseover":case"mouseout":Dr=null;break;case"pointerover":case"pointerout":fo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ho.delete(t.pointerId)}}function Fs(e,t,n,r,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Lo(t),t!==null&&Cf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function zy(e,t,n,r,i){switch(t){case"focusin":return Mr=Fs(Mr,e,t,n,r,i),!0;case"dragenter":return br=Fs(br,e,t,n,r,i),!0;case"mouseover":return Dr=Fs(Dr,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return fo.set(s,Fs(fo.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,ho.set(s,Fs(ho.get(s)||null,e,t,n,r,i)),!0}return!1}function rg(e){var t=ei(e.target);if(t!==null){var n=mi(t);if(n!==null){if(t=n.tag,t===13){if(t=jm(n),t!==null){e.blockedOn=t,ng(e.priority,function(){eg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ka(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=yc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);hc=r,n.target.dispatchEvent(r),hc=null}else return t=Lo(n),t!==null&&Cf(t),e.blockedOn=n,!1;t.shift()}return!0}function Yd(e,t,n){ka(e)&&n.delete(t)}function jy(){vc=!1,Mr!==null&&ka(Mr)&&(Mr=null),br!==null&&ka(br)&&(br=null),Dr!==null&&ka(Dr)&&(Dr=null),fo.forEach(Yd),ho.forEach(Yd)}function Ms(e,t){e.blockedOn===t&&(e.blockedOn=null,vc||(vc=!0,fn.unstable_scheduleCallback(fn.unstable_NormalPriority,jy)))}function po(e){function t(i){return Ms(i,e)}if(0<sa.length){Ms(sa[0],e);for(var n=1;n<sa.length;n++){var r=sa[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Mr!==null&&Ms(Mr,e),br!==null&&Ms(br,e),Dr!==null&&Ms(Dr,e),fo.forEach(t),ho.forEach(t),n=0;n<Nr.length;n++)r=Nr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Nr.length&&(n=Nr[0],n.blockedOn===null);)rg(n),n.blockedOn===null&&Nr.shift()}var qi=gr.ReactCurrentBatchConfig,qa=!0;function Wy(e,t,n,r){var i=Ve,s=qi.transition;qi.transition=null;try{Ve=1,Af(e,t,n,r)}finally{Ve=i,qi.transition=s}}function qy(e,t,n,r){var i=Ve,s=qi.transition;qi.transition=null;try{Ve=4,Af(e,t,n,r)}finally{Ve=i,qi.transition=s}}function Af(e,t,n,r){if(qa){var i=yc(e,t,n,r);if(i===null)Fu(e,t,r,Ja,n),Kd(e,r);else if(zy(i,e,t,n,r))r.stopPropagation();else if(Kd(e,r),t&4&&-1<$y.indexOf(e)){for(;i!==null;){var s=Lo(i);if(s!==null&&Zm(s),s=yc(e,t,n,r),s===null&&Fu(e,t,r,Ja,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Fu(e,t,r,null,n)}}var Ja=null;function yc(e,t,n,r){if(Ja=null,e=_f(r),e=ei(e),e!==null)if(t=mi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=jm(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ja=e,null}function ig(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(by()){case Sf:return 1;case Km:return 4;case ja:case Dy:return 16;case Ym:return 536870912;default:return 16}default:return 16}}var kr=null,Nf=null,Ra=null;function sg(){if(Ra)return Ra;var e,t=Nf,n=t.length,r,i="value"in kr?kr.value:kr.textContent,s=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[s-r];r++);return Ra=i.slice(e,1<r?1-r:void 0)}function Pa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function oa(){return!0}function Xd(){return!1}function pn(e){function t(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?oa:Xd,this.isPropagationStopped=Xd,this}return nt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=oa)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=oa)},persist:function(){},isPersistent:oa}),t}var ps={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},If=pn(ps),Do=nt({},ps,{view:0,detail:0}),Jy=pn(Do),Su,wu,bs,Ol=nt({},Do,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==bs&&(bs&&e.type==="mousemove"?(Su=e.screenX-bs.screenX,wu=e.screenY-bs.screenY):wu=Su=0,bs=e),Su)},movementY:function(e){return"movementY"in e?e.movementY:wu}}),Qd=pn(Ol),Ky=nt({},Ol,{dataTransfer:0}),Yy=pn(Ky),Xy=nt({},Do,{relatedTarget:0}),Cu=pn(Xy),Qy=nt({},ps,{animationName:0,elapsedTime:0,pseudoElement:0}),Zy=pn(Qy),e2=nt({},ps,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),t2=pn(e2),n2=nt({},ps,{data:0}),Zd=pn(n2),r2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},i2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},s2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function o2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=s2[e])?!!t[e]:!1}function kf(){return o2}var a2=nt({},Do,{key:function(e){if(e.key){var t=r2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Pa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?i2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kf,charCode:function(e){return e.type==="keypress"?Pa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Pa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),l2=pn(a2),u2=nt({},Ol,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),e0=pn(u2),c2=nt({},Do,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kf}),f2=pn(c2),d2=nt({},ps,{propertyName:0,elapsedTime:0,pseudoElement:0}),h2=pn(d2),p2=nt({},Ol,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),m2=pn(p2),g2=[9,13,27,32],Rf=ur&&"CompositionEvent"in window,Js=null;ur&&"documentMode"in document&&(Js=document.documentMode);var x2=ur&&"TextEvent"in window&&!Js,og=ur&&(!Rf||Js&&8<Js&&11>=Js),t0=" ",n0=!1;function ag(e,t){switch(e){case"keyup":return g2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Pi=!1;function v2(e,t){switch(e){case"compositionend":return lg(t);case"keypress":return t.which!==32?null:(n0=!0,t0);case"textInput":return e=t.data,e===t0&&n0?null:e;default:return null}}function y2(e,t){if(Pi)return e==="compositionend"||!Rf&&ag(e,t)?(e=sg(),Ra=Nf=kr=null,Pi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return og&&t.locale!=="ko"?null:t.data;default:return null}}var E2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function r0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!E2[e.type]:t==="textarea"}function ug(e,t,n,r){Gm(r),t=Ka(t,"onChange"),0<t.length&&(n=new If("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ks=null,mo=null;function T2(e){Eg(e,0)}function Ul(e){var t=bi(e);if(Mm(t))return e}function _2(e,t){if(e==="change")return t}var cg=!1;if(ur){var Au;if(ur){var Nu="oninput"in document;if(!Nu){var i0=document.createElement("div");i0.setAttribute("oninput","return;"),Nu=typeof i0.oninput=="function"}Au=Nu}else Au=!1;cg=Au&&(!document.documentMode||9<document.documentMode)}function s0(){Ks&&(Ks.detachEvent("onpropertychange",fg),mo=Ks=null)}function fg(e){if(e.propertyName==="value"&&Ul(mo)){var t=[];ug(t,mo,e,_f(e)),zm(T2,t)}}function S2(e,t,n){e==="focusin"?(s0(),Ks=t,mo=n,Ks.attachEvent("onpropertychange",fg)):e==="focusout"&&s0()}function w2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ul(mo)}function C2(e,t){if(e==="click")return Ul(t)}function A2(e,t){if(e==="input"||e==="change")return Ul(t)}function N2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Hn=typeof Object.is=="function"?Object.is:N2;function go(e,t){if(Hn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!tc.call(t,i)||!Hn(e[i],t[i]))return!1}return!0}function o0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function a0(e,t){var n=o0(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=o0(n)}}function dg(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?dg(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function hg(){for(var e=window,t=Ha();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ha(e.document)}return t}function Pf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function I2(e){var t=hg(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dg(n.ownerDocument.documentElement,n)){if(r!==null&&Pf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=a0(n,s);var o=a0(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var k2=ur&&"documentMode"in document&&11>=document.documentMode,Fi=null,Ec=null,Ys=null,Tc=!1;function l0(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Tc||Fi==null||Fi!==Ha(r)||(r=Fi,"selectionStart"in r&&Pf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ys&&go(Ys,r)||(Ys=r,r=Ka(Ec,"onSelect"),0<r.length&&(t=new If("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Fi)))}function aa(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Mi={animationend:aa("Animation","AnimationEnd"),animationiteration:aa("Animation","AnimationIteration"),animationstart:aa("Animation","AnimationStart"),transitionend:aa("Transition","TransitionEnd")},Iu={},pg={};ur&&(pg=document.createElement("div").style,"AnimationEvent"in window||(delete Mi.animationend.animation,delete Mi.animationiteration.animation,delete Mi.animationstart.animation),"TransitionEvent"in window||delete Mi.transitionend.transition);function Bl(e){if(Iu[e])return Iu[e];if(!Mi[e])return e;var t=Mi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in pg)return Iu[e]=t[n];return e}var mg=Bl("animationend"),gg=Bl("animationiteration"),xg=Bl("animationstart"),vg=Bl("transitionend"),yg=new Map,u0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Wr(e,t){yg.set(e,t),pi(t,[e])}for(var ku=0;ku<u0.length;ku++){var Ru=u0[ku],R2=Ru.toLowerCase(),P2=Ru[0].toUpperCase()+Ru.slice(1);Wr(R2,"on"+P2)}Wr(mg,"onAnimationEnd");Wr(gg,"onAnimationIteration");Wr(xg,"onAnimationStart");Wr("dblclick","onDoubleClick");Wr("focusin","onFocus");Wr("focusout","onBlur");Wr(vg,"onTransitionEnd");ss("onMouseEnter",["mouseout","mouseover"]);ss("onMouseLeave",["mouseout","mouseover"]);ss("onPointerEnter",["pointerout","pointerover"]);ss("onPointerLeave",["pointerout","pointerover"]);pi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pi("onBeforeInput",["compositionend","keypress","textInput","paste"]);pi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),F2=new Set("cancel close invalid load scroll toggle".split(" ").concat(zs));function c0(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Ry(r,t,void 0,e),e.currentTarget=null}function Eg(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;c0(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;c0(i,a,u),s=l}}}if(za)throw e=gc,za=!1,gc=null,e}function Ke(e,t){var n=t[Ac];n===void 0&&(n=t[Ac]=new Set);var r=e+"__bubble";n.has(r)||(Tg(t,e,2,!1),n.add(r))}function Pu(e,t,n){var r=0;t&&(r|=4),Tg(n,e,r,t)}var la="_reactListening"+Math.random().toString(36).slice(2);function xo(e){if(!e[la]){e[la]=!0,Im.forEach(function(n){n!=="selectionchange"&&(F2.has(n)||Pu(n,!1,e),Pu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[la]||(t[la]=!0,Pu("selectionchange",!1,t))}}function Tg(e,t,n,r){switch(ig(t)){case 1:var i=Wy;break;case 4:i=qy;break;default:i=Af}n=i.bind(null,t,n,e),i=void 0,!mc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Fu(e,t,n,r,i){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=ei(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}zm(function(){var u=s,c=_f(n),p=[];e:{var m=yg.get(e);if(m!==void 0){var g=If,y=e;switch(e){case"keypress":if(Pa(n)===0)break e;case"keydown":case"keyup":g=l2;break;case"focusin":y="focus",g=Cu;break;case"focusout":y="blur",g=Cu;break;case"beforeblur":case"afterblur":g=Cu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Qd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Yy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=f2;break;case mg:case gg:case xg:g=Zy;break;case vg:g=h2;break;case"scroll":g=Jy;break;case"wheel":g=m2;break;case"copy":case"cut":case"paste":g=t2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=e0}var x=(t&4)!==0,S=!x&&e==="scroll",T=x?m!==null?m+"Capture":null:m;x=[];for(var E=u,_;E!==null;){_=E;var N=_.stateNode;if(_.tag===5&&N!==null&&(_=N,T!==null&&(N=co(E,T),N!=null&&x.push(vo(E,N,_)))),S)break;E=E.return}0<x.length&&(m=new g(m,y,null,n,c),p.push({event:m,listeners:x}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",m&&n!==hc&&(y=n.relatedTarget||n.fromElement)&&(ei(y)||y[cr]))break e;if((g||m)&&(m=c.window===c?c:(m=c.ownerDocument)?m.defaultView||m.parentWindow:window,g?(y=n.relatedTarget||n.toElement,g=u,y=y?ei(y):null,y!==null&&(S=mi(y),y!==S||y.tag!==5&&y.tag!==6)&&(y=null)):(g=null,y=u),g!==y)){if(x=Qd,N="onMouseLeave",T="onMouseEnter",E="mouse",(e==="pointerout"||e==="pointerover")&&(x=e0,N="onPointerLeave",T="onPointerEnter",E="pointer"),S=g==null?m:bi(g),_=y==null?m:bi(y),m=new x(N,E+"leave",g,n,c),m.target=S,m.relatedTarget=_,N=null,ei(c)===u&&(x=new x(T,E+"enter",y,n,c),x.target=_,x.relatedTarget=S,N=x),S=N,g&&y)t:{for(x=g,T=y,E=0,_=x;_;_=Si(_))E++;for(_=0,N=T;N;N=Si(N))_++;for(;0<E-_;)x=Si(x),E--;for(;0<_-E;)T=Si(T),_--;for(;E--;){if(x===T||T!==null&&x===T.alternate)break t;x=Si(x),T=Si(T)}x=null}else x=null;g!==null&&f0(p,m,g,x,!1),y!==null&&S!==null&&f0(p,S,y,x,!0)}}e:{if(m=u?bi(u):window,g=m.nodeName&&m.nodeName.toLowerCase(),g==="select"||g==="input"&&m.type==="file")var B=_2;else if(r0(m))if(cg)B=A2;else{B=w2;var G=S2}else(g=m.nodeName)&&g.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(B=C2);if(B&&(B=B(e,u))){ug(p,B,n,c);break e}G&&G(e,m,u),e==="focusout"&&(G=m._wrapperState)&&G.controlled&&m.type==="number"&&lc(m,"number",m.value)}switch(G=u?bi(u):window,e){case"focusin":(r0(G)||G.contentEditable==="true")&&(Fi=G,Ec=u,Ys=null);break;case"focusout":Ys=Ec=Fi=null;break;case"mousedown":Tc=!0;break;case"contextmenu":case"mouseup":case"dragend":Tc=!1,l0(p,n,c);break;case"selectionchange":if(k2)break;case"keydown":case"keyup":l0(p,n,c)}var k;if(Rf)e:{switch(e){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else Pi?ag(e,n)&&(D="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(D="onCompositionStart");D&&(og&&n.locale!=="ko"&&(Pi||D!=="onCompositionStart"?D==="onCompositionEnd"&&Pi&&(k=sg()):(kr=c,Nf="value"in kr?kr.value:kr.textContent,Pi=!0)),G=Ka(u,D),0<G.length&&(D=new Zd(D,e,null,n,c),p.push({event:D,listeners:G}),k?D.data=k:(k=lg(n),k!==null&&(D.data=k)))),(k=x2?v2(e,n):y2(e,n))&&(u=Ka(u,"onBeforeInput"),0<u.length&&(c=new Zd("onBeforeInput","beforeinput",null,n,c),p.push({event:c,listeners:u}),c.data=k))}Eg(p,t)})}function vo(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ka(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=co(e,n),s!=null&&r.unshift(vo(e,s,i)),s=co(e,t),s!=null&&r.push(vo(e,s,i))),e=e.return}return r}function Si(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function f0(e,t,n,r,i){for(var s=t._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=co(n,s),l!=null&&o.unshift(vo(n,l,a))):i||(l=co(n,s),l!=null&&o.push(vo(n,l,a)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var M2=/\r\n?/g,b2=/\u0000|\uFFFD/g;function d0(e){return(typeof e=="string"?e:""+e).replace(M2,`
`).replace(b2,"")}function ua(e,t,n){if(t=d0(t),d0(e)!==t&&n)throw Error(oe(425))}function Ya(){}var _c=null,Sc=null;function wc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Cc=typeof setTimeout=="function"?setTimeout:void 0,D2=typeof clearTimeout=="function"?clearTimeout:void 0,h0=typeof Promise=="function"?Promise:void 0,L2=typeof queueMicrotask=="function"?queueMicrotask:typeof h0<"u"?function(e){return h0.resolve(null).then(e).catch(O2)}:Cc;function O2(e){setTimeout(function(){throw e})}function Mu(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),po(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);po(t)}function Lr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function p0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ms=Math.random().toString(36).slice(2),Kn="__reactFiber$"+ms,yo="__reactProps$"+ms,cr="__reactContainer$"+ms,Ac="__reactEvents$"+ms,U2="__reactListeners$"+ms,B2="__reactHandles$"+ms;function ei(e){var t=e[Kn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[cr]||n[Kn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=p0(e);e!==null;){if(n=e[Kn])return n;e=p0(e)}return t}e=n,n=e.parentNode}return null}function Lo(e){return e=e[Kn]||e[cr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function bi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(oe(33))}function Gl(e){return e[yo]||null}var Nc=[],Di=-1;function qr(e){return{current:e}}function Xe(e){0>Di||(e.current=Nc[Di],Nc[Di]=null,Di--)}function Je(e,t){Di++,Nc[Di]=e.current,e.current=t}var Hr={},Ot=qr(Hr),Kt=qr(!1),oi=Hr;function os(e,t){var n=e.type.contextTypes;if(!n)return Hr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Yt(e){return e=e.childContextTypes,e!=null}function Xa(){Xe(Kt),Xe(Ot)}function m0(e,t,n){if(Ot.current!==Hr)throw Error(oe(168));Je(Ot,t),Je(Kt,n)}function _g(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(oe(108,Sy(e)||"Unknown",i));return nt({},n,r)}function Qa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Hr,oi=Ot.current,Je(Ot,e),Je(Kt,Kt.current),!0}function g0(e,t,n){var r=e.stateNode;if(!r)throw Error(oe(169));n?(e=_g(e,t,oi),r.__reactInternalMemoizedMergedChildContext=e,Xe(Kt),Xe(Ot),Je(Ot,e)):Xe(Kt),Je(Kt,n)}var nr=null,Vl=!1,bu=!1;function Sg(e){nr===null?nr=[e]:nr.push(e)}function G2(e){Vl=!0,Sg(e)}function Jr(){if(!bu&&nr!==null){bu=!0;var e=0,t=Ve;try{var n=nr;for(Ve=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}nr=null,Vl=!1}catch(i){throw nr!==null&&(nr=nr.slice(e+1)),Jm(Sf,Jr),i}finally{Ve=t,bu=!1}}return null}var Li=[],Oi=0,Za=null,el=0,Tn=[],_n=0,ai=null,rr=1,ir="";function Xr(e,t){Li[Oi++]=el,Li[Oi++]=Za,Za=e,el=t}function wg(e,t,n){Tn[_n++]=rr,Tn[_n++]=ir,Tn[_n++]=ai,ai=e;var r=rr;e=ir;var i=32-Bn(r)-1;r&=~(1<<i),n+=1;var s=32-Bn(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,rr=1<<32-Bn(t)+i|n<<i|r,ir=s+e}else rr=1<<s|n<<i|r,ir=e}function Ff(e){e.return!==null&&(Xr(e,1),wg(e,1,0))}function Mf(e){for(;e===Za;)Za=Li[--Oi],Li[Oi]=null,el=Li[--Oi],Li[Oi]=null;for(;e===ai;)ai=Tn[--_n],Tn[_n]=null,ir=Tn[--_n],Tn[_n]=null,rr=Tn[--_n],Tn[_n]=null}var cn=null,un=null,Ze=!1,Ln=null;function Cg(e,t){var n=Sn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function x0(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,cn=e,un=Lr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,cn=e,un=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ai!==null?{id:rr,overflow:ir}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Sn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,cn=e,un=null,!0):!1;default:return!1}}function Ic(e){return(e.mode&1)!==0&&(e.flags&128)===0}function kc(e){if(Ze){var t=un;if(t){var n=t;if(!x0(e,t)){if(Ic(e))throw Error(oe(418));t=Lr(n.nextSibling);var r=cn;t&&x0(e,t)?Cg(r,n):(e.flags=e.flags&-4097|2,Ze=!1,cn=e)}}else{if(Ic(e))throw Error(oe(418));e.flags=e.flags&-4097|2,Ze=!1,cn=e}}}function v0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;cn=e}function ca(e){if(e!==cn)return!1;if(!Ze)return v0(e),Ze=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!wc(e.type,e.memoizedProps)),t&&(t=un)){if(Ic(e))throw Ag(),Error(oe(418));for(;t;)Cg(e,t),t=Lr(t.nextSibling)}if(v0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(oe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){un=Lr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}un=null}}else un=cn?Lr(e.stateNode.nextSibling):null;return!0}function Ag(){for(var e=un;e;)e=Lr(e.nextSibling)}function as(){un=cn=null,Ze=!1}function bf(e){Ln===null?Ln=[e]:Ln.push(e)}var V2=gr.ReactCurrentBatchConfig;function Ds(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(oe(309));var r=n.stateNode}if(!r)throw Error(oe(147,e));var i=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(oe(284));if(!n._owner)throw Error(oe(290,e))}return e}function fa(e,t){throw e=Object.prototype.toString.call(t),Error(oe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function y0(e){var t=e._init;return t(e._payload)}function Ng(e){function t(T,E){if(e){var _=T.deletions;_===null?(T.deletions=[E],T.flags|=16):_.push(E)}}function n(T,E){if(!e)return null;for(;E!==null;)t(T,E),E=E.sibling;return null}function r(T,E){for(T=new Map;E!==null;)E.key!==null?T.set(E.key,E):T.set(E.index,E),E=E.sibling;return T}function i(T,E){return T=Gr(T,E),T.index=0,T.sibling=null,T}function s(T,E,_){return T.index=_,e?(_=T.alternate,_!==null?(_=_.index,_<E?(T.flags|=2,E):_):(T.flags|=2,E)):(T.flags|=1048576,E)}function o(T){return e&&T.alternate===null&&(T.flags|=2),T}function a(T,E,_,N){return E===null||E.tag!==6?(E=Vu(_,T.mode,N),E.return=T,E):(E=i(E,_),E.return=T,E)}function l(T,E,_,N){var B=_.type;return B===Ri?c(T,E,_.props.children,N,_.key):E!==null&&(E.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Cr&&y0(B)===E.type)?(N=i(E,_.props),N.ref=Ds(T,E,_),N.return=T,N):(N=Ua(_.type,_.key,_.props,null,T.mode,N),N.ref=Ds(T,E,_),N.return=T,N)}function u(T,E,_,N){return E===null||E.tag!==4||E.stateNode.containerInfo!==_.containerInfo||E.stateNode.implementation!==_.implementation?(E=Hu(_,T.mode,N),E.return=T,E):(E=i(E,_.children||[]),E.return=T,E)}function c(T,E,_,N,B){return E===null||E.tag!==7?(E=ii(_,T.mode,N,B),E.return=T,E):(E=i(E,_),E.return=T,E)}function p(T,E,_){if(typeof E=="string"&&E!==""||typeof E=="number")return E=Vu(""+E,T.mode,_),E.return=T,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case ea:return _=Ua(E.type,E.key,E.props,null,T.mode,_),_.ref=Ds(T,null,E),_.return=T,_;case ki:return E=Hu(E,T.mode,_),E.return=T,E;case Cr:var N=E._init;return p(T,N(E._payload),_)}if(Hs(E)||Rs(E))return E=ii(E,T.mode,_,null),E.return=T,E;fa(T,E)}return null}function m(T,E,_,N){var B=E!==null?E.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return B!==null?null:a(T,E,""+_,N);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case ea:return _.key===B?l(T,E,_,N):null;case ki:return _.key===B?u(T,E,_,N):null;case Cr:return B=_._init,m(T,E,B(_._payload),N)}if(Hs(_)||Rs(_))return B!==null?null:c(T,E,_,N,null);fa(T,_)}return null}function g(T,E,_,N,B){if(typeof N=="string"&&N!==""||typeof N=="number")return T=T.get(_)||null,a(E,T,""+N,B);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case ea:return T=T.get(N.key===null?_:N.key)||null,l(E,T,N,B);case ki:return T=T.get(N.key===null?_:N.key)||null,u(E,T,N,B);case Cr:var G=N._init;return g(T,E,_,G(N._payload),B)}if(Hs(N)||Rs(N))return T=T.get(_)||null,c(E,T,N,B,null);fa(E,N)}return null}function y(T,E,_,N){for(var B=null,G=null,k=E,D=E=0,b=null;k!==null&&D<_.length;D++){k.index>D?(b=k,k=null):b=k.sibling;var O=m(T,k,_[D],N);if(O===null){k===null&&(k=b);break}e&&k&&O.alternate===null&&t(T,k),E=s(O,E,D),G===null?B=O:G.sibling=O,G=O,k=b}if(D===_.length)return n(T,k),Ze&&Xr(T,D),B;if(k===null){for(;D<_.length;D++)k=p(T,_[D],N),k!==null&&(E=s(k,E,D),G===null?B=k:G.sibling=k,G=k);return Ze&&Xr(T,D),B}for(k=r(T,k);D<_.length;D++)b=g(k,T,D,_[D],N),b!==null&&(e&&b.alternate!==null&&k.delete(b.key===null?D:b.key),E=s(b,E,D),G===null?B=b:G.sibling=b,G=b);return e&&k.forEach(function(J){return t(T,J)}),Ze&&Xr(T,D),B}function x(T,E,_,N){var B=Rs(_);if(typeof B!="function")throw Error(oe(150));if(_=B.call(_),_==null)throw Error(oe(151));for(var G=B=null,k=E,D=E=0,b=null,O=_.next();k!==null&&!O.done;D++,O=_.next()){k.index>D?(b=k,k=null):b=k.sibling;var J=m(T,k,O.value,N);if(J===null){k===null&&(k=b);break}e&&k&&J.alternate===null&&t(T,k),E=s(J,E,D),G===null?B=J:G.sibling=J,G=J,k=b}if(O.done)return n(T,k),Ze&&Xr(T,D),B;if(k===null){for(;!O.done;D++,O=_.next())O=p(T,O.value,N),O!==null&&(E=s(O,E,D),G===null?B=O:G.sibling=O,G=O);return Ze&&Xr(T,D),B}for(k=r(T,k);!O.done;D++,O=_.next())O=g(k,T,D,O.value,N),O!==null&&(e&&O.alternate!==null&&k.delete(O.key===null?D:O.key),E=s(O,E,D),G===null?B=O:G.sibling=O,G=O);return e&&k.forEach(function(X){return t(T,X)}),Ze&&Xr(T,D),B}function S(T,E,_,N){if(typeof _=="object"&&_!==null&&_.type===Ri&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case ea:e:{for(var B=_.key,G=E;G!==null;){if(G.key===B){if(B=_.type,B===Ri){if(G.tag===7){n(T,G.sibling),E=i(G,_.props.children),E.return=T,T=E;break e}}else if(G.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Cr&&y0(B)===G.type){n(T,G.sibling),E=i(G,_.props),E.ref=Ds(T,G,_),E.return=T,T=E;break e}n(T,G);break}else t(T,G);G=G.sibling}_.type===Ri?(E=ii(_.props.children,T.mode,N,_.key),E.return=T,T=E):(N=Ua(_.type,_.key,_.props,null,T.mode,N),N.ref=Ds(T,E,_),N.return=T,T=N)}return o(T);case ki:e:{for(G=_.key;E!==null;){if(E.key===G)if(E.tag===4&&E.stateNode.containerInfo===_.containerInfo&&E.stateNode.implementation===_.implementation){n(T,E.sibling),E=i(E,_.children||[]),E.return=T,T=E;break e}else{n(T,E);break}else t(T,E);E=E.sibling}E=Hu(_,T.mode,N),E.return=T,T=E}return o(T);case Cr:return G=_._init,S(T,E,G(_._payload),N)}if(Hs(_))return y(T,E,_,N);if(Rs(_))return x(T,E,_,N);fa(T,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,E!==null&&E.tag===6?(n(T,E.sibling),E=i(E,_),E.return=T,T=E):(n(T,E),E=Vu(_,T.mode,N),E.return=T,T=E),o(T)):n(T,E)}return S}var ls=Ng(!0),Ig=Ng(!1),tl=qr(null),nl=null,Ui=null,Df=null;function Lf(){Df=Ui=nl=null}function Of(e){var t=tl.current;Xe(tl),e._currentValue=t}function Rc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ji(e,t){nl=e,Df=Ui=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Jt=!0),e.firstContext=null)}function An(e){var t=e._currentValue;if(Df!==e)if(e={context:e,memoizedValue:t,next:null},Ui===null){if(nl===null)throw Error(oe(308));Ui=e,nl.dependencies={lanes:0,firstContext:e}}else Ui=Ui.next=e;return t}var ti=null;function Uf(e){ti===null?ti=[e]:ti.push(e)}function kg(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Uf(t)):(n.next=i.next,i.next=n),t.interleaved=n,fr(e,r)}function fr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ar=!1;function Bf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Rg(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function sr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Or(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Fe&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,fr(e,n)}return i=r.interleaved,i===null?(t.next=t,Uf(r)):(t.next=i.next,i.next=t),r.interleaved=t,fr(e,n)}function Fa(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,wf(e,n)}}function E0(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=t:s=s.next=t}else i=s=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function rl(e,t,n,r){var i=e.updateQueue;Ar=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=e.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;o=0,c=u=l=null,a=s;do{var m=a.lane,g=a.eventTime;if((r&m)===m){c!==null&&(c=c.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=e,x=a;switch(m=t,g=n,x.tag){case 1:if(y=x.payload,typeof y=="function"){p=y.call(g,p,m);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,m=typeof y=="function"?y.call(g,p,m):y,m==null)break e;p=nt({},p,m);break e;case 2:Ar=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,m=i.effects,m===null?i.effects=[a]:m.push(a))}else g={eventTime:g,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=g,l=p):c=c.next=g,o|=m;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;m=a,a=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(c===null&&(l=p),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);ui|=o,e.lanes=o,e.memoizedState=p}}function T0(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(oe(191,i));i.call(r)}}}var Oo={},Xn=qr(Oo),Eo=qr(Oo),To=qr(Oo);function ni(e){if(e===Oo)throw Error(oe(174));return e}function Gf(e,t){switch(Je(To,t),Je(Eo,e),Je(Xn,Oo),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:cc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=cc(t,e)}Xe(Xn),Je(Xn,t)}function us(){Xe(Xn),Xe(Eo),Xe(To)}function Pg(e){ni(To.current);var t=ni(Xn.current),n=cc(t,e.type);t!==n&&(Je(Eo,e),Je(Xn,n))}function Vf(e){Eo.current===e&&(Xe(Xn),Xe(Eo))}var et=qr(0);function il(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Du=[];function Hf(){for(var e=0;e<Du.length;e++)Du[e]._workInProgressVersionPrimary=null;Du.length=0}var Ma=gr.ReactCurrentDispatcher,Lu=gr.ReactCurrentBatchConfig,li=0,tt=null,dt=null,pt=null,sl=!1,Xs=!1,_o=0,H2=0;function Pt(){throw Error(oe(321))}function $f(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Hn(e[n],t[n]))return!1;return!0}function zf(e,t,n,r,i,s){if(li=s,tt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ma.current=e===null||e.memoizedState===null?W2:q2,e=n(r,i),Xs){s=0;do{if(Xs=!1,_o=0,25<=s)throw Error(oe(301));s+=1,pt=dt=null,t.updateQueue=null,Ma.current=J2,e=n(r,i)}while(Xs)}if(Ma.current=ol,t=dt!==null&&dt.next!==null,li=0,pt=dt=tt=null,sl=!1,t)throw Error(oe(300));return e}function jf(){var e=_o!==0;return _o=0,e}function Jn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pt===null?tt.memoizedState=pt=e:pt=pt.next=e,pt}function Nn(){if(dt===null){var e=tt.alternate;e=e!==null?e.memoizedState:null}else e=dt.next;var t=pt===null?tt.memoizedState:pt.next;if(t!==null)pt=t,dt=e;else{if(e===null)throw Error(oe(310));dt=e,e={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},pt===null?tt.memoizedState=pt=e:pt=pt.next=e}return pt}function So(e,t){return typeof t=="function"?t(e):t}function Ou(e){var t=Nn(),n=t.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=e;var r=dt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((li&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var p={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=p,o=r):l=l.next=p,tt.lanes|=c,ui|=c}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Hn(r,t.memoizedState)||(Jt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do s=i.lane,tt.lanes|=s,ui|=s,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Uu(e){var t=Nn(),n=t.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);Hn(s,t.memoizedState)||(Jt=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Fg(){}function Mg(e,t){var n=tt,r=Nn(),i=t(),s=!Hn(r.memoizedState,i);if(s&&(r.memoizedState=i,Jt=!0),r=r.queue,Wf(Lg.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||pt!==null&&pt.memoizedState.tag&1){if(n.flags|=2048,wo(9,Dg.bind(null,n,r,i,t),void 0,null),vt===null)throw Error(oe(349));li&30||bg(n,t,i)}return i}function bg(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=tt.updateQueue,t===null?(t={lastEffect:null,stores:null},tt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Dg(e,t,n,r){t.value=n,t.getSnapshot=r,Og(t)&&Ug(e)}function Lg(e,t,n){return n(function(){Og(t)&&Ug(e)})}function Og(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Hn(e,n)}catch{return!0}}function Ug(e){var t=fr(e,1);t!==null&&Gn(t,e,1,-1)}function _0(e){var t=Jn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:e},t.queue=e,e=e.dispatch=j2.bind(null,tt,e),[t.memoizedState,e]}function wo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=tt.updateQueue,t===null?(t={lastEffect:null,stores:null},tt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Bg(){return Nn().memoizedState}function ba(e,t,n,r){var i=Jn();tt.flags|=e,i.memoizedState=wo(1|t,n,void 0,r===void 0?null:r)}function Hl(e,t,n,r){var i=Nn();r=r===void 0?null:r;var s=void 0;if(dt!==null){var o=dt.memoizedState;if(s=o.destroy,r!==null&&$f(r,o.deps)){i.memoizedState=wo(t,n,s,r);return}}tt.flags|=e,i.memoizedState=wo(1|t,n,s,r)}function S0(e,t){return ba(8390656,8,e,t)}function Wf(e,t){return Hl(2048,8,e,t)}function Gg(e,t){return Hl(4,2,e,t)}function Vg(e,t){return Hl(4,4,e,t)}function Hg(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function $g(e,t,n){return n=n!=null?n.concat([e]):null,Hl(4,4,Hg.bind(null,t,e),n)}function qf(){}function zg(e,t){var n=Nn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&$f(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function jg(e,t){var n=Nn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&$f(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Wg(e,t,n){return li&21?(Hn(n,t)||(n=Xm(),tt.lanes|=n,ui|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Jt=!0),e.memoizedState=n)}function $2(e,t){var n=Ve;Ve=n!==0&&4>n?n:4,e(!0);var r=Lu.transition;Lu.transition={};try{e(!1),t()}finally{Ve=n,Lu.transition=r}}function qg(){return Nn().memoizedState}function z2(e,t,n){var r=Br(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Jg(e))Kg(t,n);else if(n=kg(e,t,n,r),n!==null){var i=$t();Gn(n,e,r,i),Yg(n,t,r)}}function j2(e,t,n){var r=Br(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Jg(e))Kg(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Hn(a,o)){var l=t.interleaved;l===null?(i.next=i,Uf(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}n=kg(e,t,i,r),n!==null&&(i=$t(),Gn(n,e,r,i),Yg(n,t,r))}}function Jg(e){var t=e.alternate;return e===tt||t!==null&&t===tt}function Kg(e,t){Xs=sl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Yg(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,wf(e,n)}}var ol={readContext:An,useCallback:Pt,useContext:Pt,useEffect:Pt,useImperativeHandle:Pt,useInsertionEffect:Pt,useLayoutEffect:Pt,useMemo:Pt,useReducer:Pt,useRef:Pt,useState:Pt,useDebugValue:Pt,useDeferredValue:Pt,useTransition:Pt,useMutableSource:Pt,useSyncExternalStore:Pt,useId:Pt,unstable_isNewReconciler:!1},W2={readContext:An,useCallback:function(e,t){return Jn().memoizedState=[e,t===void 0?null:t],e},useContext:An,useEffect:S0,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ba(4194308,4,Hg.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ba(4194308,4,e,t)},useInsertionEffect:function(e,t){return ba(4,2,e,t)},useMemo:function(e,t){var n=Jn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Jn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=z2.bind(null,tt,e),[r.memoizedState,e]},useRef:function(e){var t=Jn();return e={current:e},t.memoizedState=e},useState:_0,useDebugValue:qf,useDeferredValue:function(e){return Jn().memoizedState=e},useTransition:function(){var e=_0(!1),t=e[0];return e=$2.bind(null,e[1]),Jn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=tt,i=Jn();if(Ze){if(n===void 0)throw Error(oe(407));n=n()}else{if(n=t(),vt===null)throw Error(oe(349));li&30||bg(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,S0(Lg.bind(null,r,s,e),[e]),r.flags|=2048,wo(9,Dg.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=Jn(),t=vt.identifierPrefix;if(Ze){var n=ir,r=rr;n=(r&~(1<<32-Bn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=_o++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=H2++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},q2={readContext:An,useCallback:zg,useContext:An,useEffect:Wf,useImperativeHandle:$g,useInsertionEffect:Gg,useLayoutEffect:Vg,useMemo:jg,useReducer:Ou,useRef:Bg,useState:function(){return Ou(So)},useDebugValue:qf,useDeferredValue:function(e){var t=Nn();return Wg(t,dt.memoizedState,e)},useTransition:function(){var e=Ou(So)[0],t=Nn().memoizedState;return[e,t]},useMutableSource:Fg,useSyncExternalStore:Mg,useId:qg,unstable_isNewReconciler:!1},J2={readContext:An,useCallback:zg,useContext:An,useEffect:Wf,useImperativeHandle:$g,useInsertionEffect:Gg,useLayoutEffect:Vg,useMemo:jg,useReducer:Uu,useRef:Bg,useState:function(){return Uu(So)},useDebugValue:qf,useDeferredValue:function(e){var t=Nn();return dt===null?t.memoizedState=e:Wg(t,dt.memoizedState,e)},useTransition:function(){var e=Uu(So)[0],t=Nn().memoizedState;return[e,t]},useMutableSource:Fg,useSyncExternalStore:Mg,useId:qg,unstable_isNewReconciler:!1};function bn(e,t){if(e&&e.defaultProps){t=nt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Pc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:nt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var $l={isMounted:function(e){return(e=e._reactInternals)?mi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=$t(),i=Br(e),s=sr(r,i);s.payload=t,n!=null&&(s.callback=n),t=Or(e,s,i),t!==null&&(Gn(t,e,i,r),Fa(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=$t(),i=Br(e),s=sr(r,i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=Or(e,s,i),t!==null&&(Gn(t,e,i,r),Fa(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=$t(),r=Br(e),i=sr(n,r);i.tag=2,t!=null&&(i.callback=t),t=Or(e,i,r),t!==null&&(Gn(t,e,r,n),Fa(t,e,r))}};function w0(e,t,n,r,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,o):t.prototype&&t.prototype.isPureReactComponent?!go(n,r)||!go(i,s):!0}function Xg(e,t,n){var r=!1,i=Hr,s=t.contextType;return typeof s=="object"&&s!==null?s=An(s):(i=Yt(t)?oi:Ot.current,r=t.contextTypes,s=(r=r!=null)?os(e,i):Hr),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=$l,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function C0(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&$l.enqueueReplaceState(t,t.state,null)}function Fc(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Bf(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=An(s):(s=Yt(t)?oi:Ot.current,i.context=os(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Pc(e,t,s,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&$l.enqueueReplaceState(i,i.state,null),rl(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function cs(e,t){try{var n="",r=t;do n+=_y(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Bu(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Mc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var K2=typeof WeakMap=="function"?WeakMap:Map;function Qg(e,t,n){n=sr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ll||(ll=!0,$c=r),Mc(e,t)},n}function Zg(e,t,n){n=sr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){Mc(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Mc(e,t),typeof r!="function"&&(Ur===null?Ur=new Set([this]):Ur.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function A0(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new K2;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=uE.bind(null,e,t,n),t.then(e,e))}function N0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function I0(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=sr(-1,1),t.tag=2,Or(n,t,1))),n.lanes|=1),e)}var Y2=gr.ReactCurrentOwner,Jt=!1;function Gt(e,t,n,r){t.child=e===null?Ig(t,null,n,r):ls(t,e.child,n,r)}function k0(e,t,n,r,i){n=n.render;var s=t.ref;return Ji(t,i),r=zf(e,t,n,r,s,i),n=jf(),e!==null&&!Jt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,dr(e,t,i)):(Ze&&n&&Ff(t),t.flags|=1,Gt(e,t,r,i),t.child)}function R0(e,t,n,r,i){if(e===null){var s=n.type;return typeof s=="function"&&!td(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,ex(e,t,s,r,i)):(e=Ua(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:go,n(o,r)&&e.ref===t.ref)return dr(e,t,i)}return t.flags|=1,e=Gr(s,r),e.ref=t.ref,e.return=t,t.child=e}function ex(e,t,n,r,i){if(e!==null){var s=e.memoizedProps;if(go(s,r)&&e.ref===t.ref)if(Jt=!1,t.pendingProps=r=s,(e.lanes&i)!==0)e.flags&131072&&(Jt=!0);else return t.lanes=e.lanes,dr(e,t,i)}return bc(e,t,n,r,i)}function tx(e,t,n){var r=t.pendingProps,i=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(Gi,sn),sn|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Je(Gi,sn),sn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Je(Gi,sn),sn|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,Je(Gi,sn),sn|=r;return Gt(e,t,i,n),t.child}function nx(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function bc(e,t,n,r,i){var s=Yt(n)?oi:Ot.current;return s=os(t,s),Ji(t,i),n=zf(e,t,n,r,s,i),r=jf(),e!==null&&!Jt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,dr(e,t,i)):(Ze&&r&&Ff(t),t.flags|=1,Gt(e,t,n,i),t.child)}function P0(e,t,n,r,i){if(Yt(n)){var s=!0;Qa(t)}else s=!1;if(Ji(t,i),t.stateNode===null)Da(e,t),Xg(t,n,r),Fc(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=An(u):(u=Yt(n)?oi:Ot.current,u=os(t,u));var c=n.getDerivedStateFromProps,p=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&C0(t,o,r,u),Ar=!1;var m=t.memoizedState;o.state=m,rl(t,r,o,i),l=t.memoizedState,a!==r||m!==l||Kt.current||Ar?(typeof c=="function"&&(Pc(t,n,c,r),l=t.memoizedState),(a=Ar||w0(t,n,a,r,m,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Rg(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:bn(t.type,a),o.props=u,p=t.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=An(l):(l=Yt(n)?oi:Ot.current,l=os(t,l));var g=n.getDerivedStateFromProps;(c=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||m!==l)&&C0(t,o,r,l),Ar=!1,m=t.memoizedState,o.state=m,rl(t,r,o,i);var y=t.memoizedState;a!==p||m!==y||Kt.current||Ar?(typeof g=="function"&&(Pc(t,n,g,r),y=t.memoizedState),(u=Ar||w0(t,n,u,r,m,y,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=y),o.props=r,o.state=y,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),r=!1)}return Dc(e,t,n,r,s,i)}function Dc(e,t,n,r,i,s){nx(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&g0(t,n,!1),dr(e,t,s);r=t.stateNode,Y2.current=t;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=ls(t,e.child,null,s),t.child=ls(t,null,a,s)):Gt(e,t,a,s),t.memoizedState=r.state,i&&g0(t,n,!0),t.child}function rx(e){var t=e.stateNode;t.pendingContext?m0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&m0(e,t.context,!1),Gf(e,t.containerInfo)}function F0(e,t,n,r,i){return as(),bf(i),t.flags|=256,Gt(e,t,n,r),t.child}var Lc={dehydrated:null,treeContext:null,retryLane:0};function Oc(e){return{baseLanes:e,cachePool:null,transitions:null}}function ix(e,t,n){var r=t.pendingProps,i=et.current,s=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Je(et,i&1),e===null)return kc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,s?(r=t.mode,s=t.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Wl(o,r,0,null),e=ii(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Oc(n),t.memoizedState=Lc,e):Jf(t,o));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return X2(e,t,o,r,a,i,n);if(s){s=r.fallback,o=t.mode,i=e.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=Gr(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Gr(a,s):(s=ii(s,o,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,o=e.child.memoizedState,o=o===null?Oc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~n,t.memoizedState=Lc,r}return s=e.child,e=s.sibling,r=Gr(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Jf(e,t){return t=Wl({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function da(e,t,n,r){return r!==null&&bf(r),ls(t,e.child,null,n),e=Jf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function X2(e,t,n,r,i,s,o){if(n)return t.flags&256?(t.flags&=-257,r=Bu(Error(oe(422))),da(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Wl({mode:"visible",children:r.children},i,0,null),s=ii(s,i,o,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&ls(t,e.child,null,o),t.child.memoizedState=Oc(o),t.memoizedState=Lc,s);if(!(t.mode&1))return da(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(oe(419)),r=Bu(s,r,void 0),da(e,t,o,r)}if(a=(o&e.childLanes)!==0,Jt||a){if(r=vt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,fr(e,i),Gn(r,e,i,-1))}return ed(),r=Bu(Error(oe(421))),da(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=cE.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,un=Lr(i.nextSibling),cn=t,Ze=!0,Ln=null,e!==null&&(Tn[_n++]=rr,Tn[_n++]=ir,Tn[_n++]=ai,rr=e.id,ir=e.overflow,ai=t),t=Jf(t,r.children),t.flags|=4096,t)}function M0(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Rc(e.return,t,n)}function Gu(e,t,n,r,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function sx(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(Gt(e,t,r.children,n),r=et.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&M0(e,n,t);else if(e.tag===19)M0(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Je(et,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&il(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Gu(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&il(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Gu(t,!0,n,null,s);break;case"together":Gu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Da(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function dr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ui|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(oe(153));if(t.child!==null){for(e=t.child,n=Gr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Gr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Q2(e,t,n){switch(t.tag){case 3:rx(t),as();break;case 5:Pg(t);break;case 1:Yt(t.type)&&Qa(t);break;case 4:Gf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Je(tl,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Je(et,et.current&1),t.flags|=128,null):n&t.child.childLanes?ix(e,t,n):(Je(et,et.current&1),e=dr(e,t,n),e!==null?e.sibling:null);Je(et,et.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return sx(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Je(et,et.current),r)break;return null;case 22:case 23:return t.lanes=0,tx(e,t,n)}return dr(e,t,n)}var ox,Uc,ax,lx;ox=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Uc=function(){};ax=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,ni(Xn.current);var s=null;switch(n){case"input":i=oc(e,i),r=oc(e,r),s=[];break;case"select":i=nt({},i,{value:void 0}),r=nt({},r,{value:void 0}),s=[];break;case"textarea":i=uc(e,i),r=uc(e,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Ya)}fc(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(lo.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(lo.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ke("scroll",e),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};lx=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ls(e,t){if(!Ze)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ft(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Z2(e,t,n){var r=t.pendingProps;switch(Mf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(t),null;case 1:return Yt(t.type)&&Xa(),Ft(t),null;case 3:return r=t.stateNode,us(),Xe(Kt),Xe(Ot),Hf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ca(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ln!==null&&(Wc(Ln),Ln=null))),Uc(e,t),Ft(t),null;case 5:Vf(t);var i=ni(To.current);if(n=t.type,e!==null&&t.stateNode!=null)ax(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(oe(166));return Ft(t),null}if(e=ni(Xn.current),ca(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[Kn]=t,r[yo]=s,e=(t.mode&1)!==0,n){case"dialog":Ke("cancel",r),Ke("close",r);break;case"iframe":case"object":case"embed":Ke("load",r);break;case"video":case"audio":for(i=0;i<zs.length;i++)Ke(zs[i],r);break;case"source":Ke("error",r);break;case"img":case"image":case"link":Ke("error",r),Ke("load",r);break;case"details":Ke("toggle",r);break;case"input":Hd(r,s),Ke("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ke("invalid",r);break;case"textarea":zd(r,s),Ke("invalid",r)}fc(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&ua(r.textContent,a,e),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&ua(r.textContent,a,e),i=["children",""+a]):lo.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ke("scroll",r)}switch(n){case"input":ta(r),$d(r,s,!0);break;case"textarea":ta(r),jd(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Ya)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Lm(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Kn]=t,e[yo]=r,ox(e,t,!1,!1),t.stateNode=e;e:{switch(o=dc(n,r),n){case"dialog":Ke("cancel",e),Ke("close",e),i=r;break;case"iframe":case"object":case"embed":Ke("load",e),i=r;break;case"video":case"audio":for(i=0;i<zs.length;i++)Ke(zs[i],e);i=r;break;case"source":Ke("error",e),i=r;break;case"img":case"image":case"link":Ke("error",e),Ke("load",e),i=r;break;case"details":Ke("toggle",e),i=r;break;case"input":Hd(e,r),i=oc(e,r),Ke("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=nt({},r,{value:void 0}),Ke("invalid",e);break;case"textarea":zd(e,r),i=uc(e,r),Ke("invalid",e);break;default:i=r}fc(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Bm(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Om(e,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&uo(e,l):typeof l=="number"&&uo(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(lo.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ke("scroll",e):l!=null&&vf(e,s,l,o))}switch(n){case"input":ta(e),$d(e,r,!1);break;case"textarea":ta(e),jd(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Vr(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?zi(e,!!r.multiple,s,!1):r.defaultValue!=null&&zi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Ya)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ft(t),null;case 6:if(e&&t.stateNode!=null)lx(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(oe(166));if(n=ni(To.current),ni(Xn.current),ca(t)){if(r=t.stateNode,n=t.memoizedProps,r[Kn]=t,(s=r.nodeValue!==n)&&(e=cn,e!==null))switch(e.tag){case 3:ua(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ua(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Kn]=t,t.stateNode=r}return Ft(t),null;case 13:if(Xe(et),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ze&&un!==null&&t.mode&1&&!(t.flags&128))Ag(),as(),t.flags|=98560,s=!1;else if(s=ca(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(oe(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(oe(317));s[Kn]=t}else as(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ft(t),s=!1}else Ln!==null&&(Wc(Ln),Ln=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||et.current&1?ht===0&&(ht=3):ed())),t.updateQueue!==null&&(t.flags|=4),Ft(t),null);case 4:return us(),Uc(e,t),e===null&&xo(t.stateNode.containerInfo),Ft(t),null;case 10:return Of(t.type._context),Ft(t),null;case 17:return Yt(t.type)&&Xa(),Ft(t),null;case 19:if(Xe(et),s=t.memoizedState,s===null)return Ft(t),null;if(r=(t.flags&128)!==0,o=s.rendering,o===null)if(r)Ls(s,!1);else{if(ht!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=il(e),o!==null){for(t.flags|=128,Ls(s,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Je(et,et.current&1|2),t.child}e=e.sibling}s.tail!==null&&ot()>fs&&(t.flags|=128,r=!0,Ls(s,!1),t.lanes=4194304)}else{if(!r)if(e=il(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ls(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ze)return Ft(t),null}else 2*ot()-s.renderingStartTime>fs&&n!==1073741824&&(t.flags|=128,r=!0,Ls(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(n=s.last,n!==null?n.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ot(),t.sibling=null,n=et.current,Je(et,r?n&1|2:n&1),t):(Ft(t),null);case 22:case 23:return Zf(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?sn&1073741824&&(Ft(t),t.subtreeFlags&6&&(t.flags|=8192)):Ft(t),null;case 24:return null;case 25:return null}throw Error(oe(156,t.tag))}function eE(e,t){switch(Mf(t),t.tag){case 1:return Yt(t.type)&&Xa(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return us(),Xe(Kt),Xe(Ot),Hf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Vf(t),null;case 13:if(Xe(et),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(oe(340));as()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Xe(et),null;case 4:return us(),null;case 10:return Of(t.type._context),null;case 22:case 23:return Zf(),null;case 24:return null;default:return null}}var ha=!1,Mt=!1,tE=typeof WeakSet=="function"?WeakSet:Set,xe=null;function Bi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){rt(e,t,r)}else n.current=null}function Bc(e,t,n){try{n()}catch(r){rt(e,t,r)}}var b0=!1;function nE(e,t){if(_c=qa,e=hg(),Pf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,c=0,p=e,m=null;t:for(;;){for(var g;p!==n||i!==0&&p.nodeType!==3||(a=o+i),p!==s||r!==0&&p.nodeType!==3||(l=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(g=p.firstChild)!==null;)m=p,p=g;for(;;){if(p===e)break t;if(m===n&&++u===i&&(a=o),m===s&&++c===r&&(l=o),(g=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=g}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Sc={focusedElem:e,selectionRange:n},qa=!1,xe=t;xe!==null;)if(t=xe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,xe=e;else for(;xe!==null;){t=xe;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,S=y.memoizedState,T=t.stateNode,E=T.getSnapshotBeforeUpdate(t.elementType===t.type?x:bn(t.type,x),S);T.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(N){rt(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,xe=e;break}xe=t.return}return y=b0,b0=!1,y}function Qs(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&Bc(t,n,s)}i=i.next}while(i!==r)}}function zl(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Gc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function ux(e){var t=e.alternate;t!==null&&(e.alternate=null,ux(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Kn],delete t[yo],delete t[Ac],delete t[U2],delete t[B2])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function cx(e){return e.tag===5||e.tag===3||e.tag===4}function D0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||cx(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ya));else if(r!==4&&(e=e.child,e!==null))for(Vc(e,t,n),e=e.sibling;e!==null;)Vc(e,t,n),e=e.sibling}function Hc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Hc(e,t,n),e=e.sibling;e!==null;)Hc(e,t,n),e=e.sibling}var _t=null,Dn=!1;function Sr(e,t,n){for(n=n.child;n!==null;)fx(e,t,n),n=n.sibling}function fx(e,t,n){if(Yn&&typeof Yn.onCommitFiberUnmount=="function")try{Yn.onCommitFiberUnmount(Ll,n)}catch{}switch(n.tag){case 5:Mt||Bi(n,t);case 6:var r=_t,i=Dn;_t=null,Sr(e,t,n),_t=r,Dn=i,_t!==null&&(Dn?(e=_t,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):_t.removeChild(n.stateNode));break;case 18:_t!==null&&(Dn?(e=_t,n=n.stateNode,e.nodeType===8?Mu(e.parentNode,n):e.nodeType===1&&Mu(e,n),po(e)):Mu(_t,n.stateNode));break;case 4:r=_t,i=Dn,_t=n.stateNode.containerInfo,Dn=!0,Sr(e,t,n),_t=r,Dn=i;break;case 0:case 11:case 14:case 15:if(!Mt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Bc(n,t,o),i=i.next}while(i!==r)}Sr(e,t,n);break;case 1:if(!Mt&&(Bi(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){rt(n,t,a)}Sr(e,t,n);break;case 21:Sr(e,t,n);break;case 22:n.mode&1?(Mt=(r=Mt)||n.memoizedState!==null,Sr(e,t,n),Mt=r):Sr(e,t,n);break;default:Sr(e,t,n)}}function L0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new tE),t.forEach(function(r){var i=fE.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Pn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:_t=a.stateNode,Dn=!1;break e;case 3:_t=a.stateNode.containerInfo,Dn=!0;break e;case 4:_t=a.stateNode.containerInfo,Dn=!0;break e}a=a.return}if(_t===null)throw Error(oe(160));fx(s,o,i),_t=null,Dn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){rt(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)dx(t,e),t=t.sibling}function dx(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Pn(t,e),jn(e),r&4){try{Qs(3,e,e.return),zl(3,e)}catch(x){rt(e,e.return,x)}try{Qs(5,e,e.return)}catch(x){rt(e,e.return,x)}}break;case 1:Pn(t,e),jn(e),r&512&&n!==null&&Bi(n,n.return);break;case 5:if(Pn(t,e),jn(e),r&512&&n!==null&&Bi(n,n.return),e.flags&32){var i=e.stateNode;try{uo(i,"")}catch(x){rt(e,e.return,x)}}if(r&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=n!==null?n.memoizedProps:s,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&bm(i,s),dc(a,o);var u=dc(a,s);for(o=0;o<l.length;o+=2){var c=l[o],p=l[o+1];c==="style"?Bm(i,p):c==="dangerouslySetInnerHTML"?Om(i,p):c==="children"?uo(i,p):vf(i,c,p,u)}switch(a){case"input":ac(i,s);break;case"textarea":Dm(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?zi(i,!!s.multiple,g,!1):m!==!!s.multiple&&(s.defaultValue!=null?zi(i,!!s.multiple,s.defaultValue,!0):zi(i,!!s.multiple,s.multiple?[]:"",!1))}i[yo]=s}catch(x){rt(e,e.return,x)}}break;case 6:if(Pn(t,e),jn(e),r&4){if(e.stateNode===null)throw Error(oe(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(x){rt(e,e.return,x)}}break;case 3:if(Pn(t,e),jn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{po(t.containerInfo)}catch(x){rt(e,e.return,x)}break;case 4:Pn(t,e),jn(e);break;case 13:Pn(t,e),jn(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Xf=ot())),r&4&&L0(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(Mt=(u=Mt)||c,Pn(t,e),Mt=u):Pn(t,e),jn(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!c&&e.mode&1)for(xe=e,c=e.child;c!==null;){for(p=xe=c;xe!==null;){switch(m=xe,g=m.child,m.tag){case 0:case 11:case 14:case 15:Qs(4,m,m.return);break;case 1:Bi(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){r=m,n=m.return;try{t=r,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(x){rt(r,n,x)}}break;case 5:Bi(m,m.return);break;case 22:if(m.memoizedState!==null){U0(p);continue}}g!==null?(g.return=m,xe=g):U0(p)}c=c.sibling}e:for(c=null,p=e;;){if(p.tag===5){if(c===null){c=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Um("display",o))}catch(x){rt(e,e.return,x)}}}else if(p.tag===6){if(c===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(x){rt(e,e.return,x)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;c===p&&(c=null),p=p.return}c===p&&(c=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Pn(t,e),jn(e),r&4&&L0(e);break;case 21:break;default:Pn(t,e),jn(e)}}function jn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(cx(n)){var r=n;break e}n=n.return}throw Error(oe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(uo(i,""),r.flags&=-33);var s=D0(e);Hc(e,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=D0(e);Vc(e,a,o);break;default:throw Error(oe(161))}}catch(l){rt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function rE(e,t,n){xe=e,hx(e)}function hx(e,t,n){for(var r=(e.mode&1)!==0;xe!==null;){var i=xe,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||ha;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Mt;a=ha;var u=Mt;if(ha=o,(Mt=l)&&!u)for(xe=i;xe!==null;)o=xe,l=o.child,o.tag===22&&o.memoizedState!==null?B0(i):l!==null?(l.return=o,xe=l):B0(i);for(;s!==null;)xe=s,hx(s),s=s.sibling;xe=i,ha=a,Mt=u}O0(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,xe=s):O0(e)}}function O0(e){for(;xe!==null;){var t=xe;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Mt||zl(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Mt)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:bn(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&T0(t,s,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}T0(t,o,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var p=c.dehydrated;p!==null&&po(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}Mt||t.flags&512&&Gc(t)}catch(m){rt(t,t.return,m)}}if(t===e){xe=null;break}if(n=t.sibling,n!==null){n.return=t.return,xe=n;break}xe=t.return}}function U0(e){for(;xe!==null;){var t=xe;if(t===e){xe=null;break}var n=t.sibling;if(n!==null){n.return=t.return,xe=n;break}xe=t.return}}function B0(e){for(;xe!==null;){var t=xe;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{zl(4,t)}catch(l){rt(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(l){rt(t,i,l)}}var s=t.return;try{Gc(t)}catch(l){rt(t,s,l)}break;case 5:var o=t.return;try{Gc(t)}catch(l){rt(t,o,l)}}}catch(l){rt(t,t.return,l)}if(t===e){xe=null;break}var a=t.sibling;if(a!==null){a.return=t.return,xe=a;break}xe=t.return}}var iE=Math.ceil,al=gr.ReactCurrentDispatcher,Kf=gr.ReactCurrentOwner,wn=gr.ReactCurrentBatchConfig,Fe=0,vt=null,lt=null,At=0,sn=0,Gi=qr(0),ht=0,Co=null,ui=0,jl=0,Yf=0,Zs=null,qt=null,Xf=0,fs=1/0,tr=null,ll=!1,$c=null,Ur=null,pa=!1,Rr=null,ul=0,eo=0,zc=null,La=-1,Oa=0;function $t(){return Fe&6?ot():La!==-1?La:La=ot()}function Br(e){return e.mode&1?Fe&2&&At!==0?At&-At:V2.transition!==null?(Oa===0&&(Oa=Xm()),Oa):(e=Ve,e!==0||(e=window.event,e=e===void 0?16:ig(e.type)),e):1}function Gn(e,t,n,r){if(50<eo)throw eo=0,zc=null,Error(oe(185));bo(e,n,r),(!(Fe&2)||e!==vt)&&(e===vt&&(!(Fe&2)&&(jl|=n),ht===4&&Ir(e,At)),Xt(e,r),n===1&&Fe===0&&!(t.mode&1)&&(fs=ot()+500,Vl&&Jr()))}function Xt(e,t){var n=e.callbackNode;Vy(e,t);var r=Wa(e,e===vt?At:0);if(r===0)n!==null&&Jd(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Jd(n),t===1)e.tag===0?G2(G0.bind(null,e)):Sg(G0.bind(null,e)),L2(function(){!(Fe&6)&&Jr()}),n=null;else{switch(Qm(r)){case 1:n=Sf;break;case 4:n=Km;break;case 16:n=ja;break;case 536870912:n=Ym;break;default:n=ja}n=Tx(n,px.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function px(e,t){if(La=-1,Oa=0,Fe&6)throw Error(oe(327));var n=e.callbackNode;if(Ki()&&e.callbackNode!==n)return null;var r=Wa(e,e===vt?At:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=cl(e,r);else{t=r;var i=Fe;Fe|=2;var s=gx();(vt!==e||At!==t)&&(tr=null,fs=ot()+500,ri(e,t));do try{aE();break}catch(a){mx(e,a)}while(!0);Lf(),al.current=s,Fe=i,lt!==null?t=0:(vt=null,At=0,t=ht)}if(t!==0){if(t===2&&(i=xc(e),i!==0&&(r=i,t=jc(e,i))),t===1)throw n=Co,ri(e,0),Ir(e,r),Xt(e,ot()),n;if(t===6)Ir(e,r);else{if(i=e.current.alternate,!(r&30)&&!sE(i)&&(t=cl(e,r),t===2&&(s=xc(e),s!==0&&(r=s,t=jc(e,s))),t===1))throw n=Co,ri(e,0),Ir(e,r),Xt(e,ot()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(oe(345));case 2:Qr(e,qt,tr);break;case 3:if(Ir(e,r),(r&130023424)===r&&(t=Xf+500-ot(),10<t)){if(Wa(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){$t(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Cc(Qr.bind(null,e,qt,tr),t);break}Qr(e,qt,tr);break;case 4:if(Ir(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-Bn(r);s=1<<o,o=t[o],o>i&&(i=o),r&=~s}if(r=i,r=ot()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*iE(r/1960))-r,10<r){e.timeoutHandle=Cc(Qr.bind(null,e,qt,tr),r);break}Qr(e,qt,tr);break;case 5:Qr(e,qt,tr);break;default:throw Error(oe(329))}}}return Xt(e,ot()),e.callbackNode===n?px.bind(null,e):null}function jc(e,t){var n=Zs;return e.current.memoizedState.isDehydrated&&(ri(e,t).flags|=256),e=cl(e,t),e!==2&&(t=qt,qt=n,t!==null&&Wc(t)),e}function Wc(e){qt===null?qt=e:qt.push.apply(qt,e)}function sE(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Hn(s(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ir(e,t){for(t&=~Yf,t&=~jl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Bn(t),r=1<<n;e[n]=-1,t&=~r}}function G0(e){if(Fe&6)throw Error(oe(327));Ki();var t=Wa(e,0);if(!(t&1))return Xt(e,ot()),null;var n=cl(e,t);if(e.tag!==0&&n===2){var r=xc(e);r!==0&&(t=r,n=jc(e,r))}if(n===1)throw n=Co,ri(e,0),Ir(e,t),Xt(e,ot()),n;if(n===6)throw Error(oe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Qr(e,qt,tr),Xt(e,ot()),null}function Qf(e,t){var n=Fe;Fe|=1;try{return e(t)}finally{Fe=n,Fe===0&&(fs=ot()+500,Vl&&Jr())}}function ci(e){Rr!==null&&Rr.tag===0&&!(Fe&6)&&Ki();var t=Fe;Fe|=1;var n=wn.transition,r=Ve;try{if(wn.transition=null,Ve=1,e)return e()}finally{Ve=r,wn.transition=n,Fe=t,!(Fe&6)&&Jr()}}function Zf(){sn=Gi.current,Xe(Gi)}function ri(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,D2(n)),lt!==null)for(n=lt.return;n!==null;){var r=n;switch(Mf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Xa();break;case 3:us(),Xe(Kt),Xe(Ot),Hf();break;case 5:Vf(r);break;case 4:us();break;case 13:Xe(et);break;case 19:Xe(et);break;case 10:Of(r.type._context);break;case 22:case 23:Zf()}n=n.return}if(vt=e,lt=e=Gr(e.current,null),At=sn=t,ht=0,Co=null,Yf=jl=ui=0,qt=Zs=null,ti!==null){for(t=0;t<ti.length;t++)if(n=ti[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}ti=null}return e}function mx(e,t){do{var n=lt;try{if(Lf(),Ma.current=ol,sl){for(var r=tt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}sl=!1}if(li=0,pt=dt=tt=null,Xs=!1,_o=0,Kf.current=null,n===null||n.return===null){ht=1,Co=t,lt=null;break}e:{var s=e,o=n.return,a=n,l=t;if(t=At,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,p=c.tag;if(!(c.mode&1)&&(p===0||p===11||p===15)){var m=c.alternate;m?(c.updateQueue=m.updateQueue,c.memoizedState=m.memoizedState,c.lanes=m.lanes):(c.updateQueue=null,c.memoizedState=null)}var g=N0(o);if(g!==null){g.flags&=-257,I0(g,o,a,s,t),g.mode&1&&A0(s,u,t),t=g,l=u;var y=t.updateQueue;if(y===null){var x=new Set;x.add(l),t.updateQueue=x}else y.add(l);break e}else{if(!(t&1)){A0(s,u,t),ed();break e}l=Error(oe(426))}}else if(Ze&&a.mode&1){var S=N0(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),I0(S,o,a,s,t),bf(cs(l,a));break e}}s=l=cs(l,a),ht!==4&&(ht=2),Zs===null?Zs=[s]:Zs.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var T=Qg(s,l,t);E0(s,T);break e;case 1:a=l;var E=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof E.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Ur===null||!Ur.has(_)))){s.flags|=65536,t&=-t,s.lanes|=t;var N=Zg(s,a,t);E0(s,N);break e}}s=s.return}while(s!==null)}vx(n)}catch(B){t=B,lt===n&&n!==null&&(lt=n=n.return);continue}break}while(!0)}function gx(){var e=al.current;return al.current=ol,e===null?ol:e}function ed(){(ht===0||ht===3||ht===2)&&(ht=4),vt===null||!(ui&268435455)&&!(jl&268435455)||Ir(vt,At)}function cl(e,t){var n=Fe;Fe|=2;var r=gx();(vt!==e||At!==t)&&(tr=null,ri(e,t));do try{oE();break}catch(i){mx(e,i)}while(!0);if(Lf(),Fe=n,al.current=r,lt!==null)throw Error(oe(261));return vt=null,At=0,ht}function oE(){for(;lt!==null;)xx(lt)}function aE(){for(;lt!==null&&!Fy();)xx(lt)}function xx(e){var t=Ex(e.alternate,e,sn);e.memoizedProps=e.pendingProps,t===null?vx(e):lt=t,Kf.current=null}function vx(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=eE(n,t),n!==null){n.flags&=32767,lt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ht=6,lt=null;return}}else if(n=Z2(n,t,sn),n!==null){lt=n;return}if(t=t.sibling,t!==null){lt=t;return}lt=t=e}while(t!==null);ht===0&&(ht=5)}function Qr(e,t,n){var r=Ve,i=wn.transition;try{wn.transition=null,Ve=1,lE(e,t,n,r)}finally{wn.transition=i,Ve=r}return null}function lE(e,t,n,r){do Ki();while(Rr!==null);if(Fe&6)throw Error(oe(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(oe(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(Hy(e,s),e===vt&&(lt=vt=null,At=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||pa||(pa=!0,Tx(ja,function(){return Ki(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=wn.transition,wn.transition=null;var o=Ve;Ve=1;var a=Fe;Fe|=4,Kf.current=null,nE(e,n),dx(n,e),I2(Sc),qa=!!_c,Sc=_c=null,e.current=n,rE(n),My(),Fe=a,Ve=o,wn.transition=s}else e.current=n;if(pa&&(pa=!1,Rr=e,ul=i),s=e.pendingLanes,s===0&&(Ur=null),Ly(n.stateNode),Xt(e,ot()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ll)throw ll=!1,e=$c,$c=null,e;return ul&1&&e.tag!==0&&Ki(),s=e.pendingLanes,s&1?e===zc?eo++:(eo=0,zc=e):eo=0,Jr(),null}function Ki(){if(Rr!==null){var e=Qm(ul),t=wn.transition,n=Ve;try{if(wn.transition=null,Ve=16>e?16:e,Rr===null)var r=!1;else{if(e=Rr,Rr=null,ul=0,Fe&6)throw Error(oe(331));var i=Fe;for(Fe|=4,xe=e.current;xe!==null;){var s=xe,o=s.child;if(xe.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(xe=u;xe!==null;){var c=xe;switch(c.tag){case 0:case 11:case 15:Qs(8,c,s)}var p=c.child;if(p!==null)p.return=c,xe=p;else for(;xe!==null;){c=xe;var m=c.sibling,g=c.return;if(ux(c),c===u){xe=null;break}if(m!==null){m.return=g,xe=m;break}xe=g}}}var y=s.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var S=x.sibling;x.sibling=null,x=S}while(x!==null)}}xe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,xe=o;else e:for(;xe!==null;){if(s=xe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Qs(9,s,s.return)}var T=s.sibling;if(T!==null){T.return=s.return,xe=T;break e}xe=s.return}}var E=e.current;for(xe=E;xe!==null;){o=xe;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,xe=_;else e:for(o=E;xe!==null;){if(a=xe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:zl(9,a)}}catch(B){rt(a,a.return,B)}if(a===o){xe=null;break e}var N=a.sibling;if(N!==null){N.return=a.return,xe=N;break e}xe=a.return}}if(Fe=i,Jr(),Yn&&typeof Yn.onPostCommitFiberRoot=="function")try{Yn.onPostCommitFiberRoot(Ll,e)}catch{}r=!0}return r}finally{Ve=n,wn.transition=t}}return!1}function V0(e,t,n){t=cs(n,t),t=Qg(e,t,1),e=Or(e,t,1),t=$t(),e!==null&&(bo(e,1,t),Xt(e,t))}function rt(e,t,n){if(e.tag===3)V0(e,e,n);else for(;t!==null;){if(t.tag===3){V0(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ur===null||!Ur.has(r))){e=cs(n,e),e=Zg(t,e,1),t=Or(t,e,1),e=$t(),t!==null&&(bo(t,1,e),Xt(t,e));break}}t=t.return}}function uE(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=$t(),e.pingedLanes|=e.suspendedLanes&n,vt===e&&(At&n)===n&&(ht===4||ht===3&&(At&130023424)===At&&500>ot()-Xf?ri(e,0):Yf|=n),Xt(e,t)}function yx(e,t){t===0&&(e.mode&1?(t=ia,ia<<=1,!(ia&130023424)&&(ia=4194304)):t=1);var n=$t();e=fr(e,t),e!==null&&(bo(e,t,n),Xt(e,n))}function cE(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),yx(e,n)}function fE(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(oe(314))}r!==null&&r.delete(t),yx(e,n)}var Ex;Ex=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Kt.current)Jt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Jt=!1,Q2(e,t,n);Jt=!!(e.flags&131072)}else Jt=!1,Ze&&t.flags&1048576&&wg(t,el,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Da(e,t),e=t.pendingProps;var i=os(t,Ot.current);Ji(t,n),i=zf(null,t,r,e,i,n);var s=jf();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Yt(r)?(s=!0,Qa(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Bf(t),i.updater=$l,t.stateNode=i,i._reactInternals=t,Fc(t,r,e,n),t=Dc(null,t,r,!0,s,n)):(t.tag=0,Ze&&s&&Ff(t),Gt(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Da(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=hE(r),e=bn(r,e),i){case 0:t=bc(null,t,r,e,n);break e;case 1:t=P0(null,t,r,e,n);break e;case 11:t=k0(null,t,r,e,n);break e;case 14:t=R0(null,t,r,bn(r.type,e),n);break e}throw Error(oe(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:bn(r,i),bc(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:bn(r,i),P0(e,t,r,i,n);case 3:e:{if(rx(t),e===null)throw Error(oe(387));r=t.pendingProps,s=t.memoizedState,i=s.element,Rg(e,t),rl(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=cs(Error(oe(423)),t),t=F0(e,t,r,n,i);break e}else if(r!==i){i=cs(Error(oe(424)),t),t=F0(e,t,r,n,i);break e}else for(un=Lr(t.stateNode.containerInfo.firstChild),cn=t,Ze=!0,Ln=null,n=Ig(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(as(),r===i){t=dr(e,t,n);break e}Gt(e,t,r,n)}t=t.child}return t;case 5:return Pg(t),e===null&&kc(t),r=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,wc(r,i)?o=null:s!==null&&wc(r,s)&&(t.flags|=32),nx(e,t),Gt(e,t,o,n),t.child;case 6:return e===null&&kc(t),null;case 13:return ix(e,t,n);case 4:return Gf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ls(t,null,r,n):Gt(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:bn(r,i),k0(e,t,r,i,n);case 7:return Gt(e,t,t.pendingProps,n),t.child;case 8:return Gt(e,t,t.pendingProps.children,n),t.child;case 12:return Gt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Je(tl,r._currentValue),r._currentValue=o,s!==null)if(Hn(s.value,o)){if(s.children===i.children&&!Kt.current){t=dr(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=sr(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Rc(s.return,n,t),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(oe(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Rc(o,n,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Gt(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ji(t,n),i=An(i),r=r(i),t.flags|=1,Gt(e,t,r,n),t.child;case 14:return r=t.type,i=bn(r,t.pendingProps),i=bn(r.type,i),R0(e,t,r,i,n);case 15:return ex(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:bn(r,i),Da(e,t),t.tag=1,Yt(r)?(e=!0,Qa(t)):e=!1,Ji(t,n),Xg(t,r,i),Fc(t,r,i,n),Dc(null,t,r,!0,e,n);case 19:return sx(e,t,n);case 22:return tx(e,t,n)}throw Error(oe(156,t.tag))};function Tx(e,t){return Jm(e,t)}function dE(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sn(e,t,n,r){return new dE(e,t,n,r)}function td(e){return e=e.prototype,!(!e||!e.isReactComponent)}function hE(e){if(typeof e=="function")return td(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ef)return 11;if(e===Tf)return 14}return 2}function Gr(e,t){var n=e.alternate;return n===null?(n=Sn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ua(e,t,n,r,i,s){var o=2;if(r=e,typeof e=="function")td(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Ri:return ii(n.children,i,s,t);case yf:o=8,i|=8;break;case nc:return e=Sn(12,n,t,i|2),e.elementType=nc,e.lanes=s,e;case rc:return e=Sn(13,n,t,i),e.elementType=rc,e.lanes=s,e;case ic:return e=Sn(19,n,t,i),e.elementType=ic,e.lanes=s,e;case Pm:return Wl(n,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case km:o=10;break e;case Rm:o=9;break e;case Ef:o=11;break e;case Tf:o=14;break e;case Cr:o=16,r=null;break e}throw Error(oe(130,e==null?e:typeof e,""))}return t=Sn(o,n,t,i),t.elementType=e,t.type=r,t.lanes=s,t}function ii(e,t,n,r){return e=Sn(7,e,r,t),e.lanes=n,e}function Wl(e,t,n,r){return e=Sn(22,e,r,t),e.elementType=Pm,e.lanes=n,e.stateNode={isHidden:!1},e}function Vu(e,t,n){return e=Sn(6,e,null,t),e.lanes=n,e}function Hu(e,t,n){return t=Sn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function pE(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_u(0),this.expirationTimes=_u(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_u(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function nd(e,t,n,r,i,s,o,a,l){return e=new pE(e,t,n,a,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Sn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bf(s),e}function mE(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ki,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function _x(e){if(!e)return Hr;e=e._reactInternals;e:{if(mi(e)!==e||e.tag!==1)throw Error(oe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Yt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(oe(171))}if(e.tag===1){var n=e.type;if(Yt(n))return _g(e,n,t)}return t}function Sx(e,t,n,r,i,s,o,a,l){return e=nd(n,r,!0,e,i,s,o,a,l),e.context=_x(null),n=e.current,r=$t(),i=Br(n),s=sr(r,i),s.callback=t??null,Or(n,s,i),e.current.lanes=i,bo(e,i,r),Xt(e,r),e}function ql(e,t,n,r){var i=t.current,s=$t(),o=Br(i);return n=_x(n),t.context===null?t.context=n:t.pendingContext=n,t=sr(s,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Or(i,t,o),e!==null&&(Gn(e,i,o,s),Fa(e,i,o)),o}function fl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function H0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function rd(e,t){H0(e,t),(e=e.alternate)&&H0(e,t)}function gE(){return null}var wx=typeof reportError=="function"?reportError:function(e){console.error(e)};function id(e){this._internalRoot=e}Jl.prototype.render=id.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(oe(409));ql(e,t,null,null)};Jl.prototype.unmount=id.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ci(function(){ql(null,e,null,null)}),t[cr]=null}};function Jl(e){this._internalRoot=e}Jl.prototype.unstable_scheduleHydration=function(e){if(e){var t=tg();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Nr.length&&t!==0&&t<Nr[n].priority;n++);Nr.splice(n,0,e),n===0&&rg(e)}};function sd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Kl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function $0(){}function xE(e,t,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=fl(o);s.call(u)}}var o=Sx(t,r,e,0,null,!1,!1,"",$0);return e._reactRootContainer=o,e[cr]=o.current,xo(e.nodeType===8?e.parentNode:e),ci(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=fl(l);a.call(u)}}var l=nd(e,0,!1,null,null,!1,!1,"",$0);return e._reactRootContainer=l,e[cr]=l.current,xo(e.nodeType===8?e.parentNode:e),ci(function(){ql(t,l,n,r)}),l}function Yl(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=fl(o);a.call(l)}}ql(t,o,e,i)}else o=xE(n,t,e,i,r);return fl(o)}Zm=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=$s(t.pendingLanes);n!==0&&(wf(t,n|1),Xt(t,ot()),!(Fe&6)&&(fs=ot()+500,Jr()))}break;case 13:ci(function(){var r=fr(e,1);if(r!==null){var i=$t();Gn(r,e,1,i)}}),rd(e,1)}};Cf=function(e){if(e.tag===13){var t=fr(e,134217728);if(t!==null){var n=$t();Gn(t,e,134217728,n)}rd(e,134217728)}};eg=function(e){if(e.tag===13){var t=Br(e),n=fr(e,t);if(n!==null){var r=$t();Gn(n,e,t,r)}rd(e,t)}};tg=function(){return Ve};ng=function(e,t){var n=Ve;try{return Ve=e,t()}finally{Ve=n}};pc=function(e,t,n){switch(t){case"input":if(ac(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Gl(r);if(!i)throw Error(oe(90));Mm(r),ac(r,i)}}}break;case"textarea":Dm(e,n);break;case"select":t=n.value,t!=null&&zi(e,!!n.multiple,t,!1)}};Hm=Qf;$m=ci;var vE={usingClientEntryPoint:!1,Events:[Lo,bi,Gl,Gm,Vm,Qf]},Os={findFiberByHostInstance:ei,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yE={bundleType:Os.bundleType,version:Os.version,rendererPackageName:Os.rendererPackageName,rendererConfig:Os.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Wm(e),e===null?null:e.stateNode},findFiberByHostInstance:Os.findFiberByHostInstance||gE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ma=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ma.isDisabled&&ma.supportsFiber)try{Ll=ma.inject(yE),Yn=ma}catch{}}hn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vE;hn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sd(t))throw Error(oe(200));return mE(e,t,null,n)};hn.createRoot=function(e,t){if(!sd(e))throw Error(oe(299));var n=!1,r="",i=wx;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=nd(e,1,!1,null,null,n,!1,r,i),e[cr]=t.current,xo(e.nodeType===8?e.parentNode:e),new id(t)};hn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(oe(188)):(e=Object.keys(e).join(","),Error(oe(268,e)));return e=Wm(t),e=e===null?null:e.stateNode,e};hn.flushSync=function(e){return ci(e)};hn.hydrate=function(e,t,n){if(!Kl(t))throw Error(oe(200));return Yl(null,e,t,!0,n)};hn.hydrateRoot=function(e,t,n){if(!sd(e))throw Error(oe(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=wx;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Sx(t,null,e,1,n??null,i,!1,s,o),e[cr]=t.current,xo(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Jl(t)};hn.render=function(e,t,n){if(!Kl(t))throw Error(oe(200));return Yl(null,e,t,!1,n)};hn.unmountComponentAtNode=function(e){if(!Kl(e))throw Error(oe(40));return e._reactRootContainer?(ci(function(){Yl(null,null,e,!1,function(){e._reactRootContainer=null,e[cr]=null})}),!0):!1};hn.unstable_batchedUpdates=Qf;hn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Kl(n))throw Error(oe(200));if(e==null||e._reactInternals===void 0)throw Error(oe(38));return Yl(e,t,n,!1,r)};hn.version="18.3.1-next-f1338f8080-20240426";function Cx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Cx)}catch(e){console.error(e)}}Cx(),Cm.exports=hn;var EE=Cm.exports,z0=EE;ec.createRoot=z0.createRoot,ec.hydrateRoot=z0.hydrateRoot;/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TE=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ax=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var _E={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SE=Te.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...a},l)=>Te.createElement("svg",{ref:l,..._E,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:Ax("lucide",i),...a},[...o.map(([u,c])=>Te.createElement(u,c)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=(e,t)=>{const n=Te.forwardRef(({className:r,...i},s)=>Te.createElement(SE,{ref:s,iconNode:t,className:Ax(`lucide-${TE(e)}`,r),...i}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j0=Se("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wE=Se("Baby",[["path",{d:"M9 12h.01",key:"157uk2"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"5yv0yz"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CE=Se("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AE=Se("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yi=Se("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NE=Se("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IE=Se("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nx=Se("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kE=Se("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RE=Se("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PE=Se("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FE=Se("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W0=Se("Combine",[["path",{d:"M10 18H5a3 3 0 0 1-3-3v-1",key:"ru65g8"}],["path",{d:"M14 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"e30een"}],["path",{d:"M20 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"2ahx8o"}],["path",{d:"m7 21 3-3-3-3",key:"127cv2"}],["rect",{x:"14",y:"14",width:"8",height:"8",rx:"2",key:"1b0bso"}],["rect",{x:"2",y:"2",width:"8",height:"8",rx:"2",key:"1x09vl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=Se("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qc=Se("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bE=Se("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dl=Se("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=Se("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hl=Se("FileCode",[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DE=Se("FileSearch",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jc=Se("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $u=Se("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zu=Se("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LE=Se("Flower2",[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xi=Se("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J0=Se("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OE=Se("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ix=Se("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K0=Se("Hammer",[["path",{d:"m15 12-8.373 8.373a1 1 0 1 1-3-3L12 9",key:"eefl8a"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172V7l-2.26-2.26a6 6 0 0 0-4.202-1.756L9 2.96l.92.82A6.18 6.18 0 0 1 12 8.4V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"b7pghm"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vi=Se("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kx=Se("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=Se("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UE=Se("LayoutList",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pl=Se("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=Se("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BE=Se("ListPlus",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=Se("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GE=Se("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VE=Se("Microscope",[["path",{d:"M6 18h8",key:"1borvv"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M14 22a7 7 0 1 0 0-14h-1",key:"1jwaiy"}],["path",{d:"M9 14h2",key:"197e7h"}],["path",{d:"M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z",key:"1bmzmy"}],["path",{d:"M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3",key:"1drr47"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=Se("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xc=Se("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=Se("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HE=Se("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ml=Se("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X0=Se("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q0=Se("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z0=Se("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eh=Se("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $E=Se("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ju=Se("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zE=Se("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jE=Se("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WE=Se("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=Se("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ni=Se("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const th=Se("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=Se("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var gl={};gl.version="0.18.5";var Rx=1252,qE=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Px=function(e){qE.indexOf(e)!=-1&&(Rx=e)};function JE(){Px(1252)}var Ao=function(e){Px(e)};function KE(){Ao(1200),JE()}var xa=function(t){return String.fromCharCode(t)},nh=function(t){return String.fromCharCode(t)},xl,Pr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function No(e){for(var t="",n=0,r=0,i=0,s=0,o=0,a=0,l=0,u=0;u<e.length;)n=e.charCodeAt(u++),s=n>>2,r=e.charCodeAt(u++),o=(n&3)<<4|r>>4,i=e.charCodeAt(u++),a=(r&15)<<2|i>>6,l=i&63,isNaN(r)?a=l=64:isNaN(i)&&(l=64),t+=Pr.charAt(s)+Pr.charAt(o)+Pr.charAt(a)+Pr.charAt(l);return t}function hr(e){var t="",n=0,r=0,i=0,s=0,o=0,a=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=Pr.indexOf(e.charAt(u++)),o=Pr.indexOf(e.charAt(u++)),n=s<<2|o>>4,t+=String.fromCharCode(n),a=Pr.indexOf(e.charAt(u++)),r=(o&15)<<4|a>>2,a!==64&&(t+=String.fromCharCode(r)),l=Pr.indexOf(e.charAt(u++)),i=(a&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Oe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),xr=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function fi(e){return Oe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function rh(e){return Oe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var On=function(t){return Oe?xr(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function Xl(e){if(typeof ArrayBuffer>"u")return On(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=e.charCodeAt(r)&255;return t}function Uo(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function YE(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var wt=Oe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:xr(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),i=0;for(t=0,n=0;t<e.length;n+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function XE(e){for(var t=[],n=0,r=e.length+250,i=fi(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[n++]=o;else if(o<2048)i[n++]=192|o>>6&31,i[n++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=e.charCodeAt(++s)&1023;i[n++]=240|o>>8&7,i[n++]=128|o>>2&63,i[n++]=128|a>>6&15|(o&3)<<4,i[n++]=128|a&63}else i[n++]=224|o>>12&15,i[n++]=128|o>>6&63,i[n++]=128|o&63;n>r&&(t.push(i.slice(0,n)),n=0,i=fi(65535),r=65530)}return t.push(i.slice(0,n)),wt(t)}var to=/\u0000/g,va=/[\u0001-\u0006]/g;function Qi(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Un(e,t){var n=""+e;return n.length>=t?n:it("0",t-n.length)+n}function od(e,t){var n=""+e;return n.length>=t?n:it(" ",t-n.length)+n}function vl(e,t){var n=""+e;return n.length>=t?n:n+it(" ",t-n.length)}function QE(e,t){var n=""+Math.round(e);return n.length>=t?n:it("0",t-n.length)+n}function ZE(e,t){var n=""+e;return n.length>=t?n:it("0",t-n.length)+n}var ih=Math.pow(2,32);function wi(e,t){if(e>ih||e<-ih)return QE(e,t);var n=Math.round(e);return ZE(n,t)}function yl(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var sh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Wu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function eT(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var st={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},oh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},tT={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function El(e,t,n){for(var r=e<0?-1:1,i=e*r,s=0,o=1,a=0,l=1,u=0,c=0,p=Math.floor(i);u<t&&(p=Math.floor(i),a=p*o+s,c=p*u+l,!(i-p<5e-8));)i=1/(i-p),s=o,o=a,l=u,u=c;if(c>t&&(u>t?(c=l,a=s):(c=u,a=o)),!n)return[0,r*a,c];var m=Math.floor(r*a/c);return[m,r*a-m*c,c]}function ya(e,t,n){if(e>2958465||e<0)return null;var r=e|0,i=Math.floor(86400*(e-r)),s=0,o=[],a={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(r+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++r,++a.D)),r===60)o=n?[1317,10,29]:[1900,2,29],s=3;else if(r===0)o=n?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),n&&(s=lT(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var Fx=new Date(1899,11,31,0,0,0),nT=Fx.getTime(),rT=new Date(1900,2,1,0,0,0);function Mx(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=rT&&(n+=24*60*60*1e3),(n-(nT+(e.getTimezoneOffset()-Fx.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ad(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function iT(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function sT(e){var t=e<0?12:11,n=ad(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function oT(e){var t=ad(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function aT(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=sT(e):t===10?n=e.toFixed(10).substr(0,12):n=oT(e),ad(iT(n.toUpperCase()))}function Qc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):aT(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return $r(14,Mx(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function lT(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function uT(e,t,n,r){var i="",s=0,o=0,a=n.y,l,u=0;switch(e){case 98:a=n.y+543;case 121:switch(t.length){case 1:case 2:l=a%100,u=2;break;default:l=a%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=n.m,u=t.length;break;case 3:return Wu[n.m-1][1];case 5:return Wu[n.m-1][0];default:return Wu[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=n.d,u=t.length;break;case 3:return sh[n.q][0];default:return sh[n.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(n.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=n.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=n.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?Un(n.S,t.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,s=Math.round(o*(n.S+n.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=Un(s,2+r),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=n.D*24+n.H;break;case"[m]":case"[mm]":l=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":l=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=a,u=1;break}var c=u>0?Un(l,u):"";return c}function Fr(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,r=e.substr(0,n);n!=e.length;n+=t)r+=(r.length>0?",":"")+e.substr(n,t);return r}var bx=/%/g;function cT(e,t,n){var r=t.replace(bx,""),i=t.length-r.length;return or(e,r,n*Math.pow(10,2*i))+it("%",i)}function fT(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return or(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function Dx(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Dx(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),n.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,c){return l+u+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var Lx=/# (\?+)( ?)\/( ?)(\d+)/;function dT(e,t,n){var r=parseInt(e[4],10),i=Math.round(t*r),s=Math.floor(i/r),o=i-s*r,a=r;return n+(s===0?"":""+s)+" "+(o===0?it(" ",e[1].length+1+e[4].length):od(o,e[1].length)+e[2]+"/"+e[3]+Un(a,e[4].length))}function hT(e,t,n){return n+(t===0?"":""+t)+it(" ",e[1].length+2+e[4].length)}var Ox=/^#*0*\.([0#]+)/,Ux=/\).*[0#]/,Bx=/\(###\) ###\\?-####/;function Vt(e){for(var t="",n,r=0;r!=e.length;++r)switch(n=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function ah(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function lh(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function pT(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function mT(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function xn(e,t,n){if(e.charCodeAt(0)===40&&!t.match(Ux)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?xn("n",r,n):"("+xn("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return fT(e,t,n);if(t.indexOf("%")!==-1)return cT(e,t,n);if(t.indexOf("E")!==-1)return Dx(t,n);if(t.charCodeAt(0)===36)return"$"+xn(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,o,a,l=Math.abs(n),u=n<0?"-":"";if(t.match(/^00+$/))return u+wi(l,t.length);if(t.match(/^[#?]+$/))return i=wi(n,0),i==="0"&&(i=""),i.length>t.length?i:Vt(t.substr(0,t.length-i.length))+i;if(s=t.match(Lx))return dT(s,l,u);if(t.match(/^#+0+$/))return u+wi(l,t.length-t.indexOf("0"));if(s=t.match(Ox))return i=ah(n,s[1].length).replace(/^([^\.]+)$/,"$1."+Vt(s[1])).replace(/\.$/,"."+Vt(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+it("0",Vt(s[1]).length-x.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+ah(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Fr(wi(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+xn(e,t,-n):Fr(""+(Math.floor(n)+pT(n,s[1].length)))+"."+Un(lh(n,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return xn(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Qi(xn(e,t.replace(/[\\-]/g,""),n)),o=0,Qi(Qi(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(t.match(Bx))return i=xn(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=El(l,Math.pow(10,o)-1,!1),i=""+u,c=or("n",s[1],a[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=vl(a[2],o),c.length<s[4].length&&(c=Vt(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=El(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?od(a[1],o)+s[2]+"/"+s[3]+vl(a[2],o):it(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=wi(n,0),t.length<=i.length?i:Vt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var p=t.indexOf(".")-o,m=t.length-i.length-p;return Vt(t.substr(0,p)+i+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=lh(n,s[1].length),n<0?"-"+xn(e,t,-n):Fr(mT(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Un(0,3-y.length):"")+y})+"."+Un(o,s[1].length);switch(t){case"###,##0.00":return xn(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var g=Fr(wi(l,0));return g!=="0"?u+g:"";case"###,###.00":return xn(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return xn(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function gT(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return or(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function xT(e,t,n){var r=t.replace(bx,""),i=t.length-r.length;return or(e,r,n*Math.pow(10,2*i))+it("%",i)}function Gx(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Gx(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!n.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,c){return l+u+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Wn(e,t,n){if(e.charCodeAt(0)===40&&!t.match(Ux)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Wn("n",r,n):"("+Wn("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return gT(e,t,n);if(t.indexOf("%")!==-1)return xT(e,t,n);if(t.indexOf("E")!==-1)return Gx(t,n);if(t.charCodeAt(0)===36)return"$"+Wn(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,o,a,l=Math.abs(n),u=n<0?"-":"";if(t.match(/^00+$/))return u+Un(l,t.length);if(t.match(/^[#?]+$/))return i=""+n,n===0&&(i=""),i.length>t.length?i:Vt(t.substr(0,t.length-i.length))+i;if(s=t.match(Lx))return hT(s,l,u);if(t.match(/^#+0+$/))return u+Un(l,t.length-t.indexOf("0"));if(s=t.match(Ox))return i=(""+n).replace(/^([^\.]+)$/,"$1."+Vt(s[1])).replace(/\.$/,"."+Vt(s[1])),i=i.replace(/\.(\d*)$/,function(y,x){return"."+x+it("0",Vt(s[1]).length-x.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Fr(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Wn(e,t,-n):Fr(""+n)+"."+it("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Wn(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Qi(Wn(e,t.replace(/[\\-]/g,""),n)),o=0,Qi(Qi(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(t.match(Bx))return i=Wn(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=El(l,Math.pow(10,o)-1,!1),i=""+u,c=or("n",s[1],a[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=vl(a[2],o),c.length<s[4].length&&(c=Vt(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=El(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?od(a[1],o)+s[2]+"/"+s[3]+vl(a[2],o):it(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+n,t.length<=i.length?i:Vt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var p=t.indexOf(".")-o,m=t.length-i.length-p;return Vt(t.substr(0,p)+i+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Wn(e,t,-n):Fr(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Un(0,3-y.length):"")+y})+"."+Un(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=Fr(""+l);return g!=="0"?u+g:"";default:if(t.match(/\.[0#?]*$/))return Wn(e,t.slice(0,t.lastIndexOf(".")),n)+Vt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function or(e,t,n){return(n|0)===n?Wn(e,t,n):xn(e,t,n)}function vT(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Vx=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Hx(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":yl(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=n;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(Vx))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function yT(e,t,n,r){for(var i=[],s="",o=0,a="",l="t",u,c,p,m="H";o<e.length;)switch(a=e.charAt(o)){case"G":if(!yl(e,o))throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(p=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(p);i[i.length]={t:"t",v:s},++o;break;case"\\":var g=e.charAt(++o),y=g==="("||g===")"?g:"t";i[i.length]={t:y,v:g},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=ya(t,n,e.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=ya(t,n),u==null))return"";for(s=a;++o<e.length&&e.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=m),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"":var x={t:a,v:a};if(u==null&&(u=ya(t,n)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",m="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",o+=5,m="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",o+=5,m="h"):(x.t="t",++o),u==null&&x.t==="T")return"";i[i.length]=x,l=a;break;case"[":for(s=a;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Vx)){if(u==null&&(u=ya(t,n),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Hx(e)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=a;++o<e.length&&(a=e.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<e.length&&"0#?.,E+-%".indexOf(a=e.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;e.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:r===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"t",v:a},++o;break}var S=0,T=0,E;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=m,l="h",S<1&&(S=1);break;case"s":(E=i[o].v.match(/\.0+$/))&&(T=Math.max(T,E[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[o].v.match(/[Hh]/)&&(S=1),S<2&&i[o].v.match(/[Mm]/)&&(S=2),S<3&&i[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",N;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=uT(i[o].t.charCodeAt(0),i[o].v,u,T),i[o].t="t";break;case"n":case"?":for(N=o+1;i[N]!=null&&((a=i[N].t)==="?"||a==="D"||(a===" "||a==="t")&&i[N+1]!=null&&(i[N+1].t==="?"||i[N+1].t==="t"&&i[N+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[N].v==="/"||i[N].v===" "&&i[N+1]!=null&&i[N+1].t=="?"));)i[o].v+=i[N].v,i[N]={v:"",t:";"},++N;_+=i[o].v,o=N-1;break;case"G":i[o].t="t",i[o].v=Qc(t,n);break}var B="",G,k;if(_.length>0){_.charCodeAt(0)==40?(G=t<0&&_.charCodeAt(0)===45?-t:t,k=or("n",_,G)):(G=t<0&&r>1?-t:t,k=or("n",_,G),G<0&&i[0]&&i[0].t=="t"&&(k=k.substr(1),i[0].v="-"+i[0].v)),N=k.length-1;var D=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){D=o;break}var b=i.length;if(D===i.length&&k.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(N>=i[o].v.length-1?(N-=i[o].v.length,i[o].v=k.substr(N+1,i[o].v.length)):N<0?i[o].v="":(i[o].v=k.substr(0,N+1),N=-1),i[o].t="t",b=o);N>=0&&b<i.length&&(i[b].v=k.substr(0,N+1)+i[b].v)}else if(D!==i.length&&k.indexOf("E")===-1){for(N=k.indexOf(".")-1,o=D;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(c=i[o].v.indexOf(".")>-1&&o===D?i[o].v.indexOf(".")-1:i[o].v.length-1,B=i[o].v.substr(c+1);c>=0;--c)N>=0&&(i[o].v.charAt(c)==="0"||i[o].v.charAt(c)==="#")&&(B=k.charAt(N--)+B);i[o].v=B,i[o].t="t",b=o}for(N>=0&&b<i.length&&(i[b].v=k.substr(0,N+1)+i[b].v),N=k.indexOf(".")+1,o=D;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==D)){for(c=i[o].v.indexOf(".")>-1&&o===D?i[o].v.indexOf(".")+1:0,B=i[o].v.substr(0,c);c<i[o].v.length;++c)N<k.length&&(B+=k.charAt(N++));i[o].v=B,i[o].t="t",b=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(G=r>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=or(i[o].t,i[o].v,G),i[o].t="t");var O="";for(o=0;o!==i.length;++o)i[o]!=null&&(O+=i[o].v);return O}var uh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ch(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function ET(e,t){var n=vT(e),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var s=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,s];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var o=n[0].match(uh),a=n[1].match(uh);return ch(t,o)?[r,n[0]]:ch(t,a)?[r,n[1]]:[r,n[o!=null&&a!=null?2:1]]}return[r,s]}function $r(e,t,n){n==null&&(n={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?r=n.dateNF:r=e;break;case"number":e==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:st)[e],r==null&&(r=n.table&&n.table[oh[e]]||st[oh[e]]),r==null&&(r=tT[e]||"General");break}if(yl(r,0))return Qc(t,n);t instanceof Date&&(t=Mx(t,n.date1904));var i=ET(r,t);if(yl(i[1]))return Qc(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return yT(i[1],t,n,i[0])}function $x(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(st[n]==null){t<0&&(t=n);continue}if(st[n]==e){t=n;break}}t<0&&(t=391)}return st[t]=e,t}function Ql(e){for(var t=0;t!=392;++t)e[t]!==void 0&&$x(e[t],t)}function Zl(){st=eT()}var zx=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function TT(e){var t=typeof e=="number"?st[e]:e;return t=t.replace(zx,"(\\d+)"),new RegExp("^"+t+"$")}function _T(e,t,n){var r=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(t.match(zx)||[]).forEach(function(p,m){var g=parseInt(n[m+1],10);switch(p.toLowerCase().charAt(0)){case"y":r=g;break;case"d":s=g;break;case"h":o=g;break;case"s":l=g;break;case"m":o>=0?a=g:i=g;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var u=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var c=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?u:r==-1&&i==-1&&s==-1?c:u+"T"+c}var ST=function(){var e={};e.version="1.2.0";function t(){for(var k=0,D=new Array(256),b=0;b!=256;++b)k=b,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,D[b]=k;return typeof Int32Array<"u"?new Int32Array(D):D}var n=t();function r(k){var D=0,b=0,O=0,J=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)J[O]=k[O];for(O=0;O!=256;++O)for(b=k[O],D=256+O;D<4096;D+=256)b=J[D]=b>>>8^k[b&255];var X=[];for(O=1;O!=16;++O)X[O-1]=typeof Int32Array<"u"?J.subarray(O*256,O*256+256):J.slice(O*256,O*256+256);return X}var i=r(n),s=i[0],o=i[1],a=i[2],l=i[3],u=i[4],c=i[5],p=i[6],m=i[7],g=i[8],y=i[9],x=i[10],S=i[11],T=i[12],E=i[13],_=i[14];function N(k,D){for(var b=D^-1,O=0,J=k.length;O<J;)b=b>>>8^n[(b^k.charCodeAt(O++))&255];return~b}function B(k,D){for(var b=D^-1,O=k.length-15,J=0;J<O;)b=_[k[J++]^b&255]^E[k[J++]^b>>8&255]^T[k[J++]^b>>16&255]^S[k[J++]^b>>>24]^x[k[J++]]^y[k[J++]]^g[k[J++]]^m[k[J++]]^p[k[J++]]^c[k[J++]]^u[k[J++]]^l[k[J++]]^a[k[J++]]^o[k[J++]]^s[k[J++]]^n[k[J++]];for(O+=15;J<O;)b=b>>>8^n[(b^k[J++])&255];return~b}function G(k,D){for(var b=D^-1,O=0,J=k.length,X=0,re=0;O<J;)X=k.charCodeAt(O++),X<128?b=b>>>8^n[(b^X)&255]:X<2048?(b=b>>>8^n[(b^(192|X>>6&31))&255],b=b>>>8^n[(b^(128|X&63))&255]):X>=55296&&X<57344?(X=(X&1023)+64,re=k.charCodeAt(O++)&1023,b=b>>>8^n[(b^(240|X>>8&7))&255],b=b>>>8^n[(b^(128|X>>2&63))&255],b=b>>>8^n[(b^(128|re>>6&15|(X&3)<<4))&255],b=b>>>8^n[(b^(128|re&63))&255]):(b=b>>>8^n[(b^(224|X>>12&15))&255],b=b>>>8^n[(b^(128|X>>6&63))&255],b=b>>>8^n[(b^(128|X&63))&255]);return~b}return e.table=n,e.bstr=N,e.buf=B,e.str=G,e}(),ze=function(){var t={};t.version="1.2.1";function n(w,R){for(var A=w.split("/"),I=R.split("/"),F=0,M=0,K=Math.min(A.length,I.length);F<K;++F){if(M=A[F].length-I[F].length)return M;if(A[F]!=I[F])return A[F]<I[F]?-1:1}return A.length-I.length}function r(w){if(w.charAt(w.length-1)=="/")return w.slice(0,-1).indexOf("/")===-1?w:r(w.slice(0,-1));var R=w.lastIndexOf("/");return R===-1?w:w.slice(0,R+1)}function i(w){if(w.charAt(w.length-1)=="/")return i(w.slice(0,-1));var R=w.lastIndexOf("/");return R===-1?w:w.slice(R+1)}function s(w,R){typeof R=="string"&&(R=new Date(R));var A=R.getHours();A=A<<6|R.getMinutes(),A=A<<5|R.getSeconds()>>>1,w.write_shift(2,A);var I=R.getFullYear()-1980;I=I<<4|R.getMonth()+1,I=I<<5|R.getDate(),w.write_shift(2,I)}function o(w){var R=w.read_shift(2)&65535,A=w.read_shift(2)&65535,I=new Date,F=A&31;A>>>=5;var M=A&15;A>>>=4,I.setMilliseconds(0),I.setFullYear(A+1980),I.setMonth(M-1),I.setDate(F);var K=R&31;R>>>=5;var Z=R&63;return R>>>=6,I.setHours(R),I.setMinutes(Z),I.setSeconds(K<<1),I}function a(w){on(w,0);for(var R={},A=0;w.l<=w.length-4;){var I=w.read_shift(2),F=w.read_shift(2),M=w.l+F,K={};switch(I){case 21589:A=w.read_shift(1),A&1&&(K.mtime=w.read_shift(4)),F>5&&(A&2&&(K.atime=w.read_shift(4)),A&4&&(K.ctime=w.read_shift(4))),K.mtime&&(K.mt=new Date(K.mtime*1e3));break}w.l=M,R[I]=K}return R}var l;function u(){return l||(l={})}function c(w,R){if(w[0]==80&&w[1]==75)return Jo(w,R);if((w[0]|32)==109&&(w[1]|32)==105)return Xo(w,R);if(w.length<512)throw new Error("CFB file size "+w.length+" < 512");var A=3,I=512,F=0,M=0,K=0,Z=0,v=0,C=[],P=w.slice(0,512);on(P,0);var U=p(P);switch(A=U[0],A){case 3:I=512;break;case 4:I=4096;break;case 0:if(U[1]==0)return Jo(w,R);default:throw new Error("Major Version: Expected 3 or 4 saw "+A)}I!==512&&(P=w.slice(0,I),on(P,28));var j=w.slice(0,I);m(P,A);var Y=P.read_shift(4,"i");if(A===3&&Y!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Y);P.l+=4,K=P.read_shift(4,"i"),P.l+=4,P.chk("00100000","Mini Stream Cutoff Size: "),Z=P.read_shift(4,"i"),F=P.read_shift(4,"i"),v=P.read_shift(4,"i"),M=P.read_shift(4,"i");for(var q=-1,ee=0;ee<109&&(q=P.read_shift(4,"i"),!(q<0));++ee)C[ee]=q;var te=g(w,I);S(v,M,te,I,C);var me=E(te,K,C,I);me[K].name="!Directory",F>0&&Z!==re&&(me[Z].name="!MiniFAT"),me[C[0]].name="!FAT",me.fat_addrs=C,me.ssz=I;var pe={},Ce=[],Le=[],$e=[];_(K,me,te,Ce,F,pe,Le,Z),y(Le,$e,Ce),Ce.shift();var Et={FileIndex:Le,FullPaths:$e};return R&&R.raw&&(Et.raw={header:j,sectors:te}),Et}function p(w){if(w[w.l]==80&&w[w.l+1]==75)return[0,0];w.chk(we,"Header Signature: "),w.l+=16;var R=w.read_shift(2,"u");return[w.read_shift(2,"u"),R]}function m(w,R){var A=9;switch(w.l+=2,A=w.read_shift(2)){case 9:if(R!=3)throw new Error("Sector Shift: Expected 9 saw "+A);break;case 12:if(R!=4)throw new Error("Sector Shift: Expected 12 saw "+A);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+A)}w.chk("0600","Mini Sector Shift: "),w.chk("000000000000","Reserved: ")}function g(w,R){for(var A=Math.ceil(w.length/R)-1,I=[],F=1;F<A;++F)I[F-1]=w.slice(F*R,(F+1)*R);return I[A-1]=w.slice(A*R),I}function y(w,R,A){for(var I=0,F=0,M=0,K=0,Z=0,v=A.length,C=[],P=[];I<v;++I)C[I]=P[I]=I,R[I]=A[I];for(;Z<P.length;++Z)I=P[Z],F=w[I].L,M=w[I].R,K=w[I].C,C[I]===I&&(F!==-1&&C[F]!==F&&(C[I]=C[F]),M!==-1&&C[M]!==M&&(C[I]=C[M])),K!==-1&&(C[K]=I),F!==-1&&I!=C[I]&&(C[F]=C[I],P.lastIndexOf(F)<Z&&P.push(F)),M!==-1&&I!=C[I]&&(C[M]=C[I],P.lastIndexOf(M)<Z&&P.push(M));for(I=1;I<v;++I)C[I]===I&&(M!==-1&&C[M]!==M?C[I]=C[M]:F!==-1&&C[F]!==F&&(C[I]=C[F]));for(I=1;I<v;++I)if(w[I].type!==0){if(Z=I,Z!=C[Z])do Z=C[Z],R[I]=R[Z]+"/"+R[I];while(Z!==0&&C[Z]!==-1&&Z!=C[Z]);C[I]=-1}for(R[0]+="/",I=1;I<v;++I)w[I].type!==2&&(R[I]+="/")}function x(w,R,A){for(var I=w.start,F=w.size,M=[],K=I;A&&F>0&&K>=0;)M.push(R.slice(K*X,K*X+X)),F-=X,K=Zr(A,K*4);return M.length===0?Q(0):wt(M).slice(0,w.size)}function S(w,R,A,I,F){var M=re;if(w===re){if(R!==0)throw new Error("DIFAT chain shorter than expected")}else if(w!==-1){var K=A[w],Z=(I>>>2)-1;if(!K)return;for(var v=0;v<Z&&(M=Zr(K,v*4))!==re;++v)F.push(M);S(Zr(K,I-4),R-1,A,I,F)}}function T(w,R,A,I,F){var M=[],K=[];F||(F=[]);var Z=I-1,v=0,C=0;for(v=R;v>=0;){F[v]=!0,M[M.length]=v,K.push(w[v]);var P=A[Math.floor(v*4/I)];if(C=v*4&Z,I<4+C)throw new Error("FAT boundary crossed: "+v+" 4 "+I);if(!w[P])break;v=Zr(w[P],C)}return{nodes:M,data:vh([K])}}function E(w,R,A,I){var F=w.length,M=[],K=[],Z=[],v=[],C=I-1,P=0,U=0,j=0,Y=0;for(P=0;P<F;++P)if(Z=[],j=P+R,j>=F&&(j-=F),!K[j]){v=[];var q=[];for(U=j;U>=0;){q[U]=!0,K[U]=!0,Z[Z.length]=U,v.push(w[U]);var ee=A[Math.floor(U*4/I)];if(Y=U*4&C,I<4+Y)throw new Error("FAT boundary crossed: "+U+" 4 "+I);if(!w[ee]||(U=Zr(w[ee],Y),q[U]))break}M[j]={nodes:Z,data:vh([v])}}return M}function _(w,R,A,I,F,M,K,Z){for(var v=0,C=I.length?2:0,P=R[w].data,U=0,j=0,Y;U<P.length;U+=128){var q=P.slice(U,U+128);on(q,64),j=q.read_shift(2),Y=dd(q,0,j-C),I.push(Y);var ee={name:Y,type:q.read_shift(1),color:q.read_shift(1),L:q.read_shift(4,"i"),R:q.read_shift(4,"i"),C:q.read_shift(4,"i"),clsid:q.read_shift(16),state:q.read_shift(4,"i"),start:0,size:0},te=q.read_shift(2)+q.read_shift(2)+q.read_shift(2)+q.read_shift(2);te!==0&&(ee.ct=N(q,q.l-8));var me=q.read_shift(2)+q.read_shift(2)+q.read_shift(2)+q.read_shift(2);me!==0&&(ee.mt=N(q,q.l-8)),ee.start=q.read_shift(4,"i"),ee.size=q.read_shift(4,"i"),ee.size<0&&ee.start<0&&(ee.size=ee.type=0,ee.start=re,ee.name=""),ee.type===5?(v=ee.start,F>0&&v!==re&&(R[v].name="!StreamData")):ee.size>=4096?(ee.storage="fat",R[ee.start]===void 0&&(R[ee.start]=T(A,ee.start,R.fat_addrs,R.ssz)),R[ee.start].name=ee.name,ee.content=R[ee.start].data.slice(0,ee.size)):(ee.storage="minifat",ee.size<0?ee.size=0:v!==re&&ee.start!==re&&R[v]&&(ee.content=x(ee,R[v].data,(R[Z]||{}).data))),ee.content&&on(ee.content,0),M[Y]=ee,K.push(ee)}}function N(w,R){return new Date((ln(w,R+4)/1e7*Math.pow(2,32)+ln(w,R)/1e7-11644473600)*1e3)}function B(w,R){return u(),c(l.readFileSync(w),R)}function G(w,R){var A=R&&R.type;switch(A||Oe&&Buffer.isBuffer(w)&&(A="buffer"),A||"base64"){case"file":return B(w,R);case"base64":return c(On(hr(w)),R);case"binary":return c(On(w),R)}return c(w,R)}function k(w,R){var A=R||{},I=A.root||"Root Entry";if(w.FullPaths||(w.FullPaths=[]),w.FileIndex||(w.FileIndex=[]),w.FullPaths.length!==w.FileIndex.length)throw new Error("inconsistent CFB structure");w.FullPaths.length===0&&(w.FullPaths[0]=I+"/",w.FileIndex[0]={name:I,type:5}),A.CLSID&&(w.FileIndex[0].clsid=A.CLSID),D(w)}function D(w){var R="Sh33tJ5";if(!ze.find(w,"/"+R)){var A=Q(4);A[0]=55,A[1]=A[3]=50,A[2]=54,w.FileIndex.push({name:R,type:2,content:A,size:4,L:69,R:69,C:69}),w.FullPaths.push(w.FullPaths[0]+R),b(w)}}function b(w,R){k(w);for(var A=!1,I=!1,F=w.FullPaths.length-1;F>=0;--F){var M=w.FileIndex[F];switch(M.type){case 0:I?A=!0:(w.FileIndex.pop(),w.FullPaths.pop());break;case 1:case 2:case 5:I=!0,isNaN(M.R*M.L*M.C)&&(A=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(A=!0);break;default:A=!0;break}}if(!(!A&&!R)){var K=new Date(1987,1,19),Z=0,v=Object.create?Object.create(null):{},C=[];for(F=0;F<w.FullPaths.length;++F)v[w.FullPaths[F]]=!0,w.FileIndex[F].type!==0&&C.push([w.FullPaths[F],w.FileIndex[F]]);for(F=0;F<C.length;++F){var P=r(C[F][0]);I=v[P],I||(C.push([P,{name:i(P).replace("/",""),type:1,clsid:Ne,ct:K,mt:K,content:null}]),v[P]=!0)}for(C.sort(function(Y,q){return n(Y[0],q[0])}),w.FullPaths=[],w.FileIndex=[],F=0;F<C.length;++F)w.FullPaths[F]=C[F][0],w.FileIndex[F]=C[F][1];for(F=0;F<C.length;++F){var U=w.FileIndex[F],j=w.FullPaths[F];if(U.name=i(j).replace("/",""),U.L=U.R=U.C=-(U.color=1),U.size=U.content?U.content.length:0,U.start=0,U.clsid=U.clsid||Ne,F===0)U.C=C.length>1?1:-1,U.size=0,U.type=5;else if(j.slice(-1)=="/"){for(Z=F+1;Z<C.length&&r(w.FullPaths[Z])!=j;++Z);for(U.C=Z>=C.length?-1:Z,Z=F+1;Z<C.length&&r(w.FullPaths[Z])!=r(j);++Z);U.R=Z>=C.length?-1:Z,U.type=1}else r(w.FullPaths[F+1]||"")==r(j)&&(U.R=F+1),U.type=2}}}function O(w,R){var A=R||{};if(A.fileType=="mad")return hu(w,A);switch(b(w),A.fileType){case"zip":return uu(w,A)}var I=function(Y){for(var q=0,ee=0,te=0;te<Y.FileIndex.length;++te){var me=Y.FileIndex[te];if(me.content){var pe=me.content.length;pe>0&&(pe<4096?q+=pe+63>>6:ee+=pe+511>>9)}}for(var Ce=Y.FullPaths.length+3>>2,Le=q+7>>3,$e=q+127>>7,Et=Le+ee+Ce+$e,gn=Et+127>>7,ks=gn<=109?0:Math.ceil((gn-109)/127);Et+gn+ks+127>>7>gn;)ks=++gn<=109?0:Math.ceil((gn-109)/127);var er=[1,ks,gn,$e,Ce,ee,q,0];return Y.FileIndex[0].size=q<<6,er[7]=(Y.FileIndex[0].start=er[0]+er[1]+er[2]+er[3]+er[4]+er[5])+(er[6]+7>>3),er}(w),F=Q(I[7]<<9),M=0,K=0;{for(M=0;M<8;++M)F.write_shift(1,_e[M]);for(M=0;M<8;++M)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),M=0;M<3;++M)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,I[2]),F.write_shift(4,I[0]+I[1]+I[2]+I[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,I[3]?I[0]+I[1]+I[2]-1:re),F.write_shift(4,I[3]),F.write_shift(-4,I[1]?I[0]-1:re),F.write_shift(4,I[1]),M=0;M<109;++M)F.write_shift(-4,M<I[2]?I[1]+M:-1)}if(I[1])for(K=0;K<I[1];++K){for(;M<236+K*127;++M)F.write_shift(-4,M<I[2]?I[1]+M:-1);F.write_shift(-4,K===I[1]-1?re:K+1)}var Z=function(Y){for(K+=Y;M<K-1;++M)F.write_shift(-4,M+1);Y&&(++M,F.write_shift(-4,re))};for(K=M=0,K+=I[1];M<K;++M)F.write_shift(-4,ge.DIFSECT);for(K+=I[2];M<K;++M)F.write_shift(-4,ge.FATSECT);Z(I[3]),Z(I[4]);for(var v=0,C=0,P=w.FileIndex[0];v<w.FileIndex.length;++v)P=w.FileIndex[v],P.content&&(C=P.content.length,!(C<4096)&&(P.start=K,Z(C+511>>9)));for(Z(I[6]+7>>3);F.l&511;)F.write_shift(-4,ge.ENDOFCHAIN);for(K=M=0,v=0;v<w.FileIndex.length;++v)P=w.FileIndex[v],P.content&&(C=P.content.length,!(!C||C>=4096)&&(P.start=K,Z(C+63>>6)));for(;F.l&511;)F.write_shift(-4,ge.ENDOFCHAIN);for(M=0;M<I[4]<<2;++M){var U=w.FullPaths[M];if(!U||U.length===0){for(v=0;v<17;++v)F.write_shift(4,0);for(v=0;v<3;++v)F.write_shift(4,-1);for(v=0;v<12;++v)F.write_shift(4,0);continue}P=w.FileIndex[M],M===0&&(P.start=P.size?P.start-1:re);var j=M===0&&A.root||P.name;if(C=2*(j.length+1),F.write_shift(64,j,"utf16le"),F.write_shift(2,C),F.write_shift(1,P.type),F.write_shift(1,P.color),F.write_shift(-4,P.L),F.write_shift(-4,P.R),F.write_shift(-4,P.C),P.clsid)F.write_shift(16,P.clsid,"hex");else for(v=0;v<4;++v)F.write_shift(4,0);F.write_shift(4,P.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,P.start),F.write_shift(4,P.size),F.write_shift(4,0)}for(M=1;M<w.FileIndex.length;++M)if(P=w.FileIndex[M],P.size>=4096)if(F.l=P.start+1<<9,Oe&&Buffer.isBuffer(P.content))P.content.copy(F,F.l,0,P.size),F.l+=P.size+511&-512;else{for(v=0;v<P.size;++v)F.write_shift(1,P.content[v]);for(;v&511;++v)F.write_shift(1,0)}for(M=1;M<w.FileIndex.length;++M)if(P=w.FileIndex[M],P.size>0&&P.size<4096)if(Oe&&Buffer.isBuffer(P.content))P.content.copy(F,F.l,0,P.size),F.l+=P.size+63&-64;else{for(v=0;v<P.size;++v)F.write_shift(1,P.content[v]);for(;v&63;++v)F.write_shift(1,0)}if(Oe)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function J(w,R){var A=w.FullPaths.map(function(v){return v.toUpperCase()}),I=A.map(function(v){var C=v.split("/");return C[C.length-(v.slice(-1)=="/"?2:1)]}),F=!1;R.charCodeAt(0)===47?(F=!0,R=A[0].slice(0,-1)+R):F=R.indexOf("/")!==-1;var M=R.toUpperCase(),K=F===!0?A.indexOf(M):I.indexOf(M);if(K!==-1)return w.FileIndex[K];var Z=!M.match(va);for(M=M.replace(to,""),Z&&(M=M.replace(va,"!")),K=0;K<A.length;++K)if((Z?A[K].replace(va,"!"):A[K]).replace(to,"")==M||(Z?I[K].replace(va,"!"):I[K]).replace(to,"")==M)return w.FileIndex[K];return null}var X=64,re=-2,we="d0cf11e0a1b11ae1",_e=[208,207,17,224,161,177,26,225],Ne="00000000000000000000000000000000",ge={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:re,FREESECT:-1,HEADER_SIGNATURE:we,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ae(w,R,A){u();var I=O(w,A);l.writeFileSync(R,I)}function z(w){for(var R=new Array(w.length),A=0;A<w.length;++A)R[A]=String.fromCharCode(w[A]);return R.join("")}function se(w,R){var A=O(w,R);switch(R&&R.type||"buffer"){case"file":return u(),l.writeFileSync(R.filename,A),A;case"binary":return typeof A=="string"?A:z(A);case"base64":return No(typeof A=="string"?A:z(A));case"buffer":if(Oe)return Buffer.isBuffer(A)?A:xr(A);case"array":return typeof A=="string"?On(A):A}return A}var ye;function L(w){try{var R=w.InflateRaw,A=new R;if(A._processChunk(new Uint8Array([3,0]),A._finishFlushFlag),A.bytesRead)ye=w;else throw new Error("zlib does not expose bytesRead")}catch(I){console.error("cannot use native zlib: "+(I.message||I))}}function W(w,R){if(!ye)return As(w,R);var A=ye.InflateRaw,I=new A,F=I._processChunk(w.slice(w.l),I._finishFlushFlag);return w.l+=I.bytesRead,F}function H(w){return ye?ye.deflateRawSync(w):zo(w)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(w){var R=(w<<1|w<<11)&139536|(w<<5|w<<15)&558144;return(R>>16|R>>8|R)&255}for(var ve=typeof Uint8Array<"u",fe=ve?new Uint8Array(256):[],Pe=0;Pe<256;++Pe)fe[Pe]=Ee(Pe);function ke(w,R){var A=fe[w&255];return R<=8?A>>>8-R:(A=A<<8|fe[w>>8&255],R<=16?A>>>16-R:(A=A<<8|fe[w>>16&255],A>>>24-R))}function yt(w,R){var A=R&7,I=R>>>3;return(w[I]|(A<=6?0:w[I+1]<<8))>>>A&3}function Me(w,R){var A=R&7,I=R>>>3;return(w[I]|(A<=5?0:w[I+1]<<8))>>>A&7}function je(w,R){var A=R&7,I=R>>>3;return(w[I]|(A<=4?0:w[I+1]<<8))>>>A&15}function We(w,R){var A=R&7,I=R>>>3;return(w[I]|(A<=3?0:w[I+1]<<8))>>>A&31}function he(w,R){var A=R&7,I=R>>>3;return(w[I]|(A<=1?0:w[I+1]<<8))>>>A&127}function Rt(w,R,A){var I=R&7,F=R>>>3,M=(1<<A)-1,K=w[F]>>>I;return A<8-I||(K|=w[F+1]<<8-I,A<16-I)||(K|=w[F+2]<<16-I,A<24-I)||(K|=w[F+3]<<24-I),K&M}function qe(w,R,A){var I=R&7,F=R>>>3;return I<=5?w[F]|=(A&7)<<I:(w[F]|=A<<I&255,w[F+1]=(A&7)>>8-I),R+3}function Zn(w,R,A){var I=R&7,F=R>>>3;return A=(A&1)<<I,w[F]|=A,R+1}function tn(w,R,A){var I=R&7,F=R>>>3;return A<<=I,w[F]|=A&255,A>>>=8,w[F+1]=A,R+8}function Ut(w,R,A){var I=R&7,F=R>>>3;return A<<=I,w[F]|=A&255,A>>>=8,w[F+1]=A&255,w[F+2]=A>>>8,R+16}function Er(w,R){var A=w.length,I=2*A>R?2*A:R+5,F=0;if(A>=R)return w;if(Oe){var M=rh(I);if(w.copy)w.copy(M);else for(;F<w.length;++F)M[F]=w[F];return M}else if(ve){var K=new Uint8Array(I);if(K.set)K.set(w);else for(;F<A;++F)K[F]=w[F];return K}return w.length=I,w}function Bt(w){for(var R=new Array(w),A=0;A<w;++A)R[A]=0;return R}function Tr(w,R,A){var I=1,F=0,M=0,K=0,Z=0,v=w.length,C=ve?new Uint16Array(32):Bt(32);for(M=0;M<32;++M)C[M]=0;for(M=v;M<A;++M)w[M]=0;v=w.length;var P=ve?new Uint16Array(v):Bt(v);for(M=0;M<v;++M)C[F=w[M]]++,I<F&&(I=F),P[M]=0;for(C[0]=0,M=1;M<=I;++M)C[M+16]=Z=Z+C[M-1]<<1;for(M=0;M<v;++M)Z=w[M],Z!=0&&(P[M]=C[Z+16]++);var U=0;for(M=0;M<v;++M)if(U=w[M],U!=0)for(Z=ke(P[M],I)>>I-U,K=(1<<I+4-U)-1;K>=0;--K)R[Z|K<<U]=U&15|M<<4;return I}var zn=ve?new Uint16Array(512):Bt(512),_i=ve?new Uint16Array(32):Bt(32);if(!ve){for(var mn=0;mn<512;++mn)zn[mn]=0;for(mn=0;mn<32;++mn)_i[mn]=0}(function(){for(var w=[],R=0;R<32;R++)w.push(5);Tr(w,_i,32);var A=[];for(R=0;R<=143;R++)A.push(8);for(;R<=255;R++)A.push(9);for(;R<=279;R++)A.push(7);for(;R<=287;R++)A.push(8);Tr(A,zn,288)})();var Dd=function(){for(var R=ve?new Uint8Array(32768):[],A=0,I=0;A<ce.length-1;++A)for(;I<ce[A+1];++I)R[I]=A;for(;I<32768;++I)R[I]=29;var F=ve?new Uint8Array(259):[];for(A=0,I=0;A<ne.length-1;++A)for(;I<ne[A+1];++I)F[I]=A;function M(Z,v){for(var C=0;C<Z.length;){var P=Math.min(65535,Z.length-C),U=C+P==Z.length;for(v.write_shift(1,+U),v.write_shift(2,P),v.write_shift(2,~P&65535);P-- >0;)v[v.l++]=Z[C++]}return v.l}function K(Z,v){for(var C=0,P=0,U=ve?new Uint16Array(32768):[];P<Z.length;){var j=Math.min(65535,Z.length-P);if(j<10){for(C=qe(v,C,+(P+j==Z.length)),C&7&&(C+=8-(C&7)),v.l=C/8|0,v.write_shift(2,j),v.write_shift(2,~j&65535);j-- >0;)v[v.l++]=Z[P++];C=v.l*8;continue}C=qe(v,C,+(P+j==Z.length)+2);for(var Y=0;j-- >0;){var q=Z[P];Y=(Y<<5^q)&32767;var ee=-1,te=0;if((ee=U[Y])&&(ee|=P&-32768,ee>P&&(ee-=32768),ee<P))for(;Z[ee+te]==Z[P+te]&&te<250;)++te;if(te>2){q=F[te],q<=22?C=tn(v,C,fe[q+1]>>1)-1:(tn(v,C,3),C+=5,tn(v,C,fe[q-23]>>5),C+=3);var me=q<8?0:q-4>>2;me>0&&(Ut(v,C,te-ne[q]),C+=me),q=R[P-ee],C=tn(v,C,fe[q]>>3),C-=3;var pe=q<4?0:q-2>>1;pe>0&&(Ut(v,C,P-ee-ce[q]),C+=pe);for(var Ce=0;Ce<te;++Ce)U[Y]=P&32767,Y=(Y<<5^Z[P])&32767,++P;j-=te-1}else q<=143?q=q+48:C=Zn(v,C,1),C=tn(v,C,fe[q]),U[Y]=P&32767,++P}C=tn(v,C,0)-1}return v.l=(C+7)/8|0,v.l}return function(v,C){return v.length<8?M(v,C):K(v,C)}}();function zo(w){var R=Q(50+Math.floor(w.length*1.1)),A=Dd(w,R);return R.slice(0,A)}var _r=ve?new Uint16Array(32768):Bt(32768),Ss=ve?new Uint16Array(32768):Bt(32768),ws=ve?new Uint16Array(128):Bt(128),Cs=1,jo=1;function Wo(w,R){var A=We(w,R)+257;R+=5;var I=We(w,R)+1;R+=5;var F=je(w,R)+4;R+=4;for(var M=0,K=ve?new Uint8Array(19):Bt(19),Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],v=1,C=ve?new Uint8Array(8):Bt(8),P=ve?new Uint8Array(8):Bt(8),U=K.length,j=0;j<F;++j)K[V[j]]=M=Me(w,R),v<M&&(v=M),C[M]++,R+=3;var Y=0;for(C[0]=0,j=1;j<=v;++j)P[j]=Y=Y+C[j-1]<<1;for(j=0;j<U;++j)(Y=K[j])!=0&&(Z[j]=P[Y]++);var q=0;for(j=0;j<U;++j)if(q=K[j],q!=0){Y=fe[Z[j]]>>8-q;for(var ee=(1<<7-q)-1;ee>=0;--ee)ws[Y|ee<<q]=q&7|j<<3}var te=[];for(v=1;te.length<A+I;)switch(Y=ws[he(w,R)],R+=Y&7,Y>>>=3){case 16:for(M=3+yt(w,R),R+=2,Y=te[te.length-1];M-- >0;)te.push(Y);break;case 17:for(M=3+Me(w,R),R+=3;M-- >0;)te.push(0);break;case 18:for(M=11+he(w,R),R+=7;M-- >0;)te.push(0);break;default:te.push(Y),v<Y&&(v=Y);break}var me=te.slice(0,A),pe=te.slice(A);for(j=A;j<286;++j)me[j]=0;for(j=I;j<30;++j)pe[j]=0;return Cs=Tr(me,_r,286),jo=Tr(pe,Ss,30),R}function qo(w,R){if(w[0]==3&&!(w[1]&3))return[fi(R),2];for(var A=0,I=0,F=rh(R||1<<18),M=0,K=F.length>>>0,Z=0,v=0;!(I&1);){if(I=Me(w,A),A+=3,I>>>1)I>>1==1?(Z=9,v=5):(A=Wo(w,A),Z=Cs,v=jo);else{A&7&&(A+=8-(A&7));var C=w[A>>>3]|w[(A>>>3)+1]<<8;if(A+=32,C>0)for(!R&&K<M+C&&(F=Er(F,M+C),K=F.length);C-- >0;)F[M++]=w[A>>>3],A+=8;continue}for(;;){!R&&K<M+32767&&(F=Er(F,M+32767),K=F.length);var P=Rt(w,A,Z),U=I>>>1==1?zn[P]:_r[P];if(A+=U&15,U>>>=4,!(U>>>8&255))F[M++]=U;else{if(U==256)break;U-=257;var j=U<8?0:U-4>>2;j>5&&(j=0);var Y=M+ne[U];j>0&&(Y+=Rt(w,A,j),A+=j),P=Rt(w,A,v),U=I>>>1==1?_i[P]:Ss[P],A+=U&15,U>>>=4;var q=U<4?0:U-2>>1,ee=ce[U];for(q>0&&(ee+=Rt(w,A,q),A+=q),!R&&K<Y&&(F=Er(F,Y+100),K=F.length);M<Y;)F[M]=F[M-ee],++M}}}return R?[F,A+7>>>3]:[F.slice(0,M),A+7>>>3]}function As(w,R){var A=w.slice(w.l||0),I=qo(A,R);return w.l+=I[1],I[0]}function Ns(w,R){if(w)typeof console<"u"&&console.error(R);else throw new Error(R)}function Jo(w,R){var A=w;on(A,0);var I=[],F=[],M={FileIndex:I,FullPaths:F};k(M,{root:R.root});for(var K=A.length-4;(A[K]!=80||A[K+1]!=75||A[K+2]!=5||A[K+3]!=6)&&K>=0;)--K;A.l=K+4,A.l+=4;var Z=A.read_shift(2);A.l+=6;var v=A.read_shift(4);for(A.l=v,K=0;K<Z;++K){A.l+=20;var C=A.read_shift(4),P=A.read_shift(4),U=A.read_shift(2),j=A.read_shift(2),Y=A.read_shift(2);A.l+=8;var q=A.read_shift(4),ee=a(A.slice(A.l+U,A.l+U+j));A.l+=U+j+Y;var te=A.l;A.l=q+4,Ko(A,C,P,M,ee),A.l=te}return M}function Ko(w,R,A,I,F){w.l+=2;var M=w.read_shift(2),K=w.read_shift(2),Z=o(w);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var v=w.read_shift(4),C=w.read_shift(4),P=w.read_shift(4),U=w.read_shift(2),j=w.read_shift(2),Y="",q=0;q<U;++q)Y+=String.fromCharCode(w[w.l++]);if(j){var ee=a(w.slice(w.l,w.l+j));(ee[21589]||{}).mt&&(Z=ee[21589].mt),((F||{})[21589]||{}).mt&&(Z=F[21589].mt)}w.l+=j;var te=w.slice(w.l,w.l+C);switch(K){case 8:te=W(w,P);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+K)}var me=!1;M&8&&(v=w.read_shift(4),v==134695760&&(v=w.read_shift(4),me=!0),C=w.read_shift(4),P=w.read_shift(4)),C!=R&&Ns(me,"Bad compressed size: "+R+" != "+C),P!=A&&Ns(me,"Bad uncompressed size: "+A+" != "+P),Is(I,Y,te,{unsafe:!0,mt:Z})}function uu(w,R){var A=R||{},I=[],F=[],M=Q(1),K=A.compression?8:0,Z=0,v=0,C=0,P=0,U=0,j=w.FullPaths[0],Y=j,q=w.FileIndex[0],ee=[],te=0;for(v=1;v<w.FullPaths.length;++v)if(Y=w.FullPaths[v].slice(j.length),q=w.FileIndex[v],!(!q.size||!q.content||Y=="Sh33tJ5")){var me=P,pe=Q(Y.length);for(C=0;C<Y.length;++C)pe.write_shift(1,Y.charCodeAt(C)&127);pe=pe.slice(0,pe.l),ee[U]=ST.buf(q.content,0);var Ce=q.content;K==8&&(Ce=H(Ce)),M=Q(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,Z),M.write_shift(2,K),q.mt?s(M,q.mt):M.write_shift(4,0),M.write_shift(-4,ee[U]),M.write_shift(4,Ce.length),M.write_shift(4,q.content.length),M.write_shift(2,pe.length),M.write_shift(2,0),P+=M.length,I.push(M),P+=pe.length,I.push(pe),P+=Ce.length,I.push(Ce),M=Q(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,Z),M.write_shift(2,K),M.write_shift(4,0),M.write_shift(-4,ee[U]),M.write_shift(4,Ce.length),M.write_shift(4,q.content.length),M.write_shift(2,pe.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,me),te+=M.l,F.push(M),te+=pe.length,F.push(pe),++U}return M=Q(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,U),M.write_shift(2,U),M.write_shift(4,te),M.write_shift(4,P),M.write_shift(2,0),wt([wt(I),wt(F),M])}var kn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Rn(w,R){if(w.ctype)return w.ctype;var A=w.name||"",I=A.match(/\.([^\.]+)$/);return I&&kn[I[1]]||R&&(I=(A=R).match(/[\.\\]([^\.\\])+$/),I&&kn[I[1]])?kn[I[1]]:"application/octet-stream"}function cu(w){for(var R=No(w),A=[],I=0;I<R.length;I+=76)A.push(R.slice(I,I+76));return A.join(`\r
`)+`\r
`}function fu(w){var R=w.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(C){var P=C.charCodeAt(0).toString(16).toUpperCase();return"="+(P.length==1?"0"+P:P)});R=R.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),R.charAt(0)==`
`&&(R="=0D"+R.slice(1)),R=R.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var A=[],I=R.split(`\r
`),F=0;F<I.length;++F){var M=I[F];if(M.length==0){A.push("");continue}for(var K=0;K<M.length;){var Z=76,v=M.slice(K,K+Z);v.charAt(Z-1)=="="?Z--:v.charAt(Z-2)=="="?Z-=2:v.charAt(Z-3)=="="&&(Z-=3),v=M.slice(K,K+Z),K+=Z,K<M.length&&(v+="="),A.push(v)}}return A.join(`\r
`)}function Yo(w){for(var R=[],A=0;A<w.length;++A){for(var I=w[A];A<=w.length&&I.charAt(I.length-1)=="=";)I=I.slice(0,I.length-1)+w[++A];R.push(I)}for(var F=0;F<R.length;++F)R[F]=R[F].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return On(R.join(`\r
`))}function du(w,R,A){for(var I="",F="",M="",K,Z=0;Z<10;++Z){var v=R[Z];if(!v||v.match(/^\s*$/))break;var C=v.match(/^(.*?):\s*([^\s].*)$/);if(C)switch(C[1].toLowerCase()){case"content-location":I=C[2].trim();break;case"content-type":M=C[2].trim();break;case"content-transfer-encoding":F=C[2].trim();break}}switch(++Z,F.toLowerCase()){case"base64":K=On(hr(R.slice(Z).join("")));break;case"quoted-printable":K=Yo(R.slice(Z));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var P=Is(w,I.slice(A.length),K,{unsafe:!0});M&&(P.ctype=M)}function Xo(w,R){if(z(w.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var A=R&&R.root||"",I=(Oe&&Buffer.isBuffer(w)?w.toString("binary"):z(w)).split(`\r
`),F=0,M="";for(F=0;F<I.length;++F)if(M=I[F],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),A||(A=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,A.length)!=A))for(;A.length>0&&(A=A.slice(0,A.length-1),A=A.slice(0,A.lastIndexOf("/")+1),M.slice(0,A.length)!=A););var K=(I[1]||"").match(/boundary="(.*?)"/);if(!K)throw new Error("MAD cannot find boundary");var Z="--"+(K[1]||""),v=[],C=[],P={FileIndex:v,FullPaths:C};k(P);var U,j=0;for(F=0;F<I.length;++F){var Y=I[F];Y!==Z&&Y!==Z+"--"||(j++&&du(P,I.slice(U,F),A),U=F)}return P}function hu(w,R){var A=R||{},I=A.boundary||"SheetJS";I="------="+I;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+I.slice(2)+'"',"","",""],M=w.FullPaths[0],K=M,Z=w.FileIndex[0],v=1;v<w.FullPaths.length;++v)if(K=w.FullPaths[v].slice(M.length),Z=w.FileIndex[v],!(!Z.size||!Z.content||K=="Sh33tJ5")){K=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(te){return"_x"+te.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(te){return"_u"+te.charCodeAt(0).toString(16)+"_"});for(var C=Z.content,P=Oe&&Buffer.isBuffer(C)?C.toString("binary"):z(C),U=0,j=Math.min(1024,P.length),Y=0,q=0;q<=j;++q)(Y=P.charCodeAt(q))>=32&&Y<128&&++U;var ee=U>=j*4/5;F.push(I),F.push("Content-Location: "+(A.root||"file:///C:/SheetJS/")+K),F.push("Content-Transfer-Encoding: "+(ee?"quoted-printable":"base64")),F.push("Content-Type: "+Rn(Z,K)),F.push(""),F.push(ee?fu(P):cu(P))}return F.push(I+`--\r
`),F.join(`\r
`)}function pu(w){var R={};return k(R,w),R}function Is(w,R,A,I){var F=I&&I.unsafe;F||k(w);var M=!F&&ze.find(w,R);if(!M){var K=w.FullPaths[0];R.slice(0,K.length)==K?K=R:(K.slice(-1)!="/"&&(K+="/"),K=(K+R).replace("//","/")),M={name:i(R),type:2},w.FileIndex.push(M),w.FullPaths.push(K),F||ze.utils.cfb_gc(w)}return M.content=A,M.size=A?A.length:0,I&&(I.CLSID&&(M.clsid=I.CLSID),I.mt&&(M.mt=I.mt),I.ct&&(M.ct=I.ct)),M}function mu(w,R){k(w);var A=ze.find(w,R);if(A){for(var I=0;I<w.FileIndex.length;++I)if(w.FileIndex[I]==A)return w.FileIndex.splice(I,1),w.FullPaths.splice(I,1),!0}return!1}function Qo(w,R,A){k(w);var I=ze.find(w,R);if(I){for(var F=0;F<w.FileIndex.length;++F)if(w.FileIndex[F]==I)return w.FileIndex[F].name=i(A),w.FullPaths[F]=A,!0}return!1}function gu(w){b(w,!0)}return t.find=J,t.read=G,t.parse=c,t.write=se,t.writeFile=ae,t.utils={cfb_new:pu,cfb_add:Is,cfb_del:mu,cfb_mov:Qo,cfb_gc:gu,ReadShift:ro,CheckField:l1,prep_blob:on,bconcat:wt,use_zlib:L,_deflateRaw:zo,_inflateRaw:As,consts:ge},t}();function wT(e){return typeof e=="string"?Xl(e):Array.isArray(e)?YE(e):e}function Bo(e,t,n){if(typeof Deno<"u"){if(n&&typeof t=="string")switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=Xl(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r=n=="utf8"?ko(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var i=new Blob([wT(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(e);return a.open("w"),a.encoding="binary",Array.isArray(t)&&(t=Uo(t)),a.write(t),a.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function kt(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function fh(e,t){for(var n=[],r=kt(e),i=0;i!==r.length;++i)n[e[r[i]][t]]==null&&(n[e[r[i]][t]]=r[i]);return n}function ld(e){for(var t=[],n=kt(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function eu(e){for(var t=[],n=kt(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}function CT(e){for(var t=[],n=kt(e),r=0;r!==n.length;++r)t[e[n[r]]]==null&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}var Tl=new Date(1899,11,30,0,0,0);function Zt(e,t){var n=e.getTime(),r=Tl.getTime()+(e.getTimezoneOffset()-Tl.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var jx=new Date,AT=Tl.getTime()+(jx.getTimezoneOffset()-Tl.getTimezoneOffset())*6e4,dh=jx.getTimezoneOffset();function Wx(e){var t=new Date;return t.setTime(e*24*60*60*1e3+AT),t.getTimezoneOffset()!==dh&&t.setTime(t.getTime()+(t.getTimezoneOffset()-dh)*6e4),t}var hh=new Date("2017-02-19T19:06:09.000Z"),qx=isNaN(hh.getFullYear())?new Date("2/19/17"):hh,NT=qx.getFullYear()==2017;function zt(e,t){var n=new Date(e);if(NT)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(qx.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function tu(e,t){if(Oe&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return n[s]||s})}catch{}for(var r=[],i=0;i!=e.length;++i)r.push(String.fromCharCode(e[i]));return r.join("")}function en(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=en(e[n]));return t}function it(e,t){for(var n="";n.length<t;)n+=e;return n}function ar(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return n=-n,s}),!isNaN(t=Number(r)))?t/n:t}var IT=["january","february","march","april","may","june","july","august","september","october","november","december"];function Io(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return n;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&IT.indexOf(o)==-1)return n}else if(o.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||s>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}function Ie(e,t,n){if(e.FullPaths){if(typeof n=="string"){var r;return Oe?r=xr(n):r=XE(n),ze.utils.cfb_add(e,t,r)}ze.utils.cfb_add(e,t,n)}else e.file(t,n)}function ud(){return ze.utils.cfb_new()}var ct=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,kT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},cd=ld(kT),fd=/[&<>'"]/g,RT=/[\u0000-\u0008\u000b-\u001f]/g;function Ge(e){var t=e+"";return t.replace(fd,function(n){return cd[n]}).replace(RT,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ph(e){return Ge(e).replace(/ /g,"_x0020_")}var Jx=/[\u0000-\u001f]/g;function PT(e){var t=e+"";return t.replace(fd,function(n){return cd[n]}).replace(/\n/g,"<br/>").replace(Jx,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function FT(e){var t=e+"";return t.replace(fd,function(n){return cd[n]}).replace(Jx,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}function MT(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function bT(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function qu(e){for(var t="",n=0,r=0,i=0,s=0,o=0,a=0;n<e.length;){if(r=e.charCodeAt(n++),r<128){t+=String.fromCharCode(r);continue}if(i=e.charCodeAt(n++),r>191&&r<224){o=(r&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(n++),r<240){t+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(n++),a=((r&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(a&1023))}return t}function mh(e){var t=fi(2*e.length),n,r,i=1,s=0,o=0,a;for(r=0;r<e.length;r+=i)i=1,(a=e.charCodeAt(r))<128?n=a:a<224?(n=(a&31)*64+(e.charCodeAt(r+1)&63),i=2):a<240?(n=(a&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),i=3):(i=4,n=(a&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),n-=65536,o=55296+(n>>>10&1023),n=56320+(n&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=n%256,t[s++]=n>>>8;return t.slice(0,s).toString("ucs2")}function gh(e){return xr(e,"binary").toString("utf8")}var Ea="foo bar baz",no=Oe&&(gh(Ea)==qu(Ea)&&gh||mh(Ea)==qu(Ea)&&mh)||qu,ko=Oe?function(e){return xr(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,i=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},DT=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)r=r.replace(e[i][0],e[i][1]);return r}}(),Kx=/(^\s|\s$|\n)/;function Ct(e,t){return"<"+e+(t.match(Kx)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Ro(e){return kt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function le(e,t,n){return"<"+e+(n!=null?Ro(n):"")+(t!=null?(t.match(Kx)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Zc(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function LT(e,t){switch(typeof e){case"string":var n=le("vt:lpwstr",Ge(e));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return le((e|0)==e?"vt:i4":"vt:r8",Ge(String(e)));case"boolean":return le("vt:bool",e?"true":"false")}if(e instanceof Date)return le("vt:filetime",Zc(e));throw new Error("Unable to serialize "+e)}var mt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},gs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],an={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function OT(e,t){for(var n=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return r==2047?i==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}function UT(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=r?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var a=0;a<=5;++a,s/=256)e[n+a]=s&255;e[n+6]=(i&15)<<4|s&15,e[n+7]=i>>4|r}var xh=function(e){for(var t=[],n=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var i=0,s=e[0][r].length;i<s;i+=n)t.push.apply(t,e[0][r].slice(i,i+n));return t},vh=Oe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:xr(t)})):xh(e)}:xh,yh=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(js(e,i)));return r.join("").replace(to,"")},dd=Oe?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(to,""):yh(e,t,n)}:yh,Eh=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},Yx=Oe?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):Eh(e,t,n)}:Eh,Th=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(Ii(e,i)));return r.join("")},Go=Oe?function(t,n,r){return Buffer.isBuffer(t)?t.toString("utf8",n,r):Th(t,n,r)}:Th,Xx=function(e,t){var n=ln(e,t);return n>0?Go(e,t+4,t+4+n-1):""},Qx=Xx,Zx=function(e,t){var n=ln(e,t);return n>0?Go(e,t+4,t+4+n-1):""},e1=Zx,t1=function(e,t){var n=2*ln(e,t);return n>0?Go(e,t+4,t+4+n-1):""},n1=t1,r1=function(t,n){var r=ln(t,n);return r>0?dd(t,n+4,n+4+r):""},i1=r1,s1=function(e,t){var n=ln(e,t);return n>0?Go(e,t+4,t+4+n):""},o1=s1,a1=function(e,t){return OT(e,t)},_l=a1,hd=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Oe&&(Qx=function(t,n){if(!Buffer.isBuffer(t))return Xx(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},e1=function(t,n){if(!Buffer.isBuffer(t))return Zx(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},n1=function(t,n){if(!Buffer.isBuffer(t))return t1(t,n);var r=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r-1)},i1=function(t,n){if(!Buffer.isBuffer(t))return r1(t,n);var r=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r)},o1=function(t,n){if(!Buffer.isBuffer(t))return s1(t,n);var r=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+r)},_l=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):a1(t,n)},hd=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ii=function(e,t){return e[t]},js=function(e,t){return e[t+1]*256+e[t]},BT=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},ln=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Zr=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},GT=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ro(e,t){var n="",r,i,s=[],o,a,l,u;switch(t){case"dbcs":if(u=this.l,Oe&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)n+=String.fromCharCode(js(this,u)),u+=2;e*=2;break;case"utf8":n=Go(this,this.l,this.l+e);break;case"utf16le":e*=2,n=dd(this,this.l,this.l+e);break;case"wstr":return ro.call(this,e,"dbcs");case"lpstr-ansi":n=Qx(this,this.l),e=4+ln(this,this.l);break;case"lpstr-cp":n=e1(this,this.l),e=4+ln(this,this.l);break;case"lpwstr":n=n1(this,this.l),e=4+2*ln(this,this.l);break;case"lpp4":e=4+ln(this,this.l),n=i1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ln(this,this.l),n=o1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(o=Ii(this,this.l+e++))!==0;)s.push(xa(o));n=s.join("");break;case"_wstr":for(e=0,n="";(o=js(this,this.l+e))!==0;)s.push(xa(o)),e+=2;e+=2,n=s.join("");break;case"dbcs-cont":for(n="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ii(this,u),this.l=u+1,a=ro.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(xa(js(this,u))),u+=2}n=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ii(this,u),this.l=u+1,a=ro.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(xa(Ii(this,u))),u+=1}n=s.join("");break;default:switch(e){case 1:return r=Ii(this,this.l),this.l++,r;case 2:return r=(t==="i"?BT:js)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(r=(e>0?Zr:GT)(this,this.l),this.l+=4,r):(i=ln(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=_l(this,this.l):i=_l([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:n=Yx(this,this.l,e);break}}return this.l+=e,n}var VT=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},HT=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},$T=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function zT(e,t,n){var r=0,i=0;if(n==="dbcs"){for(i=0;i!=t.length;++i)$T(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;r=t.length}else if(n==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(n==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,VT(this,t,this.l);break;case 8:if(r=8,n==="f"){UT(this,t,this.l);break}case 16:break;case-4:r=4,HT(this,t,this.l);break}return this.l+=r,this}function l1(e,t){var n=Yx(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function on(e,t){e.l=t,e.read_shift=ro,e.chk=l1,e.write_shift=zT}function Qn(e,t){e.l+=t}function Q(e){var t=fi(e);return on(t,0),t}function Qt(){var e=[],t=Oe?256:2048,n=function(u){var c=Q(u);return on(c,0),c},r=n(t),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},s=function(u){return r&&u<r.length-r.l?r:(i(),r=n(Math.max(u+1,t)))},o=function(){return i(),wt(e)},a=function(u){i(),r=u,r.l==null&&(r.l=r.length),s(t)};return{next:s,push:a,end:o,_bufs:e}}function ie(e,t,n,r){var i=+t,s;if(!isNaN(i)){r||(r=ON[i].p||(n||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var o=e.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&hd(n)&&e.push(n)}}function io(e,t,n){var r=en(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function _h(e,t,n){var r=en(e);return r.s=io(r.s,t.s,n),r.e=io(r.e,t.s,n),r}function so(e,t){if(e.cRel&&e.c<0)for(e=en(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=en(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=He(e);return!e.cRel&&e.cRel!=null&&(n=qT(n)),!e.rRel&&e.rRel!=null&&(n=jT(n)),n}function Ju(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Dt(e.s.c)+":"+(e.e.cRel?"":"$")+Dt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Nt(e.s.r)+":"+(e.e.rRel?"":"$")+Nt(e.e.r):so(e.s,t.biff)+":"+so(e.e,t.biff)}function pd(e){return parseInt(WT(e),10)-1}function Nt(e){return""+(e+1)}function jT(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function WT(e){return e.replace(/\$(\d+)$/,"$1")}function md(e){for(var t=JT(e),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function Dt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function qT(e){return e.replace(/^([A-Z])/,"$$$1")}function JT(e){return e.replace(/^\$([A-Z])/,"$1")}function KT(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function gt(e){for(var t=0,n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function He(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function dn(e){var t=e.indexOf(":");return t==-1?{s:gt(e),e:gt(e)}:{s:gt(e.slice(0,t)),e:gt(e.slice(t+1))}}function ut(e,t){return typeof t>"u"||typeof t=="number"?ut(e.s,e.e):(typeof e!="string"&&(e=He(e)),typeof t!="string"&&(t=He(t)),e==t?e:e+":"+t)}function Qe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,s=e.length;for(n=0;r<s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.s.c=--n,n=0;r<s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(t.s.r=--n,r===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return t.e.r=--n,t}function Sh(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=$r(e.z,n?Zt(t):t)}catch{}try{return e.w=$r((e.XF||{}).numFmtId||(n?14:0),n?Zt(t):t)}catch{return""+t}}function pr(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?Vo[e.v]||e.v:t==null?Sh(e,e.v):Sh(e,t))}function gi(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function u1(e,t,n){var r=n||{},i=e?Array.isArray(e):r.dense,s=e||(i?[]:{}),o=0,a=0;if(s&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?gt(r.origin):r.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var c=Qe(s["!ref"]);u.s.c=c.s.c,u.s.r=c.s.r,u.e.c=Math.max(u.e.c,c.e.c),u.e.r=Math.max(u.e.r,c.e.r),o==-1&&(u.e.r=o=c.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[p].length;++m)if(!(typeof t[p][m]>"u")){var g={v:t[p][m]},y=o+p,x=a+m;if(u.s.r>y&&(u.s.r=y),u.s.c>x&&(u.s.c=x),u.e.r<y&&(u.e.r=y),u.e.c<x&&(u.e.c=x),t[p][m]&&typeof t[p][m]=="object"&&!Array.isArray(t[p][m])&&!(t[p][m]instanceof Date))g=t[p][m];else if(Array.isArray(g.v)&&(g.f=t[p][m][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(r.nullError)g.t="e",g.v=0;else if(r.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=r.dateNF||st[14],r.cellDates?(g.t="d",g.w=$r(g.z,Zt(g.v))):(g.t="n",g.v=Zt(g.v),g.w=$r(g.z,g.v))):g.t="s";if(i)s[y]||(s[y]=[]),s[y][x]&&s[y][x].z&&(g.z=s[y][x].z),s[y][x]=g;else{var S=He({c:x,r:y});s[S]&&s[S].z&&(g.z=s[S].z),s[S]=g}}}return u.s.c<1e7&&(s["!ref"]=ut(u)),s}function xs(e,t){return u1(null,e,t)}function YT(e){return e.read_shift(4,"i")}function Vn(e,t){return t||(t=Q(4)),t.write_shift(4,e),t}function Lt(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function xt(e,t){var n=!1;return t==null&&(n=!0,t=Q(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function XT(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function QT(e,t){return t||(t=Q(4)),t.write_shift(2,0),t.write_shift(2,0),t}function gd(e,t){var n=e.l,r=e.read_shift(1),i=Lt(e),s=[],o={t:i,h:i};if(r&1){for(var a=e.read_shift(4),l=0;l!=a;++l)s.push(XT(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=n+t,o}function ZT(e,t){var n=!1;return t==null&&(n=!0,t=Q(15+4*e.t.length)),t.write_shift(1,0),xt(e.t,t),n?t.slice(0,t.l):t}var e_=gd;function t_(e,t){var n=!1;return t==null&&(n=!0,t=Q(23+4*e.t.length)),t.write_shift(1,1),xt(e.t,t),t.write_shift(4,1),QT({},t),n?t.slice(0,t.l):t}function In(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function xi(e,t){return t==null&&(t=Q(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function vi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function yi(e,t){return t==null&&(t=Q(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var n_=Lt,c1=xt;function xd(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Sl(e,t){var n=!1;return t==null&&(n=!0,t=Q(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var r_=Lt,ef=xd,vd=Sl;function f1(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,r=t[0]&2;e.l+=4;var i=r===0?_l([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Zr(t,0)>>2;return n?i/100:i}function d1(e,t){t==null&&(t=Q(4));var n=0,r=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,n=1),r)t.write_shift(-4,((n?i:e)<<2)+(n+2));else throw new Error("unsupported RkNumber "+e)}function h1(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function i_(e,t){return t||(t=Q(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ei=h1,vs=i_;function ys(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function di(e,t){return(t||Q(8)).write_shift(8,e,"f")}function s_(e){var t={},n=e.read_shift(1),r=n>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),a=e.read_shift(1),l=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=i;var u=p_[i];u&&(t.rgb=bh(u));break;case 2:t.rgb=bh([o,a,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function wl(e,t){if(t||(t=Q(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}return t}function o_(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function a_(e,t){t||(t=Q(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,n),t.write_shift(1,0),t}var p1=2,nn=3,Ta=11,Cl=19,_a=64,l_=65,u_=71,c_=4108,f_=4126,St=80,wh={1:{n:"CodePage",t:p1},2:{n:"Category",t:St},3:{n:"PresentationFormat",t:St},4:{n:"ByteCount",t:nn},5:{n:"LineCount",t:nn},6:{n:"ParagraphCount",t:nn},7:{n:"SlideCount",t:nn},8:{n:"NoteCount",t:nn},9:{n:"HiddenCount",t:nn},10:{n:"MultimediaClipCount",t:nn},11:{n:"ScaleCrop",t:Ta},12:{n:"HeadingPairs",t:c_},13:{n:"TitlesOfParts",t:f_},14:{n:"Manager",t:St},15:{n:"Company",t:St},16:{n:"LinksUpToDate",t:Ta},17:{n:"CharacterCount",t:nn},19:{n:"SharedDoc",t:Ta},22:{n:"HyperlinksChanged",t:Ta},23:{n:"AppVersion",t:nn,p:"version"},24:{n:"DigSig",t:l_},26:{n:"ContentType",t:St},27:{n:"ContentStatus",t:St},28:{n:"Language",t:St},29:{n:"Version",t:St},255:{},2147483648:{n:"Locale",t:Cl},2147483651:{n:"Behavior",t:Cl},1919054434:{}},Ch={1:{n:"CodePage",t:p1},2:{n:"Title",t:St},3:{n:"Subject",t:St},4:{n:"Author",t:St},5:{n:"Keywords",t:St},6:{n:"Comments",t:St},7:{n:"Template",t:St},8:{n:"LastAuthor",t:St},9:{n:"RevNumber",t:St},10:{n:"EditTime",t:_a},11:{n:"LastPrinted",t:_a},12:{n:"CreatedDate",t:_a},13:{n:"ModifiedDate",t:_a},14:{n:"PageCount",t:nn},15:{n:"WordCount",t:nn},16:{n:"CharCount",t:nn},17:{n:"Thumbnail",t:u_},18:{n:"Application",t:St},19:{n:"DocSecurity",t:nn},255:{},2147483648:{n:"Locale",t:Cl},2147483651:{n:"Behavior",t:Cl},1919054434:{}};function d_(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var h_=d_([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),p_=en(h_),Vo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},m_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Sa={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function m1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function g1(e,t){var n=CT(m_),r=[],i;r[r.length]=ct,r[r.length]=le("Types",null,{xmlns:mt.CT,"xmlns:xsd":mt.xsd,"xmlns:xsi":mt.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return le("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],r[r.length]=le("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Sa[l][t.bookType]||Sa[l].xlsx}))},o=function(l){(e[l]||[]).forEach(function(u){r[r.length]=le("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Sa[l][t.bookType]||Sa[l].xlsx})})},a=function(l){(e[l]||[]).forEach(function(u){r[r.length]=le("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:n[l][0]})})};return s("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var be={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function x1(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Zi(e){var t=[ct,le("Relationships",null,{xmlns:mt.RELS})];return kt(e["!id"]).forEach(function(n){t[t.length]=le("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Be(e,t,n,r,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=n,[be.HLINK,be.XPATH,be.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function g_(e){var t=[ct];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Ah(e,t,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function x_(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function v_(e){var t=[ct];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=e.length;++n)t.push(Ah(e[n][0],e[n][1])),t.push(x_("",e[n][0]));return t.push(Ah("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function v1(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+gl.version+"</meta:generator></office:meta></office:document-meta>"}var si=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Ku(e,t,n,r,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Ge(t),r[r.length]=n?le(e,t,n):Ct(e,t))}function y1(e,t){var n=t||{},r=[ct,le("cp:coreProperties",null,{"xmlns:cp":mt.CORE_PROPS,"xmlns:dc":mt.dc,"xmlns:dcterms":mt.dcterms,"xmlns:dcmitype":mt.dcmitype,"xmlns:xsi":mt.xsi})],i={};if(!e&&!n.Props)return r.join("");e&&(e.CreatedDate!=null&&Ku("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Zc(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),e.ModifiedDate!=null&&Ku("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Zc(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=si.length;++s){var o=si[s],a=n.Props&&n.Props[o[1]]!=null?n.Props[o[1]]:e?e[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&Ku(o[0],a,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var es=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],E1=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function T1(e){var t=[],n=le;return e||(e={}),e.Application="SheetJS",t[t.length]=ct,t[t.length]=le("Properties",null,{xmlns:mt.EXT_PROPS,"xmlns:vt":mt.vt}),es.forEach(function(r){if(e[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Ge(String(e[r[1]]));break;case"bool":i=e[r[1]]?"true":"false";break}i!==void 0&&(t[t.length]=n(r[0],i))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+Ge(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function _1(e){var t=[ct,le("Properties",null,{xmlns:mt.CUST_PROPS,"xmlns:vt":mt.vt})];if(!e)return t.join("");var n=1;return kt(e).forEach(function(i){++n,t[t.length]=le("property",LT(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Ge(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Nh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function y_(e,t){var n=[];return kt(Nh).map(function(r){for(var i=0;i<si.length;++i)if(si[i][1]==r)return si[i];for(i=0;i<es.length;++i)if(es[i][1]==r)return es[i];throw r}).forEach(function(r){if(e[r[1]]!=null){var i=t&&t.Props&&t.Props[r[1]]!=null?t.Props[r[1]]:e[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(Ct(Nh[r[1]]||r[1],i))}}),le("DocumentProperties",n.join(""),{xmlns:an.o})}function E_(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return e&&kt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<si.length;++o)if(s==si[o][1])return;for(o=0;o<es.length;++o)if(s==es[o][1])return;for(o=0;o<n.length;++o)if(s==n[o])return;var a=e[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(le(ph(s),a,{"dt:dt":l}))}}),t&&kt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(le(ph(s),o,{"dt:dt":a}))}}),"<"+r+' xmlns="'+an.o+'">'+i.join("")+"</"+r+">"}function T_(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,n=t.getTime()/1e3+11644473600,r=n%Math.pow(2,32),i=(n-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var o=Q(8);return o.write_shift(4,r),o.write_shift(4,i),o}function Ih(e,t){var n=Q(4),r=Q(4);switch(n.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,t);break;case 5:r=Q(8),r.write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=T_(t);break;case 31:case 80:for(r=Q(4+2*(t.length+1)+(t.length%2?0:2)),r.write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return wt([n,r])}var S1=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function __(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function kh(e,t,n){var r=Q(8),i=[],s=[],o=8,a=0,l=Q(8),u=Q(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),o+=8+l.length,!t){u=Q(8),u.write_shift(4,0),i.unshift(u);var c=[Q(4)];for(c[0].write_shift(4,e.length),a=0;a<e.length;++a){var p=e[a][0];for(l=Q(8+2*(p.length+1)+(p.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,p.length+1),l.write_shift(0,p,"dbcs");l.l!=l.length;)l.write_shift(1,0);c.push(l)}l=wt(c),s.unshift(l),o+=8+l.length}for(a=0;a<e.length;++a)if(!(t&&!t[e[a][0]])&&!(S1.indexOf(e[a][0])>-1||E1.indexOf(e[a][0])>-1)&&e[a][1]!=null){var m=e[a][1],g=0;if(t){g=+t[e[a][0]];var y=n[g];if(y.p=="version"&&typeof m=="string"){var x=m.split(".");m=(+x[0]<<16)+(+x[1]||0)}l=Ih(y.t,m)}else{var S=__(m);S==-1&&(S=31,m=String(m)),l=Ih(S,m)}s.push(l),u=Q(8),u.write_shift(4,t?g:2+a),i.push(u),o+=8+l.length}var T=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,T),T+=s[a].length;return r.write_shift(4,o),r.write_shift(4,s.length),wt([r].concat(i).concat(s))}function Rh(e,t,n,r,i,s){var o=Q(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,ze.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var l=kh(e,n,r);if(a.push(l),i){var u=kh(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+l.length),a.push(u)}return wt(a)}function S_(e,t){t||(t=Q(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}function w_(e,t){return e.read_shift(t)===1}function Ht(e,t){return t||(t=Q(2)),t.write_shift(2,+!!e),t}function w1(e){return e.read_shift(2,"u")}function yn(e,t){return t||(t=Q(2)),t.write_shift(2,e),t}function C1(e,t,n){return n||(n=Q(2)),n.write_shift(1,t=="e"?+e:+!!e),n.write_shift(1,t=="e"?1:0),n}function A1(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else n.biff==12&&(i="wstr");n.biff>=2&&n.biff<=5&&(i="cpstr");var o=r?e.read_shift(r,i):"";return o}function C_(e){var t=e.t||"",n=Q(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=Q(2*t.length);r.write_shift(2*t.length,t,"utf16le");var i=[n,r];return wt(i)}function A_(e,t,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function N_(e,t,n){var r=e.read_shift(n&&n.biff==2?1:2);return r===0?(e.l++,""):A_(e,r,n)}function I_(e,t,n){if(n.biff>5)return N_(e,t,n);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function N1(e,t,n){return n||(n=Q(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function Ph(e,t){t||(t=Q(6+e.length*2)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function k_(e){var t=Q(512),n=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(n=0;n<o.length;++n)t.write_shift(4,o[n]);if(s==28)r=r.slice(1),Ph(r,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));var a=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(a.length+1)),n=0;n<a.length;++n)t.write_shift(2,a.charCodeAt(n));t.write_shift(2,0),s&8&&Ph(i>-1?r.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,r.charCodeAt(n+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function hi(e,t,n,r){return r||(r=Q(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function R_(e,t,n){var r=n.biff>8?4:2,i=e.read_shift(r),s=e.read_shift(r,"i"),o=e.read_shift(r,"i");return[i,s,o]}function P_(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2);return{s:{c:r,r:t},e:{c:i,r:n}}}function I1(e,t){return t||(t=Q(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function yd(e,t,n){var r=1536,i=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Q(i);return s.write_shift(2,r),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function F_(e,t){var n=!t||t.biff==8,r=Q(n?112:54);for(r.write_shift(t.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function M_(e,t){var n=!t||t.biff>=8?2:1,r=Q(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function b_(e,t){var n=Q(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var r=[],i=0;i<e.length;++i)r[i]=C_(e[i]);var s=wt([n].concat(r));return s.parts=[n.length].concat(r.map(function(o){return o.length})),s}function D_(){var e=Q(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function L_(e){var t=Q(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function O_(e,t){var n=e.name||"Arial",r=t&&t.biff==5,i=r?15+n.length:16+2*n.length,s=Q(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,n.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),s}function U_(e,t,n,r){var i=Q(10);return hi(e,t,r,i),i.write_shift(4,n),i}function B_(e,t,n,r,i){var s=!i||i.biff==8,o=Q(8+ +s+(1+s)*n.length);return hi(e,t,r,o),o.write_shift(2,n.length),s&&o.write_shift(1,1),o.write_shift((1+s)*n.length,n,s?"utf16le":"sbcs"),o}function G_(e,t,n,r){var i=n&&n.biff==5;r||(r=Q(i?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function V_(e,t){var n=t.biff==8||!t.biff?4:2,r=Q(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function Fh(e,t,n,r){var i=n&&n.biff==5;r||(r=Q(i?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function H_(e){var t=Q(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function $_(e,t,n,r,i,s){var o=Q(8);return hi(e,t,r,o),C1(n,s,o),o}function z_(e,t,n,r){var i=Q(14);return hi(e,t,r,i),di(n,i),i}function j_(e,t,n){if(n.biff<8)return W_(e,t,n);for(var r=[],i=e.l+t,s=e.read_shift(n.biff>8?4:2);s--!==0;)r.push(R_(e,n.biff>8?12:6,n));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function W_(e,t,n){e[e.l+1]==3&&e[e.l]++;var r=A1(e,t,n);return r.charCodeAt(0)==3?r.slice(1):r}function q_(e){var t=Q(2+e.length*8);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)I1(e[n],t);return t}function J_(e){var t=Q(24),n=gt(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return wt([t,k_(e[1])])}function K_(e){var t=e[1].Tooltip,n=Q(10+2*(t.length+1));n.write_shift(2,2048);var r=gt(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<t.length;++i)n.write_shift(2,t.charCodeAt(i));return n.write_shift(2,0),n}function Y_(e){return e||(e=Q(4)),e.write_shift(2,1),e.write_shift(2,1),e}function X_(e,t,n){if(!n.cellStyles)return Qn(e,t);var r=n&&n.biff>=12?4:2,i=e.read_shift(r),s=e.read_shift(r),o=e.read_shift(r),a=e.read_shift(r),l=e.read_shift(2);r==2&&(e.l+=2);var u={s:i,e:s,w:o,ixfe:a,flags:l};return(n.biff>=5||!n.biff)&&(u.level=l>>8&7),u}function Q_(e,t){var n=Q(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,e.width*256),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function Z_(e){for(var t=Q(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}function eS(e,t,n){var r=Q(15);return $o(r,e,t),r.write_shift(8,n,"f"),r}function tS(e,t,n){var r=Q(9);return $o(r,e,t),r.write_shift(2,n),r}var nS=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ld({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(a,l){var u=[],c=fi(1);switch(l.type){case"base64":c=On(hr(a));break;case"binary":c=On(a);break;case"buffer":case"array":c=a;break}on(c,0);var p=c.read_shift(1),m=!!(p&136),g=!1,y=!1;switch(p){case 2:break;case 3:break;case 48:g=!0,m=!0;break;case 49:g=!0,m=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var x=0,S=521;p==2&&(x=c.read_shift(2)),c.l+=3,p!=2&&(x=c.read_shift(4)),x>1048576&&(x=1e6),p!=2&&(S=c.read_shift(2));var T=c.read_shift(2),E=l.codepage||1252;p!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(E=e[c[c.l]]),c.l+=1,c.l+=2),y&&(c.l+=36);for(var _=[],N={},B=Math.min(c.length,p==2?521:S-10-(g?264:0)),G=y?32:11;c.l<B&&c[c.l]!=13;)switch(N={},N.name=xl.utils.decode(E,c.slice(c.l,c.l+G)).replace(/[\u0000\r\n].*$/g,""),c.l+=G,N.type=String.fromCharCode(c.read_shift(1)),p!=2&&!y&&(N.offset=c.read_shift(4)),N.len=c.read_shift(1),p==2&&(N.offset=c.read_shift(2)),N.dec=c.read_shift(1),N.name.length&&_.push(N),p!=2&&(c.l+=y?13:14),N.type){case"B":(!g||N.len!=8)&&l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(c[c.l]!==13&&(c.l=S-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=S;var k=0,D=0;for(u[0]=[],D=0;D!=_.length;++D)u[0][D]=_[D].name;for(;x-- >0;){if(c[c.l]===42){c.l+=T;continue}for(++c.l,u[++k]=[],D=0,D=0;D!=_.length;++D){var b=c.slice(c.l,c.l+_[D].len);c.l+=_[D].len,on(b,0);var O=xl.utils.decode(E,b);switch(_[D].type){case"C":O.trim().length&&(u[k][D]=O.replace(/\s+$/,""));break;case"D":O.length===8?u[k][D]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):u[k][D]=O;break;case"F":u[k][D]=parseFloat(O.trim());break;case"+":case"I":u[k][D]=y?b.read_shift(-4,"i")^2147483648:b.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":u[k][D]=!0;break;case"N":case"F":u[k][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));u[k][D]="##MEMO##"+(y?parseInt(O.trim(),10):b.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(u[k][D]=+O||0);break;case"@":u[k][D]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":u[k][D]=new Date((b.read_shift(4)-2440588)*864e5+b.read_shift(4));break;case"Y":u[k][D]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][D]=-b.read_shift(-8,"f");break;case"B":if(g&&_[D].len==8){u[k][D]=b.read_shift(8,"f");break}case"G":case"P":b.l+=_[D].len;break;case"0":if(_[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[D].type)}}}if(p!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=_,u}function r(a,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var c=xs(n(a,u),u);return c["!cols"]=u.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete u.DBF,c}function i(a,l){try{return gi(r(a,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var u=l||{};if(+u.codepage>=0&&Ao(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var c=Qt(),p=Rl(a,{header:1,raw:!0,cellDates:!0}),m=p[0],g=p.slice(1),y=a["!cols"]||[],x=0,S=0,T=0,E=1;for(x=0;x<m.length;++x){if(((y[x]||{}).DBF||{}).name){m[x]=y[x].DBF.name,++T;continue}if(m[x]!=null){if(++T,typeof m[x]=="number"&&(m[x]=m[x].toString(10)),typeof m[x]!="string")throw new Error("DBF Invalid column name "+m[x]+" |"+typeof m[x]+"|");if(m.indexOf(m[x])!==x){for(S=0;S<1024;++S)if(m.indexOf(m[x]+"_"+S)==-1){m[x]+="_"+S;break}}}}var _=Qe(a["!ref"]),N=[],B=[],G=[];for(x=0;x<=_.e.c-_.s.c;++x){var k="",D="",b=0,O=[];for(S=0;S<g.length;++S)g[S][x]!=null&&O.push(g[S][x]);if(O.length==0||m[x]==null){N[x]="?";continue}for(S=0;S<O.length;++S){switch(typeof O[S]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=O[S]instanceof Date?"D":"C";break;default:D="C"}b=Math.max(b,String(O[S]).length),k=k&&k!=D?"C":D}b>250&&(b=250),D=((y[x]||{}).DBF||{}).type,D=="C"&&y[x].DBF.len>b&&(b=y[x].DBF.len),k=="B"&&D=="N"&&(k="N",G[x]=y[x].DBF.dec,b=y[x].DBF.len),B[x]=k=="C"||D=="N"?b:s[k]||0,E+=B[x],N[x]=k}var J=c.next(32);for(J.write_shift(4,318902576),J.write_shift(4,g.length),J.write_shift(2,296+32*T),J.write_shift(2,E),x=0;x<4;++x)J.write_shift(4,0);for(J.write_shift(4,0|(+t[Rx]||3)<<8),x=0,S=0;x<m.length;++x)if(m[x]!=null){var X=c.next(32),re=(m[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);X.write_shift(1,re,"sbcs"),X.write_shift(1,N[x]=="?"?"C":N[x],"sbcs"),X.write_shift(4,S),X.write_shift(1,B[x]||s[N[x]]||0),X.write_shift(1,G[x]||0),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(4,0),S+=B[x]||s[N[x]]||0}var we=c.next(264);for(we.write_shift(4,13),x=0;x<65;++x)we.write_shift(4,0);for(x=0;x<g.length;++x){var _e=c.next(E);for(_e.write_shift(1,0),S=0;S<m.length;++S)if(m[S]!=null)switch(N[S]){case"L":_e.write_shift(1,g[x][S]==null?63:g[x][S]?84:70);break;case"B":_e.write_shift(8,g[x][S]||0,"f");break;case"N":var Ne="0";for(typeof g[x][S]=="number"&&(Ne=g[x][S].toFixed(G[S]||0)),T=0;T<B[S]-Ne.length;++T)_e.write_shift(1,32);_e.write_shift(1,Ne,"sbcs");break;case"D":g[x][S]?(_e.write_shift(4,("0000"+g[x][S].getFullYear()).slice(-4),"sbcs"),_e.write_shift(2,("00"+(g[x][S].getMonth()+1)).slice(-2),"sbcs"),_e.write_shift(2,("00"+g[x][S].getDate()).slice(-2),"sbcs")):_e.write_shift(8,"00000000","sbcs");break;case"C":var ge=String(g[x][S]!=null?g[x][S]:"").slice(0,B[S]);for(_e.write_shift(1,ge,"sbcs"),T=0;T<B[S]-ge.length;++T)_e.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:i,to_sheet:r,from_sheet:o}}(),rS=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+kt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(m,g){var y=e[g];return typeof y=="number"?nh(y):y},r=function(m,g,y){var x=g.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?m:nh(x)};e["|"]=254;function i(m,g){switch(g.type){case"base64":return s(hr(m),g);case"binary":return s(m,g);case"buffer":return s(Oe&&Buffer.isBuffer(m)?m.toString("binary"):Uo(m),g);case"array":return s(tu(m),g)}throw new Error("Unrecognized type "+g.type)}function s(m,g){var y=m.split(/[\n\r]+/),x=-1,S=-1,T=0,E=0,_=[],N=[],B=null,G={},k=[],D=[],b=[],O=0,J;for(+g.codepage>=0&&Ao(+g.codepage);T!==y.length;++T){O=0;var X=y[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),re=X.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),we=re[0],_e;if(X.length>0)switch(we){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":re[1].charAt(0)=="P"&&N.push(X.slice(3).replace(/;;/g,";"));break;case"C":var Ne=!1,ge=!1,ae=!1,z=!1,se=-1,ye=-1;for(E=1;E<re.length;++E)switch(re[E].charAt(0)){case"A":break;case"X":S=parseInt(re[E].slice(1))-1,ge=!0;break;case"Y":for(x=parseInt(re[E].slice(1))-1,ge||(S=0),J=_.length;J<=x;++J)_[J]=[];break;case"K":_e=re[E].slice(1),_e.charAt(0)==='"'?_e=_e.slice(1,_e.length-1):_e==="TRUE"?_e=!0:_e==="FALSE"?_e=!1:isNaN(ar(_e))?isNaN(Io(_e).getDate())||(_e=zt(_e)):(_e=ar(_e),B!==null&&Hx(B)&&(_e=Wx(_e))),Ne=!0;break;case"E":z=!0;var L=tw(re[E].slice(1),{r:x,c:S});_[x][S]=[_[x][S],L];break;case"S":ae=!0,_[x][S]=[_[x][S],"S5S"];break;case"G":break;case"R":se=parseInt(re[E].slice(1))-1;break;case"C":ye=parseInt(re[E].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+X)}if(Ne&&(_[x][S]&&_[x][S].length==2?_[x][S][0]=_e:_[x][S]=_e,B=null),ae){if(z)throw new Error("SYLK shared formula cannot have own formula");var W=se>-1&&_[se][ye];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");_[x][S][1]=nw(W[1],{r:x-se,c:S-ye})}break;case"F":var H=0;for(E=1;E<re.length;++E)switch(re[E].charAt(0)){case"X":S=parseInt(re[E].slice(1))-1,++H;break;case"Y":for(x=parseInt(re[E].slice(1))-1,J=_.length;J<=x;++J)_[J]=[];break;case"M":O=parseInt(re[E].slice(1))/20;break;case"F":break;case"G":break;case"P":B=N[parseInt(re[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(b=re[E].slice(1).split(" "),J=parseInt(b[0],10);J<=parseInt(b[1],10);++J)O=parseInt(b[2],10),D[J-1]=O===0?{hidden:!0}:{wch:O},Ed(D[J-1]);break;case"C":S=parseInt(re[E].slice(1))-1,D[S]||(D[S]={});break;case"R":x=parseInt(re[E].slice(1))-1,k[x]||(k[x]={}),O>0?(k[x].hpt=O,k[x].hpx=M1(O)):O===0&&(k[x].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+X)}H<1&&(B=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+X)}}return k.length>0&&(G["!rows"]=k),D.length>0&&(G["!cols"]=D),g&&g.sheetRows&&(_=_.slice(0,g.sheetRows)),[_,G]}function o(m,g){var y=i(m,g),x=y[0],S=y[1],T=xs(x,g);return kt(S).forEach(function(E){T[E]=S[E]}),T}function a(m,g){return gi(o(m,g),g)}function l(m,g,y,x){var S="C;Y"+(y+1)+";X"+(x+1)+";K";switch(m.t){case"n":S+=m.v||0,m.f&&!m.F&&(S+=";E"+_d(m.f,{r:y,c:x}));break;case"b":S+=m.v?"TRUE":"FALSE";break;case"e":S+=m.w||m.v;break;case"d":S+='"'+(m.w||m.v)+'"';break;case"s":S+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function u(m,g){g.forEach(function(y,x){var S="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?S+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=Al(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Nl(y.wpx)),typeof y.wch=="number"&&(S+=Math.round(y.wch))),S.charAt(S.length-1)!=" "&&m.push(S)})}function c(m,g){g.forEach(function(y,x){var S="F;";y.hidden?S+="M0;":y.hpt?S+="M"+20*y.hpt+";":y.hpx&&(S+="M"+20*Il(y.hpx)+";"),S.length>2&&m.push(S+"R"+(x+1))})}function p(m,g){var y=["ID;PWXL;N;E"],x=[],S=Qe(m["!ref"]),T,E=Array.isArray(m),_=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),m["!cols"]&&u(y,m["!cols"]),m["!rows"]&&c(y,m["!rows"]),y.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var N=S.s.r;N<=S.e.r;++N)for(var B=S.s.c;B<=S.e.c;++B){var G=He({r:N,c:B});T=E?(m[N]||[])[B]:m[G],!(!T||T.v==null&&(!T.f||T.F))&&x.push(l(T,m,N,B))}return y.join(_)+_+x.join(_)+_+"E"+_}return{to_workbook:a,to_sheet:o,from_sheet:p}}(),iS=function(){function e(s,o){switch(o.type){case"base64":return t(hr(s),o);case"binary":return t(s,o);case"buffer":return t(Oe&&Buffer.isBuffer(s)?s.toString("binary"):Uo(s),o);case"array":return t(tu(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var a=s.split(`
`),l=-1,u=-1,c=0,p=[];c!==a.length;++c){if(a[c].trim()==="BOT"){p[++l]=[],u=0;continue}if(!(l<0)){var m=a[c].trim().split(","),g=m[0],y=m[1];++c;for(var x=a[c]||"";(x.match(/["]/g)||[]).length&1&&c<a.length-1;)x+=`
`+a[++c];switch(x=x.trim(),+g){case-1:if(x==="BOT"){p[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?p[l][u]=!0:x==="FALSE"?p[l][u]=!1:isNaN(ar(y))?isNaN(Io(y).getDate())?p[l][u]=y:p[l][u]=zt(y):p[l][u]=ar(y),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),p[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(p=p.slice(0,o.sheetRows)),p}function n(s,o){return xs(e(s,o),o)}function r(s,o){return gi(n(s,o),o)}var i=function(){var s=function(l,u,c,p,m){l.push(u),l.push(c+","+p),l.push('"'+m.replace(/"/g,'""')+'"')},o=function(l,u,c,p){l.push(u+","+c),l.push(u==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(l){var u=[],c=Qe(l["!ref"]),p,m=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,c.e.r-c.s.r+1,""),s(u,"TUPLES",0,c.e.c-c.s.c+1,""),s(u,"DATA",0,0,"");for(var g=c.s.r;g<=c.e.r;++g){o(u,-1,0,"BOT");for(var y=c.s.c;y<=c.e.c;++y){var x=He({r:g,c:y});if(p=m?(l[g]||[])[y]:l[x],!p){o(u,1,0,"");continue}switch(p.t){case"n":var S=p.w;!S&&p.v!=null&&(S=p.v),S==null?p.f&&!p.F?o(u,1,0,"="+p.f):o(u,1,0,""):o(u,0,S,"V");break;case"b":o(u,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=$r(p.z||st[14],Zt(zt(p.v)))),o(u,0,p.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var T=`\r
`,E=u.join(T);return E}}();return{to_workbook:r,to_sheet:n,from_sheet:i}}(),k1=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(p,m){for(var g=p.split(`
`),y=-1,x=-1,S=0,T=[];S!==g.length;++S){var E=g[S].trim().split(":");if(E[0]==="cell"){var _=gt(E[1]);if(T.length<=_.r)for(y=T.length;y<=_.r;++y)T[y]||(T[y]=[]);switch(y=_.r,x=_.c,E[2]){case"t":T[y][x]=e(E[3]);break;case"v":T[y][x]=+E[3];break;case"vtf":var N=E[E.length-1];case"vtc":switch(E[3]){case"nl":T[y][x]=!!+E[4];break;default:T[y][x]=+E[4];break}E[2]=="vtf"&&(T[y][x]=[T[y][x],N])}}}return m&&m.sheetRows&&(T=T.slice(0,m.sheetRows)),T}function r(p,m){return xs(n(p,m),m)}function i(p,m){return gi(r(p,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(p){if(!p||!p["!ref"])return"";for(var m=[],g=[],y,x="",S=dn(p["!ref"]),T=Array.isArray(p),E=S.s.r;E<=S.e.r;++E)for(var _=S.s.c;_<=S.e.c;++_)if(x=He({r:E,c:_}),y=T?(p[E]||[])[_]:p[x],!(!y||y.v==null||y.t==="z")){switch(g=["cell",x,"t"],y.t){case"s":case"str":g.push(t(y.v));break;case"n":y.f?(g[2]="vtf",g[3]="n",g[4]=y.v,g[5]=t(y.f)):(g[2]="v",g[3]=y.v);break;case"b":g[2]="vt"+(y.f?"f":"c"),g[3]="nl",g[4]=y.v?"1":"0",g[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var N=Zt(zt(y.v));g[2]="vtc",g[3]="nd",g[4]=""+N,g[5]=y.w||$r(y.z||st[14],N);break;case"e":continue}m.push(g.join(":"))}return m.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function c(p){return[s,o,a,o,u(p),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:c}}(),sS=function(){function e(c,p,m,g,y){y.raw?p[m][g]=c:c===""||(c==="TRUE"?p[m][g]=!0:c==="FALSE"?p[m][g]=!1:isNaN(ar(c))?isNaN(Io(c).getDate())?p[m][g]=c:p[m][g]=zt(c):p[m][g]=ar(c))}function t(c,p){var m=p||{},g=[];if(!c||c.length===0)return g;for(var y=c.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var S=10,T=0,E=0;E<=x;++E)T=y[E].indexOf(" "),T==-1?T=y[E].length:T++,S=Math.max(S,T);for(E=0;E<=x;++E){g[E]=[];var _=0;for(e(y[E].slice(0,S).trim(),g,E,_,m),_=1;_<=(y[E].length-S)/10+1;++_)e(y[E].slice(S+(_-1)*10,S+_*10).trim(),g,E,_,m)}return m.sheetRows&&(g=g.slice(0,m.sheetRows)),g}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(c){for(var p={},m=!1,g=0,y=0;g<c.length;++g)(y=c.charCodeAt(g))==34?m=!m:!m&&y in n&&(p[y]=(p[y]||0)+1);y=[];for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&y.push([p[g],g]);if(!y.length){p=r;for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&y.push([p[g],g])}return y.sort(function(x,S){return x[0]-S[0]||r[x[1]]-r[S[1]]}),n[y.pop()[1]]||44}function s(c,p){var m=p||{},g="",y=m.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(g=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(g=c.charAt(4),c=c.slice(6)):g=i(c.slice(0,1024)):m&&m.FS?g=m.FS:g=i(c.slice(0,1024));var S=0,T=0,E=0,_=0,N=0,B=g.charCodeAt(0),G=!1,k=0,D=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var b=m.dateNF!=null?TT(m.dateNF):null;function O(){var J=c.slice(_,N),X={};if(J.charAt(0)=='"'&&J.charAt(J.length-1)=='"'&&(J=J.slice(1,-1).replace(/""/g,'"')),J.length===0)X.t="z";else if(m.raw)X.t="s",X.v=J;else if(J.trim().length===0)X.t="s",X.v=J;else if(J.charCodeAt(0)==61)J.charCodeAt(1)==34&&J.charCodeAt(J.length-1)==34?(X.t="s",X.v=J.slice(2,-1).replace(/""/g,'"')):rw(J)?(X.t="n",X.f=J.slice(1)):(X.t="s",X.v=J);else if(J=="TRUE")X.t="b",X.v=!0;else if(J=="FALSE")X.t="b",X.v=!1;else if(!isNaN(E=ar(J)))X.t="n",m.cellText!==!1&&(X.w=J),X.v=E;else if(!isNaN(Io(J).getDate())||b&&J.match(b)){X.z=m.dateNF||st[14];var re=0;b&&J.match(b)&&(J=_T(J,m.dateNF,J.match(b)||[]),re=1),m.cellDates?(X.t="d",X.v=zt(J,re)):(X.t="n",X.v=Zt(zt(J,re))),m.cellText!==!1&&(X.w=$r(X.z,X.v instanceof Date?Zt(X.v):X.v)),m.cellNF||delete X.z}else X.t="s",X.v=J;if(X.t=="z"||(m.dense?(y[S]||(y[S]=[]),y[S][T]=X):y[He({c:T,r:S})]=X),_=N+1,D=c.charCodeAt(_),x.e.c<T&&(x.e.c=T),x.e.r<S&&(x.e.r=S),k==B)++T;else if(T=0,++S,m.sheetRows&&m.sheetRows<=S)return!0}e:for(;N<c.length;++N)switch(k=c.charCodeAt(N)){case 34:D===34&&(G=!G);break;case B:case 10:case 13:if(!G&&O())break e;break}return N-_>0&&O(),y["!ref"]=ut(x),y}function o(c,p){return!(p&&p.PRN)||p.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?s(c,p):xs(t(c,p),p)}function a(c,p){var m="",g=p.type=="string"?[0,0,0,0]:xI(c,p);switch(p.type){case"base64":m=hr(c);break;case"binary":m=c;break;case"buffer":p.codepage==65001?m=c.toString("utf8"):p.codepage&&typeof xl<"u"||(m=Oe&&Buffer.isBuffer(c)?c.toString("binary"):Uo(c));break;case"array":m=tu(c);break;case"string":m=c;break;default:throw new Error("Unrecognized type "+p.type)}return g[0]==239&&g[1]==187&&g[2]==191?m=no(m.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?m=no(m):p.type=="binary"&&typeof xl<"u",m.slice(0,19)=="socialcalc:version:"?k1.to_sheet(p.type=="string"?m:no(m),p):o(m,p)}function l(c,p){return gi(a(c,p),p)}function u(c){for(var p=[],m=Qe(c["!ref"]),g,y=Array.isArray(c),x=m.s.r;x<=m.e.r;++x){for(var S=[],T=m.s.c;T<=m.e.c;++T){var E=He({r:x,c:T});if(g=y?(c[x]||[])[T]:c[E],!g||g.v==null){S.push("          ");continue}for(var _=(g.w||(pr(g),g.w)||"").slice(0,10);_.length<10;)_+=" ";S.push(_+(T===0?" ":""))}p.push(S.join(""))}return p.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:u}}(),Mh=function(){function e(L,W,H){if(L){on(L,L.l||0);for(var V=H.Enum||se;L.l<L.length;){var ne=L.read_shift(2),ce=V[ne]||V[65535],Ee=L.read_shift(2),ve=L.l+Ee,fe=ce.f&&ce.f(L,Ee,H);if(L.l=ve,W(fe,ce,ne))return}}}function t(L,W){switch(W.type){case"base64":return n(On(hr(L)),W);case"binary":return n(On(L),W);case"buffer":case"array":return n(L,W)}throw"Unsupported type "+W.type}function n(L,W){if(!L)return L;var H=W||{},V=H.dense?[]:{},ne="Sheet1",ce="",Ee=0,ve={},fe=[],Pe=[],ke={s:{r:0,c:0},e:{r:0,c:0}},yt=H.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)H.Enum=se,e(L,function(he,Rt,qe){switch(qe){case 0:H.vers=he,he>=4096&&(H.qpro=!0);break;case 6:ke=he;break;case 204:he&&(ce=he);break;case 222:ce=he;break;case 15:case 51:H.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:qe==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=H.dateNF||st[14],H.cellDates&&(he[1].t="d",he[1].v=Wx(he[1].v))),H.qpro&&he[3]>Ee&&(V["!ref"]=ut(ke),ve[ne]=V,fe.push(ne),V=H.dense?[]:{},ke={s:{r:0,c:0},e:{r:0,c:0}},Ee=he[3],ne=ce||"Sheet"+(Ee+1),ce="");var Zn=H.dense?(V[he[0].r]||[])[he[0].c]:V[He(he[0])];if(Zn){Zn.t=he[1].t,Zn.v=he[1].v,he[1].z!=null&&(Zn.z=he[1].z),he[1].f!=null&&(Zn.f=he[1].f);break}H.dense?(V[he[0].r]||(V[he[0].r]=[]),V[he[0].r][he[0].c]=he[1]):V[He(he[0])]=he[1];break}},H);else if(L[2]==26||L[2]==14)H.Enum=ye,L[2]==14&&(H.qpro=!0,L.l=0),e(L,function(he,Rt,qe){switch(qe){case 204:ne=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>Ee&&(V["!ref"]=ut(ke),ve[ne]=V,fe.push(ne),V=H.dense?[]:{},ke={s:{r:0,c:0},e:{r:0,c:0}},Ee=he[3],ne="Sheet"+(Ee+1)),yt>0&&he[0].r>=yt)break;H.dense?(V[he[0].r]||(V[he[0].r]=[]),V[he[0].r][he[0].c]=he[1]):V[He(he[0])]=he[1],ke.e.c<he[0].c&&(ke.e.c=he[0].c),ke.e.r<he[0].r&&(ke.e.r=he[0].r);break;case 27:he[14e3]&&(Pe[he[14e3][0]]=he[14e3][1]);break;case 1537:Pe[he[0]]=he[1],he[0]==Ee&&(ne=he[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(V["!ref"]=ut(ke),ve[ce||ne]=V,fe.push(ce||ne),!Pe.length)return{SheetNames:fe,Sheets:ve};for(var Me={},je=[],We=0;We<Pe.length;++We)ve[fe[We]]?(je.push(Pe[We]||fe[We]),Me[Pe[We]]=ve[Pe[We]]||ve[fe[We]]):(je.push(Pe[We]),Me[Pe[We]]={"!ref":"A1"});return{SheetNames:je,Sheets:Me}}function r(L,W){var H=W||{};if(+H.codepage>=0&&Ao(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var V=Qt(),ne=Qe(L["!ref"]),ce=Array.isArray(L),Ee=[];ue(V,0,s(1030)),ue(V,6,l(ne));for(var ve=Math.min(ne.e.r,8191),fe=ne.s.r;fe<=ve;++fe)for(var Pe=Nt(fe),ke=ne.s.c;ke<=ne.e.c;++ke){fe===ne.s.r&&(Ee[ke]=Dt(ke));var yt=Ee[ke]+Pe,Me=ce?(L[fe]||[])[ke]:L[yt];if(!(!Me||Me.t=="z"))if(Me.t=="n")(Me.v|0)==Me.v&&Me.v>=-32768&&Me.v<=32767?ue(V,13,g(fe,ke,Me.v)):ue(V,14,x(fe,ke,Me.v));else{var je=pr(Me);ue(V,15,p(fe,ke,je.slice(0,239)))}}return ue(V,1),V.end()}function i(L,W){var H=W||{};if(+H.codepage>=0&&Ao(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var V=Qt();ue(V,0,o(L));for(var ne=0,ce=0;ne<L.SheetNames.length;++ne)(L.Sheets[L.SheetNames[ne]]||{})["!ref"]&&ue(V,27,z(L.SheetNames[ne],ce++));var Ee=0;for(ne=0;ne<L.SheetNames.length;++ne){var ve=L.Sheets[L.SheetNames[ne]];if(!(!ve||!ve["!ref"])){for(var fe=Qe(ve["!ref"]),Pe=Array.isArray(ve),ke=[],yt=Math.min(fe.e.r,8191),Me=fe.s.r;Me<=yt;++Me)for(var je=Nt(Me),We=fe.s.c;We<=fe.e.c;++We){Me===fe.s.r&&(ke[We]=Dt(We));var he=ke[We]+je,Rt=Pe?(ve[Me]||[])[We]:ve[he];if(!(!Rt||Rt.t=="z"))if(Rt.t=="n")ue(V,23,O(Me,We,Ee,Rt.v));else{var qe=pr(Rt);ue(V,22,k(Me,We,Ee,qe.slice(0,239)))}}++Ee}}return ue(V,1),V.end()}function s(L){var W=Q(2);return W.write_shift(2,L),W}function o(L){var W=Q(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var H=0,V=0,ne=0,ce=0;ce<L.SheetNames.length;++ce){var Ee=L.SheetNames[ce],ve=L.Sheets[Ee];if(!(!ve||!ve["!ref"])){++ne;var fe=dn(ve["!ref"]);H<fe.e.r&&(H=fe.e.r),V<fe.e.c&&(V=fe.e.c)}}return H>8191&&(H=8191),W.write_shift(2,H),W.write_shift(1,ne),W.write_shift(1,V),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function a(L,W,H){var V={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&H.qpro?(V.s.c=L.read_shift(1),L.l++,V.s.r=L.read_shift(2),V.e.c=L.read_shift(1),L.l++,V.e.r=L.read_shift(2),V):(V.s.c=L.read_shift(2),V.s.r=L.read_shift(2),W==12&&H.qpro&&(L.l+=2),V.e.c=L.read_shift(2),V.e.r=L.read_shift(2),W==12&&H.qpro&&(L.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function l(L){var W=Q(8);return W.write_shift(2,L.s.c),W.write_shift(2,L.s.r),W.write_shift(2,L.e.c),W.write_shift(2,L.e.r),W}function u(L,W,H){var V=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(V[0].c=L.read_shift(1),V[3]=L.read_shift(1),V[0].r=L.read_shift(2),L.l+=2):(V[2]=L.read_shift(1),V[0].c=L.read_shift(2),V[0].r=L.read_shift(2)),V}function c(L,W,H){var V=L.l+W,ne=u(L,W,H);if(ne[1].t="s",H.vers==20768){L.l++;var ce=L.read_shift(1);return ne[1].v=L.read_shift(ce,"utf8"),ne}return H.qpro&&L.l++,ne[1].v=L.read_shift(V-L.l,"cstr"),ne}function p(L,W,H){var V=Q(7+H.length);V.write_shift(1,255),V.write_shift(2,W),V.write_shift(2,L),V.write_shift(1,39);for(var ne=0;ne<V.length;++ne){var ce=H.charCodeAt(ne);V.write_shift(1,ce>=128?95:ce)}return V.write_shift(1,0),V}function m(L,W,H){var V=u(L,W,H);return V[1].v=L.read_shift(2,"i"),V}function g(L,W,H){var V=Q(7);return V.write_shift(1,255),V.write_shift(2,W),V.write_shift(2,L),V.write_shift(2,H,"i"),V}function y(L,W,H){var V=u(L,W,H);return V[1].v=L.read_shift(8,"f"),V}function x(L,W,H){var V=Q(13);return V.write_shift(1,255),V.write_shift(2,W),V.write_shift(2,L),V.write_shift(8,H,"f"),V}function S(L,W,H){var V=L.l+W,ne=u(L,W,H);if(ne[1].v=L.read_shift(8,"f"),H.qpro)L.l=V;else{var ce=L.read_shift(2);N(L.slice(L.l,L.l+ce),ne),L.l+=ce}return ne}function T(L,W,H){var V=W&32768;return W&=-32769,W=(V?L:0)+(W>=8192?W-16384:W),(V?"":"$")+(H?Dt(W):Nt(W))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(L,W){on(L,0);for(var H=[],V=0,ne="",ce="",Ee="",ve="";L.l<L.length;){var fe=L[L.l++];switch(fe){case 0:H.push(L.read_shift(8,"f"));break;case 1:ce=T(W[0].c,L.read_shift(2),!0),ne=T(W[0].r,L.read_shift(2),!1),H.push(ce+ne);break;case 2:{var Pe=T(W[0].c,L.read_shift(2),!0),ke=T(W[0].r,L.read_shift(2),!1);ce=T(W[0].c,L.read_shift(2),!0),ne=T(W[0].r,L.read_shift(2),!1),H.push(Pe+ke+":"+ce+ne)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(L.read_shift(2));break;case 6:{for(var yt="";fe=L[L.l++];)yt+=String.fromCharCode(fe);H.push('"'+yt.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:ve=H.pop(),Ee=H.pop(),H.push(["AND","OR"][fe-20]+"("+Ee+","+ve+")");break;default:if(fe<32&&_[fe])ve=H.pop(),Ee=H.pop(),H.push(Ee+_[fe]+ve);else if(E[fe]){if(V=E[fe][1],V==69&&(V=L[L.l++]),V>H.length){console.error("WK1 bad formula parse 0x"+fe.toString(16)+":|"+H.join("|")+"|");return}var Me=H.slice(-V);H.length-=V,H.push(E[fe][0]+"("+Me.join(",")+")")}else return fe<=7?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=24?console.error("WK1 unsupported op "+fe.toString(16)):fe<=30?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=115?console.error("WK1 unsupported function opcode "+fe.toString(16)):console.error("WK1 unrecognized opcode "+fe.toString(16))}}H.length==1?W[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function B(L){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=L.read_shift(2),W[3]=L[L.l++],W[0].c=L[L.l++],W}function G(L,W){var H=B(L);return H[1].t="s",H[1].v=L.read_shift(W-4,"cstr"),H}function k(L,W,H,V){var ne=Q(6+V.length);ne.write_shift(2,L),ne.write_shift(1,H),ne.write_shift(1,W),ne.write_shift(1,39);for(var ce=0;ce<V.length;++ce){var Ee=V.charCodeAt(ce);ne.write_shift(1,Ee>=128?95:Ee)}return ne.write_shift(1,0),ne}function D(L,W){var H=B(L);H[1].v=L.read_shift(2);var V=H[1].v>>1;if(H[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return H[1].v=V,H}function b(L,W){var H=B(L),V=L.read_shift(4),ne=L.read_shift(4),ce=L.read_shift(2);if(ce==65535)return V===0&&ne===3221225472?(H[1].t="e",H[1].v=15):V===0&&ne===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var Ee=ce&32768;return ce=(ce&32767)-16446,H[1].v=(1-Ee*2)*(ne*Math.pow(2,ce+32)+V*Math.pow(2,ce)),H}function O(L,W,H,V){var ne=Q(14);if(ne.write_shift(2,L),ne.write_shift(1,H),ne.write_shift(1,W),V==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var ce=0,Ee=0,ve=0,fe=0;return V<0&&(ce=1,V=-V),Ee=Math.log2(V)|0,V/=Math.pow(2,Ee-31),fe=V>>>0,fe&2147483648||(V/=2,++Ee,fe=V>>>0),V-=fe,fe|=2147483648,fe>>>=0,V*=Math.pow(2,32),ve=V>>>0,ne.write_shift(4,ve),ne.write_shift(4,fe),Ee+=16383+(ce?32768:0),ne.write_shift(2,Ee),ne}function J(L,W){var H=b(L);return L.l+=W-14,H}function X(L,W){var H=B(L),V=L.read_shift(4);return H[1].v=V>>6,H}function re(L,W){var H=B(L),V=L.read_shift(8,"f");return H[1].v=V,H}function we(L,W){var H=re(L);return L.l+=W-10,H}function _e(L,W){return L[L.l+W-1]==0?L.read_shift(W,"cstr"):""}function Ne(L,W){var H=L[L.l++];H>W-1&&(H=W-1);for(var V="";V.length<H;)V+=String.fromCharCode(L[L.l++]);return V}function ge(L,W,H){if(!(!H.qpro||W<21)){var V=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var ne=L.read_shift(W-21,"cstr");return[V,ne]}}function ae(L,W){for(var H={},V=L.l+W;L.l<V;){var ne=L.read_shift(2);if(ne==14e3){for(H[ne]=[0,""],H[ne][0]=L.read_shift(2);L[L.l];)H[ne][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return H}function z(L,W){var H=Q(5+L.length);H.write_shift(2,14e3),H.write_shift(2,W);for(var V=0;V<L.length;++V){var ne=L.charCodeAt(V);H[H.l++]=ne>127?95:ne}return H[H.l++]=0,H}var se={0:{n:"BOF",f:w1},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:_e},222:{n:"SHEETNAMELP",f:Ne},65535:{n:""}},ye={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:G},23:{n:"NUMBER17",f:b},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:J},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:X},38:{n:"??"},39:{n:"NUMBER27",f:re},40:{n:"FORMULA28",f:we},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:_e},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ge},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:t}}(),oS=/^\s|\s$|[\t\n\r]/;function R1(e,t){if(!t.bookSST)return"";var n=[ct];n[n.length]=le("sst",null,{xmlns:gs[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var i=e[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(oS)&&(s+=' xml:space="preserve"'),s+=">"+Ge(i.t)+"</t>"),s+="</si>",n[n.length]=s}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function aS(e){return[e.read_shift(4),e.read_shift(4)]}function lS(e,t){return t||(t=Q(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var uS=ZT;function cS(e){var t=Qt();ie(t,159,lS(e));for(var n=0;n<e.length;++n)ie(t,19,uS(e[n]));return ie(t,160),t.end()}function fS(e){for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function P1(e){var t=0,n,r=fS(e),i=r.length+1,s,o,a,l,u;for(n=fi(i),n[0]=r.length,s=1;s!=i;++s)n[s]=r[s-1];for(s=i-1;s>=0;--s)o=n[s],a=t&16384?1:0,l=t<<1&32767,u=a|l,t=u^o;return t^52811}var dS=function(){function e(i,s){switch(s.type){case"base64":return t(hr(i),s);case"binary":return t(i,s);case"buffer":return t(Oe&&Buffer.isBuffer(i)?i.toString("binary"):Uo(i),s);case"array":return t(tu(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(c,p){Array.isArray(a)&&(a[p]=[]);for(var m=/\\\w+\b/g,g=0,y,x=-1;y=m.exec(c);){switch(y[0]){case"\\cell":var S=c.slice(g,m.lastIndex-y[0].length);if(S[0]==" "&&(S=S.slice(1)),++x,S.length){var T={v:S,t:"s"};Array.isArray(a)?a[p][x]=T:a[He({r:p,c:x})]=T}break}g=m.lastIndex}x>u.e.c&&(u.e.c=x)}),a["!ref"]=ut(u),a}function n(i,s){return gi(e(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],o=Qe(i["!ref"]),a,l=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var c=o.s.c;c<=o.e.c;++c)s.push("\\cellx"+(c+1));for(s.push("\\pard\\intbl"),c=o.s.c;c<=o.e.c;++c){var p=He({r:u,c});a=l?(i[u]||[])[c]:i[p],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(pr(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:r}}();function bh(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}var hS=6,lr=hS;function Al(e){return Math.floor((e+Math.round(128/lr)/256)*lr)}function Nl(e){return Math.floor((e-5)/lr*100+.5)/100}function tf(e){return Math.round((e*lr+5)/lr*256)/256}function Ed(e){e.width?(e.wpx=Al(e.width),e.wch=Nl(e.wpx),e.MDW=lr):e.wpx?(e.wch=Nl(e.wpx),e.width=tf(e.wch),e.MDW=lr):typeof e.wch=="number"&&(e.width=tf(e.wch),e.wpx=Al(e.width),e.MDW=lr),e.customWidth&&delete e.customWidth}var pS=96,F1=pS;function Il(e){return e*96/F1}function M1(e){return e*F1/96}function mS(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)e[r]!=null&&(t[t.length]=le("numFmt",null,{numFmtId:r,formatCode:Ge(e[r])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=le("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function gS(e){var t=[];return t[t.length]=le("cellXfs",null),e.forEach(function(n){t[t.length]=le("xf",null,n)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=le("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function b1(e,t){var n=[ct,le("styleSheet",null,{xmlns:gs[0],"xmlns:vt":mt.vt})],r;return e.SSF&&(r=mS(e.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=gS(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function xS(e,t){var n=e.read_shift(2),r=Lt(e);return[n,r]}function vS(e,t,n){n||(n=Q(6+4*t.length)),n.write_shift(2,e),xt(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function yS(e,t,n){var r={};r.sz=e.read_shift(2)/20;var i=o_(e);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=e.read_shift(2);switch(s===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(r.underline=o);var a=e.read_shift(1);a>0&&(r.family=a);var l=e.read_shift(1);switch(l>0&&(r.charset=l),e.l++,r.color=s_(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Lt(e),r}function ES(e,t){t||(t=Q(25+4*32)),t.write_shift(2,e.sz*20),a_(e,t),t.write_shift(2,e.bold?700:400);var n=0;e.vertAlign=="superscript"?n=1:e.vertAlign=="subscript"&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),wl(e.color,t);var r=0;return r=2,t.write_shift(1,r),xt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var TS=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Yu,_S=Qn;function Dh(e,t){t||(t=Q(4*3+8*7+16*1)),Yu||(Yu=ld(TS));var n=Yu[e.patternType];n==null&&(n=40),t.write_shift(4,n);var r=0;if(n!=40)for(wl({auto:1},t),wl({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function SS(e,t){var n=e.l+t,r=e.read_shift(2),i=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:i}}function D1(e,t,n){n||(n=Q(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function Bs(e,t){return t||(t=Q(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var wS=Qn;function CS(e,t){return t||(t=Q(51)),t.write_shift(1,0),Bs(null,t),Bs(null,t),Bs(null,t),Bs(null,t),Bs(null,t),t.length>t.l?t.slice(0,t.l):t}function AS(e,t){return t||(t=Q(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Sl(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function NS(e,t,n){var r=Q(2052);return r.write_shift(4,e),Sl(t,r),Sl(n,r),r.length>r.l?r.slice(0,r.l):r}function IS(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&++n}),n!=0&&(ie(e,615,Vn(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&ie(e,44,vS(i,t[i]))}),ie(e,616))}}function kS(e){var t=1;ie(e,611,Vn(t)),ie(e,43,ES({sz:12,color:{theme:1},name:"Calibri",family:2})),ie(e,612)}function RS(e){var t=2;ie(e,603,Vn(t)),ie(e,45,Dh({patternType:"none"})),ie(e,45,Dh({patternType:"gray125"})),ie(e,604)}function PS(e){var t=1;ie(e,613,Vn(t)),ie(e,46,CS()),ie(e,614)}function FS(e){var t=1;ie(e,626,Vn(t)),ie(e,47,D1({numFmtId:0},65535)),ie(e,627)}function MS(e,t){ie(e,617,Vn(t.length)),t.forEach(function(n){ie(e,47,D1(n,0))}),ie(e,618)}function bS(e){var t=1;ie(e,619,Vn(t)),ie(e,48,AS({xfId:0,name:"Normal"})),ie(e,620)}function DS(e){var t=0;ie(e,505,Vn(t)),ie(e,506)}function LS(e){var t=0;ie(e,508,NS(t,"TableStyleMedium9","PivotStyleMedium4")),ie(e,509)}function OS(e,t){var n=Qt();return ie(n,278),IS(n,e.SSF),kS(n),RS(n),PS(n),FS(n),MS(n,t.cellXfs),bS(n),DS(n),LS(n),ie(n,279),n.end()}function L1(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var n=[ct];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function US(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Lt(e)}}function BS(e){var t=Q(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),xt(e.name,t),t.slice(0,t.l)}function GS(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function VS(e){var t=Q(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}function HS(e,t){var n=Q(8+2*t.length);return n.write_shift(4,e),xt(t,n),n.slice(0,n.l)}function $S(e){return e.l+=4,e.read_shift(4)!=0}function zS(e,t){var n=Q(8);return n.write_shift(4,e),n.write_shift(4,1),n}function jS(){var e=Qt();return ie(e,332),ie(e,334,Vn(1)),ie(e,335,BS({name:"XLDAPR",version:12e4,flags:3496657072})),ie(e,336),ie(e,339,HS(1,"XLDAPR")),ie(e,52),ie(e,35,Vn(514)),ie(e,4096,Vn(0)),ie(e,4097,yn(1)),ie(e,36),ie(e,53),ie(e,340),ie(e,337,zS(1)),ie(e,51,VS([[1,0]])),ie(e,338),ie(e,333),e.end()}function O1(){var e=[ct];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function WS(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=He(n);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}var Hi=1024;function U1(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[le("xml",null,{"xmlns:v":an.v,"xmlns:o":an.o,"xmlns:x":an.x,"xmlns:mv":an.mv}).replace(/\/>/,">"),le("o:shapelayout",le("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),le("v:shapetype",[le("v:stroke",null,{joinstyle:"miter"}),le("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Hi<e*1e3;)Hi+=1e3;return t.forEach(function(s){var o=gt(s[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?le("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=le("v:fill",l,a),c={on:"t",obscured:"t"};++Hi,i=i.concat(["<v:shape"+Ro({id:"_x0000_s"+Hi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,le("v:shadow",null,c),le("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ct("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Ct("x:AutoFill","False"),Ct("x:Row",String(o.r)),Ct("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function B1(e){var t=[ct,le("comments",null,{xmlns:gs[0]})],n=[];return t.push("<authors>"),e.forEach(function(r){r[1].forEach(function(i){var s=Ge(i.a);n.indexOf(s)==-1&&(n.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&n.indexOf("tc="+i.ID)==-1&&(n.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=n.indexOf(Ge(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(Ct("t",Ge(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,a=1;a<s.length;++a)o+=`Reply:
    `+s[a]+`
`;t.push(Ct("t",Ge(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function qS(e,t,n){var r=[ct,le("ThreadedComments",null,{xmlns:mt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};a==0?s=l.id:l.parentId=s,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),r.push(le("threadedComment",Ct("text",o.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function JS(e){var t=[ct,le("personList",null,{xmlns:mt.TCMNT,"xmlns:x":gs[0]}).replace(/[\/]>/,">")];return e.forEach(function(n,r){t.push(le("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),t.push("</personList>"),t.join("")}function KS(e){var t={};t.iauthor=e.read_shift(4);var n=Ei(e);return t.rfx=n.s,t.ref=He(n.s),e.l+=16,t}function YS(e,t){return t==null&&(t=Q(36)),t.write_shift(4,e[1].iauthor),vs(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var XS=Lt;function QS(e){return xt(e.slice(0,54))}function ZS(e){var t=Qt(),n=[];return ie(t,628),ie(t,630),e.forEach(function(r){r[1].forEach(function(i){n.indexOf(i.a)>-1||(n.push(i.a.slice(0,54)),ie(t,632,QS(i.a)))})}),ie(t,631),ie(t,633),e.forEach(function(r){r[1].forEach(function(i){i.iauthor=n.indexOf(i.a);var s={s:gt(r[0]),e:gt(r[0])};ie(t,635,YS([s,i])),i.t&&i.t.length>0&&ie(t,637,t_(i)),ie(t,636),delete i.iauthor})}),ie(t,634),ie(t,629),t.end()}function ew(e,t){t.FullPaths.forEach(function(n,r){if(r!=0){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&ze.utils.cfb_add(e,i,t.FileIndex[r].content)}})}var G1=["xlsb","xlsm","xlam","biff8","xla"],tw=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(r,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,c=o.length>0?parseInt(o,10)|0:0;return a?c+=t.c:--c,l?u+=t.r:--u,i+(a?"":"$")+Dt(c)+(l?"":"$")+Nt(u)}return function(i,s){return t=s,i.replace(e,n)}}(),Td=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,_d=function(){return function(t,n){return t.replace(Td,function(r,i,s,o,a,l){var u=md(o)-(s?0:n.c),c=pd(l)-(a?0:n.r),p=c==0?"":a?c+1:"["+c+"]",m=u==0?"":s?u+1:"["+u+"]";return i+"R"+p+"C"+m})}}();function nw(e,t){return e.replace(Td,function(n,r,i,s,o,a){return r+(i=="$"?i+s:Dt(md(s)+t.c))+(o=="$"?o+a:Nt(pd(a)+t.r))})}function rw(e){return e.length!=1}function at(e){e.l+=1}function zr(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function V1(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return H1(e);n.biff==12&&(r=4)}var i=e.read_shift(r),s=e.read_shift(r),o=zr(e),a=zr(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function H1(e){var t=zr(e),n=zr(e),r=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function iw(e,t,n){if(n.biff<8)return H1(e);var r=e.read_shift(n.biff==12?4:2),i=e.read_shift(n.biff==12?4:2),s=zr(e),o=zr(e);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function $1(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return sw(e);var r=e.read_shift(n&&n.biff==12?4:2),i=zr(e);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function sw(e){var t=zr(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function ow(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function aw(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return lw(e);var i=e.read_shift(r>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function lw(e){var t=e.read_shift(2),n=e.read_shift(1),r=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),i==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:i,rRel:r}}function uw(e,t,n){var r=(e[e.l++]&96)>>5,i=V1(e,n.biff>=2&&n.biff<=5?6:8,n);return[r,i]}function cw(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=V1(e,s,n);return[r,i,o]}function fw(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function dw(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[r,i]}function hw(e,t,n){var r=(e[e.l++]&96)>>5,i=iw(e,t-1,n);return[r,i]}function pw(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[r]}function Lh(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function mw(e,t,n){e.l+=2;for(var r=e.read_shift(n&&n.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(e.read_shift(n&&n.biff==2?1:2));return i}function gw(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function xw(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function vw(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function yw(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[r]}function z1(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function Ew(e){return e.read_shift(2),z1(e)}function Tw(e){return e.read_shift(2),z1(e)}function _w(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=$1(e,0,n);return[r,i]}function Sw(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=aw(e,0,n);return[r,i]}function ww(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var s=$1(e,0,n);return[r,i,s]}function Cw(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(n&&n.biff<=3?1:2);return[CC[i],q1[i],r]}function Aw(e,t,n){var r=e[e.l++],i=e.read_shift(1),s=n&&n.biff<=3?[r==88?-1:0,e.read_shift(1)]:Nw(e);return[i,(s[0]===0?q1:wC)[s[1]]]}function Nw(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Iw(e,t,n){e.l+=n&&n.biff==2?3:4}function kw(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function Rw(e){return e.l++,Vo[e.read_shift(1)]}function Pw(e){return e.l++,e.read_shift(2)}function Fw(e){return e.l++,e.read_shift(1)!==0}function Mw(e){return e.l++,ys(e)}function bw(e,t,n){return e.l++,A1(e,t-1,n)}function Dw(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=w_(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=Vo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=ys(e);break;case 2:n[1]=I_(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function Lw(e,t,n){for(var r=e.read_shift(n.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((n.biff==12?Ei:P_)(e));return i}function Ow(e,t,n){var r=0,i=0;n.biff==12?(r=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--i==0&&(i=256));for(var s=0,o=[];s!=r&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=Dw(e,n.biff);return o}function Uw(e,t,n){var r=e.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,s=e.read_shift(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,s]}function Bw(e,t,n){if(n.biff==5)return Gw(e);var r=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[r,i,s]}function Gw(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}function Vw(e,t,n){var r=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function Hw(e,t,n){var r=e.read_shift(1)>>>5&3,i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function $w(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[r]}function zw(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[r,i]}var jw=Qn,Ww=Qn,qw=Qn;function Ho(e,t,n){return e.l+=2,[ow(e)]}function Sd(e){return e.l+=6,[]}var Jw=Ho,Kw=Sd,Yw=Sd,Xw=Ho;function j1(e){return e.l+=2,[w1(e),e.read_shift(2)&1]}var Qw=Ho,Zw=j1,eC=Sd,tC=Ho,nC=Ho,rC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function iC(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=rC[n>>2&31];return{ixti:t,coltype:n&3,rt:o,idx:r,c:i,C:s}}function sC(e){return e.l+=2,[e.read_shift(4)]}function oC(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function aC(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function lC(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function uC(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function cC(e){return e.l+=4,[0,0]}var Oh={1:{n:"PtgExp",f:kw},2:{n:"PtgTbl",f:qw},3:{n:"PtgAdd",f:at},4:{n:"PtgSub",f:at},5:{n:"PtgMul",f:at},6:{n:"PtgDiv",f:at},7:{n:"PtgPower",f:at},8:{n:"PtgConcat",f:at},9:{n:"PtgLt",f:at},10:{n:"PtgLe",f:at},11:{n:"PtgEq",f:at},12:{n:"PtgGe",f:at},13:{n:"PtgGt",f:at},14:{n:"PtgNe",f:at},15:{n:"PtgIsect",f:at},16:{n:"PtgUnion",f:at},17:{n:"PtgRange",f:at},18:{n:"PtgUplus",f:at},19:{n:"PtgUminus",f:at},20:{n:"PtgPercent",f:at},21:{n:"PtgParen",f:at},22:{n:"PtgMissArg",f:at},23:{n:"PtgStr",f:bw},26:{n:"PtgSheet",f:oC},27:{n:"PtgEndSheet",f:aC},28:{n:"PtgErr",f:Rw},29:{n:"PtgBool",f:Fw},30:{n:"PtgInt",f:Pw},31:{n:"PtgNum",f:Mw},32:{n:"PtgArray",f:pw},33:{n:"PtgFunc",f:Cw},34:{n:"PtgFuncVar",f:Aw},35:{n:"PtgName",f:Uw},36:{n:"PtgRef",f:_w},37:{n:"PtgArea",f:uw},38:{n:"PtgMemArea",f:Vw},39:{n:"PtgMemErr",f:jw},40:{n:"PtgMemNoMem",f:Ww},41:{n:"PtgMemFunc",f:Hw},42:{n:"PtgRefErr",f:$w},43:{n:"PtgAreaErr",f:fw},44:{n:"PtgRefN",f:Sw},45:{n:"PtgAreaN",f:hw},46:{n:"PtgMemAreaN",f:lC},47:{n:"PtgMemNoMemN",f:uC},57:{n:"PtgNameX",f:Bw},58:{n:"PtgRef3d",f:ww},59:{n:"PtgArea3d",f:cw},60:{n:"PtgRefErr3d",f:zw},61:{n:"PtgAreaErr3d",f:dw},255:{}},fC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},dC={1:{n:"PtgElfLel",f:j1},2:{n:"PtgElfRw",f:tC},3:{n:"PtgElfCol",f:Jw},6:{n:"PtgElfRwV",f:nC},7:{n:"PtgElfColV",f:Xw},10:{n:"PtgElfRadical",f:Qw},11:{n:"PtgElfRadicalS",f:eC},13:{n:"PtgElfColS",f:Kw},15:{n:"PtgElfColSV",f:Yw},16:{n:"PtgElfRadicalLel",f:Zw},25:{n:"PtgList",f:iC},29:{n:"PtgSxName",f:sC},255:{}},hC={0:{n:"PtgAttrNoop",f:cC},1:{n:"PtgAttrSemi",f:yw},2:{n:"PtgAttrIf",f:xw},4:{n:"PtgAttrChoose",f:mw},8:{n:"PtgAttrGoto",f:gw},16:{n:"PtgAttrSum",f:Iw},32:{n:"PtgAttrBaxcel",f:Lh},33:{n:"PtgAttrBaxcel",f:Lh},64:{n:"PtgAttrSpace",f:Ew},65:{n:"PtgAttrSpaceSemi",f:Tw},128:{n:"PtgAttrIfError",f:vw},255:{}};function pC(e,t,n,r){if(r.biff<8)return Qn(e,t);for(var i=e.l+t,s=[],o=0;o!==n.length;++o)switch(n[o][0]){case"PtgArray":n[o][1]=Ow(e,0,r),s.push(n[o][1]);break;case"PtgMemArea":n[o][2]=Lw(e,n[o][1],r),s.push(n[o][2]);break;case"PtgExp":r&&r.biff==12&&(n[o][1][1]=e.read_shift(4),s.push(n[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[o][0]}return t=i-e.l,t!==0&&s.push(Qn(e,t)),s}function mC(e,t,n){for(var r=e.l+t,i,s,o=[];r!=e.l;)t=r-e.l,s=e[e.l],i=Oh[s]||Oh[fC[s]],(s===24||s===25)&&(i=(s===24?dC:hC)[e[e.l+1]]),!i||!i.f?Qn(e,t):o.push([i.n,i.f(e,t,n)]);return o}function gC(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],i=[],s=0;s<r.length;++s){var o=r[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var xC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function vC(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function W1(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(e[r[0]][0]){case 357:return i=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[r[0]][0][3]?(i=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Uh(e,t,n){var r=W1(e,t,n);return r=="#REF"?r:vC(r,n)}function ds(e,t,n,r,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},a=[],l,u,c,p=0,m=0,g,y="";if(!e[0]||!e[0][0])return"";for(var x=-1,S="",T=0,E=e[0].length;T<E;++T){var _=e[0][T];switch(_[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),u=a.pop(),x>=0){switch(e[0][x][1][0]){case 0:S=it(" ",e[0][x][1][1]);break;case 1:S=it("\r",e[0][x][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}u=u+S,x=-1}a.push(u+xC[_[0]]+l);break;case"PtgIsect":l=a.pop(),u=a.pop(),a.push(u+" "+l);break;case"PtgUnion":l=a.pop(),u=a.pop(),a.push(u+","+l);break;case"PtgRange":l=a.pop(),u=a.pop(),a.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=io(_[1][1],o,i),a.push(so(c,s));break;case"PtgRefN":c=n?io(_[1][1],n,i):_[1][1],a.push(so(c,s));break;case"PtgRef3d":p=_[1][1],c=io(_[1][2],o,i),y=Uh(r,p,i),a.push(y+"!"+so(c,s));break;case"PtgFunc":case"PtgFuncVar":var N=_[1][0],B=_[1][1];N||(N=0),N&=127;var G=N==0?[]:a.slice(-N);a.length-=N,B==="User"&&(B=G.shift()),a.push(B+"("+G.join(",")+")");break;case"PtgBool":a.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(_[1]);break;case"PtgNum":a.push(String(_[1]));break;case"PtgStr":a.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(_[1]);break;case"PtgAreaN":g=_h(_[1][1],n?{s:n}:o,i),a.push(Ju(g,i));break;case"PtgArea":g=_h(_[1][1],o,i),a.push(Ju(g,i));break;case"PtgArea3d":p=_[1][1],g=_[1][2],y=Uh(r,p,i),a.push(y+"!"+Ju(g,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=_[1][2];var k=(r.names||[])[m-1]||(r[0]||[])[m],D=k?k.Name:"SH33TJSNAME"+String(m);D&&D.slice(0,6)=="_xlfn."&&!i.xlfn&&(D=D.slice(6)),a.push(D);break;case"PtgNameX":var b=_[1][1];m=_[1][2];var O;if(i.biff<=5)b<0&&(b=-b),r[b]&&(O=r[b][m]);else{var J="";if(((r[b]||[])[0]||[])[0]==14849||(((r[b]||[])[0]||[])[0]==1025?r[b][m]&&r[b][m].itab>0&&(J=r.SheetNames[r[b][m].itab-1]+"!"):J=r.SheetNames[m-1]+"!"),r[b]&&r[b][m])J+=r[b][m].Name;else if(r[0]&&r[0][m])J+=r[0][m].Name;else{var X=(W1(r,b,i)||"").split(";;");X[m-1]?J=X[m-1]:J+="SH33TJSERRX"}a.push(J);break}O||(O={Name:"SH33TJSERRY"}),a.push(O.Name);break;case"PtgParen":var re="(",we=")";if(x>=0){switch(S="",e[0][x][1][0]){case 2:re=it(" ",e[0][x][1][1])+re;break;case 3:re=it("\r",e[0][x][1][1])+re;break;case 4:we=it(" ",e[0][x][1][1])+we;break;case 5:we=it("\r",e[0][x][1][1])+we;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}a.push(re+a.pop()+we);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":c={c:_[1][1],r:_[1][0]};var _e={c:n.c,r:n.r};if(r.sharedf[He(c)]){var Ne=r.sharedf[He(c)];a.push(ds(Ne,o,_e,r,i))}else{var ge=!1;for(l=0;l!=r.arrayf.length;++l)if(u=r.arrayf[l],!(c.c<u[0].s.c||c.c>u[0].e.c)&&!(c.r<u[0].s.r||c.r>u[0].e.r)){a.push(ds(u[1],o,_e,r,i)),ge=!0;break}ge||a.push(_[1])}break;case"PtgArray":a.push("{"+gC(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&ae.indexOf(e[0][T][0])==-1){_=e[0][x];var z=!0;switch(_[1][0]){case 4:z=!1;case 0:S=it(" ",_[1][1]);break;case 5:z=!1;case 1:S=it("\r",_[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}a.push((z?S:"")+a.pop()+(z?"":S)),x=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function yC(e){if(e==null){var t=Q(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return di(e);return di(0)}function EC(e,t,n,r,i){var s=hi(t,n,i),o=yC(e.v),a=Q(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var u=Q(e.bf.length),c=0;c<e.bf.length;++c)u[c]=e.bf[c];var p=wt([s,o,a,u]);return p}function nu(e,t,n){var r=e.read_shift(4),i=mC(e,r,n),s=e.read_shift(4),o=s>0?pC(e,s,i,n):null;return[i,o]}var TC=nu,ru=nu,_C=nu,SC=nu,wC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},q1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},CC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function AC(e){var t="of:="+e.replace(Td,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function NC(e){return e.replace(/\./,"!")}var oo=typeof Map<"u";function wd(e,t,n){var r=0,i=e.length;if(n){if(oo?n.has(t):Object.prototype.hasOwnProperty.call(n,t)){for(var s=oo?n.get(t):n[t];r<s.length;++r)if(e[s[r]].t===t)return e.Count++,s[r]}}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t},e.Count++,e.Unique++,n&&(oo?(n.has(t)||n.set(t,[]),n.get(t).push(i)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(i))),i}function iu(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(lr=t.MDW),t.width!=null?n.customWidth=1:t.wpx!=null?r=Nl(t.wpx):t.wch!=null&&(r=t.wch),r>-1?(n.width=tf(r),n.customWidth=1):t.width!=null&&(n.width=t.width),t.hidden&&(n.hidden=!0),t.level!=null&&(n.outlineLevel=n.level=t.level),n}function J1(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function Kr(e,t,n){var r=n.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(r==null&&n.ssf){for(;i<392;++i)if(n.ssf[i]==null){$x(t.z,i),n.ssf[i]=t.z,n.revssf[t.z]=r=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===r)return i;return e[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function IC(e,t,n){if(e&&e["!ref"]){var r=Qe(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}function kC(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+ut(e[n])+'"/>';return t+"</mergeCells>"}function RC(e,t,n,r,i){var s=!1,o={},a=null;if(r.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch{}s=!0,o.codeName=ko(Ge(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),a=(a||"")+le("outlinePr",null,u)}!s&&!a||(i[i.length]=le("sheetPr",a,o))}var PC=["objects","scenarios","selectLockedCells","selectUnlockedCells"],FC=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function MC(e){var t={sheet:1};return PC.forEach(function(n){e[n]!=null&&e[n]&&(t[n]="1")}),FC.forEach(function(n){e[n]!=null&&!e[n]&&(t[n]="0")}),e.password&&(t.password=P1(e.password).toString(16).toUpperCase()),le("sheetProtection",null,t)}function bC(e){return J1(e),le("pageMargins",null,e)}function DC(e,t){for(var n=["<cols>"],r,i=0;i!=t.length;++i)(r=t[i])&&(n[n.length]=le("col",null,iu(i,r)));return n[n.length]="</cols>",n.join("")}function LC(e,t,n,r){var i=typeof e.ref=="string"?e.ref:ut(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,o=dn(i);o.s.r==o.e.r&&(o.e.r=dn(t["!ref"]).e.r,i=ut(o));for(var a=0;a<s.length;++a){var l=s[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),le("autoFilter",null,{ref:i})}function OC(e,t,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),le("sheetViews",le("sheetView",null,i),{})}function UC(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Vo[e.v];break;case"d":r&&r.cellDates?i=zt(e.v,-1).toISOString():(e=en(e),e.t="n",i=""+(e.v=Zt(zt(e.v)))),typeof e.z>"u"&&(e.z=st[14]);break;default:i=e.v;break}var a=Ct("v",Ge(i)),l={r:t},u=Kr(r.cellXfs,e,r);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){a=Ct("v",""+wd(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var c=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;a=le("f",Ge(e.f),c)+(e.v!=null?a:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),le("c",a,l)}function BC(e,t,n,r){var i=[],s=[],o=Qe(e["!ref"]),a="",l,u="",c=[],p=0,m=0,g=e["!rows"],y=Array.isArray(e),x={r:u},S,T=-1;for(m=o.s.c;m<=o.e.c;++m)c[m]=Dt(m);for(p=o.s.r;p<=o.e.r;++p){for(s=[],u=Nt(p),m=o.s.c;m<=o.e.c;++m){l=c[m]+u;var E=y?(e[p]||[])[m]:e[l];E!==void 0&&(a=UC(E,l,e,t))!=null&&s.push(a)}(s.length>0||g&&g[p])&&(x={r:u},g&&g[p]&&(S=g[p],S.hidden&&(x.hidden=1),T=-1,S.hpx?T=Il(S.hpx):S.hpt&&(T=S.hpt),T>-1&&(x.ht=T,x.customHeight=1),S.level&&(x.outlineLevel=S.level)),i[i.length]=le("row",s.join(""),x))}if(g)for(;p<g.length;++p)g&&g[p]&&(x={r:p+1},S=g[p],S.hidden&&(x.hidden=1),T=-1,S.hpx?T=Il(S.hpx):S.hpt&&(T=S.hpt),T>-1&&(x.ht=T,x.customHeight=1),S.level&&(x.outlineLevel=S.level),i[i.length]=le("row","",x));return i.join("")}function K1(e,t,n,r){var i=[ct,le("worksheet",null,{xmlns:gs[0],"xmlns:r":mt.r})],s=n.SheetNames[e],o=0,a="",l=n.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",c=Qe(u);if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),u=ut(c)}r||(r={}),l["!comments"]=[];var p=[];RC(l,n,e,t,i),i[i.length]=le("dimension",null,{ref:u}),i[i.length]=OC(l,t,e,n),t.sheetFormat&&(i[i.length]=le("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=DC(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=BC(l,t),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=MC(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=LC(l["!autofilter"],l,n,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=kC(l["!merges"]));var m=-1,g,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(g={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=Be(r,-1,Ge(x[1].Target).replace(/#.*$/,""),be.HLINK),g["r:id"]="rId"+y),(m=x[1].Target.indexOf("#"))>-1&&(g.location=Ge(x[1].Target.slice(m+1))),x[1].Tooltip&&(g.tooltip=Ge(x[1].Tooltip)),i[i.length]=le("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=bC(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Ct("ignoredErrors",le("ignoredError",null,{numberStoredAsText:1,sqref:u}))),p.length>0&&(y=Be(r,-1,"../drawings/drawing"+(e+1)+".xml",be.DRAW),i[i.length]=le("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=p),l["!comments"].length>0&&(y=Be(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",be.VML),i[i.length]=le("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function GC(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=r,s&7&&(n.level=s&7),s&16&&(n.hidden=!0),s&32&&(n.hpt=i/20),n}function VC(e,t,n){var r=Q(145),i=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var s=320;i.hpx?s=Il(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var a=0,l=r.l;r.l+=4;for(var u={r:e,c:0},c=0;c<16;++c)if(!(t.s.c>c+1<<10||t.e.c<c<<10)){for(var p=-1,m=-1,g=c<<10;g<c+1<<10;++g){u.c=g;var y=Array.isArray(n)?(n[u.r]||[])[u.c]:n[He(u)];y&&(p<0&&(p=g),m=g)}p<0||(++a,r.write_shift(4,p),r.write_shift(4,m))}var x=r.l;return r.l=l,r.write_shift(4,a),r.l=x,r.length>r.l?r.slice(0,r.l):r}function HC(e,t,n,r){var i=VC(r,n,t);(i.length>17||(t["!rows"]||[])[r])&&ie(e,0,i)}var $C=Ei,zC=vs;function jC(){}function WC(e,t){var n={},r=e[e.l];return++e.l,n.above=!(r&64),n.left=!(r&128),e.l+=18,n.name=n_(e),n}function qC(e,t,n){n==null&&(n=Q(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return wl({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),c1(e,n),n.slice(0,n.l)}function JC(e){var t=In(e);return[t]}function KC(e,t,n){return n==null&&(n=Q(8)),xi(t,n)}function YC(e){var t=vi(e);return[t]}function XC(e,t,n){return n==null&&(n=Q(4)),yi(t,n)}function QC(e){var t=In(e),n=e.read_shift(1);return[t,n,"b"]}function ZC(e,t,n){return n==null&&(n=Q(9)),xi(t,n),n.write_shift(1,e.v?1:0),n}function eA(e){var t=vi(e),n=e.read_shift(1);return[t,n,"b"]}function tA(e,t,n){return n==null&&(n=Q(5)),yi(t,n),n.write_shift(1,e.v?1:0),n}function nA(e){var t=In(e),n=e.read_shift(1);return[t,n,"e"]}function rA(e,t,n){return n==null&&(n=Q(9)),xi(t,n),n.write_shift(1,e.v),n}function iA(e){var t=vi(e),n=e.read_shift(1);return[t,n,"e"]}function sA(e,t,n){return n==null&&(n=Q(8)),yi(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}function oA(e){var t=In(e),n=e.read_shift(4);return[t,n,"s"]}function aA(e,t,n){return n==null&&(n=Q(12)),xi(t,n),n.write_shift(4,t.v),n}function lA(e){var t=vi(e),n=e.read_shift(4);return[t,n,"s"]}function uA(e,t,n){return n==null&&(n=Q(8)),yi(t,n),n.write_shift(4,t.v),n}function cA(e){var t=In(e),n=ys(e);return[t,n,"n"]}function fA(e,t,n){return n==null&&(n=Q(16)),xi(t,n),di(e.v,n),n}function dA(e){var t=vi(e),n=ys(e);return[t,n,"n"]}function hA(e,t,n){return n==null&&(n=Q(12)),yi(t,n),di(e.v,n),n}function pA(e){var t=In(e),n=f1(e);return[t,n,"n"]}function mA(e,t,n){return n==null&&(n=Q(12)),xi(t,n),d1(e.v,n),n}function gA(e){var t=vi(e),n=f1(e);return[t,n,"n"]}function xA(e,t,n){return n==null&&(n=Q(8)),yi(t,n),d1(e.v,n),n}function vA(e){var t=In(e),n=gd(e);return[t,n,"is"]}function yA(e){var t=In(e),n=Lt(e);return[t,n,"str"]}function EA(e,t,n){return n==null&&(n=Q(12+4*e.v.length)),xi(t,n),xt(e.v,n),n.length>n.l?n.slice(0,n.l):n}function TA(e){var t=vi(e),n=Lt(e);return[t,n,"str"]}function _A(e,t,n){return n==null&&(n=Q(8+4*e.v.length)),yi(t,n),xt(e.v,n),n.length>n.l?n.slice(0,n.l):n}function SA(e,t,n){var r=e.l+t,i=In(e);i.r=n["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(n.cellFormula){e.l+=2;var a=ru(e,r-e.l,n);o[3]=ds(a,null,i,n.supbooks,n)}else e.l=r;return o}function wA(e,t,n){var r=e.l+t,i=In(e);i.r=n["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(n.cellFormula){e.l+=2;var a=ru(e,r-e.l,n);o[3]=ds(a,null,i,n.supbooks,n)}else e.l=r;return o}function CA(e,t,n){var r=e.l+t,i=In(e);i.r=n["!row"];var s=ys(e),o=[i,s,"n"];if(n.cellFormula){e.l+=2;var a=ru(e,r-e.l,n);o[3]=ds(a,null,i,n.supbooks,n)}else e.l=r;return o}function AA(e,t,n){var r=e.l+t,i=In(e);i.r=n["!row"];var s=Lt(e),o=[i,s,"str"];if(n.cellFormula){e.l+=2;var a=ru(e,r-e.l,n);o[3]=ds(a,null,i,n.supbooks,n)}else e.l=r;return o}var NA=Ei,IA=vs;function kA(e,t){return t==null&&(t=Q(4)),t.write_shift(4,e),t}function RA(e,t){var n=e.l+t,r=Ei(e),i=xd(e),s=Lt(e),o=Lt(e),a=Lt(e);e.l=n;var l={rfx:r,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function PA(e,t){var n=Q(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));vs({s:gt(e[0]),e:gt(e[0])},n),vd("rId"+t,n);var r=e[1].Target.indexOf("#"),i=r==-1?"":e[1].Target.slice(r+1);return xt(i||"",n),xt(e[1].Tooltip||"",n),xt("",n),n.slice(0,n.l)}function FA(){}function MA(e,t,n){var r=e.l+t,i=h1(e),s=e.read_shift(1),o=[i];if(o[2]=s,n.cellFormula){var a=TC(e,r-e.l,n);o[1]=a}else e.l=r;return o}function bA(e,t,n){var r=e.l+t,i=Ei(e),s=[i];if(n.cellFormula){var o=SC(e,r-e.l,n);s[1]=o,e.l=r}else e.l=r;return s}function DA(e,t,n){n==null&&(n=Q(18));var r=iu(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),n.write_shift(2,i),n}var Y1=["left","right","top","bottom","header","footer"];function LA(e){var t={};return Y1.forEach(function(n){t[n]=ys(e)}),t}function OA(e,t){return t==null&&(t=Q(6*8)),J1(e),Y1.forEach(function(n){di(e[n],t)}),t}function UA(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function BA(e,t,n){n==null&&(n=Q(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function GA(e){var t=Q(24);return t.write_shift(4,4),t.write_shift(4,1),vs(e,t),t}function VA(e,t){return t==null&&(t=Q(16*4+2)),t.write_shift(2,e.password?P1(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?t.write_shift(4,e[n[0]]!=null&&!e[n[0]]?1:0):t.write_shift(4,e[n[0]]!=null&&e[n[0]]?0:1)}),t}function HA(){}function $A(){}function zA(e,t,n,r,i,s,o){if(t.v===void 0)return!1;var a="";switch(t.t){case"b":a=t.v?"1":"0";break;case"d":t=en(t),t.z=t.z||st[14],t.v=Zt(zt(t.v)),t.t="n";break;case"n":case"e":a=""+t.v;break;default:a=t.v;break}var l={r:n,c:r};switch(l.s=Kr(i.cellXfs,t,i),t.l&&s["!links"].push([He(l),t.l]),t.c&&s["!comments"].push([He(l),t.c]),t.t){case"s":case"str":return i.bookSST?(a=wd(i.Strings,t.v,i.revStrings),l.t="s",l.v=a,o?ie(e,18,uA(t,l)):ie(e,7,aA(t,l))):(l.t="str",o?ie(e,17,_A(t,l)):ie(e,6,EA(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?ie(e,13,xA(t,l)):ie(e,2,mA(t,l)):o?ie(e,16,hA(t,l)):ie(e,5,fA(t,l)),!0;case"b":return l.t="b",o?ie(e,15,tA(t,l)):ie(e,4,ZC(t,l)),!0;case"e":return l.t="e",o?ie(e,14,sA(t,l)):ie(e,3,rA(t,l)),!0}return o?ie(e,12,XC(t,l)):ie(e,1,KC(t,l)),!0}function jA(e,t,n,r){var i=Qe(t["!ref"]||"A1"),s,o="",a=[];ie(e,145);var l=Array.isArray(t),u=i.e.r;t["!rows"]&&(u=Math.max(i.e.r,t["!rows"].length-1));for(var c=i.s.r;c<=u;++c){o=Nt(c),HC(e,t,i,c);var p=!1;if(c<=i.e.r)for(var m=i.s.c;m<=i.e.c;++m){c===i.s.r&&(a[m]=Dt(m)),s=a[m]+o;var g=l?(t[c]||[])[m]:t[s];if(!g){p=!1;continue}p=zA(e,g,c,m,r,t,p)}}ie(e,146)}function WA(e,t){!t||!t["!merges"]||(ie(e,177,kA(t["!merges"].length)),t["!merges"].forEach(function(n){ie(e,176,IA(n))}),ie(e,178))}function qA(e,t){!t||!t["!cols"]||(ie(e,390),t["!cols"].forEach(function(n,r){n&&ie(e,60,DA(r,n))}),ie(e,391))}function JA(e,t){!t||!t["!ref"]||(ie(e,648),ie(e,649,GA(Qe(t["!ref"]))),ie(e,650))}function KA(e,t,n){t["!links"].forEach(function(r){if(r[1].Target){var i=Be(n,-1,r[1].Target.replace(/#.*$/,""),be.HLINK);ie(e,494,PA(r,i))}}),delete t["!links"]}function YA(e,t,n,r){if(t["!comments"].length>0){var i=Be(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",be.VML);ie(e,551,vd("rId"+i)),t["!legacy"]=i}}function XA(e,t,n,r){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:ut(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,a=dn(s);a.s.r==a.e.r&&(a.e.r=dn(t["!ref"]).e.r,s=ut(a));for(var l=0;l<o.length;++l){var u=o[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+n.SheetNames[r]+"'!"+s;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+s}),ie(e,161,vs(Qe(s))),ie(e,162)}}function QA(e,t,n){ie(e,133),ie(e,137,BA(t,n)),ie(e,138),ie(e,134)}function ZA(e,t){t["!protect"]&&ie(e,535,VA(t["!protect"]))}function eN(e,t,n,r){var i=Qt(),s=n.SheetNames[e],o=n.Sheets[s]||{},a=s;try{n&&n.Workbook&&(a=n.Workbook.Sheets[e].CodeName||a)}catch{}var l=Qe(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ie(i,129),(n.vbaraw||o["!outline"])&&ie(i,147,qC(a,o["!outline"])),ie(i,148,zC(l)),QA(i,o,n.Workbook),qA(i,o),jA(i,o,e,t),ZA(i,o),XA(i,o,n,e),WA(i,o),KA(i,o,r),o["!margins"]&&ie(i,476,OA(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&JA(i,o),YA(i,o,e,r),ie(i,130),i.end()}function tN(e,t){e.l+=10;var n=Lt(e);return{name:n}}var nN=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function rN(e){return!e.Workbook||!e.Workbook.WBProps?"false":bT(e.Workbook.WBProps.date1904)?"true":"false"}var iN="][*?/\\".split("");function X1(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return iN.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function sN(e,t,n){e.forEach(function(r,i){X1(r);for(var s=0;s<i;++s)if(r==e[s])throw new Error("Duplicate Sheet Name: "+r);if(n){var o=t&&t[i]&&t[i].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function oN(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];sN(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)IC(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}function Q1(e){var t=[ct];t[t.length]=le("workbook",null,{xmlns:gs[0],"xmlns:r":mt.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(nN.forEach(function(a){e.Workbook.WBProps[a[0]]!=null&&e.Workbook.WBProps[a[0]]!=a[1]&&(r[a[0]]=e.Workbook.WBProps[a[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=le("workbookPr",null,r);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:Ge(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=le("sheet",null,o)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(t[t.length]=le("definedName",Ge(a.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function aN(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=ef(e),n.name=Lt(e),n}function lN(e,t){return t||(t=Q(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),vd(e.strRelID,t),xt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function uN(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var i=t>8?Lt(e):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function cN(e,t){t||(t=Q(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),c1(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function fN(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=r_(e),o=_C(e,0,n),a=xd(e);e.l=r;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function dN(e,t){ie(e,143);for(var n=0;n!=t.SheetNames.length;++n){var r=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,i={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]};ie(e,156,lN(i))}ie(e,144)}function hN(e,t){t||(t=Q(127));for(var n=0;n!=4;++n)t.write_shift(4,0);return xt("SheetJS",t),xt(gl.version,t),xt(gl.version,t),xt("7262",t),t.length>t.l?t.slice(0,t.l):t}function pN(e,t){t||(t=Q(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var n=120;return t.write_shift(1,n),t.length>t.l?t.slice(0,t.l):t}function mN(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var n=t.Workbook.Sheets,r=0,i=-1,s=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&i==-1?i=r:n[r].Hidden==1&&s==-1&&(s=r);s>i||(ie(e,135),ie(e,158,pN(i)),ie(e,136))}}function gN(e,t){var n=Qt();return ie(n,131),ie(n,128,hN()),ie(n,153,cN(e.Workbook&&e.Workbook.WBProps||null)),mN(n,e),dN(n,e),ie(n,132),n.end()}function xN(e,t,n){return(t.slice(-4)===".bin"?gN:Q1)(e)}function vN(e,t,n,r,i){return(t.slice(-4)===".bin"?eN:K1)(e,n,r,i)}function yN(e,t,n){return(t.slice(-4)===".bin"?OS:b1)(e,n)}function EN(e,t,n){return(t.slice(-4)===".bin"?cS:R1)(e,n)}function TN(e,t,n){return(t.slice(-4)===".bin"?ZS:B1)(e)}function _N(e){return(e.slice(-4)===".bin"?jS:O1)()}function SN(e,t){var n=[];return e.Props&&n.push(y_(e.Props,t)),e.Custprops&&n.push(E_(e.Props,e.Custprops)),n.join("")}function wN(){return""}function CN(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(r,i){var s=[];s.push(le("NumberFormat",null,{"ss:Format":Ge(st[r.numFmtId])}));var o={"ss:ID":"s"+(21+i)};n.push(le("Style",s.join(""),o))}),le("Styles",n.join(""))}function Z1(e){return le("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+_d(e.Ref,{r:0,c:0})})}function AN(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var i=t[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||n.push(Z1(i)))}return le("Names",n.join(""))}function NN(e,t,n,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==n&&(a.Name.match(/^_xlfn\./)||s.push(Z1(a)))}return s.join("")}function IN(e,t,n,r){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(le("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(le("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(le("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(le("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<n&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Ct("ProtectContents","True")),e["!protect"].objects&&i.push(Ct("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Ct("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Ct("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Ct("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":le("WorksheetOptions",i.join(""),{xmlns:an.x})}function kN(e){return e.map(function(t){var n=MT(t.t||""),r=le("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return le("Comment",r,{"ss:Author":t.a})}).join("")}function RN(e,t,n,r,i,s,o){if(!e||e.v==null&&e.f==null)return"";var a={};if(e.f&&(a["ss:Formula"]="="+Ge(_d(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var l=gt(e.F.slice(t.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(e.l&&e.l.Target&&(a["ss:HRef"]=Ge(e.l.Target),e.l.Tooltip&&(a["x:HRefScreenTip"]=Ge(e.l.Tooltip))),n["!merges"])for(var u=n["!merges"],c=0;c!=u.length;++c)u[c].s.c!=o.c||u[c].s.r!=o.r||(u[c].e.c>u[c].s.c&&(a["ss:MergeAcross"]=u[c].e.c-u[c].s.c),u[c].e.r>u[c].s.r&&(a["ss:MergeDown"]=u[c].e.r-u[c].s.r));var p="",m="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":p="Number",m=String(e.v);break;case"b":p="Boolean",m=e.v?"1":"0";break;case"e":p="Error",m=Vo[e.v];break;case"d":p="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||st[14]);break;case"s":p="String",m=FT(e.v||"");break}var g=Kr(r.cellXfs,e,r);a["ss:StyleID"]="s"+(21+g),a["ss:Index"]=o.c+1;var y=e.v!=null?m:"",x=e.t=="z"?"":'<Data ss:Type="'+p+'">'+y+"</Data>";return(e.c||[]).length>0&&(x+=kN(e.c)),le("Cell",x,a)}function PN(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=M1(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function FN(e,t,n,r){if(!e["!ref"])return"";var i=Qe(e["!ref"]),s=e["!merges"]||[],o=0,a=[];e["!cols"]&&e["!cols"].forEach(function(S,T){Ed(S);var E=!!S.width,_=iu(T,S),N={"ss:Index":T+1};E&&(N["ss:Width"]=Al(_.width)),S.hidden&&(N["ss:Hidden"]="1"),a.push(le("Column",null,N))});for(var l=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var c=[PN(u,(e["!rows"]||[])[u])],p=i.s.c;p<=i.e.c;++p){var m=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>p)&&!(s[o].s.r>u)&&!(s[o].e.c<p)&&!(s[o].e.r<u)){(s[o].s.c!=p||s[o].s.r!=u)&&(m=!0);break}if(!m){var g={r:u,c:p},y=He(g),x=l?(e[u]||[])[p]:e[y];c.push(RN(x,y,e,t,n,r,g))}}c.push("</Row>"),c.length>2&&a.push(c.join(""))}return a.join("")}function MN(e,t,n){var r=[],i=n.SheetNames[e],s=n.Sheets[i],o=s?NN(s,t,e,n):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=s?FN(s,t,e,n):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(IN(s,t,e,n)),r.join("")}function bN(e,t){t||(t={}),e.SSF||(e.SSF=en(st)),e.SSF&&(Zl(),Ql(e.SSF),t.revssf=eu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Kr(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(SN(e,t)),n.push(wN()),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(le("Worksheet",MN(r,t,e),{"ss:Name":Ge(e.SheetNames[r])}));return n[2]=CN(e,t),n[3]=AN(e),ct+le("Workbook",n.join(""),{xmlns:an.ss,"xmlns:o":an.o,"xmlns:x":an.x,"xmlns:ss":an.ss,"xmlns:dt":an.dt,"xmlns:html":an.html})}var Xu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function DN(e,t){var n=[],r=[],i=[],s=0,o,a=fh(wh,"n"),l=fh(Ch,"n");if(e.Props)for(o=kt(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(a,o[s])?n:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=kt(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(a,o[s])?n:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],e.Custprops[o[s]]]);var u=[];for(s=0;s<i.length;++s)S1.indexOf(i[s][0])>-1||E1.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);r.length&&ze.utils.cfb_add(t,"/SummaryInformation",Rh(r,Xu.SI,l,Ch)),(n.length||u.length)&&ze.utils.cfb_add(t,"/DocumentSummaryInformation",Rh(n,Xu.DSI,a,wh,u.length?u:null,Xu.UDI))}function LN(e,t){var n=t||{},r=ze.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return ze.utils.cfb_add(r,i,ev(e,n)),n.biff==8&&(e.Props||e.Custprops)&&DN(e,r),n.biff==8&&e.vbaraw&&ew(r,ze.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var ON={0:{f:GC},1:{f:JC},2:{f:pA},3:{f:nA},4:{f:QC},5:{f:cA},6:{f:yA},7:{f:oA},8:{f:AA},9:{f:CA},10:{f:SA},11:{f:wA},12:{f:YC},13:{f:gA},14:{f:iA},15:{f:eA},16:{f:dA},17:{f:TA},18:{f:lA},19:{f:gd},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:fN},40:{},42:{},43:{f:yS},44:{f:xS},45:{f:_S},46:{f:wS},47:{f:SS},48:{},49:{f:YT},50:{},51:{f:GS},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:X_},62:{f:vA},63:{f:WS},64:{f:HA},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Qn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:UA},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:WC},148:{f:$C,p:16},151:{f:FA},152:{},153:{f:uN},154:{},155:{},156:{f:aN},157:{},158:{},159:{T:1,f:aS},160:{T:-1},161:{T:1,f:Ei},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:NA},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:US},336:{T:-1},337:{f:$S,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ef},357:{},358:{},359:{},360:{T:1},361:{},362:{f:j_},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:MA},427:{f:bA},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:LA},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:jC},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:RA},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ef},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:XS},633:{T:1},634:{T:-1},635:{T:1,f:KS},636:{T:-1},637:{f:e_},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:tN},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:$A},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ue(e,t,n,r){var i=t;if(!isNaN(i)){var s=r||(n||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&hd(n)&&e.push(n)}}function UN(e,t,n,r){var i=(n||[]).length||0;if(i<=8224)return ue(e,t,n,i);var s=t;if(!isNaN(s)){for(var o=n.parts||[],a=0,l=0,u=0;u+(o[a]||8224)<=8224;)u+=o[a]||8224,a++;var c=e.next(4);for(c.write_shift(2,s),c.write_shift(2,u),e.push(n.slice(l,l+u)),l+=u;l<i;){for(c=e.next(4),c.write_shift(2,60),u=0;u+(o[a]||8224)<=8224;)u+=o[a]||8224,a++;c.write_shift(2,u),e.push(n.slice(l,l+u)),l+=u}}}function $o(e,t,n){return e||(e=Q(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function BN(e,t,n,r){var i=Q(9);return $o(i,e,t),C1(n,r||"b",i),i}function GN(e,t,n){var r=Q(8+2*n.length);return $o(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function VN(e,t,n,r){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Zt(zt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?ue(e,2,tS(n,r,i)):ue(e,3,eS(n,r,i));return;case"b":case"e":ue(e,5,BN(n,r,t.v,t.t));return;case"s":case"str":ue(e,4,GN(n,r,(t.v||"").slice(0,255)));return}ue(e,1,$o(null,n,r))}function HN(e,t,n,r){var i=Array.isArray(t),s=Qe(t["!ref"]||"A1"),o,a="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=ut(s)}for(var u=s.s.r;u<=s.e.r;++u){a=Nt(u);for(var c=s.s.c;c<=s.e.c;++c){u===s.s.r&&(l[c]=Dt(c)),o=l[c]+a;var p=i?(t[u]||[])[c]:t[o];p&&VN(e,p,u,c)}}}function $N(e,t){for(var n=t||{},r=Qt(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==n.sheet&&(i=s);if(i==0&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return ue(r,n.biff==4?1033:n.biff==3?521:9,yd(e,16,n)),HN(r,e.Sheets[e.SheetNames[i]],i,n),ue(r,10),r.end()}function zN(e,t,n){ue(e,49,O_({sz:12,name:"Arial"},n))}function jN(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&ue(e,1054,G_(i,t[i],n))})}function WN(e,t){var n=Q(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),ue(e,2151,n),n=Q(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),I1(Qe(t["!ref"]||"A1"),n),n.write_shift(4,4),ue(e,2152,n)}function qN(e,t){for(var n=0;n<16;++n)ue(e,224,Fh({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){ue(e,224,Fh(r,0,t))})}function JN(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];ue(e,440,J_(r)),r[1].Tooltip&&ue(e,2048,K_(r))}delete t["!links"]}function KN(e,t){if(t){var n=0;t.forEach(function(r,i){++n<=256&&r&&ue(e,125,Q_(iu(i,r),i))})}}function YN(e,t,n,r,i){var s=16+Kr(i.cellXfs,t,i);if(t.v==null&&!t.bf){ue(e,513,hi(n,r,s));return}if(t.bf)ue(e,6,EC(t,n,r,i,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?Zt(zt(t.v)):t.v;ue(e,515,z_(n,r,o,s));break;case"b":case"e":ue(e,517,$_(n,r,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var a=wd(i.Strings,t.v,i.revStrings);ue(e,253,U_(n,r,a,s))}else ue(e,516,B_(n,r,(t.v||"").slice(0,255),s,i));break;default:ue(e,513,hi(n,r,s))}}function XN(e,t,n){var r=Qt(),i=n.SheetNames[e],s=n.Sheets[i]||{},o=(n||{}).Workbook||{},a=(o.Sheets||[])[e]||{},l=Array.isArray(s),u=t.biff==8,c,p="",m=[],g=Qe(s["!ref"]||"A1"),y=u?65536:16384;if(g.e.c>255||g.e.r>=y){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,y-1)}ue(r,2057,yd(n,16,t)),ue(r,13,yn(1)),ue(r,12,yn(100)),ue(r,15,Ht(!0)),ue(r,17,Ht(!1)),ue(r,16,di(.001)),ue(r,95,Ht(!0)),ue(r,42,Ht(!1)),ue(r,43,Ht(!1)),ue(r,130,yn(1)),ue(r,128,H_()),ue(r,131,Ht(!1)),ue(r,132,Ht(!1)),u&&KN(r,s["!cols"]),ue(r,512,V_(g,t)),u&&(s["!links"]=[]);for(var x=g.s.r;x<=g.e.r;++x){p=Nt(x);for(var S=g.s.c;S<=g.e.c;++S){x===g.s.r&&(m[S]=Dt(S)),c=m[S]+p;var T=l?(s[x]||[])[S]:s[c];T&&(YN(r,T,x,S,t),u&&T.l&&s["!links"].push([c,T.l]))}}var E=a.CodeName||a.name||i;return u&&ue(r,574,L_((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&ue(r,229,q_(s["!merges"])),u&&JN(r,s),ue(r,442,N1(E)),u&&WN(r,s),ue(r,10),r.end()}function QN(e,t,n){var r=Qt(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=n.biff==8,l=n.biff==5;if(ue(r,2057,yd(e,5,n)),n.bookType=="xla"&&ue(r,135),ue(r,225,a?yn(1200):null),ue(r,193,S_(2)),l&&ue(r,191),l&&ue(r,192),ue(r,226),ue(r,92,F_("SheetJS",n)),ue(r,66,yn(a?1200:1252)),a&&ue(r,353,yn(0)),a&&ue(r,448),ue(r,317,Z_(e.SheetNames.length)),a&&e.vbaraw&&ue(r,211),a&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";ue(r,442,N1(u))}ue(r,156,yn(17)),ue(r,25,Ht(!1)),ue(r,18,Ht(!1)),ue(r,19,yn(0)),a&&ue(r,431,Ht(!1)),a&&ue(r,444,yn(0)),ue(r,61,D_()),ue(r,64,Ht(!1)),ue(r,141,yn(0)),ue(r,34,Ht(rN(e)=="true")),ue(r,14,Ht(!0)),a&&ue(r,439,Ht(!1)),ue(r,218,yn(0)),zN(r,e,n),jN(r,e.SSF,n),qN(r,n),a&&ue(r,352,Ht(!1));var c=r.end(),p=Qt();a&&ue(p,140,Y_()),a&&n.Strings&&UN(p,252,b_(n.Strings)),ue(p,10);var m=p.end(),g=Qt(),y=0,x=0;for(x=0;x<e.SheetNames.length;++x)y+=(a?12:11)+(a?2:1)*e.SheetNames[x].length;var S=c.length+y+m.length;for(x=0;x<e.SheetNames.length;++x){var T=s[x]||{};ue(g,133,M_({pos:S,hs:T.Hidden||0,dt:0,name:e.SheetNames[x]},n)),S+=t[x].length}var E=g.end();if(y!=E.length)throw new Error("BS8 "+y+" != "+E.length);var _=[];return c.length&&_.push(c),E.length&&_.push(E),m.length&&_.push(m),wt(_)}function ZN(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=en(st)),e&&e.SSF&&(Zl(),Ql(e.SSF),n.revssf=eu(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Cd(n),n.cellXfs=[],Kr(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)r[r.length]=XN(i,n,e);return r.unshift(QN(e,r,n)),wt(r)}function ev(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(!(!r||!r["!ref"])){var i=dn(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return ZN(e,t);case 4:case 3:case 2:return $N(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function eI(e,t,n,r){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var a=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>n||i[u].s.c>o)&&!(i[u].e.r<n||i[u].e.c<o)){if(i[u].s.r<n||i[u].s.c<o){a=-1;break}a=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(a<0)){var c=He({r:n,c:o}),p=r.dense?(e[n]||[])[o]:e[c],m=p&&p.v!=null&&(p.h||PT(p.w||(pr(p),p.w)||""))||"",g={};a>1&&(g.rowspan=a),l>1&&(g.colspan=l),r.editable?m='<span contenteditable="true">'+m+"</span>":p&&(g["data-t"]=p&&p.t||"z",p.v!=null&&(g["data-v"]=p.v),p.z!=null&&(g["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+p.l.Target+'">'+m+"</a>")),g.id=(r.id||"sjs")+"-"+c,s.push(le("td",m,g))}}var y="<tr>";return y+s.join("")+"</tr>"}var tI='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',nI="</body></html>";function rI(e,t,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function tv(e,t){var n=t||{},r=n.header!=null?n.header:tI,i=n.footer!=null?n.footer:nI,s=[r],o=dn(e["!ref"]);n.dense=Array.isArray(e),s.push(rI(e,o,n));for(var a=o.s.r;a<=o.e.r;++a)s.push(eI(e,o,a,n));return s.push("</table>"+i),s.join("")}function nv(e,t,n){var r=n||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var o=typeof r.origin=="string"?gt(r.origin):r.origin;i=o.r,s=o.c}var a=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,a.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var c=dn(e["!ref"]);u.s.r=Math.min(u.s.r,c.s.r),u.s.c=Math.min(u.s.c,c.s.c),u.e.r=Math.max(u.e.r,c.e.r),u.e.c=Math.max(u.e.c,c.e.c),i==-1&&(u.e.r=i=c.e.r+1)}var p=[],m=0,g=e["!rows"]||(e["!rows"]=[]),y=0,x=0,S=0,T=0,E=0,_=0;for(e["!cols"]||(e["!cols"]=[]);y<a.length&&x<l;++y){var N=a[y];if(Bh(N)){if(r.display)continue;g[x]={hidden:!0}}var B=N.children;for(S=T=0;S<B.length;++S){var G=B[S];if(!(r.display&&Bh(G))){var k=G.hasAttribute("data-v")?G.getAttribute("data-v"):G.hasAttribute("v")?G.getAttribute("v"):DT(G.innerHTML),D=G.getAttribute("data-z")||G.getAttribute("z");for(m=0;m<p.length;++m){var b=p[m];b.s.c==T+s&&b.s.r<x+i&&x+i<=b.e.r&&(T=b.e.c+1-s,m=-1)}_=+G.getAttribute("colspan")||1,((E=+G.getAttribute("rowspan")||1)>1||_>1)&&p.push({s:{r:x+i,c:T+s},e:{r:x+i+(E||1)-1,c:T+s+(_||1)-1}});var O={t:"s",v:k},J=G.getAttribute("data-t")||G.getAttribute("t")||"";k!=null&&(k.length==0?O.t=J||"z":r.raw||k.trim().length==0||J=="s"||(k==="TRUE"?O={t:"b",v:!0}:k==="FALSE"?O={t:"b",v:!1}:isNaN(ar(k))?isNaN(Io(k).getDate())||(O={t:"d",v:zt(k)},r.cellDates||(O={t:"n",v:Zt(O.v)}),O.z=r.dateNF||st[14]):O={t:"n",v:ar(k)})),O.z===void 0&&D!=null&&(O.z=D);var X="",re=G.getElementsByTagName("A");if(re&&re.length)for(var we=0;we<re.length&&!(re[we].hasAttribute("href")&&(X=re[we].getAttribute("href"),X.charAt(0)!="#"));++we);X&&X.charAt(0)!="#"&&(O.l={Target:X}),r.dense?(e[x+i]||(e[x+i]=[]),e[x+i][T+s]=O):e[He({c:T+s,r:x+i})]=O,u.e.c<T+s&&(u.e.c=T+s),T+=_}}++x}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),u.e.r=Math.max(u.e.r,x-1+i),e["!ref"]=ut(u),x>=l&&(e["!fullref"]=ut((u.e.r=a.length-y+x-1+i,u))),e}function rv(e,t){var n=t||{},r=n.dense?[]:{};return nv(r,e,t)}function iI(e,t){return gi(rv(e,t),t)}function Bh(e){var t="",n=sI(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function sI(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var oI=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Ro({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ct+t}}(),Gh=function(){var e=function(s){return Ge(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(s,o,a){var l=[];l.push('      <table:table table:name="'+Ge(o.SheetNames[a])+`" table:style-name="ta1">
`);var u=0,c=0,p=dn(s["!ref"]||"A1"),m=s["!merges"]||[],g=0,y=Array.isArray(s);if(s["!cols"])for(c=0;c<=p.e.c;++c)l.push("        <table:table-column"+(s["!cols"][c]?' table:style-name="co'+s["!cols"][c].ods+'"':"")+`></table:table-column>
`);var x="",S=s["!rows"]||[];for(u=0;u<p.s.r;++u)x=S[u]?' table:style-name="ro'+S[u].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=p.e.r;++u){for(x=S[u]?' table:style-name="ro'+S[u].ods+'"':"",l.push("        <table:table-row"+x+`>
`),c=0;c<p.s.c;++c)l.push(t);for(;c<=p.e.c;++c){var T=!1,E={},_="";for(g=0;g!=m.length;++g)if(!(m[g].s.c>c)&&!(m[g].s.r>u)&&!(m[g].e.c<c)&&!(m[g].e.r<u)){(m[g].s.c!=c||m[g].s.r!=u)&&(T=!0),E["table:number-columns-spanned"]=m[g].e.c-m[g].s.c+1,E["table:number-rows-spanned"]=m[g].e.r-m[g].s.r+1;break}if(T){l.push(n);continue}var N=He({r:u,c}),B=y?(s[u]||[])[c]:s[N];if(B&&B.f&&(E["table:formula"]=Ge(AC(B.f)),B.F&&B.F.slice(0,N.length)==N)){var G=dn(B.F);E["table:number-matrix-columns-spanned"]=G.e.c-G.s.c+1,E["table:number-matrix-rows-spanned"]=G.e.r-G.s.r+1}if(!B){l.push(t);continue}switch(B.t){case"b":_=B.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=B.v?"true":"false";break;case"n":_=B.w||String(B.v||0),E["office:value-type"]="float",E["office:value"]=B.v||0;break;case"s":case"str":_=B.v==null?"":B.v,E["office:value-type"]="string";break;case"d":_=B.w||zt(B.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=zt(B.v).toISOString(),E["table:style-name"]="ce1";break;default:l.push(t);continue}var k=e(_);if(B.l&&B.l.Target){var D=B.l.Target;D=D.charAt(0)=="#"?"#"+NC(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),k=le("text:a",k,{"xlink:href":D.replace(/&/g,"&amp;")})}l.push("          "+le("table:table-cell",le("text:p",k,{}),E)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var c=0;c<u["!cols"].length;++c)if(u["!cols"][c]){var p=u["!cols"][c];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Ed(p),p.ods=a;var m=u["!cols"][c].wpx+"px";s.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var c=0;c<u["!rows"].length;++c)if(u["!rows"][c]){u["!rows"][c].ods=l;var p=u["!rows"][c].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,a){var l=[ct],u=Ro({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=Ro({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+u+c+`>
`),l.push(v1().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var p=0;p!=o.SheetNames.length;++p)l.push(r(o.Sheets[o.SheetNames[p]],o,p));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function iv(e,t){if(t.bookType=="fods")return Gh(e,t);var n=ud(),r="",i=[],s=[];return r="mimetype",Ie(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",Ie(n,r,Gh(e,t)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",Ie(n,r,oI(e,t)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",Ie(n,r,ct+v1()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",Ie(n,r,v_(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",Ie(n,r,g_(i)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function kl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function aI(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):On(ko(e))}function lI(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}function jr(e){var t=e.reduce(function(i,s){return i+s.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(i){n.set(i,r),r+=i.length}),n}function uI(e,t,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=n>=0?0:128}function Po(e,t){var n=t?t[0]:0,r=e[n]&127;e:if(e[n++]>=128&&(r|=(e[n]&127)<<7,e[n++]<128||(r|=(e[n]&127)<<14,e[n++]<128)||(r|=(e[n]&127)<<21,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),r}function Ue(e){var t=new Uint8Array(7);t[0]=e&127;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383||(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)||(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)||(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)||(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103))break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function ts(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function ft(e){for(var t=[],n=[0];n[0]<e.length;){var r=n[0],i=Po(e,n),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=n[0];e[n[0]++]>=128;);a=e.slice(l,n[0])}break;case 5:o=4,a=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,a=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=Po(e,n),a=e.slice(n[0],n[0]+o),n[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var u={data:a,type:s};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function Tt(e){var t=[];return e.forEach(function(n,r){n.forEach(function(i){i.data&&(t.push(Ue(r*8+i.type)),i.type==2&&t.push(Ue(i.data.length)),t.push(i.data))})}),jr(t)}function Fn(e){for(var t,n=[],r=[0];r[0]<e.length;){var i=Po(e,r),s=ft(e.slice(r[0],r[0]+i));r[0]+=i;var o={id:ts(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=ft(a.data),u=ts(l[3][0].data);o.messages.push({meta:l,data:e.slice(r[0],r[0]+u)}),r[0]+=u}),(t=s[3])!=null&&t[0]&&(o.merge=ts(s[3][0].data)>>>0>0),n.push(o)}return n}function Ci(e){var t=[];return e.forEach(function(n){var r=[];r[1]=[{data:Ue(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:Ue(+!!n.merge),type:0}]);var i=[];n.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Ue(o.data.length)}],r[2].push({data:Tt(o.meta),type:2})});var s=Tt(r);t.push(Ue(s.length)),t.push(s),i.forEach(function(o){return t.push(o)})}),jr(t)}function cI(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=Po(t,n),i=[];n[0]<t.length;){var s=t[n[0]]&3;if(s==0){var o=t[n[0]++]>>2;if(o<60)++o;else{var a=o-59;o=t[n[0]],a>1&&(o|=t[n[0]+1]<<8),a>2&&(o|=t[n[0]+2]<<16),a>3&&(o|=t[n[0]+3]<<24),o>>>=0,o++,n[0]+=a}i.push(t.slice(n[0],n[0]+o)),n[0]+=o;continue}else{var l=0,u=0;if(s==1?(u=(t[n[0]]>>2&7)+4,l=(t[n[0]++]&224)<<3,l|=t[n[0]++]):(u=(t[n[0]++]>>2)+1,s==2?(l=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(l=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),i=[jr(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var c=jr(i);if(c.length!=r)throw new Error("Unexpected length: ".concat(c.length," != ").concat(r));return c}function Mn(e){for(var t=[],n=0;n<e.length;){var r=e[n++],i=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(cI(r,e.slice(n,n+i))),n+=i}if(n!==e.length)throw new Error("data is not a valid framed stream!");return jr(t)}function Ai(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),i=new Uint8Array(4);t.push(i);var s=Ue(r),o=s.length;t.push(s),r<=60?(o++,t.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),o+=r,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,n+=r}return jr(t)}function Qu(e,t){var n=new Uint8Array(32),r=kl(n),i=12,s=0;switch(n[0]=5,e.t){case"n":n[1]=2,uI(n,i,e.v),s|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,s,!0),n.slice(0,i)}function Zu(e,t){var n=new Uint8Array(32),r=kl(n),i=12,s=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,s,!0),n.slice(0,i)}function wr(e){var t=ft(e);return Po(t[1][0].data)}function fI(e,t,n){var r,i,s,o;if(!((r=e[6])!=null&&r[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&ts(e[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,u=kl(e[7][0].data),c=0,p=[],m=kl(e[4][0].data),g=0,y=[],x=0;x<t.length;++x){if(t[x]==null){u.setUint16(x*2,65535,!0),m.setUint16(x*2,65535);continue}u.setUint16(x*2,c,!0),m.setUint16(x*2,g,!0);var S,T;switch(typeof t[x]){case"string":S=Qu({t:"s",v:t[x]},n),T=Zu({t:"s",v:t[x]},n);break;case"number":S=Qu({t:"n",v:t[x]},n),T=Zu({t:"n",v:t[x]},n);break;case"boolean":S=Qu({t:"b",v:t[x]},n),T=Zu({t:"b",v:t[x]},n);break;default:throw new Error("Unsupported value "+t[x])}p.push(S),c+=S.length,y.push(T),g+=T.length,++l}for(e[2][0].data=Ue(l);x<e[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),m.setUint16(x*2,65535,!0);return e[6][0].data=jr(p),e[3][0].data=jr(y),l}function dI(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=dn(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ut(r)));var s=Rl(n,{range:r,header:1}),o=["~Sh33tJ5~"];s.forEach(function(W){return W.forEach(function(H){typeof H=="string"&&o.push(H)})});var a={},l=[],u=ze.read(t.numbers,{type:"base64"});u.FileIndex.map(function(W,H){return[W,u.FullPaths[H]]}).forEach(function(W){var H=W[0],V=W[1];if(H.type==2&&H.name.match(/\.iwa/)){var ne=H.content,ce=Mn(ne),Ee=Fn(ce);Ee.forEach(function(ve){l.push(ve.id),a[ve.id]={deps:[],location:V,type:ts(ve.messages[0].meta[1][0].data)}})}}),l.sort(function(W,H){return W-H});var c=l.filter(function(W){return W>1}).map(function(W){return[W,Ue(W)]});u.FileIndex.map(function(W,H){return[W,u.FullPaths[H]]}).forEach(function(W){var H=W[0];if(W[1],!!H.name.match(/\.iwa/)){var V=Fn(Mn(H.content));V.forEach(function(ne){ne.messages.forEach(function(ce){c.forEach(function(Ee){ne.messages.some(function(ve){return ts(ve.meta[1][0].data)!=11006&&lI(ve.data,Ee[1])})&&a[Ee[0]].deps.push(ne.id)})})})}});for(var p=ze.find(u,a[1].location),m=Fn(Mn(p.content)),g,y=0;y<m.length;++y){var x=m[y];x.id==1&&(g=x)}var S=wr(ft(g.messages[0].data)[1][0].data);for(p=ze.find(u,a[S].location),m=Fn(Mn(p.content)),y=0;y<m.length;++y)x=m[y],x.id==S&&(g=x);for(S=wr(ft(g.messages[0].data)[2][0].data),p=ze.find(u,a[S].location),m=Fn(Mn(p.content)),y=0;y<m.length;++y)x=m[y],x.id==S&&(g=x);for(S=wr(ft(g.messages[0].data)[2][0].data),p=ze.find(u,a[S].location),m=Fn(Mn(p.content)),y=0;y<m.length;++y)x=m[y],x.id==S&&(g=x);var T=ft(g.messages[0].data);{T[6][0].data=Ue(r.e.r+1),T[7][0].data=Ue(r.e.c+1);var E=wr(T[46][0].data),_=ze.find(u,a[E].location),N=Fn(Mn(_.content));{for(var B=0;B<N.length&&N[B].id!=E;++B);if(N[B].id!=E)throw"Bad ColumnRowUIDMapArchive";var G=ft(N[B].messages[0].data);G[1]=[],G[2]=[],G[3]=[];for(var k=0;k<=r.e.c;++k){var D=[];D[1]=D[2]=[{type:0,data:Ue(k+420690)}],G[1].push({type:2,data:Tt(D)}),G[2].push({type:0,data:Ue(k)}),G[3].push({type:0,data:Ue(k)})}G[4]=[],G[5]=[],G[6]=[];for(var b=0;b<=r.e.r;++b)D=[],D[1]=D[2]=[{type:0,data:Ue(b+726270)}],G[4].push({type:2,data:Tt(D)}),G[5].push({type:0,data:Ue(b)}),G[6].push({type:0,data:Ue(b)});N[B].messages[0].data=Tt(G)}_.content=Ai(Ci(N)),_.size=_.content.length,delete T[46];var O=ft(T[4][0].data);{O[7][0].data=Ue(r.e.r+1);var J=ft(O[1][0].data),X=wr(J[2][0].data);_=ze.find(u,a[X].location),N=Fn(Mn(_.content));{if(N[0].id!=X)throw"Bad HeaderStorageBucket";var re=ft(N[0].messages[0].data);for(b=0;b<s.length;++b){var we=ft(re[2][0].data);we[1][0].data=Ue(b),we[4][0].data=Ue(s[b].length),re[2][b]={type:re[2][0].type,data:Tt(we)}}N[0].messages[0].data=Tt(re)}_.content=Ai(Ci(N)),_.size=_.content.length;var _e=wr(O[2][0].data);_=ze.find(u,a[_e].location),N=Fn(Mn(_.content));{if(N[0].id!=_e)throw"Bad HeaderStorageBucket";for(re=ft(N[0].messages[0].data),k=0;k<=r.e.c;++k)we=ft(re[2][0].data),we[1][0].data=Ue(k),we[4][0].data=Ue(r.e.r+1),re[2][k]={type:re[2][0].type,data:Tt(we)};N[0].messages[0].data=Tt(re)}_.content=Ai(Ci(N)),_.size=_.content.length;var Ne=wr(O[4][0].data);(function(){for(var W=ze.find(u,a[Ne].location),H=Fn(Mn(W.content)),V,ne=0;ne<H.length;++ne){var ce=H[ne];ce.id==Ne&&(V=ce)}var Ee=ft(V.messages[0].data);{Ee[3]=[];var ve=[];o.forEach(function(ke,yt){ve[1]=[{type:0,data:Ue(yt)}],ve[2]=[{type:0,data:Ue(1)}],ve[3]=[{type:2,data:aI(ke)}],Ee[3].push({type:2,data:Tt(ve)})})}V.messages[0].data=Tt(Ee);var fe=Ci(H),Pe=Ai(fe);W.content=Pe,W.size=W.content.length})();var ge=ft(O[3][0].data);{var ae=ge[1][0];delete ge[2];var z=ft(ae.data);{var se=wr(z[2][0].data);(function(){for(var W=ze.find(u,a[se].location),H=Fn(Mn(W.content)),V,ne=0;ne<H.length;++ne){var ce=H[ne];ce.id==se&&(V=ce)}var Ee=ft(V.messages[0].data);{delete Ee[6],delete ge[7];var ve=new Uint8Array(Ee[5][0].data);Ee[5]=[];for(var fe=0,Pe=0;Pe<=r.e.r;++Pe){var ke=ft(ve);fe+=fI(ke,s[Pe],o),ke[1][0].data=Ue(Pe),Ee[5].push({data:Tt(ke),type:2})}Ee[1]=[{type:0,data:Ue(r.e.c+1)}],Ee[2]=[{type:0,data:Ue(r.e.r+1)}],Ee[3]=[{type:0,data:Ue(fe)}],Ee[4]=[{type:0,data:Ue(r.e.r+1)}]}V.messages[0].data=Tt(Ee);var yt=Ci(H),Me=Ai(yt);W.content=Me,W.size=W.content.length})()}ae.data=Tt(z)}O[3][0].data=Tt(ge)}T[4][0].data=Tt(O)}g.messages[0].data=Tt(T);var ye=Ci(m),L=Ai(ye);return p.content=L,p.size=p.content.length,u}function hI(e){return function(n){for(var r=0;r!=e.length;++r){var i=e[r];n[i[0]]===void 0&&(n[i[0]]=i[1]),i[2]==="n"&&(n[i[0]]=Number(n[i[0]]))}}}function Cd(e){hI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function pI(e,t){return t.bookType=="ods"?iv(e,t):t.bookType=="numbers"?dI(e,t):t.bookType=="xlsb"?mI(e,t):gI(e,t)}function mI(e,t){Hi=1024,e&&!e.SSF&&(e.SSF=en(st)),e&&e.SSF&&(Zl(),Ql(e.SSF),t.revssf=eu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,oo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n=t.bookType=="xlsb"?"bin":"xml",r=G1.indexOf(t.bookType)>-1,i=m1();Cd(t=t||{});var s=ud(),o="",a=0;if(t.cellXfs=[],Kr(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ie(s,o,y1(e.Props,t)),i.coreprops.push(o),Be(t.rels,2,o,be.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Ie(s,o,T1(e.Props)),i.extprops.push(o),Be(t.rels,3,o,be.EXT_PROPS),e.Custprops!==e.Props&&kt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ie(s,o,_1(e.Custprops)),i.custprops.push(o),Be(t.rels,4,o,be.CUST_PROPS)),a=1;a<=e.SheetNames.length;++a){var c={"!id":{}},p=e.Sheets[e.SheetNames[a-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+a+"."+n,Ie(s,o,vN(a-1,o,t,e,c)),i.sheets.push(o),Be(t.wbrels,-1,"worksheets/sheet"+a+"."+n,be.WS[0])}if(p){var g=p["!comments"],y=!1,x="";g&&g.length>0&&(x="xl/comments"+a+"."+n,Ie(s,x,TN(g,x)),i.comments.push(x),Be(c,-1,"../comments"+a+"."+n,be.CMNT),y=!0),p["!legacy"]&&y&&Ie(s,"xl/drawings/vmlDrawing"+a+".vml",U1(a,p["!comments"])),delete p["!comments"],delete p["!legacy"]}c["!id"].rId1&&Ie(s,x1(o),Zi(c))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,Ie(s,o,EN(t.Strings,o,t)),i.strs.push(o),Be(t.wbrels,-1,"sharedStrings."+n,be.SST)),o="xl/workbook."+n,Ie(s,o,xN(e,o)),i.workbooks.push(o),Be(t.rels,1,o,be.WB),o="xl/theme/theme1.xml",Ie(s,o,L1(e.Themes,t)),i.themes.push(o),Be(t.wbrels,-1,"theme/theme1.xml",be.THEME),o="xl/styles."+n,Ie(s,o,yN(e,o,t)),i.styles.push(o),Be(t.wbrels,-1,"styles."+n,be.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",Ie(s,o,e.vbaraw),i.vba.push(o),Be(t.wbrels,-1,"vbaProject.bin",be.VBA)),o="xl/metadata."+n,Ie(s,o,_N(o)),i.metadata.push(o),Be(t.wbrels,-1,"metadata."+n,be.XLMETA),Ie(s,"[Content_Types].xml",g1(i,t)),Ie(s,"_rels/.rels",Zi(t.rels)),Ie(s,"xl/_rels/workbook."+n+".rels",Zi(t.wbrels)),delete t.revssf,delete t.ssf,s}function gI(e,t){Hi=1024,e&&!e.SSF&&(e.SSF=en(st)),e&&e.SSF&&(Zl(),Ql(e.SSF),t.revssf=eu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,oo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=G1.indexOf(t.bookType)>-1,i=m1();Cd(t=t||{});var s=ud(),o="",a=0;if(t.cellXfs=[],Kr(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ie(s,o,y1(e.Props,t)),i.coreprops.push(o),Be(t.rels,2,o,be.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Ie(s,o,T1(e.Props)),i.extprops.push(o),Be(t.rels,3,o,be.EXT_PROPS),e.Custprops!==e.Props&&kt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ie(s,o,_1(e.Custprops)),i.custprops.push(o),Be(t.rels,4,o,be.CUST_PROPS));var c=["SheetJ5"];for(t.tcid=0,a=1;a<=e.SheetNames.length;++a){var p={"!id":{}},m=e.Sheets[e.SheetNames[a-1]],g=(m||{})["!type"]||"sheet";switch(g){case"chart":default:o="xl/worksheets/sheet"+a+"."+n,Ie(s,o,K1(a-1,t,e,p)),i.sheets.push(o),Be(t.wbrels,-1,"worksheets/sheet"+a+"."+n,be.WS[0])}if(m){var y=m["!comments"],x=!1,S="";if(y&&y.length>0){var T=!1;y.forEach(function(E){E[1].forEach(function(_){_.T==!0&&(T=!0)})}),T&&(S="xl/threadedComments/threadedComment"+a+"."+n,Ie(s,S,qS(y,c,t)),i.threadedcomments.push(S),Be(p,-1,"../threadedComments/threadedComment"+a+"."+n,be.TCMNT)),S="xl/comments"+a+"."+n,Ie(s,S,B1(y)),i.comments.push(S),Be(p,-1,"../comments"+a+"."+n,be.CMNT),x=!0}m["!legacy"]&&x&&Ie(s,"xl/drawings/vmlDrawing"+a+".vml",U1(a,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&Ie(s,x1(o),Zi(p))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,Ie(s,o,R1(t.Strings,t)),i.strs.push(o),Be(t.wbrels,-1,"sharedStrings."+n,be.SST)),o="xl/workbook."+n,Ie(s,o,Q1(e)),i.workbooks.push(o),Be(t.rels,1,o,be.WB),o="xl/theme/theme1.xml",Ie(s,o,L1(e.Themes,t)),i.themes.push(o),Be(t.wbrels,-1,"theme/theme1.xml",be.THEME),o="xl/styles."+n,Ie(s,o,b1(e,t)),i.styles.push(o),Be(t.wbrels,-1,"styles."+n,be.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",Ie(s,o,e.vbaraw),i.vba.push(o),Be(t.wbrels,-1,"vbaProject.bin",be.VBA)),o="xl/metadata."+n,Ie(s,o,O1()),i.metadata.push(o),Be(t.wbrels,-1,"metadata."+n,be.XLMETA),c.length>1&&(o="xl/persons/person.xml",Ie(s,o,JS(c)),i.people.push(o),Be(t.wbrels,-1,"persons/person.xml",be.PEOPLE)),Ie(s,"[Content_Types].xml",g1(i,t)),Ie(s,"_rels/.rels",Zi(t.rels)),Ie(s,"xl/_rels/workbook."+n+".rels",Zi(t.wbrels)),delete t.revssf,delete t.ssf,s}function xI(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=hr(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function sv(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Bo(t.file,ze.write(e,{type:Oe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return ze.write(e,t)}function vI(e,t){var n=en(t||{}),r=pI(e,n);return yI(r,n)}function yI(e,t){var n={},r=Oe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?ze.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Xl(i))}return t.password&&typeof encrypt_agile<"u"?sv(encrypt_agile(i,t.password),t):t.type==="file"?Bo(t.file,i):t.type=="string"?no(i):i}function EI(e,t){var n=t||{},r=LN(e,n);return sv(r,n)}function qn(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return No(ko(r));case"binary":return ko(r);case"string":return e;case"file":return Bo(t.file,r,"utf8");case"buffer":return Oe?xr(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):qn(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function TI(e,t){switch(t.type){case"base64":return No(e);case"binary":return e;case"string":return e;case"file":return Bo(t.file,e,"binary");case"buffer":return Oe?xr(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function wa(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return t.type=="base64"?No(n):t.type=="string"?no(n):n;case"file":return Bo(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function ov(e,t){KE(),oN(e);var n=en(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=ov(e,n);return n.type="array",Xl(r)}var i=0;if(n.sheet&&(typeof n.sheet=="number"?i=n.sheet:i=e.SheetNames.indexOf(n.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return qn(bN(e,n),n);case"slk":case"sylk":return qn(rS.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"htm":case"html":return qn(tv(e.Sheets[e.SheetNames[i]],n),n);case"txt":return TI(lv(e.Sheets[e.SheetNames[i]],n),n);case"csv":return qn(Ad(e.Sheets[e.SheetNames[i]],n),n,"\uFEFF");case"dif":return qn(iS.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"dbf":return wa(nS.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"prn":return qn(sS.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"rtf":return qn(dS.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"eth":return qn(k1.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"fods":return qn(iv(e,n),n);case"wk1":return wa(Mh.sheet_to_wk1(e.Sheets[e.SheetNames[i]],n),n);case"wk3":return wa(Mh.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),wa(ev(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),EI(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return vI(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function _I(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(e.bookType=n.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function av(e,t,n){var r={};return r.type="file",r.file=t,_I(r),ov(e,r)}function SI(e,t,n,r,i,s,o,a){var l=Nt(n),u=a.defval,c=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),p=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:n,enumerable:!1})}catch{m.__rowNum__=n}else m.__rowNum__=n;if(!o||e[n])for(var g=t.s.c;g<=t.e.c;++g){var y=o?e[n][g]:e[r[g]+l];if(y===void 0||y.t===void 0){if(u===void 0)continue;s[g]!=null&&(m[s[g]]=u);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[g]!=null){if(x==null)if(y.t=="e"&&x===null)m[s[g]]=null;else if(u!==void 0)m[s[g]]=u;else if(c&&x===null)m[s[g]]=null;else continue;else m[s[g]]=c&&(y.t!=="n"||y.t==="n"&&a.rawNumbers!==!1)?x:pr(y,x,a);x!=null&&(p=!1)}}return{row:m,isempty:p}}function Rl(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},r=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},c=u.range!=null?u.range:e["!ref"];switch(u.header===1?r=1:u.header==="A"?r=2:Array.isArray(u.header)?r=3:u.header==null&&(r=0),typeof c){case"string":l=Qe(c);break;case"number":l=Qe(e["!ref"]),l.s.r=c;break;default:l=c}r>0&&(i=0);var p=Nt(l.s.r),m=[],g=[],y=0,x=0,S=Array.isArray(e),T=l.s.r,E=0,_={};S&&!e[T]&&(e[T]=[]);var N=u.skipHidden&&e["!cols"]||[],B=u.skipHidden&&e["!rows"]||[];for(E=l.s.c;E<=l.e.c;++E)if(!(N[E]||{}).hidden)switch(m[E]=Dt(E),n=S?e[T][E]:e[m[E]+p],r){case 1:s[E]=E-l.s.c;break;case 2:s[E]=m[E];break;case 3:s[E]=u.header[E-l.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),a=o=pr(n,null,u),x=_[o]||0,!x)_[o]=1;else{do a=o+"_"+x++;while(_[a]);_[o]=x,_[a]=1}s[E]=a}for(T=l.s.r+i;T<=l.e.r;++T)if(!(B[T]||{}).hidden){var G=SI(e,l,T,m,r,s,S,u);(G.isempty===!1||(r===1?u.blankrows!==!1:u.blankrows))&&(g[y++]=G.row)}return g.length=y,g}var Vh=/"/g;function wI(e,t,n,r,i,s,o,a){for(var l=!0,u=[],c="",p=Nt(n),m=t.s.c;m<=t.e.c;++m)if(r[m]){var g=a.dense?(e[n]||[])[m]:e[r[m]+p];if(g==null)c="";else if(g.v!=null){l=!1,c=""+(a.rawNumbers&&g.t=="n"?g.v:pr(g,null,a));for(var y=0,x=0;y!==c.length;++y)if((x=c.charCodeAt(y))===i||x===s||x===34||a.forceQuotes){c='"'+c.replace(Vh,'""')+'"';break}c=="ID"&&(c='"ID"')}else g.f!=null&&!g.F?(l=!1,c="="+g.f,c.indexOf(",")>=0&&(c='"'+c.replace(Vh,'""')+'"')):c="";u.push(c)}return a.blankrows===!1&&l?null:u.join(o)}function Ad(e,t){var n=[],r=t??{};if(e==null||e["!ref"]==null)return"";var i=Qe(e["!ref"]),s=r.FS!==void 0?r.FS:",",o=s.charCodeAt(0),a=r.RS!==void 0?r.RS:`
`,l=a.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),c="",p=[];r.dense=Array.isArray(e);for(var m=r.skipHidden&&e["!cols"]||[],g=r.skipHidden&&e["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(m[y]||{}).hidden||(p[y]=Dt(y));for(var x=0,S=i.s.r;S<=i.e.r;++S)(g[S]||{}).hidden||(c=wI(e,i,S,p,o,l,s,r),c!=null&&(r.strip&&(c=c.replace(u,"")),(c||r.blankrows!==!1)&&n.push((x++?a:"")+c)));return delete r.dense,n.join("")}function lv(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=Ad(e,t);return n}function CI(e){var t="",n,r="";if(e==null||e["!ref"]==null)return[];var i=Qe(e["!ref"]),s="",o=[],a,l=[],u=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)o[a]=Dt(a);for(var c=i.s.r;c<=i.e.r;++c)for(s=Nt(c),a=i.s.c;a<=i.e.c;++a)if(t=o[a]+s,n=u?(e[c]||[])[a]:e[t],r="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;r=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}l[l.length]=t+"="+r}return l}function uv(e,t,n){var r=n||{},i=+!r.skipHeader,s=e||{},o=0,a=0;if(s&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?gt(r.origin):r.origin;o=l.r,a=l.c}var u,c={s:{c:0,r:0},e:{c:a,r:o+t.length-1+i}};if(s["!ref"]){var p=Qe(s["!ref"]);c.e.c=Math.max(c.e.c,p.e.c),c.e.r=Math.max(c.e.r,p.e.r),o==-1&&(o=p.e.r+1,c.e.r=o+t.length-1+i)}else o==-1&&(o=0,c.e.r=t.length-1+i);var m=r.header||[],g=0;t.forEach(function(x,S){kt(x).forEach(function(T){(g=m.indexOf(T))==-1&&(m[g=m.length]=T);var E=x[T],_="z",N="",B=He({c:a+g,r:o+S+i});u=Fo(s,B),E&&typeof E=="object"&&!(E instanceof Date)?s[B]=E:(typeof E=="number"?_="n":typeof E=="boolean"?_="b":typeof E=="string"?_="s":E instanceof Date?(_="d",r.cellDates||(_="n",E=Zt(E)),N=r.dateNF||st[14]):E===null&&r.nullError&&(_="e",E=0),u?(u.t=_,u.v=E,delete u.w,delete u.R,N&&(u.z=N)):s[B]=u={t:_,v:E},N&&(u.z=N))})}),c.e.c=Math.max(c.e.c,a+m.length-1);var y=Nt(o);if(i)for(g=0;g<m.length;++g)s[Dt(g+a)+y]={t:"s",v:m[g]};return s["!ref"]=ut(c),s}function AI(e,t){return uv(null,e,t)}function Fo(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var r=gt(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Fo(e,He(t)):Fo(e,He({r:t,c:n||0}))}function NI(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function II(){return{SheetNames:[],Sheets:{}}}function kI(e,t,n,r){var i=1;if(!n)for(;i<=65535&&e.SheetNames.indexOf(n="Sheet"+i)!=-1;++i,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||n;for(++i;i<=65535&&e.SheetNames.indexOf(n=o+i)!=-1;++i);}if(X1(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function RI(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=NI(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n}function PI(e,t){return e.z=t,e}function cv(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function FI(e,t,n){return cv(e,"#"+t,n)}function MI(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function bI(e,t,n,r){for(var i=typeof t!="string"?t:Qe(t),s=typeof t=="string"?t:ut(t),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=Fo(e,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=n,r&&(l.D=!0))}return e}var vn={encode_col:Dt,encode_row:Nt,encode_cell:He,encode_range:ut,decode_col:md,decode_row:pd,split_cell:KT,decode_cell:gt,decode_range:dn,format_cell:pr,sheet_add_aoa:u1,sheet_add_json:uv,sheet_add_dom:nv,aoa_to_sheet:xs,json_to_sheet:AI,table_to_sheet:rv,table_to_book:iI,sheet_to_csv:Ad,sheet_to_txt:lv,sheet_to_json:Rl,sheet_to_html:tv,sheet_to_formulae:CI,sheet_to_row_object_array:Rl,sheet_get_cell:Fo,book_new:II,book_append_sheet:kI,book_set_sheet_visibility:RI,cell_set_number_format:PI,cell_set_hyperlink:cv,cell_set_internal_link:FI,cell_add_comment:MI,sheet_set_array_formula:bI,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const DI=(e,t)=>{const n=JSON.stringify(e);return`<!DOCTYPE html>
<html lang="${t}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${e.name} - NOZESia Key</title>
  <script src="https://cdn.tailwindcss.com"><\/script>
  <style>
    .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
  </style>
</head>
<body class="bg-slate-100 font-sans">
  <div id="app"></div>
  <script>
    const project = ${n};
    const lang = "${t}";
    const t = {
      en: {
        features: "Features", selected: "selected", matches: "Matches", discarded: "Discarded",
        restart: "Restart", noMatches: "No matches found.", tryUnselecting: "Try unselecting some features.",
        potential: "potential matches", identified: "1 Entity identified", close: "Close",
        speciesDetails: "Species Details", morphology: "Morphology & Traits", resources: "Resources",
        createdWith: "Created with NOZESia", viewResults: "View Results", excluded: "Excluded by selection"
      },
      pt: {
        features: "Caractersticas", selected: "selecionado(s)", matches: "Compatveis", discarded: "Descartados",
        restart: "Reiniciar", noMatches: "Nenhum resultado.", tryUnselecting: "Tente remover selees.",
        potential: "matches potenciais", identified: "1 Entidade identificada", close: "Fechar",
        speciesDetails: "Detalhes da Espcie", morphology: "Morfologia & Caractersticas", resources: "Recursos Adicionais",
        createdWith: "Criado com NOZESia", viewResults: "Ver Resultados", excluded: "Excludo pela seleo"
      }
    };
    const strings = t[lang];
    
    let selections = {};
    let showDiscarded = false;
    let viewingEntity = null;
    let mobileTab = 'FILTERS';
    
    function toggleSelection(featureId, stateId) {
      if (!selections[featureId]) selections[featureId] = [];
      const idx = selections[featureId].indexOf(stateId);
      if (idx >= 0) {
        selections[featureId].splice(idx, 1);
        if (selections[featureId].length === 0) delete selections[featureId];
      } else {
        selections[featureId].push(stateId);
      }
      render();
    }
    
    function resetKey() { selections = {}; render(); }
    function setMobileTab(tab) { mobileTab = tab; render(); }
    function toggleDiscarded() { showDiscarded = !showDiscarded; render(); }
    function viewEntity(entity) { viewingEntity = entity; render(); }
    function closeEntity() { viewingEntity = null; render(); }
    
    function getFilteredEntities() {
      const remaining = [], discarded = [];
      project.entities.forEach(entity => {
        let isMatch = true;
        for (const [fid, sids] of Object.entries(selections)) {
          const entityStates = entity.traits[fid] || [];
          if (!sids.some(id => entityStates.includes(id))) { isMatch = false; break; }
        }
        if (isMatch) remaining.push(entity); else discarded.push(entity);
      });
      return { remaining, discarded };
    }
    
    function getTotalSelections() {
      return Object.values(selections).reduce((a, c) => a + c.length, 0);
    }
    
    function render() {
      const { remaining, discarded } = getFilteredEntities();
      const totalSel = getTotalSelections();
      
      let entityModalHTML = '';
      if (viewingEntity) {
        const e = viewingEntity;
        const traitsHTML = project.features.map(f => {
          const stateIds = e.traits[f.id] || [];
          const stateLabels = stateIds.map(sid => f.states.find(s => s.id === sid)?.label).filter(Boolean).join(', ');
          return stateLabels ? \`<div class="flex justify-between py-2 border-b border-slate-100"><span class="text-slate-500">\${f.name}</span><span class="font-medium text-slate-800">\${stateLabels}</span></div>\` : '';
        }).join('');
        const linksHTML = e.links && e.links.length > 0 ? \`<div class="mt-6"><h4 class="font-semibold text-slate-700 mb-3">\${strings.resources}</h4><div class="space-y-2">\${e.links.map(l => \`<a href="\${l.url}" target="_blank" class="flex items-center gap-2 text-emerald-600 hover:underline text-sm"><span></span>\${l.label}</a>\`).join('')}</div></div>\` : '';
        entityModalHTML = \`
          <div class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4" onclick="if(event.target===this)closeEntity()">
            <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col">
              <div class="relative h-48 sm:h-64 bg-slate-200 shrink-0">
                \${e.imageUrl ? \`<img src="\${e.imageUrl}" class="w-full h-full object-cover" onerror="this.style.display='none'">\` : '<div class="w-full h-full flex items-center justify-center text-slate-400 text-6xl"></div>'}
                <button onclick="closeEntity()" class="absolute top-3 right-3 bg-black/40 hover:bg-black/60 text-white rounded-full p-2"></button>
              </div>
              <div class="p-6 overflow-y-auto custom-scrollbar">
                <h2 class="text-2xl font-bold text-slate-800 mb-1">\${e.name}</h2>
                \${e.description ? \`<p class="text-slate-600 mb-4">\${e.description}</p>\` : ''}
                <div class="mt-4"><h4 class="font-semibold text-slate-700 mb-2">\${strings.morphology}</h4><div class="text-sm">\${traitsHTML}</div></div>
                \${linksHTML}
              </div>
            </div>
          </div>
        \`;
      }
      
      const featuresHTML = project.features.map(f => {
        const selStates = selections[f.id] || [];
        return \`
          <div class="bg-slate-50 rounded-xl p-4">
            <h4 class="font-semibold text-slate-700 mb-3 flex items-center gap-2">
              \${f.imageUrl ? \`<img src="\${f.imageUrl}" class="w-6 h-6 rounded object-cover">\` : ''}
              \${f.name}
              \${selStates.length > 0 ? \`<span class="ml-auto text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full">\${selStates.length}</span>\` : ''}
            </h4>
            <div class="flex flex-wrap gap-2">
              \${f.states.map(s => {
                const isSel = selStates.includes(s.id);
                return \`<button onclick="toggleSelection('\${f.id}','\${s.id}')" class="px-3 py-1.5 rounded-lg text-sm font-medium transition-all \${isSel ? 'bg-emerald-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-100 border border-slate-200'}">\${s.label}</button>\`;
              }).join('')}
            </div>
          </div>
        \`;
      }).join('');
      
      const entityCard = (e, isDiscarded = false) => \`
        <div onclick="viewEntity(project.entities.find(x=>x.id==='\${e.id}'))" class="bg-white rounded-xl shadow-sm hover:shadow-lg transition-all cursor-pointer overflow-hidden border \${isDiscarded ? 'border-red-200 opacity-60' : 'border-slate-200 hover:border-emerald-300'}">
          <div class="h-32 bg-slate-100 relative">
            \${e.imageUrl ? \`<img src="\${e.imageUrl}" class="w-full h-full object-cover" onerror="this.parentElement.innerHTML='<div class=\\\\'w-full h-full flex items-center justify-center text-slate-300 text-4xl\\\\'></div>'">\` : '<div class="w-full h-full flex items-center justify-center text-slate-300 text-4xl"></div>'}
            \${isDiscarded ? '<div class="absolute inset-0 bg-red-500/20 flex items-center justify-center"><span class="bg-red-500 text-white text-xs px-2 py-1 rounded"></span></div>' : ''}
          </div>
          <div class="p-3">
            <h4 class="font-semibold text-slate-800 text-sm truncate">\${e.name}</h4>
            \${e.description ? \`<p class="text-xs text-slate-500 mt-1 line-clamp-2">\${e.description}</p>\` : ''}
          </div>
        </div>
      \`;
      
      const remainingHTML = remaining.length > 0 
        ? remaining.map(e => entityCard(e)).join('')
        : \`<div class="col-span-full text-center py-12 text-slate-500"><div class="text-4xl mb-3"></div><p class="font-medium">\${strings.noMatches}</p><p class="text-sm">\${strings.tryUnselecting}</p></div>\`;
      
      const discardedHTML = discarded.length > 0 && showDiscarded
        ? \`<div class="mt-6 pt-6 border-t"><h4 class="font-semibold text-slate-500 mb-4 flex items-center gap-2"> \${strings.discarded} (\${discarded.length})</h4><div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">\${discarded.map(e => entityCard(e, true)).join('')}</div></div>\`
        : '';
      
      document.getElementById('app').innerHTML = \`
        <div class="min-h-screen flex flex-col">
          <header class="bg-white border-b px-4 py-3 flex justify-between items-center shadow-sm">
            <div class="flex items-center gap-3">
              <span class="bg-emerald-600 text-white text-xs px-2 py-1 rounded font-bold">KEY</span>
              <h1 class="text-lg font-bold text-slate-800 truncate">\${project.name}</h1>
            </div>
            <button onclick="resetKey()" class="flex items-center gap-2 px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg"> \${strings.restart}</button>
          </header>
          
          <div class="md:hidden flex border-b bg-white">
            <button onclick="setMobileTab('FILTERS')" class="flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 \${mobileTab==='FILTERS'?'text-emerald-600 border-b-2 border-emerald-600':'text-slate-500 bg-slate-50'}">
               \${strings.features} \${totalSel>0?\`<span class="bg-emerald-600 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center">\${totalSel}</span>\`:''}
            </button>
            <button onclick="setMobileTab('RESULTS')" class="flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 \${mobileTab==='RESULTS'?'text-emerald-600 border-b-2 border-emerald-600':'text-slate-500 bg-slate-50'}">
               \${strings.matches} <span class="bg-slate-200 text-slate-700 text-xs px-1.5 py-0.5 rounded-full">\${remaining.length}</span>
            </button>
          </div>
          
          <div class="flex-1 flex flex-col md:flex-row overflow-hidden">
            <div class="w-full md:w-1/3 lg:w-1/4 bg-white md:border-r flex-col h-full \${mobileTab==='FILTERS'?'flex':'hidden md:flex'}">
              <div class="hidden md:block p-4 border-b bg-slate-50">
                <h3 class="font-semibold text-slate-700 flex items-center gap-2"> \${strings.features}</h3>
              </div>
              <div class="flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar">\${featuresHTML}</div>
            </div>
            
            <div class="flex-1 flex flex-col h-full \${mobileTab==='RESULTS'?'flex':'hidden md:flex'}">
              <div class="p-4 border-b bg-slate-50 flex justify-between items-center">
                <div>
                  <span class="font-semibold text-slate-700">\${remaining.length === 1 ? strings.identified : remaining.length + ' ' + strings.potential}</span>
                </div>
                \${discarded.length > 0 ? \`<button onclick="toggleDiscarded()" class="text-sm text-slate-500 hover:text-slate-700 flex items-center gap-1">\${showDiscarded?'':''} \${strings.discarded} (\${discarded.length})</button>\` : ''}
              </div>
              <div class="flex-1 overflow-y-auto p-4 custom-scrollbar">
                <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">\${remainingHTML}</div>
                \${discardedHTML}
              </div>
            </div>
          </div>
          
          <footer class="bg-white border-t px-4 py-2 text-center text-xs text-slate-400">
            \${strings.createdWith}  <a href="https://djhandoom.github.io/nozes/" target="_blank" class="text-emerald-600 hover:underline">djhandoom.github.io/nozes</a>
          </footer>
        </div>
        \${entityModalHTML}
      \`;
    }
    
    render();
  <\/script>
</body>
</html>`},LI={en:{player:"PLAYER",restart:"Restart",exit:"Exit",features:"Features",selected:"selected",matches:"Matches",discarded:"Discarded",identified:"1 Entity identified",potential:"potential matches",excluded:"Excluded by selection",noMatches:"No matches found.",tryUnselecting:"Try unselecting some features.",speciesDetails:"Species Details",morphology:"Morphology & Traits",close:"Close",resources:"Resources",viewResults:"View Results",openSaved:"Open",editKey:"Edit",exportJson:"JSON",exportXlsx:"XLSX",exportHtml:"HTML"},pt:{player:"PLAYER",restart:"Reiniciar",exit:"Sair",features:"Caractersticas",selected:"selecionado(s)",matches:"Compatveis",discarded:"Descartados",identified:"1 Entidade identificada",potential:"matches potenciais",excluded:"Excludo pela seleo",noMatches:"Nenhum resultado.",tryUnselecting:"Tente remover selees.",speciesDetails:"Detalhes da Espcie",morphology:"Morfologia & Caractersticas",close:"Fechar",resources:"Recursos Adicionais",viewResults:"Ver Resultados",openSaved:"Abrir",editKey:"Editar",exportJson:"JSON",exportXlsx:"XLSX",exportHtml:"HTML"}},OI=({project:e,onBack:t,language:n,onOpenSaved:r,onEditKey:i})=>{const s=LI[n],[o,a]=Te.useState({}),[l,u]=Te.useState(!1),[c,p]=Te.useState(null),[m,g]=Te.useState(null),[y,x]=Te.useState("FILTERS"),S=(D,b)=>{a(O=>{const J=O[D]||[],X=J.includes(b);let re;if(X?re=J.filter(we=>we!==b):re=[...J,b],re.length===0){const{[D]:we,..._e}=O;return _e}return{...O,[D]:re}})},T=()=>a({}),{remaining:E,discarded:_}=Te.useMemo(()=>{const D=[],b=[];return e.entities.forEach(O=>{let J=!0;for(const[X,re]of Object.entries(o)){const we=O.traits[X]||[];if(!re.some(Ne=>we.includes(Ne))){J=!1;break}}J?D.push(O):b.push(O)}),{remaining:D,discarded:b}},[e.entities,o]),N=Object.values(o).reduce((D,b)=>D+b.length,0),B=()=>{const D=JSON.stringify(e,null,2),b=new Blob([D],{type:"application/json"}),O=URL.createObjectURL(b),J=document.createElement("a");J.href=O,J.download=`${e.name.replace(/\s+/g,"_")}.json`,J.click(),URL.revokeObjectURL(O)},G=()=>{new Map(e.features.map(re=>[re.id,re]));const D=["Entity",...e.features.map(re=>re.name)],b=e.entities.map(re=>{const we=[re.name];return e.features.forEach(_e=>{const ge=(re.traits[_e.id]||[]).map(ae=>{var z;return((z=_e.states.find(se=>se.id===ae))==null?void 0:z.label)||""}).filter(Boolean).join(", ");we.push(ge)}),we}),O=[D,...b],J=vn.aoa_to_sheet(O),X=vn.book_new();vn.book_append_sheet(X,J,"Matrix"),av(X,`${e.name.replace(/\s+/g,"_")}.xlsx`)},k=()=>{const D=DI(e,n),b=new Blob([D],{type:"text/html;charset=utf-8"}),O=URL.createObjectURL(b),J=document.createElement("a");J.href=O,J.download=`${e.name.replace(/\s+/g,"_")}.html`,J.click(),URL.revokeObjectURL(O)};return h.jsxs("div",{className:"flex flex-col h-full bg-slate-100 font-sans absolute inset-0",children:[h.jsxs("header",{className:"bg-white border-b px-4 py-3 flex justify-between items-center shadow-sm z-30 shrink-0",children:[h.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[h.jsx("button",{onClick:t,className:"md:hidden p-2 -ml-2 text-slate-500 hover:bg-slate-100 rounded-full",children:h.jsx(j0,{size:20})}),h.jsx("div",{className:"overflow-hidden",children:h.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2 truncate",children:[h.jsx("span",{className:"hidden sm:inline-block bg-emerald-600 text-white text-xs px-2 py-1 rounded",children:s.player}),h.jsx("span",{className:"truncate",children:e.name})]})})]}),h.jsxs("div",{className:"flex gap-1 sm:gap-2 shrink-0",children:[r&&h.jsxs("button",{onClick:r,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",title:s.openSaved,children:[h.jsx(Xi,{size:18})," ",h.jsx("span",{className:"hidden lg:inline",children:s.openSaved})]}),i&&h.jsxs("button",{onClick:i,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",title:s.editKey,children:[h.jsx(zE,{size:18})," ",h.jsx("span",{className:"hidden lg:inline",children:s.editKey})]}),h.jsxs("button",{onClick:B,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",title:s.exportJson,children:[h.jsx(qc,{size:18})," ",h.jsx("span",{className:"hidden lg:inline",children:s.exportJson})]}),h.jsxs("button",{onClick:G,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",title:s.exportXlsx,children:[h.jsx(Jc,{size:18})," ",h.jsx("span",{className:"hidden lg:inline",children:s.exportXlsx})]}),h.jsxs("button",{onClick:k,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-purple-600 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",title:s.exportHtml,children:[h.jsx(hl,{size:18})," ",h.jsx("span",{className:"hidden lg:inline",children:s.exportHtml})]}),h.jsxs("button",{onClick:T,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",title:s.restart,children:[h.jsx(HE,{size:18})," ",h.jsx("span",{className:"hidden lg:inline",children:s.restart})]}),h.jsxs("button",{onClick:t,className:"hidden md:flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-600 hover:text-slate-900 transition-colors",children:[h.jsx(j0,{size:16})," ",s.exit]})]})]}),h.jsxs("div",{className:"md:hidden flex border-b bg-white z-20 shrink-0",children:[h.jsxs("button",{onClick:()=>x("FILTERS"),className:`flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 transition-colors relative ${y==="FILTERS"?"text-emerald-600":"text-slate-500 bg-slate-50"}`,children:[h.jsx(zu,{size:16}),s.features,N>0&&h.jsx("span",{className:"bg-emerald-600 text-white text-[10px] w-5 h-5 flex items-center justify-center rounded-full",children:N}),y==="FILTERS"&&h.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-600"})]}),h.jsxs("button",{onClick:()=>x("RESULTS"),className:`flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 transition-colors relative ${y==="RESULTS"?"text-emerald-600":"text-slate-500 bg-slate-50"}`,children:[h.jsx(Ix,{size:16}),s.matches,h.jsx("span",{className:"bg-slate-200 text-slate-700 text-[10px] px-1.5 py-0.5 rounded-full font-bold",children:E.length}),y==="RESULTS"&&h.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-600"})]})]}),h.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row relative",children:[h.jsxs("div",{className:`w-full md:w-1/3 lg:w-1/4 bg-white md:border-r flex flex-col h-full relative z-20 ${y==="FILTERS"?"flex":"hidden md:flex"}`,children:[h.jsx("div",{className:"hidden md:block p-4 border-b bg-slate-50",children:h.jsxs("h3",{className:"font-semibold text-slate-700 flex items-center gap-2",children:[h.jsx(zu,{size:18})," ",s.features]})}),h.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 pb-24 md:pb-4 custom-scrollbar",children:e.features.map(D=>{const b=o[D.id]||[],O=b.length>0;return h.jsxs("div",{className:"space-y-2 relative",children:[h.jsxs("div",{className:"flex justify-between items-center sticky top-0 bg-white/95 backdrop-blur-sm py-1 z-10",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("h4",{className:`font-medium ${O?"text-emerald-600":"text-slate-700"}`,children:D.name}),D.imageUrl&&h.jsx(h.Fragment,{children:h.jsx("button",{className:"text-slate-400 hover:text-emerald-500 transition-colors p-1",onClick:J=>{J.stopPropagation(),p(c===D.id?null:D.id)},children:h.jsx(Vi,{size:14})})})]}),O&&h.jsx("span",{className:"text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full",children:b.length})]}),c===D.id&&D.imageUrl&&h.jsxs("div",{className:"mb-2 rounded-lg overflow-hidden border border-slate-200 shadow-sm animate-in fade-in zoom-in-95",children:[h.jsx("img",{src:D.imageUrl,alt:D.name,className:"w-full h-32 object-cover"}),h.jsx("div",{className:"bg-slate-50 p-1 text-center",children:h.jsx("button",{onClick:()=>p(null),className:"text-xs text-slate-500 underline",children:"Fechar"})})]}),h.jsx("div",{className:"grid grid-cols-1 gap-1",children:D.states.map(J=>{const X=b.includes(J.id);return h.jsxs("button",{onClick:()=>S(D.id,J.id),className:`w-full text-left px-3 py-3 md:py-2 text-sm rounded-lg transition-all flex items-center justify-between group active:scale-[0.98] touch-manipulation ${X?"bg-emerald-600 text-white shadow-md":"bg-slate-50 text-slate-600 border border-transparent hover:bg-slate-100 hover:border-slate-200"}`,children:[h.jsx("span",{className:"leading-tight",children:J.label}),X&&h.jsx(Nx,{size:16,className:"shrink-0"})]},J.id)})})]},D.id)})}),h.jsx("div",{className:"md:hidden absolute bottom-4 left-4 right-4 z-30",children:h.jsxs("button",{onClick:()=>x("RESULTS"),className:"w-full bg-slate-900 text-white font-bold py-3 rounded-xl shadow-lg shadow-slate-900/20 flex items-center justify-center gap-2 animate-in slide-in-from-bottom-5",children:[s.viewResults," (",E.length,")"]})})]}),h.jsxs("div",{className:`flex-1 bg-slate-100 flex-col h-full overflow-hidden ${y==="RESULTS"?"flex":"hidden md:flex"}`,children:[h.jsxs("div",{className:"p-3 md:p-4 bg-white border-b flex justify-between items-center shadow-sm shrink-0",children:[h.jsxs("div",{className:"flex gap-2 md:gap-4 w-full md:w-auto bg-slate-100 p-1 rounded-lg",children:[h.jsxs("button",{className:`flex-1 md:flex-none text-xs md:text-sm font-medium px-3 py-1.5 rounded-md transition-all ${l?"text-slate-500":"bg-white text-slate-800 shadow-sm"}`,onClick:()=>u(!1),children:[s.matches," (",E.length,")"]}),h.jsxs("button",{className:`flex-1 md:flex-none text-xs md:text-sm font-medium px-3 py-1.5 rounded-md transition-all ${l?"bg-white text-slate-800 shadow-sm":"text-slate-500"}`,onClick:()=>u(!0),children:[s.discarded," (",_.length,")"]})]}),h.jsx("div",{className:"text-xs text-slate-400 hidden sm:block",children:E.length===1?s.identified:`${E.length} ${s.potential}`})]}),h.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 custom-scrollbar",onClick:()=>p(null),children:h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 pb-20 md:pb-0",children:[(l?_:E).map(D=>h.jsxs("div",{onClick:()=>g(D),className:`bg-white rounded-xl overflow-hidden shadow-sm hover:shadow-lg transition-all border cursor-pointer active:scale-[0.98] touch-manipulation ${l?"opacity-60 grayscale":""}`,children:[h.jsxs("div",{className:"h-48 md:h-40 bg-slate-200 relative group",children:[h.jsx("img",{src:D.imageUrl||"https://picsum.photos/400/300",alt:D.name,className:"w-full h-full object-cover",loading:"lazy"}),h.jsxs("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2 text-white font-medium",children:[h.jsx(q0,{size:20})," ",h.jsx("span",{className:"hidden md:inline",children:"Ver Detalhes"})]}),h.jsx("div",{className:"md:hidden absolute bottom-2 right-2 bg-black/50 text-white p-1.5 rounded-full backdrop-blur-sm",children:h.jsx(q0,{size:16})})]}),h.jsxs("div",{className:"p-4",children:[h.jsxs("h3",{className:"font-bold text-slate-800 text-lg mb-1 flex justify-between items-center",children:[D.name,h.jsx(kx,{size:16,className:"text-slate-300"})]}),(D.scientificName||D.family)&&h.jsxs("p",{className:"text-xs text-slate-400 italic mb-1",children:[D.scientificName,D.scientificName&&D.family?"  ":"",D.family]}),h.jsx("p",{className:"text-slate-500 text-xs line-clamp-3",children:D.description}),l&&h.jsxs("div",{className:"mt-3 pt-2 border-t border-slate-100 text-xs text-red-500 flex items-center gap-1",children:[h.jsx(En,{size:12})," ",s.excluded]})]})]},D.id)),!l&&E.length===0&&h.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-20 text-slate-400 px-4 text-center",children:[h.jsx(zu,{size:48,className:"mb-4 opacity-50"}),h.jsx("p",{className:"text-lg font-medium text-slate-600",children:s.noMatches}),h.jsx("p",{className:"text-sm",children:s.tryUnselecting}),h.jsx("button",{onClick:T,className:"mt-6 px-6 py-2 bg-slate-200 text-slate-700 rounded-lg font-medium hover:bg-slate-300",children:s.restart})]})]})})]})]}),m&&h.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-0 md:p-4 animate-in fade-in duration-200",children:h.jsxs("div",{className:"bg-white md:rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col h-full md:h-auto md:max-h-[90vh] overflow-hidden",children:[h.jsxs("div",{className:"relative h-64 md:h-64 shrink-0 bg-slate-900",children:[m.imageUrl?h.jsx("img",{src:m.imageUrl,className:"w-full h-full object-cover opacity-90",alt:m.name}):h.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-600 bg-slate-200",children:h.jsx(Vi,{size:48})}),h.jsx("button",{onClick:()=>g(null),className:"absolute top-4 right-4 bg-black/40 hover:bg-black/60 text-white p-2 rounded-full transition-colors z-10 backdrop-blur-sm",children:h.jsx(En,{size:24})}),h.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 via-black/50 to-transparent p-6 pt-12",children:[h.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white shadow-sm leading-tight",children:m.name}),(m.scientificName||m.family)&&h.jsxs("p",{className:"text-white/80 italic text-sm md:text-base mt-1",children:[m.scientificName,m.scientificName&&m.family?"  ":"",m.family]})]})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8 custom-scrollbar bg-white",children:[h.jsxs("div",{children:[h.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-3",children:[h.jsx(CE,{size:14})," ",s.speciesDetails]}),h.jsx("p",{className:"text-slate-800 leading-relaxed text-base md:text-lg font-serif",children:m.description})]}),m.links&&m.links.length>0&&h.jsxs("div",{children:[h.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-3",children:[h.jsx(Yc,{size:14})," ",s.resources]}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:m.links.map((D,b)=>h.jsxs("a",{href:D.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 rounded-lg border border-slate-200 bg-slate-50 hover:bg-slate-100 hover:border-emerald-300 transition-all group active:scale-[0.98]",children:[h.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm text-slate-400 group-hover:text-emerald-600",children:h.jsx(dl,{size:16})}),h.jsx("span",{className:"text-sm font-medium text-slate-700 group-hover:text-emerald-700 truncate flex-1",children:D.label||D.url})]},b))})]}),h.jsx("div",{className:"border-t border-slate-100"}),h.jsxs("div",{children:[h.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-4",children:[h.jsx(jE,{size:14})," ",s.morphology]}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4",children:e.features.map(D=>{const b=m.traits[D.id];if(!b||b.length===0)return null;const O=b.map(J=>{const X=D.states.find(re=>re.id===J);return X?X.label:"?"}).join(", ");return h.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 flex flex-col",children:[h.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:D.name}),h.jsx("span",{className:"text-sm font-semibold text-slate-800",children:O})]},D.id)})}),Object.keys(m.traits).length===0&&h.jsx("p",{className:"text-slate-400 text-sm italic",children:"Nenhuma caracterstica registrada."})]})]}),h.jsx("div",{className:"p-4 border-t bg-slate-50 shrink-0 safe-area-bottom",children:h.jsx("button",{onClick:()=>g(null),className:"w-full py-3 bg-slate-900 text-white font-bold rounded-xl hover:bg-slate-800 transition-colors shadow-lg",children:s.close})})]})})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let UI,BI;function GI(){return{geminiUrl:UI,vertexUrl:BI}}function VI(e,t,n,r){var i,s;if(!(e!=null&&e.baseUrl)){const o=GI();return t?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vr{}function de(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(t,i)){const s=t[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function d(e,t,n){for(let s=0;s<t.length-1;s++){const o=t[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in e))if(Array.isArray(n))e[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(e[a])){const l=e[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const c=l[u];d(c,t.slice(s+1),n[u])}else for(const u of l)d(u,t.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in e||(e[a]=[{}]);const l=e[a];d(l[0],t.slice(s+1),n);return}(!e[o]||typeof e[o]!="object")&&(e[o]={}),e=e[o]}const r=t[t.length-1],i=e[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(e,n):e[r]=n}function f(e,t,n=void 0){try{if(t.length===1&&t[0]==="_self")return e;for(let r=0;r<t.length;r++){if(typeof e!="object"||e===null)return n;const i=t[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in e){const o=e[s];return Array.isArray(o)?o.map(a=>f(a,t.slice(r+1),n)):n}else return n}else e=e[i]}return e}catch(r){if(r instanceof TypeError)return n;throw r}}function HI(e,t){for(const[n,r]of Object.entries(t)){const i=n.split("."),s=r.split("."),o=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const u=s[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}nf(e,i,s,0,o)}}function nf(e,t,n,r,i){if(r>=t.length||typeof e!="object"||e===null)return;const s=t[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=e;if(o in a&&Array.isArray(a[o]))for(const l of a[o])nf(l,t,n,r+1,i)}else if(s==="*"){if(typeof e=="object"&&e!==null&&!Array.isArray(e)){const o=e,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!i.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,c]of Object.entries(l)){const p=[];for(const m of n.slice(r))m==="*"?p.push(u):p.push(m);d(o,p,c)}for(const u of a)delete o[u]}}else{const o=e;s in o&&nf(o[s],t,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Nd(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $I(e){const t={},n=f(e,["operationName"]);n!=null&&d(t,["operationName"],n);const r=f(e,["resourceName"]);return r!=null&&d(t,["_url","resourceName"],r),t}function zI(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const i=f(e,["done"]);i!=null&&d(t,["done"],i);const s=f(e,["error"]);s!=null&&d(t,["error"],s);const o=f(e,["response","generateVideoResponse"]);return o!=null&&d(t,["response"],WI(o)),t}function jI(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const i=f(e,["done"]);i!=null&&d(t,["done"],i);const s=f(e,["error"]);s!=null&&d(t,["error"],s);const o=f(e,["response"]);return o!=null&&d(t,["response"],qI(o)),t}function WI(e){const t={},n=f(e,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>JI(o))),d(t,["generatedVideos"],s)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const i=f(e,["raiMediaFilteredReasons"]);return i!=null&&d(t,["raiMediaFilteredReasons"],i),t}function qI(e){const t={},n=f(e,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>KI(o))),d(t,["generatedVideos"],s)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const i=f(e,["raiMediaFilteredReasons"]);return i!=null&&d(t,["raiMediaFilteredReasons"],i),t}function JI(e){const t={},n=f(e,["video"]);return n!=null&&d(t,["video"],t4(n)),t}function KI(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],n4(n)),t}function YI(e){const t={},n=f(e,["operationName"]);return n!=null&&d(t,["_url","operationName"],n),t}function XI(e){const t={},n=f(e,["operationName"]);return n!=null&&d(t,["_url","operationName"],n),t}function QI(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const i=f(e,["done"]);i!=null&&d(t,["done"],i);const s=f(e,["error"]);s!=null&&d(t,["error"],s);const o=f(e,["response"]);return o!=null&&d(t,["response"],ZI(o)),t}function ZI(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["parent"]);r!=null&&d(t,["parent"],r);const i=f(e,["documentName"]);return i!=null&&d(t,["documentName"],i),t}function fv(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const i=f(e,["done"]);i!=null&&d(t,["done"],i);const s=f(e,["error"]);s!=null&&d(t,["error"],s);const o=f(e,["response"]);return o!=null&&d(t,["response"],e4(o)),t}function e4(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["parent"]);r!=null&&d(t,["parent"],r);const i=f(e,["documentName"]);return i!=null&&d(t,["documentName"],i),t}function t4(e){const t={},n=f(e,["uri"]);n!=null&&d(t,["uri"],n);const r=f(e,["encodedVideo"]);r!=null&&d(t,["videoBytes"],Nd(r));const i=f(e,["encoding"]);return i!=null&&d(t,["mimeType"],i),t}function n4(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["uri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&d(t,["videoBytes"],Nd(r));const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Hh;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Hh||(Hh={}));var $h;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})($h||($h={}));var zh;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(zh||(zh={}));var Ae;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(Ae||(Ae={}));var jh;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(jh||(jh={}));var Wh;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Wh||(Wh={}));var qh;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(qh||(qh={}));var Jh;(function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Jh||(Jh={}));var Kh;(function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Kh||(Kh={}));var Yh;(function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.HIGH="HIGH"})(Yh||(Yh={}));var Xh;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Xh||(Xh={}));var Qh;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(Qh||(Qh={}));var Zh;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(Zh||(Zh={}));var ep;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE"})(ep||(ep={}));var tp;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(tp||(tp={}));var np;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(np||(np={}));var rp;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(rp||(rp={}));var ip;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"})(ip||(ip={}));var sp;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(sp||(sp={}));var Pl;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Pl||(Pl={}));var op;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(op||(op={}));var ap;(function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(ap||(ap={}));var lp;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(lp||(lp={}));var rf;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(rf||(rf={}));var up;(function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"})(up||(up={}));var cp;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(cp||(cp={}));var fp;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(fp||(fp={}));var dp;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(dp||(dp={}));var hp;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(hp||(hp={}));var pp;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(pp||(pp={}));var mp;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"})(mp||(mp={}));var gp;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(gp||(gp={}));var xp;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(xp||(xp={}));var vp;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(vp||(vp={}));var yp;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(yp||(yp={}));var Ep;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Ep||(Ep={}));var Tp;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Tp||(Tp={}));var _p;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(_p||(_p={}));var Sp;(function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"})(Sp||(Sp={}));var wp;(function(e){e.ASSET="ASSET",e.STYLE="STYLE"})(wp||(wp={}));var Cp;(function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"})(Cp||(Cp={}));var Ap;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(Ap||(Ap={}));var Np;(function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING"})(Np||(Np={}));var Ip;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"})(Ip||(Ip={}));var kp;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(kp||(kp={}));var Rp;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(Rp||(Rp={}));var Pp;(function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Pp||(Pp={}));var Fp;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(Fp||(Fp={}));var Mp;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Mp||(Mp={}));var bp;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(bp||(bp={}));var Dp;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(Dp||(Dp={}));var Lp;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Lp||(Lp={}));var Op;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Op||(Op={}));var Up;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})(Up||(Up={}));var $i;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})($i||($i={}));class sf{constructor(t){const n={};for(const r of t.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class Gs{get text(){var t,n,r,i,s,o,a,l;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",c=!1;const p=[];for(const m of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[g,y]of Object.entries(m))g!=="text"&&g!=="thought"&&g!=="thoughtSignature"&&(y!==null||y!==void 0)&&p.push(g);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;c=!0,u+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),c?u:void 0}get data(){var t,n,r,i,s,o,a,l;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const c=[];for(const p of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[m,g]of Object.entries(p))m!=="inlineData"&&(g!==null||g!==void 0)&&c.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(u+=atob(p.inlineData.data))}return c.length>0&&console.warn(`there are non-data parts ${c} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var t,n,r,i,s,o,a,l;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(c=>c.functionCall).map(c=>c.functionCall).filter(c=>c!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var t,n,r,i,s,o,a,l,u;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const c=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((c==null?void 0:c.length)!==0)return(u=c==null?void 0:c[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var t,n,r,i,s,o,a,l,u;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const c=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((c==null?void 0:c.length)!==0)return(u=c==null?void 0:c[0])===null||u===void 0?void 0:u.output}}class Bp{}class Gp{}class r4{}class i4{}class s4{}class o4{}class Vp{}class Hp{}class $p{}class a4{}class Fl{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new Fl;let i;const s=t;return n?i=jI(s):i=zI(s),Object.assign(r,i),r}}class zp{}class jp{}class Wp{}class l4{}class u4{}class c4{}class Id{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new Id,s=QI(t);return Object.assign(r,s),r}}class f4{}class d4{}class h4{}class qp{}class p4{get text(){var t,n,r;let i="",s=!1;const o=[];for(const a of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var t,n,r;let i="";const s=[];for(const o of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class m4{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class kd{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new kd,s=fv(t);return Object.assign(r,s),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function De(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function dv(e,t){const n=De(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function hv(e){return Array.isArray(e)?e.map(t=>Ml(t)):[Ml(e)]}function Ml(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function pv(e){const t=Ml(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function mv(e){const t=Ml(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Jp(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function gv(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>Jp(t)):[Jp(e)]}function of(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function Kp(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function Yp(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function bt(e){if(e==null)throw new Error("ContentUnion is required");return of(e)?e:{role:"user",parts:gv(e)}}function Rd(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const r=bt(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const n=bt(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>bt(n)):[bt(t)]}function Cn(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(Kp(e)||Yp(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[bt(e)]}const t=[],n=[],r=of(e[0]);for(const i of e){const s=of(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)t.push(i);else{if(Kp(i)||Yp(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||t.push({role:"user",parts:gv(n)}),t}function g4(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(r=>r!=="null");if(n.length===1)t.type=Object.values(Ae).includes(n[0].toUpperCase())?n[0].toUpperCase():Ae.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const r of n)t.anyOf.push({type:Object.values(Ae).includes(r.toUpperCase())?r.toUpperCase():Ae.TYPE_UNSPECIFIED})}}function ns(e){const t={},n=["items"],r=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=e.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(t.nullable=!0,e=s[1]):s[1].type==="null"&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&g4(e.type,t);for(const[o,a]of Object.entries(e))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;t.type=Object.values(Ae).includes(a.toUpperCase())?a.toUpperCase():Ae.TYPE_UNSPECIFIED}else if(n.includes(o))t[o]=ns(a);else if(r.includes(o)){const l=[];for(const u of a){if(u.type=="null"){t.nullable=!0;continue}l.push(ns(u))}t[o]=l}else if(i.includes(o)){const l={};for(const[u,c]of Object.entries(a))l[u]=ns(c);t[o]=l}else{if(o==="additionalProperties")continue;t[o]=a}return t}function Pd(e){return ns(e)}function Fd(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function Md(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function Es(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=ns(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=ns(t.response));return e}function Ts(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function x4(e,t,n,r=1){const i=!t.startsWith(`${n}/`)&&t.split("/").length===r;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:i?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:i?`${n}/${t}`:t}function yr(e,t){if(typeof t!="string")throw new Error("name must be a string");return x4(e,t,"cachedContents")}function xv(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Yr(e){return Nd(e)}function v4(e){return e!=null&&typeof e=="object"&&"name"in e}function y4(e){return e!=null&&typeof e=="object"&&"video"in e}function E4(e){return e!=null&&typeof e=="object"&&"uri"in e}function vv(e){var t;let n;if(v4(e)&&(n=e.name),!(E4(e)&&(n=e.uri,n===void 0))&&!(y4(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function yv(e,t){let n;return e.isVertexAI()?n=t?"publishers/google/models":"models":n=t?"models":"tunedModels",n}function Ev(e){for(const t of["models","tunedModels","publisherModels"])if(T4(e,t))return e[t];return[]}function T4(e,t){return e!==null&&typeof e=="object"&&t in e}function _4(e,t={}){const n=e,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),t.behavior&&(r.behavior=t.behavior),{functionDeclarations:[r]}}function S4(e,t={}){const n=[],r=new Set;for(const i of e){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=_4(i,t);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function Tv(e,t){let n;if(typeof t=="string")if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))n={format:"bigquery",bigqueryUri:t};else throw new Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))n={fileName:t};else throw new Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function w4(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function _v(e){if(typeof e!="object"||e===null)return{};const t=e,n=t.inlinedResponses;if(typeof n!="object"||n===null)return e;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return e;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function _s(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function Sv(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function C4(e){const t={},n=f(e,["responsesFile"]);n!=null&&d(t,["fileName"],n);const r=f(e,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>sk(o))),d(t,["inlinedResponses"],s)}const i=f(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),d(t,["inlinedEmbedContentResponses"],s)}return t}function A4(e){const t={},n=f(e,["predictionsFormat"]);n!=null&&d(t,["format"],n);const r=f(e,["gcsDestination","outputUriPrefix"]);r!=null&&d(t,["gcsUri"],r);const i=f(e,["bigqueryDestination","outputUri"]);return i!=null&&d(t,["bigqueryUri"],i),t}function N4(e){const t={},n=f(e,["format"]);n!=null&&d(t,["predictionsFormat"],n);const r=f(e,["gcsUri"]);r!=null&&d(t,["gcsDestination","outputUriPrefix"],r);const i=f(e,["bigqueryUri"]);if(i!=null&&d(t,["bigqueryDestination","outputUri"],i),f(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(f(e,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}function Ga(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata","displayName"]);r!=null&&d(t,["displayName"],r);const i=f(e,["metadata","state"]);i!=null&&d(t,["state"],Sv(i));const s=f(e,["metadata","createTime"]);s!=null&&d(t,["createTime"],s);const o=f(e,["metadata","endTime"]);o!=null&&d(t,["endTime"],o);const a=f(e,["metadata","updateTime"]);a!=null&&d(t,["updateTime"],a);const l=f(e,["metadata","model"]);l!=null&&d(t,["model"],l);const u=f(e,["metadata","output"]);return u!=null&&d(t,["dest"],C4(_v(u))),t}function af(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const i=f(e,["state"]);i!=null&&d(t,["state"],Sv(i));const s=f(e,["error"]);s!=null&&d(t,["error"],s);const o=f(e,["createTime"]);o!=null&&d(t,["createTime"],o);const a=f(e,["startTime"]);a!=null&&d(t,["startTime"],a);const l=f(e,["endTime"]);l!=null&&d(t,["endTime"],l);const u=f(e,["updateTime"]);u!=null&&d(t,["updateTime"],u);const c=f(e,["model"]);c!=null&&d(t,["model"],c);const p=f(e,["inputConfig"]);p!=null&&d(t,["src"],I4(p));const m=f(e,["outputConfig"]);m!=null&&d(t,["dest"],A4(_v(m)));const g=f(e,["completionStats"]);return g!=null&&d(t,["completionStats"],g),t}function I4(e){const t={},n=f(e,["instancesFormat"]);n!=null&&d(t,["format"],n);const r=f(e,["gcsSource","uris"]);r!=null&&d(t,["gcsUri"],r);const i=f(e,["bigquerySource","inputUri"]);return i!=null&&d(t,["bigqueryUri"],i),t}function k4(e,t){const n={};if(f(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(f(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=f(t,["fileName"]);r!=null&&d(n,["fileName"],r);const i=f(t,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>ik(e,o))),d(n,["requests","requests"],s)}return n}function R4(e){const t={},n=f(e,["format"]);n!=null&&d(t,["instancesFormat"],n);const r=f(e,["gcsUri"]);r!=null&&d(t,["gcsSource","uris"],r);const i=f(e,["bigqueryUri"]);if(i!=null&&d(t,["bigquerySource","inputUri"],i),f(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function P4(e){const t={},n=f(e,["data"]);if(n!=null&&d(t,["data"],n),f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function F4(e,t){const n={},r=f(t,["name"]);return r!=null&&d(n,["_url","name"],_s(e,r)),n}function M4(e,t){const n={},r=f(t,["name"]);return r!=null&&d(n,["_url","name"],_s(e,r)),n}function b4(e){const t={},n=f(e,["content"]);n!=null&&d(t,["content"],n);const r=f(e,["citationMetadata"]);r!=null&&d(t,["citationMetadata"],D4(r));const i=f(e,["tokenCount"]);i!=null&&d(t,["tokenCount"],i);const s=f(e,["finishReason"]);s!=null&&d(t,["finishReason"],s);const o=f(e,["avgLogprobs"]);o!=null&&d(t,["avgLogprobs"],o);const a=f(e,["groundingMetadata"]);a!=null&&d(t,["groundingMetadata"],a);const l=f(e,["index"]);l!=null&&d(t,["index"],l);const u=f(e,["logprobsResult"]);u!=null&&d(t,["logprobsResult"],u);const c=f(e,["safetyRatings"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(g=>g)),d(t,["safetyRatings"],m)}const p=f(e,["urlContextMetadata"]);return p!=null&&d(t,["urlContextMetadata"],p),t}function D4(e){const t={},n=f(e,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),d(t,["citations"],r)}return t}function wv(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>dk(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function L4(e,t){const n={},r=f(e,["displayName"]);if(t!==void 0&&r!=null&&d(t,["batch","displayName"],r),f(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function O4(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&d(t,["displayName"],r);const i=f(e,["dest"]);return t!==void 0&&i!=null&&d(t,["outputConfig"],N4(w4(i))),n}function Xp(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["src"]);i!=null&&d(n,["batch","inputConfig"],k4(e,Tv(e,i)));const s=f(t,["config"]);return s!=null&&L4(s,n),n}function U4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["model"],De(e,r));const i=f(t,["src"]);i!=null&&d(n,["inputConfig"],R4(Tv(e,i)));const s=f(t,["config"]);return s!=null&&O4(s,n),n}function B4(e,t){const n={},r=f(e,["displayName"]);return t!==void 0&&r!=null&&d(t,["batch","displayName"],r),n}function G4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["src"]);i!=null&&d(n,["batch","inputConfig"],q4(e,i));const s=f(t,["config"]);return s!=null&&B4(s,n),n}function V4(e,t){const n={},r=f(t,["name"]);return r!=null&&d(n,["_url","name"],_s(e,r)),n}function H4(e,t){const n={},r=f(t,["name"]);return r!=null&&d(n,["_url","name"],_s(e,r)),n}function $4(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const i=f(e,["done"]);i!=null&&d(t,["done"],i);const s=f(e,["error"]);return s!=null&&d(t,["error"],s),t}function z4(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const i=f(e,["done"]);i!=null&&d(t,["done"],i);const s=f(e,["error"]);return s!=null&&d(t,["error"],s),t}function j4(e,t){const n={},r=f(t,["contents"]);if(r!=null){let s=Rd(e,r);Array.isArray(s)&&(s=s.map(o=>o)),d(n,["requests[]","request","content"],s)}const i=f(t,["config"]);return i!=null&&(d(n,["_self"],W4(i,n)),HI(n,{"requests[].*":"requests[].request.*"})),n}function W4(e,t){const n={},r=f(e,["taskType"]);t!==void 0&&r!=null&&d(t,["requests[]","taskType"],r);const i=f(e,["title"]);t!==void 0&&i!=null&&d(t,["requests[]","title"],i);const s=f(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&d(t,["requests[]","outputDimensionality"],s),f(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function q4(e,t){const n={},r=f(t,["fileName"]);r!=null&&d(n,["file_name"],r);const i=f(t,["inlinedRequests"]);return i!=null&&d(n,["requests"],j4(e,i)),n}function J4(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function K4(e){const t={},n=f(e,["id"]);n!=null&&d(t,["id"],n);const r=f(e,["args"]);r!=null&&d(t,["args"],r);const i=f(e,["name"]);if(i!=null&&d(t,["name"],i),f(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function Y4(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);if(r!=null&&d(t,["allowedFunctionNames"],r),f(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function X4(e,t,n){const r={},i=f(t,["systemInstruction"]);n!==void 0&&i!=null&&d(n,["systemInstruction"],wv(bt(i)));const s=f(t,["temperature"]);s!=null&&d(r,["temperature"],s);const o=f(t,["topP"]);o!=null&&d(r,["topP"],o);const a=f(t,["topK"]);a!=null&&d(r,["topK"],a);const l=f(t,["candidateCount"]);l!=null&&d(r,["candidateCount"],l);const u=f(t,["maxOutputTokens"]);u!=null&&d(r,["maxOutputTokens"],u);const c=f(t,["stopSequences"]);c!=null&&d(r,["stopSequences"],c);const p=f(t,["responseLogprobs"]);p!=null&&d(r,["responseLogprobs"],p);const m=f(t,["logprobs"]);m!=null&&d(r,["logprobs"],m);const g=f(t,["presencePenalty"]);g!=null&&d(r,["presencePenalty"],g);const y=f(t,["frequencyPenalty"]);y!=null&&d(r,["frequencyPenalty"],y);const x=f(t,["seed"]);x!=null&&d(r,["seed"],x);const S=f(t,["responseMimeType"]);S!=null&&d(r,["responseMimeType"],S);const T=f(t,["responseSchema"]);T!=null&&d(r,["responseSchema"],Pd(T));const E=f(t,["responseJsonSchema"]);if(E!=null&&d(r,["responseJsonSchema"],E),f(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=f(t,["safetySettings"]);if(n!==void 0&&_!=null){let X=_;Array.isArray(X)&&(X=X.map(re=>hk(re))),d(n,["safetySettings"],X)}const N=f(t,["tools"]);if(n!==void 0&&N!=null){let X=Ts(N);Array.isArray(X)&&(X=X.map(re=>mk(Es(re)))),d(n,["tools"],X)}const B=f(t,["toolConfig"]);if(n!==void 0&&B!=null&&d(n,["toolConfig"],pk(B)),f(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const G=f(t,["cachedContent"]);n!==void 0&&G!=null&&d(n,["cachedContent"],yr(e,G));const k=f(t,["responseModalities"]);k!=null&&d(r,["responseModalities"],k);const D=f(t,["mediaResolution"]);D!=null&&d(r,["mediaResolution"],D);const b=f(t,["speechConfig"]);if(b!=null&&d(r,["speechConfig"],Fd(b)),f(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const O=f(t,["thinkingConfig"]);O!=null&&d(r,["thinkingConfig"],O);const J=f(t,["imageConfig"]);return J!=null&&d(r,["imageConfig"],rk(J)),r}function Q4(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>b4(u))),d(t,["candidates"],l)}const i=f(e,["modelVersion"]);i!=null&&d(t,["modelVersion"],i);const s=f(e,["promptFeedback"]);s!=null&&d(t,["promptFeedback"],s);const o=f(e,["responseId"]);o!=null&&d(t,["responseId"],o);const a=f(e,["usageMetadata"]);return a!=null&&d(t,["usageMetadata"],a),t}function Z4(e,t){const n={},r=f(t,["name"]);return r!=null&&d(n,["_url","name"],_s(e,r)),n}function ek(e,t){const n={},r=f(t,["name"]);return r!=null&&d(n,["_url","name"],_s(e,r)),n}function tk(e){const t={};if(f(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=f(e,["enableWidget"]);return n!=null&&d(t,["enableWidget"],n),t}function nk(e){const t={};if(f(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],n),t}function rk(e){const t={},n=f(e,["aspectRatio"]);n!=null&&d(t,["aspectRatio"],n);const r=f(e,["imageSize"]);if(r!=null&&d(t,["imageSize"],r),f(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function ik(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["request","model"],De(e,r));const i=f(t,["contents"]);if(i!=null){let a=Cn(i);Array.isArray(a)&&(a=a.map(l=>wv(l))),d(n,["request","contents"],a)}const s=f(t,["metadata"]);s!=null&&d(n,["metadata"],s);const o=f(t,["config"]);return o!=null&&d(n,["request","generationConfig"],X4(e,o,f(n,["request"],{}))),n}function sk(e){const t={},n=f(e,["response"]);n!=null&&d(t,["response"],Q4(n));const r=f(e,["error"]);return r!=null&&d(t,["error"],r),t}function ok(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);if(t!==void 0&&i!=null&&d(t,["_query","pageToken"],i),f(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function ak(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);t!==void 0&&i!=null&&d(t,["_query","pageToken"],i);const s=f(e,["filter"]);return t!==void 0&&s!=null&&d(t,["_query","filter"],s),n}function lk(e){const t={},n=f(e,["config"]);return n!=null&&ok(n,t),t}function uk(e){const t={},n=f(e,["config"]);return n!=null&&ak(n,t),t}function ck(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Ga(o))),d(t,["batchJobs"],s)}return t}function fk(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>af(o))),d(t,["batchJobs"],s)}return t}function dk(e){const t={},n=f(e,["mediaResolution"]);n!=null&&d(t,["mediaResolution"],n);const r=f(e,["codeExecutionResult"]);r!=null&&d(t,["codeExecutionResult"],r);const i=f(e,["executableCode"]);i!=null&&d(t,["executableCode"],i);const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],J4(s));const o=f(e,["functionCall"]);o!=null&&d(t,["functionCall"],K4(o));const a=f(e,["functionResponse"]);a!=null&&d(t,["functionResponse"],a);const l=f(e,["inlineData"]);l!=null&&d(t,["inlineData"],P4(l));const u=f(e,["text"]);u!=null&&d(t,["text"],u);const c=f(e,["thought"]);c!=null&&d(t,["thought"],c);const p=f(e,["thoughtSignature"]);p!=null&&d(t,["thoughtSignature"],p);const m=f(e,["videoMetadata"]);return m!=null&&d(t,["videoMetadata"],m),t}function hk(e){const t={},n=f(e,["category"]);if(n!=null&&d(t,["category"],n),f(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=f(e,["threshold"]);return r!=null&&d(t,["threshold"],r),t}function pk(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],Y4(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],r),t}function mk(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(p=>p)),d(t,["functionDeclarations"],c)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearchRetrieval"]);r!=null&&d(t,["googleSearchRetrieval"],r);const i=f(e,["computerUse"]);i!=null&&d(t,["computerUse"],i);const s=f(e,["fileSearch"]);s!=null&&d(t,["fileSearch"],s);const o=f(e,["codeExecution"]);if(o!=null&&d(t,["codeExecution"],o),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=f(e,["googleMaps"]);a!=null&&d(t,["googleMaps"],tk(a));const l=f(e,["googleSearch"]);l!=null&&d(t,["googleSearch"],nk(l));const u=f(e,["urlContext"]);return u!=null&&d(t,["urlContext"],u),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var mr;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"})(mr||(mr={}));class Ti{constructor(t,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,r,i)}init(t,n,r){var i,s;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gk extends vr{constructor(t){super(),this.apiClient=t,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new Ti(mr.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(t){const n=Xp(this.apiClient,t),r=n._url,i=de("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const c of l){const p=Object.assign({},c);if(p.systemInstruction){const m=p.systemInstruction;delete p.systemInstruction;const g=p.request;g.systemInstruction=m,p.request=g}u.push(p)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(t){if(typeof t=="string")return t.startsWith("gs://")?t:void 0;if(!Array.isArray(t)&&t.gcsUri&&t.gcsUri.length>0)return t.gcsUri[0]}getBigqueryUri(t){if(typeof t=="string")return t.startsWith("bq://")?t:void 0;if(!Array.isArray(t))return t.bigqueryUri}formatDestination(t,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(t),o=this.getBigqueryUri(t);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=U4(this.apiClient,t);return a=de("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),o.then(c=>af(c))}else{const u=Xp(this.apiClient,t);return a=de("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),o.then(c=>Ga(c))}}async createEmbeddingsInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=G4(this.apiClient,t);return s=de("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>Ga(l))}}async get(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=ek(this.apiClient,t);return a=de("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),o.then(c=>af(c))}else{const u=Z4(this.apiClient,t);return a=de("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),o.then(c=>Ga(c))}}async cancel(t){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=M4(this.apiClient,t);o=de("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=F4(this.apiClient,t);o=de("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=uk(t);return a=de("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=fk(c),m=new qp;return Object.assign(m,p),m})}else{const u=lk(t);return a=de("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=ck(c),m=new qp;return Object.assign(m,p),m})}}async delete(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=H4(this.apiClient,t);return a=de("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>z4(c))}else{const u=V4(this.apiClient,t);return a=de("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>$4(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xk(e){const t={},n=f(e,["data"]);if(n!=null&&d(t,["data"],n),f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Qp(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Gk(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function vk(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const i=f(e,["expireTime"]);t!==void 0&&i!=null&&d(t,["expireTime"],i);const s=f(e,["displayName"]);t!==void 0&&s!=null&&d(t,["displayName"],s);const o=f(e,["contents"]);if(t!==void 0&&o!=null){let c=Cn(o);Array.isArray(c)&&(c=c.map(p=>Qp(p))),d(t,["contents"],c)}const a=f(e,["systemInstruction"]);t!==void 0&&a!=null&&d(t,["systemInstruction"],Qp(bt(a)));const l=f(e,["tools"]);if(t!==void 0&&l!=null){let c=l;Array.isArray(c)&&(c=c.map(p=>Hk(p))),d(t,["tools"],c)}const u=f(e,["toolConfig"]);if(t!==void 0&&u!=null&&d(t,["toolConfig"],Vk(u)),f(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function yk(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const i=f(e,["expireTime"]);t!==void 0&&i!=null&&d(t,["expireTime"],i);const s=f(e,["displayName"]);t!==void 0&&s!=null&&d(t,["displayName"],s);const o=f(e,["contents"]);if(t!==void 0&&o!=null){let p=Cn(o);Array.isArray(p)&&(p=p.map(m=>m)),d(t,["contents"],p)}const a=f(e,["systemInstruction"]);t!==void 0&&a!=null&&d(t,["systemInstruction"],bt(a));const l=f(e,["tools"]);if(t!==void 0&&l!=null){let p=l;Array.isArray(p)&&(p=p.map(m=>$k(m))),d(t,["tools"],p)}const u=f(e,["toolConfig"]);t!==void 0&&u!=null&&d(t,["toolConfig"],u);const c=f(e,["kmsKeyName"]);return t!==void 0&&c!=null&&d(t,["encryption_spec","kmsKeyName"],c),n}function Ek(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["model"],dv(e,r));const i=f(t,["config"]);return i!=null&&vk(i,n),n}function Tk(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["model"],dv(e,r));const i=f(t,["config"]);return i!=null&&yk(i,n),n}function _k(e,t){const n={},r=f(t,["name"]);return r!=null&&d(n,["_url","name"],yr(e,r)),n}function Sk(e,t){const n={},r=f(t,["name"]);return r!=null&&d(n,["_url","name"],yr(e,r)),n}function wk(e){const t={},n=f(e,["sdkHttpResponse"]);return n!=null&&d(t,["sdkHttpResponse"],n),t}function Ck(e){const t={},n=f(e,["sdkHttpResponse"]);return n!=null&&d(t,["sdkHttpResponse"],n),t}function Ak(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Nk(e){const t={},n=f(e,["id"]);n!=null&&d(t,["id"],n);const r=f(e,["args"]);r!=null&&d(t,["args"],r);const i=f(e,["name"]);if(i!=null&&d(t,["name"],i),f(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function Ik(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);if(r!=null&&d(t,["allowedFunctionNames"],r),f(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function kk(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&d(t,["description"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const i=f(e,["parameters"]);i!=null&&d(t,["parameters"],i);const s=f(e,["parametersJsonSchema"]);s!=null&&d(t,["parametersJsonSchema"],s);const o=f(e,["response"]);o!=null&&d(t,["response"],o);const a=f(e,["responseJsonSchema"]);return a!=null&&d(t,["responseJsonSchema"],a),t}function Rk(e,t){const n={},r=f(t,["name"]);return r!=null&&d(n,["_url","name"],yr(e,r)),n}function Pk(e,t){const n={},r=f(t,["name"]);return r!=null&&d(n,["_url","name"],yr(e,r)),n}function Fk(e){const t={};if(f(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=f(e,["enableWidget"]);return n!=null&&d(t,["enableWidget"],n),t}function Mk(e){const t={};if(f(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],n),t}function bk(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);return t!==void 0&&i!=null&&d(t,["_query","pageToken"],i),n}function Dk(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);return t!==void 0&&i!=null&&d(t,["_query","pageToken"],i),n}function Lk(e){const t={},n=f(e,["config"]);return n!=null&&bk(n,t),t}function Ok(e){const t={},n=f(e,["config"]);return n!=null&&Dk(n,t),t}function Uk(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),d(t,["cachedContents"],s)}return t}function Bk(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),d(t,["cachedContents"],s)}return t}function Gk(e){const t={},n=f(e,["mediaResolution"]);n!=null&&d(t,["mediaResolution"],n);const r=f(e,["codeExecutionResult"]);r!=null&&d(t,["codeExecutionResult"],r);const i=f(e,["executableCode"]);i!=null&&d(t,["executableCode"],i);const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],Ak(s));const o=f(e,["functionCall"]);o!=null&&d(t,["functionCall"],Nk(o));const a=f(e,["functionResponse"]);a!=null&&d(t,["functionResponse"],a);const l=f(e,["inlineData"]);l!=null&&d(t,["inlineData"],xk(l));const u=f(e,["text"]);u!=null&&d(t,["text"],u);const c=f(e,["thought"]);c!=null&&d(t,["thought"],c);const p=f(e,["thoughtSignature"]);p!=null&&d(t,["thoughtSignature"],p);const m=f(e,["videoMetadata"]);return m!=null&&d(t,["videoMetadata"],m),t}function Vk(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],Ik(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],r),t}function Hk(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(p=>p)),d(t,["functionDeclarations"],c)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearchRetrieval"]);r!=null&&d(t,["googleSearchRetrieval"],r);const i=f(e,["computerUse"]);i!=null&&d(t,["computerUse"],i);const s=f(e,["fileSearch"]);s!=null&&d(t,["fileSearch"],s);const o=f(e,["codeExecution"]);if(o!=null&&d(t,["codeExecution"],o),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=f(e,["googleMaps"]);a!=null&&d(t,["googleMaps"],Fk(a));const l=f(e,["googleSearch"]);l!=null&&d(t,["googleSearch"],Mk(l));const u=f(e,["urlContext"]);return u!=null&&d(t,["urlContext"],u),t}function $k(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>kk(m))),d(t,["functionDeclarations"],p)}const r=f(e,["retrieval"]);r!=null&&d(t,["retrieval"],r);const i=f(e,["googleSearchRetrieval"]);i!=null&&d(t,["googleSearchRetrieval"],i);const s=f(e,["computerUse"]);if(s!=null&&d(t,["computerUse"],s),f(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=f(e,["codeExecution"]);o!=null&&d(t,["codeExecution"],o);const a=f(e,["enterpriseWebSearch"]);a!=null&&d(t,["enterpriseWebSearch"],a);const l=f(e,["googleMaps"]);l!=null&&d(t,["googleMaps"],l);const u=f(e,["googleSearch"]);u!=null&&d(t,["googleSearch"],u);const c=f(e,["urlContext"]);return c!=null&&d(t,["urlContext"],c),t}function zk(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const i=f(e,["expireTime"]);return t!==void 0&&i!=null&&d(t,["expireTime"],i),n}function jk(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const i=f(e,["expireTime"]);return t!==void 0&&i!=null&&d(t,["expireTime"],i),n}function Wk(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],yr(e,r));const i=f(t,["config"]);return i!=null&&zk(i,n),n}function qk(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],yr(e,r));const i=f(t,["config"]);return i!=null&&jk(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Jk extends vr{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Ti(mr.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Tk(this.apiClient,t);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),o.then(c=>c)}else{const u=Ek(this.apiClient,t);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),o.then(c=>c)}}async get(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Pk(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),o.then(c=>c)}else{const u=Rk(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),o.then(c=>c)}}async delete(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Sk(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=Ck(c),m=new jp;return Object.assign(m,p),m})}else{const u=_k(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=wk(c),m=new jp;return Object.assign(m,p),m})}}async update(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=qk(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),o.then(c=>c)}else{const u=Wk(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),o.then(c=>c)}}async listInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Ok(t);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=Bk(c),m=new Wp;return Object.assign(m,p),m})}else{const u=Lk(t);return a=de("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=Uk(c),m=new Wp;return Object.assign(m,p),m})}}}function Zp(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ye(e){return this instanceof Ye?(this.v=e,this):new Ye(e)}function rs(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(g){return function(y){return Promise.resolve(y).then(g,p)}}function a(g,y){r[g]&&(i[g]=function(x){return new Promise(function(S,T){s.push([g,x,S,T])>1||l(g,x)})},y&&(i[g]=y(i[g])))}function l(g,y){try{u(r[g](y))}catch(x){m(s[0][3],x)}}function u(g){g.value instanceof Ye?Promise.resolve(g.value.v).then(c,p):m(s[0][2],g)}function c(g){l("next",g)}function p(g){l("throw",g)}function m(g,y){g(y),s.shift(),s.length&&l(s[0][0],s[0][1])}}function ao(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Zp=="function"?Zp(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(o){return new Promise(function(a,l){o=e[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Kk(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:Cv(n)}function Cv(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0)return!1;return!0}function Yk(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function em(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let r=0;for(;r<n;)if(e[r].role==="user")t.push(e[r]),r++;else{const i=[];let s=!0;for(;r<n&&e[r].role==="model";)i.push(e[r]),s&&!Cv(e[r])&&(s=!1),r++;s?t.push(...i):t.pop()}return t}class Xk{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new Qk(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class Qk{constructor(t,n,r,i={},s=[]){this.apiClient=t,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),Yk(s)}async sendMessage(t){var n;await this.sendPromise;const r=bt(t.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const l=await i,u=(o=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,c=l.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let m=[];c!=null&&(m=(a=c.slice(p))!==null&&a!==void 0?a:[]);const g=u?[u]:[];this.recordHistory(r,g,m)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(t){var n;await this.sendPromise;const r=bt(t.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(t=!1){const n=t?em(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){var r,i;return rs(this,arguments,function*(){var o,a,l,u;const c=[];try{for(var p=!0,m=ao(t),g;g=yield Ye(m.next()),o=g.done,!o;p=!0){u=g.value,p=!1;const y=u;if(Kk(y)){const x=(i=(r=y.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;x!==void 0&&c.push(x)}yield yield Ye(y)}}catch(y){a={error:y}}finally{try{!p&&!o&&(l=m.return)&&(yield Ye(l.call(m)))}finally{if(a)throw a.error}}this.recordHistory(n,c)})}recordHistory(t,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...em(r)):this.history.push(t),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class su extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,su.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Zk(e){const t={},n=f(e,["file"]);return n!=null&&d(t,["file"],n),t}function eR(e){const t={},n=f(e,["sdkHttpResponse"]);return n!=null&&d(t,["sdkHttpResponse"],n),t}function tR(e){const t={},n=f(e,["name"]);return n!=null&&d(t,["_url","file"],vv(n)),t}function nR(e){const t={},n=f(e,["sdkHttpResponse"]);return n!=null&&d(t,["sdkHttpResponse"],n),t}function rR(e){const t={},n=f(e,["name"]);return n!=null&&d(t,["_url","file"],vv(n)),t}function iR(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);return t!==void 0&&i!=null&&d(t,["_query","pageToken"],i),n}function sR(e){const t={},n=f(e,["config"]);return n!=null&&iR(n,t),t}function oR(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),d(t,["files"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aR extends vr{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Ti(mr.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>n)}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=sR(t);return s=de("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:l.headers},c})),i.then(l=>{const u=oR(l),c=new f4;return Object.assign(c,u),c})}}async createInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Zk(t);return s=de("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=eR(l),c=new d4;return Object.assign(c,u),c})}}async get(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=rR(t);return s=de("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=tR(t);return s=de("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:l.headers},c})),i.then(l=>{const u=nR(l),c=new h4;return Object.assign(c,u),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Va(e){const t={},n=f(e,["data"]);if(n!=null&&d(t,["data"],n),f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function lR(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>wR(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function uR(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function cR(e){const t={},n=f(e,["id"]);n!=null&&d(t,["id"],n);const r=f(e,["args"]);r!=null&&d(t,["args"],r);const i=f(e,["name"]);if(i!=null&&d(t,["name"],i),f(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function fR(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&d(t,["description"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const i=f(e,["parameters"]);i!=null&&d(t,["parameters"],i);const s=f(e,["parametersJsonSchema"]);s!=null&&d(t,["parametersJsonSchema"],s);const o=f(e,["response"]);o!=null&&d(t,["response"],o);const a=f(e,["responseJsonSchema"]);return a!=null&&d(t,["responseJsonSchema"],a),t}function dR(e){const t={},n=f(e,["modelSelectionConfig"]);n!=null&&d(t,["modelConfig"],n);const r=f(e,["responseJsonSchema"]);r!=null&&d(t,["responseJsonSchema"],r);const i=f(e,["audioTimestamp"]);i!=null&&d(t,["audioTimestamp"],i);const s=f(e,["candidateCount"]);s!=null&&d(t,["candidateCount"],s);const o=f(e,["enableAffectiveDialog"]);o!=null&&d(t,["enableAffectiveDialog"],o);const a=f(e,["frequencyPenalty"]);a!=null&&d(t,["frequencyPenalty"],a);const l=f(e,["logprobs"]);l!=null&&d(t,["logprobs"],l);const u=f(e,["maxOutputTokens"]);u!=null&&d(t,["maxOutputTokens"],u);const c=f(e,["mediaResolution"]);c!=null&&d(t,["mediaResolution"],c);const p=f(e,["presencePenalty"]);p!=null&&d(t,["presencePenalty"],p);const m=f(e,["responseLogprobs"]);m!=null&&d(t,["responseLogprobs"],m);const g=f(e,["responseMimeType"]);g!=null&&d(t,["responseMimeType"],g);const y=f(e,["responseModalities"]);y!=null&&d(t,["responseModalities"],y);const x=f(e,["responseSchema"]);x!=null&&d(t,["responseSchema"],x);const S=f(e,["routingConfig"]);S!=null&&d(t,["routingConfig"],S);const T=f(e,["seed"]);T!=null&&d(t,["seed"],T);const E=f(e,["speechConfig"]);E!=null&&d(t,["speechConfig"],Av(E));const _=f(e,["stopSequences"]);_!=null&&d(t,["stopSequences"],_);const N=f(e,["temperature"]);N!=null&&d(t,["temperature"],N);const B=f(e,["thinkingConfig"]);B!=null&&d(t,["thinkingConfig"],B);const G=f(e,["topK"]);G!=null&&d(t,["topK"],G);const k=f(e,["topP"]);if(k!=null&&d(t,["topP"],k),f(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function hR(e){const t={};if(f(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=f(e,["enableWidget"]);return n!=null&&d(t,["enableWidget"],n),t}function pR(e){const t={};if(f(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],n),t}function mR(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&d(t,["setup","generationConfig"],r);const i=f(e,["responseModalities"]);t!==void 0&&i!=null&&d(t,["setup","generationConfig","responseModalities"],i);const s=f(e,["temperature"]);t!==void 0&&s!=null&&d(t,["setup","generationConfig","temperature"],s);const o=f(e,["topP"]);t!==void 0&&o!=null&&d(t,["setup","generationConfig","topP"],o);const a=f(e,["topK"]);t!==void 0&&a!=null&&d(t,["setup","generationConfig","topK"],a);const l=f(e,["maxOutputTokens"]);t!==void 0&&l!=null&&d(t,["setup","generationConfig","maxOutputTokens"],l);const u=f(e,["mediaResolution"]);t!==void 0&&u!=null&&d(t,["setup","generationConfig","mediaResolution"],u);const c=f(e,["seed"]);t!==void 0&&c!=null&&d(t,["setup","generationConfig","seed"],c);const p=f(e,["speechConfig"]);t!==void 0&&p!=null&&d(t,["setup","generationConfig","speechConfig"],Md(p));const m=f(e,["thinkingConfig"]);t!==void 0&&m!=null&&d(t,["setup","generationConfig","thinkingConfig"],m);const g=f(e,["enableAffectiveDialog"]);t!==void 0&&g!=null&&d(t,["setup","generationConfig","enableAffectiveDialog"],g);const y=f(e,["systemInstruction"]);t!==void 0&&y!=null&&d(t,["setup","systemInstruction"],lR(bt(y)));const x=f(e,["tools"]);if(t!==void 0&&x!=null){let G=Ts(x);Array.isArray(G)&&(G=G.map(k=>AR(Es(k)))),d(t,["setup","tools"],G)}const S=f(e,["sessionResumption"]);t!==void 0&&S!=null&&d(t,["setup","sessionResumption"],CR(S));const T=f(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&d(t,["setup","inputAudioTranscription"],T);const E=f(e,["outputAudioTranscription"]);t!==void 0&&E!=null&&d(t,["setup","outputAudioTranscription"],E);const _=f(e,["realtimeInputConfig"]);t!==void 0&&_!=null&&d(t,["setup","realtimeInputConfig"],_);const N=f(e,["contextWindowCompression"]);t!==void 0&&N!=null&&d(t,["setup","contextWindowCompression"],N);const B=f(e,["proactivity"]);return t!==void 0&&B!=null&&d(t,["setup","proactivity"],B),n}function gR(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&d(t,["setup","generationConfig"],dR(r));const i=f(e,["responseModalities"]);t!==void 0&&i!=null&&d(t,["setup","generationConfig","responseModalities"],i);const s=f(e,["temperature"]);t!==void 0&&s!=null&&d(t,["setup","generationConfig","temperature"],s);const o=f(e,["topP"]);t!==void 0&&o!=null&&d(t,["setup","generationConfig","topP"],o);const a=f(e,["topK"]);t!==void 0&&a!=null&&d(t,["setup","generationConfig","topK"],a);const l=f(e,["maxOutputTokens"]);t!==void 0&&l!=null&&d(t,["setup","generationConfig","maxOutputTokens"],l);const u=f(e,["mediaResolution"]);t!==void 0&&u!=null&&d(t,["setup","generationConfig","mediaResolution"],u);const c=f(e,["seed"]);t!==void 0&&c!=null&&d(t,["setup","generationConfig","seed"],c);const p=f(e,["speechConfig"]);t!==void 0&&p!=null&&d(t,["setup","generationConfig","speechConfig"],Av(Md(p)));const m=f(e,["thinkingConfig"]);t!==void 0&&m!=null&&d(t,["setup","generationConfig","thinkingConfig"],m);const g=f(e,["enableAffectiveDialog"]);t!==void 0&&g!=null&&d(t,["setup","generationConfig","enableAffectiveDialog"],g);const y=f(e,["systemInstruction"]);t!==void 0&&y!=null&&d(t,["setup","systemInstruction"],bt(y));const x=f(e,["tools"]);if(t!==void 0&&x!=null){let G=Ts(x);Array.isArray(G)&&(G=G.map(k=>NR(Es(k)))),d(t,["setup","tools"],G)}const S=f(e,["sessionResumption"]);t!==void 0&&S!=null&&d(t,["setup","sessionResumption"],S);const T=f(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&d(t,["setup","inputAudioTranscription"],T);const E=f(e,["outputAudioTranscription"]);t!==void 0&&E!=null&&d(t,["setup","outputAudioTranscription"],E);const _=f(e,["realtimeInputConfig"]);t!==void 0&&_!=null&&d(t,["setup","realtimeInputConfig"],_);const N=f(e,["contextWindowCompression"]);t!==void 0&&N!=null&&d(t,["setup","contextWindowCompression"],N);const B=f(e,["proactivity"]);return t!==void 0&&B!=null&&d(t,["setup","proactivity"],B),n}function xR(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["setup","model"],De(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],mR(i,n)),n}function vR(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["setup","model"],De(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],gR(i,n)),n}function yR(e){const t={},n=f(e,["musicGenerationConfig"]);return n!=null&&d(t,["musicGenerationConfig"],n),t}function ER(e){const t={},n=f(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),d(t,["weightedPrompts"],r)}return t}function TR(e){const t={},n=f(e,["media"]);if(n!=null){let u=hv(n);Array.isArray(u)&&(u=u.map(c=>Va(c))),d(t,["mediaChunks"],u)}const r=f(e,["audio"]);r!=null&&d(t,["audio"],Va(mv(r)));const i=f(e,["audioStreamEnd"]);i!=null&&d(t,["audioStreamEnd"],i);const s=f(e,["video"]);s!=null&&d(t,["video"],Va(pv(s)));const o=f(e,["text"]);o!=null&&d(t,["text"],o);const a=f(e,["activityStart"]);a!=null&&d(t,["activityStart"],a);const l=f(e,["activityEnd"]);return l!=null&&d(t,["activityEnd"],l),t}function _R(e){const t={},n=f(e,["media"]);if(n!=null){let u=hv(n);Array.isArray(u)&&(u=u.map(c=>c)),d(t,["mediaChunks"],u)}const r=f(e,["audio"]);r!=null&&d(t,["audio"],mv(r));const i=f(e,["audioStreamEnd"]);i!=null&&d(t,["audioStreamEnd"],i);const s=f(e,["video"]);s!=null&&d(t,["video"],pv(s));const o=f(e,["text"]);o!=null&&d(t,["text"],o);const a=f(e,["activityStart"]);a!=null&&d(t,["activityStart"],a);const l=f(e,["activityEnd"]);return l!=null&&d(t,["activityEnd"],l),t}function SR(e){const t={},n=f(e,["setupComplete"]);n!=null&&d(t,["setupComplete"],n);const r=f(e,["serverContent"]);r!=null&&d(t,["serverContent"],r);const i=f(e,["toolCall"]);i!=null&&d(t,["toolCall"],i);const s=f(e,["toolCallCancellation"]);s!=null&&d(t,["toolCallCancellation"],s);const o=f(e,["usageMetadata"]);o!=null&&d(t,["usageMetadata"],IR(o));const a=f(e,["goAway"]);a!=null&&d(t,["goAway"],a);const l=f(e,["sessionResumptionUpdate"]);return l!=null&&d(t,["sessionResumptionUpdate"],l),t}function wR(e){const t={},n=f(e,["mediaResolution"]);n!=null&&d(t,["mediaResolution"],n);const r=f(e,["codeExecutionResult"]);r!=null&&d(t,["codeExecutionResult"],r);const i=f(e,["executableCode"]);i!=null&&d(t,["executableCode"],i);const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],uR(s));const o=f(e,["functionCall"]);o!=null&&d(t,["functionCall"],cR(o));const a=f(e,["functionResponse"]);a!=null&&d(t,["functionResponse"],a);const l=f(e,["inlineData"]);l!=null&&d(t,["inlineData"],Va(l));const u=f(e,["text"]);u!=null&&d(t,["text"],u);const c=f(e,["thought"]);c!=null&&d(t,["thought"],c);const p=f(e,["thoughtSignature"]);p!=null&&d(t,["thoughtSignature"],p);const m=f(e,["videoMetadata"]);return m!=null&&d(t,["videoMetadata"],m),t}function CR(e){const t={},n=f(e,["handle"]);if(n!=null&&d(t,["handle"],n),f(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function Av(e){const t={},n=f(e,["languageCode"]);n!=null&&d(t,["languageCode"],n);const r=f(e,["voiceConfig"]);if(r!=null&&d(t,["voiceConfig"],r),f(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function AR(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(p=>p)),d(t,["functionDeclarations"],c)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearchRetrieval"]);r!=null&&d(t,["googleSearchRetrieval"],r);const i=f(e,["computerUse"]);i!=null&&d(t,["computerUse"],i);const s=f(e,["fileSearch"]);s!=null&&d(t,["fileSearch"],s);const o=f(e,["codeExecution"]);if(o!=null&&d(t,["codeExecution"],o),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=f(e,["googleMaps"]);a!=null&&d(t,["googleMaps"],hR(a));const l=f(e,["googleSearch"]);l!=null&&d(t,["googleSearch"],pR(l));const u=f(e,["urlContext"]);return u!=null&&d(t,["urlContext"],u),t}function NR(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>fR(m))),d(t,["functionDeclarations"],p)}const r=f(e,["retrieval"]);r!=null&&d(t,["retrieval"],r);const i=f(e,["googleSearchRetrieval"]);i!=null&&d(t,["googleSearchRetrieval"],i);const s=f(e,["computerUse"]);if(s!=null&&d(t,["computerUse"],s),f(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=f(e,["codeExecution"]);o!=null&&d(t,["codeExecution"],o);const a=f(e,["enterpriseWebSearch"]);a!=null&&d(t,["enterpriseWebSearch"],a);const l=f(e,["googleMaps"]);l!=null&&d(t,["googleMaps"],l);const u=f(e,["googleSearch"]);u!=null&&d(t,["googleSearch"],u);const c=f(e,["urlContext"]);return c!=null&&d(t,["urlContext"],c),t}function IR(e){const t={},n=f(e,["promptTokenCount"]);n!=null&&d(t,["promptTokenCount"],n);const r=f(e,["cachedContentTokenCount"]);r!=null&&d(t,["cachedContentTokenCount"],r);const i=f(e,["candidatesTokenCount"]);i!=null&&d(t,["responseTokenCount"],i);const s=f(e,["toolUsePromptTokenCount"]);s!=null&&d(t,["toolUsePromptTokenCount"],s);const o=f(e,["thoughtsTokenCount"]);o!=null&&d(t,["thoughtsTokenCount"],o);const a=f(e,["totalTokenCount"]);a!=null&&d(t,["totalTokenCount"],a);const l=f(e,["promptTokensDetails"]);if(l!=null){let g=l;Array.isArray(g)&&(g=g.map(y=>y)),d(t,["promptTokensDetails"],g)}const u=f(e,["cacheTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(y=>y)),d(t,["cacheTokensDetails"],g)}const c=f(e,["candidatesTokensDetails"]);if(c!=null){let g=c;Array.isArray(g)&&(g=g.map(y=>y)),d(t,["responseTokensDetails"],g)}const p=f(e,["toolUsePromptTokensDetails"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(y=>y)),d(t,["toolUsePromptTokensDetails"],g)}const m=f(e,["trafficType"]);return m!=null&&d(t,["trafficType"],m),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kR(e){const t={},n=f(e,["data"]);if(n!=null&&d(t,["data"],n),f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function RR(e){const t={},n=f(e,["content"]);n!=null&&d(t,["content"],n);const r=f(e,["citationMetadata"]);r!=null&&d(t,["citationMetadata"],PR(r));const i=f(e,["tokenCount"]);i!=null&&d(t,["tokenCount"],i);const s=f(e,["finishReason"]);s!=null&&d(t,["finishReason"],s);const o=f(e,["avgLogprobs"]);o!=null&&d(t,["avgLogprobs"],o);const a=f(e,["groundingMetadata"]);a!=null&&d(t,["groundingMetadata"],a);const l=f(e,["index"]);l!=null&&d(t,["index"],l);const u=f(e,["logprobsResult"]);u!=null&&d(t,["logprobsResult"],u);const c=f(e,["safetyRatings"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(g=>g)),d(t,["safetyRatings"],m)}const p=f(e,["urlContextMetadata"]);return p!=null&&d(t,["urlContextMetadata"],p),t}function PR(e){const t={},n=f(e,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),d(t,["citations"],r)}return t}function FR(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["contents"]);if(i!=null){let s=Cn(i);Array.isArray(s)&&(s=s.map(o=>o)),d(n,["contents"],s)}return n}function MR(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),d(t,["tokensInfo"],i)}return t}function bR(e){const t={},n=f(e,["values"]);n!=null&&d(t,["values"],n);const r=f(e,["statistics"]);return r!=null&&d(t,["statistics"],DR(r)),t}function DR(e){const t={},n=f(e,["truncated"]);n!=null&&d(t,["truncated"],n);const r=f(e,["token_count"]);return r!=null&&d(t,["tokenCount"],r),t}function ou(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>z3(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function LR(e){const t={},n=f(e,["controlType"]);n!=null&&d(t,["controlType"],n);const r=f(e,["enableControlImageComputation"]);return r!=null&&d(t,["computeControl"],r),t}function OR(e){const t={};if(f(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(f(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(f(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function UR(e,t){const n={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&d(t,["systemInstruction"],bt(r));const i=f(e,["tools"]);if(t!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>Pv(a))),d(t,["tools"],o)}const s=f(e,["generationConfig"]);return t!==void 0&&s!=null&&d(t,["generationConfig"],k3(s)),n}function BR(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["contents"]);if(i!=null){let o=Cn(i);Array.isArray(o)&&(o=o.map(a=>ou(a))),d(n,["contents"],o)}const s=f(t,["config"]);return s!=null&&OR(s),n}function GR(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["contents"]);if(i!=null){let o=Cn(i);Array.isArray(o)&&(o=o.map(a=>a)),d(n,["contents"],o)}const s=f(t,["config"]);return s!=null&&UR(s,n),n}function VR(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["totalTokens"]);r!=null&&d(t,["totalTokens"],r);const i=f(e,["cachedContentTokenCount"]);return i!=null&&d(t,["cachedContentTokenCount"],i),t}function HR(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["totalTokens"]);return r!=null&&d(t,["totalTokens"],r),t}function $R(e,t){const n={},r=f(t,["model"]);return r!=null&&d(n,["_url","name"],De(e,r)),n}function zR(e,t){const n={},r=f(t,["model"]);return r!=null&&d(n,["_url","name"],De(e,r)),n}function jR(e){const t={},n=f(e,["sdkHttpResponse"]);return n!=null&&d(t,["sdkHttpResponse"],n),t}function WR(e){const t={},n=f(e,["sdkHttpResponse"]);return n!=null&&d(t,["sdkHttpResponse"],n),t}function qR(e,t){const n={},r=f(e,["outputGcsUri"]);t!==void 0&&r!=null&&d(t,["parameters","storageUri"],r);const i=f(e,["negativePrompt"]);t!==void 0&&i!=null&&d(t,["parameters","negativePrompt"],i);const s=f(e,["numberOfImages"]);t!==void 0&&s!=null&&d(t,["parameters","sampleCount"],s);const o=f(e,["aspectRatio"]);t!==void 0&&o!=null&&d(t,["parameters","aspectRatio"],o);const a=f(e,["guidanceScale"]);t!==void 0&&a!=null&&d(t,["parameters","guidanceScale"],a);const l=f(e,["seed"]);t!==void 0&&l!=null&&d(t,["parameters","seed"],l);const u=f(e,["safetyFilterLevel"]);t!==void 0&&u!=null&&d(t,["parameters","safetySetting"],u);const c=f(e,["personGeneration"]);t!==void 0&&c!=null&&d(t,["parameters","personGeneration"],c);const p=f(e,["includeSafetyAttributes"]);t!==void 0&&p!=null&&d(t,["parameters","includeSafetyAttributes"],p);const m=f(e,["includeRaiReason"]);t!==void 0&&m!=null&&d(t,["parameters","includeRaiReason"],m);const g=f(e,["language"]);t!==void 0&&g!=null&&d(t,["parameters","language"],g);const y=f(e,["outputMimeType"]);t!==void 0&&y!=null&&d(t,["parameters","outputOptions","mimeType"],y);const x=f(e,["outputCompressionQuality"]);t!==void 0&&x!=null&&d(t,["parameters","outputOptions","compressionQuality"],x);const S=f(e,["addWatermark"]);t!==void 0&&S!=null&&d(t,["parameters","addWatermark"],S);const T=f(e,["labels"]);t!==void 0&&T!=null&&d(t,["labels"],T);const E=f(e,["editMode"]);t!==void 0&&E!=null&&d(t,["parameters","editMode"],E);const _=f(e,["baseSteps"]);return t!==void 0&&_!=null&&d(t,["parameters","editConfig","baseSteps"],_),n}function JR(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["prompt"]);i!=null&&d(n,["instances[0]","prompt"],i);const s=f(t,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>Y3(l))),d(n,["instances[0]","referenceImages"],a)}const o=f(t,["config"]);return o!=null&&qR(o,n),n}function KR(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>au(s))),d(t,["generatedImages"],i)}return t}function YR(e,t){const n={},r=f(e,["taskType"]);t!==void 0&&r!=null&&d(t,["requests[]","taskType"],r);const i=f(e,["title"]);t!==void 0&&i!=null&&d(t,["requests[]","title"],i);const s=f(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&d(t,["requests[]","outputDimensionality"],s),f(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function XR(e,t){const n={},r=f(e,["taskType"]);t!==void 0&&r!=null&&d(t,["instances[]","task_type"],r);const i=f(e,["title"]);t!==void 0&&i!=null&&d(t,["instances[]","title"],i);const s=f(e,["outputDimensionality"]);t!==void 0&&s!=null&&d(t,["parameters","outputDimensionality"],s);const o=f(e,["mimeType"]);t!==void 0&&o!=null&&d(t,["instances[]","mimeType"],o);const a=f(e,["autoTruncate"]);return t!==void 0&&a!=null&&d(t,["parameters","autoTruncate"],a),n}function QR(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["contents"]);if(i!=null){let a=Rd(e,i);Array.isArray(a)&&(a=a.map(l=>l)),d(n,["requests[]","content"],a)}const s=f(t,["config"]);s!=null&&YR(s,n);const o=f(t,["model"]);return o!==void 0&&d(n,["requests[]","model"],De(e,o)),n}function ZR(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["contents"]);if(i!=null){let o=Rd(e,i);Array.isArray(o)&&(o=o.map(a=>a)),d(n,["instances[]","content"],o)}const s=f(t,["config"]);return s!=null&&XR(s,n),n}function e3(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),d(t,["embeddings"],s)}const i=f(e,["metadata"]);return i!=null&&d(t,["metadata"],i),t}function t3(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>bR(o))),d(t,["embeddings"],s)}const i=f(e,["metadata"]);return i!=null&&d(t,["metadata"],i),t}function n3(e){const t={},n=f(e,["endpoint"]);n!=null&&d(t,["name"],n);const r=f(e,["deployedModelId"]);return r!=null&&d(t,["deployedModelId"],r),t}function r3(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function i3(e){const t={},n=f(e,["id"]);n!=null&&d(t,["id"],n);const r=f(e,["args"]);r!=null&&d(t,["args"],r);const i=f(e,["name"]);if(i!=null&&d(t,["name"],i),f(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function s3(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);if(r!=null&&d(t,["allowedFunctionNames"],r),f(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function o3(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&d(t,["description"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const i=f(e,["parameters"]);i!=null&&d(t,["parameters"],i);const s=f(e,["parametersJsonSchema"]);s!=null&&d(t,["parametersJsonSchema"],s);const o=f(e,["response"]);o!=null&&d(t,["response"],o);const a=f(e,["responseJsonSchema"]);return a!=null&&d(t,["responseJsonSchema"],a),t}function a3(e,t,n){const r={},i=f(t,["systemInstruction"]);n!==void 0&&i!=null&&d(n,["systemInstruction"],ou(bt(i)));const s=f(t,["temperature"]);s!=null&&d(r,["temperature"],s);const o=f(t,["topP"]);o!=null&&d(r,["topP"],o);const a=f(t,["topK"]);a!=null&&d(r,["topK"],a);const l=f(t,["candidateCount"]);l!=null&&d(r,["candidateCount"],l);const u=f(t,["maxOutputTokens"]);u!=null&&d(r,["maxOutputTokens"],u);const c=f(t,["stopSequences"]);c!=null&&d(r,["stopSequences"],c);const p=f(t,["responseLogprobs"]);p!=null&&d(r,["responseLogprobs"],p);const m=f(t,["logprobs"]);m!=null&&d(r,["logprobs"],m);const g=f(t,["presencePenalty"]);g!=null&&d(r,["presencePenalty"],g);const y=f(t,["frequencyPenalty"]);y!=null&&d(r,["frequencyPenalty"],y);const x=f(t,["seed"]);x!=null&&d(r,["seed"],x);const S=f(t,["responseMimeType"]);S!=null&&d(r,["responseMimeType"],S);const T=f(t,["responseSchema"]);T!=null&&d(r,["responseSchema"],Pd(T));const E=f(t,["responseJsonSchema"]);if(E!=null&&d(r,["responseJsonSchema"],E),f(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=f(t,["safetySettings"]);if(n!==void 0&&_!=null){let X=_;Array.isArray(X)&&(X=X.map(re=>X3(re))),d(n,["safetySettings"],X)}const N=f(t,["tools"]);if(n!==void 0&&N!=null){let X=Ts(N);Array.isArray(X)&&(X=X.map(re=>iP(Es(re)))),d(n,["tools"],X)}const B=f(t,["toolConfig"]);if(n!==void 0&&B!=null&&d(n,["toolConfig"],rP(B)),f(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const G=f(t,["cachedContent"]);n!==void 0&&G!=null&&d(n,["cachedContent"],yr(e,G));const k=f(t,["responseModalities"]);k!=null&&d(r,["responseModalities"],k);const D=f(t,["mediaResolution"]);D!=null&&d(r,["mediaResolution"],D);const b=f(t,["speechConfig"]);if(b!=null&&d(r,["speechConfig"],Fd(b)),f(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const O=f(t,["thinkingConfig"]);O!=null&&d(r,["thinkingConfig"],O);const J=f(t,["imageConfig"]);return J!=null&&d(r,["imageConfig"],b3(J)),r}function l3(e,t,n){const r={},i=f(t,["systemInstruction"]);n!==void 0&&i!=null&&d(n,["systemInstruction"],bt(i));const s=f(t,["temperature"]);s!=null&&d(r,["temperature"],s);const o=f(t,["topP"]);o!=null&&d(r,["topP"],o);const a=f(t,["topK"]);a!=null&&d(r,["topK"],a);const l=f(t,["candidateCount"]);l!=null&&d(r,["candidateCount"],l);const u=f(t,["maxOutputTokens"]);u!=null&&d(r,["maxOutputTokens"],u);const c=f(t,["stopSequences"]);c!=null&&d(r,["stopSequences"],c);const p=f(t,["responseLogprobs"]);p!=null&&d(r,["responseLogprobs"],p);const m=f(t,["logprobs"]);m!=null&&d(r,["logprobs"],m);const g=f(t,["presencePenalty"]);g!=null&&d(r,["presencePenalty"],g);const y=f(t,["frequencyPenalty"]);y!=null&&d(r,["frequencyPenalty"],y);const x=f(t,["seed"]);x!=null&&d(r,["seed"],x);const S=f(t,["responseMimeType"]);S!=null&&d(r,["responseMimeType"],S);const T=f(t,["responseSchema"]);T!=null&&d(r,["responseSchema"],Pd(T));const E=f(t,["responseJsonSchema"]);E!=null&&d(r,["responseJsonSchema"],E);const _=f(t,["routingConfig"]);_!=null&&d(r,["routingConfig"],_);const N=f(t,["modelSelectionConfig"]);N!=null&&d(r,["modelConfig"],N);const B=f(t,["safetySettings"]);if(n!==void 0&&B!=null){let Ne=B;Array.isArray(Ne)&&(Ne=Ne.map(ge=>ge)),d(n,["safetySettings"],Ne)}const G=f(t,["tools"]);if(n!==void 0&&G!=null){let Ne=Ts(G);Array.isArray(Ne)&&(Ne=Ne.map(ge=>Pv(Es(ge)))),d(n,["tools"],Ne)}const k=f(t,["toolConfig"]);n!==void 0&&k!=null&&d(n,["toolConfig"],k);const D=f(t,["labels"]);n!==void 0&&D!=null&&d(n,["labels"],D);const b=f(t,["cachedContent"]);n!==void 0&&b!=null&&d(n,["cachedContent"],yr(e,b));const O=f(t,["responseModalities"]);O!=null&&d(r,["responseModalities"],O);const J=f(t,["mediaResolution"]);J!=null&&d(r,["mediaResolution"],J);const X=f(t,["speechConfig"]);X!=null&&d(r,["speechConfig"],Rv(Fd(X)));const re=f(t,["audioTimestamp"]);re!=null&&d(r,["audioTimestamp"],re);const we=f(t,["thinkingConfig"]);we!=null&&d(r,["thinkingConfig"],we);const _e=f(t,["imageConfig"]);return _e!=null&&d(r,["imageConfig"],D3(_e)),r}function tm(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["contents"]);if(i!=null){let o=Cn(i);Array.isArray(o)&&(o=o.map(a=>ou(a))),d(n,["contents"],o)}const s=f(t,["config"]);return s!=null&&d(n,["generationConfig"],a3(e,s,n)),n}function nm(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["contents"]);if(i!=null){let o=Cn(i);Array.isArray(o)&&(o=o.map(a=>a)),d(n,["contents"],o)}const s=f(t,["config"]);return s!=null&&d(n,["generationConfig"],l3(e,s,n)),n}function rm(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>RR(u))),d(t,["candidates"],l)}const i=f(e,["modelVersion"]);i!=null&&d(t,["modelVersion"],i);const s=f(e,["promptFeedback"]);s!=null&&d(t,["promptFeedback"],s);const o=f(e,["responseId"]);o!=null&&d(t,["responseId"],o);const a=f(e,["usageMetadata"]);return a!=null&&d(t,["usageMetadata"],a),t}function im(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>c)),d(t,["candidates"],u)}const i=f(e,["createTime"]);i!=null&&d(t,["createTime"],i);const s=f(e,["modelVersion"]);s!=null&&d(t,["modelVersion"],s);const o=f(e,["promptFeedback"]);o!=null&&d(t,["promptFeedback"],o);const a=f(e,["responseId"]);a!=null&&d(t,["responseId"],a);const l=f(e,["usageMetadata"]);return l!=null&&d(t,["usageMetadata"],l),t}function u3(e,t){const n={};if(f(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=f(e,["numberOfImages"]);t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r);const i=f(e,["aspectRatio"]);t!==void 0&&i!=null&&d(t,["parameters","aspectRatio"],i);const s=f(e,["guidanceScale"]);if(t!==void 0&&s!=null&&d(t,["parameters","guidanceScale"],s),f(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=f(e,["safetyFilterLevel"]);t!==void 0&&o!=null&&d(t,["parameters","safetySetting"],o);const a=f(e,["personGeneration"]);t!==void 0&&a!=null&&d(t,["parameters","personGeneration"],a);const l=f(e,["includeSafetyAttributes"]);t!==void 0&&l!=null&&d(t,["parameters","includeSafetyAttributes"],l);const u=f(e,["includeRaiReason"]);t!==void 0&&u!=null&&d(t,["parameters","includeRaiReason"],u);const c=f(e,["language"]);t!==void 0&&c!=null&&d(t,["parameters","language"],c);const p=f(e,["outputMimeType"]);t!==void 0&&p!=null&&d(t,["parameters","outputOptions","mimeType"],p);const m=f(e,["outputCompressionQuality"]);if(t!==void 0&&m!=null&&d(t,["parameters","outputOptions","compressionQuality"],m),f(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const g=f(e,["imageSize"]);if(t!==void 0&&g!=null&&d(t,["parameters","sampleImageSize"],g),f(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function c3(e,t){const n={},r=f(e,["outputGcsUri"]);t!==void 0&&r!=null&&d(t,["parameters","storageUri"],r);const i=f(e,["negativePrompt"]);t!==void 0&&i!=null&&d(t,["parameters","negativePrompt"],i);const s=f(e,["numberOfImages"]);t!==void 0&&s!=null&&d(t,["parameters","sampleCount"],s);const o=f(e,["aspectRatio"]);t!==void 0&&o!=null&&d(t,["parameters","aspectRatio"],o);const a=f(e,["guidanceScale"]);t!==void 0&&a!=null&&d(t,["parameters","guidanceScale"],a);const l=f(e,["seed"]);t!==void 0&&l!=null&&d(t,["parameters","seed"],l);const u=f(e,["safetyFilterLevel"]);t!==void 0&&u!=null&&d(t,["parameters","safetySetting"],u);const c=f(e,["personGeneration"]);t!==void 0&&c!=null&&d(t,["parameters","personGeneration"],c);const p=f(e,["includeSafetyAttributes"]);t!==void 0&&p!=null&&d(t,["parameters","includeSafetyAttributes"],p);const m=f(e,["includeRaiReason"]);t!==void 0&&m!=null&&d(t,["parameters","includeRaiReason"],m);const g=f(e,["language"]);t!==void 0&&g!=null&&d(t,["parameters","language"],g);const y=f(e,["outputMimeType"]);t!==void 0&&y!=null&&d(t,["parameters","outputOptions","mimeType"],y);const x=f(e,["outputCompressionQuality"]);t!==void 0&&x!=null&&d(t,["parameters","outputOptions","compressionQuality"],x);const S=f(e,["addWatermark"]);t!==void 0&&S!=null&&d(t,["parameters","addWatermark"],S);const T=f(e,["labels"]);t!==void 0&&T!=null&&d(t,["labels"],T);const E=f(e,["imageSize"]);t!==void 0&&E!=null&&d(t,["parameters","sampleImageSize"],E);const _=f(e,["enhancePrompt"]);return t!==void 0&&_!=null&&d(t,["parameters","enhancePrompt"],_),n}function f3(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["prompt"]);i!=null&&d(n,["instances[0]","prompt"],i);const s=f(t,["config"]);return s!=null&&u3(s,n),n}function d3(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["prompt"]);i!=null&&d(n,["instances[0]","prompt"],i);const s=f(t,["config"]);return s!=null&&c3(s,n),n}function h3(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>C3(o))),d(t,["generatedImages"],s)}const i=f(e,["positivePromptSafetyAttributes"]);return i!=null&&d(t,["positivePromptSafetyAttributes"],Iv(i)),t}function p3(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>au(o))),d(t,["generatedImages"],s)}const i=f(e,["positivePromptSafetyAttributes"]);return i!=null&&d(t,["positivePromptSafetyAttributes"],kv(i)),t}function m3(e,t){const n={},r=f(e,["numberOfVideos"]);if(t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r),f(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=f(e,["durationSeconds"]);if(t!==void 0&&i!=null&&d(t,["parameters","durationSeconds"],i),f(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=f(e,["aspectRatio"]);t!==void 0&&s!=null&&d(t,["parameters","aspectRatio"],s);const o=f(e,["resolution"]);t!==void 0&&o!=null&&d(t,["parameters","resolution"],o);const a=f(e,["personGeneration"]);if(t!==void 0&&a!=null&&d(t,["parameters","personGeneration"],a),f(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=f(e,["negativePrompt"]);t!==void 0&&l!=null&&d(t,["parameters","negativePrompt"],l);const u=f(e,["enhancePrompt"]);if(t!==void 0&&u!=null&&d(t,["parameters","enhancePrompt"],u),f(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const c=f(e,["lastFrame"]);t!==void 0&&c!=null&&d(t,["instances[0]","lastFrame"],lu(c));const p=f(e,["referenceImages"]);if(t!==void 0&&p!=null){let m=p;Array.isArray(m)&&(m=m.map(g=>xP(g))),d(t,["instances[0]","referenceImages"],m)}if(f(e,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(f(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function g3(e,t){const n={},r=f(e,["numberOfVideos"]);t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r);const i=f(e,["outputGcsUri"]);t!==void 0&&i!=null&&d(t,["parameters","storageUri"],i);const s=f(e,["fps"]);t!==void 0&&s!=null&&d(t,["parameters","fps"],s);const o=f(e,["durationSeconds"]);t!==void 0&&o!=null&&d(t,["parameters","durationSeconds"],o);const a=f(e,["seed"]);t!==void 0&&a!=null&&d(t,["parameters","seed"],a);const l=f(e,["aspectRatio"]);t!==void 0&&l!=null&&d(t,["parameters","aspectRatio"],l);const u=f(e,["resolution"]);t!==void 0&&u!=null&&d(t,["parameters","resolution"],u);const c=f(e,["personGeneration"]);t!==void 0&&c!=null&&d(t,["parameters","personGeneration"],c);const p=f(e,["pubsubTopic"]);t!==void 0&&p!=null&&d(t,["parameters","pubsubTopic"],p);const m=f(e,["negativePrompt"]);t!==void 0&&m!=null&&d(t,["parameters","negativePrompt"],m);const g=f(e,["enhancePrompt"]);t!==void 0&&g!=null&&d(t,["parameters","enhancePrompt"],g);const y=f(e,["generateAudio"]);t!==void 0&&y!=null&&d(t,["parameters","generateAudio"],y);const x=f(e,["lastFrame"]);t!==void 0&&x!=null&&d(t,["instances[0]","lastFrame"],$n(x));const S=f(e,["referenceImages"]);if(t!==void 0&&S!=null){let _=S;Array.isArray(_)&&(_=_.map(N=>vP(N))),d(t,["instances[0]","referenceImages"],_)}const T=f(e,["mask"]);t!==void 0&&T!=null&&d(t,["instances[0]","mask"],gP(T));const E=f(e,["compressionQuality"]);return t!==void 0&&E!=null&&d(t,["parameters","compressionQuality"],E),n}function x3(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const i=f(e,["done"]);i!=null&&d(t,["done"],i);const s=f(e,["error"]);s!=null&&d(t,["error"],s);const o=f(e,["response","generateVideoResponse"]);return o!=null&&d(t,["response"],T3(o)),t}function v3(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const i=f(e,["done"]);i!=null&&d(t,["done"],i);const s=f(e,["error"]);s!=null&&d(t,["error"],s);const o=f(e,["response"]);return o!=null&&d(t,["response"],_3(o)),t}function y3(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["prompt"]);i!=null&&d(n,["instances[0]","prompt"],i);const s=f(t,["image"]);s!=null&&d(n,["instances[0]","image"],lu(s));const o=f(t,["video"]);o!=null&&d(n,["instances[0]","video"],Fv(o));const a=f(t,["source"]);a!=null&&S3(a,n);const l=f(t,["config"]);return l!=null&&m3(l,n),n}function E3(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["prompt"]);i!=null&&d(n,["instances[0]","prompt"],i);const s=f(t,["image"]);s!=null&&d(n,["instances[0]","image"],$n(s));const o=f(t,["video"]);o!=null&&d(n,["instances[0]","video"],Mv(o));const a=f(t,["source"]);a!=null&&w3(a,n);const l=f(t,["config"]);return l!=null&&g3(l,n),n}function T3(e){const t={},n=f(e,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>N3(o))),d(t,["generatedVideos"],s)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const i=f(e,["raiMediaFilteredReasons"]);return i!=null&&d(t,["raiMediaFilteredReasons"],i),t}function _3(e){const t={},n=f(e,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>I3(o))),d(t,["generatedVideos"],s)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const i=f(e,["raiMediaFilteredReasons"]);return i!=null&&d(t,["raiMediaFilteredReasons"],i),t}function S3(e,t){const n={},r=f(e,["prompt"]);t!==void 0&&r!=null&&d(t,["instances[0]","prompt"],r);const i=f(e,["image"]);t!==void 0&&i!=null&&d(t,["instances[0]","image"],lu(i));const s=f(e,["video"]);return t!==void 0&&s!=null&&d(t,["instances[0]","video"],Fv(s)),n}function w3(e,t){const n={},r=f(e,["prompt"]);t!==void 0&&r!=null&&d(t,["instances[0]","prompt"],r);const i=f(e,["image"]);t!==void 0&&i!=null&&d(t,["instances[0]","image"],$n(i));const s=f(e,["video"]);return t!==void 0&&s!=null&&d(t,["instances[0]","video"],Mv(s)),n}function C3(e){const t={},n=f(e,["_self"]);n!=null&&d(t,["image"],L3(n));const r=f(e,["raiFilteredReason"]);r!=null&&d(t,["raiFilteredReason"],r);const i=f(e,["_self"]);return i!=null&&d(t,["safetyAttributes"],Iv(i)),t}function au(e){const t={},n=f(e,["_self"]);n!=null&&d(t,["image"],Nv(n));const r=f(e,["raiFilteredReason"]);r!=null&&d(t,["raiFilteredReason"],r);const i=f(e,["_self"]);i!=null&&d(t,["safetyAttributes"],kv(i));const s=f(e,["prompt"]);return s!=null&&d(t,["enhancedPrompt"],s),t}function A3(e){const t={},n=f(e,["_self"]);n!=null&&d(t,["mask"],Nv(n));const r=f(e,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),d(t,["labels"],i)}return t}function N3(e){const t={},n=f(e,["video"]);return n!=null&&d(t,["video"],pP(n)),t}function I3(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],mP(n)),t}function k3(e){const t={},n=f(e,["modelSelectionConfig"]);n!=null&&d(t,["modelConfig"],n);const r=f(e,["responseJsonSchema"]);r!=null&&d(t,["responseJsonSchema"],r);const i=f(e,["audioTimestamp"]);i!=null&&d(t,["audioTimestamp"],i);const s=f(e,["candidateCount"]);s!=null&&d(t,["candidateCount"],s);const o=f(e,["enableAffectiveDialog"]);o!=null&&d(t,["enableAffectiveDialog"],o);const a=f(e,["frequencyPenalty"]);a!=null&&d(t,["frequencyPenalty"],a);const l=f(e,["logprobs"]);l!=null&&d(t,["logprobs"],l);const u=f(e,["maxOutputTokens"]);u!=null&&d(t,["maxOutputTokens"],u);const c=f(e,["mediaResolution"]);c!=null&&d(t,["mediaResolution"],c);const p=f(e,["presencePenalty"]);p!=null&&d(t,["presencePenalty"],p);const m=f(e,["responseLogprobs"]);m!=null&&d(t,["responseLogprobs"],m);const g=f(e,["responseMimeType"]);g!=null&&d(t,["responseMimeType"],g);const y=f(e,["responseModalities"]);y!=null&&d(t,["responseModalities"],y);const x=f(e,["responseSchema"]);x!=null&&d(t,["responseSchema"],x);const S=f(e,["routingConfig"]);S!=null&&d(t,["routingConfig"],S);const T=f(e,["seed"]);T!=null&&d(t,["seed"],T);const E=f(e,["speechConfig"]);E!=null&&d(t,["speechConfig"],Rv(E));const _=f(e,["stopSequences"]);_!=null&&d(t,["stopSequences"],_);const N=f(e,["temperature"]);N!=null&&d(t,["temperature"],N);const B=f(e,["thinkingConfig"]);B!=null&&d(t,["thinkingConfig"],B);const G=f(e,["topK"]);G!=null&&d(t,["topK"],G);const k=f(e,["topP"]);if(k!=null&&d(t,["topP"],k),f(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function R3(e,t){const n={},r=f(t,["model"]);return r!=null&&d(n,["_url","name"],De(e,r)),n}function P3(e,t){const n={},r=f(t,["model"]);return r!=null&&d(n,["_url","name"],De(e,r)),n}function F3(e){const t={};if(f(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=f(e,["enableWidget"]);return n!=null&&d(t,["enableWidget"],n),t}function M3(e){const t={};if(f(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],n),t}function b3(e){const t={},n=f(e,["aspectRatio"]);n!=null&&d(t,["aspectRatio"],n);const r=f(e,["imageSize"]);if(r!=null&&d(t,["imageSize"],r),f(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function D3(e){const t={},n=f(e,["aspectRatio"]);n!=null&&d(t,["aspectRatio"],n);const r=f(e,["imageSize"]);r!=null&&d(t,["imageSize"],r);const i=f(e,["outputMimeType"]);i!=null&&d(t,["imageOutputOptions","mimeType"],i);const s=f(e,["outputCompressionQuality"]);return s!=null&&d(t,["imageOutputOptions","compressionQuality"],s),t}function L3(e){const t={},n=f(e,["bytesBase64Encoded"]);n!=null&&d(t,["imageBytes"],Yr(n));const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Nv(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["gcsUri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&d(t,["imageBytes"],Yr(r));const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function lu(e){const t={};if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=f(e,["imageBytes"]);n!=null&&d(t,["bytesBase64Encoded"],Yr(n));const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function $n(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["gcsUri"],n);const r=f(e,["imageBytes"]);r!=null&&d(t,["bytesBase64Encoded"],Yr(r));const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function O3(e,t,n){const r={},i=f(t,["pageSize"]);n!==void 0&&i!=null&&d(n,["_query","pageSize"],i);const s=f(t,["pageToken"]);n!==void 0&&s!=null&&d(n,["_query","pageToken"],s);const o=f(t,["filter"]);n!==void 0&&o!=null&&d(n,["_query","filter"],o);const a=f(t,["queryBase"]);return n!==void 0&&a!=null&&d(n,["_url","models_url"],yv(e,a)),r}function U3(e,t,n){const r={},i=f(t,["pageSize"]);n!==void 0&&i!=null&&d(n,["_query","pageSize"],i);const s=f(t,["pageToken"]);n!==void 0&&s!=null&&d(n,["_query","pageToken"],s);const o=f(t,["filter"]);n!==void 0&&o!=null&&d(n,["_query","filter"],o);const a=f(t,["queryBase"]);return n!==void 0&&a!=null&&d(n,["_url","models_url"],yv(e,a)),r}function B3(e,t){const n={},r=f(t,["config"]);return r!=null&&O3(e,r,n),n}function G3(e,t){const n={},r=f(t,["config"]);return r!=null&&U3(e,r,n),n}function V3(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["_self"]);if(i!=null){let s=Ev(i);Array.isArray(s)&&(s=s.map(o=>lf(o))),d(t,["models"],s)}return t}function H3(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["_self"]);if(i!=null){let s=Ev(i);Array.isArray(s)&&(s=s.map(o=>uf(o))),d(t,["models"],s)}return t}function $3(e){const t={},n=f(e,["maskMode"]);n!=null&&d(t,["maskMode"],n);const r=f(e,["segmentationClasses"]);r!=null&&d(t,["maskClasses"],r);const i=f(e,["maskDilation"]);return i!=null&&d(t,["dilation"],i),t}function lf(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const i=f(e,["description"]);i!=null&&d(t,["description"],i);const s=f(e,["version"]);s!=null&&d(t,["version"],s);const o=f(e,["_self"]);o!=null&&d(t,["tunedModelInfo"],sP(o));const a=f(e,["inputTokenLimit"]);a!=null&&d(t,["inputTokenLimit"],a);const l=f(e,["outputTokenLimit"]);l!=null&&d(t,["outputTokenLimit"],l);const u=f(e,["supportedGenerationMethods"]);u!=null&&d(t,["supportedActions"],u);const c=f(e,["temperature"]);c!=null&&d(t,["temperature"],c);const p=f(e,["maxTemperature"]);p!=null&&d(t,["maxTemperature"],p);const m=f(e,["topP"]);m!=null&&d(t,["topP"],m);const g=f(e,["topK"]);g!=null&&d(t,["topK"],g);const y=f(e,["thinking"]);return y!=null&&d(t,["thinking"],y),t}function uf(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const i=f(e,["description"]);i!=null&&d(t,["description"],i);const s=f(e,["versionId"]);s!=null&&d(t,["version"],s);const o=f(e,["deployedModels"]);if(o!=null){let p=o;Array.isArray(p)&&(p=p.map(m=>n3(m))),d(t,["endpoints"],p)}const a=f(e,["labels"]);a!=null&&d(t,["labels"],a);const l=f(e,["_self"]);l!=null&&d(t,["tunedModelInfo"],oP(l));const u=f(e,["defaultCheckpointId"]);u!=null&&d(t,["defaultCheckpointId"],u);const c=f(e,["checkpoints"]);if(c!=null){let p=c;Array.isArray(p)&&(p=p.map(m=>m)),d(t,["checkpoints"],p)}return t}function z3(e){const t={},n=f(e,["mediaResolution"]);n!=null&&d(t,["mediaResolution"],n);const r=f(e,["codeExecutionResult"]);r!=null&&d(t,["codeExecutionResult"],r);const i=f(e,["executableCode"]);i!=null&&d(t,["executableCode"],i);const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],r3(s));const o=f(e,["functionCall"]);o!=null&&d(t,["functionCall"],i3(o));const a=f(e,["functionResponse"]);a!=null&&d(t,["functionResponse"],a);const l=f(e,["inlineData"]);l!=null&&d(t,["inlineData"],kR(l));const u=f(e,["text"]);u!=null&&d(t,["text"],u);const c=f(e,["thought"]);c!=null&&d(t,["thought"],c);const p=f(e,["thoughtSignature"]);p!=null&&d(t,["thoughtSignature"],p);const m=f(e,["videoMetadata"]);return m!=null&&d(t,["videoMetadata"],m),t}function j3(e){const t={},n=f(e,["productImage"]);return n!=null&&d(t,["image"],$n(n)),t}function W3(e,t){const n={},r=f(e,["numberOfImages"]);t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r);const i=f(e,["baseSteps"]);t!==void 0&&i!=null&&d(t,["parameters","baseSteps"],i);const s=f(e,["outputGcsUri"]);t!==void 0&&s!=null&&d(t,["parameters","storageUri"],s);const o=f(e,["seed"]);t!==void 0&&o!=null&&d(t,["parameters","seed"],o);const a=f(e,["safetyFilterLevel"]);t!==void 0&&a!=null&&d(t,["parameters","safetySetting"],a);const l=f(e,["personGeneration"]);t!==void 0&&l!=null&&d(t,["parameters","personGeneration"],l);const u=f(e,["addWatermark"]);t!==void 0&&u!=null&&d(t,["parameters","addWatermark"],u);const c=f(e,["outputMimeType"]);t!==void 0&&c!=null&&d(t,["parameters","outputOptions","mimeType"],c);const p=f(e,["outputCompressionQuality"]);t!==void 0&&p!=null&&d(t,["parameters","outputOptions","compressionQuality"],p);const m=f(e,["enhancePrompt"]);t!==void 0&&m!=null&&d(t,["parameters","enhancePrompt"],m);const g=f(e,["labels"]);return t!==void 0&&g!=null&&d(t,["labels"],g),n}function q3(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["source"]);i!=null&&K3(i,n);const s=f(t,["config"]);return s!=null&&W3(s,n),n}function J3(e){const t={},n=f(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>au(i))),d(t,["generatedImages"],r)}return t}function K3(e,t){const n={},r=f(e,["prompt"]);t!==void 0&&r!=null&&d(t,["instances[0]","prompt"],r);const i=f(e,["personImage"]);t!==void 0&&i!=null&&d(t,["instances[0]","personImage","image"],$n(i));const s=f(e,["productImages"]);if(t!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>j3(a))),d(t,["instances[0]","productImages"],o)}return n}function Y3(e){const t={},n=f(e,["referenceImage"]);n!=null&&d(t,["referenceImage"],$n(n));const r=f(e,["referenceId"]);r!=null&&d(t,["referenceId"],r);const i=f(e,["referenceType"]);i!=null&&d(t,["referenceType"],i);const s=f(e,["maskImageConfig"]);s!=null&&d(t,["maskImageConfig"],$3(s));const o=f(e,["controlImageConfig"]);o!=null&&d(t,["controlImageConfig"],LR(o));const a=f(e,["styleImageConfig"]);a!=null&&d(t,["styleImageConfig"],a);const l=f(e,["subjectImageConfig"]);return l!=null&&d(t,["subjectImageConfig"],l),t}function Iv(e){const t={},n=f(e,["safetyAttributes","categories"]);n!=null&&d(t,["categories"],n);const r=f(e,["safetyAttributes","scores"]);r!=null&&d(t,["scores"],r);const i=f(e,["contentType"]);return i!=null&&d(t,["contentType"],i),t}function kv(e){const t={},n=f(e,["safetyAttributes","categories"]);n!=null&&d(t,["categories"],n);const r=f(e,["safetyAttributes","scores"]);r!=null&&d(t,["scores"],r);const i=f(e,["contentType"]);return i!=null&&d(t,["contentType"],i),t}function X3(e){const t={},n=f(e,["category"]);if(n!=null&&d(t,["category"],n),f(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=f(e,["threshold"]);return r!=null&&d(t,["threshold"],r),t}function Q3(e){const t={},n=f(e,["image"]);return n!=null&&d(t,["image"],$n(n)),t}function Z3(e,t){const n={},r=f(e,["mode"]);t!==void 0&&r!=null&&d(t,["parameters","mode"],r);const i=f(e,["maxPredictions"]);t!==void 0&&i!=null&&d(t,["parameters","maxPredictions"],i);const s=f(e,["confidenceThreshold"]);t!==void 0&&s!=null&&d(t,["parameters","confidenceThreshold"],s);const o=f(e,["maskDilation"]);t!==void 0&&o!=null&&d(t,["parameters","maskDilation"],o);const a=f(e,["binaryColorThreshold"]);t!==void 0&&a!=null&&d(t,["parameters","binaryColorThreshold"],a);const l=f(e,["labels"]);return t!==void 0&&l!=null&&d(t,["labels"],l),n}function eP(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["source"]);i!=null&&nP(i,n);const s=f(t,["config"]);return s!=null&&Z3(s,n),n}function tP(e){const t={},n=f(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>A3(i))),d(t,["generatedMasks"],r)}return t}function nP(e,t){const n={},r=f(e,["prompt"]);t!==void 0&&r!=null&&d(t,["instances[0]","prompt"],r);const i=f(e,["image"]);t!==void 0&&i!=null&&d(t,["instances[0]","image"],$n(i));const s=f(e,["scribbleImage"]);return t!==void 0&&s!=null&&d(t,["instances[0]","scribble"],Q3(s)),n}function Rv(e){const t={},n=f(e,["languageCode"]);n!=null&&d(t,["languageCode"],n);const r=f(e,["voiceConfig"]);if(r!=null&&d(t,["voiceConfig"],r),f(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function rP(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],s3(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],r),t}function iP(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(p=>p)),d(t,["functionDeclarations"],c)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearchRetrieval"]);r!=null&&d(t,["googleSearchRetrieval"],r);const i=f(e,["computerUse"]);i!=null&&d(t,["computerUse"],i);const s=f(e,["fileSearch"]);s!=null&&d(t,["fileSearch"],s);const o=f(e,["codeExecution"]);if(o!=null&&d(t,["codeExecution"],o),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=f(e,["googleMaps"]);a!=null&&d(t,["googleMaps"],F3(a));const l=f(e,["googleSearch"]);l!=null&&d(t,["googleSearch"],M3(l));const u=f(e,["urlContext"]);return u!=null&&d(t,["urlContext"],u),t}function Pv(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>o3(m))),d(t,["functionDeclarations"],p)}const r=f(e,["retrieval"]);r!=null&&d(t,["retrieval"],r);const i=f(e,["googleSearchRetrieval"]);i!=null&&d(t,["googleSearchRetrieval"],i);const s=f(e,["computerUse"]);if(s!=null&&d(t,["computerUse"],s),f(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=f(e,["codeExecution"]);o!=null&&d(t,["codeExecution"],o);const a=f(e,["enterpriseWebSearch"]);a!=null&&d(t,["enterpriseWebSearch"],a);const l=f(e,["googleMaps"]);l!=null&&d(t,["googleMaps"],l);const u=f(e,["googleSearch"]);u!=null&&d(t,["googleSearch"],u);const c=f(e,["urlContext"]);return c!=null&&d(t,["urlContext"],c),t}function sP(e){const t={},n=f(e,["baseModel"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["createTime"]);r!=null&&d(t,["createTime"],r);const i=f(e,["updateTime"]);return i!=null&&d(t,["updateTime"],i),t}function oP(e){const t={},n=f(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["createTime"]);r!=null&&d(t,["createTime"],r);const i=f(e,["updateTime"]);return i!=null&&d(t,["updateTime"],i),t}function aP(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&d(t,["displayName"],r);const i=f(e,["description"]);t!==void 0&&i!=null&&d(t,["description"],i);const s=f(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&d(t,["defaultCheckpointId"],s),n}function lP(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&d(t,["displayName"],r);const i=f(e,["description"]);t!==void 0&&i!=null&&d(t,["description"],i);const s=f(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&d(t,["defaultCheckpointId"],s),n}function uP(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],De(e,r));const i=f(t,["config"]);return i!=null&&aP(i,n),n}function cP(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["config"]);return i!=null&&lP(i,n),n}function fP(e,t){const n={},r=f(e,["outputGcsUri"]);t!==void 0&&r!=null&&d(t,["parameters","storageUri"],r);const i=f(e,["safetyFilterLevel"]);t!==void 0&&i!=null&&d(t,["parameters","safetySetting"],i);const s=f(e,["personGeneration"]);t!==void 0&&s!=null&&d(t,["parameters","personGeneration"],s);const o=f(e,["includeRaiReason"]);t!==void 0&&o!=null&&d(t,["parameters","includeRaiReason"],o);const a=f(e,["outputMimeType"]);t!==void 0&&a!=null&&d(t,["parameters","outputOptions","mimeType"],a);const l=f(e,["outputCompressionQuality"]);t!==void 0&&l!=null&&d(t,["parameters","outputOptions","compressionQuality"],l);const u=f(e,["enhanceInputImage"]);t!==void 0&&u!=null&&d(t,["parameters","upscaleConfig","enhanceInputImage"],u);const c=f(e,["imagePreservationFactor"]);t!==void 0&&c!=null&&d(t,["parameters","upscaleConfig","imagePreservationFactor"],c);const p=f(e,["labels"]);t!==void 0&&p!=null&&d(t,["labels"],p);const m=f(e,["numberOfImages"]);t!==void 0&&m!=null&&d(t,["parameters","sampleCount"],m);const g=f(e,["mode"]);return t!==void 0&&g!=null&&d(t,["parameters","mode"],g),n}function dP(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],De(e,r));const i=f(t,["image"]);i!=null&&d(n,["instances[0]","image"],$n(i));const s=f(t,["upscaleFactor"]);s!=null&&d(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=f(t,["config"]);return o!=null&&fP(o,n),n}function hP(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>au(s))),d(t,["generatedImages"],i)}return t}function pP(e){const t={},n=f(e,["uri"]);n!=null&&d(t,["uri"],n);const r=f(e,["encodedVideo"]);r!=null&&d(t,["videoBytes"],Yr(r));const i=f(e,["encoding"]);return i!=null&&d(t,["mimeType"],i),t}function mP(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["uri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&d(t,["videoBytes"],Yr(r));const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function gP(e){const t={},n=f(e,["image"]);n!=null&&d(t,["_self"],$n(n));const r=f(e,["maskMode"]);return r!=null&&d(t,["maskMode"],r),t}function xP(e){const t={},n=f(e,["image"]);n!=null&&d(t,["image"],lu(n));const r=f(e,["referenceType"]);return r!=null&&d(t,["referenceType"],r),t}function vP(e){const t={},n=f(e,["image"]);n!=null&&d(t,["image"],$n(n));const r=f(e,["referenceType"]);return r!=null&&d(t,["referenceType"],r),t}function Fv(e){const t={},n=f(e,["uri"]);n!=null&&d(t,["uri"],n);const r=f(e,["videoBytes"]);r!=null&&d(t,["encodedVideo"],Yr(r));const i=f(e,["mimeType"]);return i!=null&&d(t,["encoding"],i),t}function Mv(e){const t={},n=f(e,["uri"]);n!=null&&d(t,["gcsUri"],n);const r=f(e,["videoBytes"]);r!=null&&d(t,["bytesBase64Encoded"],Yr(r));const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yP="Content-Type",EP="X-Server-Timeout",TP="User-Agent",cf="x-goog-api-client",_P="1.30.0",SP=`google-genai-sdk/${_P}`,wP="v1beta1",CP="v1beta",sm=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class AP{constructor(t){var n,r;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:wP,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:CP,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&r.push(t.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),t!==""&&i.push(t),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);if(t.queryParams)for(const[o,a]of Object.entries(t.queryParams))i.searchParams.append(o,String(a));let s={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=t.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),t.abortSignal),this.unaryApiCall(i,s,t.httpMethod)}patchHttpOptions(t,n){const r=JSON.parse(JSON.stringify(t));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=t.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),t.abortSignal),this.streamApiCall(i,s,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,r,i){if(n&&n.timeout||i){const s=new AbortController,o=s.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>s.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),t.signal=o}return n&&n.extraBody!==null&&NP(t,n.extraBody),t.headers=await this.getHeadersInternal(n,r),t}async unaryApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await om(i),new sf(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await om(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(t){var n;return rs(this,arguments,function*(){const i=(n=t==null?void 0:t.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield Ye(i.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=s.decode(l,{stream:!0});try{const p=JSON.parse(u);if("error"in p){const m=JSON.parse(JSON.stringify(p.error)),g=m.status,y=m.code,x=`got status: ${g}. ${JSON.stringify(p)}`;if(y>=400&&y<600)throw new su({message:x,status:y})}}catch(p){if(p.name==="ApiError")throw p}o+=u;let c=o.match(sm);for(;c;){const p=c[1];try{const m=new Response(p,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield Ye(new sf(m)),o=o.slice(c[0].length),c=o.match(sm)}catch(m){throw new Error(`exception parsing stream chunk ${p}. ${m}`)}}}}finally{i.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const t={},n=SP+" "+this.clientOptions.userAgentExtra;return t[TP]=n,t[cf]=n,t[yP]="application/json",t}async getHeadersInternal(t,n){const r=new Headers;if(t&&t.headers){for(const[i,s]of Object.entries(t.headers))r.append(i,s);t.timeout&&t.timeout>0&&r.append(EP,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(t){var n;let r="";return typeof t=="string"&&(r=t.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(t,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(t);i.sizeBytes=String(o.size);const a=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const l={file:i},u=this.getFileName(t),c=de("upload/v1beta/files",l._url),p=await this.fetchUploadUrl(c,i.sizeBytes,i.mimeType,u,l,n==null?void 0:n.httpOptions);return s.upload(t,p,this)}async uploadFileToFileSearchStore(t,n,r){var i;const s=this.clientOptions.uploader,o=await s.stat(n),a=String(o.size),l=(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const u=`upload/v1beta/${t}:uploadToFileSearchStore`,c=this.getFileName(n),p={};r!=null&&r.customMetadata&&(p.customMetadata=r.customMetadata),r!=null&&r.chunkingConfig&&(p.chunkingConfig=r.chunkingConfig);const m=await this.fetchUploadUrl(u,a,l,c,p,r==null?void 0:r.httpOptions);return s.uploadToFileSearchStore(n,m,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,n,r,i,s,o){var a;let l={};o?l=o:l={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},i?{"X-Goog-Upload-File-Name":i}:{})};const u=await this.request({path:t,body:JSON.stringify(s),httpMethod:"POST",httpOptions:l});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=(a=u==null?void 0:u.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(c===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function om(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const n=e.status;let r;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?r=await e.json():r={error:{message:await e.text(),code:e.status,status:e.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new su({message:i,status:n}):new Error(i)}}function NP(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof e.body=="string"&&e.body.length>0)try{const s=JSON.parse(e.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],c=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&c&&typeof c=="object"&&!Array.isArray(c)?a[l]=r(c,u):(c&&u&&typeof c!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof c}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const i=r(n,t);e.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const IP="mcp_used/unknown";let kP=!1;function bv(e){for(const t of e)if(RP(t)||typeof t=="object"&&"inputSchema"in t)return!0;return kP}function Dv(e){var t;const n=(t=e[cf])!==null&&t!==void 0?t:"";e[cf]=(n+` ${IP}`).trimStart()}function RP(e){return e!==null&&typeof e=="object"&&e instanceof bd}function PP(e,t=100){return rs(this,arguments,function*(){let r,i=0;for(;i<t;){const s=yield Ye(e.listTools({cursor:r}));for(const o of s.tools)yield yield Ye(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class bd{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new bd(t,n)}async initialize(){var t,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const c of this.mcpClients)try{for(var a=!0,l=(n=void 0,ao(PP(c))),u;u=await l.next(),t=u.done,!t;a=!0){i=u.value,a=!1;const p=i;o.push(p);const m=p.name;if(s[m])throw new Error(`Duplicate function name ${m} found in MCP tools. Please ensure function names are unique.`);s[m]=c}}catch(p){n={error:p}}finally{try{!a&&!t&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),S4(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const r of t)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function FP(e,t,n){const r=new m4;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),t(r)}class MP{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r}async connect(t){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=LP(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const c=new Promise(_=>{u=_}),p=t.callbacks,m=function(){u({})},g=this.apiClient,y={onopen:m,onmessage:_=>{FP(g,p.onmessage,_)},onerror:(n=p==null?void 0:p.onerror)!==null&&n!==void 0?n:function(_){},onclose:(r=p==null?void 0:p.onclose)!==null&&r!==void 0?r:function(_){}},x=this.webSocketFactory.create(l,DP(o),y);x.connect(),await c;const E={setup:{model:De(this.apiClient,t.model)}};return x.send(JSON.stringify(E)),new bP(x,this.apiClient)}}class bP{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=ER(t);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=yR(t);this.conn.send(JSON.stringify(n))}sendPlaybackControl(t){const n={playbackControl:t};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl($i.PLAY)}pause(){this.sendPlaybackControl($i.PAUSE)}stop(){this.sendPlaybackControl($i.STOP)}resetContext(){this.sendPlaybackControl($i.RESET_CONTEXT)}close(){this.conn.close()}}function DP(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function LP(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const OP="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function UP(e,t,n){const r=new p4;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(e.isVertexAI()){const o=SR(s);Object.assign(r,o)}else Object.assign(r,s);t(r)}class BP{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r,this.music=new MP(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,r,i,s,o,a;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let c;const p=this.apiClient.getHeaders();t.config&&t.config.tools&&bv(t.config.tools)&&Dv(p);const m=$P(p);if(this.apiClient.isVertexAI())c=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m,c);else{const b=this.apiClient.getApiKey();let O="BidiGenerateContent",J="key";b!=null&&b.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),O="BidiGenerateContentConstrained",J="access_token"),c=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${O}?${J}=${b}`}let g=()=>{};const y=new Promise(b=>{g=b}),x=t.callbacks,S=function(){var b;(b=x==null?void 0:x.onopen)===null||b===void 0||b.call(x),g({})},T=this.apiClient,E={onopen:S,onmessage:b=>{UP(T,x.onmessage,b)},onerror:(n=x==null?void 0:x.onerror)!==null&&n!==void 0?n:function(b){},onclose:(r=x==null?void 0:x.onclose)!==null&&r!==void 0?r:function(b){}},_=this.webSocketFactory.create(c,HP(m),E);_.connect(),await y;let N=De(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&N.startsWith("publishers/")){const b=this.apiClient.getProject(),O=this.apiClient.getLocation();N=`projects/${b}/locations/${O}/`+N}let B={};this.apiClient.isVertexAI()&&((i=t.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[Pl.AUDIO]}:t.config.responseModalities=[Pl.AUDIO]),!((s=t.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const G=(a=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],k=[];for(const b of G)if(this.isCallableTool(b)){const O=b;k.push(await O.tool())}else k.push(b);k.length>0&&(t.config.tools=k);const D={model:N,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?B=vR(this.apiClient,D):B=xR(this.apiClient,D),delete B.config,_.send(JSON.stringify(B)),new VP(_,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const GP={turnComplete:!0};class VP{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Cn(n.turns),t.isVertexAI()||(r=r.map(i=>ou(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!t.isVertexAI()&&!("id"in s))throw new Error(OP)}return{toolResponse:{functionResponses:r}}}sendClientContent(t){t=Object.assign(Object.assign({},GP),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:_R(t)}:n={realtimeInput:TR(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function HP(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function $P(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const am=10;function lm(e){var t,n,r;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let i=!1;for(const o of(n=e==null?void 0:e.tools)!==null&&n!==void 0?n:[])if(is(o)){i=!0;break}if(!i)return!0;const s=(r=e==null?void 0:e.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function is(e){return"callTool"in e&&typeof e.callTool=="function"}function zP(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(i=>is(i)))!==null&&r!==void 0?r:!1}function um(e){var t;const n=[];return!((t=e==null?void 0:e.config)===null||t===void 0)&&t.tools&&e.config.tools.forEach((r,i)=>{if(is(r))return;const s=r;s.functionDeclarations&&s.functionDeclarations.length>0&&n.push(i)}),n}function cm(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jP extends vr{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>{var r,i,s,o,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!zP(n)||lm(n.config))return await this.generateContentInternal(l);const u=um(n);if(u.length>0){const x=u.map(S=>`tools[${S}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${x}.`)}let c,p;const m=Cn(l.contents),g=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:am;let y=0;for(;y<g&&(c=await this.generateContentInternal(l),!(!c.functionCalls||c.functionCalls.length===0));){const x=c.candidates[0].content,S=[];for(const T of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(is(T)){const _=await T.callTool(c.functionCalls);S.push(..._)}y++,p={role:"user",parts:S},l.contents=Cn(l.contents),l.contents.push(x),l.contents.push(p),cm(l.config)&&(m.push(x),m.push(p))}return cm(l.config)&&(c.automaticFunctionCallingHistory=m),c},this.generateContentStream=async n=>{var r,i,s,o,a;if(this.maybeMoveToResponseJsonSchem(n),lm(n.config)){const p=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(p)}const l=um(n);if(l.length>0){const p=l.map(m=>`tools[${m}]`).join(", ");throw new Error(`Incompatible tools found at ${p}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const u=(s=(i=(r=n==null?void 0:n.config)===null||r===void 0?void 0:r.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,c=(a=(o=n==null?void 0:n.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(u&&!c)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:o.push(l);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Ti(mr.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,s,o,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var n,r,i;const s=(n=t.config)===null||n===void 0?void 0:n.tools;if(!s)return t;const o=await Promise.all(s.map(async l=>is(l)?await l.tool():l)),a={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:o})};if(a.config.tools=o,t.config&&t.config.tools&&bv(t.config.tools)){const l=(i=(r=t.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),Dv(u),a.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(t){var n,r,i;const s=new Map;for(const o of(r=(n=t.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(is(o)){const a=o,l=await a.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,a)}}return s}async processAfcStream(t){var n,r,i;const s=(i=(r=(n=t.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:am;let o=!1,a=0;const l=await this.initAfcToolsMap(t);return function(u,c,p){var m,g;return rs(this,arguments,function*(){for(var y,x,S,T;a<s;){o&&(a++,o=!1);const B=yield Ye(u.processParamsMaybeAddMcpUsage(p)),G=yield Ye(u.generateContentStreamInternal(B)),k=[],D=[];try{for(var E=!0,_=(x=void 0,ao(G)),N;N=yield Ye(_.next()),y=N.done,!y;E=!0){T=N.value,E=!1;const b=T;if(yield yield Ye(b),b.candidates&&(!((m=b.candidates[0])===null||m===void 0)&&m.content)){D.push(b.candidates[0].content);for(const O of(g=b.candidates[0].content.parts)!==null&&g!==void 0?g:[])if(a<s&&O.functionCall){if(!O.functionCall.name)throw new Error("Function call name was not returned by the model.");if(c.has(O.functionCall.name)){const J=yield Ye(c.get(O.functionCall.name).callTool([O.functionCall]));k.push(...J)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${c.keys()}, mising tool: ${O.functionCall.name}`)}}}}catch(b){x={error:b}}finally{try{!E&&!y&&(S=_.return)&&(yield Ye(S.call(_)))}finally{if(x)throw x.error}}if(k.length>0){o=!0;const b=new Gs;b.candidates=[{content:{role:"user",parts:k}}],yield yield Ye(b);const O=[];O.push(...D),O.push({role:"user",parts:k});const J=Cn(p.contents).concat(O);p.contents=J}else break}})}(this,l,t)}async generateContentInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=nm(this.apiClient,t);return a=de("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=im(c),m=new Gs;return Object.assign(m,p),m})}else{const u=tm(this.apiClient,t);return a=de("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=rm(c),m=new Gs;return Object.assign(m,p),m})}}async generateContentStreamInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=nm(this.apiClient,t);return a=de("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(p){return rs(this,arguments,function*(){var m,g,y,x;try{for(var S=!0,T=ao(p),E;E=yield Ye(T.next()),m=E.done,!m;S=!0){x=E.value,S=!1;const _=x,N=im(yield Ye(_.json()));N.sdkHttpResponse={headers:_.headers};const B=new Gs;Object.assign(B,N),yield yield Ye(B)}}catch(_){g={error:_}}finally{try{!S&&!m&&(y=T.return)&&(yield Ye(y.call(T)))}finally{if(g)throw g.error}}})})}else{const u=tm(this.apiClient,t);return a=de("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(p){return rs(this,arguments,function*(){var m,g,y,x;try{for(var S=!0,T=ao(p),E;E=yield Ye(T.next()),m=E.done,!m;S=!0){x=E.value,S=!1;const _=x,N=rm(yield Ye(_.json()));N.sdkHttpResponse={headers:_.headers};const B=new Gs;Object.assign(B,N),yield yield Ye(B)}}catch(_){g={error:_}}finally{try{!S&&!m&&(y=T.return)&&(yield Ye(y.call(T)))}finally{if(g)throw g.error}}})})}}async embedContent(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=ZR(this.apiClient,t);return a=de("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=t3(c),m=new Bp;return Object.assign(m,p),m})}else{const u=QR(this.apiClient,t);return a=de("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=e3(c),m=new Bp;return Object.assign(m,p),m})}}async generateImagesInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=d3(this.apiClient,t);return a=de("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=p3(c),m=new Gp;return Object.assign(m,p),m})}else{const u=f3(this.apiClient,t);return a=de("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=h3(c),m=new Gp;return Object.assign(m,p),m})}}async editImageInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=JR(this.apiClient,t);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:l.headers},c})),i.then(l=>{const u=KR(l),c=new r4;return Object.assign(c,u),c})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=dP(this.apiClient,t);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:l.headers},c})),i.then(l=>{const u=hP(l),c=new i4;return Object.assign(c,u),c})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=q3(this.apiClient,t);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=J3(l),c=new s4;return Object.assign(c,u),c})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=eP(this.apiClient,t);return s=de("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=tP(l),c=new o4;return Object.assign(c,u),c})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=P3(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),o.then(c=>uf(c))}else{const u=R3(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),o.then(c=>lf(c))}}async listInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=G3(this.apiClient,t);return a=de("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=H3(c),m=new Vp;return Object.assign(m,p),m})}else{const u=B3(this.apiClient,t);return a=de("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=V3(c),m=new Vp;return Object.assign(m,p),m})}}async update(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=cP(this.apiClient,t);return a=de("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),o.then(c=>uf(c))}else{const u=uP(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),o.then(c=>lf(c))}}async delete(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=zR(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=WR(c),m=new Hp;return Object.assign(m,p),m})}else{const u=$R(this.apiClient,t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=jR(c),m=new Hp;return Object.assign(m,p),m})}}async countTokens(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=GR(this.apiClient,t);return a=de("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=HR(c),m=new $p;return Object.assign(m,p),m})}else{const u=BR(this.apiClient,t);return a=de("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=VR(c),m=new $p;return Object.assign(m,p),m})}}async computeTokens(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=FR(this.apiClient,t);return s=de("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:l.headers},c})),i.then(l=>{const u=MR(l),c=new a4;return Object.assign(c,u),c})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=E3(this.apiClient,t);return a=de("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),o.then(c=>{const p=v3(c),m=new Fl;return Object.assign(m,p),m})}else{const u=y3(this.apiClient,t);return a=de("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),o.then(c=>{const p=x3(c),m=new Fl;return Object.assign(m,p),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class WP extends vr{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=XI(t);return a=de("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),o}else{const u=YI(t);return a=de("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),o}}async fetchPredictVideosOperationInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=$I(t);return s=de("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qP(e){const t={},n=f(e,["data"]);if(n!=null&&d(t,["data"],n),f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function JP(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>rF(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function KP(e,t,n){const r={},i=f(t,["expireTime"]);n!==void 0&&i!=null&&d(n,["expireTime"],i);const s=f(t,["newSessionExpireTime"]);n!==void 0&&s!=null&&d(n,["newSessionExpireTime"],s);const o=f(t,["uses"]);n!==void 0&&o!=null&&d(n,["uses"],o);const a=f(t,["liveConnectConstraints"]);n!==void 0&&a!=null&&d(n,["bidiGenerateContentSetup"],nF(e,a));const l=f(t,["lockAdditionalFields"]);return n!==void 0&&l!=null&&d(n,["fieldMask"],l),r}function YP(e,t){const n={},r=f(t,["config"]);return r!=null&&d(n,["config"],KP(e,r,n)),n}function XP(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function QP(e){const t={},n=f(e,["id"]);n!=null&&d(t,["id"],n);const r=f(e,["args"]);r!=null&&d(t,["args"],r);const i=f(e,["name"]);if(i!=null&&d(t,["name"],i),f(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function ZP(e){const t={};if(f(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=f(e,["enableWidget"]);return n!=null&&d(t,["enableWidget"],n),t}function eF(e){const t={};if(f(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],n),t}function tF(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&d(t,["setup","generationConfig"],r);const i=f(e,["responseModalities"]);t!==void 0&&i!=null&&d(t,["setup","generationConfig","responseModalities"],i);const s=f(e,["temperature"]);t!==void 0&&s!=null&&d(t,["setup","generationConfig","temperature"],s);const o=f(e,["topP"]);t!==void 0&&o!=null&&d(t,["setup","generationConfig","topP"],o);const a=f(e,["topK"]);t!==void 0&&a!=null&&d(t,["setup","generationConfig","topK"],a);const l=f(e,["maxOutputTokens"]);t!==void 0&&l!=null&&d(t,["setup","generationConfig","maxOutputTokens"],l);const u=f(e,["mediaResolution"]);t!==void 0&&u!=null&&d(t,["setup","generationConfig","mediaResolution"],u);const c=f(e,["seed"]);t!==void 0&&c!=null&&d(t,["setup","generationConfig","seed"],c);const p=f(e,["speechConfig"]);t!==void 0&&p!=null&&d(t,["setup","generationConfig","speechConfig"],Md(p));const m=f(e,["thinkingConfig"]);t!==void 0&&m!=null&&d(t,["setup","generationConfig","thinkingConfig"],m);const g=f(e,["enableAffectiveDialog"]);t!==void 0&&g!=null&&d(t,["setup","generationConfig","enableAffectiveDialog"],g);const y=f(e,["systemInstruction"]);t!==void 0&&y!=null&&d(t,["setup","systemInstruction"],JP(bt(y)));const x=f(e,["tools"]);if(t!==void 0&&x!=null){let G=Ts(x);Array.isArray(G)&&(G=G.map(k=>sF(Es(k)))),d(t,["setup","tools"],G)}const S=f(e,["sessionResumption"]);t!==void 0&&S!=null&&d(t,["setup","sessionResumption"],iF(S));const T=f(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&d(t,["setup","inputAudioTranscription"],T);const E=f(e,["outputAudioTranscription"]);t!==void 0&&E!=null&&d(t,["setup","outputAudioTranscription"],E);const _=f(e,["realtimeInputConfig"]);t!==void 0&&_!=null&&d(t,["setup","realtimeInputConfig"],_);const N=f(e,["contextWindowCompression"]);t!==void 0&&N!=null&&d(t,["setup","contextWindowCompression"],N);const B=f(e,["proactivity"]);return t!==void 0&&B!=null&&d(t,["setup","proactivity"],B),n}function nF(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["setup","model"],De(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],tF(i,n)),n}function rF(e){const t={},n=f(e,["mediaResolution"]);n!=null&&d(t,["mediaResolution"],n);const r=f(e,["codeExecutionResult"]);r!=null&&d(t,["codeExecutionResult"],r);const i=f(e,["executableCode"]);i!=null&&d(t,["executableCode"],i);const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],XP(s));const o=f(e,["functionCall"]);o!=null&&d(t,["functionCall"],QP(o));const a=f(e,["functionResponse"]);a!=null&&d(t,["functionResponse"],a);const l=f(e,["inlineData"]);l!=null&&d(t,["inlineData"],qP(l));const u=f(e,["text"]);u!=null&&d(t,["text"],u);const c=f(e,["thought"]);c!=null&&d(t,["thought"],c);const p=f(e,["thoughtSignature"]);p!=null&&d(t,["thoughtSignature"],p);const m=f(e,["videoMetadata"]);return m!=null&&d(t,["videoMetadata"],m),t}function iF(e){const t={},n=f(e,["handle"]);if(n!=null&&d(t,["handle"],n),f(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function sF(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(p=>p)),d(t,["functionDeclarations"],c)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearchRetrieval"]);r!=null&&d(t,["googleSearchRetrieval"],r);const i=f(e,["computerUse"]);i!=null&&d(t,["computerUse"],i);const s=f(e,["fileSearch"]);s!=null&&d(t,["fileSearch"],s);const o=f(e,["codeExecution"]);if(o!=null&&d(t,["codeExecution"],o),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=f(e,["googleMaps"]);a!=null&&d(t,["googleMaps"],ZP(a));const l=f(e,["googleSearch"]);l!=null&&d(t,["googleSearch"],eF(l));const u=f(e,["urlContext"]);return u!=null&&d(t,["urlContext"],u),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oF(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);t.push(...i)}else t.push(n)}return t.join(",")}function aF(e,t){let n=null;const r=e.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(e.bidiGenerateContentSetup=s,n=s):delete e.bidiGenerateContentSetup}else r!==void 0&&delete e.bidiGenerateContentSetup;const i=e.fieldMask;if(n){const s=oF(n);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)s?e.fieldMask=s:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?e.fieldMask=l.join(","):delete e.fieldMask}else delete e.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}class lF extends vr{constructor(t){super(),this.apiClient=t}async create(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=YP(this.apiClient,t);s=de("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=aF(a,t.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uF(e,t){const n={},r=f(e,["displayName"]);return t!==void 0&&r!=null&&d(t,["displayName"],r),n}function cF(e){const t={},n=f(e,["config"]);return n!=null&&uF(n,t),t}function fF(e,t){const n={},r=f(e,["force"]);return t!==void 0&&r!=null&&d(t,["_query","force"],r),n}function dF(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","name"],n);const r=f(e,["config"]);return r!=null&&fF(r,t),t}function hF(e){const t={},n=f(e,["name"]);return n!=null&&d(t,["_url","name"],n),t}function pF(e,t){const n={},r=f(e,["customMetadata"]);if(t!==void 0&&r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),d(t,["customMetadata"],s)}const i=f(e,["chunkingConfig"]);return t!==void 0&&i!=null&&d(t,["chunkingConfig"],i),n}function mF(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const i=f(e,["done"]);i!=null&&d(t,["done"],i);const s=f(e,["error"]);s!=null&&d(t,["error"],s);const o=f(e,["response"]);return o!=null&&d(t,["response"],xF(o)),t}function gF(e){const t={},n=f(e,["fileSearchStoreName"]);n!=null&&d(t,["_url","file_search_store_name"],n);const r=f(e,["fileName"]);r!=null&&d(t,["fileName"],r);const i=f(e,["config"]);return i!=null&&pF(i,t),t}function xF(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["parent"]);r!=null&&d(t,["parent"],r);const i=f(e,["documentName"]);return i!=null&&d(t,["documentName"],i),t}function vF(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);return t!==void 0&&i!=null&&d(t,["_query","pageToken"],i),n}function yF(e){const t={},n=f(e,["config"]);return n!=null&&vF(n,t),t}function EF(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["fileSearchStores"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),d(t,["fileSearchStores"],s)}return t}function TF(e,t){const n={},r=f(e,["mimeType"]);t!==void 0&&r!=null&&d(t,["mimeType"],r);const i=f(e,["displayName"]);t!==void 0&&i!=null&&d(t,["displayName"],i);const s=f(e,["customMetadata"]);if(t!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),d(t,["customMetadata"],a)}const o=f(e,["chunkingConfig"]);return t!==void 0&&o!=null&&d(t,["chunkingConfig"],o),n}function _F(e){const t={},n=f(e,["fileSearchStoreName"]);n!=null&&d(t,["_url","file_search_store_name"],n);const r=f(e,["config"]);return r!=null&&TF(r,t),t}function SF(e){const t={},n=f(e,["sdkHttpResponse"]);return n!=null&&d(t,["sdkHttpResponse"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wF(e,t){const n={},r=f(e,["force"]);return t!==void 0&&r!=null&&d(t,["_query","force"],r),n}function CF(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","name"],n);const r=f(e,["config"]);return r!=null&&wF(r,t),t}function AF(e){const t={},n=f(e,["name"]);return n!=null&&d(t,["_url","name"],n),t}function NF(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);return t!==void 0&&i!=null&&d(t,["_query","pageToken"],i),n}function IF(e){const t={},n=f(e,["parent"]);n!=null&&d(t,["_url","parent"],n);const r=f(e,["config"]);return r!=null&&NF(r,t),t}function kF(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["documents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),d(t,["documents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class RF extends vr{constructor(t){super(),this.apiClient=t,this.list=async n=>new Ti(mr.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=AF(t);return s=de("{name}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(t){var n,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=CF(t);i=de("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=IF(t);return s=de("{parent}/documents",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=kF(l),c=new l4;return Object.assign(c,u),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class PF extends vr{constructor(t,n=new RF(t)){super(),this.apiClient=t,this.documents=n,this.list=async(r={})=>new Ti(mr.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(r),r)}async uploadToFileSearchStore(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(t.fileSearchStoreName,t.file,t.config)}async create(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=cF(t);return s=de("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async get(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=hF(t);return s=de("{name}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(t){var n,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=dF(t);i=de("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=yF(t);return s=de("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=EF(l),c=new u4;return Object.assign(c,u),c})}}async uploadToFileSearchStoreInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=_F(t);return s=de("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=SF(l),c=new c4;return Object.assign(c,u),c})}}async importFile(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=gF(t);return s=de("{file_search_store_name}:importFile",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=mF(l),c=new Id;return Object.assign(c,u),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function FF(e,t){const n={},r=f(e,["name"]);return r!=null&&d(n,["_url","name"],r),n}function MF(e,t){const n={},r=f(e,["name"]);return r!=null&&d(n,["_url","name"],r),n}function bF(e,t,n){const r={};if(f(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=f(e,["tunedModelDisplayName"]);if(t!==void 0&&i!=null&&d(t,["displayName"],i),f(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=f(e,["epochCount"]);t!==void 0&&s!=null&&d(t,["tuningTask","hyperparameters","epochCount"],s);const o=f(e,["learningRateMultiplier"]);if(o!=null&&d(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),f(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(f(e,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(f(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=f(e,["batchSize"]);t!==void 0&&a!=null&&d(t,["tuningTask","hyperparameters","batchSize"],a);const l=f(e,["learningRate"]);if(t!==void 0&&l!=null&&d(t,["tuningTask","hyperparameters","learningRate"],l),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(f(e,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function DF(e,t,n){const r={};let i=f(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const g=f(e,["validationDataset"]);t!==void 0&&g!=null&&d(t,["supervisedTuningSpec"],fm(g))}else if(i==="PREFERENCE_TUNING"){const g=f(e,["validationDataset"]);t!==void 0&&g!=null&&d(t,["preferenceOptimizationSpec"],fm(g))}const s=f(e,["tunedModelDisplayName"]);t!==void 0&&s!=null&&d(t,["tunedModelDisplayName"],s);const o=f(e,["description"]);t!==void 0&&o!=null&&d(t,["description"],o);let a=f(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const g=f(e,["epochCount"]);t!==void 0&&g!=null&&d(t,["supervisedTuningSpec","hyperParameters","epochCount"],g)}else if(a==="PREFERENCE_TUNING"){const g=f(e,["epochCount"]);t!==void 0&&g!=null&&d(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],g)}let l=f(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const g=f(e,["learningRateMultiplier"]);t!==void 0&&g!=null&&d(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],g)}else if(l==="PREFERENCE_TUNING"){const g=f(e,["learningRateMultiplier"]);t!==void 0&&g!=null&&d(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],g)}let u=f(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const g=f(e,["exportLastCheckpointOnly"]);t!==void 0&&g!=null&&d(t,["supervisedTuningSpec","exportLastCheckpointOnly"],g)}else if(u==="PREFERENCE_TUNING"){const g=f(e,["exportLastCheckpointOnly"]);t!==void 0&&g!=null&&d(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],g)}let c=f(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const g=f(e,["adapterSize"]);t!==void 0&&g!=null&&d(t,["supervisedTuningSpec","hyperParameters","adapterSize"],g)}else if(c==="PREFERENCE_TUNING"){const g=f(e,["adapterSize"]);t!==void 0&&g!=null&&d(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],g)}if(f(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(f(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const p=f(e,["labels"]);t!==void 0&&p!=null&&d(t,["labels"],p);const m=f(e,["beta"]);return t!==void 0&&m!=null&&d(t,["preferenceOptimizationSpec","hyperParameters","beta"],m),r}function LF(e,t){const n={},r=f(e,["baseModel"]);r!=null&&d(n,["baseModel"],r);const i=f(e,["preTunedModel"]);i!=null&&d(n,["preTunedModel"],i);const s=f(e,["trainingDataset"]);s!=null&&qF(s);const o=f(e,["config"]);return o!=null&&bF(o,n),n}function OF(e,t){const n={},r=f(e,["baseModel"]);r!=null&&d(n,["baseModel"],r);const i=f(e,["preTunedModel"]);i!=null&&d(n,["preTunedModel"],i);const s=f(e,["trainingDataset"]);s!=null&&JF(s,n,t);const o=f(e,["config"]);return o!=null&&DF(o,n,t),n}function UF(e,t){const n={},r=f(e,["name"]);return r!=null&&d(n,["_url","name"],r),n}function BF(e,t){const n={},r=f(e,["name"]);return r!=null&&d(n,["_url","name"],r),n}function GF(e,t,n){const r={},i=f(e,["pageSize"]);t!==void 0&&i!=null&&d(t,["_query","pageSize"],i);const s=f(e,["pageToken"]);t!==void 0&&s!=null&&d(t,["_query","pageToken"],s);const o=f(e,["filter"]);return t!==void 0&&o!=null&&d(t,["_query","filter"],o),r}function VF(e,t,n){const r={},i=f(e,["pageSize"]);t!==void 0&&i!=null&&d(t,["_query","pageSize"],i);const s=f(e,["pageToken"]);t!==void 0&&s!=null&&d(t,["_query","pageToken"],s);const o=f(e,["filter"]);return t!==void 0&&o!=null&&d(t,["_query","filter"],o),r}function HF(e,t){const n={},r=f(e,["config"]);return r!=null&&GF(r,n),n}function $F(e,t){const n={},r=f(e,["config"]);return r!=null&&VF(r,n),n}function zF(e,t){const n={},r=f(e,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);const i=f(e,["nextPageToken"]);i!=null&&d(n,["nextPageToken"],i);const s=f(e,["tunedModels"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Lv(a))),d(n,["tuningJobs"],o)}return n}function jF(e,t){const n={},r=f(e,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);const i=f(e,["nextPageToken"]);i!=null&&d(n,["nextPageToken"],i);const s=f(e,["tuningJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>ff(a))),d(n,["tuningJobs"],o)}return n}function WF(e,t){const n={},r=f(e,["name"]);r!=null&&d(n,["model"],r);const i=f(e,["name"]);return i!=null&&d(n,["endpoint"],i),n}function qF(e,t){const n={};if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=f(e,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),d(n,["examples","examples"],i)}return n}function JF(e,t,n){const r={};let i=f(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const o=f(e,["gcsUri"]);t!==void 0&&o!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(i==="PREFERENCE_TUNING"){const o=f(e,["gcsUri"]);t!==void 0&&o!=null&&d(t,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let s=f(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=f(e,["vertexDatasetResource"]);t!==void 0&&o!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=f(e,["vertexDatasetResource"]);t!==void 0&&o!=null&&d(t,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(f(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function Lv(e,t){const n={},r=f(e,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);const i=f(e,["name"]);i!=null&&d(n,["name"],i);const s=f(e,["state"]);s!=null&&d(n,["state"],xv(s));const o=f(e,["createTime"]);o!=null&&d(n,["createTime"],o);const a=f(e,["tuningTask","startTime"]);a!=null&&d(n,["startTime"],a);const l=f(e,["tuningTask","completeTime"]);l!=null&&d(n,["endTime"],l);const u=f(e,["updateTime"]);u!=null&&d(n,["updateTime"],u);const c=f(e,["description"]);c!=null&&d(n,["description"],c);const p=f(e,["baseModel"]);p!=null&&d(n,["baseModel"],p);const m=f(e,["_self"]);return m!=null&&d(n,["tunedModel"],WF(m)),n}function ff(e,t){const n={},r=f(e,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);const i=f(e,["name"]);i!=null&&d(n,["name"],i);const s=f(e,["state"]);s!=null&&d(n,["state"],xv(s));const o=f(e,["createTime"]);o!=null&&d(n,["createTime"],o);const a=f(e,["startTime"]);a!=null&&d(n,["startTime"],a);const l=f(e,["endTime"]);l!=null&&d(n,["endTime"],l);const u=f(e,["updateTime"]);u!=null&&d(n,["updateTime"],u);const c=f(e,["error"]);c!=null&&d(n,["error"],c);const p=f(e,["description"]);p!=null&&d(n,["description"],p);const m=f(e,["baseModel"]);m!=null&&d(n,["baseModel"],m);const g=f(e,["tunedModel"]);g!=null&&d(n,["tunedModel"],g);const y=f(e,["preTunedModel"]);y!=null&&d(n,["preTunedModel"],y);const x=f(e,["supervisedTuningSpec"]);x!=null&&d(n,["supervisedTuningSpec"],x);const S=f(e,["preferenceOptimizationSpec"]);S!=null&&d(n,["preferenceOptimizationSpec"],S);const T=f(e,["tuningDataStats"]);T!=null&&d(n,["tuningDataStats"],T);const E=f(e,["encryptionSpec"]);E!=null&&d(n,["encryptionSpec"],E);const _=f(e,["partnerModelTuningSpec"]);_!=null&&d(n,["partnerModelTuningSpec"],_);const N=f(e,["customBaseModel"]);N!=null&&d(n,["customBaseModel"],N);const B=f(e,["experiment"]);B!=null&&d(n,["experiment"],B);const G=f(e,["labels"]);G!=null&&d(n,["labels"],G);const k=f(e,["outputUri"]);k!=null&&d(n,["outputUri"],k);const D=f(e,["pipelineJob"]);D!=null&&d(n,["pipelineJob"],D);const b=f(e,["serviceAccount"]);b!=null&&d(n,["serviceAccount"],b);const O=f(e,["tunedModelDisplayName"]);O!=null&&d(n,["tunedModelDisplayName"],O);const J=f(e,["veoTuningSpec"]);return J!=null&&d(n,["veoTuningSpec"],J),n}function KF(e,t){const n={},r=f(e,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);const i=f(e,["name"]);i!=null&&d(n,["name"],i);const s=f(e,["metadata"]);s!=null&&d(n,["metadata"],s);const o=f(e,["done"]);o!=null&&d(n,["done"],o);const a=f(e,["error"]);return a!=null&&d(n,["error"],a),n}function fm(e,t){const n={},r=f(e,["gcsUri"]);r!=null&&d(n,["validationDatasetUri"],r);const i=f(e,["vertexDatasetResource"]);return i!=null&&d(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class YF extends vr{constructor(t){super(),this.apiClient=t,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Ti(mr.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:rf.JOB_STATE_QUEUED}}}}async getInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=BF(t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>ff(c))}else{const u=UF(t);return a=de("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>Lv(c))}}async listInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=$F(t);return a=de("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=jF(c),m=new zp;return Object.assign(m,p),m})}else{const u=HF(t);return a=de("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:c.headers},m})),o.then(c=>{const p=zF(c),m=new zp;return Object.assign(m,p),m})}}async cancel(t){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=MF(t);o=de("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=FF(t);o=de("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=OF(t,t);return s=de("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:l.headers},c})),i.then(l=>ff(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=LF(t);return s=de("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:l.headers},c})),i.then(l=>KF(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class XF{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const QF=1024*1024*8,ZF=3,eM=1e3,tM=2,bl="x-goog-upload-status";async function nM(e,t,n){var r;const i=await Ov(e,t,n),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[bl])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function rM(e,t,n){var r;const i=await Ov(e,t,n),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[bl])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const o=fv(s),a=new kd;return Object.assign(a,o),a}async function Ov(e,t,n){var r,i;let s=0,o=0,a=new sf(new Response),l="upload";for(s=e.size;o<s;){const u=Math.min(QF,s-o),c=e.slice(o,o+u);o+u>=s&&(l+=", finalize");let p=0,m=eM;for(;p<ZF&&(a=await n.request({path:"",body:c,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(o),"Content-Length":String(u)}}}),!(!((r=a==null?void 0:a.headers)===null||r===void 0)&&r[bl]));)p++,await sM(m),m=m*tM;if(o+=u,((i=a==null?void 0:a.headers)===null||i===void 0?void 0:i[bl])!=="active")break;if(s<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function iM(e){return{size:e.size,type:e.type}}function sM(e){return new Promise(t=>setTimeout(t,e))}class oM{async upload(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await nM(t,n,r)}async uploadToFileSearchStore(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await rM(t,n,r)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await iM(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aM{create(t,n,r){return new lM(t,n,r)}}class lM{constructor(t,n,r){this.url=t,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dm="x-goog-api-key";class uM{constructor(t){this.apiKey=t}async addAuthHeaders(t,n){if(t.get(dm)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(dm,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cM="gl-node/";class Uv{constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const r=VI(t.httpOptions,t.vertexai,void 0,void 0);r&&(t.httpOptions?t.httpOptions.baseUrl=r:t.httpOptions={baseUrl:r}),this.apiVersion=t.apiVersion;const i=new uM(this.apiKey);this.apiClient=new AP({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:cM+"web",uploader:new oM,downloader:new XF}),this.models=new jP(this.apiClient),this.live=new BP(this.apiClient,i,new aM),this.batches=new gk(this.apiClient),this.chats=new Xk(this.models,this.apiClient),this.caches=new Jk(this.apiClient),this.files=new aR(this.apiClient),this.operations=new WP(this.apiClient),this.authTokens=new lF(this.apiClient),this.tunings=new YF(this.apiClient),this.fileSearchStores=new PF(this.apiClient)}}const rn=()=>Math.random().toString(36).substr(2,9);async function fM(e){var t,n;try{const r=new URLSearchParams({q:e,per_page:"1",locale:"pt-BR"}),i=await fetch(`https://api.inaturalist.org/v1/taxa?${r}`);if(!i.ok)return null;const s=await i.json();if(s.results&&s.results.length>0){const o=s.results[0];if((t=o.default_photo)!=null&&t.medium_url)return o.default_photo.medium_url;if((n=o.default_photo)!=null&&n.square_url)return o.default_photo.square_url.replace("/square.","/medium.")}return null}catch(r){return console.warn(`iNaturalist fetch failed for "${e}":`,r),null}}async function dM(e){var t;try{const n=encodeURIComponent(e),r=await fetch(`https://www.flickr.com/services/feeds/photos_public.gne?tags=${n}&tagmode=all&format=json&nojsoncallback=1`);if(!r.ok)return null;const i=await r.json();if(i.items&&i.items.length>0){for(const s of i.items)if((t=s.media)!=null&&t.m)return s.media.m.replace("_m.jpg","_z.jpg")}return null}catch(n){return console.warn(`Flickr fetch failed for "${e}":`,n),null}}async function hM(e){var t,n;try{const r=new URLSearchParams({q:e,per_page:"3",locale:"pt",preferred_place_id:"7122"}),i=await fetch(`https://api.inaturalist.org/v1/taxa?${r}`);if(!i.ok)return null;const s=await i.json();if(s.results&&s.results.length>0)for(const o of s.results){if((t=o.default_photo)!=null&&t.medium_url)return o.default_photo.medium_url;if((n=o.default_photo)!=null&&n.square_url)return o.default_photo.square_url.replace("/square.","/medium.")}return null}catch(r){return console.warn(`Biodiversity4All fetch failed for "${e}":`,r),null}}async function pM(e,t="pt"){var n,r;try{const i=t==="pt"?["pt","en"]:["en","pt"];for(const s of i){const o=`https://${s}.wikipedia.org/w/api.php`,a=new URLSearchParams({action:"query",titles:e,prop:"pageimages",pithumbsize:"400",format:"json",origin:"*",redirects:"1"}),l=await fetch(`${o}?${a}`);if(!l.ok)continue;const c=(n=(await l.json()).query)==null?void 0:n.pages;if(c){const p=Object.keys(c)[0],m=c[p];if(m&&!m.missing&&((r=m.thumbnail)!=null&&r.source)){let g=m.thumbnail.source;return g=g.replace(/\/\d+px-/,"/400px-"),g}}}return null}catch(i){return console.warn(`Wikipedia fetch failed for "${e}":`,i),null}}async function mM(e){var t,n,r;try{const i="https://commons.wikimedia.org/w/api.php",s=new URLSearchParams({action:"query",generator:"search",gsrsearch:`${e}`,gsrnamespace:"6",gsrlimit:"3",prop:"imageinfo",iiprop:"url|mime",iiurlwidth:"400",format:"json",origin:"*"}),o=await fetch(`${i}?${s}`);if(!o.ok)return null;const l=(t=(await o.json()).query)==null?void 0:t.pages;if(l)for(const u of Object.values(l)){const c=(n=u==null?void 0:u.imageinfo)==null?void 0:n[0];if(c!=null&&c.thumburl&&((r=c==null?void 0:c.mime)!=null&&r.startsWith("image/")))return c.thumburl}return null}catch(i){return console.warn(`Wikimedia Commons fetch failed for "${e}":`,i),null}}function hm(e){if(!e)return"";const n=e.replace(/\s*\([^)]*\)\s*/g," ").trim().split(/\s+/);if(n.length>=2){const r=n[0],i=n[1];if(/^[a-z]/.test(i)&&!i.includes("."))return`${r} ${i}`}return e}async function gM(e,t,n="pt"){const r=t?hm(t):null,i=hm(e),s=[r,i,t!==r?t:null,e!==i?e:null].filter(Boolean),o=[...new Set(s)];for(const a of o){const l=await hM(a);if(l)return l;const u=await fM(a);if(u)return u;const c=await dM(a);if(c)return c;const p=await pM(a,n);if(p)return p;const m=await mM(a);if(m)return m}return null}async function Bv(e,t="pt",n){var s;const r=new Map,i=3;for(let o=0;o<e.length;o+=i){const a=e.slice(o,o+i),l=a.map(async c=>{const p=await gM(c.name,c.scientificName,t);return{name:c.name,url:p}});if((await Promise.all(l)).forEach(c=>{c.url&&r.set(c.name,c.url)}),n){const c=Math.min(o+i,e.length),p=((s=a[a.length-1])==null?void 0:s.name)||"";n(c,e.length,p)}o+i<e.length&&await new Promise(c=>setTimeout(c,150))}return r}function Gv(e){return`https://picsum.photos/seed/${encodeURIComponent(e.toLowerCase().replace(/\s+/g,"-"))}/400/300`}function xM(e,t,n){const r=[];if(!e||e.length<3)return r;const i=e.trim(),s=encodeURIComponent(i);i.replace(/\s+/g,"_");const o=n==="pt"?"pt":"en";return r.push({id:rn(),label:"Wikipedia",url:`https://${o}.wikipedia.org/wiki/Special:Search?search=${s}&go=Go`}),r.push({id:rn(),label:"GBIF",url:`https://www.gbif.org/species/search?q=${s}`}),r.push({id:rn(),label:"iNaturalist",url:`https://www.inaturalist.org/search?q=${s}`}),n==="pt"&&r.push({id:rn(),label:"Flora e Funga do Brasil",url:`https://floradobrasil.jbrj.gov.br/consulta/busca.html?q=${s}`}),n==="pt"&&r.push({id:rn(),label:"Biodiversity4All",url:`https://www.biodiversity4all.org/search?q=${s}`}),n==="pt"&&r.push({id:rn(),label:"SIDOL",url:`https://www.sidol.com.br/busca?q=${s}`}),n==="pt"&&r.push({id:rn(),label:"Flora Digital UFSC",url:`https://floradigital.ufsc.br/busca.php?q=${s}`}),r.push({id:rn(),label:"Flickr",url:`https://www.flickr.com/search/?text=${s}`}),r.push({id:rn(),label:"POWO",url:`https://powo.science.kew.org/results?q=${s}`}),r.slice(0,5)}function Vv(e){const t=e.match(/\(([A-Z][a-z]+ [a-z]+[^)]*)\)/);return t?t[1]:/^([A-Z][a-z]+)\s+([a-z]+)(\s+.*)?$/.test(e)?e.split(/\s+-\s+/)[0].trim():null}const vM=e=>{try{return JSON.parse(e)}catch(t){console.warn("JSON truncated. Attempting repair...");let n=e.trim().replace(/,$/,"");(n.match(/"/g)||[]).length%2!==0&&(n+='"');const i=[];for(const s of n)s==="{"?i.push("}"):s==="["?i.push("]"):(s==="}"||s==="]")&&i[i.length-1]===s&&i.pop();n+=i.reverse().join("");try{return JSON.parse(n)}catch(s){throw console.error("Repair failed",s),t}}},Hv={type:Ae.OBJECT,properties:{name:{type:Ae.STRING,description:"Name of the feature (e.g., 'Wing Color')"},imageUrl:{type:Ae.STRING,description:"URL for feature illustration"},states:{type:Ae.ARRAY,items:{type:Ae.STRING,description:"A state description (e.g., 'Blue')"}}},required:["name","states"]},$v={type:Ae.OBJECT,properties:{label:{type:Ae.STRING,description:"Title of the link (e.g., 'Wikipedia', 'GBIF')"},url:{type:Ae.STRING,description:"Full URL"}},required:["label","url"]},zv={type:Ae.OBJECT,properties:{projectName:{type:Ae.STRING},projectDescription:{type:Ae.STRING},features:{type:Ae.ARRAY,items:Hv},entities:{type:Ae.ARRAY,items:{type:Ae.OBJECT,properties:{name:{type:Ae.STRING,description:"Entity name (can be common name or scientific name)"},scientificName:{type:Ae.STRING,description:"Scientific binomial name (e.g., 'Panthera leo'). REQUIRED for biological species."},family:{type:Ae.STRING,description:"Taxonomic family name (e.g., 'Felidae', 'Fabaceae'). REQUIRED for biological species."},description:{type:Ae.STRING},links:{type:Ae.ARRAY,items:$v,description:"External resources"},traits:{type:Ae.ARRAY,items:{type:Ae.OBJECT,properties:{featureName:{type:Ae.STRING,description:"Must match one of the feature names exactly"},stateValue:{type:Ae.STRING,description:"Must match one of the state values for that feature exactly"}},required:["featureName","stateValue"]}}},required:["name","description","traits"]}}},required:["projectName","projectDescription","features","entities"]},yM={type:Ae.OBJECT,properties:{projectName:{type:Ae.STRING},projectDescription:{type:Ae.STRING},features:{type:Ae.ARRAY,items:Hv},entities:{type:Ae.ARRAY,items:{type:Ae.OBJECT,properties:{name:{type:Ae.STRING,description:"Entity name as found in document"},scientificName:{type:Ae.STRING,description:"Scientific binomial name if available (e.g., 'Panthera leo')"},family:{type:Ae.STRING,description:"Taxonomic family name if available (e.g., 'Felidae', 'Fabaceae')"},description:{type:Ae.STRING},links:{type:Ae.ARRAY,items:$v,description:"External resources"},traits:{type:Ae.ARRAY,items:{type:Ae.OBJECT,properties:{featureName:{type:Ae.STRING,description:"Must match one of the feature names exactly"},stateValue:{type:Ae.STRING,description:"Must match one of the state values for that feature exactly"}},required:["featureName","stateValue"]}}},required:["name","description","traits"]}}},required:["projectName","projectDescription","features","entities"]},jv=e=>{const t=e.language==="pt"?"All content (Project Name, Description, Features, States, Entities, Descriptions) MUST be in Portuguese (Brazil).":"All content must be in English.",n="For biological entities, ALWAYS provide: 1) the scientific binomial name (e.g., 'Panthera leo', 'Quercus robur'), and 2) the taxonomic family (e.g., 'Felidae', 'Fabaceae'). Both are REQUIRED for accurate classification.";let r=e.includeFeatureImages?"For each feature, provide a valid, DIRECT public URL to an image file illustrating the trait if available.":"Leave `imageUrl` empty for features.";const i="Leave the 'links' array empty (links will be generated automatically from scientific names).";if(e.importedFile){let m="Extract ALL distinctive features found in the text.";e.featureFocus==="vegetative"?m="STRICTLY EXTRACT ONLY VEGETATIVE features (leaves, bark, stem, roots, growth habit). IGNORE reproductive features (flowers, fruits, seeds).":e.featureFocus==="reproductive"&&(m="STRICTLY EXTRACT ONLY REPRODUCTIVE features (flowers, fruits, seeds, inflorescence). IGNORE vegetative features.");let g="Maintain the descriptions as close to the original text as possible (Balanced).";e.detailLevel===1?g="SIMPLIFY the descriptions. Use shorter, easier sentences. Remove excessive jargon.":e.detailLevel===3&&(g="MAXIMIZE DETAIL. Keep all scientific terms, measurements, and nuances found in the text.");const y=e.requiredFeatures&&e.requiredFeatures.length>0?`7. **REQUIRED FEATURES**: Prioritize extracting the following features if present in the document: ${e.requiredFeatures.join(", ")}. If the document doesn't mention them explicitly, still try to infer reasonable states for these features based on context.`:"",x=`
      You are an expert biologist and data analyst.
      Your task is to analyze the provided document (PDF, Text, or Image) and extract a structured Matrix Identification Key.
      
      **Goal**: Extract entities and features to build a matrix.
      
      **CRITICAL INSTRUCTIONS**: 
      1. You must extract **EVERY SINGLE** species/entity found in the text. DO NOT truncate the list.
      2. **FILTER**: ${m}
      3. **DETAIL**: ${g}
      4. **SCIENTIFIC NAMES**: ${n}
      5. **MEDIA**: 
         - Feature Images: ${r}
         - External Links: ${i}
      6. ${t}
      ${y}
      
      **Format**: Return valid JSON.
      **IMPORTANT**: Do not include markdown code fences (\`\`\`json ... \`\`\`). Return raw JSON only. Ensure all keys and string values are properly escaped.
    `,S=`
      Analyze the attached file. Extract a comprehensive biological identification key.
      
      - Project Name: Derive from document title.
      - Description: Summary of content.
      - Entities: Extract ALL entities found. Include scientific names for accurate image lookup.
      - Features: Extract distinctive traits based on the focus setting.
      - Matrix: Map traits to entities.
      
      If analyzing a Dichotomous Key, flatten the logic: assign all traits accumulated along the path to the species.
    `,T=[{inlineData:{mimeType:e.importedFile.mimeType,data:e.importedFile.data}},{text:S}];return{systemInstruction:x,prompt:S,parts:T,schema:yM}}let s="";e.featureFocus==="reproductive"?s="Focus primarily on reproductive features (e.g., flowers, fruits, seeds, cones, spores, inflorescence).":e.featureFocus==="vegetative"?s="Focus primarily on vegetative features (e.g., leaves, bark, stem, roots, growth habit, phyllo taxis).":s="Use a balanced mix of vegetative and reproductive features.";let o="";e.detailLevel===1?o="AUDIENCE: Children or General Public. Use simple, common language. Short descriptions. Avoid complex jargon.":e.detailLevel===3?o="AUDIENCE: Experts/Scientists. Use precise botanical/zoological terminology. Comprehensive descriptions. High detail.":o="AUDIENCE: Students/Enthusiasts. Balanced use of scientific terms with clear explanations.";const a=`
    You are an expert taxonomist and biologist. 
    Your task is to create an interactive identification key (matrix key) based strictly on the user's constraints.
    
    Constraints:
    1.  **Language**: ${t}
    2.  **Topic**: The general subject.
    3.  **Geography**: Restrict entities to this region/biome.
    4.  **Taxonomy**: Restrict to this Family/Genus/Order if specified.
    5.  **Quantity**: Generate exactly or close to the requested number of entities and features.
    6.  **Focus**: ${s}
    7.  **Detail Level**: ${o}
    8.  **SCIENTIFIC NAMES**: ${n}
    9.  **MEDIA**: 
        - Feature Images: ${r}
        - External Links: ${i}
    ${e.requiredFeatures&&e.requiredFeatures.length>0?`10. **REQUIRED FEATURES**: You MUST include ALL of the following features in the key: ${e.requiredFeatures.join(", ")}. These are mandatory and must be among the features generated.`:""}

    Output Requirements:
    1.  List of distinctive features. Each feature must have 2+ states.
    2.  List of entities with their scientific binomial names.
    3.  Matrix: Assign correct states.
    4.  **Scientific Accuracy**: Ensure traits are factual.

    The response must be a structured JSON object.
    **IMPORTANT**: Do not include markdown code fences (\`\`\`json ... \`\`\`). Return raw JSON only. Ensure all keys and string values are properly escaped.
  `,l=e.requiredFeatures&&e.requiredFeatures.length>0?`
    MANDATORY FEATURES: The following features MUST be included in the key:
    ${e.requiredFeatures.map((m,g)=>`${g+1}. ${m}`).join(`
    `)}
`:"",u=()=>{const m=[];return e.scope==="global"?m.push("Global scope"):e.scope==="national"?m.push("Brazil (national)"):e.scope==="regional"&&m.push("Regional focus"),e.biome&&m.push(`Biome: ${e.biome}`),e.stateUF&&m.push(`State/UF: ${e.stateUF}`),e.geography&&m.push(`Region: ${e.geography}`),m.length>0?m.join(", "):"Global"},c=()=>{const m=[];return e.taxonomyFamily&&m.push(`Family: ${e.taxonomyFamily}`),e.taxonomyGenus&&m.push(`Genus: ${e.taxonomyGenus}`),e.taxonomy&&m.push(e.taxonomy),m.length>0?m.join(", "):"General"},p=`
    Create an identification key for: "${e.topic}".
    
    Constraints:
    - Language: ${e.language==="pt"?"Portuguese":"English"}
    - Geographic Scope: ${u()}
    - Taxonomic Context: ${c()}
    - Target Number of Entities: ${e.count}
    - Target Number of Features: ${e.featureCount}
    - Feature Focus: ${e.featureFocus}
    - Complexity Level: ${e.detailLevel}/3
    ${l}
    IMPORTANT: For each entity, you MUST provide the scientificName field with the correct binomial nomenclature (e.g., "Panthera leo" for Lion).
    ${e.taxonomyFamily?`All entities MUST belong to the family ${e.taxonomyFamily}.`:""}
    ${e.taxonomyGenus?`All entities MUST belong to the genus ${e.taxonomyGenus}.`:""}
    ${e.biome?`All entities MUST occur in the ${e.biome} biome.`:""}
    ${e.stateUF?`All entities MUST occur in ${e.stateUF}, Brazil.`:""}
    ${e.scope==="national"?"All entities MUST occur in Brazil. Use Flora do Brasil 2020 as reference for valid names.":""}

    Ensure the features allow for effective separation of these entities.
  `;return{systemInstruction:a,prompt:p,schema:zv,parts:void 0}},EM=async(e,t,n,r)=>{if(!t)throw new Error("API Key is missing");const i=new Uv({apiKey:t}),{systemInstruction:s,prompt:o,parts:a,schema:l}=jv(e);n&&n(`SYSTEM:
${s}

USER PROMPT:
${o}`);const u=a||o,c=await Wv(i,e.model,u,s,l,e.language,e.includeLinks);if(e.includeSpeciesImages&&c.entities.length>0){const p=c.entities.map(g=>({name:g.name,scientificName:g.scientificName||Vv(g.name)||g.name})),m=await Bv(p,e.language,r);c.entities=c.entities.map(g=>{const{scientificName:y,...x}=g;return{...x,imageUrl:m.get(g.name)||Gv(g.name)}})}return c},Ca=async(e,t,n="gemini-2.5-flash",r="pt")=>{if(!t)throw new Error("API Key is missing");const i=new Uv({apiKey:t});return await Wv(i,n,e,"You are an expert biologist. Return ONLY valid JSON matching the schema. Do not include markdown code fences.",zv,r,!0)};async function Wv(e,t,n,r,i,s="en",o=!0){const a=async l=>{var u,c;try{return await e.models.generateContent({model:l.trim(),contents:n,config:{systemInstruction:r,responseMimeType:"application/json",responseSchema:i,maxOutputTokens:65536}})}catch(p){if((u=p.message)!=null&&u.includes("404")||(c=p.message)!=null&&c.includes("NOT_FOUND")){const m="gemini-2.5-flash";if(l!==m)return console.warn(`Model ${l} not found, falling back to ${m}`),await a(m)}throw p}};try{const u=await a(t||"gemini-2.5-flash"),c=vM(u.text||"{}");if(!c.projectName)throw new Error("Invalid AI response");const p=c.features.map(g=>({id:rn(),name:g.name,imageUrl:g.imageUrl||"",states:g.states.map(y=>({id:rn(),label:y}))})),m=c.entities.map(g=>{const y={};g.traits.forEach(_=>{let N="",B="";if(typeof _=="string"){const G=_.indexOf(":");G>-1&&(N=_.substring(0,G).trim(),B=_.substring(G+1).trim())}else typeof _=="object"&&_!==null&&(N=_.featureName,B=_.stateValue);if(N&&B){const G=p.find(k=>k.name.toLowerCase()===N.toLowerCase());if(G){const k=G.states.find(D=>D.label.toLowerCase()===B.toLowerCase());k&&(y[G.id]||(y[G.id]=[]),y[G.id].push(k.id))}}});const x=g.scientificName||Vv(g.name)||g.name,S=g.family||"",T=Gv(g.name),E=o?xM(x,S,s):[];return{id:rn(),name:g.name,scientificName:x,family:S,description:g.description,imageUrl:T,links:E,traits:y}});return{id:rn(),name:c.projectName,description:c.projectDescription,features:p,entities:m}}catch(l){throw console.error("Gemini Generation Error:",l),l}}const TM=(e,t)=>{const n=JSON.stringify(e);return`<!DOCTYPE html>
<html lang="${t}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${e.name} - NOZESia Key</title>
  <script src="https://cdn.tailwindcss.com"><\/script>
  <style>
    .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
  </style>
</head>
<body class="bg-slate-100 font-sans">
  <div id="app"></div>
  <script>
    const project = ${n};
    const lang = "${t}";
    const t = {
      en: {
        features: "Features", selected: "selected", matches: "Matches", discarded: "Discarded",
        restart: "Restart", noMatches: "No matches found.", tryUnselecting: "Try unselecting some features.",
        potential: "potential matches", identified: "1 Entity identified", close: "Close",
        speciesDetails: "Species Details", morphology: "Morphology & Traits", resources: "Resources",
        createdWith: "Created with NOZESia", viewResults: "View Results", excluded: "Excluded by selection"
      },
      pt: {
        features: "Caractersticas", selected: "selecionado(s)", matches: "Compatveis", discarded: "Descartados",
        restart: "Reiniciar", noMatches: "Nenhum resultado.", tryUnselecting: "Tente remover selees.",
        potential: "matches potenciais", identified: "1 Entidade identificada", close: "Fechar",
        speciesDetails: "Detalhes da Espcie", morphology: "Morfologia & Caractersticas", resources: "Recursos Adicionais",
        createdWith: "Criado com NOZESia", viewResults: "Ver Resultados", excluded: "Excludo pela seleo"
      }
    };
    const strings = t[lang];
    
    let selections = {};
    let showDiscarded = false;
    let viewingEntity = null;
    let mobileTab = 'FILTERS';
    
    function toggleSelection(featureId, stateId) {
      if (!selections[featureId]) selections[featureId] = [];
      const idx = selections[featureId].indexOf(stateId);
      if (idx >= 0) {
        selections[featureId].splice(idx, 1);
        if (selections[featureId].length === 0) delete selections[featureId];
      } else {
        selections[featureId].push(stateId);
      }
      render();
    }
    
    function resetKey() { selections = {}; render(); }
    function setMobileTab(tab) { mobileTab = tab; render(); }
    function toggleDiscarded() { showDiscarded = !showDiscarded; render(); }
    function viewEntity(entity) { viewingEntity = entity; render(); }
    function closeEntity() { viewingEntity = null; render(); }
    
    function getFilteredEntities() {
      const remaining = [], discarded = [];
      project.entities.forEach(entity => {
        let isMatch = true;
        for (const [fid, sids] of Object.entries(selections)) {
          const entityStates = entity.traits[fid] || [];
          if (!sids.some(id => entityStates.includes(id))) { isMatch = false; break; }
        }
        if (isMatch) remaining.push(entity); else discarded.push(entity);
      });
      return { remaining, discarded };
    }
    
    function getTotalSelections() {
      return Object.values(selections).reduce((a, c) => a + c.length, 0);
    }
    
    function render() {
      const { remaining, discarded } = getFilteredEntities();
      const totalSel = getTotalSelections();
      
      let entityModalHTML = '';
      if (viewingEntity) {
        const e = viewingEntity;
        const traitsHTML = project.features.map(f => {
          const stateIds = e.traits[f.id] || [];
          const stateLabels = stateIds.map(sid => f.states.find(s => s.id === sid)?.label).filter(Boolean).join(', ');
          return stateLabels ? \`<div class="flex justify-between py-2 border-b border-slate-100"><span class="text-slate-500">\${f.name}</span><span class="font-medium text-slate-800">\${stateLabels}</span></div>\` : '';
        }).join('');
        const linksHTML = e.links && e.links.length > 0 ? \`<div class="mt-6"><h4 class="font-semibold text-slate-700 mb-3">\${strings.resources}</h4><div class="space-y-2">\${e.links.map(l => \`<a href="\${l.url}" target="_blank" class="flex items-center gap-2 text-emerald-600 hover:underline text-sm"><span></span>\${l.label}</a>\`).join('')}</div></div>\` : '';
        entityModalHTML = \`
          <div class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4" onclick="if(event.target===this)closeEntity()">
            <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col">
              <div class="relative h-48 sm:h-64 bg-slate-200 shrink-0">
                \${e.imageUrl ? \`<img src="\${e.imageUrl}" class="w-full h-full object-cover" onerror="this.style.display='none'">\` : '<div class="w-full h-full flex items-center justify-center text-slate-400 text-6xl"></div>'}
                <button onclick="closeEntity()" class="absolute top-3 right-3 bg-black/40 hover:bg-black/60 text-white rounded-full p-2"></button>
              </div>
              <div class="p-6 overflow-y-auto custom-scrollbar">
                <h2 class="text-2xl font-bold text-slate-800 mb-1">\${e.name}</h2>
                \${e.description ? \`<p class="text-slate-600 mb-4">\${e.description}</p>\` : ''}
                <div class="mt-4"><h4 class="font-semibold text-slate-700 mb-2">\${strings.morphology}</h4><div class="text-sm">\${traitsHTML}</div></div>
                \${linksHTML}
              </div>
            </div>
          </div>
        \`;
      }
      
      const featuresHTML = project.features.map(f => {
        const selStates = selections[f.id] || [];
        return \`
          <div class="bg-slate-50 rounded-xl p-4">
            <h4 class="font-semibold text-slate-700 mb-3 flex items-center gap-2">
              \${f.imageUrl ? \`<img src="\${f.imageUrl}" class="w-6 h-6 rounded object-cover">\` : ''}
              \${f.name}
              \${selStates.length > 0 ? \`<span class="ml-auto text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full">\${selStates.length}</span>\` : ''}
            </h4>
            <div class="flex flex-wrap gap-2">
              \${f.states.map(s => {
                const isSel = selStates.includes(s.id);
                return \`<button onclick="toggleSelection('\${f.id}','\${s.id}')" class="px-3 py-1.5 rounded-lg text-sm font-medium transition-all \${isSel ? 'bg-emerald-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-100 border border-slate-200'}">\${s.label}</button>\`;
              }).join('')}
            </div>
          </div>
        \`;
      }).join('');
      
      const entityCard = (e, isDiscarded = false) => \`
        <div onclick="viewEntity(project.entities.find(x=>x.id==='\${e.id}'))" class="bg-white rounded-xl shadow-sm hover:shadow-lg transition-all cursor-pointer overflow-hidden border \${isDiscarded ? 'border-red-200 opacity-60' : 'border-slate-200 hover:border-emerald-300'}">
          <div class="h-32 bg-slate-100 relative">
            \${e.imageUrl ? \`<img src="\${e.imageUrl}" class="w-full h-full object-cover" onerror="this.parentElement.innerHTML='<div class=\\\\'w-full h-full flex items-center justify-center text-slate-300 text-4xl\\\\'></div>'">\` : '<div class="w-full h-full flex items-center justify-center text-slate-300 text-4xl"></div>'}
            \${isDiscarded ? '<div class="absolute inset-0 bg-red-500/20 flex items-center justify-center"><span class="bg-red-500 text-white text-xs px-2 py-1 rounded"></span></div>' : ''}
          </div>
          <div class="p-3">
            <h4 class="font-semibold text-slate-800 text-sm truncate">\${e.name}</h4>
            \${e.description ? \`<p class="text-xs text-slate-500 mt-1 line-clamp-2">\${e.description}</p>\` : ''}
          </div>
        </div>
      \`;
      
      const remainingHTML = remaining.length > 0 
        ? remaining.map(e => entityCard(e)).join('')
        : \`<div class="col-span-full text-center py-12 text-slate-500"><div class="text-4xl mb-3"></div><p class="font-medium">\${strings.noMatches}</p><p class="text-sm">\${strings.tryUnselecting}</p></div>\`;
      
      const discardedHTML = discarded.length > 0 && showDiscarded
        ? \`<div class="mt-6 pt-6 border-t"><h4 class="font-semibold text-slate-500 mb-4 flex items-center gap-2"> \${strings.discarded} (\${discarded.length})</h4><div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">\${discarded.map(e => entityCard(e, true)).join('')}</div></div>\`
        : '';
      
      document.getElementById('app').innerHTML = \`
        <div class="min-h-screen flex flex-col">
          <header class="bg-white border-b px-4 py-3 flex justify-between items-center shadow-sm">
            <div class="flex items-center gap-3">
              <span class="bg-emerald-600 text-white text-xs px-2 py-1 rounded font-bold">KEY</span>
              <h1 class="text-lg font-bold text-slate-800 truncate">\${project.name}</h1>
            </div>
            <button onclick="resetKey()" class="flex items-center gap-2 px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg"> \${strings.restart}</button>
          </header>
          
          <div class="md:hidden flex border-b bg-white">
            <button onclick="setMobileTab('FILTERS')" class="flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 \${mobileTab==='FILTERS'?'text-emerald-600 border-b-2 border-emerald-600':'text-slate-500 bg-slate-50'}">
               \${strings.features} \${totalSel>0?\`<span class="bg-emerald-600 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center">\${totalSel}</span>\`:''}
            </button>
            <button onclick="setMobileTab('RESULTS')" class="flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 \${mobileTab==='RESULTS'?'text-emerald-600 border-b-2 border-emerald-600':'text-slate-500 bg-slate-50'}">
               \${strings.matches} <span class="bg-slate-200 text-slate-700 text-xs px-1.5 py-0.5 rounded-full">\${remaining.length}</span>
            </button>
          </div>
          
          <div class="flex-1 flex flex-col md:flex-row overflow-hidden">
            <div class="w-full md:w-1/3 lg:w-1/4 bg-white md:border-r flex-col h-full \${mobileTab==='FILTERS'?'flex':'hidden md:flex'}">
              <div class="hidden md:block p-4 border-b bg-slate-50">
                <h3 class="font-semibold text-slate-700 flex items-center gap-2"> \${strings.features}</h3>
              </div>
              <div class="flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar">\${featuresHTML}</div>
            </div>
            
            <div class="flex-1 flex flex-col h-full \${mobileTab==='RESULTS'?'flex':'hidden md:flex'}">
              <div class="p-4 border-b bg-slate-50 flex justify-between items-center">
                <div>
                  <span class="font-semibold text-slate-700">\${remaining.length === 1 ? strings.identified : remaining.length + ' ' + strings.potential}</span>
                </div>
                \${discarded.length > 0 ? \`<button onclick="toggleDiscarded()" class="text-sm text-slate-500 hover:text-slate-700 flex items-center gap-1">\${showDiscarded?'':''} \${strings.discarded} (\${discarded.length})</button>\` : ''}
              </div>
              <div class="flex-1 overflow-y-auto p-4 custom-scrollbar">
                <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">\${remainingHTML}</div>
                \${discardedHTML}
              </div>
            </div>
          </div>
          
          <footer class="bg-white border-t px-4 py-2 text-center text-xs text-slate-400">
            \${strings.createdWith}  <a href="https://djhandoom.github.io/nozes/" target="_blank" class="text-emerald-600 hover:underline">djhandoom.github.io/nozes</a>
          </footer>
        </div>
        \${entityModalHTML}
      \`;
    }
    
    render();
  <\/script>
</body>
</html>`},_M={en:{builder:"Builder",aiWizard:"Nuts AI",savePlay:"Save & Play",exit:"Exit",save:"Save",open:"Open",export:"Export Project",exportXLSX:"Export XLSX",exportHTML:"Export HTML",import:"Import Project",general:"General",features:"Features",entities:"Entities",matrix:"Matrix Scoring",projectName:"Project Name",description:"Description",definedFeatures:"Defined Features",definedFeaturesDesc:"Define traits and their possible states.",addFeature:"Add Feature",featureName:"Feature Name",imageURL:"Image URL (optional)",states:"States",addState:"Add State",manageEntities:"Entities",manageEntitiesDesc:"Manage the taxa included in your key.",addEntity:"Add Entity",scoringMatrix:"Scoring Matrix",scoringMatrixDesc:"Click cells to toggle state association",taxaFeatures:"Taxa / Features",aiTitle:"Nuts AI Wizard",aiDesc:"Generate or Extract keys using Gemini AI.",topic:"Key Topic / Subject",topicPlace:"e.g. Freshwater Fishes, Garden Weeds",geography:"Geographic Scope",taxonomyFamily:"Family",taxonomyGenus:"Genus",biome:"Biome",stateUF:"State/Region",scopeLabel:"Scope",scopeGlobal:"Global",scopeNational:"National (Brazil)",scopeRegional:"Regional",taxonomyFilters:"Taxonomic Filters",geographyFilters:"Geographic Filters",numEntities:"Approx. # of Entities",numFeatures:"Approx. # of Features",requiredFeatures:"Required Features",requiredFeaturesDesc:"Select features the AI must include",addCustomFeature:"Add custom feature...",selectedFeatures:"selected",generating:"Nozes IA is thinking... (15-45s)",cancel:"Cancel",generate:"Generate Key",savedMsg:"Project saved to browser storage!",errGen:"Failed to generate key. Check console.",featureFocus:"Feature Focus",focusGeneral:"General (All)",focusRepro:"Reproductive Only",focusVeg:"Vegetative Only",options:"Options",fetchSpeciesImg:"Fetch Species Images",fetchFeatureImg:"Fetch Feature Images",fetchLinks:"Fetch External Links",detailLevel:"Detail Level",detailSimple:"Simplified",detailBalanced:"Balanced",detailExpert:"Expert / High",detailOriginal:"Original Fidelity",noSaved:"No saved projects.",close:"Close",modeTopic:"Generate from Topic",modeImport:"Import from File",uploadLabel:"Upload PDF, Image, or Text",uploadDesc:"The AI will study the document and extract entities and features automatically.",supportedFormats:"Supports: .pdf, .txt, .jpg, .png",dropFile:"Drop file here",removeFile:"Remove file",analyzing:"Analyzing document...",promptCopied:"Prompt copied to clipboard!",configSettings:"Configuration",links:"Additional Links / Resources",addLink:"Add Link",editTraits:"Edit Characteristics",traitEditor:"Trait Editor",copyPrompt:"Copy",missingKey:"Missing API Key. Please configure it in the main menu Settings.",apiKeyWarning:"Configure your API Key to use AI features",clickGear:"Click the key icon above",modeRefine:"Expand/Refine",refineTitle:"Enhance Current Key",refineDesc:"Use AI to expand or refine your existing identification key.",actionExpand:"Expand Entities",actionExpandDesc:"Add new species/entities similar to existing ones",actionRefine:"Refine Features",actionRefineDesc:"Improve feature descriptions and add discriminating traits",actionClean:"Clean & Optimize",actionCleanDesc:"Remove redundant features, fix inconsistencies",expandCount:"# New Entities to Add",keepExisting:"Preserve existing entities",addFeatures:"Add new discriminating features",improveDescriptions:"Improve descriptions",fillGaps:"Fill missing trait data",removeRedundant:"Remove redundant features",fixInconsistencies:"Fix inconsistencies",currentProject:"Current Project",noProjectLoaded:"No project loaded. Create or load a project first.",entitiesCount:"entities",featuresCount:"features",completePhotos:"Complete Photo Collection",completePhotosDesc:"Fill missing images with valid URLs",photoTargetEntities:"Entity Images",photoTargetFeatures:"Feature Images",photoTargetBoth:"Both",actionPhotos:"Complete Photos",actionPhotosDesc:"Fill all missing images with real URLs",photosActionDesc:"Select which images to complete with valid URLs",actionValidate:"Validate Taxonomy",actionValidateDesc:"Check species names, synonyms, and geographic distribution",validateOptions:"Validation Options",validateFixNames:"Correct invalid/outdated names",validateFixNamesDesc:"Update names according to Flora do Brasil 2020 or other catalogs",validateMergeSynonyms:"Merge synonyms",validateMergeSynonymsDesc:"Combine synonymous species, preserving traits from both",validateCheckGeography:"Check geographic distribution",validateCheckGeographyDesc:"Remove species outside the defined geographic scope",validateCheckTaxonomy:"Check taxonomic scope",validateCheckTaxonomyDesc:"Remove species outside the defined family/genus",validateReference:"Reference Catalog",validateFloradobrasil:"Flora do Brasil 2020",validateGbif:"GBIF Backbone",validatePowo:"POWO (Kew)",validateCustom:"Custom/Other",photoModeReplace:"Replace All",photoModeReplaceDesc:"Clear existing and find new photos",photoModeExpand:"Only Fill Missing",photoModeExpandDesc:"Keep existing, fill empty only",photoCustomSources:"Custom Sources (optional)",photoCustomSourcesPlaceholder:`Paste URLs of image databases separated by newlines
e.g., https://inaturalist.org
https://floradobrasil.jbrj.gov.br`,modeMerge:"Merge Keys",mergeTitle:"Combine Two Keys",mergeDesc:"Import two JSON keys and merge them into one optimized key.",mergeKey1:"First Key (JSON)",mergeKey2:"Second Key (JSON)",uploadKey1:"Upload Key 1 (JSON)",uploadKey2:"Upload Key 2 (JSON)",mergeStrategy:"Merge Strategy",strategyUnion:"Union (All-inclusive)",strategyUnionDesc:"Include all features and entities from both keys",strategyIntersection:"Intersection (Common)",strategyIntersectionDesc:"Focus on shared characteristics between keys",strategyPrimary:"Primary (Key 1 base)",strategyPrimaryDesc:"Use Key 1 as base, add unique elements from Key 2",remove:"Remove",mergeAction:"Merge Keys",mergeLoaded:"loaded"},pt:{builder:"Construtor",aiWizard:"Nozes IA",savePlay:"Salvar & Testar",exit:"Sair",save:"Salvar",open:"Abrir",export:"Exportar Projeto",exportXLSX:"Exportar XLSX",exportHTML:"Exportar HTML",import:"Importar Projeto",general:"Geral",features:"Caractersticas",entities:"Entidades",matrix:"Matriz",projectName:"Nome do Projeto",description:"Descrio",definedFeatures:"Caractersticas Definidas",definedFeaturesDesc:"Defina caractersticas e seus estados possveis.",addFeature:"Adicionar Caracterstica",featureName:"Nome",imageURL:"URL da Imagem (opcional)",states:"Estados",addState:"Adicionar Estado",manageEntities:"Entidades",manageEntitiesDesc:"Gerencie os txons includos na chave.",addEntity:"Adicionar Entidade",scoringMatrix:"Matriz de Pontuao",scoringMatrixDesc:"Clique nas clulas para associar estados",taxaFeatures:"Txons / Caractersticas",aiTitle:"Assistente Nozes IA",aiDesc:"Gere ou Extraia chaves usando Gemini IA.",topic:"Tpico / Assunto",topicPlace:"ex: Peixes de gua Doce, Ervas Daninhas",geography:"Escopo Geogrfico",taxonomyFamily:"Famlia",taxonomyGenus:"Gnero",biome:"Bioma",stateUF:"Estado/UF",scopeLabel:"Escopo",scopeGlobal:"Global",scopeNational:"Nacional (Brasil)",scopeRegional:"Regional",taxonomyFilters:"Filtros Taxonmicos",geographyFilters:"Filtros Geogrficos",numEntities:"Aprox. # de Entidades",numFeatures:"Aprox. # de Caractersticas",requiredFeatures:"Caractersticas Obrigatrias",requiredFeaturesDesc:"Selecione caractersticas que a IA deve incluir",addCustomFeature:"Adicionar caracterstica...",selectedFeatures:"selecionadas",generating:"Nozes IA est pensando... (15-45s)",cancel:"Cancelar",generate:"Gerar Chave",savedMsg:"Projeto salvo no navegador!",errGen:"Falha ao gerar chave. Verifique o console.",featureFocus:"Foco das Caractersticas",focusGeneral:"Geral (Todas)",focusRepro:"Apenas Reprodutivas",focusVeg:"Apenas Vegetativas",options:"Opes",fetchSpeciesImg:"Buscar Imagens de Espcies",fetchFeatureImg:"Buscar Imagens de Caractersticas",fetchLinks:"Buscar Links/Materiais",detailLevel:"Nvel de Detalhe",detailSimple:"Simplificado",detailBalanced:"Equilibrado",detailExpert:"Especialista / Alto",detailOriginal:"Fidelidade Original",noSaved:"Nenhum projeto salvo.",close:"Fechar",modeTopic:"Gerar por Tpico",modeImport:"Importar Arquivo",uploadLabel:"Upload PDF, Imagem ou Texto",uploadDesc:"A IA estudar o documento e extrair entidades e caractersticas automaticamente.",supportedFormats:"Suporta: .pdf, .txt, .jpg, .png",dropFile:"Solte o arquivo aqui",removeFile:"Remover arquivo",analyzing:"Analisando documento...",promptCopied:"Prompt copiado para a rea de transferncia!",configSettings:"Configurao",links:"Links Adicionais / Materiais",addLink:"Adicionar Link",editTraits:"Editar Caractersticas",traitEditor:"Editor de Caractersticas",copyPrompt:"Copiar",missingKey:"Falta a Chave da API. Configure-a nas Configuraes do menu principal.",apiKeyWarning:"Configure sua Chave de API para usar a IA",clickGear:"Clique na chave acima",modeRefine:"Expandir/Refinar",refineTitle:"Aprimorar Chave Atual",refineDesc:"Use IA para expandir ou refinar sua chave de identificao existente.",actionExpand:"Expandir Entidades",actionExpandDesc:"Adicionar novas espcies/entidades similares s existentes",actionRefine:"Refinar Caractersticas",actionRefineDesc:"Melhorar descries e adicionar caractersticas discriminantes",actionClean:"Limpar & Otimizar",actionCleanDesc:"Remover caractersticas redundantes, corrigir inconsistncias",expandCount:"# Novas Entidades a Adicionar",keepExisting:"Preservar entidades existentes",addFeatures:"Adicionar novas caractersticas discriminantes",improveDescriptions:"Melhorar descries",fillGaps:"Preencher dados de caractersticas faltantes",removeRedundant:"Remover caractersticas redundantes",fixInconsistencies:"Corrigir inconsistncias",currentProject:"Projeto Atual",noProjectLoaded:"Nenhum projeto carregado. Crie ou carregue um projeto primeiro.",entitiesCount:"entidades",featuresCount:"caractersticas",completePhotos:"Completar Acervo Fotogrfico",completePhotosDesc:"Preencher imagens faltantes com URLs vlidas",photoTargetEntities:"Imagens de Entidades",photoTargetFeatures:"Imagens de Caractersticas",photoTargetBoth:"Ambos",actionPhotos:"Completar Fotos",actionPhotosDesc:"Preencher todas as imagens faltantes com URLs reais",photosActionDesc:"Selecione quais imagens completar com URLs vlidas",actionValidate:"Validar Taxonomia",actionValidateDesc:"Verificar nomes de espcies, sinonmias e distribuio geogrfica",validateOptions:"Opes de Validao",validateFixNames:"Corrigir nomes invlidos/desatualizados",validateFixNamesDesc:"Atualizar nomes conforme Flora do Brasil 2020 ou outros catlogos",validateMergeSynonyms:"Mesclar sinnimos",validateMergeSynonymsDesc:"Combinar espcies sinnimas, preservando caractersticas de ambas",validateCheckGeography:"Verificar distribuio geogrfica",validateCheckGeographyDesc:"Remover espcies fora do escopo geogrfico definido",validateCheckTaxonomy:"Verificar escopo taxonmico",validateCheckTaxonomyDesc:"Remover espcies fora da famlia/gnero definido",validateReference:"Catlogo de Referncia",validateFloradobrasil:"Flora do Brasil 2020",validateGbif:"GBIF Backbone",validatePowo:"POWO (Kew)",validateCustom:"Personalizado/Outro",photoModeReplace:"Substituir Todas",photoModeReplaceDesc:"Limpar existentes e buscar novas",photoModeExpand:"Apenas Preencher Faltantes",photoModeExpandDesc:"Manter existentes, preencher vazias",photoCustomSources:"Fontes Personalizadas (opcional)",photoCustomSourcesPlaceholder:`Cole URLs de bancos de imagens separados por quebras de linha
ex: https://inaturalist.org
https://floradobrasil.jbrj.gov.br`,modeMerge:"Combinar",mergeTitle:"Combinar Duas Chaves",mergeDesc:"Importe dois JSONs e combine-os em uma chave otimizada.",mergeKey1:"Primeira Chave (JSON)",mergeKey2:"Segunda Chave (JSON)",uploadKey1:"Carregar Chave 1 (JSON)",uploadKey2:"Carregar Chave 2 (JSON)",mergeStrategy:"Estratgia de Combinao",strategyUnion:"Unio (Tudo includo)",strategyUnionDesc:"Incluir todas as caractersticas e entidades de ambas as chaves",strategyIntersection:"Interseo (Comum)",strategyIntersectionDesc:"Focar nas caractersticas compartilhadas entre as chaves",strategyPrimary:"Primria (Base Chave 1)",strategyPrimaryDesc:"Usar Chave 1 como base, adicionar elementos nicos da Chave 2",remove:"Remover",mergeAction:"Combinar Chaves",mergeLoaded:"carregado"}},SM=({initialProject:e,onSave:t,onCancel:n,language:r,defaultModel:i,apiKey:s,onOpenSettings:o,reopenAiModal:a,onAiModalOpened:l,onProjectImported:u})=>{var I,F,M,K,Z;const c=_M[r],[p,m]=Te.useState(e||{id:Math.random().toString(36).substr(2,9),name:r==="pt"?"Nova Chave":"New Key",description:"",features:[],entities:[]}),[g,y]=Te.useState("GENERAL"),[x,S]=Te.useState({topic:"",count:10,featureCount:5,geography:"",taxonomy:"",taxonomyFamily:"",taxonomyGenus:"",biome:"",stateUF:"",scope:"national",language:r,featureFocus:"general",includeSpeciesImages:!0,includeFeatureImages:!0,includeLinks:!0,model:i,detailLevel:2}),[T,E]=Te.useState(!1),[_,N]=Te.useState(""),[B,G]=Te.useState(!1),[k,D]=Te.useState("TOPIC"),[b,O]=Te.useState(null),[J,X]=Te.useState([]),[re,we]=Te.useState(!1),[_e,Ne]=Te.useState(!1),[ge,ae]=Te.useState("EXPAND"),[z,se]=Te.useState({expandCount:10,keepExisting:!0,addFeatures:!0,improveDescriptions:!0,fillGaps:!0,removeRedundant:!1,fixInconsistencies:!0,completePhotos:!1,photoTarget:"both",photoMode:"expand",photoCustomSources:"",validateFixNames:!0,validateMergeSynonyms:!0,validateCheckGeography:!0,validateCheckTaxonomy:!0,validateReference:"floradobrasil",validateFamily:"",validateGenus:"",validateBiome:"",validateStateUF:"",validateScope:"national"}),[ye,L]=Te.useState(null),[W,H]=Te.useState(null),[V,ne]=Te.useState("union"),[ce,Ee]=Te.useState([]),[ve,fe]=Te.useState(!1),[Pe,ke]=Te.useState(""),yt=r==="pt"?[{category:"Vegetativas",items:["Tipo de folha (simples/composta)","Filotaxia (alterna/oposta/verticilada)","Margem foliar","Forma da folha","Textura da folha","Presena de estpulas","Tipo de nervao","Forma do caule","Tipo de casca","Hbito de crescimento","Presena de espinhos/acleos","Presena de ltex","Tipo de raiz","Presena de tricomas/pelos","Domcias"]},{category:"Reprodutivas",items:["Tipo de inflorescncia","Cor da flor","Nmero de ptalas","Simetria floral","Tipo de fruto","Cor do fruto","Tipo de semente","Deiscncia do fruto"]},{category:"Ecolgicas",items:["Ambiente/habitat","Altitude","Fenologia","Polinizadores","Disperso"]}]:[{category:"Vegetative",items:["Leaf type (simple/compound)","Phyllotaxy (alternate/opposite/whorled)","Leaf margin","Leaf shape","Leaf texture","Stipule presence","Venation type","Stem shape","Bark type","Growth habit","Spine/prickle presence","Latex presence","Root type","Trichome/hair presence","Domatia"]},{category:"Reproductive",items:["Inflorescence type","Flower color","Petal number","Floral symmetry","Fruit type","Fruit color","Seed type","Fruit dehiscence"]},{category:"Ecological",items:["Habitat/environment","Altitude","Phenology","Pollinators","Dispersal"]}],[Me,je]=Te.useState(!1),[We,he]=Te.useState(""),[Rt,qe]=Te.useState(""),[Zn,tn]=Te.useState(!1),Ut=Ia.useRef(null),Er=Ia.useRef(null),[Bt,Tr]=Te.useState(null),[zn,_i]=Te.useState(p.features.length>0?p.features[0].id:null),mn=Ia.useRef(null),[Dd,zo]=Te.useState(!1),_r=v=>{const C=zn!==v;_i(P=>P===v?null:v),C&&mn.current&&setTimeout(()=>{const P=mn.current;if(!P)return;const U=p.features.findIndex(te=>te.id===v);if(U===-1)return;let j=200;for(let te=0;te<U;te++)j+=70;const Y=P.clientWidth,q=p.features[U].states.length*90,ee=j-Y/2+q/2;P.scrollTo({left:Math.max(0,ee),behavior:"smooth"})},100)},Ss=v=>{const C=p.features.findIndex(U=>U.id===zn);if(C===-1)return;const P=v==="prev"?(C-1+p.features.length)%p.features.length:(C+1)%p.features.length;_r(p.features[P].id)};Te.useEffect(()=>{S(v=>({...v,language:r}))},[r]),Te.useEffect(()=>{a&&(G(!0),l==null||l())},[a,l]),Te.useEffect(()=>{S(v=>({...v,model:i}))},[i]),Te.useEffect(()=>{const v=mn.current;if(!v)return;const C=()=>{zo(v.scrollTop>0)};return v.addEventListener("scroll",C),()=>v.removeEventListener("scroll",C)},[]),Te.useEffect(()=>{const v=localStorage.getItem("nozesia_projects");if(v)try{X(JSON.parse(v))}catch{console.error("Failed to load local projects")}},[]),Te.useEffect(()=>{Er.current&&Rt&&(Er.current.scrollTop=Er.current.scrollHeight)},[Rt]);const ws=v=>m(C=>({...C,...v})),Cs=()=>{const v=[p,...J.filter(C=>C.id!==p.id)];X(v),localStorage.setItem("nozesia_projects",JSON.stringify(v)),alert(c.savedMsg)},jo=v=>{m(v),we(!1)},Wo=()=>{const v="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(p)),C=document.createElement("a");C.setAttribute("href",v),C.setAttribute("download",`${p.name.replace(/\s+/g,"_")}.json`),document.body.appendChild(C),C.click(),C.remove()},qo=()=>{const v=vn.book_new(),C=p.entities.map(me=>{var pe,Ce;return{ID:me.id,Name:me.name,Description:me.description,ImageURL:me.imageUrl,LinkLabels:((pe=me.links)==null?void 0:pe.map(Le=>Le.label).join("; "))||"",LinkURLs:((Ce=me.links)==null?void 0:Ce.map(Le=>Le.url).join("; "))||""}}),P=vn.json_to_sheet(C);vn.book_append_sheet(v,P,"Entities");const U=p.features.map(me=>({ID:me.id,Name:me.name,ImageURL:me.imageUrl,States:me.states.map(pe=>pe.label).join("; ")})),j=vn.json_to_sheet(U);vn.book_append_sheet(v,j,"Features");const Y=p.entities.map(me=>{const pe={Entity:me.name};return p.features.forEach(Ce=>{const Le=me.traits[Ce.id]||[],$e=Ce.states.filter(Et=>Le.includes(Et.id)).map(Et=>Et.label).join(", ");pe[Ce.name]=$e}),pe}),q=vn.json_to_sheet(Y);vn.book_append_sheet(v,q,"Matrix");const ee=[{Name:p.name,Description:p.description,ExportDate:new Date().toISOString().split("T")[0],TotalEntities:p.entities.length,TotalFeatures:p.features.length}],te=vn.json_to_sheet(ee);vn.book_append_sheet(v,te,"Project Info"),av(v,`${p.name.replace(/\s+/g,"_")}.xlsx`)},As=()=>{const v=TM(p,r),C=new Blob([v],{type:"text/html;charset=utf-8"}),P=URL.createObjectURL(C),U=document.createElement("a");U.href=P,U.download=`${p.name.replace(/\s+/g,"_")}.html`,U.click(),URL.revokeObjectURL(P)},Ns=v=>{const C=new FileReader;v.target.files&&v.target.files[0]&&(C.readAsText(v.target.files[0],"UTF-8"),C.onload=P=>{var U;try{const j=JSON.parse((U=P.target)==null?void 0:U.result);if(j.name&&j.features&&j.entities){m(j);const Y=localStorage.getItem("nozesia_projects");let q=[];if(Y)try{q=JSON.parse(Y)}catch(te){console.error("Failed to parse projects",te)}const ee=[j,...q.filter(te=>te.id!==j.id)];localStorage.setItem("nozesia_projects",JSON.stringify(ee)),u&&u(j)}else alert("Invalid project file format.")}catch{alert("Error parsing JSON file.")}})},Jo=v=>{v.target.files&&v.target.files[0]&&O(v.target.files[0])},Ko=v=>new Promise((C,P)=>{const U=new FileReader;U.onload=()=>{const Y=U.result.split(",")[1];C(Y)},U.onerror=j=>P(j),U.readAsDataURL(v)}),uu=()=>{const v=[],C=r==="pt"?[" Analisando estrutura do documento..."," Identificando caractersticas taxonmicas..."," Processando matriz de identificao..."," Extraindo informaes das espcies..."]:[" Analyzing document structure..."," Identifying taxonomic features..."," Processing identification matrix..."," Extracting species information..."];if(v.push(...C),J.length>0){const P=r==="pt"?`
 Enquanto isso, voc sabia que...`:`
 Meanwhile, did you know that...`;v.push(P),J.forEach(q=>{if(q.entities&&q.entities.length>0&&[...q.entities].sort(()=>Math.random()-.5).slice(0,3).forEach(te=>{if(te.description&&te.description.length>20){const me=r==="pt"?`
 "${te.name}": ${te.description}`:`
 "${te.name}": ${te.description}`;v.push(me)}if(te.scientificName||te.family){const me=r==="pt"?`
    ${te.scientificName?`Nome cientfico: ${te.scientificName}`:""}${te.scientificName&&te.family?" | ":""}${te.family?`Famlia: ${te.family}`:""}`:`
    ${te.scientificName?`Scientific name: ${te.scientificName}`:""}${te.scientificName&&te.family?" | ":""}${te.family?`Family: ${te.family}`:""}`;(te.scientificName||te.family)&&v.push(me)}}),q.features&&q.features.length>0){const ee=q.features[Math.floor(Math.random()*q.features.length)];if(ee.states&&ee.states.length>1){const te=ee.states.map(pe=>pe.label).join(", "),me=r==="pt"?`
 A caracterstica "${ee.name}" pode ter os estados: ${te}`:`
 The feature "${ee.name}" can have states: ${te}`;v.push(me)}}});const U=J.reduce((q,ee)=>{var te;return q+(((te=ee.entities)==null?void 0:te.length)||0)},0),j=J.reduce((q,ee)=>{var te;return q+(((te=ee.features)==null?void 0:te.length)||0)},0),Y=r==="pt"?`

 Voc j catalogou ${U} entidades e ${j} caractersticas em ${J.length} chave(s)!`:`

 You have cataloged ${U} entities and ${j} features across ${J.length} key(s)!`;v.push(Y)}return v},kn=()=>{qe(""),tn(!1);const C=uu().join(`
`);let P=0;Ut.current&&clearInterval(Ut.current),Ut.current=setInterval(()=>{if(P<C.length){const U=Math.min(3,C.length-P);qe(j=>j+C.substring(P,P+U)),P+=U}},30)},Rn=v=>{var C,P,U,j,Y;if(Ut.current&&(clearInterval(Ut.current),Ut.current=null),v){const q=((C=v.entities)==null?void 0:C.length)||0,ee=((P=v.features)==null?void 0:P.length)||0,te=((U=v.features)==null?void 0:U.reduce(($e,Et)=>{var gn;return $e+(((gn=Et.states)==null?void 0:gn.length)||0)},0))||0,me=((j=v.entities)==null?void 0:j.filter($e=>$e.imageUrl&&!$e.imageUrl.includes("picsum.photos")&&!$e.imageUrl.includes("placehold.co")).length)||0,pe=((Y=v.entities)==null?void 0:Y.filter($e=>$e.links&&$e.links.length>0).length)||0,Ce=r==="pt"?`

 ATENO: REVISO NECESSRIA!

Os dados gerados por IA podem conter:
 Erros taxonmicos ou nomenclaturais
 Caractersticas incorretas ou incompletas
 Associaes espcie-caracterstica imprecisas
 Fotos que no correspondem  espcie

 REVISE E CORRIJA todos os dados antes
   de utilizar esta chave para identificao.`:`

 WARNING: REVIEW REQUIRED!

AI-generated data may contain:
 Taxonomic or nomenclatural errors
 Incorrect or incomplete features
 Inaccurate species-trait associations
 Photos that don't match the species

 REVIEW AND CORRECT all data before
   using this key for identification.`,Le=r==="pt"?`


 ANLISE CONCLUDA!


 Resumo da Gerao:

    Entidades: ${q}
    Caractersticas: ${ee}
    Estados totais: ${te}
    Com fotos: ${me}/${q}
    Com links: ${pe}/${q}${Ce}`:`


 ANALYSIS COMPLETE!


 Generation Summary:

    Entities: ${q}
    Features: ${ee}
    Total states: ${te}
    With photos: ${me}/${q}
    With links: ${pe}/${q}${Ce}`;qe($e=>$e+Le)}tn(!0)},cu=()=>{Ut.current&&(clearInterval(Ut.current),Ut.current=null),E(!1),N(""),qe(""),tn(!1),G(!1)},fu=async()=>{if(!s){alert(c.missingKey);return}E(!0),N(c.generating),G(!1),je(!0),kn();try{let v={...x,requiredFeatures:ce};if(k==="IMPORT"&&b){const P=await Ko(b);v.importedFile={data:P,mimeType:b.type},v.topic=`Imported: ${b.name}`}else if(k==="TOPIC"){if(!v.topic.trim())return;v.importedFile=void 0}const C=await EM(v,s,P=>{he(P)},(P,U,j)=>{const Y=x.language==="pt"?` Buscando imagens: ${P}/${U} - ${j}`:` Fetching images: ${P}/${U} - ${j}`;N(Y),qe(q=>{const ee=`
 ${j}...`;return q.includes(ee)?q:q+ee})});Rn(C),await new Promise(P=>setTimeout(P,2500)),m(C),je(!1),y("MATRIX")}catch(v){console.error(v),Rn(),qe(C=>C+(r==="pt"?`

 ERRO: No foi possvel gerar a chave.`:`

 ERROR: Could not generate the key.`)),await new Promise(C=>setTimeout(C,2e3)),alert(c.errGen),je(!1)}finally{E(!1),N("")}},Yo=()=>{var P,U,j;const v=JSON.stringify({name:p.name,description:p.description,features:p.features.map(Y=>({name:Y.name,imageUrl:Y.imageUrl||"",states:Y.states.map(q=>q.label)})),entities:p.entities.map(Y=>({name:Y.name,description:Y.description,imageUrl:Y.imageUrl||"",traits:Object.entries(Y.traits).map(([q,ee])=>{const te=p.features.find(me=>me.id===q);return ee.map(me=>{const pe=te==null?void 0:te.states.find(Ce=>Ce.id===me);return{featureName:(te==null?void 0:te.name)||"",stateValue:(pe==null?void 0:pe.label)||""}})}).flat()}))},null,2);let C="";if(ge==="PHOTOS"){const Y=z.photoTarget==="entities"||z.photoTarget==="both",q=z.photoTarget==="features"||z.photoTarget==="both",ee=z.photoMode==="replace",te=(P=z.photoCustomSources)==null?void 0:P.trim();let me={name:p.name};Y&&(me.entities=p.entities.map(Le=>({name:Le.name,currentUrl:ee?"":Le.imageUrl||""})).filter(Le=>ee||!Le.currentUrl)),q&&(me.features=p.features.map(Le=>({name:Le.name,currentUrl:ee?"":Le.imageUrl||""})).filter(Le=>ee||!Le.currentUrl));const pe=JSON.stringify(me,null,2);let Ce="";te?Ce=`
USER-PREFERRED SOURCES (check these FIRST, in order):
${te.split(`
`).filter($e=>$e.trim()).map(($e,Et)=>`${Et+1}. ${$e.trim()}`).join(`
`)}

If user sources don't have the image, then check these scientific databases:`:Ce=`
SCIENTIFIC IMAGE SOURCES (check in this order):`,C=`
# PHOTO COLLECTION TASK

You are an expert at finding HIGH-QUALITY, VALID image URLs from scientific databases.

## PROJECT: "${p.name}"
${p.description?`Description: ${p.description}`:""}

## ITEMS NEEDING PHOTOS:
${pe}

## YOUR TASK:
Find ONE valid, high-quality image URL for each item listed above.
${ee?"REPLACE ALL URLs - ignore any existing URLs and find new ones.":"ONLY FILL EMPTY URLs - skip items that already have a URL."}

## HOW TO FIND GOOD PHOTOS:
${Ce}
1. **iNaturalist** - Search: https://www.inaturalist.org/taxa/search?q=[species_name]
   - Navigate to species page  Photos tab  Right-click image  Copy Image Address
   - Valid format: https://inaturalist-open-data.s3.amazonaws.com/photos/[id]/medium.jpg

2. **GBIF** - Search: https://www.gbif.org/species/search?q=[species_name]
   - Go to species page  Gallery  Click image  Copy direct URL
   
3. **Flickr Commons** - Scientific/botanical photos with open licenses
   - Valid format: https://live.staticflickr.com/[path].jpg

4. **Biodiversity Heritage Library** - For historical botanical illustrations
   - Valid format: https://www.biodiversitylibrary.org/pagethumb/[id]

5. **Wikimedia Commons** - ONLY use if you know the EXACT filename exists
   - Valid format: https://upload.wikimedia.org/wikipedia/commons/thumb/X/XX/Exact_Filename.jpg/400px-Exact_Filename.jpg

${r==="pt"?`
6. **Flora e Funga do Brasil** - Para espcies brasileiras
   - https://floradobrasil.jbrj.gov.br

7. **Species Link** - Rede de herbrios brasileiros
   - http://www.splink.org.br
`:""}

## CRITICAL RULES:
1.  URL MUST be a DIRECT image link ending in .jpg, .jpeg, .png, .gif, or .webp
2.  URL MUST work when opened directly in a browser (no login required)
3.  DO NOT use Google Images, Pinterest, or any search result pages
4.  DO NOT guess or make up URLs - only use URLs you are confident exist
5.  DO NOT use Wikimedia URLs unless you know the exact filename

## FALLBACK (only if no real photo found):
Use placeholder: https://placehold.co/400x300/e2e8f0/64748b?text=[URL-encoded-name]

## OUTPUT FORMAT:
Return a JSON array with the results:
\`\`\`json
{
  ${Y?`"entities": [
    { "name": "Species Name", "imageUrl": "https://direct-image-url.jpg" }
  ]${q?",":""}`:""}
  ${q?`"features": [
    { "name": "Feature Name", "imageUrl": "https://direct-image-url.jpg" }
  ]`:""}
}
\`\`\`

Language: ${r==="pt"?"Portuguese":"English"}
Total items to process: ${(Y&&((U=me.entities)==null?void 0:U.length)||0)+(q&&((j=me.features)==null?void 0:j.length)||0)}
`}else ge==="EXPAND"?C=`
You are an expert taxonomist. I have an existing identification key that I want to EXPAND with more entities.

CURRENT KEY (JSON):
${v}

TASK: Add ${z.expandCount} NEW entities (species/taxa) to this key.

CRITICAL RULES:
1. DO NOT repeat any of the existing ${p.entities.length} entities. Each new entity MUST be unique.
2. New entities should be taxonomically related or similar to existing ones (same family/genus/habitat).
3. ${z.keepExisting?"PRESERVE all existing entities in the output.":"Replace existing entities with new ones."}
4. ${z.addFeatures?"You MAY add 1-3 new discriminating features if needed to distinguish new species.":"Use ONLY the existing features."}
5. For each new entity, assign appropriate trait values using the existing feature states.
6. Maintain the same level of detail and language (${r==="pt"?"Portuguese":"English"}).

OUTPUT: Return a complete JSON with the expanded key including all entities (existing + new).
`:ge==="REFINE"?C=`
You are an expert taxonomist. I have an existing identification key that I want to REFINE and improve.

CURRENT KEY (JSON):
${v}

TASK: Improve and refine this identification key.

IMPROVEMENTS TO MAKE:
${z.improveDescriptions?"- Improve entity descriptions with more accurate biological information.":""}
${z.fillGaps?"- Fill in missing trait data where entities lack assignments.":""}
${z.addFeatures?"- Add 2-4 new discriminating features that help better distinguish between entities.":""}

RULES:
1. Keep all existing entities.
2. Maintain the same language (${r==="pt"?"Portuguese":"English"}).
3. Ensure scientific accuracy.
4. Make features more discriminating (each state should ideally apply to different subsets of entities).

OUTPUT: Return the improved JSON key.
`:C=`
You are an expert taxonomist. I have an existing identification key that I want to CLEAN and optimize.

CURRENT KEY (JSON):
${v}

TASK: Clean and optimize this identification key.

OPTIMIZATIONS TO MAKE:
${z.removeRedundant?"- Remove redundant features (features where all entities have the same state).":""}
${z.fixInconsistencies?"- Fix any inconsistencies in trait assignments.":""}
- Ensure each feature has meaningful variation across entities.
- Remove empty or meaningless states.

RULES:
1. Keep all entities.
2. Maintain the same language (${r==="pt"?"Portuguese":"English"}).
3. Only remove features that provide no discriminating value.

OUTPUT: Return the cleaned JSON key.
`;return C},du=()=>{if(!ye||!W)return"";const v=JSON.stringify({name:ye.name,description:ye.description,features:ye.features.map(U=>({name:U.name,states:U.states.map(j=>j.label)})),entities:ye.entities.map(U=>({name:U.name,description:U.description,traits:Object.entries(U.traits).map(([j,Y])=>{const q=ye.features.find(ee=>ee.id===j);return Y.map(ee=>{const te=q==null?void 0:q.states.find(me=>me.id===ee);return{featureName:(q==null?void 0:q.name)||"",stateValue:(te==null?void 0:te.label)||""}})}).flat()}))},null,2),C=JSON.stringify({name:W.name,description:W.description,features:W.features.map(U=>({name:U.name,states:U.states.map(j=>j.label)})),entities:W.entities.map(U=>({name:U.name,description:U.description,traits:Object.entries(U.traits).map(([j,Y])=>{const q=W.features.find(ee=>ee.id===j);return Y.map(ee=>{const te=q==null?void 0:q.states.find(me=>me.id===ee);return{featureName:(q==null?void 0:q.name)||"",stateValue:(te==null?void 0:te.label)||""}})}).flat()}))},null,2);let P="";return V==="union"?P=`
MERGE STRATEGY: UNION (All-inclusive)
- Include ALL features from BOTH keys
- Include ALL entities from BOTH keys
- Merge similar features where possible, keeping all unique states
- For duplicate entities, combine traits from both sources`:V==="intersection"?P=`
MERGE STRATEGY: INTERSECTION (Common elements)
- Keep only features that are present in BOTH keys (or semantically equivalent)
- Include ALL entities from both keys, but focus on shared characteristics
- Prioritize traits that appear in both keys for duplicate entities`:P=`
MERGE STRATEGY: PRIMARY (Key 1 priority)
- Use KEY 1 as the primary structure base
- Add entities from KEY 2 that don't exist in KEY 1
- For duplicate entities, prefer KEY 1's trait assignments
- Add features from KEY 2 only if they add discrimination value`,`
You are an expert taxonomist specializing in identification key design and optimization.

TASK: Merge two identification keys into ONE comprehensive, optimized key.

KEY 1 (${ye.entities.length} entities, ${ye.features.length} features):
${v}

KEY 2 (${W.entities.length} entities, ${W.features.length} features):
${C}

${P}

CRITICAL REQUIREMENTS:
1. PRESERVE ALL ENTITIES from BOTH keys. The merged key must include every single species/entity.
2. Create a unified feature set that can describe ALL entities
3. Assign appropriate traits to every entity for every feature in the merged key
4. Merge semantically similar features (e.g., "Leaf Shape" and "Leaf Form")
5. Maintain language: ${r==="pt"?"Portuguese":"English"}

PROCESS:
1. First, identify all unique entities from both keys
2. Analyze features from both keys for similarities
3. Create unified feature set based on merge strategy
4. Map all entities to the new feature set
5. Ensure every entity has trait assignments for every feature

OUTPUT: Return a single merged JSON identification key with:
- Combined name and description
- Unified feature set
- ALL entities from both keys with complete trait mappings
`},Xo=v=>{const C=document.createElement("input");C.type="file",C.accept=".json",C.onchange=async P=>{var j;const U=(j=P.target.files)==null?void 0:j[0];if(U)try{const Y=await U.text(),q=JSON.parse(Y);if(!q.features||!q.entities){alert(r==="pt"?"JSON invlido. Deve conter features e entities.":"Invalid JSON. Must contain features and entities.");return}v===1?L(q):H(q)}catch{alert(r==="pt"?"Erro ao ler arquivo JSON.":"Error reading JSON file.")}},C.click()},hu=async()=>{if(!s){alert(c.missingKey);return}if(!ye||!W){alert(r==="pt"?"Carregue ambas as chaves JSON primeiro.":"Load both JSON keys first.");return}E(!0),G(!1),je(!0),kn();try{const v=du();he(v);const C=await Ca(v,s,x.model,r);Rn(C),await new Promise(P=>setTimeout(P,2500)),m(C),je(!1),y("MATRIX")}catch(v){console.error(v),Rn(),qe(C=>C+(r==="pt"?`

 ERRO: No foi possvel mesclar as chaves.`:`

 ERROR: Could not merge the keys.`)),await new Promise(C=>setTimeout(C,2e3)),alert(c.errGen),je(!1)}finally{E(!1)}},pu=async()=>{if(ge!=="PHOTOS"&&!s){alert(c.missingKey);return}if(p.entities.length===0){alert(r==="pt"?"Carregue um projeto primeiro.":"Load a project first.");return}if(ge==="VALIDATE"&&!z.validateFixNames&&!z.validateMergeSynonyms&&!z.validateCheckGeography&&!z.validateCheckTaxonomy){alert(r==="pt"?"Selecione pelo menos uma opo de validao.":"Select at least one validation option.");return}E(!0),N(""),G(!1),je(!0),qe(""),tn(!1);try{if(ge==="PHOTOS"){const P=z.photoTarget==="entities"||z.photoTarget==="both",U=z.photoTarget==="features"||z.photoTarget==="both",j=z.photoMode==="replace";let Y={...p};if(qe(r==="pt"?` Iniciando busca de imagens...

 Fontes: iNaturalist, Flickr, Wikipedia, Biodiversity4All, SIDOL, Flora Digital UFSC

`:` Starting image search...

 Sources: iNaturalist, Flickr, Wikipedia, Biodiversity4All, SIDOL, Flora Digital UFSC

`),P){const pe=p.entities.filter(Ce=>j||!Ce.imageUrl||Ce.imageUrl.includes("picsum.photos")||Ce.imageUrl.includes("placehold.co")).map(Ce=>({name:Ce.name,scientificName:Ce.name}));if(pe.length>0){const Ce=await Bv(pe,r,(Le,$e,Et)=>{const gn=r==="pt"?` Buscando imagens: ${Le}/${$e} - ${Et}`:` Fetching images: ${Le}/${$e} - ${Et}`;N(gn),qe(ks=>ks+` ${Et}...
`)});Y.entities=p.entities.map(Le=>{const $e=Ce.get(Le.name);return $e?{...Le,imageUrl:$e}:Le})}}if(U){const pe=r==="pt"?`
 Imagens de caractersticas no suportadas via API automtica
`:`
 Feature images not supported via automatic API
`;qe(Ce=>Ce+pe),await new Promise(Ce=>setTimeout(Ce,1500))}const ee=P?Y.entities.filter(pe=>pe.imageUrl&&!pe.imageUrl.includes("picsum.photos")).length:0,te=P?p.entities.length:0,me=r==="pt"?`

 BUSCA CONCLUDA!


 Resultado:
    Imagens encontradas: ${ee}/${te}

 Fotos atualizadas com sucesso!`:`

 SEARCH COMPLETE!


 Result:
    Images found: ${ee}/${te}

 Photos updated successfully!`;qe(pe=>pe+me),tn(!0),await new Promise(pe=>setTimeout(pe,2e3)),m(Y),je(!1),y("ENTITIES");return}if(ge==="VALIDATE"){kn();const P=p.entities.map(pe=>`- "${pe.name}"${pe.scientificName?` (${pe.scientificName})`:""}`).join(`
`),U=z.validateReference==="floradobrasil"?"Flora do Brasil 2020":z.validateReference==="gbif"?"GBIF Backbone Taxonomy":z.validateReference==="powo"?"Plants of the World Online (POWO)":"current taxonomic literature",j=[];if(z.validateFixNames&&j.push(`1. CORRECT NAMES: Check each species against ${U}. If a name is outdated, misspelled, or refers to a non-existent species, provide the accepted name.`),z.validateMergeSynonyms&&j.push("2. MERGE SYNONYMS: Identify synonymous species in the list. When found, keep only the accepted name and merge trait data from both entries."),z.validateCheckTaxonomy&&(z.validateFamily||z.validateGenus)){const pe=z.validateFamily?`family ${z.validateFamily}`:`genus ${z.validateGenus}`;j.push(`3. CHECK TAXONOMY: Remove any species that do not belong to ${pe}.`)}if(z.validateCheckGeography&&z.validateScope!=="global"){const pe=z.validateScope==="national"?"Brazil":z.validateBiome||z.validateStateUF||"the specified region";j.push(`4. CHECK GEOGRAPHY: Remove species that do not occur in ${pe}${z.validateBiome?` (${z.validateBiome})`:""}${z.validateStateUF?` (${z.validateStateUF})`:""}.`)}const Y=`You are a taxonomic validation expert. Analyze the following species list and perform the requested validations.

SPECIES LIST TO VALIDATE:
${P}

VALIDATION TASKS:
${j.join(`
`)}

REFERENCE CATALOG: ${U}

IMPORTANT INSTRUCTIONS:
- Return a JSON object with the full project structure
- For each entity, preserve ALL existing data (traits, description, links, imageUrl)
- Only modify: name, scientificName, and family fields when corrections are needed
- When merging synonyms, combine traits from both entities (union of all trait values)
- Add a "validationNotes" field to each entity explaining any changes made
- If an entity should be removed, do NOT include it in the output
- Keep the exact same feature definitions

EXISTING PROJECT (preserve structure):
${JSON.stringify(p,null,2)}

Return the validated project as a JSON object with the same structure.`;he(Y);const q=await Ca(Y,s,x.model,r),ee=p.entities.length-q.entities.length,te=q.entities.filter(pe=>p.entities.find(Ce=>Ce.id===pe.id&&(Ce.name!==pe.name||Ce.scientificName!==pe.scientificName))).length,me=r==="pt"?`

 VALIDAO CONCLUDA!


 Resultado:
    Nomes corrigidos: ${te}
    Espcies removidas: ${ee}
    Espcies vlidas: ${q.entities.length}

 ATENO: Revise as alteraes manualmente!
Os dados da IA podem conter imprecises.
`:`

 VALIDATION COMPLETE!


 Result:
    Names corrected: ${te}
    Species removed: ${ee}
    Valid species: ${q.entities.length}

 WARNING: Review changes manually!
AI data may contain inaccuracies.
`;Rn(q),qe(pe=>pe+me),await new Promise(pe=>setTimeout(pe,3e3)),m(q),je(!1),y("ENTITIES");return}kn();const v=Yo();he(v),G(!1),je(!0),kn();const C=await Ca(v,s,x.model,r);Rn(C),await new Promise(P=>setTimeout(P,2500)),m(C),je(!1),y("MATRIX")}catch(v){console.error(v),Rn(),qe(C=>C+(r==="pt"?`

 ERRO: No foi possvel refinar a chave.`:`

 ERROR: Could not refine the key.`)),await new Promise(C=>setTimeout(C,2e3)),alert(c.errGen),je(!1)}finally{E(!1),N("")}},Is=async()=>{try{if(k==="REFINE"){if(p.entities.length===0){alert(r==="pt"?"Carregue um projeto primeiro.":"Load a project first.");return}const j=Yo();he(j),je(!0),G(!1);return}let v={...x};if(k==="IMPORT"&&b){const j=await Ko(b);v.importedFile={data:j,mimeType:b.type},v.topic=`Imported: ${b.name}`}else if(k==="TOPIC"){if(!v.topic.trim()){alert("Please enter a topic first.");return}v.importedFile=void 0}const{systemInstruction:C,prompt:P}=jv(v),U=`SYSTEM:
${C}

USER PROMPT:
${P}`;he(U),je(!0),G(!1)}catch(v){console.error("Failed to build prompt",v)}},mu=async()=>{if(!s){alert(c.missingKey);return}E(!0),je(!0),kn();try{const v=await Ca(We,s,x.model,r);Rn(v),await new Promise(C=>setTimeout(C,2e3)),m(v),y("MATRIX"),je(!1)}catch(v){console.error(v),Rn(),qe(C=>C+(r==="pt"?`

 ERRO: No foi possvel gerar a chave. Por favor, tente novamente.`:`

 ERROR: Could not generate the key. Please try again.`)),await new Promise(C=>setTimeout(C,2e3)),alert(c.errGen)}finally{E(!1)}},Qo=()=>{Ut.current&&(clearInterval(Ut.current),Ut.current=null),E(!1),N(""),qe(""),tn(!1),je(!1),G(!0)},gu=()=>{const v={id:Math.random().toString(36).substr(2,9),name:r==="pt"?"Nova Caracterstica":"New Feature",imageUrl:"",states:[{id:Math.random().toString(36).substr(2,9),label:r==="pt"?"Estado 1":"State 1"}]};m(C=>({...C,features:[v,...C.features]}))},w=()=>{const v={id:Math.random().toString(36).substr(2,9),name:r==="pt"?"Nova Entidade":"New Entity",description:"...",links:[],traits:{}};m(C=>({...C,entities:[v,...C.entities]}))},R=(v,C,P)=>{m(U=>{const j=U.entities.map(Y=>{if(Y.id!==v)return Y;const q=Y.traits[C]||[],ee=q.includes(P);let te;return ee?te=q.filter(me=>me!==P):te=[...q,P],{...Y,traits:{...Y.traits,[C]:te}}});return{...U,entities:j}})},A=v=>v===1?c.detailSimple:v===3?c.detailExpert:k==="IMPORT"?c.detailOriginal:c.detailBalanced;return h.jsxs("div",{className:"flex flex-col h-full bg-white font-sans absolute inset-0",children:[h.jsxs("div",{className:"border-b px-4 py-3 flex justify-between items-center bg-slate-900 text-white shadow-md z-30 shrink-0",children:[h.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[h.jsx("button",{onClick:()=>Ne(!_e),className:"md:hidden text-slate-300 hover:text-white",children:h.jsx(GE,{size:24})}),h.jsxs("h2",{className:"text-base md:text-xl font-bold flex items-center gap-2 truncate",children:[h.jsx("span",{className:"bg-emerald-500 text-[10px] md:text-xs text-white px-2 py-1 rounded uppercase tracking-wider shadow-sm hidden sm:inline-block",children:c.builder}),h.jsx("span",{className:"truncate max-w-[150px] md:max-w-[300px]",children:p.name})]}),h.jsx("div",{className:"h-6 w-px bg-slate-700 mx-2 hidden md:block"}),h.jsxs("div",{className:"hidden md:flex items-center gap-1 text-sm",children:[h.jsxs("button",{onClick:Cs,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:c.save,children:[h.jsx(ml,{size:14})," ",h.jsx("span",{className:"hidden sm:inline",children:c.save})]}),h.jsxs("button",{onClick:()=>we(!0),className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:c.open,children:[h.jsx(Xi,{size:14})," ",h.jsx("span",{className:"hidden sm:inline",children:c.open})]}),h.jsxs("button",{onClick:Wo,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:c.export,children:[h.jsx(qc,{size:14})," ",h.jsx("span",{className:"hidden sm:inline",children:c.export})]}),h.jsxs("button",{onClick:qo,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:c.exportXLSX,children:[h.jsx(Jc,{size:14})," ",h.jsx("span",{className:"hidden sm:inline",children:c.exportXLSX})]}),h.jsxs("button",{onClick:As,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:c.exportHTML,children:[h.jsx(hl,{size:14})," ",h.jsx("span",{className:"hidden sm:inline",children:c.exportHTML})]}),h.jsxs("label",{className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white cursor-pointer",title:c.import,children:[h.jsx(Ni,{size:14})," ",h.jsx("span",{className:"hidden sm:inline",children:c.import}),h.jsx("input",{type:"file",accept:".json",onChange:Ns,className:"hidden"})]})]})]}),h.jsxs("div",{className:"flex gap-2 md:gap-3",children:[h.jsxs("button",{onClick:()=>G(!0),className:"flex items-center gap-2 px-3 py-1.5 md:px-4 md:py-2 bg-gradient-to-r from-amber-500 to-yellow-500 hover:from-amber-400 hover:to-yellow-400 text-white rounded-lg transition-all shadow-lg shadow-amber-900/30 text-xs md:text-sm font-bold border border-amber-400/20 group",children:[h.jsx(Yi,{size:16,className:"text-white fill-white/20 group-hover:scale-110 transition-transform"})," ",h.jsx("span",{className:"hidden sm:inline",children:c.aiWizard}),h.jsx("span",{className:"sm:hidden",children:"IA"})]}),h.jsxs("button",{onClick:()=>t(p),className:"flex items-center gap-2 px-3 py-1.5 md:px-5 md:py-2 bg-emerald-600 hover:bg-emerald-500 rounded-lg transition-all text-xs md:text-sm font-semibold shadow-lg shadow-emerald-900/30 text-white",children:[h.jsx(Xc,{size:16})," ",h.jsx("span",{className:"hidden sm:inline",children:c.savePlay})]}),h.jsxs("button",{onClick:n,className:"px-2 py-1.5 md:px-4 md:py-2 text-slate-400 hover:text-white transition-colors text-xs md:text-sm font-medium",children:[h.jsx(En,{size:20,className:"md:hidden"})," ",h.jsx("span",{className:"hidden md:inline",children:c.exit})]})]})]}),_e&&h.jsxs("div",{className:"md:hidden bg-slate-800 text-slate-200 border-b border-slate-700 p-2 grid grid-cols-5 gap-2 text-xs font-medium z-20",children:[h.jsxs("button",{onClick:()=>{Cs(),Ne(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[h.jsx(ml,{size:18})," ",c.save]}),h.jsxs("button",{onClick:()=>{we(!0),Ne(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[h.jsx(Xi,{size:18})," ",c.open]}),h.jsxs("button",{onClick:()=>{Wo(),Ne(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[h.jsx(qc,{size:18})," JSON"]}),h.jsxs("button",{onClick:()=>{qo(),Ne(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[h.jsx(Jc,{size:18})," XLSX"]}),h.jsxs("button",{onClick:()=>{As(),Ne(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[h.jsx(hl,{size:18})," HTML"]}),h.jsxs("label",{className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded cursor-pointer col-span-5",children:[h.jsx(Ni,{size:18})," ",c.import,h.jsx("input",{type:"file",accept:".json",onChange:Ns,className:"hidden"})]})]}),h.jsx("div",{className:"flex border-b bg-white overflow-x-auto whitespace-nowrap shrink-0",children:[{id:"GENERAL",label:c.general,icon:AE},{id:"FEATURES",label:c.features,icon:UE},{id:"ENTITIES",label:c.entities,icon:Ix},{id:"MATRIX",label:c.matrix,icon:ju}].map(v=>h.jsxs("button",{onClick:()=>y(v.id),className:`flex items-center gap-2 px-4 py-3 md:py-4 text-xs md:text-sm font-medium transition-all border-b-2 relative top-[2px] min-w-fit ${g===v.id?"border-emerald-600 text-emerald-600 bg-emerald-50/50 rounded-t-lg":"border-transparent text-slate-500 hover:text-slate-800 hover:bg-slate-50/50"}`,children:[h.jsx(v.icon,{size:16})," ",v.label]},v.id))}),h.jsx("div",{className:"flex-1 overflow-auto bg-slate-50 p-4 md:p-6 pb-20 md:pb-6",children:h.jsxs("div",{className:`mx-auto bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden ${g==="MATRIX"?"max-w-none":"max-w-6xl"}`,children:[g==="GENERAL"&&h.jsx("div",{className:"p-6 md:p-8 space-y-8 max-w-2xl",children:h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 border-b pb-2",children:c.general}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1",children:c.projectName}),h.jsx("input",{value:p.name,onChange:v=>ws({name:v.target.value}),className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all font-medium text-slate-800"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1",children:c.description}),h.jsx("textarea",{value:p.description,onChange:v=>ws({description:v.target.value}),className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all h-32 text-slate-700"})]})]})]})}),g==="FEATURES"&&h.jsxs("div",{className:"p-4 md:p-8",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:c.definedFeatures}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 text-xs font-bold rounded-full",children:[p.features.length," ",r==="pt"?"car.":"feat."]}),h.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-xs font-bold rounded-full",children:[p.features.reduce((v,C)=>v+C.states.length,0)," ",r==="pt"?"estados":"states"]})]})]}),h.jsx("p",{className:"text-xs md:text-sm text-slate-500",children:c.definedFeaturesDesc})]}),h.jsxs("button",{onClick:gu,className:"flex items-center gap-2 text-sm bg-slate-900 text-white px-4 py-2 rounded-lg hover:bg-slate-700 shadow-md transition-all",children:[h.jsx(Us,{size:16})," ",h.jsx("span",{className:"hidden sm:inline",children:c.addFeature})]})]}),h.jsx("div",{className:"grid gap-6 md:grid-cols-2 xl:grid-cols-3",children:p.features.map((v,C)=>h.jsxs("div",{className:"border border-slate-200 rounded-xl p-5 bg-white relative group hover:border-emerald-300 hover:shadow-md transition-all",children:[h.jsx("button",{className:"absolute top-3 right-3 text-slate-300 hover:text-red-500 md:opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-red-50 rounded",onClick:()=>{const P=p.features.filter(U=>U.id!==v.id);m(U=>({...U,features:P}))},children:h.jsx(Ba,{size:16})}),h.jsxs("div",{className:"mb-4 space-y-2",children:[h.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:c.featureName}),h.jsx("input",{value:v.name,onChange:P=>{const U=[...p.features];U[C].name=P.target.value,m(j=>({...j,features:U}))},className:"font-bold text-lg text-slate-800 bg-transparent border-b border-transparent hover:border-slate-300 focus:border-emerald-500 outline-none w-full pb-1"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Vi,{size:14,className:"text-slate-400"}),h.jsx("input",{value:v.imageUrl||"",onChange:P=>{const U=[...p.features];U[C].imageUrl=P.target.value,m(j=>({...j,features:U}))},className:"text-xs flex-1 bg-slate-50 border border-slate-200 rounded px-2 py-1 outline-none focus:border-emerald-400",placeholder:c.imageURL})]})]}),h.jsxs("div",{className:"space-y-2 pl-3 border-l-2 border-slate-100",children:[h.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider block mb-1",children:c.states}),v.states.map((P,U)=>h.jsxs("div",{className:"flex items-center gap-2 group/state",children:[h.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-300 group-focus-within/state:bg-emerald-400"}),h.jsx("input",{value:P.label,onChange:j=>{const Y=[...p.features];Y[C].states[U].label=j.target.value,m(q=>({...q,features:Y}))},className:"text-sm bg-transparent outline-none w-full text-slate-600 focus:text-slate-900 focus:font-medium"}),h.jsx("button",{onClick:()=>{const j=[...p.features];j[C].states=j[C].states.filter(Y=>Y.id!==P.id),m(Y=>({...Y,features:j}))},className:"text-slate-300 hover:text-red-400 md:opacity-0 group-hover/state:opacity-100 transition-opacity",children:h.jsx(En,{size:12})})]},P.id)),h.jsxs("button",{onClick:()=>{const P=[...p.features];P[C].states.push({id:Math.random().toString(36).substr(2,9),label:"..."}),m(U=>({...U,features:P}))},className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium mt-3 flex items-center gap-1 bg-emerald-50 w-fit px-2 py-1 rounded",children:[h.jsx(Us,{size:10})," ",c.addState]})]})]},v.id))})]}),g==="ENTITIES"&&h.jsxs("div",{className:"p-4 md:p-8",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:c.manageEntities}),h.jsxs("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 text-xs font-bold rounded-full",children:[p.entities.length," ",r==="pt"?"entidades":"entities"]})]}),h.jsx("p",{className:"text-xs md:text-sm text-slate-500",children:c.manageEntitiesDesc})]}),h.jsxs("button",{onClick:w,className:"flex items-center gap-2 text-sm bg-slate-900 text-white px-4 py-2 rounded-lg hover:bg-slate-700 shadow-md transition-all",children:[h.jsx(Us,{size:16})," ",h.jsx("span",{className:"hidden sm:inline",children:c.addEntity})]})]}),h.jsx("div",{className:"space-y-4",children:p.entities.map((v,C)=>h.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 items-start border border-slate-200 p-4 md:p-6 rounded-xl bg-white hover:shadow-md transition-shadow",children:[h.jsxs("div",{className:"w-full sm:w-48 space-y-2 flex-shrink-0",children:[h.jsx("div",{className:"aspect-[4/3] bg-slate-100 rounded-lg overflow-hidden border border-slate-200",children:v.imageUrl?h.jsx("img",{src:v.imageUrl,className:"w-full h-full object-cover",alt:"preview"}):h.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-300",children:h.jsx(Vi,{size:32})})}),h.jsx("input",{value:v.imageUrl||"",onChange:P=>{const U=[...p.entities];U[C].imageUrl=P.target.value,m(j=>({...j,entities:U}))},className:"text-xs w-full px-2 py-1.5 bg-slate-50 border border-slate-200 rounded outline-none focus:border-emerald-500 text-slate-600",placeholder:c.imageURL}),h.jsxs("button",{onClick:()=>Tr(v.id),className:"w-full flex items-center justify-center gap-2 text-xs bg-slate-100 hover:bg-slate-200 text-slate-700 py-3 md:py-2 rounded-lg font-medium transition-colors border border-slate-200",children:[h.jsx(ga,{size:12})," ",c.editTraits]})]}),h.jsxs("div",{className:"flex-1 space-y-4 w-full",children:[h.jsxs("div",{className:"flex justify-between items-start gap-2",children:[h.jsx("input",{value:v.name,onChange:P=>{const U=[...p.entities];U[C].name=P.target.value,m(j=>({...j,entities:U}))},className:"text-xl font-bold bg-transparent border-b border-transparent hover:border-slate-300 focus:border-emerald-500 outline-none w-full pb-1 text-slate-800"}),h.jsx("button",{onClick:()=>{const P=p.entities.filter(U=>U.id!==v.id);m(U=>({...U,entities:P}))},className:"text-slate-300 hover:text-red-500 p-2 hover:bg-red-50 rounded transition-colors",children:h.jsx(Ba,{size:18})})]}),h.jsxs("div",{className:"flex gap-3 flex-wrap md:flex-nowrap",children:[h.jsxs("div",{className:"flex-1 min-w-[140px]",children:[h.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:r==="pt"?"Nome Cientfico":"Scientific Name"}),h.jsx("input",{value:v.scientificName||"",onChange:P=>{const U=[...p.entities];U[C].scientificName=P.target.value,m(j=>({...j,entities:U}))},placeholder:r==="pt"?"Ex: Panthera leo":"e.g., Panthera leo",className:"text-sm italic text-slate-600 bg-slate-50 border border-slate-200 focus:bg-white focus:border-emerald-500 w-full outline-none rounded-lg px-3 py-2 transition-colors"})]}),h.jsxs("div",{className:"flex-1 min-w-[120px]",children:[h.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:r==="pt"?"Famlia":"Family"}),h.jsx("input",{value:v.family||"",onChange:P=>{const U=[...p.entities];U[C].family=P.target.value,m(j=>({...j,entities:U}))},placeholder:r==="pt"?"Ex: Felidae":"e.g., Felidae",className:"text-sm text-slate-600 bg-slate-50 border border-slate-200 focus:bg-white focus:border-emerald-500 w-full outline-none rounded-lg px-3 py-2 transition-colors"})]})]}),h.jsx("textarea",{value:v.description,onChange:P=>{const U=[...p.entities];U[C].description=P.target.value,m(j=>({...j,entities:U}))},className:"text-sm text-slate-600 bg-slate-50 border border-transparent focus:bg-white focus:border-emerald-500 w-full h-24 outline-none resize-none rounded-lg p-3 transition-colors"}),h.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100",children:[h.jsxs("h5",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 flex items-center gap-2",children:[h.jsx(Yc,{size:12})," ",c.links]}),h.jsxs("div",{className:"space-y-2",children:[(v.links||[]).map((P,U)=>h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{placeholder:"Label",value:P.label,onChange:j=>{const Y=[...p.entities];Y[C].links||(Y[C].links=[]),Y[C].links[U].label=j.target.value,m(q=>({...q,entities:Y}))},className:"text-xs flex-1 px-2 py-1 border border-slate-200 rounded outline-none focus:border-emerald-400"}),h.jsx("input",{placeholder:"URL",value:P.url,onChange:j=>{const Y=[...p.entities];Y[C].links||(Y[C].links=[]),Y[C].links[U].url=j.target.value,m(q=>({...q,entities:Y}))},className:"text-xs flex-[2] px-2 py-1 border border-slate-200 rounded outline-none focus:border-emerald-400"}),h.jsx("button",{onClick:()=>{const j=[...p.entities];j[C].links||(j[C].links=[]),j[C].links=j[C].links.filter((Y,q)=>q!==U),m(Y=>({...Y,entities:j}))},className:"text-slate-400 hover:text-red-500",children:h.jsx(En,{size:14})})]},P.id||U)),h.jsxs("button",{onClick:()=>{const P=[...p.entities];P[C].links||(P[C].links=[]),P[C].links.push({id:Math.random().toString(36).substr(2,9),label:"",url:""}),m(U=>({...U,entities:P}))},className:"text-xs flex items-center gap-1 text-emerald-600 hover:text-emerald-700 font-medium",children:[h.jsx(Us,{size:12})," ",c.addLink]})]})]})]})]},v.id))})]}),g==="MATRIX"&&h.jsxs("div",{className:"flex flex-col h-full bg-slate-50 min-h-[500px]",children:[h.jsxs("div",{className:"p-4 border-b bg-white",children:[h.jsxs("div",{className:"flex justify-between items-center mb-3",children:[h.jsx("h3",{className:"font-semibold text-slate-700",children:c.scoringMatrix}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs text-slate-400 hidden sm:inline",children:c.scoringMatrixDesc}),p.features.length>1&&h.jsxs("div",{className:"flex gap-1 border-l pl-2 ml-2",children:[h.jsx("button",{onClick:()=>Ss("prev"),className:"p-1.5 hover:bg-slate-100 rounded transition-colors text-slate-600",title:"Caracterstica Anterior",children:h.jsx(RE,{size:16})}),h.jsx("button",{onClick:()=>Ss("next"),className:"p-1.5 hover:bg-slate-100 rounded transition-colors text-slate-600",title:"Prxima Caracterstica",children:h.jsx(PE,{size:16})})]})]})]}),h.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 custom-scrollbar",children:p.features.map((v,C)=>h.jsx("button",{onClick:()=>_r(v.id),className:`shrink-0 px-3 py-1.5 rounded-full text-xs font-medium transition-all ${zn===v.id?"bg-emerald-600 text-white shadow-md":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:v.name},v.id))})]}),h.jsx("div",{className:"flex-1 overflow-hidden bg-gradient-to-br from-slate-100 to-slate-200 relative",children:h.jsx("div",{ref:mn,className:"absolute inset-0 overflow-auto custom-scrollbar",children:h.jsxs("table",{className:"border-collapse w-max",children:[h.jsxs("thead",{className:"sticky top-0 z-40",children:[h.jsxs("tr",{className:"bg-gradient-to-r from-slate-800 to-slate-900",children:[h.jsx("th",{rowSpan:2,className:"sticky left-0 z-50 bg-gradient-to-br from-slate-800 to-slate-900 text-white px-3 py-2 font-bold border-r border-b border-slate-600 text-left align-bottom",style:{minWidth:"180px",maxWidth:"180px"},children:h.jsx("span",{className:"text-xs font-semibold tracking-wide",children:c.taxaFeatures})}),p.features.map(v=>{const C=zn===v.id,P=C?v.states.length:1;return h.jsx("th",{colSpan:P,className:`px-1 py-1.5 font-semibold border-r border-b text-center align-middle cursor-pointer transition-all duration-200 ${C?"bg-gradient-to-br from-emerald-500 to-emerald-700 border-emerald-400 text-white shadow-lg":"bg-gradient-to-b from-slate-600 to-slate-700 border-slate-500 text-slate-100 hover:from-slate-500 hover:to-slate-600"}`,style:{minWidth:C?`${P*80}px`:"60px"},onClick:()=>_r(v.id),title:v.name,children:h.jsxs("div",{className:"flex items-center justify-center gap-1",children:[C&&h.jsx("button",{onClick:U=>{U.stopPropagation(),_i(null)},className:"p-0.5 hover:bg-emerald-400/50 rounded transition-colors flex-shrink-0",children:h.jsx(En,{size:12})}),h.jsx("span",{className:`font-semibold leading-tight ${C?"text-[10px]":"text-[9px]"}`,children:v.name})]})},`header-${v.id}`)})]}),h.jsx("tr",{children:p.features.map(v=>zn===v.id?v.states.map(P=>h.jsx("th",{className:"bg-gradient-to-b from-emerald-600 to-emerald-700 text-white px-1 py-1.5 border-r border-b border-emerald-500 text-center align-top",style:{minWidth:"80px",maxWidth:"100px"},title:P.label,children:h.jsx("div",{className:"text-[8px] font-medium leading-snug px-0.5 break-words",style:{wordBreak:"break-word",hyphens:"auto"},children:P.label})},`state-${P.id}`)):h.jsx("th",{className:"bg-gradient-to-b from-slate-500 to-slate-600 text-slate-200 px-1 py-1.5 border-r border-b border-slate-400 text-center cursor-pointer hover:from-slate-400 hover:to-slate-500 transition-all",style:{minWidth:"60px",maxWidth:"60px"},onClick:()=>_r(v.id),children:h.jsxs("div",{className:"flex flex-col items-center gap-0",children:[h.jsx("span",{className:"text-[8px] opacity-80",children:"expandir"}),h.jsxs("span",{className:"text-[10px] font-bold",children:["(",v.states.length,")"]})]})},`expand-${v.id}`))})]}),h.jsx("tbody",{children:p.entities.map((v,C)=>h.jsxs("tr",{className:C%2===0?"bg-white":"bg-slate-50/80",children:[h.jsx("td",{className:`sticky left-0 z-20 px-2 py-1.5 border-r-2 border-b border-slate-200 ${C%2===0?"bg-white":"bg-slate-50"}`,style:{minWidth:"180px",maxWidth:"180px",boxShadow:"2px 0 6px rgba(0,0,0,0.08)"},children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-6 h-6 rounded bg-slate-200 overflow-hidden flex-shrink-0",children:v.imageUrl&&h.jsx("img",{src:v.imageUrl,className:"w-full h-full object-cover",alt:""})}),h.jsx("span",{className:"text-[11px] font-medium text-slate-700 line-clamp-2 leading-tight",title:v.name,children:v.name})]})}),p.features.map(P=>{const U=zn===P.id,j=v.traits[P.id]||[],Y=j.length;return U?P.states.map(q=>{const ee=j.includes(q.id);return h.jsx("td",{className:`border-b border-r border-slate-200 text-center hover:bg-emerald-50 transition-colors p-1 ${C%2===0?"bg-white":"bg-slate-50/80"}`,style:{minWidth:"80px",maxWidth:"100px"},children:h.jsx("button",{onClick:()=>R(v.id,P.id,q.id),className:`w-7 h-7 rounded-md flex items-center justify-center transition-all mx-auto ${ee?"bg-gradient-to-br from-emerald-400 to-emerald-600 text-white shadow-sm":"bg-slate-100 text-slate-300 hover:bg-slate-200"}`,children:ee&&h.jsx(ju,{size:14,strokeWidth:2.5})})},`${v.id}-${q.id}`)}):h.jsx("td",{className:`border-b border-r border-slate-200 text-center cursor-pointer hover:bg-slate-100 transition-colors p-1 ${C%2===0?"bg-white":"bg-slate-50/80"}`,style:{minWidth:"60px",maxWidth:"60px"},onClick:()=>_r(P.id),title:`${Y} de ${P.states.length}`,children:h.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-bold mx-auto ${Y>0?"bg-gradient-to-br from-emerald-100 to-emerald-200 text-emerald-700":"bg-slate-100 text-slate-400"}`,children:Y})},`${v.id}-${P.id}-collapsed`)})]},v.id))})]})})})]})]})}),Bt&&h.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col max-h-[90vh] animate-in fade-in zoom-in-95 overflow-hidden",children:[h.jsxs("div",{className:"bg-slate-50 p-4 border-b flex justify-between items-center",children:[h.jsxs("h3",{className:"font-bold text-slate-800 text-lg flex items-center gap-2 truncate",children:[h.jsx(ga,{size:18,className:"text-emerald-600"}),h.jsxs("span",{className:"truncate",children:[c.traitEditor,": ",h.jsx("span",{className:"text-emerald-600",children:(I=p.entities.find(v=>v.id===Bt))==null?void 0:I.name})]})]}),h.jsx("button",{onClick:()=>Tr(null),className:"text-slate-400 hover:text-slate-600 p-1",children:h.jsx(En,{size:20})})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 space-y-6 custom-scrollbar",children:[p.features.map(v=>h.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4",children:[h.jsxs("h4",{className:"font-bold text-slate-700 mb-3 flex items-center gap-2",children:[v.name,v.imageUrl&&h.jsx("a",{href:v.imageUrl,target:"_blank",rel:"noopener noreferrer",className:"text-slate-400 hover:text-emerald-500",children:h.jsx(dl,{size:12})})]}),h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:v.states.map(C=>{var U,j;const P=(j=(U=p.entities.find(Y=>Y.id===Bt))==null?void 0:U.traits[v.id])==null?void 0:j.includes(C.id);return h.jsxs("button",{onClick:()=>R(Bt,v.id,C.id),className:`text-sm px-3 py-3 md:py-2 rounded-lg border text-left flex items-center justify-between transition-all touch-manipulation active:scale-[0.98] ${P?"bg-emerald-600 text-white border-emerald-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-emerald-300 hover:text-emerald-600"}`,children:[h.jsx("span",{className:"truncate mr-2 text-xs md:text-sm",children:C.label}),P&&h.jsx(ju,{size:14})]},C.id)})})]},v.id)),p.features.length===0&&h.jsx("div",{className:"text-center text-slate-400 py-10",children:"Nenhuma caracterstica definida no projeto."})]}),h.jsx("div",{className:"p-4 border-t bg-slate-50 shrink-0",children:h.jsx("button",{onClick:()=>Tr(null),className:"w-full py-3 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-500 shadow-lg shadow-emerald-900/10",children:c.close})})]})}),B&&h.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full overflow-hidden animate-in fade-in zoom-in-95 duration-200 border border-slate-200 max-h-[90vh] flex flex-col",children:[h.jsxs("div",{className:"bg-gradient-to-r from-amber-500 to-yellow-500 p-4 md:p-6 text-white shrink-0",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:h.jsx(Yi,{size:24,className:"text-white"})}),h.jsx("h3",{className:"text-xl md:text-2xl font-bold flex-1",children:c.aiTitle}),o&&h.jsx("button",{onClick:()=>{G(!1),o(!0)},className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",title:r==="pt"?"Configurar Chave de API":"Configure API Key",children:h.jsx(Kc,{size:18,className:"text-white"})})]}),h.jsx("p",{className:"text-amber-50 text-xs md:text-sm font-medium drop-shadow-sm",children:c.aiDesc}),!s&&o&&h.jsxs("div",{className:"mt-3 flex items-center gap-2 bg-red-500/30 backdrop-blur-sm px-3 py-2 rounded-lg border border-red-300/50 animate-pulse",children:[h.jsx(Kc,{size:16,className:"text-yellow-200"}),h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"text-yellow-100 text-xs font-bold",children:c.apiKeyWarning}),h.jsx("p",{className:"text-yellow-200/80 text-[10px]",children:c.clickGear})]})]})]}),h.jsxs("div",{className:"flex border-b border-slate-200 bg-slate-50 shrink-0",children:[h.jsx("button",{onClick:()=>D("TOPIC"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${k==="TOPIC"?"border-amber-500 text-amber-600 bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:h.jsxs("span",{className:"flex items-center justify-center gap-1",children:[h.jsx(th,{size:14})," ",h.jsx("span",{className:"hidden sm:inline",children:c.modeTopic}),h.jsx("span",{className:"sm:hidden",children:"Gerar"})]})}),h.jsx("button",{onClick:()=>D("IMPORT"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${k==="IMPORT"?"border-amber-500 text-amber-600 bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:h.jsxs("span",{className:"flex items-center justify-center gap-1",children:[h.jsx(DE,{size:14})," ",h.jsx("span",{className:"hidden sm:inline",children:c.modeImport}),h.jsx("span",{className:"sm:hidden",children:"Importar"})]})}),h.jsx("button",{onClick:()=>D("REFINE"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${k==="REFINE"?"border-amber-500 text-amber-600 bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:h.jsxs("span",{className:"flex items-center justify-center gap-1",children:[h.jsx(eh,{size:14})," ",h.jsx("span",{className:"hidden sm:inline",children:c.modeRefine}),h.jsx("span",{className:"sm:hidden",children:"Refinar"})]})}),h.jsx("button",{onClick:()=>D("MERGE"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${k==="MERGE"?"border-amber-500 text-amber-600 bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:h.jsxs("span",{className:"flex items-center justify-center gap-1",children:[h.jsx(W0,{size:14})," ",h.jsx("span",{className:"hidden sm:inline",children:c.modeMerge}),h.jsx("span",{className:"sm:hidden",children:"Combinar"})]})})]}),h.jsxs("div",{className:"p-4 md:p-6 space-y-5 overflow-y-auto custom-scrollbar flex-1 bg-white",children:[k==="TOPIC"?h.jsxs(h.Fragment,{children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:c.topic}),h.jsx("input",{value:x.topic,onChange:v=>S(C=>({...C,topic:v.target.value})),placeholder:c.topicPlace,className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-amber-500 focus:border-amber-500 outline-none text-base md:text-lg",disabled:T})]}),h.jsxs("div",{className:"bg-emerald-50/50 p-3 rounded-xl border border-emerald-100",children:[h.jsxs("label",{className:"block text-xs font-bold text-emerald-700 uppercase mb-2 flex items-center gap-1",children:[h.jsx(pl,{size:12})," ",c.taxonomyFilters]}),h.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:c.taxonomyFamily}),h.jsx("input",{value:x.taxonomyFamily,onChange:v=>S(C=>({...C,taxonomyFamily:v.target.value})),placeholder:r==="pt"?"ex: Fabaceae":"e.g. Fabaceae",className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 outline-none text-sm bg-white",disabled:T})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:c.taxonomyGenus}),h.jsx("input",{value:x.taxonomyGenus,onChange:v=>S(C=>({...C,taxonomyGenus:v.target.value})),placeholder:r==="pt"?"ex: Inga":"e.g. Inga",className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 outline-none text-sm bg-white",disabled:T})]})]})]}),h.jsxs("div",{className:"bg-blue-50/50 p-3 rounded-xl border border-blue-100",children:[h.jsxs("label",{className:"block text-xs font-bold text-blue-700 uppercase mb-2 flex items-center gap-1",children:[h.jsx(J0,{size:12})," ",c.geographyFilters]}),h.jsx("div",{className:"flex gap-2 mb-3",children:["global","national","regional"].map(v=>h.jsx("button",{onClick:()=>S(C=>({...C,scope:v})),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-lg transition-colors ${x.scope===v?"bg-blue-600 text-white":"bg-white text-slate-600 hover:bg-blue-100 border border-slate-200"}`,disabled:T,children:v==="global"?c.scopeGlobal:v==="national"?c.scopeNational:c.scopeRegional},v))}),h.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:c.biome}),h.jsxs("select",{value:x.biome,onChange:v=>S(C=>({...C,biome:v.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm bg-white",disabled:T,children:[h.jsx("option",{value:"",children:r==="pt"?"Todos os biomas":"All biomes"}),h.jsx("option",{value:"Amaznia",children:"Amaznia"}),h.jsx("option",{value:"Mata Atlntica",children:"Mata Atlntica"}),h.jsx("option",{value:"Cerrado",children:"Cerrado"}),h.jsx("option",{value:"Caatinga",children:"Caatinga"}),h.jsx("option",{value:"Pampa",children:"Pampa"}),h.jsx("option",{value:"Pantanal",children:"Pantanal"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:c.stateUF}),h.jsxs("select",{value:x.stateUF,onChange:v=>S(C=>({...C,stateUF:v.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm bg-white",disabled:T,children:[h.jsx("option",{value:"",children:r==="pt"?"Todos os estados":"All states"}),h.jsx("option",{value:"AC",children:"Acre (AC)"}),h.jsx("option",{value:"AL",children:"Alagoas (AL)"}),h.jsx("option",{value:"AP",children:"Amap (AP)"}),h.jsx("option",{value:"AM",children:"Amazonas (AM)"}),h.jsx("option",{value:"BA",children:"Bahia (BA)"}),h.jsx("option",{value:"CE",children:"Cear (CE)"}),h.jsx("option",{value:"DF",children:"Distrito Federal (DF)"}),h.jsx("option",{value:"ES",children:"Esprito Santo (ES)"}),h.jsx("option",{value:"GO",children:"Gois (GO)"}),h.jsx("option",{value:"MA",children:"Maranho (MA)"}),h.jsx("option",{value:"MT",children:"Mato Grosso (MT)"}),h.jsx("option",{value:"MS",children:"Mato Grosso do Sul (MS)"}),h.jsx("option",{value:"MG",children:"Minas Gerais (MG)"}),h.jsx("option",{value:"PA",children:"Par (PA)"}),h.jsx("option",{value:"PB",children:"Paraba (PB)"}),h.jsx("option",{value:"PR",children:"Paran (PR)"}),h.jsx("option",{value:"PE",children:"Pernambuco (PE)"}),h.jsx("option",{value:"PI",children:"Piau (PI)"}),h.jsx("option",{value:"RJ",children:"Rio de Janeiro (RJ)"}),h.jsx("option",{value:"RN",children:"Rio Grande do Norte (RN)"}),h.jsx("option",{value:"RS",children:"Rio Grande do Sul (RS)"}),h.jsx("option",{value:"RO",children:"Rondnia (RO)"}),h.jsx("option",{value:"RR",children:"Roraima (RR)"}),h.jsx("option",{value:"SC",children:"Santa Catarina (SC)"}),h.jsx("option",{value:"SP",children:"So Paulo (SP)"}),h.jsx("option",{value:"SE",children:"Sergipe (SE)"}),h.jsx("option",{value:"TO",children:"Tocantins (TO)"})]})]})]}),h.jsxs("div",{className:"mt-3",children:[h.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:r==="pt"?"Regio especfica (opcional)":"Specific region (optional)"}),h.jsx("input",{value:x.geography,onChange:v=>S(C=>({...C,geography:v.target.value})),placeholder:r==="pt"?"ex: Serra do Mar, Bacia do Rio Doce":"e.g. Amazon Basin, Andes",className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm bg-white",disabled:T})]})]})]}):k==="IMPORT"?h.jsxs("div",{className:"flex flex-col gap-4",children:[h.jsxs("div",{className:"text-center space-y-2 mb-2",children:[h.jsx("h4",{className:"font-bold text-slate-800 text-lg",children:c.uploadLabel}),h.jsx("p",{className:"text-slate-500 text-sm",children:c.uploadDesc})]}),h.jsx("div",{className:`border-2 border-dashed rounded-xl p-6 flex flex-col items-center justify-center transition-all bg-slate-50 ${b?"border-amber-500 bg-amber-50/30":"border-slate-300 hover:border-amber-400"}`,children:b?h.jsxs("div",{className:"flex flex-col items-center gap-3",children:[h.jsx($u,{size:48,className:"text-amber-600"}),h.jsx("span",{className:"font-bold text-slate-800 text-sm text-center break-all",children:b.name}),h.jsxs("span",{className:"text-xs text-slate-400",children:[(b.size/1024).toFixed(1)," KB"]}),h.jsxs("button",{onClick:()=>O(null),className:"mt-2 text-red-500 text-xs font-bold hover:underline flex items-center gap-1 p-2",children:[h.jsx(Ba,{size:12})," ",c.removeFile]})]}):h.jsxs("label",{className:"cursor-pointer flex flex-col items-center gap-3 w-full h-full",children:[h.jsx("div",{className:"p-4 bg-white rounded-full shadow-sm",children:h.jsx(Ni,{size:24,className:"text-amber-500"})}),h.jsx("span",{className:"font-bold text-slate-600",children:c.dropFile}),h.jsx("span",{className:"text-xs text-slate-400",children:c.supportedFormats}),h.jsx("input",{type:"file",className:"hidden",accept:".pdf,.txt,.jpg,.jpeg,.png",onChange:Jo})]})})]}):k==="REFINE"?h.jsxs("div",{className:"flex flex-col gap-4",children:[h.jsxs("div",{className:"bg-gradient-to-r from-emerald-50 to-teal-50 p-4 rounded-xl border border-emerald-200",children:[h.jsx("h5",{className:"text-xs font-bold text-emerald-700 uppercase mb-2",children:c.currentProject}),p.entities.length>0||p.features.length>0?h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"font-bold text-slate-800 truncate",children:p.name}),h.jsxs("p",{className:"text-xs text-slate-500",children:[p.entities.length," ",c.entitiesCount,"  ",p.features.length," ",c.featuresCount]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("span",{className:"bg-emerald-100 text-emerald-700 text-xs font-bold px-2 py-1 rounded",children:p.entities.length}),h.jsx("span",{className:"bg-teal-100 text-teal-700 text-xs font-bold px-2 py-1 rounded",children:p.features.length})]})]}):h.jsx("p",{className:"text-sm text-amber-600 italic",children:c.noProjectLoaded})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("button",{onClick:()=>ae("EXPAND"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${ge==="EXPAND"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`p-2 rounded-lg ${ge==="EXPAND"?"bg-amber-500 text-white":"bg-slate-100 text-slate-500"}`,children:h.jsx(BE,{size:20})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"font-bold text-slate-800",children:c.actionExpand}),h.jsx("p",{className:"text-xs text-slate-500",children:c.actionExpandDesc})]})]})}),h.jsx("button",{onClick:()=>ae("REFINE"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${ge==="REFINE"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`p-2 rounded-lg ${ge==="REFINE"?"bg-amber-500 text-white":"bg-slate-100 text-slate-500"}`,children:h.jsx(WE,{size:20})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"font-bold text-slate-800",children:c.actionRefine}),h.jsx("p",{className:"text-xs text-slate-500",children:c.actionRefineDesc})]})]})}),h.jsx("button",{onClick:()=>ae("CLEAN"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${ge==="CLEAN"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`p-2 rounded-lg ${ge==="CLEAN"?"bg-amber-500 text-white":"bg-slate-100 text-slate-500"}`,children:h.jsx(bE,{size:20})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"font-bold text-slate-800",children:c.actionClean}),h.jsx("p",{className:"text-xs text-slate-500",children:c.actionCleanDesc})]})]})}),h.jsx("button",{onClick:()=>ae("PHOTOS"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${ge==="PHOTOS"?"border-blue-500 bg-blue-50":"border-slate-200 hover:border-blue-300"}`,children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`p-2 rounded-lg ${ge==="PHOTOS"?"bg-blue-500 text-white":"bg-slate-100 text-slate-500"}`,children:h.jsx(IE,{size:20})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"font-bold text-slate-800",children:c.actionPhotos}),h.jsx("p",{className:"text-xs text-slate-500",children:c.actionPhotosDesc})]})]})}),h.jsx("button",{onClick:()=>ae("VALIDATE"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${ge==="VALIDATE"?"border-emerald-500 bg-emerald-50":"border-slate-200 hover:border-emerald-300"}`,children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`p-2 rounded-lg ${ge==="VALIDATE"?"bg-emerald-500 text-white":"bg-slate-100 text-slate-500"}`,children:h.jsx(Z0,{size:20})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"font-bold text-slate-800",children:c.actionValidate}),h.jsx("p",{className:"text-xs text-slate-500",children:c.actionValidateDesc})]})]})})]}),ge==="EXPAND"&&h.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-4",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:c.expandCount}),h.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:z.expandCount})]}),h.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:z.expandCount,onChange:v=>se(C=>({...C,expandCount:parseInt(v.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500",disabled:T})]}),h.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:z.keepExisting,onChange:v=>se(C=>({...C,keepExisting:v.target.checked})),className:"w-4 h-4 accent-amber-500"}),h.jsx("span",{className:"text-sm text-slate-700",children:c.keepExisting})]}),h.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:z.addFeatures,onChange:v=>se(C=>({...C,addFeatures:v.target.checked})),className:"w-4 h-4 accent-amber-500"}),h.jsx("span",{className:"text-sm text-slate-700",children:c.addFeatures})]})]}),ge==="REFINE"&&h.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-3",children:[h.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:z.improveDescriptions,onChange:v=>se(C=>({...C,improveDescriptions:v.target.checked})),className:"w-4 h-4 accent-amber-500"}),h.jsx("span",{className:"text-sm text-slate-700",children:c.improveDescriptions})]}),h.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:z.fillGaps,onChange:v=>se(C=>({...C,fillGaps:v.target.checked})),className:"w-4 h-4 accent-amber-500"}),h.jsx("span",{className:"text-sm text-slate-700",children:c.fillGaps})]}),h.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:z.addFeatures,onChange:v=>se(C=>({...C,addFeatures:v.target.checked})),className:"w-4 h-4 accent-amber-500"}),h.jsx("span",{className:"text-sm text-slate-700",children:c.addFeatures})]})]}),ge==="CLEAN"&&h.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-3",children:[h.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:z.removeRedundant,onChange:v=>se(C=>({...C,removeRedundant:v.target.checked})),className:"w-4 h-4 accent-amber-500"}),h.jsx("span",{className:"text-sm text-slate-700",children:c.removeRedundant})]}),h.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:z.fixInconsistencies,onChange:v=>se(C=>({...C,fixInconsistencies:v.target.checked})),className:"w-4 h-4 accent-amber-500"}),h.jsx("span",{className:"text-sm text-slate-700",children:c.fixInconsistencies})]})]}),ge==="PHOTOS"&&h.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-xl border border-blue-200 space-y-4",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx("p",{className:"text-sm font-medium text-blue-800",children:c.photosActionDesc}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>se(v=>({...v,photoTarget:"entities"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${z.photoTarget==="entities"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:c.photoTargetEntities}),h.jsx("button",{onClick:()=>se(v=>({...v,photoTarget:"features"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${z.photoTarget==="features"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:c.photoTargetFeatures}),h.jsx("button",{onClick:()=>se(v=>({...v,photoTarget:"both"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${z.photoTarget==="both"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:c.photoTargetBoth})]})]}),h.jsx("div",{className:"space-y-2",children:h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("button",{onClick:()=>se(v=>({...v,photoMode:"expand"})),className:`flex-1 py-2 px-3 rounded-lg transition-all ${z.photoMode==="expand"?"bg-emerald-500 text-white shadow-sm":"bg-white text-emerald-700 border border-emerald-200 hover:bg-emerald-50"}`,children:[h.jsx("div",{className:"text-xs font-medium",children:c.photoModeExpand}),h.jsx("div",{className:"text-[10px] opacity-80",children:c.photoModeExpandDesc})]}),h.jsxs("button",{onClick:()=>se(v=>({...v,photoMode:"replace"})),className:`flex-1 py-2 px-3 rounded-lg transition-all ${z.photoMode==="replace"?"bg-orange-500 text-white shadow-sm":"bg-white text-orange-700 border border-orange-200 hover:bg-orange-50"}`,children:[h.jsx("div",{className:"text-xs font-medium",children:c.photoModeReplace}),h.jsx("div",{className:"text-[10px] opacity-80",children:c.photoModeReplaceDesc})]})]})}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"text-xs font-medium text-blue-700",children:c.photoCustomSources}),h.jsx("textarea",{value:z.photoCustomSources||"",onChange:v=>se(C=>({...C,photoCustomSources:v.target.value})),placeholder:c.photoCustomSourcesPlaceholder,className:"w-full h-20 text-xs p-2 border border-blue-200 rounded-lg bg-white/50 focus:ring-2 focus:ring-blue-400 focus:outline-none resize-none"})]})]}),ge==="VALIDATE"&&h.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 p-4 rounded-xl border border-emerald-200 space-y-4",children:[h.jsx("p",{className:"text-sm font-medium text-emerald-800",children:c.validateOptions}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"text-xs font-bold text-emerald-700 uppercase",children:c.validateReference}),h.jsx("div",{className:"grid grid-cols-2 gap-2",children:["floradobrasil","gbif","powo","custom"].map(v=>h.jsx("button",{onClick:()=>se(C=>({...C,validateReference:v})),className:`py-2 px-3 text-xs font-medium rounded-lg transition-all ${z.validateReference===v?"bg-emerald-600 text-white shadow-sm":"bg-white text-emerald-700 border border-emerald-200 hover:bg-emerald-50"}`,children:v==="floradobrasil"?c.validateFloradobrasil:v==="gbif"?c.validateGbif:v==="powo"?c.validatePowo:c.validateCustom},v))})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("label",{className:"flex items-start gap-2 cursor-pointer p-2 rounded-lg hover:bg-white/50 transition-colors",children:[h.jsx("input",{type:"checkbox",checked:z.validateFixNames,onChange:v=>se(C=>({...C,validateFixNames:v.target.checked})),className:"w-4 h-4 accent-emerald-500 mt-0.5"}),h.jsxs("div",{children:[h.jsx("span",{className:"text-sm font-medium text-slate-800",children:c.validateFixNames}),h.jsx("p",{className:"text-xs text-slate-500",children:c.validateFixNamesDesc})]})]}),h.jsxs("label",{className:"flex items-start gap-2 cursor-pointer p-2 rounded-lg hover:bg-white/50 transition-colors",children:[h.jsx("input",{type:"checkbox",checked:z.validateMergeSynonyms,onChange:v=>se(C=>({...C,validateMergeSynonyms:v.target.checked})),className:"w-4 h-4 accent-emerald-500 mt-0.5"}),h.jsxs("div",{children:[h.jsx("span",{className:"text-sm font-medium text-slate-800",children:c.validateMergeSynonyms}),h.jsx("p",{className:"text-xs text-slate-500",children:c.validateMergeSynonymsDesc})]})]}),h.jsxs("label",{className:"flex items-start gap-2 cursor-pointer p-2 rounded-lg hover:bg-white/50 transition-colors",children:[h.jsx("input",{type:"checkbox",checked:z.validateCheckGeography,onChange:v=>se(C=>({...C,validateCheckGeography:v.target.checked})),className:"w-4 h-4 accent-emerald-500 mt-0.5"}),h.jsxs("div",{children:[h.jsx("span",{className:"text-sm font-medium text-slate-800",children:c.validateCheckGeography}),h.jsx("p",{className:"text-xs text-slate-500",children:c.validateCheckGeographyDesc})]})]}),h.jsxs("label",{className:"flex items-start gap-2 cursor-pointer p-2 rounded-lg hover:bg-white/50 transition-colors",children:[h.jsx("input",{type:"checkbox",checked:z.validateCheckTaxonomy,onChange:v=>se(C=>({...C,validateCheckTaxonomy:v.target.checked})),className:"w-4 h-4 accent-emerald-500 mt-0.5"}),h.jsxs("div",{children:[h.jsx("span",{className:"text-sm font-medium text-slate-800",children:c.validateCheckTaxonomy}),h.jsx("p",{className:"text-xs text-slate-500",children:c.validateCheckTaxonomyDesc})]})]})]}),z.validateCheckTaxonomy&&h.jsxs("div",{className:"bg-white/50 p-3 rounded-lg border border-emerald-200 space-y-3",children:[h.jsxs("label",{className:"text-xs font-bold text-emerald-700 uppercase flex items-center gap-1",children:[h.jsx(pl,{size:12})," ",c.taxonomyFilters]}),h.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[h.jsx("input",{value:z.validateFamily,onChange:v=>se(C=>({...C,validateFamily:v.target.value})),placeholder:c.taxonomyFamily,className:"px-3 py-2 border border-emerald-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 outline-none"}),h.jsx("input",{value:z.validateGenus,onChange:v=>se(C=>({...C,validateGenus:v.target.value})),placeholder:c.taxonomyGenus,className:"px-3 py-2 border border-emerald-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 outline-none"})]})]}),z.validateCheckGeography&&h.jsxs("div",{className:"bg-white/50 p-3 rounded-lg border border-emerald-200 space-y-3",children:[h.jsxs("label",{className:"text-xs font-bold text-emerald-700 uppercase flex items-center gap-1",children:[h.jsx(J0,{size:12})," ",c.geographyFilters]}),h.jsx("div",{className:"flex gap-2",children:["global","national","regional"].map(v=>h.jsx("button",{onClick:()=>se(C=>({...C,validateScope:v})),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-lg transition-colors ${z.validateScope===v?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-100 border border-slate-200"}`,children:v==="global"?c.scopeGlobal:v==="national"?c.scopeNational:c.scopeRegional},v))}),z.validateScope!=="global"&&h.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[h.jsxs("select",{value:z.validateBiome,onChange:v=>se(C=>({...C,validateBiome:v.target.value})),className:"px-3 py-2 border border-emerald-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 outline-none bg-white",children:[h.jsx("option",{value:"",children:c.biome}),h.jsx("option",{value:"Amaznia",children:"Amaznia"}),h.jsx("option",{value:"Mata Atlntica",children:"Mata Atlntica"}),h.jsx("option",{value:"Cerrado",children:"Cerrado"}),h.jsx("option",{value:"Caatinga",children:"Caatinga"}),h.jsx("option",{value:"Pampa",children:"Pampa"}),h.jsx("option",{value:"Pantanal",children:"Pantanal"})]}),h.jsxs("select",{value:z.validateStateUF,onChange:v=>se(C=>({...C,validateStateUF:v.target.value})),className:"px-3 py-2 border border-emerald-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 outline-none bg-white",children:[h.jsx("option",{value:"",children:c.stateUF}),h.jsx("option",{value:"AC",children:"Acre (AC)"}),h.jsx("option",{value:"AL",children:"Alagoas (AL)"}),h.jsx("option",{value:"AP",children:"Amap (AP)"}),h.jsx("option",{value:"AM",children:"Amazonas (AM)"}),h.jsx("option",{value:"BA",children:"Bahia (BA)"}),h.jsx("option",{value:"CE",children:"Cear (CE)"}),h.jsx("option",{value:"DF",children:"Distrito Federal (DF)"}),h.jsx("option",{value:"ES",children:"Esprito Santo (ES)"}),h.jsx("option",{value:"GO",children:"Gois (GO)"}),h.jsx("option",{value:"MA",children:"Maranho (MA)"}),h.jsx("option",{value:"MT",children:"Mato Grosso (MT)"}),h.jsx("option",{value:"MS",children:"Mato Grosso do Sul (MS)"}),h.jsx("option",{value:"MG",children:"Minas Gerais (MG)"}),h.jsx("option",{value:"PA",children:"Par (PA)"}),h.jsx("option",{value:"PB",children:"Paraba (PB)"}),h.jsx("option",{value:"PR",children:"Paran (PR)"}),h.jsx("option",{value:"PE",children:"Pernambuco (PE)"}),h.jsx("option",{value:"PI",children:"Piau (PI)"}),h.jsx("option",{value:"RJ",children:"Rio de Janeiro (RJ)"}),h.jsx("option",{value:"RN",children:"Rio Grande do Norte (RN)"}),h.jsx("option",{value:"RS",children:"Rio Grande do Sul (RS)"}),h.jsx("option",{value:"RO",children:"Rondnia (RO)"}),h.jsx("option",{value:"RR",children:"Roraima (RR)"}),h.jsx("option",{value:"SC",children:"Santa Catarina (SC)"}),h.jsx("option",{value:"SP",children:"So Paulo (SP)"}),h.jsx("option",{value:"SE",children:"Sergipe (SE)"}),h.jsx("option",{value:"TO",children:"Tocantins (TO)"})]})]})]})]}),ge!=="PHOTOS"&&ge!=="VALIDATE"&&h.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-xl border border-blue-200 space-y-3",children:[h.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:z.completePhotos,onChange:v=>se(C=>({...C,completePhotos:v.target.checked})),className:"w-4 h-4 accent-blue-500"}),h.jsxs("div",{className:"flex-1",children:[h.jsx("span",{className:"text-sm font-semibold text-blue-800",children:c.completePhotos}),h.jsx("p",{className:"text-xs text-blue-600",children:c.completePhotosDesc})]}),h.jsx(Vi,{size:20,className:"text-blue-400"})]}),z.completePhotos&&h.jsxs("div",{className:"flex gap-2 pl-6",children:[h.jsx("button",{onClick:()=>se(v=>({...v,photoTarget:"entities"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${z.photoTarget==="entities"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:c.photoTargetEntities}),h.jsx("button",{onClick:()=>se(v=>({...v,photoTarget:"features"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${z.photoTarget==="features"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:c.photoTargetFeatures}),h.jsx("button",{onClick:()=>se(v=>({...v,photoTarget:"both"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${z.photoTarget==="both"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:c.photoTargetBoth})]})]})]}):null,k==="MERGE"&&h.jsxs("div",{className:"flex flex-col gap-4",children:[h.jsxs("div",{className:"text-center space-y-2 mb-2",children:[h.jsx("h4",{className:"font-bold text-slate-800 text-lg",children:c.mergeTitle}),h.jsx("p",{className:"text-slate-500 text-sm",children:c.mergeDesc})]}),h.jsx("div",{className:`border-2 border-dashed rounded-xl p-4 flex flex-col items-center justify-center transition-all ${ye?"border-amber-500 bg-amber-50/30":"border-slate-300 hover:border-amber-400 bg-slate-50"}`,children:ye?h.jsxs("div",{className:"flex flex-col items-center gap-2 w-full",children:[h.jsx($u,{size:32,className:"text-amber-600"}),h.jsx("span",{className:"font-bold text-slate-800 text-sm text-center",children:ye.name||"Key 1"}),h.jsxs("span",{className:"text-xs text-slate-500",children:[((F=ye.entities)==null?void 0:F.length)||0," ",c.entities,"  ",((M=ye.features)==null?void 0:M.length)||0," ",c.features]}),h.jsx("button",{onClick:()=>L(null),className:"text-xs text-red-500 hover:text-red-700 underline",children:c.remove})]}):h.jsxs("button",{onClick:()=>Xo(1),className:"flex flex-col items-center gap-2 p-2 w-full",children:[h.jsx(Ni,{size:32,className:"text-slate-400"}),h.jsx("span",{className:"text-sm font-medium text-slate-600",children:c.uploadKey1})]})}),h.jsx("div",{className:`border-2 border-dashed rounded-xl p-4 flex flex-col items-center justify-center transition-all ${W?"border-amber-500 bg-amber-50/30":"border-slate-300 hover:border-amber-400 bg-slate-50"}`,children:W?h.jsxs("div",{className:"flex flex-col items-center gap-2 w-full",children:[h.jsx($u,{size:32,className:"text-amber-600"}),h.jsx("span",{className:"font-bold text-slate-800 text-sm text-center",children:W.name||"Key 2"}),h.jsxs("span",{className:"text-xs text-slate-500",children:[((K=W.entities)==null?void 0:K.length)||0," ",c.entities,"  ",((Z=W.features)==null?void 0:Z.length)||0," ",c.features]}),h.jsx("button",{onClick:()=>H(null),className:"text-xs text-red-500 hover:text-red-700 underline",children:c.remove})]}):h.jsxs("button",{onClick:()=>Xo(2),className:"flex flex-col items-center gap-2 p-2 w-full",children:[h.jsx(Ni,{size:32,className:"text-slate-400"}),h.jsx("span",{className:"text-sm font-medium text-slate-600",children:c.uploadKey2})]})}),h.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-3",children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-2",children:c.mergeStrategy}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("button",{onClick:()=>ne("union"),className:`w-full p-3 rounded-lg border-2 text-left transition-all ${V==="union"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:[h.jsx("p",{className:"font-bold text-slate-800 text-sm",children:c.strategyUnion}),h.jsx("p",{className:"text-xs text-slate-500",children:c.strategyUnionDesc})]}),h.jsxs("button",{onClick:()=>ne("intersection"),className:`w-full p-3 rounded-lg border-2 text-left transition-all ${V==="intersection"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:[h.jsx("p",{className:"font-bold text-slate-800 text-sm",children:c.strategyIntersection}),h.jsx("p",{className:"text-xs text-slate-500",children:c.strategyIntersectionDesc})]}),h.jsxs("button",{onClick:()=>ne("primary"),className:`w-full p-3 rounded-lg border-2 text-left transition-all ${V==="primary"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:[h.jsx("p",{className:"font-bold text-slate-800 text-sm",children:c.strategyPrimary}),h.jsx("p",{className:"text-xs text-slate-500",children:c.strategyPrimaryDesc})]})]})]})]}),(k==="TOPIC"||k==="IMPORT")&&h.jsxs("div",{className:"pt-4 border-t border-slate-100 space-y-5",children:[h.jsxs("h5",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[h.jsx(X0,{size:12})," ",c.configSettings]}),h.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase flex items-center gap-1",children:[h.jsx(VE,{size:14})," ",c.detailLevel]}),h.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-100 px-2 py-1 rounded",children:A(x.detailLevel)})]}),h.jsx("input",{type:"range",min:"1",max:"3",step:"1",value:x.detailLevel,onChange:v=>S(C=>({...C,detailLevel:parseInt(v.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500 mb-2",disabled:T}),h.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 font-medium uppercase tracking-wide",children:[h.jsxs("span",{className:`flex flex-col items-center gap-1 ${x.detailLevel===1?"text-amber-600":""}`,children:[h.jsx(wE,{size:16})," Simple"]}),h.jsxs("span",{className:`flex flex-col items-center gap-1 ${x.detailLevel===2?"text-amber-600":""}`,children:[h.jsx(Yi,{size:16})," Bal."]}),h.jsxs("span",{className:`flex flex-col items-center gap-1 ${x.detailLevel===3?"text-amber-600":""}`,children:[h.jsx(OE,{size:16})," Expert"]})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-2",children:c.featureFocus}),h.jsx("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:["general","reproductive","vegetative"].map(v=>h.jsx("button",{onClick:()=>S(C=>({...C,featureFocus:v})),className:`flex-1 py-2 rounded-md text-[10px] md:text-xs font-medium transition-all ${x.featureFocus===v?"bg-white text-amber-600 shadow-sm":"text-slate-500 hover:text-slate-800"}`,disabled:T,children:v==="general"?c.focusGeneral:v==="reproductive"?c.focusRepro:c.focusVeg},v))})]}),k==="TOPIC"&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:c.numEntities}),h.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:x.count})]}),h.jsx("input",{type:"range",min:"3",max:"30",step:"1",value:x.count,onChange:v=>S(C=>({...C,count:parseInt(v.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500",disabled:T})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:c.numFeatures}),h.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:x.featureCount})]}),h.jsx("input",{type:"range",min:"2",max:"10",step:"1",value:x.featureCount,onChange:v=>S(C=>({...C,featureCount:parseInt(v.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500",disabled:T})]}),h.jsxs("div",{className:"relative",children:[h.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:c.requiredFeatures}),ce.length>0&&h.jsxs("span",{className:"text-xs font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded",children:[ce.length," ",c.selectedFeatures]})]}),h.jsxs("button",{type:"button",onClick:()=>fe(!ve),className:"w-full px-3 py-2 text-left text-sm bg-white border border-slate-200 rounded-lg hover:border-amber-400 focus:outline-none focus:ring-2 focus:ring-amber-500/20 transition-colors flex items-center justify-between",disabled:T,children:[h.jsx("span",{className:ce.length>0?"text-slate-700":"text-slate-400",children:ce.length>0?ce.slice(0,2).join(", ")+(ce.length>2?` +${ce.length-2}`:""):c.requiredFeaturesDesc}),h.jsx(kE,{size:16,className:`text-slate-400 transition-transform ${ve?"rotate-180":""}`})]}),ve&&h.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-slate-200 rounded-lg shadow-xl max-h-64 overflow-y-auto custom-scrollbar",children:[h.jsx("div",{className:"sticky top-0 bg-white border-b p-2",children:h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{type:"text",value:Pe,onChange:v=>ke(v.target.value),placeholder:c.addCustomFeature,className:"flex-1 px-2 py-1.5 text-sm border border-slate-200 rounded focus:outline-none focus:border-amber-400",onKeyDown:v=>{v.key==="Enter"&&Pe.trim()&&(ce.includes(Pe.trim())||Ee(C=>[...C,Pe.trim()]),ke(""))}}),h.jsx("button",{type:"button",onClick:()=>{Pe.trim()&&!ce.includes(Pe.trim())&&(Ee(v=>[...v,Pe.trim()]),ke(""))},className:"px-2 py-1 bg-amber-500 text-white rounded text-xs font-medium hover:bg-amber-600",children:h.jsx(Us,{size:14})})]})}),ce.length>0&&h.jsxs("div",{className:"p-2 border-b bg-emerald-50/50",children:[h.jsx("div",{className:"text-xs font-semibold text-emerald-700 mb-1.5 uppercase",children:r==="pt"?"Selecionadas":"Selected"}),h.jsx("div",{className:"flex flex-wrap gap-1",children:ce.map((v,C)=>h.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-emerald-100 text-emerald-700 text-xs rounded-full",children:[v,h.jsx("button",{type:"button",onClick:()=>Ee(P=>P.filter(U=>U!==v)),className:"hover:text-red-500",children:h.jsx(En,{size:12})})]},C))})]}),yt.map((v,C)=>h.jsxs("div",{children:[h.jsx("div",{className:"px-3 py-1.5 bg-slate-50 text-xs font-semibold text-slate-500 uppercase sticky top-[52px]",children:v.category}),v.items.map((P,U)=>{const j=ce.includes(P);return h.jsxs("button",{type:"button",onClick:()=>{Ee(j?Y=>Y.filter(q=>q!==P):Y=>[...Y,P])},className:`w-full px-3 py-2 text-left text-sm hover:bg-amber-50 flex items-center justify-between transition-colors ${j?"bg-emerald-50 text-emerald-700":"text-slate-600"}`,children:[h.jsx("span",{children:P}),j&&h.jsx(Nx,{size:14,className:"text-emerald-500"})]},U)})]},C))]})]})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Vi,{size:16,className:"text-slate-400 group-hover:text-amber-500 transition-colors"}),h.jsx("span",{className:"text-sm font-medium text-slate-700",children:c.fetchSpeciesImg})]}),h.jsx("div",{className:`w-11 h-6 flex items-center rounded-full p-1 transition-colors ${x.includeSpeciesImages?"bg-amber-500":"bg-slate-300"}`,children:h.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${x.includeSpeciesImages?"translate-x-5":""}`})}),h.jsx("input",{type:"checkbox",className:"hidden",checked:x.includeSpeciesImages,onChange:v=>S(C=>({...C,includeSpeciesImages:v.target.checked})),disabled:T})]}),h.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(X0,{size:16,className:"text-slate-400 group-hover:text-amber-500 transition-colors"}),h.jsx("span",{className:"text-sm font-medium text-slate-700",children:c.fetchFeatureImg})]}),h.jsx("div",{className:`w-11 h-6 flex items-center rounded-full p-1 transition-colors ${x.includeFeatureImages?"bg-amber-500":"bg-slate-300"}`,children:h.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${x.includeFeatureImages?"translate-x-5":""}`})}),h.jsx("input",{type:"checkbox",className:"hidden",checked:x.includeFeatureImages,onChange:v=>S(C=>({...C,includeFeatureImages:v.target.checked})),disabled:T})]}),h.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Yc,{size:16,className:"text-slate-400 group-hover:text-amber-500 transition-colors"}),h.jsx("span",{className:"text-sm font-medium text-slate-700",children:c.fetchLinks})]}),h.jsx("div",{className:`w-11 h-6 flex items-center rounded-full p-1 transition-colors ${x.includeLinks?"bg-amber-500":"bg-slate-300"}`,children:h.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${x.includeLinks?"translate-x-5":""}`})}),h.jsx("input",{type:"checkbox",className:"hidden",checked:x.includeLinks,onChange:v=>S(C=>({...C,includeLinks:v.target.checked})),disabled:T})]})]})]}),T&&h.jsxs("div",{className:"bg-amber-50 text-amber-700 p-3 rounded-lg text-sm flex items-center justify-center gap-2",children:[h.jsx(Y0,{className:"animate-spin",size:16})," ",_||(k==="IMPORT"?c.analyzing:c.generating)]})]}),h.jsxs("div",{className:"p-4 bg-slate-50 border-t flex gap-3 shrink-0 safe-area-bottom",children:[h.jsx("button",{onClick:cu,className:"flex-none w-16 md:w-20 py-2.5 text-slate-600 font-medium hover:bg-slate-200 rounded-xl transition-colors text-center text-xs md:text-sm",children:c.cancel}),h.jsxs("button",{onClick:Is,className:"w-auto px-3 py-2 text-xs bg-white border border-slate-300 text-slate-700 font-bold rounded-xl hover:bg-slate-50 hover:border-amber-400 hover:text-amber-600 shadow-sm transition-all flex items-center justify-center gap-2",disabled:T||k==="TOPIC"&&!x.topic||k==="IMPORT"&&!b||k==="REFINE"&&p.entities.length===0||k==="MERGE"&&(!ye||!W),title:"View and edit the prompt before sending",children:[h.jsx(ga,{size:14})," ",h.jsx("span",{className:"hidden sm:inline",children:"View/Edit Prompt"})]}),k==="REFINE"?h.jsxs("button",{onClick:pu,className:`flex-1 py-2.5 ${ge==="VALIDATE"?"bg-emerald-500 hover:bg-emerald-600 shadow-emerald-900/20":"bg-amber-500 hover:bg-amber-600 shadow-amber-900/20"} text-white font-bold rounded-xl shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 text-sm`,disabled:T||p.entities.length===0,children:[ge==="EXPAND"?c.actionExpand:ge==="REFINE"?c.actionRefine:ge==="CLEAN"?c.actionClean:ge==="VALIDATE"?c.actionValidate:c.actionPhotos," ",ge==="VALIDATE"?h.jsx(Z0,{size:16,className:"opacity-70"}):h.jsx(eh,{size:16,className:"opacity-70"})]}):k==="MERGE"?h.jsxs("button",{onClick:hu,className:"flex-1 py-2.5 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 text-sm",disabled:T||!ye||!W,children:[c.mergeAction," ",h.jsx(W0,{size:16,className:"opacity-70"})]}):h.jsxs("button",{onClick:fu,className:"flex-1 py-2.5 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 text-sm",disabled:T||k==="TOPIC"&&!x.topic||k==="IMPORT"&&!b,children:[c.generate," ",h.jsx(th,{size:16,className:"opacity-70"})]})]})]})}),Me&&h.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-[60] flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col h-[80vh] max-h-[90vh] animate-in fade-in zoom-in-95 overflow-hidden",children:[h.jsxs("div",{className:"bg-slate-800 p-4 border-b border-slate-700 flex justify-between items-center text-white shrink-0",children:[h.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[h.jsx(ga,{size:18,className:"text-amber-400"}),"Prompt Editor"]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(We),alert(c.promptCopied)},className:"flex items-center gap-1.5 px-3 py-1.5 text-xs hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",disabled:T,children:[h.jsx(ME,{size:12})," ",c.copyPrompt]}),h.jsx("button",{onClick:Qo,className:"text-slate-400 hover:text-white p-1",children:h.jsx(En,{size:20})})]})]}),h.jsxs("div",{className:"flex-1 p-2 bg-slate-100 min-h-0 flex flex-col gap-2",children:[!T&&h.jsx("textarea",{value:We,onChange:v=>he(v.target.value),className:"w-full flex-1 p-4 bg-slate-900 text-slate-200 font-mono text-sm rounded-lg resize-none outline-none border-2 border-transparent focus:border-amber-500",spellCheck:"false"}),T&&h.jsx("div",{ref:Er,className:"w-full flex-1 p-4 bg-gradient-to-br from-slate-900 to-slate-800 text-slate-200 font-mono text-sm rounded-lg overflow-auto custom-scrollbar border-2 border-amber-500/30",children:h.jsxs("div",{className:"whitespace-pre-wrap",children:[Rt,!Zn&&h.jsx("span",{className:"inline-block w-2 h-4 bg-amber-400 animate-pulse ml-1 align-middle"})]})})]}),h.jsxs("div",{className:"p-4 border-t bg-slate-50 shrink-0 flex items-center justify-between gap-4",children:[T&&h.jsxs("div",{className:"flex items-center gap-2 text-amber-600",children:[h.jsxs("div",{className:"flex gap-1",children:[h.jsx("span",{className:"w-2 h-2 bg-amber-500 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),h.jsx("span",{className:"w-2 h-2 bg-amber-500 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),h.jsx("span",{className:"w-2 h-2 bg-amber-500 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),h.jsx("span",{className:"text-sm font-medium",children:r==="pt"?"IA processando...":"AI processing..."})]}),h.jsxs("div",{className:"flex items-center gap-4 ml-auto",children:[h.jsx("button",{onClick:Qo,className:"px-6 py-2 text-slate-600 font-medium hover:bg-slate-200 rounded-xl transition-colors",children:c.cancel}),h.jsx("button",{onClick:mu,className:"px-6 py-2 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 flex items-center gap-2",disabled:T,children:T?h.jsxs(h.Fragment,{children:[h.jsx(Y0,{className:"animate-spin",size:16})," ",_||c.generating]}):h.jsx(h.Fragment,{children:c.generate})})]})]})]})}),re&&h.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",children:[h.jsxs("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[h.jsx(Xi,{className:"text-emerald-600",size:20}),c.open]}),h.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto mb-4 custom-scrollbar",children:J.length===0?h.jsx("p",{className:"text-slate-500 text-sm text-center py-8 border-2 border-dashed border-slate-200 rounded-lg",children:c.noSaved}):J.map(v=>h.jsxs("button",{onClick:()=>jo(v),className:"w-full text-left p-3 hover:bg-emerald-50 rounded-lg border border-slate-100 hover:border-emerald-200 group transition-all",children:[h.jsx("div",{className:"font-medium text-slate-800 group-hover:text-emerald-700",children:v.name}),h.jsx("div",{className:"text-xs text-slate-400 truncate",children:v.description||"No description"})]},v.id))}),h.jsx("button",{onClick:()=>we(!1),className:"w-full py-2.5 bg-slate-100 text-slate-600 rounded-xl font-medium hover:bg-slate-200 transition-colors",children:c.close})]})})]})},wM=()=>{const[e,t]=Te.useState("HOME"),[n,r]=Te.useState(null),[i,s]=Te.useState("pt"),[o,a]=Te.useState([]),[l,u]=Te.useState(!1),[c,p]=Te.useState(!1),[m,g]=Te.useState(!1),[y,x]=Te.useState(!1),[S,T]=Te.useState("ABOUT"),[E,_]=Te.useState("gemini-2.5-flash"),[N,B]=Te.useState(""),[G,k]=Te.useState(!1);Te.useEffect(()=>{const z=localStorage.getItem("nozesia_settings");if(z)try{const se=JSON.parse(z);se.model&&_(se.model),se.apiKey&&B(se.apiKey)}catch{console.error("Failed to load settings")}},[]),Te.useEffect(()=>{if(e==="HOME"||e==="PLAYER"){const z=localStorage.getItem("nozesia_projects");if(z)try{a(JSON.parse(z))}catch{console.error("Failed to load local projects")}}},[e]);const D=()=>{const z=E.trim(),se=N.trim();localStorage.setItem("nozesia_settings",JSON.stringify({model:z,apiKey:se})),p(!1)},b={id:"demo-1",name:"Exemplo: Grandes Felinos",description:"Identifique espcies comuns de grandes felinos.",features:[{id:"f1",name:"Padro da Pelagem",states:[{id:"s1",label:"Listras"},{id:"s2",label:"Manchas"},{id:"s3",label:"Liso"}]},{id:"f2",name:"Habitat",states:[{id:"s4",label:"Selva"},{id:"s5",label:"Savana"}]}],entities:[{id:"e1",name:"Tigre",description:"O maior dos felinos.",imageUrl:"https://picsum.photos/id/237/400/300",links:[],traits:{f1:["s1"],f2:["s4"]}},{id:"e2",name:"Leo",description:"O rei da selva.",imageUrl:"https://picsum.photos/id/1003/400/300",links:[],traits:{f1:["s3"],f2:["s5"]}},{id:"e3",name:"Leopardo",description:"Escalador especialista.",imageUrl:"https://picsum.photos/id/1074/400/300",links:[],traits:{f1:["s2"],f2:["s4","s5"]}}]},O={en:{subtitle:"v2.1 Tropical",tagline:"Biological Identification AI",desc:"Create and share professional matrix identification keys. Powered by Gemini AI for instant taxonomy generation.",createNew:"Create / Edit Key",openSaved:"Open Saved",importJson:"Import Project",demo:"Try Demo",savedProj:"Saved Projects",close:"Close",noSaved:"No saved projects found.",invalid:"Invalid project file.",settings:"Settings",aiModel:"AI Model",apiKey:"Gemini API Key",getKey:"Get Key",save:"Save",apiKeyNotice:"Your API Key is stored locally in your browser and used only to communicate with Google.",help:"About & Help",helpContent:{intro:"NOZES is an intelligent platform for creating and using matrix identification keys, designed for biologists, students, and nature enthusiasts.",step1Title:"1. NUTS AI Wizard",step1Desc:"Use the 'Nuts AI' button in the builder to automatically generate a key. You can describe a topic (e.g., 'Brazilian Cerrado Trees') OR upload a PDF/Image reference. The AI will study the material and create species, features, and the scoring matrix for you.",step2Title:"2. The Builder",step2Desc:"Refine your key manually. You can add new features, upload images for species, and adjust the matrix relationships between taxa and traits. Use the 'Export Project' button to save your work as a JSON file, which is essential for backups.",step3Title:"3. The Player",step3Desc:"This is the end-user view. Select observed features to filter down the list of species until you identify your specimen.",importExportTitle:"4. Import & Export",importExportDesc:"Always save your work by clicking 'Export Project'. This downloads a .json file. To resume work later or on another device, use 'Import Project' and select that file. You can also export to Excel (XLSX) for spreadsheets.",htmlExportTitle:"5. HTML Export",htmlExportDesc:"Export your key as a standalone HTML file that works offline! Click 'HTML' in the builder to generate a complete, self-contained webpage with all images embedded. Perfect for sharing with colleagues, publishing on websites, or using in field work without internet. The exported file includes the full Player interface with all filtering functionality."}},pt:{subtitle:"v2.1 Tropical",tagline:"Inteligncia para Identificao Biolgica",desc:"Crie e compartilhe chaves de identificao matriciais profissionais. Poder da Gemini AI para gerao instantnea de taxonomia.",createNew:"Criar / Editar Chave",openSaved:"Abrir Chave",importJson:"Importar Projeto",demo:"Ver Demo",savedProj:"Projetos Salvos",close:"Fechar",noSaved:"Nenhum projeto salvo.",invalid:"Arquivo invlido.",settings:"Configuraes",aiModel:"Modelo IA",apiKey:"Chave API Gemini",getKey:"Obter Chave",save:"Salvar",apiKeyNotice:"Sua API Key  salva localmente no navegador e usada apenas para comunicar com o Google.",help:"Sobre e Ajuda",helpContent:{intro:"O NOZES  uma plataforma inteligente para criao e uso de chaves de identificao matriciais, projetada para bilogos, estudantes e entusiastas da natureza.",step1Title:"1. Assistente Nozes IA",step1Desc:"Use o boto 'Nozes IA' no construtor para gerar uma chave automaticamente. Voc pode descrever um tpico (ex: 'rvores do Cerrado') OU fazer upload de um PDF/Imagem de referncia. A IA estudar o material e criar espcies, caractersticas e a matriz para voc.",step2Title:"2. O Construtor",step2Desc:"Refine sua chave manualmente. Adicione novas caractersticas, insira imagens e ajuste a matriz. Use o boto 'Exportar Projeto' para salvar seu trabalho em arquivo JSON (backup essencial).",step3Title:"3. O Player",step3Desc:"Esta  a viso do usurio final. Selecione as caractersticas observadas para filtrar a lista de espcies at identificar seu espcime.",importExportTitle:"4. Importar & Exportar",importExportDesc:"Sempre salve seu trabalho clicando em 'Exportar Projeto'. Isso baixa um arquivo .json. Para continuar depois ou em outro dispositivo, use 'Importar Projeto' e selecione esse arquivo. Voc tambm pode exportar para Excel (XLSX).",htmlExportTitle:"5. Exportao HTML",htmlExportDesc:"Exporte sua chave como um arquivo HTML autnomo que funciona offline! Clique em 'HTML' no construtor para gerar uma pgina web completa e independente com todas as imagens embutidas. Perfeito para compartilhar com colegas, publicar em sites ou usar em trabalho de campo sem internet. O arquivo exportado inclui a interface completa do Player com toda a funcionalidade de filtragem."}}}[i],J=()=>{k(!1),t("BUILDER")},X=()=>{k(!0),r(null),t("BUILDER")},re=()=>{r(b),t("PLAYER")},we=z=>{const se=localStorage.getItem("nozesia_projects");let ye=[];if(se)try{ye=JSON.parse(se)}catch(W){console.error("Failed to parse projects",W)}const L=[z,...ye.filter(W=>W.id!==z.id)];localStorage.setItem("nozesia_projects",JSON.stringify(L)),a(L),r(z),t("PLAYER")},_e=z=>{r(z),t("PLAYER"),u(!1)},Ne=z=>{const se=new FileReader;z.target.files&&z.target.files[0]&&(se.readAsText(z.target.files[0],"UTF-8"),se.onload=ye=>{var L;try{const W=JSON.parse((L=ye.target)==null?void 0:L.result);W.name&&W.features&&W.entities?(r(W),t("PLAYER")):alert(O.invalid)}catch{alert(O.invalid)}})},ge=()=>c&&h.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[h.jsx(Q0,{className:"text-emerald-600",size:20}),O.settings]}),h.jsx("button",{onClick:()=>p(!1),className:"text-slate-400 hover:text-slate-600 p-2",children:h.jsx(En,{size:24})})]}),h.jsxs("div",{className:"space-y-4 mb-6",children:[h.jsxs("div",{children:[h.jsx("div",{className:"flex justify-between items-center mb-2",children:h.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:O.apiKey})}),h.jsxs("div",{className:"relative",children:[h.jsx(Kc,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),h.jsx("input",{type:"password",value:N,onChange:z=>B(z.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none",placeholder:"AIzaSy..."})]}),h.jsxs("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"mt-3 flex items-center justify-center gap-2 w-full py-2.5 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg font-bold text-sm hover:from-blue-600 hover:to-indigo-700 transition-all shadow-md hover:shadow-lg",children:[h.jsx(dl,{size:16}),O.getKey," - Google AI Studio"]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:O.aiModel}),h.jsx("input",{value:E,onChange:z=>_(z.target.value),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none",placeholder:"gemini-2.5-flash"}),h.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Default: gemini-2.5-flash"})]}),h.jsx("div",{className:"bg-amber-50 p-3 rounded-lg border border-amber-100",children:h.jsx("p",{className:"text-xs text-amber-700",children:O.apiKeyNotice})})]}),h.jsxs("button",{onClick:D,className:"w-full py-3 bg-emerald-600 text-white rounded-xl font-bold hover:bg-emerald-500 transition-colors flex items-center justify-center gap-2",children:[h.jsx(ml,{size:16})," ",O.save]})]})}),ae=()=>l&&h.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[h.jsx(Xi,{className:"text-emerald-600",size:20}),O.openSaved]}),h.jsx("button",{onClick:()=>u(!1),className:"text-slate-400 hover:text-slate-600 p-1",children:h.jsx(En,{size:20})})]}),h.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto mb-4 custom-scrollbar",children:o.length===0?h.jsx("p",{className:"text-slate-500 text-sm text-center py-8 border-2 border-dashed border-slate-200 rounded-lg",children:O.noSaved}):o.map(z=>h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:se=>{if(se.stopPropagation(),confirm(i==="pt"?`Excluir "${z.name}"?`:`Delete "${z.name}"?`)){const ye=o.filter(L=>L.id!==z.id);a(ye),localStorage.setItem("nozesia_projects",JSON.stringify(ye))}},className:"p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors shrink-0",title:i==="pt"?"Excluir":"Delete",children:h.jsx(Ba,{size:16})}),h.jsxs("button",{onClick:()=>_e(z),className:"flex-1 text-left p-3 hover:bg-emerald-50 rounded-lg border border-slate-100 hover:border-emerald-200 group transition-all min-w-0",children:[h.jsx("div",{className:"font-medium text-slate-800 group-hover:text-emerald-700 truncate",children:z.name}),h.jsx("div",{className:"text-xs text-slate-400 truncate",children:z.description||(i==="pt"?"Sem descrio":"No description")})]})]},z.id))}),h.jsx("button",{onClick:()=>u(!1),className:"w-full py-3 bg-slate-100 text-slate-600 rounded-xl font-medium hover:bg-slate-200 transition-colors",children:O.close})]})});return e==="PLAYER"&&n?h.jsxs(h.Fragment,{children:[h.jsx(OI,{project:n,onBack:()=>t("HOME"),language:i,onOpenSaved:()=>u(!0),onEditKey:()=>t("BUILDER")}),ge(),ae()]}):e==="BUILDER"?h.jsxs(h.Fragment,{children:[h.jsx(SM,{initialProject:n,onSave:we,onCancel:()=>t("HOME"),language:i,defaultModel:E,apiKey:N,onOpenSettings:z=>{g(z||!1),p(!0)},reopenAiModal:m&&!c||G,onAiModalOpened:()=>{g(!1),k(!1)},onProjectImported:z=>{a(se=>[z,...se.filter(ye=>ye.id!==z.id)])}}),ge()]}):h.jsxs("div",{className:"min-h-screen bg-[#0f2e24] flex items-center justify-center p-4 md:p-6 relative overflow-hidden font-sans",children:[h.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden pointer-events-none",children:[h.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[400px] md:w-[600px] h-[400px] md:h-[600px] bg-emerald-600/20 rounded-full blur-[80px] md:blur-[120px]"}),h.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[300px] md:w-[500px] h-[300px] md:h-[500px] bg-teal-500/20 rounded-full blur-[80px] md:blur-[100px]"}),h.jsx(pl,{className:"absolute top-[10%] right-[15%] text-emerald-800/20 w-20 h-20 md:w-32 md:h-32 rotate-12"}),h.jsx($E,{className:"absolute bottom-[20%] left-[10%] text-emerald-800/20 w-32 h-32 md:w-48 md:h-48 -rotate-12"})]}),h.jsxs("div",{className:"max-w-6xl w-full grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12 items-center z-10",children:[h.jsxs("div",{className:"text-white space-y-6 md:space-y-8",children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsx("div",{className:"inline-flex items-center gap-2 bg-emerald-900/50 text-emerald-300 px-3 py-1 rounded-full text-[10px] md:text-xs font-semibold tracking-wider uppercase border border-emerald-500/30 backdrop-blur-sm",children:O.subtitle}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("div",{className:"flex bg-emerald-900/50 rounded-lg p-1 border border-emerald-500/30 backdrop-blur-sm",children:[h.jsx("button",{onClick:()=>s("pt"),className:`px-3 py-1 rounded text-xs font-bold transition-colors ${i==="pt"?"bg-emerald-500 text-white":"text-emerald-400 hover:text-white"}`,children:"PT"}),h.jsx("button",{onClick:()=>s("en"),className:`px-3 py-1 rounded text-xs font-bold transition-colors ${i==="en"?"bg-emerald-500 text-white":"text-emerald-400 hover:text-white"}`,children:"EN"})]}),h.jsx("button",{onClick:()=>x(!0),className:"bg-emerald-900/50 rounded-lg p-1.5 border border-emerald-500/30 backdrop-blur-sm text-emerald-400 hover:text-white hover:bg-emerald-800/50 transition-colors",title:O.help,children:h.jsx(FE,{size:20})}),h.jsx("button",{onClick:()=>p(!0),className:`bg-emerald-900/50 rounded-lg p-1.5 border backdrop-blur-sm transition-colors ${N?"border-emerald-500/30 text-emerald-400 hover:text-white hover:bg-emerald-800/50":"border-amber-500 text-amber-500 animate-pulse"}`,title:O.settings,children:h.jsx(Q0,{size:20})})]})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center gap-3 md:gap-4 mb-2",children:[h.jsx("div",{className:"bg-amber-800/20 p-2 md:p-3 rounded-2xl border-2 border-amber-600/30 backdrop-blur-md shadow-[0_0_30px_rgba(217,119,6,0.2)]",children:h.jsx(Yi,{className:"text-amber-500 w-12 h-12 md:w-20 md:h-20",strokeWidth:1.5})}),h.jsx("h1",{className:"text-5xl md:text-7xl font-black tracking-tight leading-none text-transparent bg-clip-text bg-gradient-to-br from-amber-300 via-amber-500 to-orange-400 drop-shadow-sm",children:"NOZES"})]}),h.jsx("h2",{className:"text-lg md:text-2xl text-emerald-100/80 font-light pl-2",children:O.tagline})]}),h.jsx("p",{className:"text-slate-300 text-base md:text-lg leading-relaxed max-w-lg border-l-4 border-amber-500/50 pl-4 md:pl-6",children:O.desc}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 md:gap-4 pt-2",children:[h.jsxs("button",{onClick:X,className:"col-span-1 sm:col-span-2 flex items-center justify-center gap-3 px-8 py-4 bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-400 hover:to-orange-400 text-white rounded-xl font-bold transition-all shadow-xl shadow-amber-900/50 hover:scale-[1.02] text-lg border-t border-amber-300/30 active:scale-95 animate-pulse hover:animate-none",children:[h.jsx(Yi,{className:"w-6 h-6"}),i==="pt"?"Nozes IA":"NUTS AI"]}),h.jsxs("button",{onClick:J,className:"col-span-1 sm:col-span-2 flex items-center justify-center gap-3 px-8 py-4 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white rounded-xl font-bold transition-all shadow-xl shadow-emerald-900/50 hover:scale-[1.02] text-lg border-t border-emerald-400/20 active:scale-95",children:[h.jsx(K0,{className:"w-5 h-5"}),O.createNew]}),h.jsxs("button",{onClick:()=>u(!0),className:"flex items-center justify-center gap-2 px-6 py-3 bg-emerald-900/40 hover:bg-emerald-800/40 text-emerald-100 rounded-xl font-medium transition-all border border-emerald-500/20 hover:border-emerald-500/50 backdrop-blur-sm active:scale-95",children:[h.jsx(Xi,{className:"w-4 h-4"}),O.openSaved]}),h.jsxs("label",{className:"flex items-center justify-center gap-2 px-6 py-3 bg-emerald-900/40 hover:bg-emerald-800/40 text-emerald-100 rounded-xl font-medium transition-all border border-emerald-500/20 hover:border-emerald-500/50 backdrop-blur-sm cursor-pointer active:scale-95",children:[h.jsx(Ni,{className:"w-4 h-4"}),O.importJson,h.jsx("input",{type:"file",accept:".json",onChange:Ne,className:"hidden"})]}),h.jsxs("button",{onClick:re,className:"col-span-1 sm:col-span-2 mt-2 text-sm text-emerald-400 hover:text-emerald-200 flex items-center justify-center gap-2 font-medium py-2",children:[h.jsx(Xc,{className:"w-3 h-3"}),O.demo]})]})]}),h.jsx("div",{className:"relative hidden lg:block transform perspective-1000 hover:rotate-y-2 transition-transform duration-700",children:h.jsxs("div",{className:"relative bg-gradient-to-br from-emerald-900/80 to-teal-900/80 backdrop-blur-md border border-emerald-500/20 p-8 rounded-3xl shadow-2xl",children:[h.jsx("div",{className:"absolute -top-10 -right-10 text-emerald-400/10",children:h.jsx(LE,{size:200})}),h.jsxs("div",{className:"flex items-center gap-3 mb-8 border-b border-emerald-500/20 pb-6",children:[h.jsx("div",{className:"w-3 h-3 rounded-full bg-red-400/80"}),h.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-400/80"}),h.jsx("div",{className:"w-3 h-3 rounded-full bg-green-400/80"}),h.jsx("div",{className:"ml-auto text-xs text-amber-500/80 font-mono tracking-widest font-bold",children:"NOZES.IA-v2"})]}),h.jsx("div",{className:"space-y-6 opacity-90",children:h.jsxs("div",{className:"flex gap-6",children:[h.jsxs("div",{className:"w-1/3 space-y-3",children:[h.jsx("div",{className:"h-2 bg-emerald-700/50 rounded w-1/2 mb-4"}),h.jsxs("div",{className:"h-10 bg-emerald-500/20 border-l-2 border-emerald-400 rounded-r flex items-center px-3 text-emerald-200 text-xs gap-2",children:[h.jsx(pl,{size:12})," Folhas"]}),h.jsx("div",{className:"h-10 bg-emerald-900/30 rounded flex items-center px-3 text-emerald-600/50 text-xs",children:"Flores"}),h.jsx("div",{className:"h-10 bg-emerald-900/30 rounded flex items-center px-3 text-emerald-600/50 text-xs",children:"Caule"})]}),h.jsx("div",{className:"w-2/3 grid grid-cols-2 gap-3",children:[1,2,3,4].map(z=>h.jsxs("div",{className:"bg-emerald-950/50 rounded-lg p-3 border border-emerald-500/10 flex flex-col gap-2",children:[h.jsx("div",{className:"aspect-video bg-emerald-900/50 rounded flex items-center justify-center",children:h.jsx(NE,{className:"text-emerald-700/50",size:20})}),h.jsx("div",{className:"h-1.5 bg-emerald-800/50 rounded w-3/4"}),h.jsx("div",{className:"h-1.5 bg-emerald-800/30 rounded w-1/2"})]},z))})]})}),h.jsxs("div",{className:"mt-8 pt-6 border-t border-emerald-500/20 flex justify-between items-center text-emerald-400/40 text-xs",children:[h.jsx("span",{children:"Gemini 2.5 Flash Integrated"}),h.jsx("span",{children:"100% Client-Side"})]})]})})]}),ge(),y&&h.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-0 overflow-hidden animate-in fade-in zoom-in-95 flex flex-col max-h-[85vh]",children:[h.jsxs("div",{className:"p-4 md:p-6 border-b flex justify-between items-center bg-slate-50",children:[h.jsxs("div",{className:"flex gap-4 items-center",children:[h.jsxs("h3",{className:"text-lg md:text-xl font-bold text-slate-800 flex items-center gap-2",children:[h.jsx(kx,{className:"text-emerald-600",size:24}),O.help]}),h.jsxs("div",{className:"flex bg-slate-200/50 p-1 rounded-lg",children:[h.jsx("button",{onClick:()=>T("ABOUT"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${S==="ABOUT"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Sobre"}),h.jsx("button",{onClick:()=>T("HELP"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${S==="HELP"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Ajuda"})]})]}),h.jsx("button",{onClick:()=>x(!1),className:"text-slate-400 hover:text-slate-600 p-2",children:h.jsx(En,{size:24})})]}),h.jsx("div",{className:"p-4 md:p-6 overflow-y-auto custom-scrollbar space-y-6 md:space-y-8",children:S==="ABOUT"?h.jsxs(h.Fragment,{children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:" Sobre o Criador"}),h.jsxs("div",{className:"creator-info space-y-4 text-slate-700",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-semibold text-emerald-700",children:"Diogo Bueno Kanoute"}),h.jsx("p",{className:"font-medium",children:"Parabotnico e Dendrlogo em Inventrio Florestal"}),h.jsx("p",{className:"text-sm md:text-base mt-2",children:"Desenvolvedor especializado em Tecnologias de Inteligncia Artificial e Banco de Dados para Inventrio Florestal, Ecologia, Botnica, Dendrometria e Dendrologia."})]}),h.jsx("h4",{className:"text-lg font-bold text-slate-800 mt-8 border-t pt-4",children:" Links e Contatos"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{className:"bg-slate-800 p-3 rounded-lg border border-slate-700 hover:border-emerald-400 transition-colors col-span-full",children:[h.jsx("strong",{className:"block text-sm text-emerald-400 mb-1",children:" Projeto no GitHub"}),h.jsxs("a",{href:"https://github.com/DJHanDoom/Nozes",target:"_blank",rel:"noopener noreferrer",className:"text-white hover:text-emerald-300 font-medium flex items-center gap-2",children:["github.com/DJHanDoom/Nozes",h.jsx(dl,{size:14})]})]}),h.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[h.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:"Identificao Botnica"}),h.jsx("a",{href:"https://go.hotmart.com/G103222293V",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"Curso Online na Hotmart"})]}),h.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[h.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" Fototeca DBK no SPLink"}),h.jsx("a",{href:"https://specieslink.net/col/FDBK",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"specieslink.net/col/FDBK"})]}),h.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[h.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" Instagram Cientfico"}),h.jsx("a",{href:"https://instagram.com/fotografandomato",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"@fotografandomato"})]}),h.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[h.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" Biblioteca Botnica"}),h.jsx("a",{href:"https://drive.google.com/drive/folders/0B4wGMi_KVTvOWm51UzNnNVJjaEk?resourcekey=0-8e69zvcLn2zMXuphNmC56A&usp=drive_link",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"PDFs e Material de Referncia"})]}),h.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[h.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" E-mail"}),h.jsx("a",{href:"mailto:diogokanoute@gmail.com",className:"text-emerald-600 hover:underline font-medium",children:"diogokanoute@gmail.com"})]}),h.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[h.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" WhatsApp Cientfico"}),h.jsx("a",{href:"https://wa.me/5521998501623",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"+55 21 998501623"})]})]}),h.jsx("p",{className:"text-sm text-slate-500 italic mt-6 bg-amber-50 p-4 rounded-lg border border-amber-100",children:"Entre em contato para dvidas sobre o app, cursos de Identificao Botnica, tecnologias de IA aplicadas  Dendrologia ou servios de Inventrio Florestal (Mata Atlntica, Cerrado, Amaznia e Caatinga)."})]})]}):h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"bg-emerald-50 p-4 rounded-xl border border-emerald-100 text-slate-700 leading-relaxed text-sm md:text-base",children:O.helpContent.intro}),h.jsxs("div",{className:"grid gap-6",children:[h.jsxs("div",{className:"flex gap-4",children:[h.jsx("div",{className:"bg-amber-100 p-3 rounded-full h-fit text-amber-600 shrink-0",children:h.jsx(Yi,{size:24})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:O.helpContent.step1Title}),h.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:O.helpContent.step1Desc})]})]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("div",{className:"bg-blue-100 p-3 rounded-full h-fit text-blue-600 shrink-0",children:h.jsx(K0,{size:24})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:O.helpContent.step2Title}),h.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:O.helpContent.step2Desc})]})]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("div",{className:"bg-emerald-100 p-3 rounded-full h-fit text-emerald-600 shrink-0",children:h.jsx(Xc,{size:24})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:O.helpContent.step3Title}),h.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:O.helpContent.step3Desc})]})]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("div",{className:"bg-purple-100 p-3 rounded-full h-fit text-purple-600 shrink-0",children:h.jsx(ml,{size:24})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:O.helpContent.importExportTitle}),h.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:O.helpContent.importExportDesc})]})]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("div",{className:"bg-rose-100 p-3 rounded-full h-fit text-rose-600 shrink-0",children:h.jsx(hl,{size:24})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:O.helpContent.htmlExportTitle}),h.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:O.helpContent.htmlExportDesc})]})]})]})]})}),h.jsx("div",{className:"p-4 bg-slate-50 border-t",children:h.jsx("button",{onClick:()=>x(!1),className:"w-full py-3 bg-emerald-600 text-white rounded-xl font-bold hover:bg-emerald-500 transition-colors",children:O.close})})]})}),ae()]})},qv=document.getElementById("root");if(!qv)throw new Error("Could not find root element to mount to");const CM=ec.createRoot(qv);CM.render(h.jsx(Ia.StrictMode,{children:h.jsx(wM,{})}));

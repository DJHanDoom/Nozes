(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Dv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Hp={exports:{}},cl={},zp={exports:{}},Re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var To=Symbol.for("react.element"),Lv=Symbol.for("react.portal"),Uv=Symbol.for("react.fragment"),Ov=Symbol.for("react.strict_mode"),Bv=Symbol.for("react.profiler"),bv=Symbol.for("react.provider"),Vv=Symbol.for("react.context"),Gv=Symbol.for("react.forward_ref"),Hv=Symbol.for("react.suspense"),zv=Symbol.for("react.memo"),Wv=Symbol.for("react.lazy"),d0=Symbol.iterator;function qv(e){return e===null||typeof e!="object"?null:(e=d0&&e[d0]||e["@@iterator"],typeof e=="function"?e:null)}var Wp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qp=Object.assign,$p={};function ts(e,t,n){this.props=e,this.context=t,this.refs=$p,this.updater=n||Wp}ts.prototype.isReactComponent={};ts.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ts.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Jp(){}Jp.prototype=ts.prototype;function Mf(e,t,n){this.props=e,this.context=t,this.refs=$p,this.updater=n||Wp}var Df=Mf.prototype=new Jp;Df.constructor=Mf;qp(Df,ts.prototype);Df.isPureReactComponent=!0;var h0=Array.isArray,Kp=Object.prototype.hasOwnProperty,Lf={current:null},Yp={key:!0,ref:!0,__self:!0,__source:!0};function Xp(e,t,n){var r,i={},s=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)Kp.call(t,r)&&!Yp.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:To,type:e,key:s,ref:o,props:i,_owner:Lf.current}}function $v(e,t){return{$$typeof:To,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Uf(e){return typeof e=="object"&&e!==null&&e.$$typeof===To}function Jv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var p0=/\/+/g;function Gl(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Jv(""+e.key):t.toString(36)}function oa(e,t,n,r,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case To:case Lv:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+Gl(o,0):r,h0(i)?(n="",e!=null&&(n=e.replace(p0,"$&/")+"/"),oa(i,t,n,"",function(u){return u})):i!=null&&(Uf(i)&&(i=$v(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(p0,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",h0(e))for(var a=0;a<e.length;a++){s=e[a];var l=r+Gl(s,a);o+=oa(s,t,n,l,i)}else if(l=qv(e),typeof l=="function")for(e=l.call(e),a=0;!(s=e.next()).done;)s=s.value,l=r+Gl(s,a++),o+=oa(s,t,n,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Mo(e,t,n){if(e==null)return e;var r=[],i=0;return oa(e,r,"","",function(s){return t.call(n,s,i++)}),r}function Kv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var zt={current:null},aa={transition:null},Yv={ReactCurrentDispatcher:zt,ReactCurrentBatchConfig:aa,ReactCurrentOwner:Lf};function Qp(){throw Error("act(...) is not supported in production builds of React.")}Re.Children={map:Mo,forEach:function(e,t,n){Mo(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Mo(e,function(){t++}),t},toArray:function(e){return Mo(e,function(t){return t})||[]},only:function(e){if(!Uf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Re.Component=ts;Re.Fragment=Uv;Re.Profiler=Bv;Re.PureComponent=Mf;Re.StrictMode=Ov;Re.Suspense=Hv;Re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yv;Re.act=Qp;Re.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=qp({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=Lf.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)Kp.call(t,l)&&!Yp.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:To,type:e.type,key:i,ref:s,props:r,_owner:o}};Re.createContext=function(e){return e={$$typeof:Vv,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:bv,_context:e},e.Consumer=e};Re.createElement=Xp;Re.createFactory=function(e){var t=Xp.bind(null,e);return t.type=e,t};Re.createRef=function(){return{current:null}};Re.forwardRef=function(e){return{$$typeof:Gv,render:e}};Re.isValidElement=Uf;Re.lazy=function(e){return{$$typeof:Wv,_payload:{_status:-1,_result:e},_init:Kv}};Re.memo=function(e,t){return{$$typeof:zv,type:e,compare:t===void 0?null:t}};Re.startTransition=function(e){var t=aa.transition;aa.transition={};try{e()}finally{aa.transition=t}};Re.unstable_act=Qp;Re.useCallback=function(e,t){return zt.current.useCallback(e,t)};Re.useContext=function(e){return zt.current.useContext(e)};Re.useDebugValue=function(){};Re.useDeferredValue=function(e){return zt.current.useDeferredValue(e)};Re.useEffect=function(e,t){return zt.current.useEffect(e,t)};Re.useId=function(){return zt.current.useId()};Re.useImperativeHandle=function(e,t,n){return zt.current.useImperativeHandle(e,t,n)};Re.useInsertionEffect=function(e,t){return zt.current.useInsertionEffect(e,t)};Re.useLayoutEffect=function(e,t){return zt.current.useLayoutEffect(e,t)};Re.useMemo=function(e,t){return zt.current.useMemo(e,t)};Re.useReducer=function(e,t,n){return zt.current.useReducer(e,t,n)};Re.useRef=function(e){return zt.current.useRef(e)};Re.useState=function(e){return zt.current.useState(e)};Re.useSyncExternalStore=function(e,t,n){return zt.current.useSyncExternalStore(e,t,n)};Re.useTransition=function(){return zt.current.useTransition()};Re.version="18.3.1";zp.exports=Re;var Ne=zp.exports;const jp=Dv(Ne);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xv=Ne,Qv=Symbol.for("react.element"),jv=Symbol.for("react.fragment"),Zv=Object.prototype.hasOwnProperty,ey=Xv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ty={key:!0,ref:!0,__self:!0,__source:!0};function Zp(e,t,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)Zv.call(t,r)&&!ty.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:Qv,type:e,key:s,ref:o,props:i,_owner:ey.current}}cl.Fragment=jv;cl.jsx=Zp;cl.jsxs=Zp;Hp.exports=cl;var g=Hp.exports,wu={},em={exports:{}},un={},tm={exports:{}},nm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(oe,ge){var _e=oe.length;oe.push(ge);e:for(;0<_e;){var ke=_e-1>>>1,P=oe[ke];if(0<i(P,ge))oe[ke]=ge,oe[_e]=P,_e=ke;else break e}}function n(oe){return oe.length===0?null:oe[0]}function r(oe){if(oe.length===0)return null;var ge=oe[0],_e=oe.pop();if(_e!==ge){oe[0]=_e;e:for(var ke=0,P=oe.length,W=P>>>1;ke<W;){var O=2*(ke+1)-1,U=oe[O],Q=O+1,he=oe[Q];if(0>i(U,_e))Q<P&&0>i(he,U)?(oe[ke]=he,oe[Q]=_e,ke=Q):(oe[ke]=U,oe[O]=_e,ke=O);else if(Q<P&&0>i(he,_e))oe[ke]=he,oe[Q]=_e,ke=Q;else break e}}return ge}function i(oe,ge){var _e=oe.sortIndex-ge.sortIndex;return _e!==0?_e:oe.id-ge.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,h=null,p=3,m=!1,y=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(oe){for(var ge=n(u);ge!==null;){if(ge.callback===null)r(u);else if(ge.startTime<=oe)r(u),ge.sortIndex=ge.expirationTime,t(l,ge);else break;ge=n(u)}}function C(oe){if(x=!1,v(oe),!y)if(n(l)!==null)y=!0,Ee(D);else{var ge=n(u);ge!==null&&Me(C,ge.startTime-oe)}}function D(oe,ge){y=!1,x&&(x=!1,T(L),L=-1),m=!0;var _e=p;try{for(v(ge),h=n(l);h!==null&&(!(h.expirationTime>ge)||oe&&!J());){var ke=h.callback;if(typeof ke=="function"){h.callback=null,p=h.priorityLevel;var P=ke(h.expirationTime<=ge);ge=e.unstable_now(),typeof P=="function"?h.callback=P:h===n(l)&&r(l),v(ge)}else r(l);h=n(l)}if(h!==null)var W=!0;else{var O=n(u);O!==null&&Me(C,O.startTime-ge),W=!1}return W}finally{h=null,p=_e,m=!1}}var F=!1,I=null,L=-1,M=5,B=-1;function J(){return!(e.unstable_now()-B<M)}function H(){if(I!==null){var oe=e.unstable_now();B=oe;var ge=!0;try{ge=I(!0,oe)}finally{ge?Z():(F=!1,I=null)}}else F=!1}var Z;if(typeof _=="function")Z=function(){_(H)};else if(typeof MessageChannel<"u"){var Te=new MessageChannel,ye=Te.port2;Te.port1.onmessage=H,Z=function(){ye.postMessage(null)}}else Z=function(){E(H,0)};function Ee(oe){I=oe,F||(F=!0,Z())}function Me(oe,ge){L=E(function(){oe(e.unstable_now())},ge)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(oe){oe.callback=null},e.unstable_continueExecution=function(){y||m||(y=!0,Ee(D))},e.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<oe?Math.floor(1e3/oe):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(oe){switch(p){case 1:case 2:case 3:var ge=3;break;default:ge=p}var _e=p;p=ge;try{return oe()}finally{p=_e}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(oe,ge){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var _e=p;p=oe;try{return ge()}finally{p=_e}},e.unstable_scheduleCallback=function(oe,ge,_e){var ke=e.unstable_now();switch(typeof _e=="object"&&_e!==null?(_e=_e.delay,_e=typeof _e=="number"&&0<_e?ke+_e:ke):_e=ke,oe){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=_e+P,oe={id:d++,callback:ge,priorityLevel:oe,startTime:_e,expirationTime:P,sortIndex:-1},_e>ke?(oe.sortIndex=_e,t(u,oe),n(l)===null&&oe===n(u)&&(x?(T(L),L=-1):x=!0,Me(C,_e-ke))):(oe.sortIndex=P,t(l,oe),y||m||(y=!0,Ee(D))),oe},e.unstable_shouldYield=J,e.unstable_wrapCallback=function(oe){var ge=p;return function(){var _e=p;p=ge;try{return oe.apply(this,arguments)}finally{p=_e}}}})(nm);tm.exports=nm;var ny=tm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ry=Ne,an=ny;function ne(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var rm=new Set,Xs={};function ai(e,t){Ji(e,t),Ji(e+"Capture",t)}function Ji(e,t){for(Xs[e]=t,e=0;e<t.length;e++)rm.add(t[e])}var rr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cu=Object.prototype.hasOwnProperty,iy=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m0={},g0={};function sy(e){return Cu.call(g0,e)?!0:Cu.call(m0,e)?!1:iy.test(e)?g0[e]=!0:(m0[e]=!0,!1)}function oy(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ay(e,t,n,r){if(t===null||typeof t>"u"||oy(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Wt(e,t,n,r,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var It={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){It[e]=new Wt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];It[t]=new Wt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){It[e]=new Wt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){It[e]=new Wt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){It[e]=new Wt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){It[e]=new Wt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){It[e]=new Wt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){It[e]=new Wt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){It[e]=new Wt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Of=/[\-:]([a-z])/g;function Bf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Of,Bf);It[t]=new Wt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Of,Bf);It[t]=new Wt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Of,Bf);It[t]=new Wt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){It[e]=new Wt(e,1,!1,e.toLowerCase(),null,!1,!1)});It.xlinkHref=new Wt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){It[e]=new Wt(e,1,!1,e.toLowerCase(),null,!0,!0)});function bf(e,t,n,r){var i=It.hasOwnProperty(t)?It[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ay(t,n,i,r)&&(n=null),r||i===null?sy(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var fr=ry.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Do=Symbol.for("react.element"),_i=Symbol.for("react.portal"),Ti=Symbol.for("react.fragment"),Vf=Symbol.for("react.strict_mode"),Au=Symbol.for("react.profiler"),im=Symbol.for("react.provider"),sm=Symbol.for("react.context"),Gf=Symbol.for("react.forward_ref"),Nu=Symbol.for("react.suspense"),Iu=Symbol.for("react.suspense_list"),Hf=Symbol.for("react.memo"),xr=Symbol.for("react.lazy"),om=Symbol.for("react.offscreen"),x0=Symbol.iterator;function ms(e){return e===null||typeof e!="object"?null:(e=x0&&e[x0]||e["@@iterator"],typeof e=="function"?e:null)}var et=Object.assign,Hl;function As(e){if(Hl===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Hl=t&&t[1]||""}return`
`+Hl+e}var zl=!1;function Wl(e,t){if(!e||zl)return"";zl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=a);break}}}finally{zl=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?As(e):""}function ly(e){switch(e.tag){case 5:return As(e.type);case 16:return As("Lazy");case 13:return As("Suspense");case 19:return As("SuspenseList");case 0:case 2:case 15:return e=Wl(e.type,!1),e;case 11:return e=Wl(e.type.render,!1),e;case 1:return e=Wl(e.type,!0),e;default:return""}}function ku(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ti:return"Fragment";case _i:return"Portal";case Au:return"Profiler";case Vf:return"StrictMode";case Nu:return"Suspense";case Iu:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case sm:return(e.displayName||"Context")+".Consumer";case im:return(e._context.displayName||"Context")+".Provider";case Gf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Hf:return t=e.displayName||null,t!==null?t:ku(e.type)||"Memo";case xr:t=e._payload,e=e._init;try{return ku(e(t))}catch{}}return null}function uy(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ku(t);case 8:return t===Vf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Mr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function am(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function fy(e){var t=am(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Lo(e){e._valueTracker||(e._valueTracker=fy(e))}function lm(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=am(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Ta(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ru(e,t){var n=t.checked;return et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function v0(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Mr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function um(e,t){t=t.checked,t!=null&&bf(e,"checked",t,!1)}function Pu(e,t){um(e,t);var n=Mr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Fu(e,t.type,n):t.hasOwnProperty("defaultValue")&&Fu(e,t.type,Mr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function y0(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Fu(e,t,n){(t!=="number"||Ta(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ns=Array.isArray;function Di(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Mr(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Mu(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ne(91));return et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function _0(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ne(92));if(Ns(n)){if(1<n.length)throw Error(ne(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Mr(n)}}function fm(e,t){var n=Mr(t.value),r=Mr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function T0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function cm(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Du(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?cm(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Uo,dm=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Uo=Uo||document.createElement("div"),Uo.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Uo.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Qs(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Ps={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cy=["Webkit","ms","Moz","O"];Object.keys(Ps).forEach(function(e){cy.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ps[t]=Ps[e]})});function hm(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Ps.hasOwnProperty(e)&&Ps[e]?(""+t).trim():t+"px"}function pm(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=hm(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var dy=et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Lu(e,t){if(t){if(dy[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ne(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ne(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ne(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ne(62))}}function Uu(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ou=null;function zf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Bu=null,Li=null,Ui=null;function E0(e){if(e=wo(e)){if(typeof Bu!="function")throw Error(ne(280));var t=e.stateNode;t&&(t=gl(t),Bu(e.stateNode,e.type,t))}}function mm(e){Li?Ui?Ui.push(e):Ui=[e]:Li=e}function gm(){if(Li){var e=Li,t=Ui;if(Ui=Li=null,E0(e),t)for(e=0;e<t.length;e++)E0(t[e])}}function xm(e,t){return e(t)}function vm(){}var ql=!1;function ym(e,t,n){if(ql)return e(t,n);ql=!0;try{return xm(e,t,n)}finally{ql=!1,(Li!==null||Ui!==null)&&(vm(),gm())}}function js(e,t){var n=e.stateNode;if(n===null)return null;var r=gl(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ne(231,t,typeof n));return n}var bu=!1;if(rr)try{var gs={};Object.defineProperty(gs,"passive",{get:function(){bu=!0}}),window.addEventListener("test",gs,gs),window.removeEventListener("test",gs,gs)}catch{bu=!1}function hy(e,t,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(d){this.onError(d)}}var Fs=!1,Ea=null,Sa=!1,Vu=null,py={onError:function(e){Fs=!0,Ea=e}};function my(e,t,n,r,i,s,o,a,l){Fs=!1,Ea=null,hy.apply(py,arguments)}function gy(e,t,n,r,i,s,o,a,l){if(my.apply(this,arguments),Fs){if(Fs){var u=Ea;Fs=!1,Ea=null}else throw Error(ne(198));Sa||(Sa=!0,Vu=u)}}function li(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function _m(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function S0(e){if(li(e)!==e)throw Error(ne(188))}function xy(e){var t=e.alternate;if(!t){if(t=li(e),t===null)throw Error(ne(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return S0(i),e;if(s===r)return S0(i),t;s=s.sibling}throw Error(ne(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(ne(189))}}if(n.alternate!==r)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?e:t}function Tm(e){return e=xy(e),e!==null?Em(e):null}function Em(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Em(e);if(t!==null)return t;e=e.sibling}return null}var Sm=an.unstable_scheduleCallback,w0=an.unstable_cancelCallback,vy=an.unstable_shouldYield,yy=an.unstable_requestPaint,st=an.unstable_now,_y=an.unstable_getCurrentPriorityLevel,Wf=an.unstable_ImmediatePriority,wm=an.unstable_UserBlockingPriority,wa=an.unstable_NormalPriority,Ty=an.unstable_LowPriority,Cm=an.unstable_IdlePriority,dl=null,zn=null;function Ey(e){if(zn&&typeof zn.onCommitFiberRoot=="function")try{zn.onCommitFiberRoot(dl,e,void 0,(e.current.flags&128)===128)}catch{}}var Pn=Math.clz32?Math.clz32:Cy,Sy=Math.log,wy=Math.LN2;function Cy(e){return e>>>=0,e===0?32:31-(Sy(e)/wy|0)|0}var Oo=64,Bo=4194304;function Is(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ca(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Is(a):(s&=o,s!==0&&(r=Is(s)))}else o=n&~i,o!==0?r=Is(o):s!==0&&(r=Is(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Pn(t),i=1<<n,r|=e[n],t&=~i;return r}function Ay(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ny(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Pn(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=Ay(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}function Gu(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Am(){var e=Oo;return Oo<<=1,!(Oo&4194240)&&(Oo=64),e}function $l(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Eo(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Pn(t),e[t]=n}function Iy(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Pn(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}function qf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Pn(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Ge=0;function Nm(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Im,$f,km,Rm,Pm,Hu=!1,bo=[],Cr=null,Ar=null,Nr=null,Zs=new Map,eo=new Map,yr=[],ky="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function C0(e,t){switch(e){case"focusin":case"focusout":Cr=null;break;case"dragenter":case"dragleave":Ar=null;break;case"mouseover":case"mouseout":Nr=null;break;case"pointerover":case"pointerout":Zs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":eo.delete(t.pointerId)}}function xs(e,t,n,r,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},t!==null&&(t=wo(t),t!==null&&$f(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Ry(e,t,n,r,i){switch(t){case"focusin":return Cr=xs(Cr,e,t,n,r,i),!0;case"dragenter":return Ar=xs(Ar,e,t,n,r,i),!0;case"mouseover":return Nr=xs(Nr,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Zs.set(s,xs(Zs.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,eo.set(s,xs(eo.get(s)||null,e,t,n,r,i)),!0}return!1}function Fm(e){var t=Jr(e.target);if(t!==null){var n=li(t);if(n!==null){if(t=n.tag,t===13){if(t=_m(n),t!==null){e.blockedOn=t,Pm(e.priority,function(){km(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function la(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=zu(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Ou=r,n.target.dispatchEvent(r),Ou=null}else return t=wo(n),t!==null&&$f(t),e.blockedOn=n,!1;t.shift()}return!0}function A0(e,t,n){la(e)&&n.delete(t)}function Py(){Hu=!1,Cr!==null&&la(Cr)&&(Cr=null),Ar!==null&&la(Ar)&&(Ar=null),Nr!==null&&la(Nr)&&(Nr=null),Zs.forEach(A0),eo.forEach(A0)}function vs(e,t){e.blockedOn===t&&(e.blockedOn=null,Hu||(Hu=!0,an.unstable_scheduleCallback(an.unstable_NormalPriority,Py)))}function to(e){function t(i){return vs(i,e)}if(0<bo.length){vs(bo[0],e);for(var n=1;n<bo.length;n++){var r=bo[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Cr!==null&&vs(Cr,e),Ar!==null&&vs(Ar,e),Nr!==null&&vs(Nr,e),Zs.forEach(t),eo.forEach(t),n=0;n<yr.length;n++)r=yr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<yr.length&&(n=yr[0],n.blockedOn===null);)Fm(n),n.blockedOn===null&&yr.shift()}var Oi=fr.ReactCurrentBatchConfig,Aa=!0;function Fy(e,t,n,r){var i=Ge,s=Oi.transition;Oi.transition=null;try{Ge=1,Jf(e,t,n,r)}finally{Ge=i,Oi.transition=s}}function My(e,t,n,r){var i=Ge,s=Oi.transition;Oi.transition=null;try{Ge=4,Jf(e,t,n,r)}finally{Ge=i,Oi.transition=s}}function Jf(e,t,n,r){if(Aa){var i=zu(e,t,n,r);if(i===null)nu(e,t,r,Na,n),C0(e,r);else if(Ry(i,e,t,n,r))r.stopPropagation();else if(C0(e,r),t&4&&-1<ky.indexOf(e)){for(;i!==null;){var s=wo(i);if(s!==null&&Im(s),s=zu(e,t,n,r),s===null&&nu(e,t,r,Na,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else nu(e,t,r,null,n)}}var Na=null;function zu(e,t,n,r){if(Na=null,e=zf(r),e=Jr(e),e!==null)if(t=li(e),t===null)e=null;else if(n=t.tag,n===13){if(e=_m(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Na=e,null}function Mm(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_y()){case Wf:return 1;case wm:return 4;case wa:case Ty:return 16;case Cm:return 536870912;default:return 16}default:return 16}}var Tr=null,Kf=null,ua=null;function Dm(){if(ua)return ua;var e,t=Kf,n=t.length,r,i="value"in Tr?Tr.value:Tr.textContent,s=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[s-r];r++);return ua=i.slice(e,1<r?1-r:void 0)}function fa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Vo(){return!0}function N0(){return!1}function fn(e){function t(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Vo:N0,this.isPropagationStopped=N0,this}return et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Vo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Vo)},persist:function(){},isPersistent:Vo}),t}var ns={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yf=fn(ns),So=et({},ns,{view:0,detail:0}),Dy=fn(So),Jl,Kl,ys,hl=et({},So,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ys&&(ys&&e.type==="mousemove"?(Jl=e.screenX-ys.screenX,Kl=e.screenY-ys.screenY):Kl=Jl=0,ys=e),Jl)},movementY:function(e){return"movementY"in e?e.movementY:Kl}}),I0=fn(hl),Ly=et({},hl,{dataTransfer:0}),Uy=fn(Ly),Oy=et({},So,{relatedTarget:0}),Yl=fn(Oy),By=et({},ns,{animationName:0,elapsedTime:0,pseudoElement:0}),by=fn(By),Vy=et({},ns,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Gy=fn(Vy),Hy=et({},ns,{data:0}),k0=fn(Hy),zy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Wy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $y(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=qy[e])?!!t[e]:!1}function Xf(){return $y}var Jy=et({},So,{key:function(e){if(e.key){var t=zy[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=fa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Wy[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xf,charCode:function(e){return e.type==="keypress"?fa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?fa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Ky=fn(Jy),Yy=et({},hl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),R0=fn(Yy),Xy=et({},So,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xf}),Qy=fn(Xy),jy=et({},ns,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zy=fn(jy),e2=et({},hl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),t2=fn(e2),n2=[9,13,27,32],Qf=rr&&"CompositionEvent"in window,Ms=null;rr&&"documentMode"in document&&(Ms=document.documentMode);var r2=rr&&"TextEvent"in window&&!Ms,Lm=rr&&(!Qf||Ms&&8<Ms&&11>=Ms),P0=" ",F0=!1;function Um(e,t){switch(e){case"keyup":return n2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Om(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ei=!1;function i2(e,t){switch(e){case"compositionend":return Om(t);case"keypress":return t.which!==32?null:(F0=!0,P0);case"textInput":return e=t.data,e===P0&&F0?null:e;default:return null}}function s2(e,t){if(Ei)return e==="compositionend"||!Qf&&Um(e,t)?(e=Dm(),ua=Kf=Tr=null,Ei=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Lm&&t.locale!=="ko"?null:t.data;default:return null}}var o2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function M0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!o2[e.type]:t==="textarea"}function Bm(e,t,n,r){mm(r),t=Ia(t,"onChange"),0<t.length&&(n=new Yf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ds=null,no=null;function a2(e){Ym(e,0)}function pl(e){var t=Ci(e);if(lm(t))return e}function l2(e,t){if(e==="change")return t}var bm=!1;if(rr){var Xl;if(rr){var Ql="oninput"in document;if(!Ql){var D0=document.createElement("div");D0.setAttribute("oninput","return;"),Ql=typeof D0.oninput=="function"}Xl=Ql}else Xl=!1;bm=Xl&&(!document.documentMode||9<document.documentMode)}function L0(){Ds&&(Ds.detachEvent("onpropertychange",Vm),no=Ds=null)}function Vm(e){if(e.propertyName==="value"&&pl(no)){var t=[];Bm(t,no,e,zf(e)),ym(a2,t)}}function u2(e,t,n){e==="focusin"?(L0(),Ds=t,no=n,Ds.attachEvent("onpropertychange",Vm)):e==="focusout"&&L0()}function f2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return pl(no)}function c2(e,t){if(e==="click")return pl(t)}function d2(e,t){if(e==="input"||e==="change")return pl(t)}function h2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Dn=typeof Object.is=="function"?Object.is:h2;function ro(e,t){if(Dn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Cu.call(t,i)||!Dn(e[i],t[i]))return!1}return!0}function U0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function O0(e,t){var n=U0(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=U0(n)}}function Gm(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Gm(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Hm(){for(var e=window,t=Ta();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ta(e.document)}return t}function jf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function p2(e){var t=Hm(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Gm(n.ownerDocument.documentElement,n)){if(r!==null&&jf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=O0(n,s);var o=O0(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var m2=rr&&"documentMode"in document&&11>=document.documentMode,Si=null,Wu=null,Ls=null,qu=!1;function B0(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;qu||Si==null||Si!==Ta(r)||(r=Si,"selectionStart"in r&&jf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ls&&ro(Ls,r)||(Ls=r,r=Ia(Wu,"onSelect"),0<r.length&&(t=new Yf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Si)))}function Go(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wi={animationend:Go("Animation","AnimationEnd"),animationiteration:Go("Animation","AnimationIteration"),animationstart:Go("Animation","AnimationStart"),transitionend:Go("Transition","TransitionEnd")},jl={},zm={};rr&&(zm=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);function ml(e){if(jl[e])return jl[e];if(!wi[e])return e;var t=wi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in zm)return jl[e]=t[n];return e}var Wm=ml("animationend"),qm=ml("animationiteration"),$m=ml("animationstart"),Jm=ml("transitionend"),Km=new Map,b0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Br(e,t){Km.set(e,t),ai(t,[e])}for(var Zl=0;Zl<b0.length;Zl++){var eu=b0[Zl],g2=eu.toLowerCase(),x2=eu[0].toUpperCase()+eu.slice(1);Br(g2,"on"+x2)}Br(Wm,"onAnimationEnd");Br(qm,"onAnimationIteration");Br($m,"onAnimationStart");Br("dblclick","onDoubleClick");Br("focusin","onFocus");Br("focusout","onBlur");Br(Jm,"onTransitionEnd");Ji("onMouseEnter",["mouseout","mouseover"]);Ji("onMouseLeave",["mouseout","mouseover"]);Ji("onPointerEnter",["pointerout","pointerover"]);Ji("onPointerLeave",["pointerout","pointerover"]);ai("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ai("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ai("onBeforeInput",["compositionend","keypress","textInput","paste"]);ai("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ai("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ai("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ks="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),v2=new Set("cancel close invalid load scroll toggle".split(" ").concat(ks));function V0(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,gy(r,t,void 0,e),e.currentTarget=null}function Ym(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;V0(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;V0(i,a,u),s=l}}}if(Sa)throw e=Vu,Sa=!1,Vu=null,e}function qe(e,t){var n=t[Xu];n===void 0&&(n=t[Xu]=new Set);var r=e+"__bubble";n.has(r)||(Xm(t,e,2,!1),n.add(r))}function tu(e,t,n){var r=0;t&&(r|=4),Xm(n,e,r,t)}var Ho="_reactListening"+Math.random().toString(36).slice(2);function io(e){if(!e[Ho]){e[Ho]=!0,rm.forEach(function(n){n!=="selectionchange"&&(v2.has(n)||tu(n,!1,e),tu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ho]||(t[Ho]=!0,tu("selectionchange",!1,t))}}function Xm(e,t,n,r){switch(Mm(t)){case 1:var i=Fy;break;case 4:i=My;break;default:i=Jf}n=i.bind(null,t,n,e),i=void 0,!bu||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function nu(e,t,n,r,i){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Jr(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}ym(function(){var u=s,d=zf(n),h=[];e:{var p=Km.get(e);if(p!==void 0){var m=Yf,y=e;switch(e){case"keypress":if(fa(n)===0)break e;case"keydown":case"keyup":m=Ky;break;case"focusin":y="focus",m=Yl;break;case"focusout":y="blur",m=Yl;break;case"beforeblur":case"afterblur":m=Yl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=I0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=Uy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Qy;break;case Wm:case qm:case $m:m=by;break;case Jm:m=Zy;break;case"scroll":m=Dy;break;case"wheel":m=t2;break;case"copy":case"cut":case"paste":m=Gy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=R0}var x=(t&4)!==0,E=!x&&e==="scroll",T=x?p!==null?p+"Capture":null:p;x=[];for(var _=u,v;_!==null;){v=_;var C=v.stateNode;if(v.tag===5&&C!==null&&(v=C,T!==null&&(C=js(_,T),C!=null&&x.push(so(_,C,v)))),E)break;_=_.return}0<x.length&&(p=new m(p,y,null,n,d),h.push({event:p,listeners:x}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",p&&n!==Ou&&(y=n.relatedTarget||n.fromElement)&&(Jr(y)||y[ir]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(y=n.relatedTarget||n.toElement,m=u,y=y?Jr(y):null,y!==null&&(E=li(y),y!==E||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(x=I0,C="onMouseLeave",T="onMouseEnter",_="mouse",(e==="pointerout"||e==="pointerover")&&(x=R0,C="onPointerLeave",T="onPointerEnter",_="pointer"),E=m==null?p:Ci(m),v=y==null?p:Ci(y),p=new x(C,_+"leave",m,n,d),p.target=E,p.relatedTarget=v,C=null,Jr(d)===u&&(x=new x(T,_+"enter",y,n,d),x.target=v,x.relatedTarget=E,C=x),E=C,m&&y)t:{for(x=m,T=y,_=0,v=x;v;v=mi(v))_++;for(v=0,C=T;C;C=mi(C))v++;for(;0<_-v;)x=mi(x),_--;for(;0<v-_;)T=mi(T),v--;for(;_--;){if(x===T||T!==null&&x===T.alternate)break t;x=mi(x),T=mi(T)}x=null}else x=null;m!==null&&G0(h,p,m,x,!1),y!==null&&E!==null&&G0(h,E,y,x,!0)}}e:{if(p=u?Ci(u):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var D=l2;else if(M0(p))if(bm)D=d2;else{D=f2;var F=u2}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(D=c2);if(D&&(D=D(e,u))){Bm(h,D,n,d);break e}F&&F(e,p,u),e==="focusout"&&(F=p._wrapperState)&&F.controlled&&p.type==="number"&&Fu(p,"number",p.value)}switch(F=u?Ci(u):window,e){case"focusin":(M0(F)||F.contentEditable==="true")&&(Si=F,Wu=u,Ls=null);break;case"focusout":Ls=Wu=Si=null;break;case"mousedown":qu=!0;break;case"contextmenu":case"mouseup":case"dragend":qu=!1,B0(h,n,d);break;case"selectionchange":if(m2)break;case"keydown":case"keyup":B0(h,n,d)}var I;if(Qf)e:{switch(e){case"compositionstart":var L="onCompositionStart";break e;case"compositionend":L="onCompositionEnd";break e;case"compositionupdate":L="onCompositionUpdate";break e}L=void 0}else Ei?Um(e,n)&&(L="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(L="onCompositionStart");L&&(Lm&&n.locale!=="ko"&&(Ei||L!=="onCompositionStart"?L==="onCompositionEnd"&&Ei&&(I=Dm()):(Tr=d,Kf="value"in Tr?Tr.value:Tr.textContent,Ei=!0)),F=Ia(u,L),0<F.length&&(L=new k0(L,e,null,n,d),h.push({event:L,listeners:F}),I?L.data=I:(I=Om(n),I!==null&&(L.data=I)))),(I=r2?i2(e,n):s2(e,n))&&(u=Ia(u,"onBeforeInput"),0<u.length&&(d=new k0("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=I))}Ym(h,t)})}function so(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ia(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=js(e,n),s!=null&&r.unshift(so(e,s,i)),s=js(e,t),s!=null&&r.push(so(e,s,i))),e=e.return}return r}function mi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function G0(e,t,n,r,i){for(var s=t._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=js(n,s),l!=null&&o.unshift(so(n,l,a))):i||(l=js(n,s),l!=null&&o.push(so(n,l,a)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var y2=/\r\n?/g,_2=/\u0000|\uFFFD/g;function H0(e){return(typeof e=="string"?e:""+e).replace(y2,`
`).replace(_2,"")}function zo(e,t,n){if(t=H0(t),H0(e)!==t&&n)throw Error(ne(425))}function ka(){}var $u=null,Ju=null;function Ku(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Yu=typeof setTimeout=="function"?setTimeout:void 0,T2=typeof clearTimeout=="function"?clearTimeout:void 0,z0=typeof Promise=="function"?Promise:void 0,E2=typeof queueMicrotask=="function"?queueMicrotask:typeof z0<"u"?function(e){return z0.resolve(null).then(e).catch(S2)}:Yu;function S2(e){setTimeout(function(){throw e})}function ru(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),to(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);to(t)}function Ir(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function W0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var rs=Math.random().toString(36).slice(2),Gn="__reactFiber$"+rs,oo="__reactProps$"+rs,ir="__reactContainer$"+rs,Xu="__reactEvents$"+rs,w2="__reactListeners$"+rs,C2="__reactHandles$"+rs;function Jr(e){var t=e[Gn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ir]||n[Gn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=W0(e);e!==null;){if(n=e[Gn])return n;e=W0(e)}return t}e=n,n=e.parentNode}return null}function wo(e){return e=e[Gn]||e[ir],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ci(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ne(33))}function gl(e){return e[oo]||null}var Qu=[],Ai=-1;function br(e){return{current:e}}function Je(e){0>Ai||(e.current=Qu[Ai],Qu[Ai]=null,Ai--)}function We(e,t){Ai++,Qu[Ai]=e.current,e.current=t}var Dr={},Ot=br(Dr),Jt=br(!1),Zr=Dr;function Ki(e,t){var n=e.type.contextTypes;if(!n)return Dr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Kt(e){return e=e.childContextTypes,e!=null}function Ra(){Je(Jt),Je(Ot)}function q0(e,t,n){if(Ot.current!==Dr)throw Error(ne(168));We(Ot,t),We(Jt,n)}function Qm(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(ne(108,uy(e)||"Unknown",i));return et({},n,r)}function Pa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Dr,Zr=Ot.current,We(Ot,e),We(Jt,Jt.current),!0}function $0(e,t,n){var r=e.stateNode;if(!r)throw Error(ne(169));n?(e=Qm(e,t,Zr),r.__reactInternalMemoizedMergedChildContext=e,Je(Jt),Je(Ot),We(Ot,e)):Je(Jt),We(Jt,n)}var Xn=null,xl=!1,iu=!1;function jm(e){Xn===null?Xn=[e]:Xn.push(e)}function A2(e){xl=!0,jm(e)}function Vr(){if(!iu&&Xn!==null){iu=!0;var e=0,t=Ge;try{var n=Xn;for(Ge=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Xn=null,xl=!1}catch(i){throw Xn!==null&&(Xn=Xn.slice(e+1)),Sm(Wf,Vr),i}finally{Ge=t,iu=!1}}return null}var Ni=[],Ii=0,Fa=null,Ma=0,hn=[],pn=0,ei=null,Qn=1,jn="";function Wr(e,t){Ni[Ii++]=Ma,Ni[Ii++]=Fa,Fa=e,Ma=t}function Zm(e,t,n){hn[pn++]=Qn,hn[pn++]=jn,hn[pn++]=ei,ei=e;var r=Qn;e=jn;var i=32-Pn(r)-1;r&=~(1<<i),n+=1;var s=32-Pn(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Qn=1<<32-Pn(t)+i|n<<i|r,jn=s+e}else Qn=1<<s|n<<i|r,jn=e}function Zf(e){e.return!==null&&(Wr(e,1),Zm(e,1,0))}function ec(e){for(;e===Fa;)Fa=Ni[--Ii],Ni[Ii]=null,Ma=Ni[--Ii],Ni[Ii]=null;for(;e===ei;)ei=hn[--pn],hn[pn]=null,jn=hn[--pn],hn[pn]=null,Qn=hn[--pn],hn[pn]=null}var on=null,sn=null,Ye=!1,In=null;function eg(e,t){var n=mn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function J0(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,on=e,sn=Ir(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,on=e,sn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ei!==null?{id:Qn,overflow:jn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=mn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,on=e,sn=null,!0):!1;default:return!1}}function ju(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Zu(e){if(Ye){var t=sn;if(t){var n=t;if(!J0(e,t)){if(ju(e))throw Error(ne(418));t=Ir(n.nextSibling);var r=on;t&&J0(e,t)?eg(r,n):(e.flags=e.flags&-4097|2,Ye=!1,on=e)}}else{if(ju(e))throw Error(ne(418));e.flags=e.flags&-4097|2,Ye=!1,on=e}}}function K0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;on=e}function Wo(e){if(e!==on)return!1;if(!Ye)return K0(e),Ye=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ku(e.type,e.memoizedProps)),t&&(t=sn)){if(ju(e))throw tg(),Error(ne(418));for(;t;)eg(e,t),t=Ir(t.nextSibling)}if(K0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ne(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){sn=Ir(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}sn=null}}else sn=on?Ir(e.stateNode.nextSibling):null;return!0}function tg(){for(var e=sn;e;)e=Ir(e.nextSibling)}function Yi(){sn=on=null,Ye=!1}function tc(e){In===null?In=[e]:In.push(e)}var N2=fr.ReactCurrentBatchConfig;function _s(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ne(309));var r=n.stateNode}if(!r)throw Error(ne(147,e));var i=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(ne(284));if(!n._owner)throw Error(ne(290,e))}return e}function qo(e,t){throw e=Object.prototype.toString.call(t),Error(ne(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Y0(e){var t=e._init;return t(e._payload)}function ng(e){function t(T,_){if(e){var v=T.deletions;v===null?(T.deletions=[_],T.flags|=16):v.push(_)}}function n(T,_){if(!e)return null;for(;_!==null;)t(T,_),_=_.sibling;return null}function r(T,_){for(T=new Map;_!==null;)_.key!==null?T.set(_.key,_):T.set(_.index,_),_=_.sibling;return T}function i(T,_){return T=Fr(T,_),T.index=0,T.sibling=null,T}function s(T,_,v){return T.index=v,e?(v=T.alternate,v!==null?(v=v.index,v<_?(T.flags|=2,_):v):(T.flags|=2,_)):(T.flags|=1048576,_)}function o(T){return e&&T.alternate===null&&(T.flags|=2),T}function a(T,_,v,C){return _===null||_.tag!==6?(_=cu(v,T.mode,C),_.return=T,_):(_=i(_,v),_.return=T,_)}function l(T,_,v,C){var D=v.type;return D===Ti?d(T,_,v.props.children,C,v.key):_!==null&&(_.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===xr&&Y0(D)===_.type)?(C=i(_,v.props),C.ref=_s(T,_,v),C.return=T,C):(C=xa(v.type,v.key,v.props,null,T.mode,C),C.ref=_s(T,_,v),C.return=T,C)}function u(T,_,v,C){return _===null||_.tag!==4||_.stateNode.containerInfo!==v.containerInfo||_.stateNode.implementation!==v.implementation?(_=du(v,T.mode,C),_.return=T,_):(_=i(_,v.children||[]),_.return=T,_)}function d(T,_,v,C,D){return _===null||_.tag!==7?(_=Qr(v,T.mode,C,D),_.return=T,_):(_=i(_,v),_.return=T,_)}function h(T,_,v){if(typeof _=="string"&&_!==""||typeof _=="number")return _=cu(""+_,T.mode,v),_.return=T,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Do:return v=xa(_.type,_.key,_.props,null,T.mode,v),v.ref=_s(T,null,_),v.return=T,v;case _i:return _=du(_,T.mode,v),_.return=T,_;case xr:var C=_._init;return h(T,C(_._payload),v)}if(Ns(_)||ms(_))return _=Qr(_,T.mode,v,null),_.return=T,_;qo(T,_)}return null}function p(T,_,v,C){var D=_!==null?_.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return D!==null?null:a(T,_,""+v,C);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Do:return v.key===D?l(T,_,v,C):null;case _i:return v.key===D?u(T,_,v,C):null;case xr:return D=v._init,p(T,_,D(v._payload),C)}if(Ns(v)||ms(v))return D!==null?null:d(T,_,v,C,null);qo(T,v)}return null}function m(T,_,v,C,D){if(typeof C=="string"&&C!==""||typeof C=="number")return T=T.get(v)||null,a(_,T,""+C,D);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Do:return T=T.get(C.key===null?v:C.key)||null,l(_,T,C,D);case _i:return T=T.get(C.key===null?v:C.key)||null,u(_,T,C,D);case xr:var F=C._init;return m(T,_,v,F(C._payload),D)}if(Ns(C)||ms(C))return T=T.get(v)||null,d(_,T,C,D,null);qo(_,C)}return null}function y(T,_,v,C){for(var D=null,F=null,I=_,L=_=0,M=null;I!==null&&L<v.length;L++){I.index>L?(M=I,I=null):M=I.sibling;var B=p(T,I,v[L],C);if(B===null){I===null&&(I=M);break}e&&I&&B.alternate===null&&t(T,I),_=s(B,_,L),F===null?D=B:F.sibling=B,F=B,I=M}if(L===v.length)return n(T,I),Ye&&Wr(T,L),D;if(I===null){for(;L<v.length;L++)I=h(T,v[L],C),I!==null&&(_=s(I,_,L),F===null?D=I:F.sibling=I,F=I);return Ye&&Wr(T,L),D}for(I=r(T,I);L<v.length;L++)M=m(I,T,L,v[L],C),M!==null&&(e&&M.alternate!==null&&I.delete(M.key===null?L:M.key),_=s(M,_,L),F===null?D=M:F.sibling=M,F=M);return e&&I.forEach(function(J){return t(T,J)}),Ye&&Wr(T,L),D}function x(T,_,v,C){var D=ms(v);if(typeof D!="function")throw Error(ne(150));if(v=D.call(v),v==null)throw Error(ne(151));for(var F=D=null,I=_,L=_=0,M=null,B=v.next();I!==null&&!B.done;L++,B=v.next()){I.index>L?(M=I,I=null):M=I.sibling;var J=p(T,I,B.value,C);if(J===null){I===null&&(I=M);break}e&&I&&J.alternate===null&&t(T,I),_=s(J,_,L),F===null?D=J:F.sibling=J,F=J,I=M}if(B.done)return n(T,I),Ye&&Wr(T,L),D;if(I===null){for(;!B.done;L++,B=v.next())B=h(T,B.value,C),B!==null&&(_=s(B,_,L),F===null?D=B:F.sibling=B,F=B);return Ye&&Wr(T,L),D}for(I=r(T,I);!B.done;L++,B=v.next())B=m(I,T,L,B.value,C),B!==null&&(e&&B.alternate!==null&&I.delete(B.key===null?L:B.key),_=s(B,_,L),F===null?D=B:F.sibling=B,F=B);return e&&I.forEach(function(H){return t(T,H)}),Ye&&Wr(T,L),D}function E(T,_,v,C){if(typeof v=="object"&&v!==null&&v.type===Ti&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Do:e:{for(var D=v.key,F=_;F!==null;){if(F.key===D){if(D=v.type,D===Ti){if(F.tag===7){n(T,F.sibling),_=i(F,v.props.children),_.return=T,T=_;break e}}else if(F.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===xr&&Y0(D)===F.type){n(T,F.sibling),_=i(F,v.props),_.ref=_s(T,F,v),_.return=T,T=_;break e}n(T,F);break}else t(T,F);F=F.sibling}v.type===Ti?(_=Qr(v.props.children,T.mode,C,v.key),_.return=T,T=_):(C=xa(v.type,v.key,v.props,null,T.mode,C),C.ref=_s(T,_,v),C.return=T,T=C)}return o(T);case _i:e:{for(F=v.key;_!==null;){if(_.key===F)if(_.tag===4&&_.stateNode.containerInfo===v.containerInfo&&_.stateNode.implementation===v.implementation){n(T,_.sibling),_=i(_,v.children||[]),_.return=T,T=_;break e}else{n(T,_);break}else t(T,_);_=_.sibling}_=du(v,T.mode,C),_.return=T,T=_}return o(T);case xr:return F=v._init,E(T,_,F(v._payload),C)}if(Ns(v))return y(T,_,v,C);if(ms(v))return x(T,_,v,C);qo(T,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,_!==null&&_.tag===6?(n(T,_.sibling),_=i(_,v),_.return=T,T=_):(n(T,_),_=cu(v,T.mode,C),_.return=T,T=_),o(T)):n(T,_)}return E}var Xi=ng(!0),rg=ng(!1),Da=br(null),La=null,ki=null,nc=null;function rc(){nc=ki=La=null}function ic(e){var t=Da.current;Je(Da),e._currentValue=t}function ef(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Bi(e,t){La=e,nc=ki=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&($t=!0),e.firstContext=null)}function vn(e){var t=e._currentValue;if(nc!==e)if(e={context:e,memoizedValue:t,next:null},ki===null){if(La===null)throw Error(ne(308));ki=e,La.dependencies={lanes:0,firstContext:e}}else ki=ki.next=e;return t}var Kr=null;function sc(e){Kr===null?Kr=[e]:Kr.push(e)}function ig(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,sc(t)):(n.next=i.next,i.next=n),t.interleaved=n,sr(e,r)}function sr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var vr=!1;function oc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sg(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Zn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function kr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Fe&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,sr(e,n)}return i=r.interleaved,i===null?(t.next=t,sc(r)):(t.next=i.next,i.next=t),r.interleaved=t,sr(e,n)}function ca(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,qf(e,n)}}function X0(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=t:s=s.next=t}else i=s=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ua(e,t,n,r){var i=e.updateQueue;vr=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var d=e.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,d=u=l=null,a=s;do{var p=a.lane,m=a.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=e,x=a;switch(p=t,m=n,x.tag){case 1:if(y=x.payload,typeof y=="function"){h=y.call(m,h,p);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,p=typeof y=="function"?y.call(m,h,p):y,p==null)break e;h=et({},h,p);break e;case 2:vr=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[a]:p.push(a))}else m={eventTime:m,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=m,l=h):d=d.next=m,o|=p;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;p=a,a=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);ni|=o,e.lanes=o,e.memoizedState=h}}function Q0(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ne(191,i));i.call(r)}}}var Co={},Wn=br(Co),ao=br(Co),lo=br(Co);function Yr(e){if(e===Co)throw Error(ne(174));return e}function ac(e,t){switch(We(lo,t),We(ao,e),We(Wn,Co),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Du(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Du(t,e)}Je(Wn),We(Wn,t)}function Qi(){Je(Wn),Je(ao),Je(lo)}function og(e){Yr(lo.current);var t=Yr(Wn.current),n=Du(t,e.type);t!==n&&(We(ao,e),We(Wn,n))}function lc(e){ao.current===e&&(Je(Wn),Je(ao))}var je=br(0);function Oa(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var su=[];function uc(){for(var e=0;e<su.length;e++)su[e]._workInProgressVersionPrimary=null;su.length=0}var da=fr.ReactCurrentDispatcher,ou=fr.ReactCurrentBatchConfig,ti=0,Ze=null,dt=null,gt=null,Ba=!1,Us=!1,uo=0,I2=0;function Pt(){throw Error(ne(321))}function fc(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Dn(e[n],t[n]))return!1;return!0}function cc(e,t,n,r,i,s){if(ti=s,Ze=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,da.current=e===null||e.memoizedState===null?F2:M2,e=n(r,i),Us){s=0;do{if(Us=!1,uo=0,25<=s)throw Error(ne(301));s+=1,gt=dt=null,t.updateQueue=null,da.current=D2,e=n(r,i)}while(Us)}if(da.current=ba,t=dt!==null&&dt.next!==null,ti=0,gt=dt=Ze=null,Ba=!1,t)throw Error(ne(300));return e}function dc(){var e=uo!==0;return uo=0,e}function Vn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gt===null?Ze.memoizedState=gt=e:gt=gt.next=e,gt}function yn(){if(dt===null){var e=Ze.alternate;e=e!==null?e.memoizedState:null}else e=dt.next;var t=gt===null?Ze.memoizedState:gt.next;if(t!==null)gt=t,dt=e;else{if(e===null)throw Error(ne(310));dt=e,e={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},gt===null?Ze.memoizedState=gt=e:gt=gt.next=e}return gt}function fo(e,t){return typeof t=="function"?t(e):t}function au(e){var t=yn(),n=t.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=e;var r=dt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var d=u.lane;if((ti&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,Ze.lanes|=d,ni|=d}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Dn(r,t.memoizedState)||($t=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do s=i.lane,Ze.lanes|=s,ni|=s,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function lu(e){var t=yn(),n=t.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);Dn(s,t.memoizedState)||($t=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function ag(){}function lg(e,t){var n=Ze,r=yn(),i=t(),s=!Dn(r.memoizedState,i);if(s&&(r.memoizedState=i,$t=!0),r=r.queue,hc(cg.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||gt!==null&&gt.memoizedState.tag&1){if(n.flags|=2048,co(9,fg.bind(null,n,r,i,t),void 0,null),_t===null)throw Error(ne(349));ti&30||ug(n,t,i)}return i}function ug(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function fg(e,t,n,r){t.value=n,t.getSnapshot=r,dg(t)&&hg(e)}function cg(e,t,n){return n(function(){dg(t)&&hg(e)})}function dg(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Dn(e,n)}catch{return!0}}function hg(e){var t=sr(e,1);t!==null&&Fn(t,e,1,-1)}function j0(e){var t=Vn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fo,lastRenderedState:e},t.queue=e,e=e.dispatch=P2.bind(null,Ze,e),[t.memoizedState,e]}function co(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function pg(){return yn().memoizedState}function ha(e,t,n,r){var i=Vn();Ze.flags|=e,i.memoizedState=co(1|t,n,void 0,r===void 0?null:r)}function vl(e,t,n,r){var i=yn();r=r===void 0?null:r;var s=void 0;if(dt!==null){var o=dt.memoizedState;if(s=o.destroy,r!==null&&fc(r,o.deps)){i.memoizedState=co(t,n,s,r);return}}Ze.flags|=e,i.memoizedState=co(1|t,n,s,r)}function Z0(e,t){return ha(8390656,8,e,t)}function hc(e,t){return vl(2048,8,e,t)}function mg(e,t){return vl(4,2,e,t)}function gg(e,t){return vl(4,4,e,t)}function xg(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function vg(e,t,n){return n=n!=null?n.concat([e]):null,vl(4,4,xg.bind(null,t,e),n)}function pc(){}function yg(e,t){var n=yn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&fc(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function _g(e,t){var n=yn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&fc(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Tg(e,t,n){return ti&21?(Dn(n,t)||(n=Am(),Ze.lanes|=n,ni|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,$t=!0),e.memoizedState=n)}function k2(e,t){var n=Ge;Ge=n!==0&&4>n?n:4,e(!0);var r=ou.transition;ou.transition={};try{e(!1),t()}finally{Ge=n,ou.transition=r}}function Eg(){return yn().memoizedState}function R2(e,t,n){var r=Pr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Sg(e))wg(t,n);else if(n=ig(e,t,n,r),n!==null){var i=Gt();Fn(n,e,r,i),Cg(n,t,r)}}function P2(e,t,n){var r=Pr(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Sg(e))wg(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Dn(a,o)){var l=t.interleaved;l===null?(i.next=i,sc(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}n=ig(e,t,i,r),n!==null&&(i=Gt(),Fn(n,e,r,i),Cg(n,t,r))}}function Sg(e){var t=e.alternate;return e===Ze||t!==null&&t===Ze}function wg(e,t){Us=Ba=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Cg(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,qf(e,n)}}var ba={readContext:vn,useCallback:Pt,useContext:Pt,useEffect:Pt,useImperativeHandle:Pt,useInsertionEffect:Pt,useLayoutEffect:Pt,useMemo:Pt,useReducer:Pt,useRef:Pt,useState:Pt,useDebugValue:Pt,useDeferredValue:Pt,useTransition:Pt,useMutableSource:Pt,useSyncExternalStore:Pt,useId:Pt,unstable_isNewReconciler:!1},F2={readContext:vn,useCallback:function(e,t){return Vn().memoizedState=[e,t===void 0?null:t],e},useContext:vn,useEffect:Z0,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ha(4194308,4,xg.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ha(4194308,4,e,t)},useInsertionEffect:function(e,t){return ha(4,2,e,t)},useMemo:function(e,t){var n=Vn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Vn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=R2.bind(null,Ze,e),[r.memoizedState,e]},useRef:function(e){var t=Vn();return e={current:e},t.memoizedState=e},useState:j0,useDebugValue:pc,useDeferredValue:function(e){return Vn().memoizedState=e},useTransition:function(){var e=j0(!1),t=e[0];return e=k2.bind(null,e[1]),Vn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ze,i=Vn();if(Ye){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=t(),_t===null)throw Error(ne(349));ti&30||ug(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,Z0(cg.bind(null,r,s,e),[e]),r.flags|=2048,co(9,fg.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=Vn(),t=_t.identifierPrefix;if(Ye){var n=jn,r=Qn;n=(r&~(1<<32-Pn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=uo++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=I2++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},M2={readContext:vn,useCallback:yg,useContext:vn,useEffect:hc,useImperativeHandle:vg,useInsertionEffect:mg,useLayoutEffect:gg,useMemo:_g,useReducer:au,useRef:pg,useState:function(){return au(fo)},useDebugValue:pc,useDeferredValue:function(e){var t=yn();return Tg(t,dt.memoizedState,e)},useTransition:function(){var e=au(fo)[0],t=yn().memoizedState;return[e,t]},useMutableSource:ag,useSyncExternalStore:lg,useId:Eg,unstable_isNewReconciler:!1},D2={readContext:vn,useCallback:yg,useContext:vn,useEffect:hc,useImperativeHandle:vg,useInsertionEffect:mg,useLayoutEffect:gg,useMemo:_g,useReducer:lu,useRef:pg,useState:function(){return lu(fo)},useDebugValue:pc,useDeferredValue:function(e){var t=yn();return dt===null?t.memoizedState=e:Tg(t,dt.memoizedState,e)},useTransition:function(){var e=lu(fo)[0],t=yn().memoizedState;return[e,t]},useMutableSource:ag,useSyncExternalStore:lg,useId:Eg,unstable_isNewReconciler:!1};function An(e,t){if(e&&e.defaultProps){t=et({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function tf(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:et({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var yl={isMounted:function(e){return(e=e._reactInternals)?li(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Gt(),i=Pr(e),s=Zn(r,i);s.payload=t,n!=null&&(s.callback=n),t=kr(e,s,i),t!==null&&(Fn(t,e,i,r),ca(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Gt(),i=Pr(e),s=Zn(r,i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=kr(e,s,i),t!==null&&(Fn(t,e,i,r),ca(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Gt(),r=Pr(e),i=Zn(n,r);i.tag=2,t!=null&&(i.callback=t),t=kr(e,i,r),t!==null&&(Fn(t,e,r,n),ca(t,e,r))}};function ed(e,t,n,r,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,o):t.prototype&&t.prototype.isPureReactComponent?!ro(n,r)||!ro(i,s):!0}function Ag(e,t,n){var r=!1,i=Dr,s=t.contextType;return typeof s=="object"&&s!==null?s=vn(s):(i=Kt(t)?Zr:Ot.current,r=t.contextTypes,s=(r=r!=null)?Ki(e,i):Dr),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=yl,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function td(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&yl.enqueueReplaceState(t,t.state,null)}function nf(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},oc(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=vn(s):(s=Kt(t)?Zr:Ot.current,i.context=Ki(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(tf(e,t,s,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&yl.enqueueReplaceState(i,i.state,null),Ua(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function ji(e,t){try{var n="",r=t;do n+=ly(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function uu(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function rf(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var L2=typeof WeakMap=="function"?WeakMap:Map;function Ng(e,t,n){n=Zn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ga||(Ga=!0,pf=r),rf(e,t)},n}function Ig(e,t,n){n=Zn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){rf(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){rf(e,t),typeof r!="function"&&(Rr===null?Rr=new Set([this]):Rr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function nd(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new L2;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Y2.bind(null,e,t,n),t.then(e,e))}function rd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function id(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Zn(-1,1),t.tag=2,kr(n,t,1))),n.lanes|=1),e)}var U2=fr.ReactCurrentOwner,$t=!1;function Bt(e,t,n,r){t.child=e===null?rg(t,null,n,r):Xi(t,e.child,n,r)}function sd(e,t,n,r,i){n=n.render;var s=t.ref;return Bi(t,i),r=cc(e,t,n,r,s,i),n=dc(),e!==null&&!$t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,or(e,t,i)):(Ye&&n&&Zf(t),t.flags|=1,Bt(e,t,r,i),t.child)}function od(e,t,n,r,i){if(e===null){var s=n.type;return typeof s=="function"&&!Ec(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,kg(e,t,s,r,i)):(e=xa(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:ro,n(o,r)&&e.ref===t.ref)return or(e,t,i)}return t.flags|=1,e=Fr(s,r),e.ref=t.ref,e.return=t,t.child=e}function kg(e,t,n,r,i){if(e!==null){var s=e.memoizedProps;if(ro(s,r)&&e.ref===t.ref)if($t=!1,t.pendingProps=r=s,(e.lanes&i)!==0)e.flags&131072&&($t=!0);else return t.lanes=e.lanes,or(e,t,i)}return sf(e,t,n,r,i)}function Rg(e,t,n){var r=t.pendingProps,i=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},We(Pi,en),en|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,We(Pi,en),en|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,We(Pi,en),en|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,We(Pi,en),en|=r;return Bt(e,t,i,n),t.child}function Pg(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function sf(e,t,n,r,i){var s=Kt(n)?Zr:Ot.current;return s=Ki(t,s),Bi(t,i),n=cc(e,t,n,r,s,i),r=dc(),e!==null&&!$t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,or(e,t,i)):(Ye&&r&&Zf(t),t.flags|=1,Bt(e,t,n,i),t.child)}function ad(e,t,n,r,i){if(Kt(n)){var s=!0;Pa(t)}else s=!1;if(Bi(t,i),t.stateNode===null)pa(e,t),Ag(t,n,r),nf(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=vn(u):(u=Kt(n)?Zr:Ot.current,u=Ki(t,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&td(t,o,r,u),vr=!1;var p=t.memoizedState;o.state=p,Ua(t,r,o,i),l=t.memoizedState,a!==r||p!==l||Jt.current||vr?(typeof d=="function"&&(tf(t,n,d,r),l=t.memoizedState),(a=vr||ed(t,n,a,r,p,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,sg(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:An(t.type,a),o.props=u,h=t.pendingProps,p=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=vn(l):(l=Kt(n)?Zr:Ot.current,l=Ki(t,l));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||p!==l)&&td(t,o,r,l),vr=!1,p=t.memoizedState,o.state=p,Ua(t,r,o,i);var y=t.memoizedState;a!==h||p!==y||Jt.current||vr?(typeof m=="function"&&(tf(t,n,m,r),y=t.memoizedState),(u=vr||ed(t,n,u,r,p,y,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=y),o.props=r,o.state=y,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return of(e,t,n,r,s,i)}function of(e,t,n,r,i,s){Pg(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&$0(t,n,!1),or(e,t,s);r=t.stateNode,U2.current=t;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Xi(t,e.child,null,s),t.child=Xi(t,null,a,s)):Bt(e,t,a,s),t.memoizedState=r.state,i&&$0(t,n,!0),t.child}function Fg(e){var t=e.stateNode;t.pendingContext?q0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&q0(e,t.context,!1),ac(e,t.containerInfo)}function ld(e,t,n,r,i){return Yi(),tc(i),t.flags|=256,Bt(e,t,n,r),t.child}var af={dehydrated:null,treeContext:null,retryLane:0};function lf(e){return{baseLanes:e,cachePool:null,transitions:null}}function Mg(e,t,n){var r=t.pendingProps,i=je.current,s=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),We(je,i&1),e===null)return Zu(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,s?(r=t.mode,s=t.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=El(o,r,0,null),e=Qr(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=lf(n),t.memoizedState=af,e):mc(t,o));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return O2(e,t,o,r,a,i,n);if(s){s=r.fallback,o=t.mode,i=e.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=Fr(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Fr(a,s):(s=Qr(s,o,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,o=e.child.memoizedState,o=o===null?lf(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~n,t.memoizedState=af,r}return s=e.child,e=s.sibling,r=Fr(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function mc(e,t){return t=El({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function $o(e,t,n,r){return r!==null&&tc(r),Xi(t,e.child,null,n),e=mc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function O2(e,t,n,r,i,s,o){if(n)return t.flags&256?(t.flags&=-257,r=uu(Error(ne(422))),$o(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=El({mode:"visible",children:r.children},i,0,null),s=Qr(s,i,o,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&Xi(t,e.child,null,o),t.child.memoizedState=lf(o),t.memoizedState=af,s);if(!(t.mode&1))return $o(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(ne(419)),r=uu(s,r,void 0),$o(e,t,o,r)}if(a=(o&e.childLanes)!==0,$t||a){if(r=_t,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,sr(e,i),Fn(r,e,i,-1))}return Tc(),r=uu(Error(ne(421))),$o(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=X2.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,sn=Ir(i.nextSibling),on=t,Ye=!0,In=null,e!==null&&(hn[pn++]=Qn,hn[pn++]=jn,hn[pn++]=ei,Qn=e.id,jn=e.overflow,ei=t),t=mc(t,r.children),t.flags|=4096,t)}function ud(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ef(e.return,t,n)}function fu(e,t,n,r,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Dg(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(Bt(e,t,r.children,n),r=je.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ud(e,n,t);else if(e.tag===19)ud(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(We(je,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Oa(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),fu(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Oa(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}fu(t,!0,n,null,s);break;case"together":fu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function pa(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function or(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ni|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ne(153));if(t.child!==null){for(e=t.child,n=Fr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Fr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function B2(e,t,n){switch(t.tag){case 3:Fg(t),Yi();break;case 5:og(t);break;case 1:Kt(t.type)&&Pa(t);break;case 4:ac(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;We(Da,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(We(je,je.current&1),t.flags|=128,null):n&t.child.childLanes?Mg(e,t,n):(We(je,je.current&1),e=or(e,t,n),e!==null?e.sibling:null);We(je,je.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Dg(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),We(je,je.current),r)break;return null;case 22:case 23:return t.lanes=0,Rg(e,t,n)}return or(e,t,n)}var Lg,uf,Ug,Og;Lg=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};uf=function(){};Ug=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Yr(Wn.current);var s=null;switch(n){case"input":i=Ru(e,i),r=Ru(e,r),s=[];break;case"select":i=et({},i,{value:void 0}),r=et({},r,{value:void 0}),s=[];break;case"textarea":i=Mu(e,i),r=Mu(e,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ka)}Lu(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Xs.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Xs.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&qe("scroll",e),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};Og=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ts(e,t){if(!Ye)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ft(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function b2(e,t,n){var r=t.pendingProps;switch(ec(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(t),null;case 1:return Kt(t.type)&&Ra(),Ft(t),null;case 3:return r=t.stateNode,Qi(),Je(Jt),Je(Ot),uc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Wo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,In!==null&&(xf(In),In=null))),uf(e,t),Ft(t),null;case 5:lc(t);var i=Yr(lo.current);if(n=t.type,e!==null&&t.stateNode!=null)Ug(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ne(166));return Ft(t),null}if(e=Yr(Wn.current),Wo(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[Gn]=t,r[oo]=s,e=(t.mode&1)!==0,n){case"dialog":qe("cancel",r),qe("close",r);break;case"iframe":case"object":case"embed":qe("load",r);break;case"video":case"audio":for(i=0;i<ks.length;i++)qe(ks[i],r);break;case"source":qe("error",r);break;case"img":case"image":case"link":qe("error",r),qe("load",r);break;case"details":qe("toggle",r);break;case"input":v0(r,s),qe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},qe("invalid",r);break;case"textarea":_0(r,s),qe("invalid",r)}Lu(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&zo(r.textContent,a,e),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&zo(r.textContent,a,e),i=["children",""+a]):Xs.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&qe("scroll",r)}switch(n){case"input":Lo(r),y0(r,s,!0);break;case"textarea":Lo(r),T0(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=ka)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=cm(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Gn]=t,e[oo]=r,Lg(e,t,!1,!1),t.stateNode=e;e:{switch(o=Uu(n,r),n){case"dialog":qe("cancel",e),qe("close",e),i=r;break;case"iframe":case"object":case"embed":qe("load",e),i=r;break;case"video":case"audio":for(i=0;i<ks.length;i++)qe(ks[i],e);i=r;break;case"source":qe("error",e),i=r;break;case"img":case"image":case"link":qe("error",e),qe("load",e),i=r;break;case"details":qe("toggle",e),i=r;break;case"input":v0(e,r),i=Ru(e,r),qe("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=et({},r,{value:void 0}),qe("invalid",e);break;case"textarea":_0(e,r),i=Mu(e,r),qe("invalid",e);break;default:i=r}Lu(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?pm(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&dm(e,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Qs(e,l):typeof l=="number"&&Qs(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Xs.hasOwnProperty(s)?l!=null&&s==="onScroll"&&qe("scroll",e):l!=null&&bf(e,s,l,o))}switch(n){case"input":Lo(e),y0(e,r,!1);break;case"textarea":Lo(e),T0(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Mr(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?Di(e,!!r.multiple,s,!1):r.defaultValue!=null&&Di(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=ka)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ft(t),null;case 6:if(e&&t.stateNode!=null)Og(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ne(166));if(n=Yr(lo.current),Yr(Wn.current),Wo(t)){if(r=t.stateNode,n=t.memoizedProps,r[Gn]=t,(s=r.nodeValue!==n)&&(e=on,e!==null))switch(e.tag){case 3:zo(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&zo(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Gn]=t,t.stateNode=r}return Ft(t),null;case 13:if(Je(je),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ye&&sn!==null&&t.mode&1&&!(t.flags&128))tg(),Yi(),t.flags|=98560,s=!1;else if(s=Wo(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(ne(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ne(317));s[Gn]=t}else Yi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ft(t),s=!1}else In!==null&&(xf(In),In=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||je.current&1?ht===0&&(ht=3):Tc())),t.updateQueue!==null&&(t.flags|=4),Ft(t),null);case 4:return Qi(),uf(e,t),e===null&&io(t.stateNode.containerInfo),Ft(t),null;case 10:return ic(t.type._context),Ft(t),null;case 17:return Kt(t.type)&&Ra(),Ft(t),null;case 19:if(Je(je),s=t.memoizedState,s===null)return Ft(t),null;if(r=(t.flags&128)!==0,o=s.rendering,o===null)if(r)Ts(s,!1);else{if(ht!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Oa(e),o!==null){for(t.flags|=128,Ts(s,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return We(je,je.current&1|2),t.child}e=e.sibling}s.tail!==null&&st()>Zi&&(t.flags|=128,r=!0,Ts(s,!1),t.lanes=4194304)}else{if(!r)if(e=Oa(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ts(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ye)return Ft(t),null}else 2*st()-s.renderingStartTime>Zi&&n!==1073741824&&(t.flags|=128,r=!0,Ts(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(n=s.last,n!==null?n.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=st(),t.sibling=null,n=je.current,We(je,r?n&1|2:n&1),t):(Ft(t),null);case 22:case 23:return _c(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?en&1073741824&&(Ft(t),t.subtreeFlags&6&&(t.flags|=8192)):Ft(t),null;case 24:return null;case 25:return null}throw Error(ne(156,t.tag))}function V2(e,t){switch(ec(t),t.tag){case 1:return Kt(t.type)&&Ra(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Qi(),Je(Jt),Je(Ot),uc(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return lc(t),null;case 13:if(Je(je),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ne(340));Yi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Je(je),null;case 4:return Qi(),null;case 10:return ic(t.type._context),null;case 22:case 23:return _c(),null;case 24:return null;default:return null}}var Jo=!1,Mt=!1,G2=typeof WeakSet=="function"?WeakSet:Set,pe=null;function Ri(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){tt(e,t,r)}else n.current=null}function ff(e,t,n){try{n()}catch(r){tt(e,t,r)}}var fd=!1;function H2(e,t){if($u=Aa,e=Hm(),jf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var m;h!==n||i!==0&&h.nodeType!==3||(a=o+i),h!==s||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++u===i&&(a=o),p===s&&++d===r&&(l=o),(m=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=m}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ju={focusedElem:e,selectionRange:n},Aa=!1,pe=t;pe!==null;)if(t=pe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,pe=e;else for(;pe!==null;){t=pe;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,E=y.memoizedState,T=t.stateNode,_=T.getSnapshotBeforeUpdate(t.elementType===t.type?x:An(t.type,x),E);T.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(C){tt(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,pe=e;break}pe=t.return}return y=fd,fd=!1,y}function Os(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&ff(t,n,s)}i=i.next}while(i!==r)}}function _l(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function cf(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Bg(e){var t=e.alternate;t!==null&&(e.alternate=null,Bg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gn],delete t[oo],delete t[Xu],delete t[w2],delete t[C2])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function bg(e){return e.tag===5||e.tag===3||e.tag===4}function cd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||bg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function df(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ka));else if(r!==4&&(e=e.child,e!==null))for(df(e,t,n),e=e.sibling;e!==null;)df(e,t,n),e=e.sibling}function hf(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(hf(e,t,n),e=e.sibling;e!==null;)hf(e,t,n),e=e.sibling}var Et=null,Nn=!1;function mr(e,t,n){for(n=n.child;n!==null;)Vg(e,t,n),n=n.sibling}function Vg(e,t,n){if(zn&&typeof zn.onCommitFiberUnmount=="function")try{zn.onCommitFiberUnmount(dl,n)}catch{}switch(n.tag){case 5:Mt||Ri(n,t);case 6:var r=Et,i=Nn;Et=null,mr(e,t,n),Et=r,Nn=i,Et!==null&&(Nn?(e=Et,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Et.removeChild(n.stateNode));break;case 18:Et!==null&&(Nn?(e=Et,n=n.stateNode,e.nodeType===8?ru(e.parentNode,n):e.nodeType===1&&ru(e,n),to(e)):ru(Et,n.stateNode));break;case 4:r=Et,i=Nn,Et=n.stateNode.containerInfo,Nn=!0,mr(e,t,n),Et=r,Nn=i;break;case 0:case 11:case 14:case 15:if(!Mt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&ff(n,t,o),i=i.next}while(i!==r)}mr(e,t,n);break;case 1:if(!Mt&&(Ri(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){tt(n,t,a)}mr(e,t,n);break;case 21:mr(e,t,n);break;case 22:n.mode&1?(Mt=(r=Mt)||n.memoizedState!==null,mr(e,t,n),Mt=r):mr(e,t,n);break;default:mr(e,t,n)}}function dd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new G2),t.forEach(function(r){var i=Q2.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Sn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:Et=a.stateNode,Nn=!1;break e;case 3:Et=a.stateNode.containerInfo,Nn=!0;break e;case 4:Et=a.stateNode.containerInfo,Nn=!0;break e}a=a.return}if(Et===null)throw Error(ne(160));Vg(s,o,i),Et=null,Nn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){tt(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Gg(t,e),t=t.sibling}function Gg(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Sn(t,e),On(e),r&4){try{Os(3,e,e.return),_l(3,e)}catch(x){tt(e,e.return,x)}try{Os(5,e,e.return)}catch(x){tt(e,e.return,x)}}break;case 1:Sn(t,e),On(e),r&512&&n!==null&&Ri(n,n.return);break;case 5:if(Sn(t,e),On(e),r&512&&n!==null&&Ri(n,n.return),e.flags&32){var i=e.stateNode;try{Qs(i,"")}catch(x){tt(e,e.return,x)}}if(r&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=n!==null?n.memoizedProps:s,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&um(i,s),Uu(a,o);var u=Uu(a,s);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];d==="style"?pm(i,h):d==="dangerouslySetInnerHTML"?dm(i,h):d==="children"?Qs(i,h):bf(i,d,h,u)}switch(a){case"input":Pu(i,s);break;case"textarea":fm(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Di(i,!!s.multiple,m,!1):p!==!!s.multiple&&(s.defaultValue!=null?Di(i,!!s.multiple,s.defaultValue,!0):Di(i,!!s.multiple,s.multiple?[]:"",!1))}i[oo]=s}catch(x){tt(e,e.return,x)}}break;case 6:if(Sn(t,e),On(e),r&4){if(e.stateNode===null)throw Error(ne(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(x){tt(e,e.return,x)}}break;case 3:if(Sn(t,e),On(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{to(t.containerInfo)}catch(x){tt(e,e.return,x)}break;case 4:Sn(t,e),On(e);break;case 13:Sn(t,e),On(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(vc=st())),r&4&&dd(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(Mt=(u=Mt)||d,Sn(t,e),Mt=u):Sn(t,e),On(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(pe=e,d=e.child;d!==null;){for(h=pe=d;pe!==null;){switch(p=pe,m=p.child,p.tag){case 0:case 11:case 14:case 15:Os(4,p,p.return);break;case 1:Ri(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(x){tt(r,n,x)}}break;case 5:Ri(p,p.return);break;case 22:if(p.memoizedState!==null){pd(h);continue}}m!==null?(m.return=p,pe=m):pd(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=hm("display",o))}catch(x){tt(e,e.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){tt(e,e.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Sn(t,e),On(e),r&4&&dd(e);break;case 21:break;default:Sn(t,e),On(e)}}function On(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(bg(n)){var r=n;break e}n=n.return}throw Error(ne(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Qs(i,""),r.flags&=-33);var s=cd(e);hf(e,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=cd(e);df(e,a,o);break;default:throw Error(ne(161))}}catch(l){tt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function z2(e,t,n){pe=e,Hg(e)}function Hg(e,t,n){for(var r=(e.mode&1)!==0;pe!==null;){var i=pe,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Jo;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Mt;a=Jo;var u=Mt;if(Jo=o,(Mt=l)&&!u)for(pe=i;pe!==null;)o=pe,l=o.child,o.tag===22&&o.memoizedState!==null?md(i):l!==null?(l.return=o,pe=l):md(i);for(;s!==null;)pe=s,Hg(s),s=s.sibling;pe=i,Jo=a,Mt=u}hd(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,pe=s):hd(e)}}function hd(e){for(;pe!==null;){var t=pe;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Mt||_l(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Mt)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:An(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Q0(t,s,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Q0(t,o,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&to(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}Mt||t.flags&512&&cf(t)}catch(p){tt(t,t.return,p)}}if(t===e){pe=null;break}if(n=t.sibling,n!==null){n.return=t.return,pe=n;break}pe=t.return}}function pd(e){for(;pe!==null;){var t=pe;if(t===e){pe=null;break}var n=t.sibling;if(n!==null){n.return=t.return,pe=n;break}pe=t.return}}function md(e){for(;pe!==null;){var t=pe;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{_l(4,t)}catch(l){tt(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(l){tt(t,i,l)}}var s=t.return;try{cf(t)}catch(l){tt(t,s,l)}break;case 5:var o=t.return;try{cf(t)}catch(l){tt(t,o,l)}}}catch(l){tt(t,t.return,l)}if(t===e){pe=null;break}var a=t.sibling;if(a!==null){a.return=t.return,pe=a;break}pe=t.return}}var W2=Math.ceil,Va=fr.ReactCurrentDispatcher,gc=fr.ReactCurrentOwner,gn=fr.ReactCurrentBatchConfig,Fe=0,_t=null,lt=null,At=0,en=0,Pi=br(0),ht=0,ho=null,ni=0,Tl=0,xc=0,Bs=null,qt=null,vc=0,Zi=1/0,Yn=null,Ga=!1,pf=null,Rr=null,Ko=!1,Er=null,Ha=0,bs=0,mf=null,ma=-1,ga=0;function Gt(){return Fe&6?st():ma!==-1?ma:ma=st()}function Pr(e){return e.mode&1?Fe&2&&At!==0?At&-At:N2.transition!==null?(ga===0&&(ga=Am()),ga):(e=Ge,e!==0||(e=window.event,e=e===void 0?16:Mm(e.type)),e):1}function Fn(e,t,n,r){if(50<bs)throw bs=0,mf=null,Error(ne(185));Eo(e,n,r),(!(Fe&2)||e!==_t)&&(e===_t&&(!(Fe&2)&&(Tl|=n),ht===4&&_r(e,At)),Yt(e,r),n===1&&Fe===0&&!(t.mode&1)&&(Zi=st()+500,xl&&Vr()))}function Yt(e,t){var n=e.callbackNode;Ny(e,t);var r=Ca(e,e===_t?At:0);if(r===0)n!==null&&w0(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&w0(n),t===1)e.tag===0?A2(gd.bind(null,e)):jm(gd.bind(null,e)),E2(function(){!(Fe&6)&&Vr()}),n=null;else{switch(Nm(r)){case 1:n=Wf;break;case 4:n=wm;break;case 16:n=wa;break;case 536870912:n=Cm;break;default:n=wa}n=Xg(n,zg.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function zg(e,t){if(ma=-1,ga=0,Fe&6)throw Error(ne(327));var n=e.callbackNode;if(bi()&&e.callbackNode!==n)return null;var r=Ca(e,e===_t?At:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=za(e,r);else{t=r;var i=Fe;Fe|=2;var s=qg();(_t!==e||At!==t)&&(Yn=null,Zi=st()+500,Xr(e,t));do try{J2();break}catch(a){Wg(e,a)}while(!0);rc(),Va.current=s,Fe=i,lt!==null?t=0:(_t=null,At=0,t=ht)}if(t!==0){if(t===2&&(i=Gu(e),i!==0&&(r=i,t=gf(e,i))),t===1)throw n=ho,Xr(e,0),_r(e,r),Yt(e,st()),n;if(t===6)_r(e,r);else{if(i=e.current.alternate,!(r&30)&&!q2(i)&&(t=za(e,r),t===2&&(s=Gu(e),s!==0&&(r=s,t=gf(e,s))),t===1))throw n=ho,Xr(e,0),_r(e,r),Yt(e,st()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(ne(345));case 2:qr(e,qt,Yn);break;case 3:if(_r(e,r),(r&130023424)===r&&(t=vc+500-st(),10<t)){if(Ca(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){Gt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Yu(qr.bind(null,e,qt,Yn),t);break}qr(e,qt,Yn);break;case 4:if(_r(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-Pn(r);s=1<<o,o=t[o],o>i&&(i=o),r&=~s}if(r=i,r=st()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*W2(r/1960))-r,10<r){e.timeoutHandle=Yu(qr.bind(null,e,qt,Yn),r);break}qr(e,qt,Yn);break;case 5:qr(e,qt,Yn);break;default:throw Error(ne(329))}}}return Yt(e,st()),e.callbackNode===n?zg.bind(null,e):null}function gf(e,t){var n=Bs;return e.current.memoizedState.isDehydrated&&(Xr(e,t).flags|=256),e=za(e,t),e!==2&&(t=qt,qt=n,t!==null&&xf(t)),e}function xf(e){qt===null?qt=e:qt.push.apply(qt,e)}function q2(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Dn(s(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function _r(e,t){for(t&=~xc,t&=~Tl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Pn(t),r=1<<n;e[n]=-1,t&=~r}}function gd(e){if(Fe&6)throw Error(ne(327));bi();var t=Ca(e,0);if(!(t&1))return Yt(e,st()),null;var n=za(e,t);if(e.tag!==0&&n===2){var r=Gu(e);r!==0&&(t=r,n=gf(e,r))}if(n===1)throw n=ho,Xr(e,0),_r(e,t),Yt(e,st()),n;if(n===6)throw Error(ne(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,qr(e,qt,Yn),Yt(e,st()),null}function yc(e,t){var n=Fe;Fe|=1;try{return e(t)}finally{Fe=n,Fe===0&&(Zi=st()+500,xl&&Vr())}}function ri(e){Er!==null&&Er.tag===0&&!(Fe&6)&&bi();var t=Fe;Fe|=1;var n=gn.transition,r=Ge;try{if(gn.transition=null,Ge=1,e)return e()}finally{Ge=r,gn.transition=n,Fe=t,!(Fe&6)&&Vr()}}function _c(){en=Pi.current,Je(Pi)}function Xr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,T2(n)),lt!==null)for(n=lt.return;n!==null;){var r=n;switch(ec(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ra();break;case 3:Qi(),Je(Jt),Je(Ot),uc();break;case 5:lc(r);break;case 4:Qi();break;case 13:Je(je);break;case 19:Je(je);break;case 10:ic(r.type._context);break;case 22:case 23:_c()}n=n.return}if(_t=e,lt=e=Fr(e.current,null),At=en=t,ht=0,ho=null,xc=Tl=ni=0,qt=Bs=null,Kr!==null){for(t=0;t<Kr.length;t++)if(n=Kr[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Kr=null}return e}function Wg(e,t){do{var n=lt;try{if(rc(),da.current=ba,Ba){for(var r=Ze.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Ba=!1}if(ti=0,gt=dt=Ze=null,Us=!1,uo=0,gc.current=null,n===null||n.return===null){ht=1,ho=t,lt=null;break}e:{var s=e,o=n.return,a=n,l=t;if(t=At,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=rd(o);if(m!==null){m.flags&=-257,id(m,o,a,s,t),m.mode&1&&nd(s,u,t),t=m,l=u;var y=t.updateQueue;if(y===null){var x=new Set;x.add(l),t.updateQueue=x}else y.add(l);break e}else{if(!(t&1)){nd(s,u,t),Tc();break e}l=Error(ne(426))}}else if(Ye&&a.mode&1){var E=rd(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),id(E,o,a,s,t),tc(ji(l,a));break e}}s=l=ji(l,a),ht!==4&&(ht=2),Bs===null?Bs=[s]:Bs.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var T=Ng(s,l,t);X0(s,T);break e;case 1:a=l;var _=s.type,v=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Rr===null||!Rr.has(v)))){s.flags|=65536,t&=-t,s.lanes|=t;var C=Ig(s,a,t);X0(s,C);break e}}s=s.return}while(s!==null)}Jg(n)}catch(D){t=D,lt===n&&n!==null&&(lt=n=n.return);continue}break}while(!0)}function qg(){var e=Va.current;return Va.current=ba,e===null?ba:e}function Tc(){(ht===0||ht===3||ht===2)&&(ht=4),_t===null||!(ni&268435455)&&!(Tl&268435455)||_r(_t,At)}function za(e,t){var n=Fe;Fe|=2;var r=qg();(_t!==e||At!==t)&&(Yn=null,Xr(e,t));do try{$2();break}catch(i){Wg(e,i)}while(!0);if(rc(),Fe=n,Va.current=r,lt!==null)throw Error(ne(261));return _t=null,At=0,ht}function $2(){for(;lt!==null;)$g(lt)}function J2(){for(;lt!==null&&!vy();)$g(lt)}function $g(e){var t=Yg(e.alternate,e,en);e.memoizedProps=e.pendingProps,t===null?Jg(e):lt=t,gc.current=null}function Jg(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=V2(n,t),n!==null){n.flags&=32767,lt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ht=6,lt=null;return}}else if(n=b2(n,t,en),n!==null){lt=n;return}if(t=t.sibling,t!==null){lt=t;return}lt=t=e}while(t!==null);ht===0&&(ht=5)}function qr(e,t,n){var r=Ge,i=gn.transition;try{gn.transition=null,Ge=1,K2(e,t,n,r)}finally{gn.transition=i,Ge=r}return null}function K2(e,t,n,r){do bi();while(Er!==null);if(Fe&6)throw Error(ne(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ne(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(Iy(e,s),e===_t&&(lt=_t=null,At=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ko||(Ko=!0,Xg(wa,function(){return bi(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=gn.transition,gn.transition=null;var o=Ge;Ge=1;var a=Fe;Fe|=4,gc.current=null,H2(e,n),Gg(n,e),p2(Ju),Aa=!!$u,Ju=$u=null,e.current=n,z2(n),yy(),Fe=a,Ge=o,gn.transition=s}else e.current=n;if(Ko&&(Ko=!1,Er=e,Ha=i),s=e.pendingLanes,s===0&&(Rr=null),Ey(n.stateNode),Yt(e,st()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ga)throw Ga=!1,e=pf,pf=null,e;return Ha&1&&e.tag!==0&&bi(),s=e.pendingLanes,s&1?e===mf?bs++:(bs=0,mf=e):bs=0,Vr(),null}function bi(){if(Er!==null){var e=Nm(Ha),t=gn.transition,n=Ge;try{if(gn.transition=null,Ge=16>e?16:e,Er===null)var r=!1;else{if(e=Er,Er=null,Ha=0,Fe&6)throw Error(ne(331));var i=Fe;for(Fe|=4,pe=e.current;pe!==null;){var s=pe,o=s.child;if(pe.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(pe=u;pe!==null;){var d=pe;switch(d.tag){case 0:case 11:case 15:Os(8,d,s)}var h=d.child;if(h!==null)h.return=d,pe=h;else for(;pe!==null;){d=pe;var p=d.sibling,m=d.return;if(Bg(d),d===u){pe=null;break}if(p!==null){p.return=m,pe=p;break}pe=m}}}var y=s.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var E=x.sibling;x.sibling=null,x=E}while(x!==null)}}pe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,pe=o;else e:for(;pe!==null;){if(s=pe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Os(9,s,s.return)}var T=s.sibling;if(T!==null){T.return=s.return,pe=T;break e}pe=s.return}}var _=e.current;for(pe=_;pe!==null;){o=pe;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,pe=v;else e:for(o=_;pe!==null;){if(a=pe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:_l(9,a)}}catch(D){tt(a,a.return,D)}if(a===o){pe=null;break e}var C=a.sibling;if(C!==null){C.return=a.return,pe=C;break e}pe=a.return}}if(Fe=i,Vr(),zn&&typeof zn.onPostCommitFiberRoot=="function")try{zn.onPostCommitFiberRoot(dl,e)}catch{}r=!0}return r}finally{Ge=n,gn.transition=t}}return!1}function xd(e,t,n){t=ji(n,t),t=Ng(e,t,1),e=kr(e,t,1),t=Gt(),e!==null&&(Eo(e,1,t),Yt(e,t))}function tt(e,t,n){if(e.tag===3)xd(e,e,n);else for(;t!==null;){if(t.tag===3){xd(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Rr===null||!Rr.has(r))){e=ji(n,e),e=Ig(t,e,1),t=kr(t,e,1),e=Gt(),t!==null&&(Eo(t,1,e),Yt(t,e));break}}t=t.return}}function Y2(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Gt(),e.pingedLanes|=e.suspendedLanes&n,_t===e&&(At&n)===n&&(ht===4||ht===3&&(At&130023424)===At&&500>st()-vc?Xr(e,0):xc|=n),Yt(e,t)}function Kg(e,t){t===0&&(e.mode&1?(t=Bo,Bo<<=1,!(Bo&130023424)&&(Bo=4194304)):t=1);var n=Gt();e=sr(e,t),e!==null&&(Eo(e,t,n),Yt(e,n))}function X2(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Kg(e,n)}function Q2(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ne(314))}r!==null&&r.delete(t),Kg(e,n)}var Yg;Yg=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Jt.current)$t=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return $t=!1,B2(e,t,n);$t=!!(e.flags&131072)}else $t=!1,Ye&&t.flags&1048576&&Zm(t,Ma,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;pa(e,t),e=t.pendingProps;var i=Ki(t,Ot.current);Bi(t,n),i=cc(null,t,r,e,i,n);var s=dc();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Kt(r)?(s=!0,Pa(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,oc(t),i.updater=yl,t.stateNode=i,i._reactInternals=t,nf(t,r,e,n),t=of(null,t,r,!0,s,n)):(t.tag=0,Ye&&s&&Zf(t),Bt(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(pa(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=Z2(r),e=An(r,e),i){case 0:t=sf(null,t,r,e,n);break e;case 1:t=ad(null,t,r,e,n);break e;case 11:t=sd(null,t,r,e,n);break e;case 14:t=od(null,t,r,An(r.type,e),n);break e}throw Error(ne(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:An(r,i),sf(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:An(r,i),ad(e,t,r,i,n);case 3:e:{if(Fg(t),e===null)throw Error(ne(387));r=t.pendingProps,s=t.memoizedState,i=s.element,sg(e,t),Ua(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=ji(Error(ne(423)),t),t=ld(e,t,r,n,i);break e}else if(r!==i){i=ji(Error(ne(424)),t),t=ld(e,t,r,n,i);break e}else for(sn=Ir(t.stateNode.containerInfo.firstChild),on=t,Ye=!0,In=null,n=rg(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Yi(),r===i){t=or(e,t,n);break e}Bt(e,t,r,n)}t=t.child}return t;case 5:return og(t),e===null&&Zu(t),r=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,Ku(r,i)?o=null:s!==null&&Ku(r,s)&&(t.flags|=32),Pg(e,t),Bt(e,t,o,n),t.child;case 6:return e===null&&Zu(t),null;case 13:return Mg(e,t,n);case 4:return ac(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Xi(t,null,r,n):Bt(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:An(r,i),sd(e,t,r,i,n);case 7:return Bt(e,t,t.pendingProps,n),t.child;case 8:return Bt(e,t,t.pendingProps.children,n),t.child;case 12:return Bt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,We(Da,r._currentValue),r._currentValue=o,s!==null)if(Dn(s.value,o)){if(s.children===i.children&&!Jt.current){t=or(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Zn(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),ef(s.return,n,t),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ne(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),ef(o,n,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Bt(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Bi(t,n),i=vn(i),r=r(i),t.flags|=1,Bt(e,t,r,n),t.child;case 14:return r=t.type,i=An(r,t.pendingProps),i=An(r.type,i),od(e,t,r,i,n);case 15:return kg(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:An(r,i),pa(e,t),t.tag=1,Kt(r)?(e=!0,Pa(t)):e=!1,Bi(t,n),Ag(t,r,i),nf(t,r,i,n),of(null,t,r,!0,e,n);case 19:return Dg(e,t,n);case 22:return Rg(e,t,n)}throw Error(ne(156,t.tag))};function Xg(e,t){return Sm(e,t)}function j2(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mn(e,t,n,r){return new j2(e,t,n,r)}function Ec(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Z2(e){if(typeof e=="function")return Ec(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Gf)return 11;if(e===Hf)return 14}return 2}function Fr(e,t){var n=e.alternate;return n===null?(n=mn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function xa(e,t,n,r,i,s){var o=2;if(r=e,typeof e=="function")Ec(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Ti:return Qr(n.children,i,s,t);case Vf:o=8,i|=8;break;case Au:return e=mn(12,n,t,i|2),e.elementType=Au,e.lanes=s,e;case Nu:return e=mn(13,n,t,i),e.elementType=Nu,e.lanes=s,e;case Iu:return e=mn(19,n,t,i),e.elementType=Iu,e.lanes=s,e;case om:return El(n,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case im:o=10;break e;case sm:o=9;break e;case Gf:o=11;break e;case Hf:o=14;break e;case xr:o=16,r=null;break e}throw Error(ne(130,e==null?e:typeof e,""))}return t=mn(o,n,t,i),t.elementType=e,t.type=r,t.lanes=s,t}function Qr(e,t,n,r){return e=mn(7,e,r,t),e.lanes=n,e}function El(e,t,n,r){return e=mn(22,e,r,t),e.elementType=om,e.lanes=n,e.stateNode={isHidden:!1},e}function cu(e,t,n){return e=mn(6,e,null,t),e.lanes=n,e}function du(e,t,n){return t=mn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function e_(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$l(0),this.expirationTimes=$l(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$l(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Sc(e,t,n,r,i,s,o,a,l){return e=new e_(e,t,n,a,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=mn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},oc(s),e}function t_(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_i,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Qg(e){if(!e)return Dr;e=e._reactInternals;e:{if(li(e)!==e||e.tag!==1)throw Error(ne(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Kt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ne(171))}if(e.tag===1){var n=e.type;if(Kt(n))return Qm(e,n,t)}return t}function jg(e,t,n,r,i,s,o,a,l){return e=Sc(n,r,!0,e,i,s,o,a,l),e.context=Qg(null),n=e.current,r=Gt(),i=Pr(n),s=Zn(r,i),s.callback=t??null,kr(n,s,i),e.current.lanes=i,Eo(e,i,r),Yt(e,r),e}function Sl(e,t,n,r){var i=t.current,s=Gt(),o=Pr(i);return n=Qg(n),t.context===null?t.context=n:t.pendingContext=n,t=Zn(s,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=kr(i,t,o),e!==null&&(Fn(e,i,o,s),ca(e,i,o)),o}function Wa(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function vd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function wc(e,t){vd(e,t),(e=e.alternate)&&vd(e,t)}function n_(){return null}var Zg=typeof reportError=="function"?reportError:function(e){console.error(e)};function Cc(e){this._internalRoot=e}wl.prototype.render=Cc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ne(409));Sl(e,t,null,null)};wl.prototype.unmount=Cc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ri(function(){Sl(null,e,null,null)}),t[ir]=null}};function wl(e){this._internalRoot=e}wl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Rm();e={blockedOn:null,target:e,priority:t};for(var n=0;n<yr.length&&t!==0&&t<yr[n].priority;n++);yr.splice(n,0,e),n===0&&Fm(e)}};function Ac(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Cl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function yd(){}function r_(e,t,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Wa(o);s.call(u)}}var o=jg(t,r,e,0,null,!1,!1,"",yd);return e._reactRootContainer=o,e[ir]=o.current,io(e.nodeType===8?e.parentNode:e),ri(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=Wa(l);a.call(u)}}var l=Sc(e,0,!1,null,null,!1,!1,"",yd);return e._reactRootContainer=l,e[ir]=l.current,io(e.nodeType===8?e.parentNode:e),ri(function(){Sl(t,l,n,r)}),l}function Al(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Wa(o);a.call(l)}}Sl(t,o,e,i)}else o=r_(n,t,e,i,r);return Wa(o)}Im=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Is(t.pendingLanes);n!==0&&(qf(t,n|1),Yt(t,st()),!(Fe&6)&&(Zi=st()+500,Vr()))}break;case 13:ri(function(){var r=sr(e,1);if(r!==null){var i=Gt();Fn(r,e,1,i)}}),wc(e,1)}};$f=function(e){if(e.tag===13){var t=sr(e,134217728);if(t!==null){var n=Gt();Fn(t,e,134217728,n)}wc(e,134217728)}};km=function(e){if(e.tag===13){var t=Pr(e),n=sr(e,t);if(n!==null){var r=Gt();Fn(n,e,t,r)}wc(e,t)}};Rm=function(){return Ge};Pm=function(e,t){var n=Ge;try{return Ge=e,t()}finally{Ge=n}};Bu=function(e,t,n){switch(t){case"input":if(Pu(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=gl(r);if(!i)throw Error(ne(90));lm(r),Pu(r,i)}}}break;case"textarea":fm(e,n);break;case"select":t=n.value,t!=null&&Di(e,!!n.multiple,t,!1)}};xm=yc;vm=ri;var i_={usingClientEntryPoint:!1,Events:[wo,Ci,gl,mm,gm,yc]},Es={findFiberByHostInstance:Jr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},s_={bundleType:Es.bundleType,version:Es.version,rendererPackageName:Es.rendererPackageName,rendererConfig:Es.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Tm(e),e===null?null:e.stateNode},findFiberByHostInstance:Es.findFiberByHostInstance||n_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yo.isDisabled&&Yo.supportsFiber)try{dl=Yo.inject(s_),zn=Yo}catch{}}un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=i_;un.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ac(t))throw Error(ne(200));return t_(e,t,null,n)};un.createRoot=function(e,t){if(!Ac(e))throw Error(ne(299));var n=!1,r="",i=Zg;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Sc(e,1,!1,null,null,n,!1,r,i),e[ir]=t.current,io(e.nodeType===8?e.parentNode:e),new Cc(t)};un.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ne(188)):(e=Object.keys(e).join(","),Error(ne(268,e)));return e=Tm(t),e=e===null?null:e.stateNode,e};un.flushSync=function(e){return ri(e)};un.hydrate=function(e,t,n){if(!Cl(t))throw Error(ne(200));return Al(null,e,t,!0,n)};un.hydrateRoot=function(e,t,n){if(!Ac(e))throw Error(ne(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=Zg;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=jg(t,null,e,1,n??null,i,!1,s,o),e[ir]=t.current,io(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new wl(t)};un.render=function(e,t,n){if(!Cl(t))throw Error(ne(200));return Al(null,e,t,!1,n)};un.unmountComponentAtNode=function(e){if(!Cl(e))throw Error(ne(40));return e._reactRootContainer?(ri(function(){Al(null,null,e,!1,function(){e._reactRootContainer=null,e[ir]=null})}),!0):!1};un.unstable_batchedUpdates=yc;un.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Cl(n))throw Error(ne(200));if(e==null||e._reactInternals===void 0)throw Error(ne(38));return Al(e,t,n,!1,r)};un.version="18.3.1-next-f1338f8080-20240426";function e1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e1)}catch(e){console.error(e)}}e1(),em.exports=un;var o_=em.exports,_d=o_;wu.createRoot=_d.createRoot,wu.hydrateRoot=_d.hydrateRoot;/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a_=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),t1=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var l_={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u_=Ne.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...a},l)=>Ne.createElement("svg",{ref:l,...l_,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:t1("lucide",i),...a},[...o.map(([u,d])=>Ne.createElement(u,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=(e,t)=>{const n=Ne.forwardRef(({className:r,...i},s)=>Ne.createElement(u_,{ref:s,iconNode:t,className:t1(`lucide-${a_(e)}`,r),...i}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Td=Ce("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f_=Ce("Baby",[["path",{d:"M9 12h.01",key:"157uk2"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"5yv0yz"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c_=Ce("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d_=Ce("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=Ce("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h_=Ce("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p_=Ce("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m_=Ce("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g_=Ce("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=Ce("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nc=Ce("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=Ce("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x_=Ce("FileSearch",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=Ce("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v_=Ce("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hu=Ce("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y_=Ce("Flower2",[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=Ce("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __=Ce("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n1=Ce("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cd=Ce("Hammer",[["path",{d:"m15 12-8.373 8.373a1 1 0 1 1-3-3L12 9",key:"eefl8a"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172V7l-2.26-2.26a6 6 0 0 0-4.202-1.756L9 2.96l.92.82A6.18 6.18 0 0 1 12 8.4V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"b7pghm"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=Ce("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r1=Ce("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T_=Ce("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E_=Ce("LayoutList",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ad=Ce("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=Ce("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=Ce("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S_=Ce("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w_=Ce("Microscope",[["path",{d:"M6 18h8",key:"1borvv"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M14 22a7 7 0 1 0 0-14h-1",key:"1jwaiy"}],["path",{d:"M9 14h2",key:"197e7h"}],["path",{d:"M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z",key:"1bmzmy"}],["path",{d:"M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3",key:"1drr47"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=Ce("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=Ce("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=Ce("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C_=Ce("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=Ce("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Id=Ce("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kd=Ce("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A_=Ce("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pu=Ce("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N_=Ce("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mu=Ce("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=Ce("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rd=Ce("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=Ce("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),I_={en:{player:"PLAYER",restart:"Restart",exit:"Exit",features:"Features",selected:"selected",matches:"Matches",discarded:"Discarded",identified:"1 Entity identified",potential:"potential matches",excluded:"Excluded by selection",noMatches:"No matches found.",tryUnselecting:"Try unselecting some features.",speciesDetails:"Species Details",morphology:"Morphology & Traits",close:"Close",resources:"Resources",viewResults:"View Results"},pt:{player:"PLAYER",restart:"Reiniciar",exit:"Sair",features:"Caractersticas",selected:"selecionado(s)",matches:"Compatveis",discarded:"Descartados",identified:"1 Entidade identificada",potential:"matches potenciais",excluded:"Excludo pela seleo",noMatches:"Nenhum resultado.",tryUnselecting:"Tente remover selees.",speciesDetails:"Detalhes da Espcie",morphology:"Morfologia & Caractersticas",close:"Fechar",resources:"Recursos Adicionais",viewResults:"Ver Resultados"}},k_=({project:e,onBack:t,language:n})=>{const r=I_[n],[i,s]=Ne.useState({}),[o,a]=Ne.useState(!1),[l,u]=Ne.useState(null),[d,h]=Ne.useState(null),[p,m]=Ne.useState("FILTERS"),y=(v,C)=>{s(D=>{const F=D[v]||[],I=F.includes(C);let L;if(I?L=F.filter(M=>M!==C):L=[...F,C],L.length===0){const{[v]:M,...B}=D;return B}return{...D,[v]:L}})},x=()=>s({}),{remaining:E,discarded:T}=Ne.useMemo(()=>{const v=[],C=[];return e.entities.forEach(D=>{let F=!0;for(const[I,L]of Object.entries(i)){const M=D.traits[I]||[];if(!L.some(J=>M.includes(J))){F=!1;break}}F?v.push(D):C.push(D)}),{remaining:v,discarded:C}},[e.entities,i]),_=Object.values(i).reduce((v,C)=>v+C.length,0);return g.jsxs("div",{className:"flex flex-col h-full bg-slate-100 font-sans absolute inset-0",children:[g.jsxs("header",{className:"bg-white border-b px-4 py-3 flex justify-between items-center shadow-sm z-30 shrink-0",children:[g.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[g.jsx("button",{onClick:t,className:"md:hidden p-2 -ml-2 text-slate-500 hover:bg-slate-100 rounded-full",children:g.jsx(Td,{size:20})}),g.jsx("div",{className:"overflow-hidden",children:g.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2 truncate",children:[g.jsx("span",{className:"hidden sm:inline-block bg-emerald-600 text-white text-xs px-2 py-1 rounded",children:r.player}),g.jsx("span",{className:"truncate",children:e.name})]})})]}),g.jsxs("div",{className:"flex gap-2 shrink-0",children:[g.jsxs("button",{onClick:x,className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",title:r.restart,children:[g.jsx(C_,{size:18})," ",g.jsx("span",{className:"hidden sm:inline",children:r.restart})]}),g.jsxs("button",{onClick:t,className:"hidden md:flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-600 hover:text-slate-900 transition-colors",children:[g.jsx(Td,{size:16})," ",r.exit]})]})]}),g.jsxs("div",{className:"md:hidden flex border-b bg-white z-20 shrink-0",children:[g.jsxs("button",{onClick:()=>m("FILTERS"),className:`flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 transition-colors relative ${p==="FILTERS"?"text-emerald-600":"text-slate-500 bg-slate-50"}`,children:[g.jsx(hu,{size:16}),r.features,_>0&&g.jsx("span",{className:"bg-emerald-600 text-white text-[10px] w-5 h-5 flex items-center justify-center rounded-full",children:_}),p==="FILTERS"&&g.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-600"})]}),g.jsxs("button",{onClick:()=>m("RESULTS"),className:`flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 transition-colors relative ${p==="RESULTS"?"text-emerald-600":"text-slate-500 bg-slate-50"}`,children:[g.jsx(n1,{size:16}),r.matches,g.jsx("span",{className:"bg-slate-200 text-slate-700 text-[10px] px-1.5 py-0.5 rounded-full font-bold",children:E.length}),p==="RESULTS"&&g.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-600"})]})]}),g.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row relative",children:[g.jsxs("div",{className:`w-full md:w-1/3 lg:w-1/4 bg-white md:border-r flex flex-col h-full relative z-20 ${p==="FILTERS"?"flex":"hidden md:flex"}`,children:[g.jsx("div",{className:"hidden md:block p-4 border-b bg-slate-50",children:g.jsxs("h3",{className:"font-semibold text-slate-700 flex items-center gap-2",children:[g.jsx(hu,{size:18})," ",r.features]})}),g.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 pb-24 md:pb-4 custom-scrollbar",children:e.features.map(v=>{const C=i[v.id]||[],D=C.length>0;return g.jsxs("div",{className:"space-y-2 relative",children:[g.jsxs("div",{className:"flex justify-between items-center sticky top-0 bg-white/95 backdrop-blur-sm py-1 z-10",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("h4",{className:`font-medium ${D?"text-emerald-600":"text-slate-700"}`,children:v.name}),v.imageUrl&&g.jsx(g.Fragment,{children:g.jsx("button",{className:"text-slate-400 hover:text-emerald-500 transition-colors p-1",onClick:F=>{F.stopPropagation(),u(l===v.id?null:v.id)},children:g.jsx(Hs,{size:14})})})]}),D&&g.jsx("span",{className:"text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full",children:C.length})]}),l===v.id&&v.imageUrl&&g.jsxs("div",{className:"mb-2 rounded-lg overflow-hidden border border-slate-200 shadow-sm animate-in fade-in zoom-in-95",children:[g.jsx("img",{src:v.imageUrl,alt:v.name,className:"w-full h-32 object-cover"}),g.jsx("div",{className:"bg-slate-50 p-1 text-center",children:g.jsx("button",{onClick:()=>u(null),className:"text-xs text-slate-500 underline",children:"Fechar"})})]}),g.jsx("div",{className:"grid grid-cols-1 gap-1",children:v.states.map(F=>{const I=C.includes(F.id);return g.jsxs("button",{onClick:()=>y(v.id,F.id),className:`w-full text-left px-3 py-3 md:py-2 text-sm rounded-lg transition-all flex items-center justify-between group active:scale-[0.98] touch-manipulation ${I?"bg-emerald-600 text-white shadow-md":"bg-slate-50 text-slate-600 border border-transparent hover:bg-slate-100 hover:border-slate-200"}`,children:[g.jsx("span",{className:"leading-tight",children:F.label}),I&&g.jsx(p_,{size:16,className:"shrink-0"})]},F.id)})})]},v.id)})}),g.jsx("div",{className:"md:hidden absolute bottom-4 left-4 right-4 z-30",children:g.jsxs("button",{onClick:()=>m("RESULTS"),className:"w-full bg-slate-900 text-white font-bold py-3 rounded-xl shadow-lg shadow-slate-900/20 flex items-center justify-center gap-2 animate-in slide-in-from-bottom-5",children:[r.viewResults," (",E.length,")"]})})]}),g.jsxs("div",{className:`flex-1 bg-slate-100 flex-col h-full overflow-hidden ${p==="RESULTS"?"flex":"hidden md:flex"}`,children:[g.jsxs("div",{className:"p-3 md:p-4 bg-white border-b flex justify-between items-center shadow-sm shrink-0",children:[g.jsxs("div",{className:"flex gap-2 md:gap-4 w-full md:w-auto bg-slate-100 p-1 rounded-lg",children:[g.jsxs("button",{className:`flex-1 md:flex-none text-xs md:text-sm font-medium px-3 py-1.5 rounded-md transition-all ${o?"text-slate-500":"bg-white text-slate-800 shadow-sm"}`,onClick:()=>a(!1),children:[r.matches," (",E.length,")"]}),g.jsxs("button",{className:`flex-1 md:flex-none text-xs md:text-sm font-medium px-3 py-1.5 rounded-md transition-all ${o?"bg-white text-slate-800 shadow-sm":"text-slate-500"}`,onClick:()=>a(!0),children:[r.discarded," (",T.length,")"]})]}),g.jsx("div",{className:"text-xs text-slate-400 hidden sm:block",children:E.length===1?r.identified:`${E.length} ${r.potential}`})]}),g.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 custom-scrollbar",onClick:()=>u(null),children:g.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 pb-20 md:pb-0",children:[(o?T:E).map(v=>g.jsxs("div",{onClick:()=>h(v),className:`bg-white rounded-xl overflow-hidden shadow-sm hover:shadow-lg transition-all border cursor-pointer active:scale-[0.98] touch-manipulation ${o?"opacity-60 grayscale":""}`,children:[g.jsxs("div",{className:"h-48 md:h-40 bg-slate-200 relative group",children:[g.jsx("img",{src:v.imageUrl||"https://picsum.photos/400/300",alt:v.name,className:"w-full h-full object-cover",loading:"lazy"}),g.jsxs("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2 text-white font-medium",children:[g.jsx(Sd,{size:20})," ",g.jsx("span",{className:"hidden md:inline",children:"Ver Detalhes"})]}),g.jsx("div",{className:"md:hidden absolute bottom-2 right-2 bg-black/50 text-white p-1.5 rounded-full backdrop-blur-sm",children:g.jsx(Sd,{size:16})})]}),g.jsxs("div",{className:"p-4",children:[g.jsxs("h3",{className:"font-bold text-slate-800 text-lg mb-1 flex justify-between items-center",children:[v.name,g.jsx(r1,{size:16,className:"text-slate-300"})]}),g.jsx("p",{className:"text-slate-500 text-xs line-clamp-3",children:v.description}),o&&g.jsxs("div",{className:"mt-3 pt-2 border-t border-slate-100 text-xs text-red-500 flex items-center gap-1",children:[g.jsx(Hn,{size:12})," ",r.excluded]})]})]},v.id)),!o&&E.length===0&&g.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-20 text-slate-400 px-4 text-center",children:[g.jsx(hu,{size:48,className:"mb-4 opacity-50"}),g.jsx("p",{className:"text-lg font-medium text-slate-600",children:r.noMatches}),g.jsx("p",{className:"text-sm",children:r.tryUnselecting}),g.jsx("button",{onClick:x,className:"mt-6 px-6 py-2 bg-slate-200 text-slate-700 rounded-lg font-medium hover:bg-slate-300",children:r.restart})]})]})})]})]}),d&&g.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-0 md:p-4 animate-in fade-in duration-200",children:g.jsxs("div",{className:"bg-white md:rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col h-full md:h-auto md:max-h-[90vh] overflow-hidden",children:[g.jsxs("div",{className:"relative h-64 md:h-64 shrink-0 bg-slate-900",children:[d.imageUrl?g.jsx("img",{src:d.imageUrl,className:"w-full h-full object-cover opacity-90",alt:d.name}):g.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-600 bg-slate-200",children:g.jsx(Hs,{size:48})}),g.jsx("button",{onClick:()=>h(null),className:"absolute top-4 right-4 bg-black/40 hover:bg-black/60 text-white p-2 rounded-full transition-colors z-10 backdrop-blur-sm",children:g.jsx(Hn,{size:24})}),g.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 via-black/50 to-transparent p-6 pt-12",children:g.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white shadow-sm leading-tight",children:d.name})})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8 custom-scrollbar bg-white",children:[g.jsxs("div",{children:[g.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-3",children:[g.jsx(c_,{size:14})," ",r.speciesDetails]}),g.jsx("p",{className:"text-slate-800 leading-relaxed text-base md:text-lg font-serif",children:d.description})]}),d.links&&d.links.length>0&&g.jsxs("div",{children:[g.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-3",children:[g.jsx(vf,{size:14})," ",r.resources]}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:d.links.map((v,C)=>g.jsxs("a",{href:v.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 rounded-lg border border-slate-200 bg-slate-50 hover:bg-slate-100 hover:border-emerald-300 transition-all group active:scale-[0.98]",children:[g.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm text-slate-400 group-hover:text-emerald-600",children:g.jsx(Nc,{size:16})}),g.jsx("span",{className:"text-sm font-medium text-slate-700 group-hover:text-emerald-700 truncate flex-1",children:v.label||v.url})]},C))})]}),g.jsx("div",{className:"border-t border-slate-100"}),g.jsxs("div",{children:[g.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-4",children:[g.jsx(N_,{size:14})," ",r.morphology]}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4",children:e.features.map(v=>{const C=d.traits[v.id];if(!C||C.length===0)return null;const D=C.map(F=>{const I=v.states.find(L=>L.id===F);return I?I.label:"?"}).join(", ");return g.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 flex flex-col",children:[g.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:v.name}),g.jsx("span",{className:"text-sm font-semibold text-slate-800",children:D})]},v.id)})}),Object.keys(d.traits).length===0&&g.jsx("p",{className:"text-slate-400 text-sm italic",children:"Nenhuma caracterstica registrada."})]})]}),g.jsx("div",{className:"p-4 border-t bg-slate-50 shrink-0 safe-area-bottom",children:g.jsx("button",{onClick:()=>h(null),className:"w-full py-3 bg-slate-900 text-white font-bold rounded-xl hover:bg-slate-800 transition-colors shadow-lg",children:r.close})})]})})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let R_,P_;function F_(){return{geminiUrl:R_,vertexUrl:P_}}function M_(e,t,n,r){var i,s;if(!(e!=null&&e.baseUrl)){const o=F_();return t?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cr{}function fe(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(t,i)){const s=t[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function c(e,t,n){for(let s=0;s<t.length-1;s++){const o=t[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in e))if(Array.isArray(n))e[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(e[a])){const l=e[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const d=l[u];c(d,t.slice(s+1),n[u])}else for(const u of l)c(u,t.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in e||(e[a]=[{}]);const l=e[a];c(l[0],t.slice(s+1),n);return}(!e[o]||typeof e[o]!="object")&&(e[o]={}),e=e[o]}const r=t[t.length-1],i=e[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(e,n):e[r]=n}function f(e,t,n=void 0){try{if(t.length===1&&t[0]==="_self")return e;for(let r=0;r<t.length;r++){if(typeof e!="object"||e===null)return n;const i=t[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in e){const o=e[s];return Array.isArray(o)?o.map(a=>f(a,t.slice(r+1),n)):n}else return n}else e=e[i]}return e}catch(r){if(r instanceof TypeError)return n;throw r}}function D_(e,t){for(const[n,r]of Object.entries(t)){const i=n.split("."),s=r.split("."),o=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const u=s[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}_f(e,i,s,0,o)}}function _f(e,t,n,r,i){if(r>=t.length||typeof e!="object"||e===null)return;const s=t[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=e;if(o in a&&Array.isArray(a[o]))for(const l of a[o])_f(l,t,n,r+1,i)}else if(s==="*"){if(typeof e=="object"&&e!==null&&!Array.isArray(e)){const o=e,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!i.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,d]of Object.entries(l)){const h=[];for(const p of n.slice(r))p==="*"?h.push(u):h.push(p);c(o,h,d)}for(const u of a)delete o[u]}}else{const o=e;s in o&&_f(o[s],t,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ic(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function L_(e){const t={},n=f(e,["operationName"]);n!=null&&c(t,["operationName"],n);const r=f(e,["resourceName"]);return r!=null&&c(t,["_url","resourceName"],r),t}function U_(e){const t={},n=f(e,["name"]);n!=null&&c(t,["name"],n);const r=f(e,["metadata"]);r!=null&&c(t,["metadata"],r);const i=f(e,["done"]);i!=null&&c(t,["done"],i);const s=f(e,["error"]);s!=null&&c(t,["error"],s);const o=f(e,["response","generateVideoResponse"]);return o!=null&&c(t,["response"],B_(o)),t}function O_(e){const t={},n=f(e,["name"]);n!=null&&c(t,["name"],n);const r=f(e,["metadata"]);r!=null&&c(t,["metadata"],r);const i=f(e,["done"]);i!=null&&c(t,["done"],i);const s=f(e,["error"]);s!=null&&c(t,["error"],s);const o=f(e,["response"]);return o!=null&&c(t,["response"],b_(o)),t}function B_(e){const t={},n=f(e,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>V_(o))),c(t,["generatedVideos"],s)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&c(t,["raiMediaFilteredCount"],r);const i=f(e,["raiMediaFilteredReasons"]);return i!=null&&c(t,["raiMediaFilteredReasons"],i),t}function b_(e){const t={},n=f(e,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>G_(o))),c(t,["generatedVideos"],s)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&c(t,["raiMediaFilteredCount"],r);const i=f(e,["raiMediaFilteredReasons"]);return i!=null&&c(t,["raiMediaFilteredReasons"],i),t}function V_(e){const t={},n=f(e,["video"]);return n!=null&&c(t,["video"],J_(n)),t}function G_(e){const t={},n=f(e,["_self"]);return n!=null&&c(t,["video"],K_(n)),t}function H_(e){const t={},n=f(e,["operationName"]);return n!=null&&c(t,["_url","operationName"],n),t}function z_(e){const t={},n=f(e,["operationName"]);return n!=null&&c(t,["_url","operationName"],n),t}function W_(e){const t={},n=f(e,["name"]);n!=null&&c(t,["name"],n);const r=f(e,["metadata"]);r!=null&&c(t,["metadata"],r);const i=f(e,["done"]);i!=null&&c(t,["done"],i);const s=f(e,["error"]);s!=null&&c(t,["error"],s);const o=f(e,["response"]);return o!=null&&c(t,["response"],q_(o)),t}function q_(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["parent"]);r!=null&&c(t,["parent"],r);const i=f(e,["documentName"]);return i!=null&&c(t,["documentName"],i),t}function i1(e){const t={},n=f(e,["name"]);n!=null&&c(t,["name"],n);const r=f(e,["metadata"]);r!=null&&c(t,["metadata"],r);const i=f(e,["done"]);i!=null&&c(t,["done"],i);const s=f(e,["error"]);s!=null&&c(t,["error"],s);const o=f(e,["response"]);return o!=null&&c(t,["response"],$_(o)),t}function $_(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["parent"]);r!=null&&c(t,["parent"],r);const i=f(e,["documentName"]);return i!=null&&c(t,["documentName"],i),t}function J_(e){const t={},n=f(e,["uri"]);n!=null&&c(t,["uri"],n);const r=f(e,["encodedVideo"]);r!=null&&c(t,["videoBytes"],Ic(r));const i=f(e,["encoding"]);return i!=null&&c(t,["mimeType"],i),t}function K_(e){const t={},n=f(e,["gcsUri"]);n!=null&&c(t,["uri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&c(t,["videoBytes"],Ic(r));const i=f(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Pd;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Pd||(Pd={}));var Fd;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(Fd||(Fd={}));var Md;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(Md||(Md={}));var we;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(we||(we={}));var Dd;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(Dd||(Dd={}));var Ld;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Ld||(Ld={}));var Ud;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(Ud||(Ud={}));var Od;(function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Od||(Od={}));var Bd;(function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Bd||(Bd={}));var bd;(function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.HIGH="HIGH"})(bd||(bd={}));var Vd;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Vd||(Vd={}));var Gd;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(Gd||(Gd={}));var Hd;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(Hd||(Hd={}));var zd;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE"})(zd||(zd={}));var Wd;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(Wd||(Wd={}));var qd;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(qd||(qd={}));var $d;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})($d||($d={}));var Jd;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"})(Jd||(Jd={}));var Kd;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Kd||(Kd={}));var $a;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})($a||($a={}));var Yd;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Yd||(Yd={}));var Xd;(function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Xd||(Xd={}));var Qd;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Qd||(Qd={}));var Tf;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Tf||(Tf={}));var jd;(function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"})(jd||(jd={}));var Zd;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Zd||(Zd={}));var eh;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(eh||(eh={}));var th;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(th||(th={}));var nh;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(nh||(nh={}));var rh;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(rh||(rh={}));var ih;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"})(ih||(ih={}));var sh;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(sh||(sh={}));var oh;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(oh||(oh={}));var ah;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(ah||(ah={}));var lh;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(lh||(lh={}));var uh;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(uh||(uh={}));var fh;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(fh||(fh={}));var ch;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(ch||(ch={}));var dh;(function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"})(dh||(dh={}));var hh;(function(e){e.ASSET="ASSET",e.STYLE="STYLE"})(hh||(hh={}));var ph;(function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"})(ph||(ph={}));var mh;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(mh||(mh={}));var gh;(function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING"})(gh||(gh={}));var xh;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"})(xh||(xh={}));var vh;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(vh||(vh={}));var yh;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(yh||(yh={}));var _h;(function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"})(_h||(_h={}));var Th;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(Th||(Th={}));var Eh;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Eh||(Eh={}));var Sh;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Sh||(Sh={}));var wh;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(wh||(wh={}));var Ch;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Ch||(Ch={}));var Ah;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Ah||(Ah={}));var Nh;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})(Nh||(Nh={}));var Fi;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(Fi||(Fi={}));class Ef{constructor(t){const n={};for(const r of t.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class Ss{get text(){var t,n,r,i,s,o,a,l;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",d=!1;const h=[];for(const p of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[m,y]of Object.entries(p))m!=="text"&&m!=="thought"&&m!=="thoughtSignature"&&(y!==null||y!==void 0)&&h.push(m);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;d=!0,u+=p.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?u:void 0}get data(){var t,n,r,i,s,o,a,l;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const d=[];for(const h of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[p,m]of Object.entries(h))p!=="inlineData"&&(m!==null||m!==void 0)&&d.push(p);h.inlineData&&typeof h.inlineData.data=="string"&&(u+=atob(h.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var t,n,r,i,s,o,a,l;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var t,n,r,i,s,o,a,l,u;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var t,n,r,i,s,o,a,l,u;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.output}}class Ih{}class kh{}class Y_{}class X_{}class Q_{}class j_{}class Rh{}class Ph{}class Fh{}class Z_{}class Ja{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new Ja;let i;const s=t;return n?i=O_(s):i=U_(s),Object.assign(r,i),r}}class Mh{}class Dh{}class Lh{}class eT{}class tT{}class nT{}class kc{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new kc,s=W_(t);return Object.assign(r,s),r}}class rT{}class iT{}class sT{}class Uh{}class oT{get text(){var t,n,r;let i="",s=!1;const o=[];for(const a of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var t,n,r;let i="";const s=[];for(const o of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class aT{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Rc{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new Rc,s=i1(t);return Object.assign(r,s),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Le(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function s1(e,t){const n=Le(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function o1(e){return Array.isArray(e)?e.map(t=>Ka(t)):[Ka(e)]}function Ka(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function a1(e){const t=Ka(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function l1(e){const t=Ka(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Oh(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function u1(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>Oh(t)):[Oh(e)]}function Sf(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function Bh(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function bh(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Dt(e){if(e==null)throw new Error("ContentUnion is required");return Sf(e)?e:{role:"user",parts:u1(e)}}function Pc(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const r=Dt(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const n=Dt(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>Dt(n)):[Dt(t)]}function xn(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(Bh(e)||bh(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Dt(e)]}const t=[],n=[],r=Sf(e[0]);for(const i of e){const s=Sf(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)t.push(i);else{if(Bh(i)||bh(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||t.push({role:"user",parts:u1(n)}),t}function lT(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(r=>r!=="null");if(n.length===1)t.type=Object.values(we).includes(n[0].toUpperCase())?n[0].toUpperCase():we.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const r of n)t.anyOf.push({type:Object.values(we).includes(r.toUpperCase())?r.toUpperCase():we.TYPE_UNSPECIFIED})}}function Vi(e){const t={},n=["items"],r=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=e.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(t.nullable=!0,e=s[1]):s[1].type==="null"&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&lT(e.type,t);for(const[o,a]of Object.entries(e))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;t.type=Object.values(we).includes(a.toUpperCase())?a.toUpperCase():we.TYPE_UNSPECIFIED}else if(n.includes(o))t[o]=Vi(a);else if(r.includes(o)){const l=[];for(const u of a){if(u.type=="null"){t.nullable=!0;continue}l.push(Vi(u))}t[o]=l}else if(i.includes(o)){const l={};for(const[u,d]of Object.entries(a))l[u]=Vi(d);t[o]=l}else{if(o==="additionalProperties")continue;t[o]=a}return t}function Fc(e){return Vi(e)}function Mc(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function Dc(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function is(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=Vi(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=Vi(t.response));return e}function ss(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function uT(e,t,n,r=1){const i=!t.startsWith(`${n}/`)&&t.split("/").length===r;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:i?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:i?`${n}/${t}`:t}function dr(e,t){if(typeof t!="string")throw new Error("name must be a string");return uT(e,t,"cachedContents")}function f1(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Gr(e){return Ic(e)}function fT(e){return e!=null&&typeof e=="object"&&"name"in e}function cT(e){return e!=null&&typeof e=="object"&&"video"in e}function dT(e){return e!=null&&typeof e=="object"&&"uri"in e}function c1(e){var t;let n;if(fT(e)&&(n=e.name),!(dT(e)&&(n=e.uri,n===void 0))&&!(cT(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function d1(e,t){let n;return e.isVertexAI()?n=t?"publishers/google/models":"models":n=t?"models":"tunedModels",n}function h1(e){for(const t of["models","tunedModels","publisherModels"])if(hT(e,t))return e[t];return[]}function hT(e,t){return e!==null&&typeof e=="object"&&t in e}function pT(e,t={}){const n=e,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),t.behavior&&(r.behavior=t.behavior),{functionDeclarations:[r]}}function mT(e,t={}){const n=[],r=new Set;for(const i of e){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=pT(i,t);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function p1(e,t){let n;if(typeof t=="string")if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))n={format:"bigquery",bigqueryUri:t};else throw new Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))n={fileName:t};else throw new Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function gT(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function m1(e){if(typeof e!="object"||e===null)return{};const t=e,n=t.inlinedResponses;if(typeof n!="object"||n===null)return e;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return e;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function os(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function g1(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xT(e){const t={},n=f(e,["responsesFile"]);n!=null&&c(t,["fileName"],n);const r=f(e,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>QT(o))),c(t,["inlinedResponses"],s)}const i=f(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),c(t,["inlinedEmbedContentResponses"],s)}return t}function vT(e){const t={},n=f(e,["predictionsFormat"]);n!=null&&c(t,["format"],n);const r=f(e,["gcsDestination","outputUriPrefix"]);r!=null&&c(t,["gcsUri"],r);const i=f(e,["bigqueryDestination","outputUri"]);return i!=null&&c(t,["bigqueryUri"],i),t}function yT(e){const t={},n=f(e,["format"]);n!=null&&c(t,["predictionsFormat"],n);const r=f(e,["gcsUri"]);r!=null&&c(t,["gcsDestination","outputUriPrefix"],r);const i=f(e,["bigqueryUri"]);if(i!=null&&c(t,["bigqueryDestination","outputUri"],i),f(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(f(e,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}function ya(e){const t={},n=f(e,["name"]);n!=null&&c(t,["name"],n);const r=f(e,["metadata","displayName"]);r!=null&&c(t,["displayName"],r);const i=f(e,["metadata","state"]);i!=null&&c(t,["state"],g1(i));const s=f(e,["metadata","createTime"]);s!=null&&c(t,["createTime"],s);const o=f(e,["metadata","endTime"]);o!=null&&c(t,["endTime"],o);const a=f(e,["metadata","updateTime"]);a!=null&&c(t,["updateTime"],a);const l=f(e,["metadata","model"]);l!=null&&c(t,["model"],l);const u=f(e,["metadata","output"]);return u!=null&&c(t,["dest"],xT(m1(u))),t}function wf(e){const t={},n=f(e,["name"]);n!=null&&c(t,["name"],n);const r=f(e,["displayName"]);r!=null&&c(t,["displayName"],r);const i=f(e,["state"]);i!=null&&c(t,["state"],g1(i));const s=f(e,["error"]);s!=null&&c(t,["error"],s);const o=f(e,["createTime"]);o!=null&&c(t,["createTime"],o);const a=f(e,["startTime"]);a!=null&&c(t,["startTime"],a);const l=f(e,["endTime"]);l!=null&&c(t,["endTime"],l);const u=f(e,["updateTime"]);u!=null&&c(t,["updateTime"],u);const d=f(e,["model"]);d!=null&&c(t,["model"],d);const h=f(e,["inputConfig"]);h!=null&&c(t,["src"],_T(h));const p=f(e,["outputConfig"]);p!=null&&c(t,["dest"],vT(m1(p)));const m=f(e,["completionStats"]);return m!=null&&c(t,["completionStats"],m),t}function _T(e){const t={},n=f(e,["instancesFormat"]);n!=null&&c(t,["format"],n);const r=f(e,["gcsSource","uris"]);r!=null&&c(t,["gcsUri"],r);const i=f(e,["bigquerySource","inputUri"]);return i!=null&&c(t,["bigqueryUri"],i),t}function TT(e,t){const n={};if(f(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(f(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=f(t,["fileName"]);r!=null&&c(n,["fileName"],r);const i=f(t,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>XT(e,o))),c(n,["requests","requests"],s)}return n}function ET(e){const t={},n=f(e,["format"]);n!=null&&c(t,["instancesFormat"],n);const r=f(e,["gcsUri"]);r!=null&&c(t,["gcsSource","uris"],r);const i=f(e,["bigqueryUri"]);if(i!=null&&c(t,["bigquerySource","inputUri"],i),f(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function ST(e){const t={},n=f(e,["data"]);if(n!=null&&c(t,["data"],n),f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=f(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function wT(e,t){const n={},r=f(t,["name"]);return r!=null&&c(n,["_url","name"],os(e,r)),n}function CT(e,t){const n={},r=f(t,["name"]);return r!=null&&c(n,["_url","name"],os(e,r)),n}function AT(e){const t={},n=f(e,["content"]);n!=null&&c(t,["content"],n);const r=f(e,["citationMetadata"]);r!=null&&c(t,["citationMetadata"],NT(r));const i=f(e,["tokenCount"]);i!=null&&c(t,["tokenCount"],i);const s=f(e,["finishReason"]);s!=null&&c(t,["finishReason"],s);const o=f(e,["avgLogprobs"]);o!=null&&c(t,["avgLogprobs"],o);const a=f(e,["groundingMetadata"]);a!=null&&c(t,["groundingMetadata"],a);const l=f(e,["index"]);l!=null&&c(t,["index"],l);const u=f(e,["logprobsResult"]);u!=null&&c(t,["logprobsResult"],u);const d=f(e,["safetyRatings"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(m=>m)),c(t,["safetyRatings"],p)}const h=f(e,["urlContextMetadata"]);return h!=null&&c(t,["urlContextMetadata"],h),t}function NT(e){const t={},n=f(e,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),c(t,["citations"],r)}return t}function x1(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>iE(s))),c(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&c(t,["role"],r),t}function IT(e,t){const n={},r=f(e,["displayName"]);if(t!==void 0&&r!=null&&c(t,["batch","displayName"],r),f(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function kT(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&c(t,["displayName"],r);const i=f(e,["dest"]);return t!==void 0&&i!=null&&c(t,["outputConfig"],yT(gT(i))),n}function Vh(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["src"]);i!=null&&c(n,["batch","inputConfig"],TT(e,p1(e,i)));const s=f(t,["config"]);return s!=null&&IT(s,n),n}function RT(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["model"],Le(e,r));const i=f(t,["src"]);i!=null&&c(n,["inputConfig"],ET(p1(e,i)));const s=f(t,["config"]);return s!=null&&kT(s,n),n}function PT(e,t){const n={},r=f(e,["displayName"]);return t!==void 0&&r!=null&&c(t,["batch","displayName"],r),n}function FT(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["src"]);i!=null&&c(n,["batch","inputConfig"],bT(e,i));const s=f(t,["config"]);return s!=null&&PT(s,n),n}function MT(e,t){const n={},r=f(t,["name"]);return r!=null&&c(n,["_url","name"],os(e,r)),n}function DT(e,t){const n={},r=f(t,["name"]);return r!=null&&c(n,["_url","name"],os(e,r)),n}function LT(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["name"]);r!=null&&c(t,["name"],r);const i=f(e,["done"]);i!=null&&c(t,["done"],i);const s=f(e,["error"]);return s!=null&&c(t,["error"],s),t}function UT(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["name"]);r!=null&&c(t,["name"],r);const i=f(e,["done"]);i!=null&&c(t,["done"],i);const s=f(e,["error"]);return s!=null&&c(t,["error"],s),t}function OT(e,t){const n={},r=f(t,["contents"]);if(r!=null){let s=Pc(e,r);Array.isArray(s)&&(s=s.map(o=>o)),c(n,["requests[]","request","content"],s)}const i=f(t,["config"]);return i!=null&&(c(n,["_self"],BT(i,n)),D_(n,{"requests[].*":"requests[].request.*"})),n}function BT(e,t){const n={},r=f(e,["taskType"]);t!==void 0&&r!=null&&c(t,["requests[]","taskType"],r);const i=f(e,["title"]);t!==void 0&&i!=null&&c(t,["requests[]","title"],i);const s=f(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&c(t,["requests[]","outputDimensionality"],s),f(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function bT(e,t){const n={},r=f(t,["fileName"]);r!=null&&c(n,["file_name"],r);const i=f(t,["inlinedRequests"]);return i!=null&&c(n,["requests"],OT(e,i)),n}function VT(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&c(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function GT(e){const t={},n=f(e,["id"]);n!=null&&c(t,["id"],n);const r=f(e,["args"]);r!=null&&c(t,["args"],r);const i=f(e,["name"]);if(i!=null&&c(t,["name"],i),f(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function HT(e){const t={},n=f(e,["mode"]);n!=null&&c(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);if(r!=null&&c(t,["allowedFunctionNames"],r),f(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function zT(e,t,n){const r={},i=f(t,["systemInstruction"]);n!==void 0&&i!=null&&c(n,["systemInstruction"],x1(Dt(i)));const s=f(t,["temperature"]);s!=null&&c(r,["temperature"],s);const o=f(t,["topP"]);o!=null&&c(r,["topP"],o);const a=f(t,["topK"]);a!=null&&c(r,["topK"],a);const l=f(t,["candidateCount"]);l!=null&&c(r,["candidateCount"],l);const u=f(t,["maxOutputTokens"]);u!=null&&c(r,["maxOutputTokens"],u);const d=f(t,["stopSequences"]);d!=null&&c(r,["stopSequences"],d);const h=f(t,["responseLogprobs"]);h!=null&&c(r,["responseLogprobs"],h);const p=f(t,["logprobs"]);p!=null&&c(r,["logprobs"],p);const m=f(t,["presencePenalty"]);m!=null&&c(r,["presencePenalty"],m);const y=f(t,["frequencyPenalty"]);y!=null&&c(r,["frequencyPenalty"],y);const x=f(t,["seed"]);x!=null&&c(r,["seed"],x);const E=f(t,["responseMimeType"]);E!=null&&c(r,["responseMimeType"],E);const T=f(t,["responseSchema"]);T!=null&&c(r,["responseSchema"],Fc(T));const _=f(t,["responseJsonSchema"]);if(_!=null&&c(r,["responseJsonSchema"],_),f(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const v=f(t,["safetySettings"]);if(n!==void 0&&v!=null){let H=v;Array.isArray(H)&&(H=H.map(Z=>sE(Z))),c(n,["safetySettings"],H)}const C=f(t,["tools"]);if(n!==void 0&&C!=null){let H=ss(C);Array.isArray(H)&&(H=H.map(Z=>aE(is(Z)))),c(n,["tools"],H)}const D=f(t,["toolConfig"]);if(n!==void 0&&D!=null&&c(n,["toolConfig"],oE(D)),f(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=f(t,["cachedContent"]);n!==void 0&&F!=null&&c(n,["cachedContent"],dr(e,F));const I=f(t,["responseModalities"]);I!=null&&c(r,["responseModalities"],I);const L=f(t,["mediaResolution"]);L!=null&&c(r,["mediaResolution"],L);const M=f(t,["speechConfig"]);if(M!=null&&c(r,["speechConfig"],Mc(M)),f(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const B=f(t,["thinkingConfig"]);B!=null&&c(r,["thinkingConfig"],B);const J=f(t,["imageConfig"]);return J!=null&&c(r,["imageConfig"],YT(J)),r}function WT(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>AT(u))),c(t,["candidates"],l)}const i=f(e,["modelVersion"]);i!=null&&c(t,["modelVersion"],i);const s=f(e,["promptFeedback"]);s!=null&&c(t,["promptFeedback"],s);const o=f(e,["responseId"]);o!=null&&c(t,["responseId"],o);const a=f(e,["usageMetadata"]);return a!=null&&c(t,["usageMetadata"],a),t}function qT(e,t){const n={},r=f(t,["name"]);return r!=null&&c(n,["_url","name"],os(e,r)),n}function $T(e,t){const n={},r=f(t,["name"]);return r!=null&&c(n,["_url","name"],os(e,r)),n}function JT(e){const t={};if(f(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=f(e,["enableWidget"]);return n!=null&&c(t,["enableWidget"],n),t}function KT(e){const t={};if(f(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=f(e,["timeRangeFilter"]);return n!=null&&c(t,["timeRangeFilter"],n),t}function YT(e){const t={},n=f(e,["aspectRatio"]);n!=null&&c(t,["aspectRatio"],n);const r=f(e,["imageSize"]);if(r!=null&&c(t,["imageSize"],r),f(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function XT(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["request","model"],Le(e,r));const i=f(t,["contents"]);if(i!=null){let a=xn(i);Array.isArray(a)&&(a=a.map(l=>x1(l))),c(n,["request","contents"],a)}const s=f(t,["metadata"]);s!=null&&c(n,["metadata"],s);const o=f(t,["config"]);return o!=null&&c(n,["request","generationConfig"],zT(e,o,f(n,["request"],{}))),n}function QT(e){const t={},n=f(e,["response"]);n!=null&&c(t,["response"],WT(n));const r=f(e,["error"]);return r!=null&&c(t,["error"],r),t}function jT(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&c(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);if(t!==void 0&&i!=null&&c(t,["_query","pageToken"],i),f(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function ZT(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&c(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);t!==void 0&&i!=null&&c(t,["_query","pageToken"],i);const s=f(e,["filter"]);return t!==void 0&&s!=null&&c(t,["_query","filter"],s),n}function eE(e){const t={},n=f(e,["config"]);return n!=null&&jT(n,t),t}function tE(e){const t={},n=f(e,["config"]);return n!=null&&ZT(n,t),t}function nE(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=f(e,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>ya(o))),c(t,["batchJobs"],s)}return t}function rE(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=f(e,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>wf(o))),c(t,["batchJobs"],s)}return t}function iE(e){const t={},n=f(e,["mediaResolution"]);n!=null&&c(t,["mediaResolution"],n);const r=f(e,["codeExecutionResult"]);r!=null&&c(t,["codeExecutionResult"],r);const i=f(e,["executableCode"]);i!=null&&c(t,["executableCode"],i);const s=f(e,["fileData"]);s!=null&&c(t,["fileData"],VT(s));const o=f(e,["functionCall"]);o!=null&&c(t,["functionCall"],GT(o));const a=f(e,["functionResponse"]);a!=null&&c(t,["functionResponse"],a);const l=f(e,["inlineData"]);l!=null&&c(t,["inlineData"],ST(l));const u=f(e,["text"]);u!=null&&c(t,["text"],u);const d=f(e,["thought"]);d!=null&&c(t,["thought"],d);const h=f(e,["thoughtSignature"]);h!=null&&c(t,["thoughtSignature"],h);const p=f(e,["videoMetadata"]);return p!=null&&c(t,["videoMetadata"],p),t}function sE(e){const t={},n=f(e,["category"]);if(n!=null&&c(t,["category"],n),f(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=f(e,["threshold"]);return r!=null&&c(t,["threshold"],r),t}function oE(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&c(t,["functionCallingConfig"],HT(n));const r=f(e,["retrievalConfig"]);return r!=null&&c(t,["retrievalConfig"],r),t}function aE(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>h)),c(t,["functionDeclarations"],d)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearchRetrieval"]);r!=null&&c(t,["googleSearchRetrieval"],r);const i=f(e,["computerUse"]);i!=null&&c(t,["computerUse"],i);const s=f(e,["fileSearch"]);s!=null&&c(t,["fileSearch"],s);const o=f(e,["codeExecution"]);if(o!=null&&c(t,["codeExecution"],o),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=f(e,["googleMaps"]);a!=null&&c(t,["googleMaps"],JT(a));const l=f(e,["googleSearch"]);l!=null&&c(t,["googleSearch"],KT(l));const u=f(e,["urlContext"]);return u!=null&&c(t,["urlContext"],u),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ar;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"})(ar||(ar={}));class ui{constructor(t,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,r,i)}init(t,n,r){var i,s;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lE extends cr{constructor(t){super(),this.apiClient=t,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new ui(ar.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(t){const n=Vh(this.apiClient,t),r=n._url,i=fe("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const d of l){const h=Object.assign({},d);if(h.systemInstruction){const p=h.systemInstruction;delete h.systemInstruction;const m=h.request;m.systemInstruction=p,h.request=m}u.push(h)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(t){if(typeof t=="string")return t.startsWith("gs://")?t:void 0;if(!Array.isArray(t)&&t.gcsUri&&t.gcsUri.length>0)return t.gcsUri[0]}getBigqueryUri(t){if(typeof t=="string")return t.startsWith("bq://")?t:void 0;if(!Array.isArray(t))return t.bigqueryUri}formatDestination(t,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(t),o=this.getBigqueryUri(t);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=RT(this.apiClient,t);return a=fe("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>wf(d))}else{const u=Vh(this.apiClient,t);return a=fe("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>ya(d))}}async createEmbeddingsInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=FT(this.apiClient,t);return s=fe("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>ya(l))}}async get(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=$T(this.apiClient,t);return a=fe("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>wf(d))}else{const u=qT(this.apiClient,t);return a=fe("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>ya(d))}}async cancel(t){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=CT(this.apiClient,t);o=fe("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=wT(this.apiClient,t);o=fe("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=tE(t);return a=fe("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=rE(d),p=new Uh;return Object.assign(p,h),p})}else{const u=eE(t);return a=fe("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=nE(d),p=new Uh;return Object.assign(p,h),p})}}async delete(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=DT(this.apiClient,t);return a=fe("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>UT(d))}else{const u=MT(this.apiClient,t);return a=fe("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>LT(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uE(e){const t={},n=f(e,["data"]);if(n!=null&&c(t,["data"],n),f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=f(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function Gh(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>FE(s))),c(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&c(t,["role"],r),t}function fE(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&c(t,["ttl"],r);const i=f(e,["expireTime"]);t!==void 0&&i!=null&&c(t,["expireTime"],i);const s=f(e,["displayName"]);t!==void 0&&s!=null&&c(t,["displayName"],s);const o=f(e,["contents"]);if(t!==void 0&&o!=null){let d=xn(o);Array.isArray(d)&&(d=d.map(h=>Gh(h))),c(t,["contents"],d)}const a=f(e,["systemInstruction"]);t!==void 0&&a!=null&&c(t,["systemInstruction"],Gh(Dt(a)));const l=f(e,["tools"]);if(t!==void 0&&l!=null){let d=l;Array.isArray(d)&&(d=d.map(h=>DE(h))),c(t,["tools"],d)}const u=f(e,["toolConfig"]);if(t!==void 0&&u!=null&&c(t,["toolConfig"],ME(u)),f(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function cE(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&c(t,["ttl"],r);const i=f(e,["expireTime"]);t!==void 0&&i!=null&&c(t,["expireTime"],i);const s=f(e,["displayName"]);t!==void 0&&s!=null&&c(t,["displayName"],s);const o=f(e,["contents"]);if(t!==void 0&&o!=null){let h=xn(o);Array.isArray(h)&&(h=h.map(p=>p)),c(t,["contents"],h)}const a=f(e,["systemInstruction"]);t!==void 0&&a!=null&&c(t,["systemInstruction"],Dt(a));const l=f(e,["tools"]);if(t!==void 0&&l!=null){let h=l;Array.isArray(h)&&(h=h.map(p=>LE(p))),c(t,["tools"],h)}const u=f(e,["toolConfig"]);t!==void 0&&u!=null&&c(t,["toolConfig"],u);const d=f(e,["kmsKeyName"]);return t!==void 0&&d!=null&&c(t,["encryption_spec","kmsKeyName"],d),n}function dE(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["model"],s1(e,r));const i=f(t,["config"]);return i!=null&&fE(i,n),n}function hE(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["model"],s1(e,r));const i=f(t,["config"]);return i!=null&&cE(i,n),n}function pE(e,t){const n={},r=f(t,["name"]);return r!=null&&c(n,["_url","name"],dr(e,r)),n}function mE(e,t){const n={},r=f(t,["name"]);return r!=null&&c(n,["_url","name"],dr(e,r)),n}function gE(e){const t={},n=f(e,["sdkHttpResponse"]);return n!=null&&c(t,["sdkHttpResponse"],n),t}function xE(e){const t={},n=f(e,["sdkHttpResponse"]);return n!=null&&c(t,["sdkHttpResponse"],n),t}function vE(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&c(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function yE(e){const t={},n=f(e,["id"]);n!=null&&c(t,["id"],n);const r=f(e,["args"]);r!=null&&c(t,["args"],r);const i=f(e,["name"]);if(i!=null&&c(t,["name"],i),f(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function _E(e){const t={},n=f(e,["mode"]);n!=null&&c(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);if(r!=null&&c(t,["allowedFunctionNames"],r),f(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function TE(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&c(t,["description"],n);const r=f(e,["name"]);r!=null&&c(t,["name"],r);const i=f(e,["parameters"]);i!=null&&c(t,["parameters"],i);const s=f(e,["parametersJsonSchema"]);s!=null&&c(t,["parametersJsonSchema"],s);const o=f(e,["response"]);o!=null&&c(t,["response"],o);const a=f(e,["responseJsonSchema"]);return a!=null&&c(t,["responseJsonSchema"],a),t}function EE(e,t){const n={},r=f(t,["name"]);return r!=null&&c(n,["_url","name"],dr(e,r)),n}function SE(e,t){const n={},r=f(t,["name"]);return r!=null&&c(n,["_url","name"],dr(e,r)),n}function wE(e){const t={};if(f(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=f(e,["enableWidget"]);return n!=null&&c(t,["enableWidget"],n),t}function CE(e){const t={};if(f(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=f(e,["timeRangeFilter"]);return n!=null&&c(t,["timeRangeFilter"],n),t}function AE(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&c(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);return t!==void 0&&i!=null&&c(t,["_query","pageToken"],i),n}function NE(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&c(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);return t!==void 0&&i!=null&&c(t,["_query","pageToken"],i),n}function IE(e){const t={},n=f(e,["config"]);return n!=null&&AE(n,t),t}function kE(e){const t={},n=f(e,["config"]);return n!=null&&NE(n,t),t}function RE(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=f(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),c(t,["cachedContents"],s)}return t}function PE(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=f(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),c(t,["cachedContents"],s)}return t}function FE(e){const t={},n=f(e,["mediaResolution"]);n!=null&&c(t,["mediaResolution"],n);const r=f(e,["codeExecutionResult"]);r!=null&&c(t,["codeExecutionResult"],r);const i=f(e,["executableCode"]);i!=null&&c(t,["executableCode"],i);const s=f(e,["fileData"]);s!=null&&c(t,["fileData"],vE(s));const o=f(e,["functionCall"]);o!=null&&c(t,["functionCall"],yE(o));const a=f(e,["functionResponse"]);a!=null&&c(t,["functionResponse"],a);const l=f(e,["inlineData"]);l!=null&&c(t,["inlineData"],uE(l));const u=f(e,["text"]);u!=null&&c(t,["text"],u);const d=f(e,["thought"]);d!=null&&c(t,["thought"],d);const h=f(e,["thoughtSignature"]);h!=null&&c(t,["thoughtSignature"],h);const p=f(e,["videoMetadata"]);return p!=null&&c(t,["videoMetadata"],p),t}function ME(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&c(t,["functionCallingConfig"],_E(n));const r=f(e,["retrievalConfig"]);return r!=null&&c(t,["retrievalConfig"],r),t}function DE(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>h)),c(t,["functionDeclarations"],d)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearchRetrieval"]);r!=null&&c(t,["googleSearchRetrieval"],r);const i=f(e,["computerUse"]);i!=null&&c(t,["computerUse"],i);const s=f(e,["fileSearch"]);s!=null&&c(t,["fileSearch"],s);const o=f(e,["codeExecution"]);if(o!=null&&c(t,["codeExecution"],o),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=f(e,["googleMaps"]);a!=null&&c(t,["googleMaps"],wE(a));const l=f(e,["googleSearch"]);l!=null&&c(t,["googleSearch"],CE(l));const u=f(e,["urlContext"]);return u!=null&&c(t,["urlContext"],u),t}function LE(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>TE(p))),c(t,["functionDeclarations"],h)}const r=f(e,["retrieval"]);r!=null&&c(t,["retrieval"],r);const i=f(e,["googleSearchRetrieval"]);i!=null&&c(t,["googleSearchRetrieval"],i);const s=f(e,["computerUse"]);if(s!=null&&c(t,["computerUse"],s),f(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=f(e,["codeExecution"]);o!=null&&c(t,["codeExecution"],o);const a=f(e,["enterpriseWebSearch"]);a!=null&&c(t,["enterpriseWebSearch"],a);const l=f(e,["googleMaps"]);l!=null&&c(t,["googleMaps"],l);const u=f(e,["googleSearch"]);u!=null&&c(t,["googleSearch"],u);const d=f(e,["urlContext"]);return d!=null&&c(t,["urlContext"],d),t}function UE(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&c(t,["ttl"],r);const i=f(e,["expireTime"]);return t!==void 0&&i!=null&&c(t,["expireTime"],i),n}function OE(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&c(t,["ttl"],r);const i=f(e,["expireTime"]);return t!==void 0&&i!=null&&c(t,["expireTime"],i),n}function BE(e,t){const n={},r=f(t,["name"]);r!=null&&c(n,["_url","name"],dr(e,r));const i=f(t,["config"]);return i!=null&&UE(i,n),n}function bE(e,t){const n={},r=f(t,["name"]);r!=null&&c(n,["_url","name"],dr(e,r));const i=f(t,["config"]);return i!=null&&OE(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class VE extends cr{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new ui(ar.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=hE(this.apiClient,t);return a=fe("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>d)}else{const u=dE(this.apiClient,t);return a=fe("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>d)}}async get(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=SE(this.apiClient,t);return a=fe("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>d)}else{const u=EE(this.apiClient,t);return a=fe("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>d)}}async delete(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=mE(this.apiClient,t);return a=fe("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=xE(d),p=new Dh;return Object.assign(p,h),p})}else{const u=pE(this.apiClient,t);return a=fe("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=gE(d),p=new Dh;return Object.assign(p,h),p})}}async update(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=bE(this.apiClient,t);return a=fe("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>d)}else{const u=BE(this.apiClient,t);return a=fe("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>d)}}async listInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=kE(t);return a=fe("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=PE(d),p=new Lh;return Object.assign(p,h),p})}else{const u=IE(t);return a=fe("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=RE(d),p=new Lh;return Object.assign(p,h),p})}}}function Hh(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function $e(e){return this instanceof $e?(this.v=e,this):new $e(e)}function Gi(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(m){return function(y){return Promise.resolve(y).then(m,h)}}function a(m,y){r[m]&&(i[m]=function(x){return new Promise(function(E,T){s.push([m,x,E,T])>1||l(m,x)})},y&&(i[m]=y(i[m])))}function l(m,y){try{u(r[m](y))}catch(x){p(s[0][3],x)}}function u(m){m.value instanceof $e?Promise.resolve(m.value.v).then(d,h):p(s[0][2],m)}function d(m){l("next",m)}function h(m){l("throw",m)}function p(m,y){m(y),s.shift(),s.length&&l(s[0][0],s[0][1])}}function zs(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Hh=="function"?Hh(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(o){return new Promise(function(a,l){o=e[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function GE(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:v1(n)}function v1(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0)return!1;return!0}function HE(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function zh(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let r=0;for(;r<n;)if(e[r].role==="user")t.push(e[r]),r++;else{const i=[];let s=!0;for(;r<n&&e[r].role==="model";)i.push(e[r]),s&&!v1(e[r])&&(s=!1),r++;s?t.push(...i):t.pop()}return t}class zE{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new WE(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class WE{constructor(t,n,r,i={},s=[]){this.apiClient=t,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),HE(s)}async sendMessage(t){var n;await this.sendPromise;const r=Dt(t.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const l=await i,u=(o=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,d=l.automaticFunctionCallingHistory,h=this.getHistory(!0).length;let p=[];d!=null&&(p=(a=d.slice(h))!==null&&a!==void 0?a:[]);const m=u?[u]:[];this.recordHistory(r,m,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(t){var n;await this.sendPromise;const r=Dt(t.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(t=!1){const n=t?zh(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){var r,i;return Gi(this,arguments,function*(){var o,a,l,u;const d=[];try{for(var h=!0,p=zs(t),m;m=yield $e(p.next()),o=m.done,!o;h=!0){u=m.value,h=!1;const y=u;if(GE(y)){const x=(i=(r=y.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;x!==void 0&&d.push(x)}yield yield $e(y)}}catch(y){a={error:y}}finally{try{!h&&!o&&(l=p.return)&&(yield $e(l.call(p)))}finally{if(a)throw a.error}}this.recordHistory(n,d)})}recordHistory(t,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...zh(r)):this.history.push(t),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Nl extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,Nl.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qE(e){const t={},n=f(e,["file"]);return n!=null&&c(t,["file"],n),t}function $E(e){const t={},n=f(e,["sdkHttpResponse"]);return n!=null&&c(t,["sdkHttpResponse"],n),t}function JE(e){const t={},n=f(e,["name"]);return n!=null&&c(t,["_url","file"],c1(n)),t}function KE(e){const t={},n=f(e,["sdkHttpResponse"]);return n!=null&&c(t,["sdkHttpResponse"],n),t}function YE(e){const t={},n=f(e,["name"]);return n!=null&&c(t,["_url","file"],c1(n)),t}function XE(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&c(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);return t!==void 0&&i!=null&&c(t,["_query","pageToken"],i),n}function QE(e){const t={},n=f(e,["config"]);return n!=null&&XE(n,t),t}function jE(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=f(e,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),c(t,["files"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ZE extends cr{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new ui(ar.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>n)}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=QE(t);return s=fe("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const u=jE(l),d=new rT;return Object.assign(d,u),d})}}async createInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=qE(t);return s=fe("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=$E(l),d=new iT;return Object.assign(d,u),d})}}async get(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=YE(t);return s=fe("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=JE(t);return s=fe("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const u=KE(l),d=new sT;return Object.assign(d,u),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _a(e){const t={},n=f(e,["data"]);if(n!=null&&c(t,["data"],n),f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=f(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function eS(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>gS(s))),c(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&c(t,["role"],r),t}function tS(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&c(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function nS(e){const t={},n=f(e,["id"]);n!=null&&c(t,["id"],n);const r=f(e,["args"]);r!=null&&c(t,["args"],r);const i=f(e,["name"]);if(i!=null&&c(t,["name"],i),f(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function rS(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&c(t,["description"],n);const r=f(e,["name"]);r!=null&&c(t,["name"],r);const i=f(e,["parameters"]);i!=null&&c(t,["parameters"],i);const s=f(e,["parametersJsonSchema"]);s!=null&&c(t,["parametersJsonSchema"],s);const o=f(e,["response"]);o!=null&&c(t,["response"],o);const a=f(e,["responseJsonSchema"]);return a!=null&&c(t,["responseJsonSchema"],a),t}function iS(e){const t={},n=f(e,["modelSelectionConfig"]);n!=null&&c(t,["modelConfig"],n);const r=f(e,["responseJsonSchema"]);r!=null&&c(t,["responseJsonSchema"],r);const i=f(e,["audioTimestamp"]);i!=null&&c(t,["audioTimestamp"],i);const s=f(e,["candidateCount"]);s!=null&&c(t,["candidateCount"],s);const o=f(e,["enableAffectiveDialog"]);o!=null&&c(t,["enableAffectiveDialog"],o);const a=f(e,["frequencyPenalty"]);a!=null&&c(t,["frequencyPenalty"],a);const l=f(e,["logprobs"]);l!=null&&c(t,["logprobs"],l);const u=f(e,["maxOutputTokens"]);u!=null&&c(t,["maxOutputTokens"],u);const d=f(e,["mediaResolution"]);d!=null&&c(t,["mediaResolution"],d);const h=f(e,["presencePenalty"]);h!=null&&c(t,["presencePenalty"],h);const p=f(e,["responseLogprobs"]);p!=null&&c(t,["responseLogprobs"],p);const m=f(e,["responseMimeType"]);m!=null&&c(t,["responseMimeType"],m);const y=f(e,["responseModalities"]);y!=null&&c(t,["responseModalities"],y);const x=f(e,["responseSchema"]);x!=null&&c(t,["responseSchema"],x);const E=f(e,["routingConfig"]);E!=null&&c(t,["routingConfig"],E);const T=f(e,["seed"]);T!=null&&c(t,["seed"],T);const _=f(e,["speechConfig"]);_!=null&&c(t,["speechConfig"],y1(_));const v=f(e,["stopSequences"]);v!=null&&c(t,["stopSequences"],v);const C=f(e,["temperature"]);C!=null&&c(t,["temperature"],C);const D=f(e,["thinkingConfig"]);D!=null&&c(t,["thinkingConfig"],D);const F=f(e,["topK"]);F!=null&&c(t,["topK"],F);const I=f(e,["topP"]);if(I!=null&&c(t,["topP"],I),f(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function sS(e){const t={};if(f(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=f(e,["enableWidget"]);return n!=null&&c(t,["enableWidget"],n),t}function oS(e){const t={};if(f(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=f(e,["timeRangeFilter"]);return n!=null&&c(t,["timeRangeFilter"],n),t}function aS(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&c(t,["setup","generationConfig"],r);const i=f(e,["responseModalities"]);t!==void 0&&i!=null&&c(t,["setup","generationConfig","responseModalities"],i);const s=f(e,["temperature"]);t!==void 0&&s!=null&&c(t,["setup","generationConfig","temperature"],s);const o=f(e,["topP"]);t!==void 0&&o!=null&&c(t,["setup","generationConfig","topP"],o);const a=f(e,["topK"]);t!==void 0&&a!=null&&c(t,["setup","generationConfig","topK"],a);const l=f(e,["maxOutputTokens"]);t!==void 0&&l!=null&&c(t,["setup","generationConfig","maxOutputTokens"],l);const u=f(e,["mediaResolution"]);t!==void 0&&u!=null&&c(t,["setup","generationConfig","mediaResolution"],u);const d=f(e,["seed"]);t!==void 0&&d!=null&&c(t,["setup","generationConfig","seed"],d);const h=f(e,["speechConfig"]);t!==void 0&&h!=null&&c(t,["setup","generationConfig","speechConfig"],Dc(h));const p=f(e,["thinkingConfig"]);t!==void 0&&p!=null&&c(t,["setup","generationConfig","thinkingConfig"],p);const m=f(e,["enableAffectiveDialog"]);t!==void 0&&m!=null&&c(t,["setup","generationConfig","enableAffectiveDialog"],m);const y=f(e,["systemInstruction"]);t!==void 0&&y!=null&&c(t,["setup","systemInstruction"],eS(Dt(y)));const x=f(e,["tools"]);if(t!==void 0&&x!=null){let F=ss(x);Array.isArray(F)&&(F=F.map(I=>vS(is(I)))),c(t,["setup","tools"],F)}const E=f(e,["sessionResumption"]);t!==void 0&&E!=null&&c(t,["setup","sessionResumption"],xS(E));const T=f(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&c(t,["setup","inputAudioTranscription"],T);const _=f(e,["outputAudioTranscription"]);t!==void 0&&_!=null&&c(t,["setup","outputAudioTranscription"],_);const v=f(e,["realtimeInputConfig"]);t!==void 0&&v!=null&&c(t,["setup","realtimeInputConfig"],v);const C=f(e,["contextWindowCompression"]);t!==void 0&&C!=null&&c(t,["setup","contextWindowCompression"],C);const D=f(e,["proactivity"]);return t!==void 0&&D!=null&&c(t,["setup","proactivity"],D),n}function lS(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&c(t,["setup","generationConfig"],iS(r));const i=f(e,["responseModalities"]);t!==void 0&&i!=null&&c(t,["setup","generationConfig","responseModalities"],i);const s=f(e,["temperature"]);t!==void 0&&s!=null&&c(t,["setup","generationConfig","temperature"],s);const o=f(e,["topP"]);t!==void 0&&o!=null&&c(t,["setup","generationConfig","topP"],o);const a=f(e,["topK"]);t!==void 0&&a!=null&&c(t,["setup","generationConfig","topK"],a);const l=f(e,["maxOutputTokens"]);t!==void 0&&l!=null&&c(t,["setup","generationConfig","maxOutputTokens"],l);const u=f(e,["mediaResolution"]);t!==void 0&&u!=null&&c(t,["setup","generationConfig","mediaResolution"],u);const d=f(e,["seed"]);t!==void 0&&d!=null&&c(t,["setup","generationConfig","seed"],d);const h=f(e,["speechConfig"]);t!==void 0&&h!=null&&c(t,["setup","generationConfig","speechConfig"],y1(Dc(h)));const p=f(e,["thinkingConfig"]);t!==void 0&&p!=null&&c(t,["setup","generationConfig","thinkingConfig"],p);const m=f(e,["enableAffectiveDialog"]);t!==void 0&&m!=null&&c(t,["setup","generationConfig","enableAffectiveDialog"],m);const y=f(e,["systemInstruction"]);t!==void 0&&y!=null&&c(t,["setup","systemInstruction"],Dt(y));const x=f(e,["tools"]);if(t!==void 0&&x!=null){let F=ss(x);Array.isArray(F)&&(F=F.map(I=>yS(is(I)))),c(t,["setup","tools"],F)}const E=f(e,["sessionResumption"]);t!==void 0&&E!=null&&c(t,["setup","sessionResumption"],E);const T=f(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&c(t,["setup","inputAudioTranscription"],T);const _=f(e,["outputAudioTranscription"]);t!==void 0&&_!=null&&c(t,["setup","outputAudioTranscription"],_);const v=f(e,["realtimeInputConfig"]);t!==void 0&&v!=null&&c(t,["setup","realtimeInputConfig"],v);const C=f(e,["contextWindowCompression"]);t!==void 0&&C!=null&&c(t,["setup","contextWindowCompression"],C);const D=f(e,["proactivity"]);return t!==void 0&&D!=null&&c(t,["setup","proactivity"],D),n}function uS(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["setup","model"],Le(e,r));const i=f(t,["config"]);return i!=null&&c(n,["config"],aS(i,n)),n}function fS(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["setup","model"],Le(e,r));const i=f(t,["config"]);return i!=null&&c(n,["config"],lS(i,n)),n}function cS(e){const t={},n=f(e,["musicGenerationConfig"]);return n!=null&&c(t,["musicGenerationConfig"],n),t}function dS(e){const t={},n=f(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),c(t,["weightedPrompts"],r)}return t}function hS(e){const t={},n=f(e,["media"]);if(n!=null){let u=o1(n);Array.isArray(u)&&(u=u.map(d=>_a(d))),c(t,["mediaChunks"],u)}const r=f(e,["audio"]);r!=null&&c(t,["audio"],_a(l1(r)));const i=f(e,["audioStreamEnd"]);i!=null&&c(t,["audioStreamEnd"],i);const s=f(e,["video"]);s!=null&&c(t,["video"],_a(a1(s)));const o=f(e,["text"]);o!=null&&c(t,["text"],o);const a=f(e,["activityStart"]);a!=null&&c(t,["activityStart"],a);const l=f(e,["activityEnd"]);return l!=null&&c(t,["activityEnd"],l),t}function pS(e){const t={},n=f(e,["media"]);if(n!=null){let u=o1(n);Array.isArray(u)&&(u=u.map(d=>d)),c(t,["mediaChunks"],u)}const r=f(e,["audio"]);r!=null&&c(t,["audio"],l1(r));const i=f(e,["audioStreamEnd"]);i!=null&&c(t,["audioStreamEnd"],i);const s=f(e,["video"]);s!=null&&c(t,["video"],a1(s));const o=f(e,["text"]);o!=null&&c(t,["text"],o);const a=f(e,["activityStart"]);a!=null&&c(t,["activityStart"],a);const l=f(e,["activityEnd"]);return l!=null&&c(t,["activityEnd"],l),t}function mS(e){const t={},n=f(e,["setupComplete"]);n!=null&&c(t,["setupComplete"],n);const r=f(e,["serverContent"]);r!=null&&c(t,["serverContent"],r);const i=f(e,["toolCall"]);i!=null&&c(t,["toolCall"],i);const s=f(e,["toolCallCancellation"]);s!=null&&c(t,["toolCallCancellation"],s);const o=f(e,["usageMetadata"]);o!=null&&c(t,["usageMetadata"],_S(o));const a=f(e,["goAway"]);a!=null&&c(t,["goAway"],a);const l=f(e,["sessionResumptionUpdate"]);return l!=null&&c(t,["sessionResumptionUpdate"],l),t}function gS(e){const t={},n=f(e,["mediaResolution"]);n!=null&&c(t,["mediaResolution"],n);const r=f(e,["codeExecutionResult"]);r!=null&&c(t,["codeExecutionResult"],r);const i=f(e,["executableCode"]);i!=null&&c(t,["executableCode"],i);const s=f(e,["fileData"]);s!=null&&c(t,["fileData"],tS(s));const o=f(e,["functionCall"]);o!=null&&c(t,["functionCall"],nS(o));const a=f(e,["functionResponse"]);a!=null&&c(t,["functionResponse"],a);const l=f(e,["inlineData"]);l!=null&&c(t,["inlineData"],_a(l));const u=f(e,["text"]);u!=null&&c(t,["text"],u);const d=f(e,["thought"]);d!=null&&c(t,["thought"],d);const h=f(e,["thoughtSignature"]);h!=null&&c(t,["thoughtSignature"],h);const p=f(e,["videoMetadata"]);return p!=null&&c(t,["videoMetadata"],p),t}function xS(e){const t={},n=f(e,["handle"]);if(n!=null&&c(t,["handle"],n),f(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function y1(e){const t={},n=f(e,["languageCode"]);n!=null&&c(t,["languageCode"],n);const r=f(e,["voiceConfig"]);if(r!=null&&c(t,["voiceConfig"],r),f(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function vS(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>h)),c(t,["functionDeclarations"],d)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearchRetrieval"]);r!=null&&c(t,["googleSearchRetrieval"],r);const i=f(e,["computerUse"]);i!=null&&c(t,["computerUse"],i);const s=f(e,["fileSearch"]);s!=null&&c(t,["fileSearch"],s);const o=f(e,["codeExecution"]);if(o!=null&&c(t,["codeExecution"],o),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=f(e,["googleMaps"]);a!=null&&c(t,["googleMaps"],sS(a));const l=f(e,["googleSearch"]);l!=null&&c(t,["googleSearch"],oS(l));const u=f(e,["urlContext"]);return u!=null&&c(t,["urlContext"],u),t}function yS(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>rS(p))),c(t,["functionDeclarations"],h)}const r=f(e,["retrieval"]);r!=null&&c(t,["retrieval"],r);const i=f(e,["googleSearchRetrieval"]);i!=null&&c(t,["googleSearchRetrieval"],i);const s=f(e,["computerUse"]);if(s!=null&&c(t,["computerUse"],s),f(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=f(e,["codeExecution"]);o!=null&&c(t,["codeExecution"],o);const a=f(e,["enterpriseWebSearch"]);a!=null&&c(t,["enterpriseWebSearch"],a);const l=f(e,["googleMaps"]);l!=null&&c(t,["googleMaps"],l);const u=f(e,["googleSearch"]);u!=null&&c(t,["googleSearch"],u);const d=f(e,["urlContext"]);return d!=null&&c(t,["urlContext"],d),t}function _S(e){const t={},n=f(e,["promptTokenCount"]);n!=null&&c(t,["promptTokenCount"],n);const r=f(e,["cachedContentTokenCount"]);r!=null&&c(t,["cachedContentTokenCount"],r);const i=f(e,["candidatesTokenCount"]);i!=null&&c(t,["responseTokenCount"],i);const s=f(e,["toolUsePromptTokenCount"]);s!=null&&c(t,["toolUsePromptTokenCount"],s);const o=f(e,["thoughtsTokenCount"]);o!=null&&c(t,["thoughtsTokenCount"],o);const a=f(e,["totalTokenCount"]);a!=null&&c(t,["totalTokenCount"],a);const l=f(e,["promptTokensDetails"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(y=>y)),c(t,["promptTokensDetails"],m)}const u=f(e,["cacheTokensDetails"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(y=>y)),c(t,["cacheTokensDetails"],m)}const d=f(e,["candidatesTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(y=>y)),c(t,["responseTokensDetails"],m)}const h=f(e,["toolUsePromptTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(y=>y)),c(t,["toolUsePromptTokensDetails"],m)}const p=f(e,["trafficType"]);return p!=null&&c(t,["trafficType"],p),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function TS(e){const t={},n=f(e,["data"]);if(n!=null&&c(t,["data"],n),f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=f(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function ES(e){const t={},n=f(e,["content"]);n!=null&&c(t,["content"],n);const r=f(e,["citationMetadata"]);r!=null&&c(t,["citationMetadata"],SS(r));const i=f(e,["tokenCount"]);i!=null&&c(t,["tokenCount"],i);const s=f(e,["finishReason"]);s!=null&&c(t,["finishReason"],s);const o=f(e,["avgLogprobs"]);o!=null&&c(t,["avgLogprobs"],o);const a=f(e,["groundingMetadata"]);a!=null&&c(t,["groundingMetadata"],a);const l=f(e,["index"]);l!=null&&c(t,["index"],l);const u=f(e,["logprobsResult"]);u!=null&&c(t,["logprobsResult"],u);const d=f(e,["safetyRatings"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(m=>m)),c(t,["safetyRatings"],p)}const h=f(e,["urlContextMetadata"]);return h!=null&&c(t,["urlContextMetadata"],h),t}function SS(e){const t={},n=f(e,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),c(t,["citations"],r)}return t}function wS(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["contents"]);if(i!=null){let s=xn(i);Array.isArray(s)&&(s=s.map(o=>o)),c(n,["contents"],s)}return n}function CS(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),c(t,["tokensInfo"],i)}return t}function AS(e){const t={},n=f(e,["values"]);n!=null&&c(t,["values"],n);const r=f(e,["statistics"]);return r!=null&&c(t,["statistics"],NS(r)),t}function NS(e){const t={},n=f(e,["truncated"]);n!=null&&c(t,["truncated"],n);const r=f(e,["token_count"]);return r!=null&&c(t,["tokenCount"],r),t}function Il(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Uw(s))),c(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&c(t,["role"],r),t}function IS(e){const t={},n=f(e,["controlType"]);n!=null&&c(t,["controlType"],n);const r=f(e,["enableControlImageComputation"]);return r!=null&&c(t,["computeControl"],r),t}function kS(e){const t={};if(f(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(f(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(f(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function RS(e,t){const n={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&c(t,["systemInstruction"],Dt(r));const i=f(e,["tools"]);if(t!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>w1(a))),c(t,["tools"],o)}const s=f(e,["generationConfig"]);return t!==void 0&&s!=null&&c(t,["generationConfig"],Tw(s)),n}function PS(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["contents"]);if(i!=null){let o=xn(i);Array.isArray(o)&&(o=o.map(a=>Il(a))),c(n,["contents"],o)}const s=f(t,["config"]);return s!=null&&kS(s),n}function FS(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["contents"]);if(i!=null){let o=xn(i);Array.isArray(o)&&(o=o.map(a=>a)),c(n,["contents"],o)}const s=f(t,["config"]);return s!=null&&RS(s,n),n}function MS(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["totalTokens"]);r!=null&&c(t,["totalTokens"],r);const i=f(e,["cachedContentTokenCount"]);return i!=null&&c(t,["cachedContentTokenCount"],i),t}function DS(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["totalTokens"]);return r!=null&&c(t,["totalTokens"],r),t}function LS(e,t){const n={},r=f(t,["model"]);return r!=null&&c(n,["_url","name"],Le(e,r)),n}function US(e,t){const n={},r=f(t,["model"]);return r!=null&&c(n,["_url","name"],Le(e,r)),n}function OS(e){const t={},n=f(e,["sdkHttpResponse"]);return n!=null&&c(t,["sdkHttpResponse"],n),t}function BS(e){const t={},n=f(e,["sdkHttpResponse"]);return n!=null&&c(t,["sdkHttpResponse"],n),t}function bS(e,t){const n={},r=f(e,["outputGcsUri"]);t!==void 0&&r!=null&&c(t,["parameters","storageUri"],r);const i=f(e,["negativePrompt"]);t!==void 0&&i!=null&&c(t,["parameters","negativePrompt"],i);const s=f(e,["numberOfImages"]);t!==void 0&&s!=null&&c(t,["parameters","sampleCount"],s);const o=f(e,["aspectRatio"]);t!==void 0&&o!=null&&c(t,["parameters","aspectRatio"],o);const a=f(e,["guidanceScale"]);t!==void 0&&a!=null&&c(t,["parameters","guidanceScale"],a);const l=f(e,["seed"]);t!==void 0&&l!=null&&c(t,["parameters","seed"],l);const u=f(e,["safetyFilterLevel"]);t!==void 0&&u!=null&&c(t,["parameters","safetySetting"],u);const d=f(e,["personGeneration"]);t!==void 0&&d!=null&&c(t,["parameters","personGeneration"],d);const h=f(e,["includeSafetyAttributes"]);t!==void 0&&h!=null&&c(t,["parameters","includeSafetyAttributes"],h);const p=f(e,["includeRaiReason"]);t!==void 0&&p!=null&&c(t,["parameters","includeRaiReason"],p);const m=f(e,["language"]);t!==void 0&&m!=null&&c(t,["parameters","language"],m);const y=f(e,["outputMimeType"]);t!==void 0&&y!=null&&c(t,["parameters","outputOptions","mimeType"],y);const x=f(e,["outputCompressionQuality"]);t!==void 0&&x!=null&&c(t,["parameters","outputOptions","compressionQuality"],x);const E=f(e,["addWatermark"]);t!==void 0&&E!=null&&c(t,["parameters","addWatermark"],E);const T=f(e,["labels"]);t!==void 0&&T!=null&&c(t,["labels"],T);const _=f(e,["editMode"]);t!==void 0&&_!=null&&c(t,["parameters","editMode"],_);const v=f(e,["baseSteps"]);return t!==void 0&&v!=null&&c(t,["parameters","editConfig","baseSteps"],v),n}function VS(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["prompt"]);i!=null&&c(n,["instances[0]","prompt"],i);const s=f(t,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>Hw(l))),c(n,["instances[0]","referenceImages"],a)}const o=f(t,["config"]);return o!=null&&bS(o,n),n}function GS(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>kl(s))),c(t,["generatedImages"],i)}return t}function HS(e,t){const n={},r=f(e,["taskType"]);t!==void 0&&r!=null&&c(t,["requests[]","taskType"],r);const i=f(e,["title"]);t!==void 0&&i!=null&&c(t,["requests[]","title"],i);const s=f(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&c(t,["requests[]","outputDimensionality"],s),f(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function zS(e,t){const n={},r=f(e,["taskType"]);t!==void 0&&r!=null&&c(t,["instances[]","task_type"],r);const i=f(e,["title"]);t!==void 0&&i!=null&&c(t,["instances[]","title"],i);const s=f(e,["outputDimensionality"]);t!==void 0&&s!=null&&c(t,["parameters","outputDimensionality"],s);const o=f(e,["mimeType"]);t!==void 0&&o!=null&&c(t,["instances[]","mimeType"],o);const a=f(e,["autoTruncate"]);return t!==void 0&&a!=null&&c(t,["parameters","autoTruncate"],a),n}function WS(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["contents"]);if(i!=null){let a=Pc(e,i);Array.isArray(a)&&(a=a.map(l=>l)),c(n,["requests[]","content"],a)}const s=f(t,["config"]);s!=null&&HS(s,n);const o=f(t,["model"]);return o!==void 0&&c(n,["requests[]","model"],Le(e,o)),n}function qS(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["contents"]);if(i!=null){let o=Pc(e,i);Array.isArray(o)&&(o=o.map(a=>a)),c(n,["instances[]","content"],o)}const s=f(t,["config"]);return s!=null&&zS(s,n),n}function $S(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),c(t,["embeddings"],s)}const i=f(e,["metadata"]);return i!=null&&c(t,["metadata"],i),t}function JS(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>AS(o))),c(t,["embeddings"],s)}const i=f(e,["metadata"]);return i!=null&&c(t,["metadata"],i),t}function KS(e){const t={},n=f(e,["endpoint"]);n!=null&&c(t,["name"],n);const r=f(e,["deployedModelId"]);return r!=null&&c(t,["deployedModelId"],r),t}function YS(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&c(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function XS(e){const t={},n=f(e,["id"]);n!=null&&c(t,["id"],n);const r=f(e,["args"]);r!=null&&c(t,["args"],r);const i=f(e,["name"]);if(i!=null&&c(t,["name"],i),f(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function QS(e){const t={},n=f(e,["mode"]);n!=null&&c(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);if(r!=null&&c(t,["allowedFunctionNames"],r),f(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function jS(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&c(t,["description"],n);const r=f(e,["name"]);r!=null&&c(t,["name"],r);const i=f(e,["parameters"]);i!=null&&c(t,["parameters"],i);const s=f(e,["parametersJsonSchema"]);s!=null&&c(t,["parametersJsonSchema"],s);const o=f(e,["response"]);o!=null&&c(t,["response"],o);const a=f(e,["responseJsonSchema"]);return a!=null&&c(t,["responseJsonSchema"],a),t}function ZS(e,t,n){const r={},i=f(t,["systemInstruction"]);n!==void 0&&i!=null&&c(n,["systemInstruction"],Il(Dt(i)));const s=f(t,["temperature"]);s!=null&&c(r,["temperature"],s);const o=f(t,["topP"]);o!=null&&c(r,["topP"],o);const a=f(t,["topK"]);a!=null&&c(r,["topK"],a);const l=f(t,["candidateCount"]);l!=null&&c(r,["candidateCount"],l);const u=f(t,["maxOutputTokens"]);u!=null&&c(r,["maxOutputTokens"],u);const d=f(t,["stopSequences"]);d!=null&&c(r,["stopSequences"],d);const h=f(t,["responseLogprobs"]);h!=null&&c(r,["responseLogprobs"],h);const p=f(t,["logprobs"]);p!=null&&c(r,["logprobs"],p);const m=f(t,["presencePenalty"]);m!=null&&c(r,["presencePenalty"],m);const y=f(t,["frequencyPenalty"]);y!=null&&c(r,["frequencyPenalty"],y);const x=f(t,["seed"]);x!=null&&c(r,["seed"],x);const E=f(t,["responseMimeType"]);E!=null&&c(r,["responseMimeType"],E);const T=f(t,["responseSchema"]);T!=null&&c(r,["responseSchema"],Fc(T));const _=f(t,["responseJsonSchema"]);if(_!=null&&c(r,["responseJsonSchema"],_),f(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const v=f(t,["safetySettings"]);if(n!==void 0&&v!=null){let H=v;Array.isArray(H)&&(H=H.map(Z=>zw(Z))),c(n,["safetySettings"],H)}const C=f(t,["tools"]);if(n!==void 0&&C!=null){let H=ss(C);Array.isArray(H)&&(H=H.map(Z=>Xw(is(Z)))),c(n,["tools"],H)}const D=f(t,["toolConfig"]);if(n!==void 0&&D!=null&&c(n,["toolConfig"],Yw(D)),f(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=f(t,["cachedContent"]);n!==void 0&&F!=null&&c(n,["cachedContent"],dr(e,F));const I=f(t,["responseModalities"]);I!=null&&c(r,["responseModalities"],I);const L=f(t,["mediaResolution"]);L!=null&&c(r,["mediaResolution"],L);const M=f(t,["speechConfig"]);if(M!=null&&c(r,["speechConfig"],Mc(M)),f(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const B=f(t,["thinkingConfig"]);B!=null&&c(r,["thinkingConfig"],B);const J=f(t,["imageConfig"]);return J!=null&&c(r,["imageConfig"],Aw(J)),r}function ew(e,t,n){const r={},i=f(t,["systemInstruction"]);n!==void 0&&i!=null&&c(n,["systemInstruction"],Dt(i));const s=f(t,["temperature"]);s!=null&&c(r,["temperature"],s);const o=f(t,["topP"]);o!=null&&c(r,["topP"],o);const a=f(t,["topK"]);a!=null&&c(r,["topK"],a);const l=f(t,["candidateCount"]);l!=null&&c(r,["candidateCount"],l);const u=f(t,["maxOutputTokens"]);u!=null&&c(r,["maxOutputTokens"],u);const d=f(t,["stopSequences"]);d!=null&&c(r,["stopSequences"],d);const h=f(t,["responseLogprobs"]);h!=null&&c(r,["responseLogprobs"],h);const p=f(t,["logprobs"]);p!=null&&c(r,["logprobs"],p);const m=f(t,["presencePenalty"]);m!=null&&c(r,["presencePenalty"],m);const y=f(t,["frequencyPenalty"]);y!=null&&c(r,["frequencyPenalty"],y);const x=f(t,["seed"]);x!=null&&c(r,["seed"],x);const E=f(t,["responseMimeType"]);E!=null&&c(r,["responseMimeType"],E);const T=f(t,["responseSchema"]);T!=null&&c(r,["responseSchema"],Fc(T));const _=f(t,["responseJsonSchema"]);_!=null&&c(r,["responseJsonSchema"],_);const v=f(t,["routingConfig"]);v!=null&&c(r,["routingConfig"],v);const C=f(t,["modelSelectionConfig"]);C!=null&&c(r,["modelConfig"],C);const D=f(t,["safetySettings"]);if(n!==void 0&&D!=null){let Ee=D;Array.isArray(Ee)&&(Ee=Ee.map(Me=>Me)),c(n,["safetySettings"],Ee)}const F=f(t,["tools"]);if(n!==void 0&&F!=null){let Ee=ss(F);Array.isArray(Ee)&&(Ee=Ee.map(Me=>w1(is(Me)))),c(n,["tools"],Ee)}const I=f(t,["toolConfig"]);n!==void 0&&I!=null&&c(n,["toolConfig"],I);const L=f(t,["labels"]);n!==void 0&&L!=null&&c(n,["labels"],L);const M=f(t,["cachedContent"]);n!==void 0&&M!=null&&c(n,["cachedContent"],dr(e,M));const B=f(t,["responseModalities"]);B!=null&&c(r,["responseModalities"],B);const J=f(t,["mediaResolution"]);J!=null&&c(r,["mediaResolution"],J);const H=f(t,["speechConfig"]);H!=null&&c(r,["speechConfig"],S1(Mc(H)));const Z=f(t,["audioTimestamp"]);Z!=null&&c(r,["audioTimestamp"],Z);const Te=f(t,["thinkingConfig"]);Te!=null&&c(r,["thinkingConfig"],Te);const ye=f(t,["imageConfig"]);return ye!=null&&c(r,["imageConfig"],Nw(ye)),r}function Wh(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["contents"]);if(i!=null){let o=xn(i);Array.isArray(o)&&(o=o.map(a=>Il(a))),c(n,["contents"],o)}const s=f(t,["config"]);return s!=null&&c(n,["generationConfig"],ZS(e,s,n)),n}function qh(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["contents"]);if(i!=null){let o=xn(i);Array.isArray(o)&&(o=o.map(a=>a)),c(n,["contents"],o)}const s=f(t,["config"]);return s!=null&&c(n,["generationConfig"],ew(e,s,n)),n}function $h(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>ES(u))),c(t,["candidates"],l)}const i=f(e,["modelVersion"]);i!=null&&c(t,["modelVersion"],i);const s=f(e,["promptFeedback"]);s!=null&&c(t,["promptFeedback"],s);const o=f(e,["responseId"]);o!=null&&c(t,["responseId"],o);const a=f(e,["usageMetadata"]);return a!=null&&c(t,["usageMetadata"],a),t}function Jh(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>d)),c(t,["candidates"],u)}const i=f(e,["createTime"]);i!=null&&c(t,["createTime"],i);const s=f(e,["modelVersion"]);s!=null&&c(t,["modelVersion"],s);const o=f(e,["promptFeedback"]);o!=null&&c(t,["promptFeedback"],o);const a=f(e,["responseId"]);a!=null&&c(t,["responseId"],a);const l=f(e,["usageMetadata"]);return l!=null&&c(t,["usageMetadata"],l),t}function tw(e,t){const n={};if(f(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=f(e,["numberOfImages"]);t!==void 0&&r!=null&&c(t,["parameters","sampleCount"],r);const i=f(e,["aspectRatio"]);t!==void 0&&i!=null&&c(t,["parameters","aspectRatio"],i);const s=f(e,["guidanceScale"]);if(t!==void 0&&s!=null&&c(t,["parameters","guidanceScale"],s),f(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=f(e,["safetyFilterLevel"]);t!==void 0&&o!=null&&c(t,["parameters","safetySetting"],o);const a=f(e,["personGeneration"]);t!==void 0&&a!=null&&c(t,["parameters","personGeneration"],a);const l=f(e,["includeSafetyAttributes"]);t!==void 0&&l!=null&&c(t,["parameters","includeSafetyAttributes"],l);const u=f(e,["includeRaiReason"]);t!==void 0&&u!=null&&c(t,["parameters","includeRaiReason"],u);const d=f(e,["language"]);t!==void 0&&d!=null&&c(t,["parameters","language"],d);const h=f(e,["outputMimeType"]);t!==void 0&&h!=null&&c(t,["parameters","outputOptions","mimeType"],h);const p=f(e,["outputCompressionQuality"]);if(t!==void 0&&p!=null&&c(t,["parameters","outputOptions","compressionQuality"],p),f(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const m=f(e,["imageSize"]);if(t!==void 0&&m!=null&&c(t,["parameters","sampleImageSize"],m),f(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function nw(e,t){const n={},r=f(e,["outputGcsUri"]);t!==void 0&&r!=null&&c(t,["parameters","storageUri"],r);const i=f(e,["negativePrompt"]);t!==void 0&&i!=null&&c(t,["parameters","negativePrompt"],i);const s=f(e,["numberOfImages"]);t!==void 0&&s!=null&&c(t,["parameters","sampleCount"],s);const o=f(e,["aspectRatio"]);t!==void 0&&o!=null&&c(t,["parameters","aspectRatio"],o);const a=f(e,["guidanceScale"]);t!==void 0&&a!=null&&c(t,["parameters","guidanceScale"],a);const l=f(e,["seed"]);t!==void 0&&l!=null&&c(t,["parameters","seed"],l);const u=f(e,["safetyFilterLevel"]);t!==void 0&&u!=null&&c(t,["parameters","safetySetting"],u);const d=f(e,["personGeneration"]);t!==void 0&&d!=null&&c(t,["parameters","personGeneration"],d);const h=f(e,["includeSafetyAttributes"]);t!==void 0&&h!=null&&c(t,["parameters","includeSafetyAttributes"],h);const p=f(e,["includeRaiReason"]);t!==void 0&&p!=null&&c(t,["parameters","includeRaiReason"],p);const m=f(e,["language"]);t!==void 0&&m!=null&&c(t,["parameters","language"],m);const y=f(e,["outputMimeType"]);t!==void 0&&y!=null&&c(t,["parameters","outputOptions","mimeType"],y);const x=f(e,["outputCompressionQuality"]);t!==void 0&&x!=null&&c(t,["parameters","outputOptions","compressionQuality"],x);const E=f(e,["addWatermark"]);t!==void 0&&E!=null&&c(t,["parameters","addWatermark"],E);const T=f(e,["labels"]);t!==void 0&&T!=null&&c(t,["labels"],T);const _=f(e,["imageSize"]);t!==void 0&&_!=null&&c(t,["parameters","sampleImageSize"],_);const v=f(e,["enhancePrompt"]);return t!==void 0&&v!=null&&c(t,["parameters","enhancePrompt"],v),n}function rw(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["prompt"]);i!=null&&c(n,["instances[0]","prompt"],i);const s=f(t,["config"]);return s!=null&&tw(s,n),n}function iw(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["prompt"]);i!=null&&c(n,["instances[0]","prompt"],i);const s=f(t,["config"]);return s!=null&&nw(s,n),n}function sw(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>xw(o))),c(t,["generatedImages"],s)}const i=f(e,["positivePromptSafetyAttributes"]);return i!=null&&c(t,["positivePromptSafetyAttributes"],T1(i)),t}function ow(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>kl(o))),c(t,["generatedImages"],s)}const i=f(e,["positivePromptSafetyAttributes"]);return i!=null&&c(t,["positivePromptSafetyAttributes"],E1(i)),t}function aw(e,t){const n={},r=f(e,["numberOfVideos"]);if(t!==void 0&&r!=null&&c(t,["parameters","sampleCount"],r),f(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=f(e,["durationSeconds"]);if(t!==void 0&&i!=null&&c(t,["parameters","durationSeconds"],i),f(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=f(e,["aspectRatio"]);t!==void 0&&s!=null&&c(t,["parameters","aspectRatio"],s);const o=f(e,["resolution"]);t!==void 0&&o!=null&&c(t,["parameters","resolution"],o);const a=f(e,["personGeneration"]);if(t!==void 0&&a!=null&&c(t,["parameters","personGeneration"],a),f(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=f(e,["negativePrompt"]);t!==void 0&&l!=null&&c(t,["parameters","negativePrompt"],l);const u=f(e,["enhancePrompt"]);if(t!==void 0&&u!=null&&c(t,["parameters","enhancePrompt"],u),f(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const d=f(e,["lastFrame"]);t!==void 0&&d!=null&&c(t,["instances[0]","lastFrame"],Rl(d));const h=f(e,["referenceImages"]);if(t!==void 0&&h!=null){let p=h;Array.isArray(p)&&(p=p.map(m=>uC(m))),c(t,["instances[0]","referenceImages"],p)}if(f(e,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(f(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function lw(e,t){const n={},r=f(e,["numberOfVideos"]);t!==void 0&&r!=null&&c(t,["parameters","sampleCount"],r);const i=f(e,["outputGcsUri"]);t!==void 0&&i!=null&&c(t,["parameters","storageUri"],i);const s=f(e,["fps"]);t!==void 0&&s!=null&&c(t,["parameters","fps"],s);const o=f(e,["durationSeconds"]);t!==void 0&&o!=null&&c(t,["parameters","durationSeconds"],o);const a=f(e,["seed"]);t!==void 0&&a!=null&&c(t,["parameters","seed"],a);const l=f(e,["aspectRatio"]);t!==void 0&&l!=null&&c(t,["parameters","aspectRatio"],l);const u=f(e,["resolution"]);t!==void 0&&u!=null&&c(t,["parameters","resolution"],u);const d=f(e,["personGeneration"]);t!==void 0&&d!=null&&c(t,["parameters","personGeneration"],d);const h=f(e,["pubsubTopic"]);t!==void 0&&h!=null&&c(t,["parameters","pubsubTopic"],h);const p=f(e,["negativePrompt"]);t!==void 0&&p!=null&&c(t,["parameters","negativePrompt"],p);const m=f(e,["enhancePrompt"]);t!==void 0&&m!=null&&c(t,["parameters","enhancePrompt"],m);const y=f(e,["generateAudio"]);t!==void 0&&y!=null&&c(t,["parameters","generateAudio"],y);const x=f(e,["lastFrame"]);t!==void 0&&x!=null&&c(t,["instances[0]","lastFrame"],Ln(x));const E=f(e,["referenceImages"]);if(t!==void 0&&E!=null){let v=E;Array.isArray(v)&&(v=v.map(C=>fC(C))),c(t,["instances[0]","referenceImages"],v)}const T=f(e,["mask"]);t!==void 0&&T!=null&&c(t,["instances[0]","mask"],lC(T));const _=f(e,["compressionQuality"]);return t!==void 0&&_!=null&&c(t,["parameters","compressionQuality"],_),n}function uw(e){const t={},n=f(e,["name"]);n!=null&&c(t,["name"],n);const r=f(e,["metadata"]);r!=null&&c(t,["metadata"],r);const i=f(e,["done"]);i!=null&&c(t,["done"],i);const s=f(e,["error"]);s!=null&&c(t,["error"],s);const o=f(e,["response","generateVideoResponse"]);return o!=null&&c(t,["response"],hw(o)),t}function fw(e){const t={},n=f(e,["name"]);n!=null&&c(t,["name"],n);const r=f(e,["metadata"]);r!=null&&c(t,["metadata"],r);const i=f(e,["done"]);i!=null&&c(t,["done"],i);const s=f(e,["error"]);s!=null&&c(t,["error"],s);const o=f(e,["response"]);return o!=null&&c(t,["response"],pw(o)),t}function cw(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["prompt"]);i!=null&&c(n,["instances[0]","prompt"],i);const s=f(t,["image"]);s!=null&&c(n,["instances[0]","image"],Rl(s));const o=f(t,["video"]);o!=null&&c(n,["instances[0]","video"],C1(o));const a=f(t,["source"]);a!=null&&mw(a,n);const l=f(t,["config"]);return l!=null&&aw(l,n),n}function dw(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["prompt"]);i!=null&&c(n,["instances[0]","prompt"],i);const s=f(t,["image"]);s!=null&&c(n,["instances[0]","image"],Ln(s));const o=f(t,["video"]);o!=null&&c(n,["instances[0]","video"],A1(o));const a=f(t,["source"]);a!=null&&gw(a,n);const l=f(t,["config"]);return l!=null&&lw(l,n),n}function hw(e){const t={},n=f(e,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>yw(o))),c(t,["generatedVideos"],s)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&c(t,["raiMediaFilteredCount"],r);const i=f(e,["raiMediaFilteredReasons"]);return i!=null&&c(t,["raiMediaFilteredReasons"],i),t}function pw(e){const t={},n=f(e,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>_w(o))),c(t,["generatedVideos"],s)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&c(t,["raiMediaFilteredCount"],r);const i=f(e,["raiMediaFilteredReasons"]);return i!=null&&c(t,["raiMediaFilteredReasons"],i),t}function mw(e,t){const n={},r=f(e,["prompt"]);t!==void 0&&r!=null&&c(t,["instances[0]","prompt"],r);const i=f(e,["image"]);t!==void 0&&i!=null&&c(t,["instances[0]","image"],Rl(i));const s=f(e,["video"]);return t!==void 0&&s!=null&&c(t,["instances[0]","video"],C1(s)),n}function gw(e,t){const n={},r=f(e,["prompt"]);t!==void 0&&r!=null&&c(t,["instances[0]","prompt"],r);const i=f(e,["image"]);t!==void 0&&i!=null&&c(t,["instances[0]","image"],Ln(i));const s=f(e,["video"]);return t!==void 0&&s!=null&&c(t,["instances[0]","video"],A1(s)),n}function xw(e){const t={},n=f(e,["_self"]);n!=null&&c(t,["image"],Iw(n));const r=f(e,["raiFilteredReason"]);r!=null&&c(t,["raiFilteredReason"],r);const i=f(e,["_self"]);return i!=null&&c(t,["safetyAttributes"],T1(i)),t}function kl(e){const t={},n=f(e,["_self"]);n!=null&&c(t,["image"],_1(n));const r=f(e,["raiFilteredReason"]);r!=null&&c(t,["raiFilteredReason"],r);const i=f(e,["_self"]);i!=null&&c(t,["safetyAttributes"],E1(i));const s=f(e,["prompt"]);return s!=null&&c(t,["enhancedPrompt"],s),t}function vw(e){const t={},n=f(e,["_self"]);n!=null&&c(t,["mask"],_1(n));const r=f(e,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),c(t,["labels"],i)}return t}function yw(e){const t={},n=f(e,["video"]);return n!=null&&c(t,["video"],oC(n)),t}function _w(e){const t={},n=f(e,["_self"]);return n!=null&&c(t,["video"],aC(n)),t}function Tw(e){const t={},n=f(e,["modelSelectionConfig"]);n!=null&&c(t,["modelConfig"],n);const r=f(e,["responseJsonSchema"]);r!=null&&c(t,["responseJsonSchema"],r);const i=f(e,["audioTimestamp"]);i!=null&&c(t,["audioTimestamp"],i);const s=f(e,["candidateCount"]);s!=null&&c(t,["candidateCount"],s);const o=f(e,["enableAffectiveDialog"]);o!=null&&c(t,["enableAffectiveDialog"],o);const a=f(e,["frequencyPenalty"]);a!=null&&c(t,["frequencyPenalty"],a);const l=f(e,["logprobs"]);l!=null&&c(t,["logprobs"],l);const u=f(e,["maxOutputTokens"]);u!=null&&c(t,["maxOutputTokens"],u);const d=f(e,["mediaResolution"]);d!=null&&c(t,["mediaResolution"],d);const h=f(e,["presencePenalty"]);h!=null&&c(t,["presencePenalty"],h);const p=f(e,["responseLogprobs"]);p!=null&&c(t,["responseLogprobs"],p);const m=f(e,["responseMimeType"]);m!=null&&c(t,["responseMimeType"],m);const y=f(e,["responseModalities"]);y!=null&&c(t,["responseModalities"],y);const x=f(e,["responseSchema"]);x!=null&&c(t,["responseSchema"],x);const E=f(e,["routingConfig"]);E!=null&&c(t,["routingConfig"],E);const T=f(e,["seed"]);T!=null&&c(t,["seed"],T);const _=f(e,["speechConfig"]);_!=null&&c(t,["speechConfig"],S1(_));const v=f(e,["stopSequences"]);v!=null&&c(t,["stopSequences"],v);const C=f(e,["temperature"]);C!=null&&c(t,["temperature"],C);const D=f(e,["thinkingConfig"]);D!=null&&c(t,["thinkingConfig"],D);const F=f(e,["topK"]);F!=null&&c(t,["topK"],F);const I=f(e,["topP"]);if(I!=null&&c(t,["topP"],I),f(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function Ew(e,t){const n={},r=f(t,["model"]);return r!=null&&c(n,["_url","name"],Le(e,r)),n}function Sw(e,t){const n={},r=f(t,["model"]);return r!=null&&c(n,["_url","name"],Le(e,r)),n}function ww(e){const t={};if(f(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=f(e,["enableWidget"]);return n!=null&&c(t,["enableWidget"],n),t}function Cw(e){const t={};if(f(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=f(e,["timeRangeFilter"]);return n!=null&&c(t,["timeRangeFilter"],n),t}function Aw(e){const t={},n=f(e,["aspectRatio"]);n!=null&&c(t,["aspectRatio"],n);const r=f(e,["imageSize"]);if(r!=null&&c(t,["imageSize"],r),f(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function Nw(e){const t={},n=f(e,["aspectRatio"]);n!=null&&c(t,["aspectRatio"],n);const r=f(e,["imageSize"]);r!=null&&c(t,["imageSize"],r);const i=f(e,["outputMimeType"]);i!=null&&c(t,["imageOutputOptions","mimeType"],i);const s=f(e,["outputCompressionQuality"]);return s!=null&&c(t,["imageOutputOptions","compressionQuality"],s),t}function Iw(e){const t={},n=f(e,["bytesBase64Encoded"]);n!=null&&c(t,["imageBytes"],Gr(n));const r=f(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function _1(e){const t={},n=f(e,["gcsUri"]);n!=null&&c(t,["gcsUri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&c(t,["imageBytes"],Gr(r));const i=f(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}function Rl(e){const t={};if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=f(e,["imageBytes"]);n!=null&&c(t,["bytesBase64Encoded"],Gr(n));const r=f(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function Ln(e){const t={},n=f(e,["gcsUri"]);n!=null&&c(t,["gcsUri"],n);const r=f(e,["imageBytes"]);r!=null&&c(t,["bytesBase64Encoded"],Gr(r));const i=f(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}function kw(e,t,n){const r={},i=f(t,["pageSize"]);n!==void 0&&i!=null&&c(n,["_query","pageSize"],i);const s=f(t,["pageToken"]);n!==void 0&&s!=null&&c(n,["_query","pageToken"],s);const o=f(t,["filter"]);n!==void 0&&o!=null&&c(n,["_query","filter"],o);const a=f(t,["queryBase"]);return n!==void 0&&a!=null&&c(n,["_url","models_url"],d1(e,a)),r}function Rw(e,t,n){const r={},i=f(t,["pageSize"]);n!==void 0&&i!=null&&c(n,["_query","pageSize"],i);const s=f(t,["pageToken"]);n!==void 0&&s!=null&&c(n,["_query","pageToken"],s);const o=f(t,["filter"]);n!==void 0&&o!=null&&c(n,["_query","filter"],o);const a=f(t,["queryBase"]);return n!==void 0&&a!=null&&c(n,["_url","models_url"],d1(e,a)),r}function Pw(e,t){const n={},r=f(t,["config"]);return r!=null&&kw(e,r,n),n}function Fw(e,t){const n={},r=f(t,["config"]);return r!=null&&Rw(e,r,n),n}function Mw(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=f(e,["_self"]);if(i!=null){let s=h1(i);Array.isArray(s)&&(s=s.map(o=>Cf(o))),c(t,["models"],s)}return t}function Dw(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=f(e,["_self"]);if(i!=null){let s=h1(i);Array.isArray(s)&&(s=s.map(o=>Af(o))),c(t,["models"],s)}return t}function Lw(e){const t={},n=f(e,["maskMode"]);n!=null&&c(t,["maskMode"],n);const r=f(e,["segmentationClasses"]);r!=null&&c(t,["maskClasses"],r);const i=f(e,["maskDilation"]);return i!=null&&c(t,["dilation"],i),t}function Cf(e){const t={},n=f(e,["name"]);n!=null&&c(t,["name"],n);const r=f(e,["displayName"]);r!=null&&c(t,["displayName"],r);const i=f(e,["description"]);i!=null&&c(t,["description"],i);const s=f(e,["version"]);s!=null&&c(t,["version"],s);const o=f(e,["_self"]);o!=null&&c(t,["tunedModelInfo"],Qw(o));const a=f(e,["inputTokenLimit"]);a!=null&&c(t,["inputTokenLimit"],a);const l=f(e,["outputTokenLimit"]);l!=null&&c(t,["outputTokenLimit"],l);const u=f(e,["supportedGenerationMethods"]);u!=null&&c(t,["supportedActions"],u);const d=f(e,["temperature"]);d!=null&&c(t,["temperature"],d);const h=f(e,["maxTemperature"]);h!=null&&c(t,["maxTemperature"],h);const p=f(e,["topP"]);p!=null&&c(t,["topP"],p);const m=f(e,["topK"]);m!=null&&c(t,["topK"],m);const y=f(e,["thinking"]);return y!=null&&c(t,["thinking"],y),t}function Af(e){const t={},n=f(e,["name"]);n!=null&&c(t,["name"],n);const r=f(e,["displayName"]);r!=null&&c(t,["displayName"],r);const i=f(e,["description"]);i!=null&&c(t,["description"],i);const s=f(e,["versionId"]);s!=null&&c(t,["version"],s);const o=f(e,["deployedModels"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(p=>KS(p))),c(t,["endpoints"],h)}const a=f(e,["labels"]);a!=null&&c(t,["labels"],a);const l=f(e,["_self"]);l!=null&&c(t,["tunedModelInfo"],jw(l));const u=f(e,["defaultCheckpointId"]);u!=null&&c(t,["defaultCheckpointId"],u);const d=f(e,["checkpoints"]);if(d!=null){let h=d;Array.isArray(h)&&(h=h.map(p=>p)),c(t,["checkpoints"],h)}return t}function Uw(e){const t={},n=f(e,["mediaResolution"]);n!=null&&c(t,["mediaResolution"],n);const r=f(e,["codeExecutionResult"]);r!=null&&c(t,["codeExecutionResult"],r);const i=f(e,["executableCode"]);i!=null&&c(t,["executableCode"],i);const s=f(e,["fileData"]);s!=null&&c(t,["fileData"],YS(s));const o=f(e,["functionCall"]);o!=null&&c(t,["functionCall"],XS(o));const a=f(e,["functionResponse"]);a!=null&&c(t,["functionResponse"],a);const l=f(e,["inlineData"]);l!=null&&c(t,["inlineData"],TS(l));const u=f(e,["text"]);u!=null&&c(t,["text"],u);const d=f(e,["thought"]);d!=null&&c(t,["thought"],d);const h=f(e,["thoughtSignature"]);h!=null&&c(t,["thoughtSignature"],h);const p=f(e,["videoMetadata"]);return p!=null&&c(t,["videoMetadata"],p),t}function Ow(e){const t={},n=f(e,["productImage"]);return n!=null&&c(t,["image"],Ln(n)),t}function Bw(e,t){const n={},r=f(e,["numberOfImages"]);t!==void 0&&r!=null&&c(t,["parameters","sampleCount"],r);const i=f(e,["baseSteps"]);t!==void 0&&i!=null&&c(t,["parameters","baseSteps"],i);const s=f(e,["outputGcsUri"]);t!==void 0&&s!=null&&c(t,["parameters","storageUri"],s);const o=f(e,["seed"]);t!==void 0&&o!=null&&c(t,["parameters","seed"],o);const a=f(e,["safetyFilterLevel"]);t!==void 0&&a!=null&&c(t,["parameters","safetySetting"],a);const l=f(e,["personGeneration"]);t!==void 0&&l!=null&&c(t,["parameters","personGeneration"],l);const u=f(e,["addWatermark"]);t!==void 0&&u!=null&&c(t,["parameters","addWatermark"],u);const d=f(e,["outputMimeType"]);t!==void 0&&d!=null&&c(t,["parameters","outputOptions","mimeType"],d);const h=f(e,["outputCompressionQuality"]);t!==void 0&&h!=null&&c(t,["parameters","outputOptions","compressionQuality"],h);const p=f(e,["enhancePrompt"]);t!==void 0&&p!=null&&c(t,["parameters","enhancePrompt"],p);const m=f(e,["labels"]);return t!==void 0&&m!=null&&c(t,["labels"],m),n}function bw(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["source"]);i!=null&&Gw(i,n);const s=f(t,["config"]);return s!=null&&Bw(s,n),n}function Vw(e){const t={},n=f(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>kl(i))),c(t,["generatedImages"],r)}return t}function Gw(e,t){const n={},r=f(e,["prompt"]);t!==void 0&&r!=null&&c(t,["instances[0]","prompt"],r);const i=f(e,["personImage"]);t!==void 0&&i!=null&&c(t,["instances[0]","personImage","image"],Ln(i));const s=f(e,["productImages"]);if(t!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Ow(a))),c(t,["instances[0]","productImages"],o)}return n}function Hw(e){const t={},n=f(e,["referenceImage"]);n!=null&&c(t,["referenceImage"],Ln(n));const r=f(e,["referenceId"]);r!=null&&c(t,["referenceId"],r);const i=f(e,["referenceType"]);i!=null&&c(t,["referenceType"],i);const s=f(e,["maskImageConfig"]);s!=null&&c(t,["maskImageConfig"],Lw(s));const o=f(e,["controlImageConfig"]);o!=null&&c(t,["controlImageConfig"],IS(o));const a=f(e,["styleImageConfig"]);a!=null&&c(t,["styleImageConfig"],a);const l=f(e,["subjectImageConfig"]);return l!=null&&c(t,["subjectImageConfig"],l),t}function T1(e){const t={},n=f(e,["safetyAttributes","categories"]);n!=null&&c(t,["categories"],n);const r=f(e,["safetyAttributes","scores"]);r!=null&&c(t,["scores"],r);const i=f(e,["contentType"]);return i!=null&&c(t,["contentType"],i),t}function E1(e){const t={},n=f(e,["safetyAttributes","categories"]);n!=null&&c(t,["categories"],n);const r=f(e,["safetyAttributes","scores"]);r!=null&&c(t,["scores"],r);const i=f(e,["contentType"]);return i!=null&&c(t,["contentType"],i),t}function zw(e){const t={},n=f(e,["category"]);if(n!=null&&c(t,["category"],n),f(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=f(e,["threshold"]);return r!=null&&c(t,["threshold"],r),t}function Ww(e){const t={},n=f(e,["image"]);return n!=null&&c(t,["image"],Ln(n)),t}function qw(e,t){const n={},r=f(e,["mode"]);t!==void 0&&r!=null&&c(t,["parameters","mode"],r);const i=f(e,["maxPredictions"]);t!==void 0&&i!=null&&c(t,["parameters","maxPredictions"],i);const s=f(e,["confidenceThreshold"]);t!==void 0&&s!=null&&c(t,["parameters","confidenceThreshold"],s);const o=f(e,["maskDilation"]);t!==void 0&&o!=null&&c(t,["parameters","maskDilation"],o);const a=f(e,["binaryColorThreshold"]);t!==void 0&&a!=null&&c(t,["parameters","binaryColorThreshold"],a);const l=f(e,["labels"]);return t!==void 0&&l!=null&&c(t,["labels"],l),n}function $w(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["source"]);i!=null&&Kw(i,n);const s=f(t,["config"]);return s!=null&&qw(s,n),n}function Jw(e){const t={},n=f(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>vw(i))),c(t,["generatedMasks"],r)}return t}function Kw(e,t){const n={},r=f(e,["prompt"]);t!==void 0&&r!=null&&c(t,["instances[0]","prompt"],r);const i=f(e,["image"]);t!==void 0&&i!=null&&c(t,["instances[0]","image"],Ln(i));const s=f(e,["scribbleImage"]);return t!==void 0&&s!=null&&c(t,["instances[0]","scribble"],Ww(s)),n}function S1(e){const t={},n=f(e,["languageCode"]);n!=null&&c(t,["languageCode"],n);const r=f(e,["voiceConfig"]);if(r!=null&&c(t,["voiceConfig"],r),f(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function Yw(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&c(t,["functionCallingConfig"],QS(n));const r=f(e,["retrievalConfig"]);return r!=null&&c(t,["retrievalConfig"],r),t}function Xw(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>h)),c(t,["functionDeclarations"],d)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearchRetrieval"]);r!=null&&c(t,["googleSearchRetrieval"],r);const i=f(e,["computerUse"]);i!=null&&c(t,["computerUse"],i);const s=f(e,["fileSearch"]);s!=null&&c(t,["fileSearch"],s);const o=f(e,["codeExecution"]);if(o!=null&&c(t,["codeExecution"],o),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=f(e,["googleMaps"]);a!=null&&c(t,["googleMaps"],ww(a));const l=f(e,["googleSearch"]);l!=null&&c(t,["googleSearch"],Cw(l));const u=f(e,["urlContext"]);return u!=null&&c(t,["urlContext"],u),t}function w1(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>jS(p))),c(t,["functionDeclarations"],h)}const r=f(e,["retrieval"]);r!=null&&c(t,["retrieval"],r);const i=f(e,["googleSearchRetrieval"]);i!=null&&c(t,["googleSearchRetrieval"],i);const s=f(e,["computerUse"]);if(s!=null&&c(t,["computerUse"],s),f(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=f(e,["codeExecution"]);o!=null&&c(t,["codeExecution"],o);const a=f(e,["enterpriseWebSearch"]);a!=null&&c(t,["enterpriseWebSearch"],a);const l=f(e,["googleMaps"]);l!=null&&c(t,["googleMaps"],l);const u=f(e,["googleSearch"]);u!=null&&c(t,["googleSearch"],u);const d=f(e,["urlContext"]);return d!=null&&c(t,["urlContext"],d),t}function Qw(e){const t={},n=f(e,["baseModel"]);n!=null&&c(t,["baseModel"],n);const r=f(e,["createTime"]);r!=null&&c(t,["createTime"],r);const i=f(e,["updateTime"]);return i!=null&&c(t,["updateTime"],i),t}function jw(e){const t={},n=f(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&c(t,["baseModel"],n);const r=f(e,["createTime"]);r!=null&&c(t,["createTime"],r);const i=f(e,["updateTime"]);return i!=null&&c(t,["updateTime"],i),t}function Zw(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&c(t,["displayName"],r);const i=f(e,["description"]);t!==void 0&&i!=null&&c(t,["description"],i);const s=f(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&c(t,["defaultCheckpointId"],s),n}function eC(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&c(t,["displayName"],r);const i=f(e,["description"]);t!==void 0&&i!=null&&c(t,["description"],i);const s=f(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&c(t,["defaultCheckpointId"],s),n}function tC(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","name"],Le(e,r));const i=f(t,["config"]);return i!=null&&Zw(i,n),n}function nC(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["config"]);return i!=null&&eC(i,n),n}function rC(e,t){const n={},r=f(e,["outputGcsUri"]);t!==void 0&&r!=null&&c(t,["parameters","storageUri"],r);const i=f(e,["safetyFilterLevel"]);t!==void 0&&i!=null&&c(t,["parameters","safetySetting"],i);const s=f(e,["personGeneration"]);t!==void 0&&s!=null&&c(t,["parameters","personGeneration"],s);const o=f(e,["includeRaiReason"]);t!==void 0&&o!=null&&c(t,["parameters","includeRaiReason"],o);const a=f(e,["outputMimeType"]);t!==void 0&&a!=null&&c(t,["parameters","outputOptions","mimeType"],a);const l=f(e,["outputCompressionQuality"]);t!==void 0&&l!=null&&c(t,["parameters","outputOptions","compressionQuality"],l);const u=f(e,["enhanceInputImage"]);t!==void 0&&u!=null&&c(t,["parameters","upscaleConfig","enhanceInputImage"],u);const d=f(e,["imagePreservationFactor"]);t!==void 0&&d!=null&&c(t,["parameters","upscaleConfig","imagePreservationFactor"],d);const h=f(e,["labels"]);t!==void 0&&h!=null&&c(t,["labels"],h);const p=f(e,["numberOfImages"]);t!==void 0&&p!=null&&c(t,["parameters","sampleCount"],p);const m=f(e,["mode"]);return t!==void 0&&m!=null&&c(t,["parameters","mode"],m),n}function iC(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["_url","model"],Le(e,r));const i=f(t,["image"]);i!=null&&c(n,["instances[0]","image"],Ln(i));const s=f(t,["upscaleFactor"]);s!=null&&c(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=f(t,["config"]);return o!=null&&rC(o,n),n}function sC(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>kl(s))),c(t,["generatedImages"],i)}return t}function oC(e){const t={},n=f(e,["uri"]);n!=null&&c(t,["uri"],n);const r=f(e,["encodedVideo"]);r!=null&&c(t,["videoBytes"],Gr(r));const i=f(e,["encoding"]);return i!=null&&c(t,["mimeType"],i),t}function aC(e){const t={},n=f(e,["gcsUri"]);n!=null&&c(t,["uri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&c(t,["videoBytes"],Gr(r));const i=f(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}function lC(e){const t={},n=f(e,["image"]);n!=null&&c(t,["_self"],Ln(n));const r=f(e,["maskMode"]);return r!=null&&c(t,["maskMode"],r),t}function uC(e){const t={},n=f(e,["image"]);n!=null&&c(t,["image"],Rl(n));const r=f(e,["referenceType"]);return r!=null&&c(t,["referenceType"],r),t}function fC(e){const t={},n=f(e,["image"]);n!=null&&c(t,["image"],Ln(n));const r=f(e,["referenceType"]);return r!=null&&c(t,["referenceType"],r),t}function C1(e){const t={},n=f(e,["uri"]);n!=null&&c(t,["uri"],n);const r=f(e,["videoBytes"]);r!=null&&c(t,["encodedVideo"],Gr(r));const i=f(e,["mimeType"]);return i!=null&&c(t,["encoding"],i),t}function A1(e){const t={},n=f(e,["uri"]);n!=null&&c(t,["gcsUri"],n);const r=f(e,["videoBytes"]);r!=null&&c(t,["bytesBase64Encoded"],Gr(r));const i=f(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cC="Content-Type",dC="X-Server-Timeout",hC="User-Agent",Nf="x-goog-api-client",pC="1.30.0",mC=`google-genai-sdk/${pC}`,gC="v1beta1",xC="v1beta",Kh=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class vC{constructor(t){var n,r;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:gC,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:xC,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&r.push(t.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),t!==""&&i.push(t),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);if(t.queryParams)for(const[o,a]of Object.entries(t.queryParams))i.searchParams.append(o,String(a));let s={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=t.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),t.abortSignal),this.unaryApiCall(i,s,t.httpMethod)}patchHttpOptions(t,n){const r=JSON.parse(JSON.stringify(t));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=t.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),t.abortSignal),this.streamApiCall(i,s,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,r,i){if(n&&n.timeout||i){const s=new AbortController,o=s.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>s.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),t.signal=o}return n&&n.extraBody!==null&&yC(t,n.extraBody),t.headers=await this.getHeadersInternal(n,r),t}async unaryApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await Yh(i),new Ef(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await Yh(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(t){var n;return Gi(this,arguments,function*(){const i=(n=t==null?void 0:t.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield $e(i.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=s.decode(l,{stream:!0});try{const h=JSON.parse(u);if("error"in h){const p=JSON.parse(JSON.stringify(h.error)),m=p.status,y=p.code,x=`got status: ${m}. ${JSON.stringify(h)}`;if(y>=400&&y<600)throw new Nl({message:x,status:y})}}catch(h){if(h.name==="ApiError")throw h}o+=u;let d=o.match(Kh);for(;d;){const h=d[1];try{const p=new Response(h,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield $e(new Ef(p)),o=o.slice(d[0].length),d=o.match(Kh)}catch(p){throw new Error(`exception parsing stream chunk ${h}. ${p}`)}}}}finally{i.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const t={},n=mC+" "+this.clientOptions.userAgentExtra;return t[hC]=n,t[Nf]=n,t[cC]="application/json",t}async getHeadersInternal(t,n){const r=new Headers;if(t&&t.headers){for(const[i,s]of Object.entries(t.headers))r.append(i,s);t.timeout&&t.timeout>0&&r.append(dC,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(t){var n;let r="";return typeof t=="string"&&(r=t.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(t,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(t);i.sizeBytes=String(o.size);const a=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const l={file:i},u=this.getFileName(t),d=fe("upload/v1beta/files",l._url),h=await this.fetchUploadUrl(d,i.sizeBytes,i.mimeType,u,l,n==null?void 0:n.httpOptions);return s.upload(t,h,this)}async uploadFileToFileSearchStore(t,n,r){var i;const s=this.clientOptions.uploader,o=await s.stat(n),a=String(o.size),l=(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const u=`upload/v1beta/${t}:uploadToFileSearchStore`,d=this.getFileName(n),h={};r!=null&&r.customMetadata&&(h.customMetadata=r.customMetadata),r!=null&&r.chunkingConfig&&(h.chunkingConfig=r.chunkingConfig);const p=await this.fetchUploadUrl(u,a,l,d,h,r==null?void 0:r.httpOptions);return s.uploadToFileSearchStore(n,p,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,n,r,i,s,o){var a;let l={};o?l=o:l={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},i?{"X-Goog-Upload-File-Name":i}:{})};const u=await this.request({path:t,body:JSON.stringify(s),httpMethod:"POST",httpOptions:l});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(a=u==null?void 0:u.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function Yh(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const n=e.status;let r;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?r=await e.json():r={error:{message:await e.text(),code:e.status,status:e.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new Nl({message:i,status:n}):new Error(i)}}function yC(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof e.body=="string"&&e.body.length>0)try{const s=JSON.parse(e.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],d=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&d&&typeof d=="object"&&!Array.isArray(d)?a[l]=r(d,u):(d&&u&&typeof d!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof d}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const i=r(n,t);e.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _C="mcp_used/unknown";let TC=!1;function N1(e){for(const t of e)if(EC(t)||typeof t=="object"&&"inputSchema"in t)return!0;return TC}function I1(e){var t;const n=(t=e[Nf])!==null&&t!==void 0?t:"";e[Nf]=(n+` ${_C}`).trimStart()}function EC(e){return e!==null&&typeof e=="object"&&e instanceof Lc}function SC(e,t=100){return Gi(this,arguments,function*(){let r,i=0;for(;i<t;){const s=yield $e(e.listTools({cursor:r}));for(const o of s.tools)yield yield $e(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class Lc{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new Lc(t,n)}async initialize(){var t,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const d of this.mcpClients)try{for(var a=!0,l=(n=void 0,zs(SC(d))),u;u=await l.next(),t=u.done,!t;a=!0){i=u.value,a=!1;const h=i;o.push(h);const p=h.name;if(s[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);s[p]=d}}catch(h){n={error:h}}finally{try{!a&&!t&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),mT(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const r of t)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function wC(e,t,n){const r=new aT;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),t(r)}class CC{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r}async connect(t){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=IC(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const d=new Promise(v=>{u=v}),h=t.callbacks,p=function(){u({})},m=this.apiClient,y={onopen:p,onmessage:v=>{wC(m,h.onmessage,v)},onerror:(n=h==null?void 0:h.onerror)!==null&&n!==void 0?n:function(v){},onclose:(r=h==null?void 0:h.onclose)!==null&&r!==void 0?r:function(v){}},x=this.webSocketFactory.create(l,NC(o),y);x.connect(),await d;const _={setup:{model:Le(this.apiClient,t.model)}};return x.send(JSON.stringify(_)),new AC(x,this.apiClient)}}class AC{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=dS(t);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=cS(t);this.conn.send(JSON.stringify(n))}sendPlaybackControl(t){const n={playbackControl:t};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Fi.PLAY)}pause(){this.sendPlaybackControl(Fi.PAUSE)}stop(){this.sendPlaybackControl(Fi.STOP)}resetContext(){this.sendPlaybackControl(Fi.RESET_CONTEXT)}close(){this.conn.close()}}function NC(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function IC(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kC="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function RC(e,t,n){const r=new oT;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(e.isVertexAI()){const o=mS(s);Object.assign(r,o)}else Object.assign(r,s);t(r)}class PC{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r,this.music=new CC(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,r,i,s,o,a;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let d;const h=this.apiClient.getHeaders();t.config&&t.config.tools&&N1(t.config.tools)&&I1(h);const p=LC(h);if(this.apiClient.isVertexAI())d=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p,d);else{const M=this.apiClient.getApiKey();let B="BidiGenerateContent",J="key";M!=null&&M.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),B="BidiGenerateContentConstrained",J="access_token"),d=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${B}?${J}=${M}`}let m=()=>{};const y=new Promise(M=>{m=M}),x=t.callbacks,E=function(){var M;(M=x==null?void 0:x.onopen)===null||M===void 0||M.call(x),m({})},T=this.apiClient,_={onopen:E,onmessage:M=>{RC(T,x.onmessage,M)},onerror:(n=x==null?void 0:x.onerror)!==null&&n!==void 0?n:function(M){},onclose:(r=x==null?void 0:x.onclose)!==null&&r!==void 0?r:function(M){}},v=this.webSocketFactory.create(d,DC(p),_);v.connect(),await y;let C=Le(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&C.startsWith("publishers/")){const M=this.apiClient.getProject(),B=this.apiClient.getLocation();C=`projects/${M}/locations/${B}/`+C}let D={};this.apiClient.isVertexAI()&&((i=t.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[$a.AUDIO]}:t.config.responseModalities=[$a.AUDIO]),!((s=t.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const F=(a=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],I=[];for(const M of F)if(this.isCallableTool(M)){const B=M;I.push(await B.tool())}else I.push(M);I.length>0&&(t.config.tools=I);const L={model:C,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?D=fS(this.apiClient,L):D=uS(this.apiClient,L),delete D.config,v.send(JSON.stringify(D)),new MC(v,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const FC={turnComplete:!0};class MC{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=xn(n.turns),t.isVertexAI()||(r=r.map(i=>Il(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!t.isVertexAI()&&!("id"in s))throw new Error(kC)}return{toolResponse:{functionResponses:r}}}sendClientContent(t){t=Object.assign(Object.assign({},FC),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:pS(t)}:n={realtimeInput:hS(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function DC(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function LC(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Xh=10;function Qh(e){var t,n,r;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let i=!1;for(const o of(n=e==null?void 0:e.tools)!==null&&n!==void 0?n:[])if(Hi(o)){i=!0;break}if(!i)return!0;const s=(r=e==null?void 0:e.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function Hi(e){return"callTool"in e&&typeof e.callTool=="function"}function UC(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(i=>Hi(i)))!==null&&r!==void 0?r:!1}function jh(e){var t;const n=[];return!((t=e==null?void 0:e.config)===null||t===void 0)&&t.tools&&e.config.tools.forEach((r,i)=>{if(Hi(r))return;const s=r;s.functionDeclarations&&s.functionDeclarations.length>0&&n.push(i)}),n}function Zh(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class OC extends cr{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>{var r,i,s,o,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!UC(n)||Qh(n.config))return await this.generateContentInternal(l);const u=jh(n);if(u.length>0){const x=u.map(E=>`tools[${E}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${x}.`)}let d,h;const p=xn(l.contents),m=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:Xh;let y=0;for(;y<m&&(d=await this.generateContentInternal(l),!(!d.functionCalls||d.functionCalls.length===0));){const x=d.candidates[0].content,E=[];for(const T of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(Hi(T)){const v=await T.callTool(d.functionCalls);E.push(...v)}y++,h={role:"user",parts:E},l.contents=xn(l.contents),l.contents.push(x),l.contents.push(h),Zh(l.config)&&(p.push(x),p.push(h))}return Zh(l.config)&&(d.automaticFunctionCallingHistory=p),d},this.generateContentStream=async n=>{var r,i,s,o,a;if(this.maybeMoveToResponseJsonSchem(n),Qh(n.config)){const h=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(h)}const l=jh(n);if(l.length>0){const h=l.map(p=>`tools[${p}]`).join(", ");throw new Error(`Incompatible tools found at ${h}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const u=(s=(i=(r=n==null?void 0:n.config)===null||r===void 0?void 0:r.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,d=(a=(o=n==null?void 0:n.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(u&&!d)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:o.push(l);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new ui(ar.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,s,o,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var n,r,i;const s=(n=t.config)===null||n===void 0?void 0:n.tools;if(!s)return t;const o=await Promise.all(s.map(async l=>Hi(l)?await l.tool():l)),a={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:o})};if(a.config.tools=o,t.config&&t.config.tools&&N1(t.config.tools)){const l=(i=(r=t.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),I1(u),a.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(t){var n,r,i;const s=new Map;for(const o of(r=(n=t.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Hi(o)){const a=o,l=await a.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,a)}}return s}async processAfcStream(t){var n,r,i;const s=(i=(r=(n=t.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:Xh;let o=!1,a=0;const l=await this.initAfcToolsMap(t);return function(u,d,h){var p,m;return Gi(this,arguments,function*(){for(var y,x,E,T;a<s;){o&&(a++,o=!1);const D=yield $e(u.processParamsMaybeAddMcpUsage(h)),F=yield $e(u.generateContentStreamInternal(D)),I=[],L=[];try{for(var _=!0,v=(x=void 0,zs(F)),C;C=yield $e(v.next()),y=C.done,!y;_=!0){T=C.value,_=!1;const M=T;if(yield yield $e(M),M.candidates&&(!((p=M.candidates[0])===null||p===void 0)&&p.content)){L.push(M.candidates[0].content);for(const B of(m=M.candidates[0].content.parts)!==null&&m!==void 0?m:[])if(a<s&&B.functionCall){if(!B.functionCall.name)throw new Error("Function call name was not returned by the model.");if(d.has(B.functionCall.name)){const J=yield $e(d.get(B.functionCall.name).callTool([B.functionCall]));I.push(...J)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${d.keys()}, mising tool: ${B.functionCall.name}`)}}}}catch(M){x={error:M}}finally{try{!_&&!y&&(E=v.return)&&(yield $e(E.call(v)))}finally{if(x)throw x.error}}if(I.length>0){o=!0;const M=new Ss;M.candidates=[{content:{role:"user",parts:I}}],yield yield $e(M);const B=[];B.push(...L),B.push({role:"user",parts:I});const J=xn(h.contents).concat(B);h.contents=J}else break}})}(this,l,t)}async generateContentInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=qh(this.apiClient,t);return a=fe("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=Jh(d),p=new Ss;return Object.assign(p,h),p})}else{const u=Wh(this.apiClient,t);return a=fe("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=$h(d),p=new Ss;return Object.assign(p,h),p})}}async generateContentStreamInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=qh(this.apiClient,t);return a=fe("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(h){return Gi(this,arguments,function*(){var p,m,y,x;try{for(var E=!0,T=zs(h),_;_=yield $e(T.next()),p=_.done,!p;E=!0){x=_.value,E=!1;const v=x,C=Jh(yield $e(v.json()));C.sdkHttpResponse={headers:v.headers};const D=new Ss;Object.assign(D,C),yield yield $e(D)}}catch(v){m={error:v}}finally{try{!E&&!p&&(y=T.return)&&(yield $e(y.call(T)))}finally{if(m)throw m.error}}})})}else{const u=Wh(this.apiClient,t);return a=fe("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(h){return Gi(this,arguments,function*(){var p,m,y,x;try{for(var E=!0,T=zs(h),_;_=yield $e(T.next()),p=_.done,!p;E=!0){x=_.value,E=!1;const v=x,C=$h(yield $e(v.json()));C.sdkHttpResponse={headers:v.headers};const D=new Ss;Object.assign(D,C),yield yield $e(D)}}catch(v){m={error:v}}finally{try{!E&&!p&&(y=T.return)&&(yield $e(y.call(T)))}finally{if(m)throw m.error}}})})}}async embedContent(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=qS(this.apiClient,t);return a=fe("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=JS(d),p=new Ih;return Object.assign(p,h),p})}else{const u=WS(this.apiClient,t);return a=fe("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=$S(d),p=new Ih;return Object.assign(p,h),p})}}async generateImagesInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=iw(this.apiClient,t);return a=fe("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=ow(d),p=new kh;return Object.assign(p,h),p})}else{const u=rw(this.apiClient,t);return a=fe("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=sw(d),p=new kh;return Object.assign(p,h),p})}}async editImageInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=VS(this.apiClient,t);return s=fe("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const u=GS(l),d=new Y_;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=iC(this.apiClient,t);return s=fe("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const u=sC(l),d=new X_;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=bw(this.apiClient,t);return s=fe("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=Vw(l),d=new Q_;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=$w(this.apiClient,t);return s=fe("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=Jw(l),d=new j_;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Sw(this.apiClient,t);return a=fe("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>Af(d))}else{const u=Ew(this.apiClient,t);return a=fe("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>Cf(d))}}async listInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Fw(this.apiClient,t);return a=fe("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=Dw(d),p=new Rh;return Object.assign(p,h),p})}else{const u=Pw(this.apiClient,t);return a=fe("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=Mw(d),p=new Rh;return Object.assign(p,h),p})}}async update(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=nC(this.apiClient,t);return a=fe("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>Af(d))}else{const u=tC(this.apiClient,t);return a=fe("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>Cf(d))}}async delete(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=US(this.apiClient,t);return a=fe("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=BS(d),p=new Ph;return Object.assign(p,h),p})}else{const u=LS(this.apiClient,t);return a=fe("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=OS(d),p=new Ph;return Object.assign(p,h),p})}}async countTokens(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=FS(this.apiClient,t);return a=fe("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=DS(d),p=new Fh;return Object.assign(p,h),p})}else{const u=PS(this.apiClient,t);return a=fe("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=MS(d),p=new Fh;return Object.assign(p,h),p})}}async computeTokens(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=wS(this.apiClient,t);return s=fe("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const u=CS(l),d=new Z_;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=dw(this.apiClient,t);return a=fe("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=fw(d),p=new Ja;return Object.assign(p,h),p})}else{const u=cw(this.apiClient,t);return a=fe("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>{const h=uw(d),p=new Ja;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class BC extends cr{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=z_(t);return a=fe("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o}else{const u=H_(t);return a=fe("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o}}async fetchPredictVideosOperationInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=L_(t);return s=fe("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bC(e){const t={},n=f(e,["data"]);if(n!=null&&c(t,["data"],n),f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=f(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function VC(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>YC(s))),c(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&c(t,["role"],r),t}function GC(e,t,n){const r={},i=f(t,["expireTime"]);n!==void 0&&i!=null&&c(n,["expireTime"],i);const s=f(t,["newSessionExpireTime"]);n!==void 0&&s!=null&&c(n,["newSessionExpireTime"],s);const o=f(t,["uses"]);n!==void 0&&o!=null&&c(n,["uses"],o);const a=f(t,["liveConnectConstraints"]);n!==void 0&&a!=null&&c(n,["bidiGenerateContentSetup"],KC(e,a));const l=f(t,["lockAdditionalFields"]);return n!==void 0&&l!=null&&c(n,["fieldMask"],l),r}function HC(e,t){const n={},r=f(t,["config"]);return r!=null&&c(n,["config"],GC(e,r,n)),n}function zC(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&c(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function WC(e){const t={},n=f(e,["id"]);n!=null&&c(t,["id"],n);const r=f(e,["args"]);r!=null&&c(t,["args"],r);const i=f(e,["name"]);if(i!=null&&c(t,["name"],i),f(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function qC(e){const t={};if(f(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=f(e,["enableWidget"]);return n!=null&&c(t,["enableWidget"],n),t}function $C(e){const t={};if(f(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=f(e,["timeRangeFilter"]);return n!=null&&c(t,["timeRangeFilter"],n),t}function JC(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&c(t,["setup","generationConfig"],r);const i=f(e,["responseModalities"]);t!==void 0&&i!=null&&c(t,["setup","generationConfig","responseModalities"],i);const s=f(e,["temperature"]);t!==void 0&&s!=null&&c(t,["setup","generationConfig","temperature"],s);const o=f(e,["topP"]);t!==void 0&&o!=null&&c(t,["setup","generationConfig","topP"],o);const a=f(e,["topK"]);t!==void 0&&a!=null&&c(t,["setup","generationConfig","topK"],a);const l=f(e,["maxOutputTokens"]);t!==void 0&&l!=null&&c(t,["setup","generationConfig","maxOutputTokens"],l);const u=f(e,["mediaResolution"]);t!==void 0&&u!=null&&c(t,["setup","generationConfig","mediaResolution"],u);const d=f(e,["seed"]);t!==void 0&&d!=null&&c(t,["setup","generationConfig","seed"],d);const h=f(e,["speechConfig"]);t!==void 0&&h!=null&&c(t,["setup","generationConfig","speechConfig"],Dc(h));const p=f(e,["thinkingConfig"]);t!==void 0&&p!=null&&c(t,["setup","generationConfig","thinkingConfig"],p);const m=f(e,["enableAffectiveDialog"]);t!==void 0&&m!=null&&c(t,["setup","generationConfig","enableAffectiveDialog"],m);const y=f(e,["systemInstruction"]);t!==void 0&&y!=null&&c(t,["setup","systemInstruction"],VC(Dt(y)));const x=f(e,["tools"]);if(t!==void 0&&x!=null){let F=ss(x);Array.isArray(F)&&(F=F.map(I=>QC(is(I)))),c(t,["setup","tools"],F)}const E=f(e,["sessionResumption"]);t!==void 0&&E!=null&&c(t,["setup","sessionResumption"],XC(E));const T=f(e,["inputAudioTranscription"]);t!==void 0&&T!=null&&c(t,["setup","inputAudioTranscription"],T);const _=f(e,["outputAudioTranscription"]);t!==void 0&&_!=null&&c(t,["setup","outputAudioTranscription"],_);const v=f(e,["realtimeInputConfig"]);t!==void 0&&v!=null&&c(t,["setup","realtimeInputConfig"],v);const C=f(e,["contextWindowCompression"]);t!==void 0&&C!=null&&c(t,["setup","contextWindowCompression"],C);const D=f(e,["proactivity"]);return t!==void 0&&D!=null&&c(t,["setup","proactivity"],D),n}function KC(e,t){const n={},r=f(t,["model"]);r!=null&&c(n,["setup","model"],Le(e,r));const i=f(t,["config"]);return i!=null&&c(n,["config"],JC(i,n)),n}function YC(e){const t={},n=f(e,["mediaResolution"]);n!=null&&c(t,["mediaResolution"],n);const r=f(e,["codeExecutionResult"]);r!=null&&c(t,["codeExecutionResult"],r);const i=f(e,["executableCode"]);i!=null&&c(t,["executableCode"],i);const s=f(e,["fileData"]);s!=null&&c(t,["fileData"],zC(s));const o=f(e,["functionCall"]);o!=null&&c(t,["functionCall"],WC(o));const a=f(e,["functionResponse"]);a!=null&&c(t,["functionResponse"],a);const l=f(e,["inlineData"]);l!=null&&c(t,["inlineData"],bC(l));const u=f(e,["text"]);u!=null&&c(t,["text"],u);const d=f(e,["thought"]);d!=null&&c(t,["thought"],d);const h=f(e,["thoughtSignature"]);h!=null&&c(t,["thoughtSignature"],h);const p=f(e,["videoMetadata"]);return p!=null&&c(t,["videoMetadata"],p),t}function XC(e){const t={},n=f(e,["handle"]);if(n!=null&&c(t,["handle"],n),f(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function QC(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>h)),c(t,["functionDeclarations"],d)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearchRetrieval"]);r!=null&&c(t,["googleSearchRetrieval"],r);const i=f(e,["computerUse"]);i!=null&&c(t,["computerUse"],i);const s=f(e,["fileSearch"]);s!=null&&c(t,["fileSearch"],s);const o=f(e,["codeExecution"]);if(o!=null&&c(t,["codeExecution"],o),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=f(e,["googleMaps"]);a!=null&&c(t,["googleMaps"],qC(a));const l=f(e,["googleSearch"]);l!=null&&c(t,["googleSearch"],$C(l));const u=f(e,["urlContext"]);return u!=null&&c(t,["urlContext"],u),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jC(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);t.push(...i)}else t.push(n)}return t.join(",")}function ZC(e,t){let n=null;const r=e.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(e.bidiGenerateContentSetup=s,n=s):delete e.bidiGenerateContentSetup}else r!==void 0&&delete e.bidiGenerateContentSetup;const i=e.fieldMask;if(n){const s=jC(n);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)s?e.fieldMask=s:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?e.fieldMask=l.join(","):delete e.fieldMask}else delete e.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}class eA extends cr{constructor(t){super(),this.apiClient=t}async create(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=HC(this.apiClient,t);s=fe("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=ZC(a,t.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tA(e,t){const n={},r=f(e,["displayName"]);return t!==void 0&&r!=null&&c(t,["displayName"],r),n}function nA(e){const t={},n=f(e,["config"]);return n!=null&&tA(n,t),t}function rA(e,t){const n={},r=f(e,["force"]);return t!==void 0&&r!=null&&c(t,["_query","force"],r),n}function iA(e){const t={},n=f(e,["name"]);n!=null&&c(t,["_url","name"],n);const r=f(e,["config"]);return r!=null&&rA(r,t),t}function sA(e){const t={},n=f(e,["name"]);return n!=null&&c(t,["_url","name"],n),t}function oA(e,t){const n={},r=f(e,["customMetadata"]);if(t!==void 0&&r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),c(t,["customMetadata"],s)}const i=f(e,["chunkingConfig"]);return t!==void 0&&i!=null&&c(t,["chunkingConfig"],i),n}function aA(e){const t={},n=f(e,["name"]);n!=null&&c(t,["name"],n);const r=f(e,["metadata"]);r!=null&&c(t,["metadata"],r);const i=f(e,["done"]);i!=null&&c(t,["done"],i);const s=f(e,["error"]);s!=null&&c(t,["error"],s);const o=f(e,["response"]);return o!=null&&c(t,["response"],uA(o)),t}function lA(e){const t={},n=f(e,["fileSearchStoreName"]);n!=null&&c(t,["_url","file_search_store_name"],n);const r=f(e,["fileName"]);r!=null&&c(t,["fileName"],r);const i=f(e,["config"]);return i!=null&&oA(i,t),t}function uA(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["parent"]);r!=null&&c(t,["parent"],r);const i=f(e,["documentName"]);return i!=null&&c(t,["documentName"],i),t}function fA(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&c(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);return t!==void 0&&i!=null&&c(t,["_query","pageToken"],i),n}function cA(e){const t={},n=f(e,["config"]);return n!=null&&fA(n,t),t}function dA(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=f(e,["fileSearchStores"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),c(t,["fileSearchStores"],s)}return t}function hA(e,t){const n={},r=f(e,["mimeType"]);t!==void 0&&r!=null&&c(t,["mimeType"],r);const i=f(e,["displayName"]);t!==void 0&&i!=null&&c(t,["displayName"],i);const s=f(e,["customMetadata"]);if(t!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),c(t,["customMetadata"],a)}const o=f(e,["chunkingConfig"]);return t!==void 0&&o!=null&&c(t,["chunkingConfig"],o),n}function pA(e){const t={},n=f(e,["fileSearchStoreName"]);n!=null&&c(t,["_url","file_search_store_name"],n);const r=f(e,["config"]);return r!=null&&hA(r,t),t}function mA(e){const t={},n=f(e,["sdkHttpResponse"]);return n!=null&&c(t,["sdkHttpResponse"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gA(e,t){const n={},r=f(e,["force"]);return t!==void 0&&r!=null&&c(t,["_query","force"],r),n}function xA(e){const t={},n=f(e,["name"]);n!=null&&c(t,["_url","name"],n);const r=f(e,["config"]);return r!=null&&gA(r,t),t}function vA(e){const t={},n=f(e,["name"]);return n!=null&&c(t,["_url","name"],n),t}function yA(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&c(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);return t!==void 0&&i!=null&&c(t,["_query","pageToken"],i),n}function _A(e){const t={},n=f(e,["parent"]);n!=null&&c(t,["_url","parent"],n);const r=f(e,["config"]);return r!=null&&yA(r,t),t}function TA(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=f(e,["documents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),c(t,["documents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class EA extends cr{constructor(t){super(),this.apiClient=t,this.list=async n=>new ui(ar.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=vA(t);return s=fe("{name}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(t){var n,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=xA(t);i=fe("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=_A(t);return s=fe("{parent}/documents",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=TA(l),d=new eT;return Object.assign(d,u),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class SA extends cr{constructor(t,n=new EA(t)){super(),this.apiClient=t,this.documents=n,this.list=async(r={})=>new ui(ar.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(r),r)}async uploadToFileSearchStore(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(t.fileSearchStoreName,t.file,t.config)}async create(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=nA(t);return s=fe("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async get(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=sA(t);return s=fe("{name}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(t){var n,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=iA(t);i=fe("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=cA(t);return s=fe("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=dA(l),d=new tT;return Object.assign(d,u),d})}}async uploadToFileSearchStoreInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=pA(t);return s=fe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=mA(l),d=new nT;return Object.assign(d,u),d})}}async importFile(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=lA(t);return s=fe("{file_search_store_name}:importFile",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=aA(l),d=new kc;return Object.assign(d,u),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wA(e,t){const n={},r=f(e,["name"]);return r!=null&&c(n,["_url","name"],r),n}function CA(e,t){const n={},r=f(e,["name"]);return r!=null&&c(n,["_url","name"],r),n}function AA(e,t,n){const r={};if(f(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=f(e,["tunedModelDisplayName"]);if(t!==void 0&&i!=null&&c(t,["displayName"],i),f(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=f(e,["epochCount"]);t!==void 0&&s!=null&&c(t,["tuningTask","hyperparameters","epochCount"],s);const o=f(e,["learningRateMultiplier"]);if(o!=null&&c(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),f(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(f(e,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(f(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=f(e,["batchSize"]);t!==void 0&&a!=null&&c(t,["tuningTask","hyperparameters","batchSize"],a);const l=f(e,["learningRate"]);if(t!==void 0&&l!=null&&c(t,["tuningTask","hyperparameters","learningRate"],l),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(f(e,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function NA(e,t,n){const r={};let i=f(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const m=f(e,["validationDataset"]);t!==void 0&&m!=null&&c(t,["supervisedTuningSpec"],ep(m))}else if(i==="PREFERENCE_TUNING"){const m=f(e,["validationDataset"]);t!==void 0&&m!=null&&c(t,["preferenceOptimizationSpec"],ep(m))}const s=f(e,["tunedModelDisplayName"]);t!==void 0&&s!=null&&c(t,["tunedModelDisplayName"],s);const o=f(e,["description"]);t!==void 0&&o!=null&&c(t,["description"],o);let a=f(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const m=f(e,["epochCount"]);t!==void 0&&m!=null&&c(t,["supervisedTuningSpec","hyperParameters","epochCount"],m)}else if(a==="PREFERENCE_TUNING"){const m=f(e,["epochCount"]);t!==void 0&&m!=null&&c(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],m)}let l=f(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const m=f(e,["learningRateMultiplier"]);t!==void 0&&m!=null&&c(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],m)}else if(l==="PREFERENCE_TUNING"){const m=f(e,["learningRateMultiplier"]);t!==void 0&&m!=null&&c(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],m)}let u=f(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const m=f(e,["exportLastCheckpointOnly"]);t!==void 0&&m!=null&&c(t,["supervisedTuningSpec","exportLastCheckpointOnly"],m)}else if(u==="PREFERENCE_TUNING"){const m=f(e,["exportLastCheckpointOnly"]);t!==void 0&&m!=null&&c(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],m)}let d=f(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const m=f(e,["adapterSize"]);t!==void 0&&m!=null&&c(t,["supervisedTuningSpec","hyperParameters","adapterSize"],m)}else if(d==="PREFERENCE_TUNING"){const m=f(e,["adapterSize"]);t!==void 0&&m!=null&&c(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],m)}if(f(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(f(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const h=f(e,["labels"]);t!==void 0&&h!=null&&c(t,["labels"],h);const p=f(e,["beta"]);return t!==void 0&&p!=null&&c(t,["preferenceOptimizationSpec","hyperParameters","beta"],p),r}function IA(e,t){const n={},r=f(e,["baseModel"]);r!=null&&c(n,["baseModel"],r);const i=f(e,["preTunedModel"]);i!=null&&c(n,["preTunedModel"],i);const s=f(e,["trainingDataset"]);s!=null&&bA(s);const o=f(e,["config"]);return o!=null&&AA(o,n),n}function kA(e,t){const n={},r=f(e,["baseModel"]);r!=null&&c(n,["baseModel"],r);const i=f(e,["preTunedModel"]);i!=null&&c(n,["preTunedModel"],i);const s=f(e,["trainingDataset"]);s!=null&&VA(s,n,t);const o=f(e,["config"]);return o!=null&&NA(o,n,t),n}function RA(e,t){const n={},r=f(e,["name"]);return r!=null&&c(n,["_url","name"],r),n}function PA(e,t){const n={},r=f(e,["name"]);return r!=null&&c(n,["_url","name"],r),n}function FA(e,t,n){const r={},i=f(e,["pageSize"]);t!==void 0&&i!=null&&c(t,["_query","pageSize"],i);const s=f(e,["pageToken"]);t!==void 0&&s!=null&&c(t,["_query","pageToken"],s);const o=f(e,["filter"]);return t!==void 0&&o!=null&&c(t,["_query","filter"],o),r}function MA(e,t,n){const r={},i=f(e,["pageSize"]);t!==void 0&&i!=null&&c(t,["_query","pageSize"],i);const s=f(e,["pageToken"]);t!==void 0&&s!=null&&c(t,["_query","pageToken"],s);const o=f(e,["filter"]);return t!==void 0&&o!=null&&c(t,["_query","filter"],o),r}function DA(e,t){const n={},r=f(e,["config"]);return r!=null&&FA(r,n),n}function LA(e,t){const n={},r=f(e,["config"]);return r!=null&&MA(r,n),n}function UA(e,t){const n={},r=f(e,["sdkHttpResponse"]);r!=null&&c(n,["sdkHttpResponse"],r);const i=f(e,["nextPageToken"]);i!=null&&c(n,["nextPageToken"],i);const s=f(e,["tunedModels"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>k1(a))),c(n,["tuningJobs"],o)}return n}function OA(e,t){const n={},r=f(e,["sdkHttpResponse"]);r!=null&&c(n,["sdkHttpResponse"],r);const i=f(e,["nextPageToken"]);i!=null&&c(n,["nextPageToken"],i);const s=f(e,["tuningJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>If(a))),c(n,["tuningJobs"],o)}return n}function BA(e,t){const n={},r=f(e,["name"]);r!=null&&c(n,["model"],r);const i=f(e,["name"]);return i!=null&&c(n,["endpoint"],i),n}function bA(e,t){const n={};if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=f(e,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),c(n,["examples","examples"],i)}return n}function VA(e,t,n){const r={};let i=f(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const o=f(e,["gcsUri"]);t!==void 0&&o!=null&&c(t,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(i==="PREFERENCE_TUNING"){const o=f(e,["gcsUri"]);t!==void 0&&o!=null&&c(t,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let s=f(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=f(e,["vertexDatasetResource"]);t!==void 0&&o!=null&&c(t,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=f(e,["vertexDatasetResource"]);t!==void 0&&o!=null&&c(t,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(f(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function k1(e,t){const n={},r=f(e,["sdkHttpResponse"]);r!=null&&c(n,["sdkHttpResponse"],r);const i=f(e,["name"]);i!=null&&c(n,["name"],i);const s=f(e,["state"]);s!=null&&c(n,["state"],f1(s));const o=f(e,["createTime"]);o!=null&&c(n,["createTime"],o);const a=f(e,["tuningTask","startTime"]);a!=null&&c(n,["startTime"],a);const l=f(e,["tuningTask","completeTime"]);l!=null&&c(n,["endTime"],l);const u=f(e,["updateTime"]);u!=null&&c(n,["updateTime"],u);const d=f(e,["description"]);d!=null&&c(n,["description"],d);const h=f(e,["baseModel"]);h!=null&&c(n,["baseModel"],h);const p=f(e,["_self"]);return p!=null&&c(n,["tunedModel"],BA(p)),n}function If(e,t){const n={},r=f(e,["sdkHttpResponse"]);r!=null&&c(n,["sdkHttpResponse"],r);const i=f(e,["name"]);i!=null&&c(n,["name"],i);const s=f(e,["state"]);s!=null&&c(n,["state"],f1(s));const o=f(e,["createTime"]);o!=null&&c(n,["createTime"],o);const a=f(e,["startTime"]);a!=null&&c(n,["startTime"],a);const l=f(e,["endTime"]);l!=null&&c(n,["endTime"],l);const u=f(e,["updateTime"]);u!=null&&c(n,["updateTime"],u);const d=f(e,["error"]);d!=null&&c(n,["error"],d);const h=f(e,["description"]);h!=null&&c(n,["description"],h);const p=f(e,["baseModel"]);p!=null&&c(n,["baseModel"],p);const m=f(e,["tunedModel"]);m!=null&&c(n,["tunedModel"],m);const y=f(e,["preTunedModel"]);y!=null&&c(n,["preTunedModel"],y);const x=f(e,["supervisedTuningSpec"]);x!=null&&c(n,["supervisedTuningSpec"],x);const E=f(e,["preferenceOptimizationSpec"]);E!=null&&c(n,["preferenceOptimizationSpec"],E);const T=f(e,["tuningDataStats"]);T!=null&&c(n,["tuningDataStats"],T);const _=f(e,["encryptionSpec"]);_!=null&&c(n,["encryptionSpec"],_);const v=f(e,["partnerModelTuningSpec"]);v!=null&&c(n,["partnerModelTuningSpec"],v);const C=f(e,["customBaseModel"]);C!=null&&c(n,["customBaseModel"],C);const D=f(e,["experiment"]);D!=null&&c(n,["experiment"],D);const F=f(e,["labels"]);F!=null&&c(n,["labels"],F);const I=f(e,["outputUri"]);I!=null&&c(n,["outputUri"],I);const L=f(e,["pipelineJob"]);L!=null&&c(n,["pipelineJob"],L);const M=f(e,["serviceAccount"]);M!=null&&c(n,["serviceAccount"],M);const B=f(e,["tunedModelDisplayName"]);B!=null&&c(n,["tunedModelDisplayName"],B);const J=f(e,["veoTuningSpec"]);return J!=null&&c(n,["veoTuningSpec"],J),n}function GA(e,t){const n={},r=f(e,["sdkHttpResponse"]);r!=null&&c(n,["sdkHttpResponse"],r);const i=f(e,["name"]);i!=null&&c(n,["name"],i);const s=f(e,["metadata"]);s!=null&&c(n,["metadata"],s);const o=f(e,["done"]);o!=null&&c(n,["done"],o);const a=f(e,["error"]);return a!=null&&c(n,["error"],a),n}function ep(e,t){const n={},r=f(e,["gcsUri"]);r!=null&&c(n,["validationDatasetUri"],r);const i=f(e,["vertexDatasetResource"]);return i!=null&&c(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class HA extends cr{constructor(t){super(),this.apiClient=t,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new ui(ar.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:Tf.JOB_STATE_QUEUED}}}}async getInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=PA(t);return a=fe("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>If(d))}else{const u=RA(t);return a=fe("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>k1(d))}}async listInternal(t){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=LA(t);return a=fe("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=OA(d),p=new Mh;return Object.assign(p,h),p})}else{const u=DA(t);return a=fe("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),o.then(d=>{const h=UA(d),p=new Mh;return Object.assign(p,h),p})}}async cancel(t){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=CA(t);o=fe("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=wA(t);o=fe("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=kA(t,t);return s=fe("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>If(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=IA(t);return s=fe("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>GA(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zA{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const WA=1024*1024*8,qA=3,$A=1e3,JA=2,Ya="x-goog-upload-status";async function KA(e,t,n){var r;const i=await R1(e,t,n),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[Ya])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function YA(e,t,n){var r;const i=await R1(e,t,n),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[Ya])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const o=i1(s),a=new Rc;return Object.assign(a,o),a}async function R1(e,t,n){var r,i;let s=0,o=0,a=new Ef(new Response),l="upload";for(s=e.size;o<s;){const u=Math.min(WA,s-o),d=e.slice(o,o+u);o+u>=s&&(l+=", finalize");let h=0,p=$A;for(;h<qA&&(a=await n.request({path:"",body:d,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(o),"Content-Length":String(u)}}}),!(!((r=a==null?void 0:a.headers)===null||r===void 0)&&r[Ya]));)h++,await QA(p),p=p*JA;if(o+=u,((i=a==null?void 0:a.headers)===null||i===void 0?void 0:i[Ya])!=="active")break;if(s<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function XA(e){return{size:e.size,type:e.type}}function QA(e){return new Promise(t=>setTimeout(t,e))}class jA{async upload(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await KA(t,n,r)}async uploadToFileSearchStore(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await YA(t,n,r)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await XA(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ZA{create(t,n,r){return new eN(t,n,r)}}class eN{constructor(t,n,r){this.url=t,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tp="x-goog-api-key";class tN{constructor(t){this.apiKey=t}async addAuthHeaders(t,n){if(t.get(tp)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(tp,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nN="gl-node/";class P1{constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const r=M_(t.httpOptions,t.vertexai,void 0,void 0);r&&(t.httpOptions?t.httpOptions.baseUrl=r:t.httpOptions={baseUrl:r}),this.apiVersion=t.apiVersion;const i=new tN(this.apiKey);this.apiClient=new vC({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:nN+"web",uploader:new jA,downloader:new zA}),this.models=new OC(this.apiClient),this.live=new PC(this.apiClient,i,new ZA),this.batches=new lE(this.apiClient),this.chats=new zE(this.models,this.apiClient),this.caches=new VE(this.apiClient),this.files=new ZE(this.apiClient),this.operations=new BC(this.apiClient),this.authTokens=new eA(this.apiClient),this.tunings=new HA(this.apiClient),this.fileSearchStores=new SA(this.apiClient)}}const ws=()=>Math.random().toString(36).substr(2,9),rN=e=>{try{return JSON.parse(e)}catch(t){console.warn("JSON truncated. Attempting repair...");let n=e.trim().replace(/,$/,"");(n.match(/"/g)||[]).length%2!==0&&(n+='"');const i=[];for(const s of n)s==="{"?i.push("}"):s==="["?i.push("]"):(s==="}"||s==="]")&&i[i.length-1]===s&&i.pop();n+=i.reverse().join("");try{return JSON.parse(n)}catch(s){throw console.error("Repair failed",s),t}}},F1={type:we.OBJECT,properties:{name:{type:we.STRING,description:"Name of the feature (e.g., 'Wing Color')"},imageUrl:{type:we.STRING,description:"URL for feature illustration"},states:{type:we.ARRAY,items:{type:we.STRING,description:"A state description (e.g., 'Blue')"}}},required:["name","states"]},M1={type:we.OBJECT,properties:{label:{type:we.STRING,description:"Title of the link (e.g., 'Wikipedia', 'GBIF')"},url:{type:we.STRING,description:"Full URL"}},required:["label","url"]},D1={type:we.OBJECT,properties:{projectName:{type:we.STRING},projectDescription:{type:we.STRING},features:{type:we.ARRAY,items:F1},entities:{type:we.ARRAY,items:{type:we.OBJECT,properties:{name:{type:we.STRING},description:{type:we.STRING},imageUrl:{type:we.STRING,description:"URL for species image."},links:{type:we.ARRAY,items:M1,description:"External resources"},traits:{type:we.ARRAY,items:{type:we.OBJECT,properties:{featureName:{type:we.STRING,description:"Must match one of the feature names exactly"},stateValue:{type:we.STRING,description:"Must match one of the state values for that feature exactly"}},required:["featureName","stateValue"]}}},required:["name","description","traits"]}}},required:["projectName","projectDescription","features","entities"]},iN={type:we.OBJECT,properties:{projectName:{type:we.STRING},projectDescription:{type:we.STRING},features:{type:we.ARRAY,items:F1},entities:{type:we.ARRAY,items:{type:we.OBJECT,properties:{name:{type:we.STRING},description:{type:we.STRING},imageUrl:{type:we.STRING,description:"URL if found, else empty."},links:{type:we.ARRAY,items:M1,description:"External resources"},traits:{type:we.ARRAY,items:{type:we.OBJECT,properties:{featureName:{type:we.STRING,description:"Must match one of the feature names exactly"},stateValue:{type:we.STRING,description:"Must match one of the state values for that feature exactly"}},required:["featureName","stateValue"]}}},required:["name","description","traits"]}}},required:["projectName","projectDescription","features","entities"]},L1=e=>{const t=e.language==="pt"?"All content (Project Name, Description, Features, States, Entities, Descriptions) MUST be in Portuguese (Brazil).":"All content must be in English.";let n=e.includeSpeciesImages?"For each entity, provide a valid, DIRECT public URL to an image file (must end in .jpg, .jpeg, or .png) representing the species. The URL must point directly to the image binary, not a landing page.":"Leave `imageUrl` empty for entities.",r=e.includeFeatureImages?"For each feature, provide a valid, DIRECT public URL to an image file (must end in .jpg, .jpeg, or .png) illustrating the trait. The URL must point directly to the image binary, not a landing page.":"Leave `imageUrl` empty for features.",i=e.includeLinks?"For each entity, provide 1-2 reputable external links (e.g., Wikipedia, IUCN, GBIF, Flora e Funga do Brasil) in the 'links' array.":"Leave the 'links' array empty.";if(e.importedFile){let u="Extract ALL distinctive features found in the text.";e.featureFocus==="vegetative"?u="STRICTLY EXTRACT ONLY VEGETATIVE features (leaves, bark, stem, roots, growth habit). IGNORE reproductive features (flowers, fruits, seeds).":e.featureFocus==="reproductive"&&(u="STRICTLY EXTRACT ONLY REPRODUCTIVE features (flowers, fruits, seeds, inflorescence). IGNORE vegetative features.");let d="Maintain the descriptions as close to the original text as possible (Balanced).";e.detailLevel===1?d="SIMPLIFY the descriptions. Use shorter, easier sentences. Remove excessive jargon.":e.detailLevel===3&&(d="MAXIMIZE DETAIL. Keep all scientific terms, measurements, and nuances found in the text.");const h=`
      You are an expert biologist and data analyst.
      Your task is to analyze the provided document (PDF, Text, or Image) and extract a structured Matrix Identification Key.
      
      **Goal**: Extract entities and features to build a matrix.
      
      **CRITICAL INSTRUCTIONS**: 
      1. You must extract **EVERY SINGLE** species/entity found in the text. DO NOT truncate the list.
      2. **FILTER**: ${u}
      3. **DETAIL**: ${d}
      4. **MEDIA**: 
         - Species Images: ${n}
         - Feature Images: ${r}
         - External Links: ${i}
      5. ${t}
      
      **Format**: Return valid JSON.
      **IMPORTANT**: Do not include markdown code fences (\`\`\`json ... \`\`\`). Return raw JSON only. Ensure all keys and string values are properly escaped.
    `,p=`
      Analyze the attached file. Extract a comprehensive biological identification key.
      
      - Project Name: Derive from document title.
      - Description: Summary of content.
      - Entities: Extract ALL entities found.
      - Features: Extract distinctive traits based on the focus setting.
      - Matrix: Map traits to entities.
      
      If analyzing a Dichotomous Key, flatten the logic: assign all traits accumulated along the path to the species.
    `,m=[{inlineData:{mimeType:e.importedFile.mimeType,data:e.importedFile.data}},{text:p}];return{systemInstruction:h,prompt:p,parts:m,schema:iN}}let s="";e.featureFocus==="reproductive"?s="Focus primarily on reproductive features (e.g., flowers, fruits, seeds, cones, spores, inflorescence).":e.featureFocus==="vegetative"?s="Focus primarily on vegetative features (e.g., leaves, bark, stem, roots, growth habit, phyllo taxis).":s="Use a balanced mix of vegetative and reproductive features.";let o="";e.detailLevel===1?o="AUDIENCE: Children or General Public. Use simple, common language. Short descriptions. Avoid complex jargon.":e.detailLevel===3?o="AUDIENCE: Experts/Scientists. Use precise botanical/zoological terminology. Comprehensive descriptions. High detail.":o="AUDIENCE: Students/Enthusiasts. Balanced use of scientific terms with clear explanations.";const a=`
    You are an expert taxonomist and biologist. 
    Your task is to create an interactive identification key (matrix key) based strictly on the user's constraints.
    
    Constraints:
    1.  **Language**: ${t}
    2.  **Topic**: The general subject.
    3.  **Geography**: Restrict entities to this region/biome.
    4.  **Taxonomy**: Restrict to this Family/Genus/Order if specified.
    5.  **Quantity**: Generate exactly or close to the requested number of entities and features.
    6.  **Focus**: ${s}
    7.  **Detail Level**: ${o}
    8.  **Media**: 
        - Species Images: ${n}
        - Feature Images: ${r}
        - External Links: ${i}

    Output Requirements:
    1.  List of distinctive features. Each feature must have 2+ states.
    2.  List of entities.
    3.  Matrix: Assign correct states.
    4.  **Scientific Accuracy**: Ensure traits are factual.

    The response must be a structured JSON object.
    **IMPORTANT**: Do not include markdown code fences (\`\`\`json ... \`\`\`). Return raw JSON only. Ensure all keys and string values are properly escaped.
  `,l=`
    Create an identification key for: "${e.topic}".
    
    Constraints:
    - Language: ${e.language==="pt"?"Portuguese":"English"}
    - Geographic Scope: ${e.geography||"Global"}
    - Taxonomic Context: ${e.taxonomy||"General"}
    - Target Number of Entities: ${e.count}
    - Target Number of Features: ${e.featureCount}
    - Feature Focus: ${e.featureFocus}
    - Complexity Level: ${e.detailLevel}/3

    Ensure the features allow for effective separation of these entities.
  `;return{systemInstruction:a,prompt:l,schema:D1,parts:void 0}},sN=async(e,t,n)=>{if(!t)throw new Error("API Key is missing");const r=new P1({apiKey:t}),{systemInstruction:i,prompt:s,parts:o,schema:a}=L1(e);n&&n(`SYSTEM:
${i}

USER PROMPT:
${s}`);const l=o||s;return await U1(r,e.model,l,i,a)},oN=async(e,t,n="gemini-2.5-flash")=>{if(!t)throw new Error("API Key is missing");const r=new P1({apiKey:t});return await U1(r,n,e,"You are an expert biologist. Return ONLY valid JSON matching the schema. Do not include markdown code fences.",D1)};async function U1(e,t,n,r,i){const s=async o=>{var a,l;try{return await e.models.generateContent({model:o.trim(),contents:n,config:{systemInstruction:r,responseMimeType:"application/json",responseSchema:i,maxOutputTokens:65536}})}catch(u){if((a=u.message)!=null&&a.includes("404")||(l=u.message)!=null&&l.includes("NOT_FOUND")){const d="gemini-2.5-flash";if(o!==d)return console.warn(`Model ${o} not found, falling back to ${d}`),await s(d)}throw u}};try{const a=await s(t||"gemini-2.5-flash"),l=rN(a.text||"{}");if(!l.projectName)throw new Error("Invalid AI response");const u=l.features.map(h=>({id:ws(),name:h.name,imageUrl:h.imageUrl||"",states:h.states.map(p=>({id:ws(),label:p}))})),d=l.entities.map(h=>{const p={};h.traits.forEach(E=>{let T="",_="";if(typeof E=="string"){const v=E.indexOf(":");v>-1&&(T=E.substring(0,v).trim(),_=E.substring(v+1).trim())}else typeof E=="object"&&E!==null&&(T=E.featureName,_=E.stateValue);if(T&&_){const v=u.find(C=>C.name.toLowerCase()===T.toLowerCase());if(v){const C=v.states.find(D=>D.label.toLowerCase()===_.toLowerCase());C&&(p[v.id]||(p[v.id]=[]),p[v.id].push(C.id))}}});const m=h.imageUrl?h.imageUrl.trim():"",y=m.startsWith("http"),x=Array.isArray(h.links)?h.links:[];return{id:ws(),name:h.name,description:h.description,imageUrl:y?m:`https://picsum.photos/seed/${encodeURIComponent(h.name)}/400/300`,links:x.map(E=>({id:ws(),label:E.label||"Link",url:E.url||"#"})),traits:p}});return{id:ws(),name:l.projectName,description:l.projectDescription,features:u,entities:d}}catch(o){throw console.error("Gemini Generation Error:",o),o}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Xa={};Xa.version="0.18.5";var O1=1252,aN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],B1=function(e){aN.indexOf(e)!=-1&&(O1=e)};function lN(){B1(1252)}var po=function(e){B1(e)};function uN(){po(1200),lN()}var jo=function(t){return String.fromCharCode(t)},np=function(t){return String.fromCharCode(t)},Qa,Sr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function mo(e){for(var t="",n=0,r=0,i=0,s=0,o=0,a=0,l=0,u=0;u<e.length;)n=e.charCodeAt(u++),s=n>>2,r=e.charCodeAt(u++),o=(n&3)<<4|r>>4,i=e.charCodeAt(u++),a=(r&15)<<2|i>>6,l=i&63,isNaN(r)?a=l=64:isNaN(i)&&(l=64),t+=Sr.charAt(s)+Sr.charAt(o)+Sr.charAt(a)+Sr.charAt(l);return t}function lr(e){var t="",n=0,r=0,i=0,s=0,o=0,a=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=Sr.indexOf(e.charAt(u++)),o=Sr.indexOf(e.charAt(u++)),n=s<<2|o>>4,t+=String.fromCharCode(n),a=Sr.indexOf(e.charAt(u++)),r=(o&15)<<4|a>>2,a!==64&&(t+=String.fromCharCode(r)),l=Sr.indexOf(e.charAt(u++)),i=(a&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Ue=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),hr=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ii(e){return Ue?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function rp(e){return Ue?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var kn=function(t){return Ue?hr(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function Pl(e){if(typeof ArrayBuffer>"u")return kn(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=e.charCodeAt(r)&255;return t}function Ao(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function fN(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var wt=Ue?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:hr(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),i=0;for(t=0,n=0;t<e.length;n+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function cN(e){for(var t=[],n=0,r=e.length+250,i=ii(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[n++]=o;else if(o<2048)i[n++]=192|o>>6&31,i[n++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=e.charCodeAt(++s)&1023;i[n++]=240|o>>8&7,i[n++]=128|o>>2&63,i[n++]=128|a>>6&15|(o&3)<<4,i[n++]=128|a&63}else i[n++]=224|o>>12&15,i[n++]=128|o>>6&63,i[n++]=128|o&63;n>r&&(t.push(i.slice(0,n)),n=0,i=ii(65535),r=65530)}return t.push(i.slice(0,n)),wt(t)}var Ws=/\u0000/g,Zo=/[\u0001-\u0006]/g;function zi(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Rn(e,t){var n=""+e;return n.length>=t?n:nt("0",t-n.length)+n}function Uc(e,t){var n=""+e;return n.length>=t?n:nt(" ",t-n.length)+n}function ja(e,t){var n=""+e;return n.length>=t?n:n+nt(" ",t-n.length)}function dN(e,t){var n=""+Math.round(e);return n.length>=t?n:nt("0",t-n.length)+n}function hN(e,t){var n=""+e;return n.length>=t?n:nt("0",t-n.length)+n}var ip=Math.pow(2,32);function gi(e,t){if(e>ip||e<-ip)return dN(e,t);var n=Math.round(e);return hN(n,t)}function Za(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var sp=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],gu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function pN(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var rt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},op={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},mN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function el(e,t,n){for(var r=e<0?-1:1,i=e*r,s=0,o=1,a=0,l=1,u=0,d=0,h=Math.floor(i);u<t&&(h=Math.floor(i),a=h*o+s,d=h*u+l,!(i-h<5e-8));)i=1/(i-h),s=o,o=a,l=u,u=d;if(d>t&&(u>t?(d=l,a=s):(d=u,a=o)),!n)return[0,r*a,d];var p=Math.floor(r*a/d);return[p,r*a-p*d,d]}function ea(e,t,n){if(e>2958465||e<0)return null;var r=e|0,i=Math.floor(86400*(e-r)),s=0,o=[],a={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(r+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++r,++a.D)),r===60)o=n?[1317,10,29]:[1900,2,29],s=3;else if(r===0)o=n?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),n&&(s=EN(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var b1=new Date(1899,11,31,0,0,0),gN=b1.getTime(),xN=new Date(1900,2,1,0,0,0);function V1(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=xN&&(n+=24*60*60*1e3),(n-(gN+(e.getTimezoneOffset()-b1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Oc(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function vN(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function yN(e){var t=e<0?12:11,n=Oc(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function _N(e){var t=Oc(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function TN(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=yN(e):t===10?n=e.toFixed(10).substr(0,12):n=_N(e),Oc(vN(n.toUpperCase()))}function kf(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):TN(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Lr(14,V1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function EN(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function SN(e,t,n,r){var i="",s=0,o=0,a=n.y,l,u=0;switch(e){case 98:a=n.y+543;case 121:switch(t.length){case 1:case 2:l=a%100,u=2;break;default:l=a%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=n.m,u=t.length;break;case 3:return gu[n.m-1][1];case 5:return gu[n.m-1][0];default:return gu[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=n.d,u=t.length;break;case 3:return sp[n.q][0];default:return sp[n.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(n.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=n.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=n.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?Rn(n.S,t.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,s=Math.round(o*(n.S+n.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=Rn(s,2+r),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=n.D*24+n.H;break;case"[m]":case"[mm]":l=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":l=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=a,u=1;break}var d=u>0?Rn(l,u):"";return d}function wr(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,r=e.substr(0,n);n!=e.length;n+=t)r+=(r.length>0?",":"")+e.substr(n,t);return r}var G1=/%/g;function wN(e,t,n){var r=t.replace(G1,""),i=t.length-r.length;return er(e,r,n*Math.pow(10,2*i))+nt("%",i)}function CN(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return er(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function H1(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+H1(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),n.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,d){return l+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var z1=/# (\?+)( ?)\/( ?)(\d+)/;function AN(e,t,n){var r=parseInt(e[4],10),i=Math.round(t*r),s=Math.floor(i/r),o=i-s*r,a=r;return n+(s===0?"":""+s)+" "+(o===0?nt(" ",e[1].length+1+e[4].length):Uc(o,e[1].length)+e[2]+"/"+e[3]+Rn(a,e[4].length))}function NN(e,t,n){return n+(t===0?"":""+t)+nt(" ",e[1].length+2+e[4].length)}var W1=/^#*0*\.([0#]+)/,q1=/\).*[0#]/,$1=/\(###\) ###\\?-####/;function bt(e){for(var t="",n,r=0;r!=e.length;++r)switch(n=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function ap(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function lp(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function IN(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function kN(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function cn(e,t,n){if(e.charCodeAt(0)===40&&!t.match(q1)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?cn("n",r,n):"("+cn("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return CN(e,t,n);if(t.indexOf("%")!==-1)return wN(e,t,n);if(t.indexOf("E")!==-1)return H1(t,n);if(t.charCodeAt(0)===36)return"$"+cn(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,o,a,l=Math.abs(n),u=n<0?"-":"";if(t.match(/^00+$/))return u+gi(l,t.length);if(t.match(/^[#?]+$/))return i=gi(n,0),i==="0"&&(i=""),i.length>t.length?i:bt(t.substr(0,t.length-i.length))+i;if(s=t.match(z1))return AN(s,l,u);if(t.match(/^#+0+$/))return u+gi(l,t.length-t.indexOf("0"));if(s=t.match(W1))return i=ap(n,s[1].length).replace(/^([^\.]+)$/,"$1."+bt(s[1])).replace(/\.$/,"."+bt(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+nt("0",bt(s[1]).length-x.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+ap(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+wr(gi(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+cn(e,t,-n):wr(""+(Math.floor(n)+IN(n,s[1].length)))+"."+Rn(lp(n,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return cn(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=zi(cn(e,t.replace(/[\\-]/g,""),n)),o=0,zi(zi(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(t.match($1))return i=cn(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=el(l,Math.pow(10,o)-1,!1),i=""+u,d=er("n",s[1],a[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=ja(a[2],o),d.length<s[4].length&&(d=bt(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=el(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?Uc(a[1],o)+s[2]+"/"+s[3]+ja(a[2],o):nt(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=gi(n,0),t.length<=i.length?i:bt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=t.indexOf(".")-o,p=t.length-i.length-h;return bt(t.substr(0,h)+i+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=lp(n,s[1].length),n<0?"-"+cn(e,t,-n):wr(kN(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Rn(0,3-y.length):"")+y})+"."+Rn(o,s[1].length);switch(t){case"###,##0.00":return cn(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var m=wr(gi(l,0));return m!=="0"?u+m:"";case"###,###.00":return cn(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return cn(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function RN(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return er(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function PN(e,t,n){var r=t.replace(G1,""),i=t.length-r.length;return er(e,r,n*Math.pow(10,2*i))+nt("%",i)}function J1(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+J1(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!n.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,d){return l+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Bn(e,t,n){if(e.charCodeAt(0)===40&&!t.match(q1)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Bn("n",r,n):"("+Bn("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return RN(e,t,n);if(t.indexOf("%")!==-1)return PN(e,t,n);if(t.indexOf("E")!==-1)return J1(t,n);if(t.charCodeAt(0)===36)return"$"+Bn(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,o,a,l=Math.abs(n),u=n<0?"-":"";if(t.match(/^00+$/))return u+Rn(l,t.length);if(t.match(/^[#?]+$/))return i=""+n,n===0&&(i=""),i.length>t.length?i:bt(t.substr(0,t.length-i.length))+i;if(s=t.match(z1))return NN(s,l,u);if(t.match(/^#+0+$/))return u+Rn(l,t.length-t.indexOf("0"));if(s=t.match(W1))return i=(""+n).replace(/^([^\.]+)$/,"$1."+bt(s[1])).replace(/\.$/,"."+bt(s[1])),i=i.replace(/\.(\d*)$/,function(y,x){return"."+x+nt("0",bt(s[1]).length-x.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+wr(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Bn(e,t,-n):wr(""+n)+"."+nt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Bn(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=zi(Bn(e,t.replace(/[\\-]/g,""),n)),o=0,zi(zi(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(t.match($1))return i=Bn(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=el(l,Math.pow(10,o)-1,!1),i=""+u,d=er("n",s[1],a[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=ja(a[2],o),d.length<s[4].length&&(d=bt(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=el(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?Uc(a[1],o)+s[2]+"/"+s[3]+ja(a[2],o):nt(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+n,t.length<=i.length?i:bt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=t.indexOf(".")-o,p=t.length-i.length-h;return bt(t.substr(0,h)+i+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Bn(e,t,-n):wr(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Rn(0,3-y.length):"")+y})+"."+Rn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=wr(""+l);return m!=="0"?u+m:"";default:if(t.match(/\.[0#?]*$/))return Bn(e,t.slice(0,t.lastIndexOf(".")),n)+bt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function er(e,t,n){return(n|0)===n?Bn(e,t,n):cn(e,t,n)}function FN(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var K1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Y1(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":Za(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=n;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(K1))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function MN(e,t,n,r){for(var i=[],s="",o=0,a="",l="t",u,d,h,p="H";o<e.length;)switch(a=e.charAt(o)){case"G":if(!Za(e,o))throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(h=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++o;break;case"\\":var m=e.charAt(++o),y=m==="("||m===")"?m:"t";i[i.length]={t:y,v:m},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=ea(t,n,e.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=ea(t,n),u==null))return"";for(s=a;++o<e.length&&e.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=p),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"":var x={t:a,v:a};if(u==null&&(u=ea(t,n)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",p="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",o+=5,p="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",o+=5,p="h"):(x.t="t",++o),u==null&&x.t==="T")return"";i[i.length]=x,l=a;break;case"[":for(s=a;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(K1)){if(u==null&&(u=ea(t,n),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Y1(e)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=a;++o<e.length&&(a=e.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<e.length&&"0#?.,E+-%".indexOf(a=e.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;e.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:r===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"t",v:a},++o;break}var E=0,T=0,_;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=p,l="h",E<1&&(E=1);break;case"s":(_=i[o].v.match(/\.0+$/))&&(T=Math.max(T,_[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[o].v.match(/[Hh]/)&&(E=1),E<2&&i[o].v.match(/[Mm]/)&&(E=2),E<3&&i[o].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var v="",C;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=SN(i[o].t.charCodeAt(0),i[o].v,u,T),i[o].t="t";break;case"n":case"?":for(C=o+1;i[C]!=null&&((a=i[C].t)==="?"||a==="D"||(a===" "||a==="t")&&i[C+1]!=null&&(i[C+1].t==="?"||i[C+1].t==="t"&&i[C+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[C].v==="/"||i[C].v===" "&&i[C+1]!=null&&i[C+1].t=="?"));)i[o].v+=i[C].v,i[C]={v:"",t:";"},++C;v+=i[o].v,o=C-1;break;case"G":i[o].t="t",i[o].v=kf(t,n);break}var D="",F,I;if(v.length>0){v.charCodeAt(0)==40?(F=t<0&&v.charCodeAt(0)===45?-t:t,I=er("n",v,F)):(F=t<0&&r>1?-t:t,I=er("n",v,F),F<0&&i[0]&&i[0].t=="t"&&(I=I.substr(1),i[0].v="-"+i[0].v)),C=I.length-1;var L=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){L=o;break}var M=i.length;if(L===i.length&&I.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(C>=i[o].v.length-1?(C-=i[o].v.length,i[o].v=I.substr(C+1,i[o].v.length)):C<0?i[o].v="":(i[o].v=I.substr(0,C+1),C=-1),i[o].t="t",M=o);C>=0&&M<i.length&&(i[M].v=I.substr(0,C+1)+i[M].v)}else if(L!==i.length&&I.indexOf("E")===-1){for(C=I.indexOf(".")-1,o=L;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(d=i[o].v.indexOf(".")>-1&&o===L?i[o].v.indexOf(".")-1:i[o].v.length-1,D=i[o].v.substr(d+1);d>=0;--d)C>=0&&(i[o].v.charAt(d)==="0"||i[o].v.charAt(d)==="#")&&(D=I.charAt(C--)+D);i[o].v=D,i[o].t="t",M=o}for(C>=0&&M<i.length&&(i[M].v=I.substr(0,C+1)+i[M].v),C=I.indexOf(".")+1,o=L;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==L)){for(d=i[o].v.indexOf(".")>-1&&o===L?i[o].v.indexOf(".")+1:0,D=i[o].v.substr(0,d);d<i[o].v.length;++d)C<I.length&&(D+=I.charAt(C++));i[o].v=D,i[o].t="t",M=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(F=r>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=er(i[o].t,i[o].v,F),i[o].t="t");var B="";for(o=0;o!==i.length;++o)i[o]!=null&&(B+=i[o].v);return B}var up=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function fp(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function DN(e,t){var n=FN(e),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var s=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,s];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var o=n[0].match(up),a=n[1].match(up);return fp(t,o)?[r,n[0]]:fp(t,a)?[r,n[1]]:[r,n[o!=null&&a!=null?2:1]]}return[r,s]}function Lr(e,t,n){n==null&&(n={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?r=n.dateNF:r=e;break;case"number":e==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:rt)[e],r==null&&(r=n.table&&n.table[op[e]]||rt[op[e]]),r==null&&(r=mN[e]||"General");break}if(Za(r,0))return kf(t,n);t instanceof Date&&(t=V1(t,n.date1904));var i=DN(r,t);if(Za(i[1]))return kf(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return MN(i[1],t,n,i[0])}function X1(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(rt[n]==null){t<0&&(t=n);continue}if(rt[n]==e){t=n;break}}t<0&&(t=391)}return rt[t]=e,t}function Fl(e){for(var t=0;t!=392;++t)e[t]!==void 0&&X1(e[t],t)}function Ml(){rt=pN()}var Q1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function LN(e){var t=typeof e=="number"?rt[e]:e;return t=t.replace(Q1,"(\\d+)"),new RegExp("^"+t+"$")}function UN(e,t,n){var r=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(t.match(Q1)||[]).forEach(function(h,p){var m=parseInt(n[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":r=m;break;case"d":s=m;break;case"h":o=m;break;case"s":l=m;break;case"m":o>=0?a=m:i=m;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var u=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?u:r==-1&&i==-1&&s==-1?d:u+"T"+d}var ON=function(){var e={};e.version="1.2.0";function t(){for(var I=0,L=new Array(256),M=0;M!=256;++M)I=M,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,L[M]=I;return typeof Int32Array<"u"?new Int32Array(L):L}var n=t();function r(I){var L=0,M=0,B=0,J=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)J[B]=I[B];for(B=0;B!=256;++B)for(M=I[B],L=256+B;L<4096;L+=256)M=J[L]=M>>>8^I[M&255];var H=[];for(B=1;B!=16;++B)H[B-1]=typeof Int32Array<"u"?J.subarray(B*256,B*256+256):J.slice(B*256,B*256+256);return H}var i=r(n),s=i[0],o=i[1],a=i[2],l=i[3],u=i[4],d=i[5],h=i[6],p=i[7],m=i[8],y=i[9],x=i[10],E=i[11],T=i[12],_=i[13],v=i[14];function C(I,L){for(var M=L^-1,B=0,J=I.length;B<J;)M=M>>>8^n[(M^I.charCodeAt(B++))&255];return~M}function D(I,L){for(var M=L^-1,B=I.length-15,J=0;J<B;)M=v[I[J++]^M&255]^_[I[J++]^M>>8&255]^T[I[J++]^M>>16&255]^E[I[J++]^M>>>24]^x[I[J++]]^y[I[J++]]^m[I[J++]]^p[I[J++]]^h[I[J++]]^d[I[J++]]^u[I[J++]]^l[I[J++]]^a[I[J++]]^o[I[J++]]^s[I[J++]]^n[I[J++]];for(B+=15;J<B;)M=M>>>8^n[(M^I[J++])&255];return~M}function F(I,L){for(var M=L^-1,B=0,J=I.length,H=0,Z=0;B<J;)H=I.charCodeAt(B++),H<128?M=M>>>8^n[(M^H)&255]:H<2048?(M=M>>>8^n[(M^(192|H>>6&31))&255],M=M>>>8^n[(M^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,Z=I.charCodeAt(B++)&1023,M=M>>>8^n[(M^(240|H>>8&7))&255],M=M>>>8^n[(M^(128|H>>2&63))&255],M=M>>>8^n[(M^(128|Z>>6&15|(H&3)<<4))&255],M=M>>>8^n[(M^(128|Z&63))&255]):(M=M>>>8^n[(M^(224|H>>12&15))&255],M=M>>>8^n[(M^(128|H>>6&63))&255],M=M>>>8^n[(M^(128|H&63))&255]);return~M}return e.table=n,e.bstr=C,e.buf=D,e.str=F,e}(),ze=function(){var t={};t.version="1.2.1";function n(S,N){for(var w=S.split("/"),A=N.split("/"),k=0,R=0,G=Math.min(w.length,A.length);k<G;++k){if(R=w[k].length-A[k].length)return R;if(w[k]!=A[k])return w[k]<A[k]?-1:1}return w.length-A.length}function r(S){if(S.charAt(S.length-1)=="/")return S.slice(0,-1).indexOf("/")===-1?S:r(S.slice(0,-1));var N=S.lastIndexOf("/");return N===-1?S:S.slice(0,N+1)}function i(S){if(S.charAt(S.length-1)=="/")return i(S.slice(0,-1));var N=S.lastIndexOf("/");return N===-1?S:S.slice(N+1)}function s(S,N){typeof N=="string"&&(N=new Date(N));var w=N.getHours();w=w<<6|N.getMinutes(),w=w<<5|N.getSeconds()>>>1,S.write_shift(2,w);var A=N.getFullYear()-1980;A=A<<4|N.getMonth()+1,A=A<<5|N.getDate(),S.write_shift(2,A)}function o(S){var N=S.read_shift(2)&65535,w=S.read_shift(2)&65535,A=new Date,k=w&31;w>>>=5;var R=w&15;w>>>=4,A.setMilliseconds(0),A.setFullYear(w+1980),A.setMonth(R-1),A.setDate(k);var G=N&31;N>>>=5;var Y=N&63;return N>>>=6,A.setHours(N),A.setMinutes(Y),A.setSeconds(G<<1),A}function a(S){tn(S,0);for(var N={},w=0;S.l<=S.length-4;){var A=S.read_shift(2),k=S.read_shift(2),R=S.l+k,G={};switch(A){case 21589:w=S.read_shift(1),w&1&&(G.mtime=S.read_shift(4)),k>5&&(w&2&&(G.atime=S.read_shift(4)),w&4&&(G.ctime=S.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}S.l=R,N[A]=G}return N}var l;function u(){return l||(l={})}function d(S,N){if(S[0]==80&&S[1]==75)return c0(S,N);if((S[0]|32)==109&&(S[1]|32)==105)return Iv(S,N);if(S.length<512)throw new Error("CFB file size "+S.length+" < 512");var w=3,A=512,k=0,R=0,G=0,Y=0,V=0,z=[],q=S.slice(0,512);tn(q,0);var te=h(q);switch(w=te[0],w){case 3:A=512;break;case 4:A=4096;break;case 0:if(te[1]==0)return c0(S,N);default:throw new Error("Major Version: Expected 3 or 4 saw "+w)}A!==512&&(q=S.slice(0,A),tn(q,28));var ae=S.slice(0,A);p(q,w);var de=q.read_shift(4,"i");if(w===3&&de!==0)throw new Error("# Directory Sectors: Expected 0 saw "+de);q.l+=4,G=q.read_shift(4,"i"),q.l+=4,q.chk("00100000","Mini Stream Cutoff Size: "),Y=q.read_shift(4,"i"),k=q.read_shift(4,"i"),V=q.read_shift(4,"i"),R=q.read_shift(4,"i");for(var re=-1,ce=0;ce<109&&(re=q.read_shift(4,"i"),!(re<0));++ce)z[ce]=re;var Ae=m(S,A);E(V,R,Ae,A,z);var Xe=_(Ae,G,z,A);Xe[G].name="!Directory",k>0&&Y!==Z&&(Xe[Y].name="!MiniFAT"),Xe[z[0]].name="!FAT",Xe.fat_addrs=z,Xe.ssz=A;var Qe={},Rt=[],ds=[],hs=[];v(G,Xe,Ae,Rt,k,Qe,ds,Y),y(ds,hs,Rt),Rt.shift();var ps={FileIndex:ds,FullPaths:hs};return N&&N.raw&&(ps.raw={header:ae,sectors:Ae}),ps}function h(S){if(S[S.l]==80&&S[S.l+1]==75)return[0,0];S.chk(Te,"Header Signature: "),S.l+=16;var N=S.read_shift(2,"u");return[S.read_shift(2,"u"),N]}function p(S,N){var w=9;switch(S.l+=2,w=S.read_shift(2)){case 9:if(N!=3)throw new Error("Sector Shift: Expected 9 saw "+w);break;case 12:if(N!=4)throw new Error("Sector Shift: Expected 12 saw "+w);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+w)}S.chk("0600","Mini Sector Shift: "),S.chk("000000000000","Reserved: ")}function m(S,N){for(var w=Math.ceil(S.length/N)-1,A=[],k=1;k<w;++k)A[k-1]=S.slice(k*N,(k+1)*N);return A[w-1]=S.slice(w*N),A}function y(S,N,w){for(var A=0,k=0,R=0,G=0,Y=0,V=w.length,z=[],q=[];A<V;++A)z[A]=q[A]=A,N[A]=w[A];for(;Y<q.length;++Y)A=q[Y],k=S[A].L,R=S[A].R,G=S[A].C,z[A]===A&&(k!==-1&&z[k]!==k&&(z[A]=z[k]),R!==-1&&z[R]!==R&&(z[A]=z[R])),G!==-1&&(z[G]=A),k!==-1&&A!=z[A]&&(z[k]=z[A],q.lastIndexOf(k)<Y&&q.push(k)),R!==-1&&A!=z[A]&&(z[R]=z[A],q.lastIndexOf(R)<Y&&q.push(R));for(A=1;A<V;++A)z[A]===A&&(R!==-1&&z[R]!==R?z[A]=z[R]:k!==-1&&z[k]!==k&&(z[A]=z[k]));for(A=1;A<V;++A)if(S[A].type!==0){if(Y=A,Y!=z[Y])do Y=z[Y],N[A]=N[Y]+"/"+N[A];while(Y!==0&&z[Y]!==-1&&Y!=z[Y]);z[A]=-1}for(N[0]+="/",A=1;A<V;++A)S[A].type!==2&&(N[A]+="/")}function x(S,N,w){for(var A=S.start,k=S.size,R=[],G=A;w&&k>0&&G>=0;)R.push(N.slice(G*H,G*H+H)),k-=H,G=$r(w,G*4);return R.length===0?K(0):wt(R).slice(0,S.size)}function E(S,N,w,A,k){var R=Z;if(S===Z){if(N!==0)throw new Error("DIFAT chain shorter than expected")}else if(S!==-1){var G=w[S],Y=(A>>>2)-1;if(!G)return;for(var V=0;V<Y&&(R=$r(G,V*4))!==Z;++V)k.push(R);E($r(G,A-4),N-1,w,A,k)}}function T(S,N,w,A,k){var R=[],G=[];k||(k=[]);var Y=A-1,V=0,z=0;for(V=N;V>=0;){k[V]=!0,R[R.length]=V,G.push(S[V]);var q=w[Math.floor(V*4/A)];if(z=V*4&Y,A<4+z)throw new Error("FAT boundary crossed: "+V+" 4 "+A);if(!S[q])break;V=$r(S[q],z)}return{nodes:R,data:vp([G])}}function _(S,N,w,A){var k=S.length,R=[],G=[],Y=[],V=[],z=A-1,q=0,te=0,ae=0,de=0;for(q=0;q<k;++q)if(Y=[],ae=q+N,ae>=k&&(ae-=k),!G[ae]){V=[];var re=[];for(te=ae;te>=0;){re[te]=!0,G[te]=!0,Y[Y.length]=te,V.push(S[te]);var ce=w[Math.floor(te*4/A)];if(de=te*4&z,A<4+de)throw new Error("FAT boundary crossed: "+te+" 4 "+A);if(!S[ce]||(te=$r(S[ce],de),re[te]))break}R[ae]={nodes:Y,data:vp([V])}}return R}function v(S,N,w,A,k,R,G,Y){for(var V=0,z=A.length?2:0,q=N[S].data,te=0,ae=0,de;te<q.length;te+=128){var re=q.slice(te,te+128);tn(re,64),ae=re.read_shift(2),de=Hc(re,0,ae-z),A.push(de);var ce={name:de,type:re.read_shift(1),color:re.read_shift(1),L:re.read_shift(4,"i"),R:re.read_shift(4,"i"),C:re.read_shift(4,"i"),clsid:re.read_shift(16),state:re.read_shift(4,"i"),start:0,size:0},Ae=re.read_shift(2)+re.read_shift(2)+re.read_shift(2)+re.read_shift(2);Ae!==0&&(ce.ct=C(re,re.l-8));var Xe=re.read_shift(2)+re.read_shift(2)+re.read_shift(2)+re.read_shift(2);Xe!==0&&(ce.mt=C(re,re.l-8)),ce.start=re.read_shift(4,"i"),ce.size=re.read_shift(4,"i"),ce.size<0&&ce.start<0&&(ce.size=ce.type=0,ce.start=Z,ce.name=""),ce.type===5?(V=ce.start,k>0&&V!==Z&&(N[V].name="!StreamData")):ce.size>=4096?(ce.storage="fat",N[ce.start]===void 0&&(N[ce.start]=T(w,ce.start,N.fat_addrs,N.ssz)),N[ce.start].name=ce.name,ce.content=N[ce.start].data.slice(0,ce.size)):(ce.storage="minifat",ce.size<0?ce.size=0:V!==Z&&ce.start!==Z&&N[V]&&(ce.content=x(ce,N[V].data,(N[Y]||{}).data))),ce.content&&tn(ce.content,0),R[de]=ce,G.push(ce)}}function C(S,N){return new Date((rn(S,N+4)/1e7*Math.pow(2,32)+rn(S,N)/1e7-11644473600)*1e3)}function D(S,N){return u(),d(l.readFileSync(S),N)}function F(S,N){var w=N&&N.type;switch(w||Ue&&Buffer.isBuffer(S)&&(w="buffer"),w||"base64"){case"file":return D(S,N);case"base64":return d(kn(lr(S)),N);case"binary":return d(kn(S),N)}return d(S,N)}function I(S,N){var w=N||{},A=w.root||"Root Entry";if(S.FullPaths||(S.FullPaths=[]),S.FileIndex||(S.FileIndex=[]),S.FullPaths.length!==S.FileIndex.length)throw new Error("inconsistent CFB structure");S.FullPaths.length===0&&(S.FullPaths[0]=A+"/",S.FileIndex[0]={name:A,type:5}),w.CLSID&&(S.FileIndex[0].clsid=w.CLSID),L(S)}function L(S){var N="Sh33tJ5";if(!ze.find(S,"/"+N)){var w=K(4);w[0]=55,w[1]=w[3]=50,w[2]=54,S.FileIndex.push({name:N,type:2,content:w,size:4,L:69,R:69,C:69}),S.FullPaths.push(S.FullPaths[0]+N),M(S)}}function M(S,N){I(S);for(var w=!1,A=!1,k=S.FullPaths.length-1;k>=0;--k){var R=S.FileIndex[k];switch(R.type){case 0:A?w=!0:(S.FileIndex.pop(),S.FullPaths.pop());break;case 1:case 2:case 5:A=!0,isNaN(R.R*R.L*R.C)&&(w=!0),R.R>-1&&R.L>-1&&R.R==R.L&&(w=!0);break;default:w=!0;break}}if(!(!w&&!N)){var G=new Date(1987,1,19),Y=0,V=Object.create?Object.create(null):{},z=[];for(k=0;k<S.FullPaths.length;++k)V[S.FullPaths[k]]=!0,S.FileIndex[k].type!==0&&z.push([S.FullPaths[k],S.FileIndex[k]]);for(k=0;k<z.length;++k){var q=r(z[k][0]);A=V[q],A||(z.push([q,{name:i(q).replace("/",""),type:1,clsid:Ee,ct:G,mt:G,content:null}]),V[q]=!0)}for(z.sort(function(de,re){return n(de[0],re[0])}),S.FullPaths=[],S.FileIndex=[],k=0;k<z.length;++k)S.FullPaths[k]=z[k][0],S.FileIndex[k]=z[k][1];for(k=0;k<z.length;++k){var te=S.FileIndex[k],ae=S.FullPaths[k];if(te.name=i(ae).replace("/",""),te.L=te.R=te.C=-(te.color=1),te.size=te.content?te.content.length:0,te.start=0,te.clsid=te.clsid||Ee,k===0)te.C=z.length>1?1:-1,te.size=0,te.type=5;else if(ae.slice(-1)=="/"){for(Y=k+1;Y<z.length&&r(S.FullPaths[Y])!=ae;++Y);for(te.C=Y>=z.length?-1:Y,Y=k+1;Y<z.length&&r(S.FullPaths[Y])!=r(ae);++Y);te.R=Y>=z.length?-1:Y,te.type=1}else r(S.FullPaths[k+1]||"")==r(ae)&&(te.R=k+1),te.type=2}}}function B(S,N){var w=N||{};if(w.fileType=="mad")return kv(S,w);switch(M(S),w.fileType){case"zip":return Ev(S,w)}var A=function(de){for(var re=0,ce=0,Ae=0;Ae<de.FileIndex.length;++Ae){var Xe=de.FileIndex[Ae];if(Xe.content){var Qe=Xe.content.length;Qe>0&&(Qe<4096?re+=Qe+63>>6:ce+=Qe+511>>9)}}for(var Rt=de.FullPaths.length+3>>2,ds=re+7>>3,hs=re+127>>7,ps=ds+ce+Rt+hs,zr=ps+127>>7,Vl=zr<=109?0:Math.ceil((zr-109)/127);ps+zr+Vl+127>>7>zr;)Vl=++zr<=109?0:Math.ceil((zr-109)/127);var Jn=[1,Vl,zr,hs,Rt,ce,re,0];return de.FileIndex[0].size=re<<6,Jn[7]=(de.FileIndex[0].start=Jn[0]+Jn[1]+Jn[2]+Jn[3]+Jn[4]+Jn[5])+(Jn[6]+7>>3),Jn}(S),k=K(A[7]<<9),R=0,G=0;{for(R=0;R<8;++R)k.write_shift(1,ye[R]);for(R=0;R<8;++R)k.write_shift(2,0);for(k.write_shift(2,62),k.write_shift(2,3),k.write_shift(2,65534),k.write_shift(2,9),k.write_shift(2,6),R=0;R<3;++R)k.write_shift(2,0);for(k.write_shift(4,0),k.write_shift(4,A[2]),k.write_shift(4,A[0]+A[1]+A[2]+A[3]-1),k.write_shift(4,0),k.write_shift(4,4096),k.write_shift(4,A[3]?A[0]+A[1]+A[2]-1:Z),k.write_shift(4,A[3]),k.write_shift(-4,A[1]?A[0]-1:Z),k.write_shift(4,A[1]),R=0;R<109;++R)k.write_shift(-4,R<A[2]?A[1]+R:-1)}if(A[1])for(G=0;G<A[1];++G){for(;R<236+G*127;++R)k.write_shift(-4,R<A[2]?A[1]+R:-1);k.write_shift(-4,G===A[1]-1?Z:G+1)}var Y=function(de){for(G+=de;R<G-1;++R)k.write_shift(-4,R+1);de&&(++R,k.write_shift(-4,Z))};for(G=R=0,G+=A[1];R<G;++R)k.write_shift(-4,Me.DIFSECT);for(G+=A[2];R<G;++R)k.write_shift(-4,Me.FATSECT);Y(A[3]),Y(A[4]);for(var V=0,z=0,q=S.FileIndex[0];V<S.FileIndex.length;++V)q=S.FileIndex[V],q.content&&(z=q.content.length,!(z<4096)&&(q.start=G,Y(z+511>>9)));for(Y(A[6]+7>>3);k.l&511;)k.write_shift(-4,Me.ENDOFCHAIN);for(G=R=0,V=0;V<S.FileIndex.length;++V)q=S.FileIndex[V],q.content&&(z=q.content.length,!(!z||z>=4096)&&(q.start=G,Y(z+63>>6)));for(;k.l&511;)k.write_shift(-4,Me.ENDOFCHAIN);for(R=0;R<A[4]<<2;++R){var te=S.FullPaths[R];if(!te||te.length===0){for(V=0;V<17;++V)k.write_shift(4,0);for(V=0;V<3;++V)k.write_shift(4,-1);for(V=0;V<12;++V)k.write_shift(4,0);continue}q=S.FileIndex[R],R===0&&(q.start=q.size?q.start-1:Z);var ae=R===0&&w.root||q.name;if(z=2*(ae.length+1),k.write_shift(64,ae,"utf16le"),k.write_shift(2,z),k.write_shift(1,q.type),k.write_shift(1,q.color),k.write_shift(-4,q.L),k.write_shift(-4,q.R),k.write_shift(-4,q.C),q.clsid)k.write_shift(16,q.clsid,"hex");else for(V=0;V<4;++V)k.write_shift(4,0);k.write_shift(4,q.state||0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,q.start),k.write_shift(4,q.size),k.write_shift(4,0)}for(R=1;R<S.FileIndex.length;++R)if(q=S.FileIndex[R],q.size>=4096)if(k.l=q.start+1<<9,Ue&&Buffer.isBuffer(q.content))q.content.copy(k,k.l,0,q.size),k.l+=q.size+511&-512;else{for(V=0;V<q.size;++V)k.write_shift(1,q.content[V]);for(;V&511;++V)k.write_shift(1,0)}for(R=1;R<S.FileIndex.length;++R)if(q=S.FileIndex[R],q.size>0&&q.size<4096)if(Ue&&Buffer.isBuffer(q.content))q.content.copy(k,k.l,0,q.size),k.l+=q.size+63&-64;else{for(V=0;V<q.size;++V)k.write_shift(1,q.content[V]);for(;V&63;++V)k.write_shift(1,0)}if(Ue)k.l=k.length;else for(;k.l<k.length;)k.write_shift(1,0);return k}function J(S,N){var w=S.FullPaths.map(function(V){return V.toUpperCase()}),A=w.map(function(V){var z=V.split("/");return z[z.length-(V.slice(-1)=="/"?2:1)]}),k=!1;N.charCodeAt(0)===47?(k=!0,N=w[0].slice(0,-1)+N):k=N.indexOf("/")!==-1;var R=N.toUpperCase(),G=k===!0?w.indexOf(R):A.indexOf(R);if(G!==-1)return S.FileIndex[G];var Y=!R.match(Zo);for(R=R.replace(Ws,""),Y&&(R=R.replace(Zo,"!")),G=0;G<w.length;++G)if((Y?w[G].replace(Zo,"!"):w[G]).replace(Ws,"")==R||(Y?A[G].replace(Zo,"!"):A[G]).replace(Ws,"")==R)return S.FileIndex[G];return null}var H=64,Z=-2,Te="d0cf11e0a1b11ae1",ye=[208,207,17,224,161,177,26,225],Ee="00000000000000000000000000000000",Me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Z,FREESECT:-1,HEADER_SIGNATURE:Te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(S,N,w){u();var A=B(S,w);l.writeFileSync(N,A)}function ge(S){for(var N=new Array(S.length),w=0;w<S.length;++w)N[w]=String.fromCharCode(S[w]);return N.join("")}function _e(S,N){var w=B(S,N);switch(N&&N.type||"buffer"){case"file":return u(),l.writeFileSync(N.filename,w),w;case"binary":return typeof w=="string"?w:ge(w);case"base64":return mo(typeof w=="string"?w:ge(w));case"buffer":if(Ue)return Buffer.isBuffer(w)?w:hr(w);case"array":return typeof w=="string"?kn(w):w}return w}var ke;function P(S){try{var N=S.InflateRaw,w=new N;if(w._processChunk(new Uint8Array([3,0]),w._finishFlushFlag),w.bytesRead)ke=S;else throw new Error("zlib does not expose bytesRead")}catch(A){console.error("cannot use native zlib: "+(A.message||A))}}function W(S,N){if(!ke)return u0(S,N);var w=ke.InflateRaw,A=new w,k=A._processChunk(S.slice(S.l),A._finishFlushFlag);return S.l+=A.bytesRead,k}function O(S){return ke?ke.deflateRawSync(S):r0(S)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function xe(S){var N=(S<<1|S<<11)&139536|(S<<5|S<<15)&558144;return(N>>16|N>>8|N)&255}for(var me=typeof Uint8Array<"u",le=me?new Uint8Array(256):[],Oe=0;Oe<256;++Oe)le[Oe]=xe(Oe);function Pe(S,N){var w=le[S&255];return N<=8?w>>>8-N:(w=w<<8|le[S>>8&255],N<=16?w>>>16-N:(w=w<<8|le[S>>16&255],w>>>24-N))}function pt(S,N){var w=N&7,A=N>>>3;return(S[A]|(w<=6?0:S[A+1]<<8))>>>w&3}function b(S,N){var w=N&7,A=N>>>3;return(S[A]|(w<=5?0:S[A+1]<<8))>>>w&7}function ee(S,N){var w=N&7,A=N>>>3;return(S[A]|(w<=4?0:S[A+1]<<8))>>>w&15}function ue(S,N){var w=N&7,A=N>>>3;return(S[A]|(w<=3?0:S[A+1]<<8))>>>w&31}function X(S,N){var w=N&7,A=N>>>3;return(S[A]|(w<=1?0:S[A+1]<<8))>>>w&127}function ve(S,N,w){var A=N&7,k=N>>>3,R=(1<<w)-1,G=S[k]>>>A;return w<8-A||(G|=S[k+1]<<8-A,w<16-A)||(G|=S[k+2]<<16-A,w<24-A)||(G|=S[k+3]<<24-A),G&R}function Se(S,N,w){var A=N&7,k=N>>>3;return A<=5?S[k]|=(w&7)<<A:(S[k]|=w<<A&255,S[k+1]=(w&7)>>8-A),N+3}function it(S,N,w){var A=N&7,k=N>>>3;return w=(w&1)<<A,S[k]|=w,N+1}function Un(S,N,w){var A=N&7,k=N>>>3;return w<<=A,S[k]|=w&255,w>>>=8,S[k+1]=w,N+8}function pr(S,N,w){var A=N&7,k=N>>>3;return w<<=A,S[k]|=w&255,w>>>=8,S[k+1]=w&255,S[k+2]=w>>>8,N+16}function ot(S,N){var w=S.length,A=2*w>N?2*w:N+5,k=0;if(w>=N)return S;if(Ue){var R=rp(A);if(S.copy)S.copy(R);else for(;k<S.length;++k)R[k]=S[k];return R}else if(me){var G=new Uint8Array(A);if(G.set)G.set(S);else for(;k<w;++k)G[k]=S[k];return G}return S.length=A,S}function mt(S){for(var N=new Array(S),w=0;w<S;++w)N[w]=0;return N}function Tn(S,N,w){var A=1,k=0,R=0,G=0,Y=0,V=S.length,z=me?new Uint16Array(32):mt(32);for(R=0;R<32;++R)z[R]=0;for(R=V;R<w;++R)S[R]=0;V=S.length;var q=me?new Uint16Array(V):mt(V);for(R=0;R<V;++R)z[k=S[R]]++,A<k&&(A=k),q[R]=0;for(z[0]=0,R=1;R<=A;++R)z[R+16]=Y=Y+z[R-1]<<1;for(R=0;R<V;++R)Y=S[R],Y!=0&&(q[R]=z[Y+16]++);var te=0;for(R=0;R<V;++R)if(te=S[R],te!=0)for(Y=Pe(q[R],A)>>A-te,G=(1<<A+4-te)-1;G>=0;--G)N[Y|G<<te]=te&15|R<<4;return A}var $n=me?new Uint16Array(512):mt(512),cs=me?new Uint16Array(32):mt(32);if(!me){for(var En=0;En<512;++En)$n[En]=0;for(En=0;En<32;++En)cs[En]=0}(function(){for(var S=[],N=0;N<32;N++)S.push(5);Tn(S,cs,32);var w=[];for(N=0;N<=143;N++)w.push(8);for(;N<=255;N++)w.push(9);for(;N<=279;N++)w.push(7);for(;N<=287;N++)w.push(8);Tn(w,$n,288)})();var vv=function(){for(var N=me?new Uint8Array(32768):[],w=0,A=0;w<he.length-1;++w)for(;A<he[w+1];++A)N[A]=w;for(;A<32768;++A)N[A]=29;var k=me?new Uint8Array(259):[];for(w=0,A=0;w<Q.length-1;++w)for(;A<Q[w+1];++A)k[A]=w;function R(Y,V){for(var z=0;z<Y.length;){var q=Math.min(65535,Y.length-z),te=z+q==Y.length;for(V.write_shift(1,+te),V.write_shift(2,q),V.write_shift(2,~q&65535);q-- >0;)V[V.l++]=Y[z++]}return V.l}function G(Y,V){for(var z=0,q=0,te=me?new Uint16Array(32768):[];q<Y.length;){var ae=Math.min(65535,Y.length-q);if(ae<10){for(z=Se(V,z,+(q+ae==Y.length)),z&7&&(z+=8-(z&7)),V.l=z/8|0,V.write_shift(2,ae),V.write_shift(2,~ae&65535);ae-- >0;)V[V.l++]=Y[q++];z=V.l*8;continue}z=Se(V,z,+(q+ae==Y.length)+2);for(var de=0;ae-- >0;){var re=Y[q];de=(de<<5^re)&32767;var ce=-1,Ae=0;if((ce=te[de])&&(ce|=q&-32768,ce>q&&(ce-=32768),ce<q))for(;Y[ce+Ae]==Y[q+Ae]&&Ae<250;)++Ae;if(Ae>2){re=k[Ae],re<=22?z=Un(V,z,le[re+1]>>1)-1:(Un(V,z,3),z+=5,Un(V,z,le[re-23]>>5),z+=3);var Xe=re<8?0:re-4>>2;Xe>0&&(pr(V,z,Ae-Q[re]),z+=Xe),re=N[q-ce],z=Un(V,z,le[re]>>3),z-=3;var Qe=re<4?0:re-2>>1;Qe>0&&(pr(V,z,q-ce-he[re]),z+=Qe);for(var Rt=0;Rt<Ae;++Rt)te[de]=q&32767,de=(de<<5^Y[q])&32767,++q;ae-=Ae-1}else re<=143?re=re+48:z=it(V,z,1),z=Un(V,z,le[re]),te[de]=q&32767,++q}z=Un(V,z,0)-1}return V.l=(z+7)/8|0,V.l}return function(V,z){return V.length<8?R(V,z):G(V,z)}}();function r0(S){var N=K(50+Math.floor(S.length*1.1)),w=vv(S,N);return N.slice(0,w)}var i0=me?new Uint16Array(32768):mt(32768),s0=me?new Uint16Array(32768):mt(32768),o0=me?new Uint16Array(128):mt(128),a0=1,l0=1;function yv(S,N){var w=ue(S,N)+257;N+=5;var A=ue(S,N)+1;N+=5;var k=ee(S,N)+4;N+=4;for(var R=0,G=me?new Uint8Array(19):mt(19),Y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],V=1,z=me?new Uint8Array(8):mt(8),q=me?new Uint8Array(8):mt(8),te=G.length,ae=0;ae<k;++ae)G[U[ae]]=R=b(S,N),V<R&&(V=R),z[R]++,N+=3;var de=0;for(z[0]=0,ae=1;ae<=V;++ae)q[ae]=de=de+z[ae-1]<<1;for(ae=0;ae<te;++ae)(de=G[ae])!=0&&(Y[ae]=q[de]++);var re=0;for(ae=0;ae<te;++ae)if(re=G[ae],re!=0){de=le[Y[ae]]>>8-re;for(var ce=(1<<7-re)-1;ce>=0;--ce)o0[de|ce<<re]=re&7|ae<<3}var Ae=[];for(V=1;Ae.length<w+A;)switch(de=o0[X(S,N)],N+=de&7,de>>>=3){case 16:for(R=3+pt(S,N),N+=2,de=Ae[Ae.length-1];R-- >0;)Ae.push(de);break;case 17:for(R=3+b(S,N),N+=3;R-- >0;)Ae.push(0);break;case 18:for(R=11+X(S,N),N+=7;R-- >0;)Ae.push(0);break;default:Ae.push(de),V<de&&(V=de);break}var Xe=Ae.slice(0,w),Qe=Ae.slice(w);for(ae=w;ae<286;++ae)Xe[ae]=0;for(ae=A;ae<30;++ae)Qe[ae]=0;return a0=Tn(Xe,i0,286),l0=Tn(Qe,s0,30),N}function _v(S,N){if(S[0]==3&&!(S[1]&3))return[ii(N),2];for(var w=0,A=0,k=rp(N||1<<18),R=0,G=k.length>>>0,Y=0,V=0;!(A&1);){if(A=b(S,w),w+=3,A>>>1)A>>1==1?(Y=9,V=5):(w=yv(S,w),Y=a0,V=l0);else{w&7&&(w+=8-(w&7));var z=S[w>>>3]|S[(w>>>3)+1]<<8;if(w+=32,z>0)for(!N&&G<R+z&&(k=ot(k,R+z),G=k.length);z-- >0;)k[R++]=S[w>>>3],w+=8;continue}for(;;){!N&&G<R+32767&&(k=ot(k,R+32767),G=k.length);var q=ve(S,w,Y),te=A>>>1==1?$n[q]:i0[q];if(w+=te&15,te>>>=4,!(te>>>8&255))k[R++]=te;else{if(te==256)break;te-=257;var ae=te<8?0:te-4>>2;ae>5&&(ae=0);var de=R+Q[te];ae>0&&(de+=ve(S,w,ae),w+=ae),q=ve(S,w,V),te=A>>>1==1?cs[q]:s0[q],w+=te&15,te>>>=4;var re=te<4?0:te-2>>1,ce=he[te];for(re>0&&(ce+=ve(S,w,re),w+=re),!N&&G<de&&(k=ot(k,de+100),G=k.length);R<de;)k[R]=k[R-ce],++R}}}return N?[k,w+7>>>3]:[k.slice(0,R),w+7>>>3]}function u0(S,N){var w=S.slice(S.l||0),A=_v(w,N);return S.l+=A[1],A[0]}function f0(S,N){if(S)typeof console<"u"&&console.error(N);else throw new Error(N)}function c0(S,N){var w=S;tn(w,0);var A=[],k=[],R={FileIndex:A,FullPaths:k};I(R,{root:N.root});for(var G=w.length-4;(w[G]!=80||w[G+1]!=75||w[G+2]!=5||w[G+3]!=6)&&G>=0;)--G;w.l=G+4,w.l+=4;var Y=w.read_shift(2);w.l+=6;var V=w.read_shift(4);for(w.l=V,G=0;G<Y;++G){w.l+=20;var z=w.read_shift(4),q=w.read_shift(4),te=w.read_shift(2),ae=w.read_shift(2),de=w.read_shift(2);w.l+=8;var re=w.read_shift(4),ce=a(w.slice(w.l+te,w.l+te+ae));w.l+=te+ae+de;var Ae=w.l;w.l=re+4,Tv(w,z,q,R,ce),w.l=Ae}return R}function Tv(S,N,w,A,k){S.l+=2;var R=S.read_shift(2),G=S.read_shift(2),Y=o(S);if(R&8257)throw new Error("Unsupported ZIP encryption");for(var V=S.read_shift(4),z=S.read_shift(4),q=S.read_shift(4),te=S.read_shift(2),ae=S.read_shift(2),de="",re=0;re<te;++re)de+=String.fromCharCode(S[S.l++]);if(ae){var ce=a(S.slice(S.l,S.l+ae));(ce[21589]||{}).mt&&(Y=ce[21589].mt),((k||{})[21589]||{}).mt&&(Y=k[21589].mt)}S.l+=ae;var Ae=S.slice(S.l,S.l+z);switch(G){case 8:Ae=W(S,q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var Xe=!1;R&8&&(V=S.read_shift(4),V==134695760&&(V=S.read_shift(4),Xe=!0),z=S.read_shift(4),q=S.read_shift(4)),z!=N&&f0(Xe,"Bad compressed size: "+N+" != "+z),q!=w&&f0(Xe,"Bad uncompressed size: "+w+" != "+q),bl(A,de,Ae,{unsafe:!0,mt:Y})}function Ev(S,N){var w=N||{},A=[],k=[],R=K(1),G=w.compression?8:0,Y=0,V=0,z=0,q=0,te=0,ae=S.FullPaths[0],de=ae,re=S.FileIndex[0],ce=[],Ae=0;for(V=1;V<S.FullPaths.length;++V)if(de=S.FullPaths[V].slice(ae.length),re=S.FileIndex[V],!(!re.size||!re.content||de=="Sh33tJ5")){var Xe=q,Qe=K(de.length);for(z=0;z<de.length;++z)Qe.write_shift(1,de.charCodeAt(z)&127);Qe=Qe.slice(0,Qe.l),ce[te]=ON.buf(re.content,0);var Rt=re.content;G==8&&(Rt=O(Rt)),R=K(30),R.write_shift(4,67324752),R.write_shift(2,20),R.write_shift(2,Y),R.write_shift(2,G),re.mt?s(R,re.mt):R.write_shift(4,0),R.write_shift(-4,ce[te]),R.write_shift(4,Rt.length),R.write_shift(4,re.content.length),R.write_shift(2,Qe.length),R.write_shift(2,0),q+=R.length,A.push(R),q+=Qe.length,A.push(Qe),q+=Rt.length,A.push(Rt),R=K(46),R.write_shift(4,33639248),R.write_shift(2,0),R.write_shift(2,20),R.write_shift(2,Y),R.write_shift(2,G),R.write_shift(4,0),R.write_shift(-4,ce[te]),R.write_shift(4,Rt.length),R.write_shift(4,re.content.length),R.write_shift(2,Qe.length),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(4,0),R.write_shift(4,Xe),Ae+=R.l,k.push(R),Ae+=Qe.length,k.push(Qe),++te}return R=K(22),R.write_shift(4,101010256),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,te),R.write_shift(2,te),R.write_shift(4,Ae),R.write_shift(4,q),R.write_shift(2,0),wt([wt(A),wt(k),R])}var Fo={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Sv(S,N){if(S.ctype)return S.ctype;var w=S.name||"",A=w.match(/\.([^\.]+)$/);return A&&Fo[A[1]]||N&&(A=(w=N).match(/[\.\\]([^\.\\])+$/),A&&Fo[A[1]])?Fo[A[1]]:"application/octet-stream"}function wv(S){for(var N=mo(S),w=[],A=0;A<N.length;A+=76)w.push(N.slice(A,A+76));return w.join(`\r
`)+`\r
`}function Cv(S){var N=S.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(z){var q=z.charCodeAt(0).toString(16).toUpperCase();return"="+(q.length==1?"0"+q:q)});N=N.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),N.charAt(0)==`
`&&(N="=0D"+N.slice(1)),N=N.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var w=[],A=N.split(`\r
`),k=0;k<A.length;++k){var R=A[k];if(R.length==0){w.push("");continue}for(var G=0;G<R.length;){var Y=76,V=R.slice(G,G+Y);V.charAt(Y-1)=="="?Y--:V.charAt(Y-2)=="="?Y-=2:V.charAt(Y-3)=="="&&(Y-=3),V=R.slice(G,G+Y),G+=Y,G<R.length&&(V+="="),w.push(V)}}return w.join(`\r
`)}function Av(S){for(var N=[],w=0;w<S.length;++w){for(var A=S[w];w<=S.length&&A.charAt(A.length-1)=="=";)A=A.slice(0,A.length-1)+S[++w];N.push(A)}for(var k=0;k<N.length;++k)N[k]=N[k].replace(/[=][0-9A-Fa-f]{2}/g,function(R){return String.fromCharCode(parseInt(R.slice(1),16))});return kn(N.join(`\r
`))}function Nv(S,N,w){for(var A="",k="",R="",G,Y=0;Y<10;++Y){var V=N[Y];if(!V||V.match(/^\s*$/))break;var z=V.match(/^(.*?):\s*([^\s].*)$/);if(z)switch(z[1].toLowerCase()){case"content-location":A=z[2].trim();break;case"content-type":R=z[2].trim();break;case"content-transfer-encoding":k=z[2].trim();break}}switch(++Y,k.toLowerCase()){case"base64":G=kn(lr(N.slice(Y).join("")));break;case"quoted-printable":G=Av(N.slice(Y));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+k)}var q=bl(S,A.slice(w.length),G,{unsafe:!0});R&&(q.ctype=R)}function Iv(S,N){if(ge(S.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var w=N&&N.root||"",A=(Ue&&Buffer.isBuffer(S)?S.toString("binary"):ge(S)).split(`\r
`),k=0,R="";for(k=0;k<A.length;++k)if(R=A[k],!!/^Content-Location:/i.test(R)&&(R=R.slice(R.indexOf("file")),w||(w=R.slice(0,R.lastIndexOf("/")+1)),R.slice(0,w.length)!=w))for(;w.length>0&&(w=w.slice(0,w.length-1),w=w.slice(0,w.lastIndexOf("/")+1),R.slice(0,w.length)!=w););var G=(A[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var Y="--"+(G[1]||""),V=[],z=[],q={FileIndex:V,FullPaths:z};I(q);var te,ae=0;for(k=0;k<A.length;++k){var de=A[k];de!==Y&&de!==Y+"--"||(ae++&&Nv(q,A.slice(te,k),w),te=k)}return q}function kv(S,N){var w=N||{},A=w.boundary||"SheetJS";A="------="+A;for(var k=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+A.slice(2)+'"',"","",""],R=S.FullPaths[0],G=R,Y=S.FileIndex[0],V=1;V<S.FullPaths.length;++V)if(G=S.FullPaths[V].slice(R.length),Y=S.FileIndex[V],!(!Y.size||!Y.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ae){return"_x"+Ae.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ae){return"_u"+Ae.charCodeAt(0).toString(16)+"_"});for(var z=Y.content,q=Ue&&Buffer.isBuffer(z)?z.toString("binary"):ge(z),te=0,ae=Math.min(1024,q.length),de=0,re=0;re<=ae;++re)(de=q.charCodeAt(re))>=32&&de<128&&++te;var ce=te>=ae*4/5;k.push(A),k.push("Content-Location: "+(w.root||"file:///C:/SheetJS/")+G),k.push("Content-Transfer-Encoding: "+(ce?"quoted-printable":"base64")),k.push("Content-Type: "+Sv(Y,G)),k.push(""),k.push(ce?Cv(q):wv(q))}return k.push(A+`--\r
`),k.join(`\r
`)}function Rv(S){var N={};return I(N,S),N}function bl(S,N,w,A){var k=A&&A.unsafe;k||I(S);var R=!k&&ze.find(S,N);if(!R){var G=S.FullPaths[0];N.slice(0,G.length)==G?G=N:(G.slice(-1)!="/"&&(G+="/"),G=(G+N).replace("//","/")),R={name:i(N),type:2},S.FileIndex.push(R),S.FullPaths.push(G),k||ze.utils.cfb_gc(S)}return R.content=w,R.size=w?w.length:0,A&&(A.CLSID&&(R.clsid=A.CLSID),A.mt&&(R.mt=A.mt),A.ct&&(R.ct=A.ct)),R}function Pv(S,N){I(S);var w=ze.find(S,N);if(w){for(var A=0;A<S.FileIndex.length;++A)if(S.FileIndex[A]==w)return S.FileIndex.splice(A,1),S.FullPaths.splice(A,1),!0}return!1}function Fv(S,N,w){I(S);var A=ze.find(S,N);if(A){for(var k=0;k<S.FileIndex.length;++k)if(S.FileIndex[k]==A)return S.FileIndex[k].name=i(w),S.FullPaths[k]=w,!0}return!1}function Mv(S){M(S,!0)}return t.find=J,t.read=F,t.parse=d,t.write=_e,t.writeFile=oe,t.utils={cfb_new:Rv,cfb_add:bl,cfb_del:Pv,cfb_mov:Fv,cfb_gc:Mv,ReadShift:$s,CheckField:mx,prep_blob:tn,bconcat:wt,use_zlib:P,_deflateRaw:r0,_inflateRaw:u0,consts:Me},t}();function BN(e){return typeof e=="string"?Pl(e):Array.isArray(e)?fN(e):e}function No(e,t,n){if(typeof Deno<"u"){if(n&&typeof t=="string")switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=Pl(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r=n=="utf8"?xo(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var i=new Blob([BN(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(e);return a.open("w"),a.encoding="binary",Array.isArray(t)&&(t=Ao(t)),a.write(t),a.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function kt(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function cp(e,t){for(var n=[],r=kt(e),i=0;i!==r.length;++i)n[e[r[i]][t]]==null&&(n[e[r[i]][t]]=r[i]);return n}function Bc(e){for(var t=[],n=kt(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function Dl(e){for(var t=[],n=kt(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}function bN(e){for(var t=[],n=kt(e),r=0;r!==n.length;++r)t[e[n[r]]]==null&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}var tl=new Date(1899,11,30,0,0,0);function Qt(e,t){var n=e.getTime(),r=tl.getTime()+(e.getTimezoneOffset()-tl.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var j1=new Date,VN=tl.getTime()+(j1.getTimezoneOffset()-tl.getTimezoneOffset())*6e4,dp=j1.getTimezoneOffset();function Z1(e){var t=new Date;return t.setTime(e*24*60*60*1e3+VN),t.getTimezoneOffset()!==dp&&t.setTime(t.getTime()+(t.getTimezoneOffset()-dp)*6e4),t}var hp=new Date("2017-02-19T19:06:09.000Z"),ex=isNaN(hp.getFullYear())?new Date("2/19/17"):hp,GN=ex.getFullYear()==2017;function Ht(e,t){var n=new Date(e);if(GN)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(ex.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ll(e,t){if(Ue&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return n[s]||s})}catch{}for(var r=[],i=0;i!=e.length;++i)r.push(String.fromCharCode(e[i]));return r.join("")}function jt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=jt(e[n]));return t}function nt(e,t){for(var n="";n.length<t;)n+=e;return n}function tr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return n=-n,s}),!isNaN(t=Number(r)))?t/n:t}var HN=["january","february","march","april","may","june","july","august","september","october","november","december"];function go(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return n;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&HN.indexOf(o)==-1)return n}else if(o.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||s>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}function Ie(e,t,n){if(e.FullPaths){if(typeof n=="string"){var r;return Ue?r=hr(n):r=cN(n),ze.utils.cfb_add(e,t,r)}ze.utils.cfb_add(e,t,n)}else e.file(t,n)}function bc(){return ze.utils.cfb_new()}var ft=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,zN={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Vc=Bc(zN),Gc=/[&<>'"]/g,WN=/[\u0000-\u0008\u000b-\u001f]/g;function Ve(e){var t=e+"";return t.replace(Gc,function(n){return Vc[n]}).replace(WN,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function pp(e){return Ve(e).replace(/ /g,"_x0020_")}var tx=/[\u0000-\u001f]/g;function qN(e){var t=e+"";return t.replace(Gc,function(n){return Vc[n]}).replace(/\n/g,"<br/>").replace(tx,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function $N(e){var t=e+"";return t.replace(Gc,function(n){return Vc[n]}).replace(tx,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}function JN(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function KN(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function xu(e){for(var t="",n=0,r=0,i=0,s=0,o=0,a=0;n<e.length;){if(r=e.charCodeAt(n++),r<128){t+=String.fromCharCode(r);continue}if(i=e.charCodeAt(n++),r>191&&r<224){o=(r&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(n++),r<240){t+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(n++),a=((r&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(a&1023))}return t}function mp(e){var t=ii(2*e.length),n,r,i=1,s=0,o=0,a;for(r=0;r<e.length;r+=i)i=1,(a=e.charCodeAt(r))<128?n=a:a<224?(n=(a&31)*64+(e.charCodeAt(r+1)&63),i=2):a<240?(n=(a&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),i=3):(i=4,n=(a&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),n-=65536,o=55296+(n>>>10&1023),n=56320+(n&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=n%256,t[s++]=n>>>8;return t.slice(0,s).toString("ucs2")}function gp(e){return hr(e,"binary").toString("utf8")}var ta="foo bar baz",qs=Ue&&(gp(ta)==xu(ta)&&gp||mp(ta)==xu(ta)&&mp)||xu,xo=Ue?function(e){return hr(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,i=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},YN=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)r=r.replace(e[i][0],e[i][1]);return r}}(),nx=/(^\s|\s$|\n)/;function Ct(e,t){return"<"+e+(t.match(nx)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function vo(e){return kt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ie(e,t,n){return"<"+e+(n!=null?vo(n):"")+(t!=null?(t.match(nx)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Rf(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function XN(e,t){switch(typeof e){case"string":var n=ie("vt:lpwstr",Ve(e));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return ie((e|0)==e?"vt:i4":"vt:r8",Ve(String(e)));case"boolean":return ie("vt:bool",e?"true":"false")}if(e instanceof Date)return ie("vt:filetime",Rf(e));throw new Error("Unable to serialize "+e)}var xt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},as=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],nn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function QN(e,t){for(var n=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return r==2047?i==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}function jN(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=r?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var a=0;a<=5;++a,s/=256)e[n+a]=s&255;e[n+6]=(i&15)<<4|s&15,e[n+7]=i>>4|r}var xp=function(e){for(var t=[],n=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var i=0,s=e[0][r].length;i<s;i+=n)t.push.apply(t,e[0][r].slice(i,i+n));return t},vp=Ue?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:hr(t)})):xp(e)}:xp,yp=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(Rs(e,i)));return r.join("").replace(Ws,"")},Hc=Ue?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(Ws,""):yp(e,t,n)}:yp,_p=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},rx=Ue?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):_p(e,t,n)}:_p,Tp=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(yi(e,i)));return r.join("")},Io=Ue?function(t,n,r){return Buffer.isBuffer(t)?t.toString("utf8",n,r):Tp(t,n,r)}:Tp,ix=function(e,t){var n=rn(e,t);return n>0?Io(e,t+4,t+4+n-1):""},sx=ix,ox=function(e,t){var n=rn(e,t);return n>0?Io(e,t+4,t+4+n-1):""},ax=ox,lx=function(e,t){var n=2*rn(e,t);return n>0?Io(e,t+4,t+4+n-1):""},ux=lx,fx=function(t,n){var r=rn(t,n);return r>0?Hc(t,n+4,n+4+r):""},cx=fx,dx=function(e,t){var n=rn(e,t);return n>0?Io(e,t+4,t+4+n):""},hx=dx,px=function(e,t){return QN(e,t)},nl=px,zc=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ue&&(sx=function(t,n){if(!Buffer.isBuffer(t))return ix(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},ax=function(t,n){if(!Buffer.isBuffer(t))return ox(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},ux=function(t,n){if(!Buffer.isBuffer(t))return lx(t,n);var r=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r-1)},cx=function(t,n){if(!Buffer.isBuffer(t))return fx(t,n);var r=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r)},hx=function(t,n){if(!Buffer.isBuffer(t))return dx(t,n);var r=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+r)},nl=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):px(t,n)},zc=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var yi=function(e,t){return e[t]},Rs=function(e,t){return e[t+1]*256+e[t]},ZN=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},rn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},$r=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},eI=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function $s(e,t){var n="",r,i,s=[],o,a,l,u;switch(t){case"dbcs":if(u=this.l,Ue&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)n+=String.fromCharCode(Rs(this,u)),u+=2;e*=2;break;case"utf8":n=Io(this,this.l,this.l+e);break;case"utf16le":e*=2,n=Hc(this,this.l,this.l+e);break;case"wstr":return $s.call(this,e,"dbcs");case"lpstr-ansi":n=sx(this,this.l),e=4+rn(this,this.l);break;case"lpstr-cp":n=ax(this,this.l),e=4+rn(this,this.l);break;case"lpwstr":n=ux(this,this.l),e=4+2*rn(this,this.l);break;case"lpp4":e=4+rn(this,this.l),n=cx(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+rn(this,this.l),n=hx(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(o=yi(this,this.l+e++))!==0;)s.push(jo(o));n=s.join("");break;case"_wstr":for(e=0,n="";(o=Rs(this,this.l+e))!==0;)s.push(jo(o)),e+=2;e+=2,n=s.join("");break;case"dbcs-cont":for(n="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=yi(this,u),this.l=u+1,a=$s.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(jo(Rs(this,u))),u+=2}n=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=yi(this,u),this.l=u+1,a=$s.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(jo(yi(this,u))),u+=1}n=s.join("");break;default:switch(e){case 1:return r=yi(this,this.l),this.l++,r;case 2:return r=(t==="i"?ZN:Rs)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(r=(e>0?$r:eI)(this,this.l),this.l+=4,r):(i=rn(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=nl(this,this.l):i=nl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:n=rx(this,this.l,e);break}}return this.l+=e,n}var tI=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},nI=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},rI=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function iI(e,t,n){var r=0,i=0;if(n==="dbcs"){for(i=0;i!=t.length;++i)rI(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;r=t.length}else if(n==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(n==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,tI(this,t,this.l);break;case 8:if(r=8,n==="f"){jN(this,t,this.l);break}case 16:break;case-4:r=4,nI(this,t,this.l);break}return this.l+=r,this}function mx(e,t){var n=rx(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function tn(e,t){e.l=t,e.read_shift=$s,e.chk=mx,e.write_shift=iI}function qn(e,t){e.l+=t}function K(e){var t=ii(e);return tn(t,0),t}function Xt(){var e=[],t=Ue?256:2048,n=function(u){var d=K(u);return tn(d,0),d},r=n(t),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},s=function(u){return r&&u<r.length-r.l?r:(i(),r=n(Math.max(u+1,t)))},o=function(){return i(),wt(e)},a=function(u){i(),r=u,r.l==null&&(r.l=r.length),s(t)};return{next:s,push:a,end:o,_bufs:e}}function j(e,t,n,r){var i=+t,s;if(!isNaN(i)){r||(r=QP[i].p||(n||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var o=e.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&zc(n)&&e.push(n)}}function Js(e,t,n){var r=jt(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Ep(e,t,n){var r=jt(e);return r.s=Js(r.s,t.s,n),r.e=Js(r.e,t.s,n),r}function Ks(e,t){if(e.cRel&&e.c<0)for(e=jt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=jt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=He(e);return!e.cRel&&e.cRel!=null&&(n=aI(n)),!e.rRel&&e.rRel!=null&&(n=sI(n)),n}function vu(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Lt(e.s.c)+":"+(e.e.cRel?"":"$")+Lt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Nt(e.s.r)+":"+(e.e.rRel?"":"$")+Nt(e.e.r):Ks(e.s,t.biff)+":"+Ks(e.e,t.biff)}function Wc(e){return parseInt(oI(e),10)-1}function Nt(e){return""+(e+1)}function sI(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function oI(e){return e.replace(/\$(\d+)$/,"$1")}function qc(e){for(var t=lI(e),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function Lt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function aI(e){return e.replace(/^([A-Z])/,"$$$1")}function lI(e){return e.replace(/^\$([A-Z])/,"$1")}function uI(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function vt(e){for(var t=0,n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function He(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function ln(e){var t=e.indexOf(":");return t==-1?{s:vt(e),e:vt(e)}:{s:vt(e.slice(0,t)),e:vt(e.slice(t+1))}}function ut(e,t){return typeof t>"u"||typeof t=="number"?ut(e.s,e.e):(typeof e!="string"&&(e=He(e)),typeof t!="string"&&(t=He(t)),e==t?e:e+":"+t)}function Ke(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,s=e.length;for(n=0;r<s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.s.c=--n,n=0;r<s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(t.s.r=--n,r===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return t.e.r=--n,t}function Sp(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Lr(e.z,n?Qt(t):t)}catch{}try{return e.w=Lr((e.XF||{}).numFmtId||(n?14:0),n?Qt(t):t)}catch{return""+t}}function ur(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?ko[e.v]||e.v:t==null?Sp(e,e.v):Sp(e,t))}function fi(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function gx(e,t,n){var r=n||{},i=e?Array.isArray(e):r.dense,s=e||(i?[]:{}),o=0,a=0;if(s&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?vt(r.origin):r.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Ke(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[h].length;++p)if(!(typeof t[h][p]>"u")){var m={v:t[h][p]},y=o+h,x=a+p;if(u.s.r>y&&(u.s.r=y),u.s.c>x&&(u.s.c=x),u.e.r<y&&(u.e.r=y),u.e.c<x&&(u.e.c=x),t[h][p]&&typeof t[h][p]=="object"&&!Array.isArray(t[h][p])&&!(t[h][p]instanceof Date))m=t[h][p];else if(Array.isArray(m.v)&&(m.f=t[h][p][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(r.nullError)m.t="e",m.v=0;else if(r.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=r.dateNF||rt[14],r.cellDates?(m.t="d",m.w=Lr(m.z,Qt(m.v))):(m.t="n",m.v=Qt(m.v),m.w=Lr(m.z,m.v))):m.t="s";if(i)s[y]||(s[y]=[]),s[y][x]&&s[y][x].z&&(m.z=s[y][x].z),s[y][x]=m;else{var E=He({c:x,r:y});s[E]&&s[E].z&&(m.z=s[E].z),s[E]=m}}}return u.s.c<1e7&&(s["!ref"]=ut(u)),s}function ls(e,t){return gx(null,e,t)}function fI(e){return e.read_shift(4,"i")}function Mn(e,t){return t||(t=K(4)),t.write_shift(4,e),t}function Ut(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function yt(e,t){var n=!1;return t==null&&(n=!0,t=K(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function cI(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function dI(e,t){return t||(t=K(4)),t.write_shift(2,0),t.write_shift(2,0),t}function $c(e,t){var n=e.l,r=e.read_shift(1),i=Ut(e),s=[],o={t:i,h:i};if(r&1){for(var a=e.read_shift(4),l=0;l!=a;++l)s.push(cI(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=n+t,o}function hI(e,t){var n=!1;return t==null&&(n=!0,t=K(15+4*e.t.length)),t.write_shift(1,0),yt(e.t,t),n?t.slice(0,t.l):t}var pI=$c;function mI(e,t){var n=!1;return t==null&&(n=!0,t=K(23+4*e.t.length)),t.write_shift(1,1),yt(e.t,t),t.write_shift(4,1),dI({},t),n?t.slice(0,t.l):t}function _n(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function ci(e,t){return t==null&&(t=K(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function di(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function hi(e,t){return t==null&&(t=K(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var gI=Ut,xx=yt;function Jc(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function rl(e,t){var n=!1;return t==null&&(n=!0,t=K(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var xI=Ut,Pf=Jc,Kc=rl;function vx(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,r=t[0]&2;e.l+=4;var i=r===0?nl([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):$r(t,0)>>2;return n?i/100:i}function yx(e,t){t==null&&(t=K(4));var n=0,r=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,n=1),r)t.write_shift(-4,((n?i:e)<<2)+(n+2));else throw new Error("unsupported RkNumber "+e)}function _x(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function vI(e,t){return t||(t=K(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var pi=_x,us=vI;function fs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function si(e,t){return(t||K(8)).write_shift(8,e,"f")}function yI(e){var t={},n=e.read_shift(1),r=n>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),a=e.read_shift(1),l=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=i;var u=II[i];u&&(t.rgb=Dp(u));break;case 2:t.rgb=Dp([o,a,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function il(e,t){if(t||(t=K(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}return t}function _I(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function TI(e,t){t||(t=K(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,n),t.write_shift(1,0),t}var Tx=2,Zt=3,na=11,sl=19,ra=64,EI=65,SI=71,wI=4108,CI=4126,St=80,wp={1:{n:"CodePage",t:Tx},2:{n:"Category",t:St},3:{n:"PresentationFormat",t:St},4:{n:"ByteCount",t:Zt},5:{n:"LineCount",t:Zt},6:{n:"ParagraphCount",t:Zt},7:{n:"SlideCount",t:Zt},8:{n:"NoteCount",t:Zt},9:{n:"HiddenCount",t:Zt},10:{n:"MultimediaClipCount",t:Zt},11:{n:"ScaleCrop",t:na},12:{n:"HeadingPairs",t:wI},13:{n:"TitlesOfParts",t:CI},14:{n:"Manager",t:St},15:{n:"Company",t:St},16:{n:"LinksUpToDate",t:na},17:{n:"CharacterCount",t:Zt},19:{n:"SharedDoc",t:na},22:{n:"HyperlinksChanged",t:na},23:{n:"AppVersion",t:Zt,p:"version"},24:{n:"DigSig",t:EI},26:{n:"ContentType",t:St},27:{n:"ContentStatus",t:St},28:{n:"Language",t:St},29:{n:"Version",t:St},255:{},2147483648:{n:"Locale",t:sl},2147483651:{n:"Behavior",t:sl},1919054434:{}},Cp={1:{n:"CodePage",t:Tx},2:{n:"Title",t:St},3:{n:"Subject",t:St},4:{n:"Author",t:St},5:{n:"Keywords",t:St},6:{n:"Comments",t:St},7:{n:"Template",t:St},8:{n:"LastAuthor",t:St},9:{n:"RevNumber",t:St},10:{n:"EditTime",t:ra},11:{n:"LastPrinted",t:ra},12:{n:"CreatedDate",t:ra},13:{n:"ModifiedDate",t:ra},14:{n:"PageCount",t:Zt},15:{n:"WordCount",t:Zt},16:{n:"CharCount",t:Zt},17:{n:"Thumbnail",t:SI},18:{n:"Application",t:St},19:{n:"DocSecurity",t:Zt},255:{},2147483648:{n:"Locale",t:sl},2147483651:{n:"Behavior",t:sl},1919054434:{}};function AI(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var NI=AI([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),II=jt(NI),ko={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},kI={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ia={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ex(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Sx(e,t){var n=bN(kI),r=[],i;r[r.length]=ft,r[r.length]=ie("Types",null,{xmlns:xt.CT,"xmlns:xsd":xt.xsd,"xmlns:xsi":xt.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ie("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],r[r.length]=ie("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:ia[l][t.bookType]||ia[l].xlsx}))},o=function(l){(e[l]||[]).forEach(function(u){r[r.length]=ie("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:ia[l][t.bookType]||ia[l].xlsx})})},a=function(l){(e[l]||[]).forEach(function(u){r[r.length]=ie("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:n[l][0]})})};return s("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var De={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function wx(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Wi(e){var t=[ft,ie("Relationships",null,{xmlns:xt.RELS})];return kt(e["!id"]).forEach(function(n){t[t.length]=ie("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function be(e,t,n,r,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=n,[De.HLINK,De.XPATH,De.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function RI(e){var t=[ft];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Ap(e,t,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function PI(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function FI(e){var t=[ft];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=e.length;++n)t.push(Ap(e[n][0],e[n][1])),t.push(PI("",e[n][0]));return t.push(Ap("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Cx(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Xa.version+"</meta:generator></office:meta></office:document-meta>"}var jr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function yu(e,t,n,r,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Ve(t),r[r.length]=n?ie(e,t,n):Ct(e,t))}function Ax(e,t){var n=t||{},r=[ft,ie("cp:coreProperties",null,{"xmlns:cp":xt.CORE_PROPS,"xmlns:dc":xt.dc,"xmlns:dcterms":xt.dcterms,"xmlns:dcmitype":xt.dcmitype,"xmlns:xsi":xt.xsi})],i={};if(!e&&!n.Props)return r.join("");e&&(e.CreatedDate!=null&&yu("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Rf(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),e.ModifiedDate!=null&&yu("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Rf(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=jr.length;++s){var o=jr[s],a=n.Props&&n.Props[o[1]]!=null?n.Props[o[1]]:e?e[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&yu(o[0],a,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var qi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Nx=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ix(e){var t=[],n=ie;return e||(e={}),e.Application="SheetJS",t[t.length]=ft,t[t.length]=ie("Properties",null,{xmlns:xt.EXT_PROPS,"xmlns:vt":xt.vt}),qi.forEach(function(r){if(e[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Ve(String(e[r[1]]));break;case"bool":i=e[r[1]]?"true":"false";break}i!==void 0&&(t[t.length]=n(r[0],i))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+Ve(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function kx(e){var t=[ft,ie("Properties",null,{xmlns:xt.CUST_PROPS,"xmlns:vt":xt.vt})];if(!e)return t.join("");var n=1;return kt(e).forEach(function(i){++n,t[t.length]=ie("property",XN(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Ve(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Np={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function MI(e,t){var n=[];return kt(Np).map(function(r){for(var i=0;i<jr.length;++i)if(jr[i][1]==r)return jr[i];for(i=0;i<qi.length;++i)if(qi[i][1]==r)return qi[i];throw r}).forEach(function(r){if(e[r[1]]!=null){var i=t&&t.Props&&t.Props[r[1]]!=null?t.Props[r[1]]:e[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(Ct(Np[r[1]]||r[1],i))}}),ie("DocumentProperties",n.join(""),{xmlns:nn.o})}function DI(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return e&&kt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<jr.length;++o)if(s==jr[o][1])return;for(o=0;o<qi.length;++o)if(s==qi[o][1])return;for(o=0;o<n.length;++o)if(s==n[o])return;var a=e[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(ie(pp(s),a,{"dt:dt":l}))}}),t&&kt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(ie(pp(s),o,{"dt:dt":a}))}}),"<"+r+' xmlns="'+nn.o+'">'+i.join("")+"</"+r+">"}function LI(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,n=t.getTime()/1e3+11644473600,r=n%Math.pow(2,32),i=(n-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var o=K(8);return o.write_shift(4,r),o.write_shift(4,i),o}function Ip(e,t){var n=K(4),r=K(4);switch(n.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,t);break;case 5:r=K(8),r.write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=LI(t);break;case 31:case 80:for(r=K(4+2*(t.length+1)+(t.length%2?0:2)),r.write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return wt([n,r])}var Rx=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function UI(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function kp(e,t,n){var r=K(8),i=[],s=[],o=8,a=0,l=K(8),u=K(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),o+=8+l.length,!t){u=K(8),u.write_shift(4,0),i.unshift(u);var d=[K(4)];for(d[0].write_shift(4,e.length),a=0;a<e.length;++a){var h=e[a][0];for(l=K(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=wt(d),s.unshift(l),o+=8+l.length}for(a=0;a<e.length;++a)if(!(t&&!t[e[a][0]])&&!(Rx.indexOf(e[a][0])>-1||Nx.indexOf(e[a][0])>-1)&&e[a][1]!=null){var p=e[a][1],m=0;if(t){m=+t[e[a][0]];var y=n[m];if(y.p=="version"&&typeof p=="string"){var x=p.split(".");p=(+x[0]<<16)+(+x[1]||0)}l=Ip(y.t,p)}else{var E=UI(p);E==-1&&(E=31,p=String(p)),l=Ip(E,p)}s.push(l),u=K(8),u.write_shift(4,t?m:2+a),i.push(u),o+=8+l.length}var T=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,T),T+=s[a].length;return r.write_shift(4,o),r.write_shift(4,s.length),wt([r].concat(i).concat(s))}function Rp(e,t,n,r,i,s){var o=K(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,ze.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var l=kp(e,n,r);if(a.push(l),i){var u=kp(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+l.length),a.push(u)}return wt(a)}function OI(e,t){t||(t=K(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}function BI(e,t){return e.read_shift(t)===1}function Vt(e,t){return t||(t=K(2)),t.write_shift(2,+!!e),t}function Px(e){return e.read_shift(2,"u")}function dn(e,t){return t||(t=K(2)),t.write_shift(2,e),t}function Fx(e,t,n){return n||(n=K(2)),n.write_shift(1,t=="e"?+e:+!!e),n.write_shift(1,t=="e"?1:0),n}function Mx(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else n.biff==12&&(i="wstr");n.biff>=2&&n.biff<=5&&(i="cpstr");var o=r?e.read_shift(r,i):"";return o}function bI(e){var t=e.t||"",n=K(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=K(2*t.length);r.write_shift(2*t.length,t,"utf16le");var i=[n,r];return wt(i)}function VI(e,t,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function GI(e,t,n){var r=e.read_shift(n&&n.biff==2?1:2);return r===0?(e.l++,""):VI(e,r,n)}function HI(e,t,n){if(n.biff>5)return GI(e,t,n);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Dx(e,t,n){return n||(n=K(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function Pp(e,t){t||(t=K(6+e.length*2)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function zI(e){var t=K(512),n=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(n=0;n<o.length;++n)t.write_shift(4,o[n]);if(s==28)r=r.slice(1),Pp(r,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));var a=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(a.length+1)),n=0;n<a.length;++n)t.write_shift(2,a.charCodeAt(n));t.write_shift(2,0),s&8&&Pp(i>-1?r.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,r.charCodeAt(n+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function oi(e,t,n,r){return r||(r=K(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function WI(e,t,n){var r=n.biff>8?4:2,i=e.read_shift(r),s=e.read_shift(r,"i"),o=e.read_shift(r,"i");return[i,s,o]}function qI(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2);return{s:{c:r,r:t},e:{c:i,r:n}}}function Lx(e,t){return t||(t=K(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Yc(e,t,n){var r=1536,i=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=K(i);return s.write_shift(2,r),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function $I(e,t){var n=!t||t.biff==8,r=K(n?112:54);for(r.write_shift(t.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function JI(e,t){var n=!t||t.biff>=8?2:1,r=K(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function KI(e,t){var n=K(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var r=[],i=0;i<e.length;++i)r[i]=bI(e[i]);var s=wt([n].concat(r));return s.parts=[n.length].concat(r.map(function(o){return o.length})),s}function YI(){var e=K(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function XI(e){var t=K(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function QI(e,t){var n=e.name||"Arial",r=t&&t.biff==5,i=r?15+n.length:16+2*n.length,s=K(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,n.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),s}function jI(e,t,n,r){var i=K(10);return oi(e,t,r,i),i.write_shift(4,n),i}function ZI(e,t,n,r,i){var s=!i||i.biff==8,o=K(8+ +s+(1+s)*n.length);return oi(e,t,r,o),o.write_shift(2,n.length),s&&o.write_shift(1,1),o.write_shift((1+s)*n.length,n,s?"utf16le":"sbcs"),o}function e4(e,t,n,r){var i=n&&n.biff==5;r||(r=K(i?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function t4(e,t){var n=t.biff==8||!t.biff?4:2,r=K(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function Fp(e,t,n,r){var i=n&&n.biff==5;r||(r=K(i?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function n4(e){var t=K(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function r4(e,t,n,r,i,s){var o=K(8);return oi(e,t,r,o),Fx(n,s,o),o}function i4(e,t,n,r){var i=K(14);return oi(e,t,r,i),si(n,i),i}function s4(e,t,n){if(n.biff<8)return o4(e,t,n);for(var r=[],i=e.l+t,s=e.read_shift(n.biff>8?4:2);s--!==0;)r.push(WI(e,n.biff>8?12:6,n));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function o4(e,t,n){e[e.l+1]==3&&e[e.l]++;var r=Mx(e,t,n);return r.charCodeAt(0)==3?r.slice(1):r}function a4(e){var t=K(2+e.length*8);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)Lx(e[n],t);return t}function l4(e){var t=K(24),n=vt(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return wt([t,zI(e[1])])}function u4(e){var t=e[1].Tooltip,n=K(10+2*(t.length+1));n.write_shift(2,2048);var r=vt(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<t.length;++i)n.write_shift(2,t.charCodeAt(i));return n.write_shift(2,0),n}function f4(e){return e||(e=K(4)),e.write_shift(2,1),e.write_shift(2,1),e}function c4(e,t,n){if(!n.cellStyles)return qn(e,t);var r=n&&n.biff>=12?4:2,i=e.read_shift(r),s=e.read_shift(r),o=e.read_shift(r),a=e.read_shift(r),l=e.read_shift(2);r==2&&(e.l+=2);var u={s:i,e:s,w:o,ixfe:a,flags:l};return(n.biff>=5||!n.biff)&&(u.level=l>>8&7),u}function d4(e,t){var n=K(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,e.width*256),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function h4(e){for(var t=K(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}function p4(e,t,n){var r=K(15);return Po(r,e,t),r.write_shift(8,n,"f"),r}function m4(e,t,n){var r=K(9);return Po(r,e,t),r.write_shift(2,n),r}var g4=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Bc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(a,l){var u=[],d=ii(1);switch(l.type){case"base64":d=kn(lr(a));break;case"binary":d=kn(a);break;case"buffer":case"array":d=a;break}tn(d,0);var h=d.read_shift(1),p=!!(h&136),m=!1,y=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,p=!0;break;case 49:m=!0,p=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,E=521;h==2&&(x=d.read_shift(2)),d.l+=3,h!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(E=d.read_shift(2));var T=d.read_shift(2),_=l.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(_=e[d[d.l]]),d.l+=1,d.l+=2),y&&(d.l+=36);for(var v=[],C={},D=Math.min(d.length,h==2?521:E-10-(m?264:0)),F=y?32:11;d.l<D&&d[d.l]!=13;)switch(C={},C.name=Qa.utils.decode(_,d.slice(d.l,d.l+F)).replace(/[\u0000\r\n].*$/g,""),d.l+=F,C.type=String.fromCharCode(d.read_shift(1)),h!=2&&!y&&(C.offset=d.read_shift(4)),C.len=d.read_shift(1),h==2&&(C.offset=d.read_shift(2)),C.dec=d.read_shift(1),C.name.length&&v.push(C),h!=2&&(d.l+=y?13:14),C.type){case"B":(!m||C.len!=8)&&l.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(d[d.l]!==13&&(d.l=E-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=E;var I=0,L=0;for(u[0]=[],L=0;L!=v.length;++L)u[0][L]=v[L].name;for(;x-- >0;){if(d[d.l]===42){d.l+=T;continue}for(++d.l,u[++I]=[],L=0,L=0;L!=v.length;++L){var M=d.slice(d.l,d.l+v[L].len);d.l+=v[L].len,tn(M,0);var B=Qa.utils.decode(_,M);switch(v[L].type){case"C":B.trim().length&&(u[I][L]=B.replace(/\s+$/,""));break;case"D":B.length===8?u[I][L]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):u[I][L]=B;break;case"F":u[I][L]=parseFloat(B.trim());break;case"+":case"I":u[I][L]=y?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":u[I][L]=!0;break;case"N":case"F":u[I][L]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[I][L]="##MEMO##"+(y?parseInt(B.trim(),10):M.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(u[I][L]=+B||0);break;case"@":u[I][L]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":u[I][L]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":u[I][L]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[I][L]=-M.read_shift(-8,"f");break;case"B":if(m&&v[L].len==8){u[I][L]=M.read_shift(8,"f");break}case"G":case"P":M.l+=v[L].len;break;case"0":if(v[L].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[L].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=v,u}function r(a,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var d=ls(n(a,u),u);return d["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,d}function i(a,l){try{return fi(r(a,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var u=l||{};if(+u.codepage>=0&&po(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Xt(),h=fl(a,{header:1,raw:!0,cellDates:!0}),p=h[0],m=h.slice(1),y=a["!cols"]||[],x=0,E=0,T=0,_=1;for(x=0;x<p.length;++x){if(((y[x]||{}).DBF||{}).name){p[x]=y[x].DBF.name,++T;continue}if(p[x]!=null){if(++T,typeof p[x]=="number"&&(p[x]=p[x].toString(10)),typeof p[x]!="string")throw new Error("DBF Invalid column name "+p[x]+" |"+typeof p[x]+"|");if(p.indexOf(p[x])!==x){for(E=0;E<1024;++E)if(p.indexOf(p[x]+"_"+E)==-1){p[x]+="_"+E;break}}}}var v=Ke(a["!ref"]),C=[],D=[],F=[];for(x=0;x<=v.e.c-v.s.c;++x){var I="",L="",M=0,B=[];for(E=0;E<m.length;++E)m[E][x]!=null&&B.push(m[E][x]);if(B.length==0||p[x]==null){C[x]="?";continue}for(E=0;E<B.length;++E){switch(typeof B[E]){case"number":L="B";break;case"string":L="C";break;case"boolean":L="L";break;case"object":L=B[E]instanceof Date?"D":"C";break;default:L="C"}M=Math.max(M,String(B[E]).length),I=I&&I!=L?"C":L}M>250&&(M=250),L=((y[x]||{}).DBF||{}).type,L=="C"&&y[x].DBF.len>M&&(M=y[x].DBF.len),I=="B"&&L=="N"&&(I="N",F[x]=y[x].DBF.dec,M=y[x].DBF.len),D[x]=I=="C"||L=="N"?M:s[I]||0,_+=D[x],C[x]=I}var J=d.next(32);for(J.write_shift(4,318902576),J.write_shift(4,m.length),J.write_shift(2,296+32*T),J.write_shift(2,_),x=0;x<4;++x)J.write_shift(4,0);for(J.write_shift(4,0|(+t[O1]||3)<<8),x=0,E=0;x<p.length;++x)if(p[x]!=null){var H=d.next(32),Z=(p[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);H.write_shift(1,Z,"sbcs"),H.write_shift(1,C[x]=="?"?"C":C[x],"sbcs"),H.write_shift(4,E),H.write_shift(1,D[x]||s[C[x]]||0),H.write_shift(1,F[x]||0),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(1,0),H.write_shift(4,0),H.write_shift(4,0),E+=D[x]||s[C[x]]||0}var Te=d.next(264);for(Te.write_shift(4,13),x=0;x<65;++x)Te.write_shift(4,0);for(x=0;x<m.length;++x){var ye=d.next(_);for(ye.write_shift(1,0),E=0;E<p.length;++E)if(p[E]!=null)switch(C[E]){case"L":ye.write_shift(1,m[x][E]==null?63:m[x][E]?84:70);break;case"B":ye.write_shift(8,m[x][E]||0,"f");break;case"N":var Ee="0";for(typeof m[x][E]=="number"&&(Ee=m[x][E].toFixed(F[E]||0)),T=0;T<D[E]-Ee.length;++T)ye.write_shift(1,32);ye.write_shift(1,Ee,"sbcs");break;case"D":m[x][E]?(ye.write_shift(4,("0000"+m[x][E].getFullYear()).slice(-4),"sbcs"),ye.write_shift(2,("00"+(m[x][E].getMonth()+1)).slice(-2),"sbcs"),ye.write_shift(2,("00"+m[x][E].getDate()).slice(-2),"sbcs")):ye.write_shift(8,"00000000","sbcs");break;case"C":var Me=String(m[x][E]!=null?m[x][E]:"").slice(0,D[E]);for(ye.write_shift(1,Me,"sbcs"),T=0;T<D[E]-Me.length;++T)ye.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:r,from_sheet:o}}(),x4=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+kt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(p,m){var y=e[m];return typeof y=="number"?np(y):y},r=function(p,m,y){var x=m.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?p:np(x)};e["|"]=254;function i(p,m){switch(m.type){case"base64":return s(lr(p),m);case"binary":return s(p,m);case"buffer":return s(Ue&&Buffer.isBuffer(p)?p.toString("binary"):Ao(p),m);case"array":return s(Ll(p),m)}throw new Error("Unrecognized type "+m.type)}function s(p,m){var y=p.split(/[\n\r]+/),x=-1,E=-1,T=0,_=0,v=[],C=[],D=null,F={},I=[],L=[],M=[],B=0,J;for(+m.codepage>=0&&po(+m.codepage);T!==y.length;++T){B=0;var H=y[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),Z=H.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),Te=Z[0],ye;if(H.length>0)switch(Te){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Z[1].charAt(0)=="P"&&C.push(H.slice(3).replace(/;;/g,";"));break;case"C":var Ee=!1,Me=!1,oe=!1,ge=!1,_e=-1,ke=-1;for(_=1;_<Z.length;++_)switch(Z[_].charAt(0)){case"A":break;case"X":E=parseInt(Z[_].slice(1))-1,Me=!0;break;case"Y":for(x=parseInt(Z[_].slice(1))-1,Me||(E=0),J=v.length;J<=x;++J)v[J]=[];break;case"K":ye=Z[_].slice(1),ye.charAt(0)==='"'?ye=ye.slice(1,ye.length-1):ye==="TRUE"?ye=!0:ye==="FALSE"?ye=!1:isNaN(tr(ye))?isNaN(go(ye).getDate())||(ye=Ht(ye)):(ye=tr(ye),D!==null&&Y1(D)&&(ye=Z1(ye))),Ee=!0;break;case"E":ge=!0;var P=mk(Z[_].slice(1),{r:x,c:E});v[x][E]=[v[x][E],P];break;case"S":oe=!0,v[x][E]=[v[x][E],"S5S"];break;case"G":break;case"R":_e=parseInt(Z[_].slice(1))-1;break;case"C":ke=parseInt(Z[_].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+H)}if(Ee&&(v[x][E]&&v[x][E].length==2?v[x][E][0]=ye:v[x][E]=ye,D=null),oe){if(ge)throw new Error("SYLK shared formula cannot have own formula");var W=_e>-1&&v[_e][ke];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");v[x][E][1]=gk(W[1],{r:x-_e,c:E-ke})}break;case"F":var O=0;for(_=1;_<Z.length;++_)switch(Z[_].charAt(0)){case"X":E=parseInt(Z[_].slice(1))-1,++O;break;case"Y":for(x=parseInt(Z[_].slice(1))-1,J=v.length;J<=x;++J)v[J]=[];break;case"M":B=parseInt(Z[_].slice(1))/20;break;case"F":break;case"G":break;case"P":D=C[parseInt(Z[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=Z[_].slice(1).split(" "),J=parseInt(M[0],10);J<=parseInt(M[1],10);++J)B=parseInt(M[2],10),L[J-1]=B===0?{hidden:!0}:{wch:B},Xc(L[J-1]);break;case"C":E=parseInt(Z[_].slice(1))-1,L[E]||(L[E]={});break;case"R":x=parseInt(Z[_].slice(1))-1,I[x]||(I[x]={}),B>0?(I[x].hpt=B,I[x].hpx=Vx(B)):B===0&&(I[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+H)}O<1&&(D=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+H)}}return I.length>0&&(F["!rows"]=I),L.length>0&&(F["!cols"]=L),m&&m.sheetRows&&(v=v.slice(0,m.sheetRows)),[v,F]}function o(p,m){var y=i(p,m),x=y[0],E=y[1],T=ls(x,m);return kt(E).forEach(function(_){T[_]=E[_]}),T}function a(p,m){return fi(o(p,m),m)}function l(p,m,y,x){var E="C;Y"+(y+1)+";X"+(x+1)+";K";switch(p.t){case"n":E+=p.v||0,p.f&&!p.F&&(E+=";E"+jc(p.f,{r:y,c:x}));break;case"b":E+=p.v?"TRUE":"FALSE";break;case"e":E+=p.w||p.v;break;case"d":E+='"'+(p.w||p.v)+'"';break;case"s":E+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function u(p,m){m.forEach(function(y,x){var E="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?E+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=ol(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=al(y.wpx)),typeof y.wch=="number"&&(E+=Math.round(y.wch))),E.charAt(E.length-1)!=" "&&p.push(E)})}function d(p,m){m.forEach(function(y,x){var E="F;";y.hidden?E+="M0;":y.hpt?E+="M"+20*y.hpt+";":y.hpx&&(E+="M"+20*ll(y.hpx)+";"),E.length>2&&p.push(E+"R"+(x+1))})}function h(p,m){var y=["ID;PWXL;N;E"],x=[],E=Ke(p["!ref"]),T,_=Array.isArray(p),v=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),p["!cols"]&&u(y,p["!cols"]),p["!rows"]&&d(y,p["!rows"]),y.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var C=E.s.r;C<=E.e.r;++C)for(var D=E.s.c;D<=E.e.c;++D){var F=He({r:C,c:D});T=_?(p[C]||[])[D]:p[F],!(!T||T.v==null&&(!T.f||T.F))&&x.push(l(T,p,C,D))}return y.join(v)+v+x.join(v)+v+"E"+v}return{to_workbook:a,to_sheet:o,from_sheet:h}}(),v4=function(){function e(s,o){switch(o.type){case"base64":return t(lr(s),o);case"binary":return t(s,o);case"buffer":return t(Ue&&Buffer.isBuffer(s)?s.toString("binary"):Ao(s),o);case"array":return t(Ll(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var a=s.split(`
`),l=-1,u=-1,d=0,h=[];d!==a.length;++d){if(a[d].trim()==="BOT"){h[++l]=[],u=0;continue}if(!(l<0)){var p=a[d].trim().split(","),m=p[0],y=p[1];++d;for(var x=a[d]||"";(x.match(/["]/g)||[]).length&1&&d<a.length-1;)x+=`
`+a[++d];switch(x=x.trim(),+m){case-1:if(x==="BOT"){h[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[l][u]=!0:x==="FALSE"?h[l][u]=!1:isNaN(tr(y))?isNaN(go(y).getDate())?h[l][u]=y:h[l][u]=Ht(y):h[l][u]=tr(y),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function n(s,o){return ls(e(s,o),o)}function r(s,o){return fi(n(s,o),o)}var i=function(){var s=function(l,u,d,h,p){l.push(u),l.push(d+","+h),l.push('"'+p.replace(/"/g,'""')+'"')},o=function(l,u,d,h){l.push(u+","+d),l.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var u=[],d=Ke(l["!ref"]),h,p=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){o(u,-1,0,"BOT");for(var y=d.s.c;y<=d.e.c;++y){var x=He({r:m,c:y});if(h=p?(l[m]||[])[y]:l[x],!h){o(u,1,0,"");continue}switch(h.t){case"n":var E=h.w;!E&&h.v!=null&&(E=h.v),E==null?h.f&&!h.F?o(u,1,0,"="+h.f):o(u,1,0,""):o(u,0,E,"V");break;case"b":o(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Lr(h.z||rt[14],Qt(Ht(h.v)))),o(u,0,h.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var T=`\r
`,_=u.join(T);return _}}();return{to_workbook:r,to_sheet:n,from_sheet:i}}(),Ux=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(h,p){for(var m=h.split(`
`),y=-1,x=-1,E=0,T=[];E!==m.length;++E){var _=m[E].trim().split(":");if(_[0]==="cell"){var v=vt(_[1]);if(T.length<=v.r)for(y=T.length;y<=v.r;++y)T[y]||(T[y]=[]);switch(y=v.r,x=v.c,_[2]){case"t":T[y][x]=e(_[3]);break;case"v":T[y][x]=+_[3];break;case"vtf":var C=_[_.length-1];case"vtc":switch(_[3]){case"nl":T[y][x]=!!+_[4];break;default:T[y][x]=+_[4];break}_[2]=="vtf"&&(T[y][x]=[T[y][x],C])}}}return p&&p.sheetRows&&(T=T.slice(0,p.sheetRows)),T}function r(h,p){return ls(n(h,p),p)}function i(h,p){return fi(r(h,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var p=[],m=[],y,x="",E=ln(h["!ref"]),T=Array.isArray(h),_=E.s.r;_<=E.e.r;++_)for(var v=E.s.c;v<=E.e.c;++v)if(x=He({r:_,c:v}),y=T?(h[_]||[])[v]:h[x],!(!y||y.v==null||y.t==="z")){switch(m=["cell",x,"t"],y.t){case"s":case"str":m.push(t(y.v));break;case"n":y.f?(m[2]="vtf",m[3]="n",m[4]=y.v,m[5]=t(y.f)):(m[2]="v",m[3]=y.v);break;case"b":m[2]="vt"+(y.f?"f":"c"),m[3]="nl",m[4]=y.v?"1":"0",m[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var C=Qt(Ht(y.v));m[2]="vtc",m[3]="nd",m[4]=""+C,m[5]=y.w||Lr(y.z||rt[14],C);break;case"e":continue}p.push(m.join(":"))}return p.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(h){return[s,o,a,o,u(h),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:d}}(),y4=function(){function e(d,h,p,m,y){y.raw?h[p][m]=d:d===""||(d==="TRUE"?h[p][m]=!0:d==="FALSE"?h[p][m]=!1:isNaN(tr(d))?isNaN(go(d).getDate())?h[p][m]=d:h[p][m]=Ht(d):h[p][m]=tr(d))}function t(d,h){var p=h||{},m=[];if(!d||d.length===0)return m;for(var y=d.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var E=10,T=0,_=0;_<=x;++_)T=y[_].indexOf(" "),T==-1?T=y[_].length:T++,E=Math.max(E,T);for(_=0;_<=x;++_){m[_]=[];var v=0;for(e(y[_].slice(0,E).trim(),m,_,v,p),v=1;v<=(y[_].length-E)/10+1;++v)e(y[_].slice(E+(v-1)*10,E+v*10).trim(),m,_,v,p)}return p.sheetRows&&(m=m.slice(0,p.sheetRows)),m}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(d){for(var h={},p=!1,m=0,y=0;m<d.length;++m)(y=d.charCodeAt(m))==34?p=!p:!p&&y in n&&(h[y]=(h[y]||0)+1);y=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&y.push([h[m],m]);if(!y.length){h=r;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&y.push([h[m],m])}return y.sort(function(x,E){return x[0]-E[0]||r[x[1]]-r[E[1]]}),n[y.pop()[1]]||44}function s(d,h){var p=h||{},m="",y=p.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=i(d.slice(0,1024)):p&&p.FS?m=p.FS:m=i(d.slice(0,1024));var E=0,T=0,_=0,v=0,C=0,D=m.charCodeAt(0),F=!1,I=0,L=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var M=p.dateNF!=null?LN(p.dateNF):null;function B(){var J=d.slice(v,C),H={};if(J.charAt(0)=='"'&&J.charAt(J.length-1)=='"'&&(J=J.slice(1,-1).replace(/""/g,'"')),J.length===0)H.t="z";else if(p.raw)H.t="s",H.v=J;else if(J.trim().length===0)H.t="s",H.v=J;else if(J.charCodeAt(0)==61)J.charCodeAt(1)==34&&J.charCodeAt(J.length-1)==34?(H.t="s",H.v=J.slice(2,-1).replace(/""/g,'"')):xk(J)?(H.t="n",H.f=J.slice(1)):(H.t="s",H.v=J);else if(J=="TRUE")H.t="b",H.v=!0;else if(J=="FALSE")H.t="b",H.v=!1;else if(!isNaN(_=tr(J)))H.t="n",p.cellText!==!1&&(H.w=J),H.v=_;else if(!isNaN(go(J).getDate())||M&&J.match(M)){H.z=p.dateNF||rt[14];var Z=0;M&&J.match(M)&&(J=UN(J,p.dateNF,J.match(M)||[]),Z=1),p.cellDates?(H.t="d",H.v=Ht(J,Z)):(H.t="n",H.v=Qt(Ht(J,Z))),p.cellText!==!1&&(H.w=Lr(H.z,H.v instanceof Date?Qt(H.v):H.v)),p.cellNF||delete H.z}else H.t="s",H.v=J;if(H.t=="z"||(p.dense?(y[E]||(y[E]=[]),y[E][T]=H):y[He({c:T,r:E})]=H),v=C+1,L=d.charCodeAt(v),x.e.c<T&&(x.e.c=T),x.e.r<E&&(x.e.r=E),I==D)++T;else if(T=0,++E,p.sheetRows&&p.sheetRows<=E)return!0}e:for(;C<d.length;++C)switch(I=d.charCodeAt(C)){case 34:L===34&&(F=!F);break;case D:case 10:case 13:if(!F&&B())break e;break}return C-v>0&&B(),y["!ref"]=ut(x),y}function o(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,h):ls(t(d,h),h)}function a(d,h){var p="",m=h.type=="string"?[0,0,0,0]:PF(d,h);switch(h.type){case"base64":p=lr(d);break;case"binary":p=d;break;case"buffer":h.codepage==65001?p=d.toString("utf8"):h.codepage&&typeof Qa<"u"||(p=Ue&&Buffer.isBuffer(d)?d.toString("binary"):Ao(d));break;case"array":p=Ll(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?p=qs(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=qs(p):h.type=="binary"&&typeof Qa<"u",p.slice(0,19)=="socialcalc:version:"?Ux.to_sheet(h.type=="string"?p:qs(p),h):o(p,h)}function l(d,h){return fi(a(d,h),h)}function u(d){for(var h=[],p=Ke(d["!ref"]),m,y=Array.isArray(d),x=p.s.r;x<=p.e.r;++x){for(var E=[],T=p.s.c;T<=p.e.c;++T){var _=He({r:x,c:T});if(m=y?(d[x]||[])[T]:d[_],!m||m.v==null){E.push("          ");continue}for(var v=(m.w||(ur(m),m.w)||"").slice(0,10);v.length<10;)v+=" ";E.push(v+(T===0?" ":""))}h.push(E.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:u}}(),Mp=function(){function e(P,W,O){if(P){tn(P,P.l||0);for(var U=O.Enum||_e;P.l<P.length;){var Q=P.read_shift(2),he=U[Q]||U[65535],xe=P.read_shift(2),me=P.l+xe,le=he.f&&he.f(P,xe,O);if(P.l=me,W(le,he,Q))return}}}function t(P,W){switch(W.type){case"base64":return n(kn(lr(P)),W);case"binary":return n(kn(P),W);case"buffer":case"array":return n(P,W)}throw"Unsupported type "+W.type}function n(P,W){if(!P)return P;var O=W||{},U=O.dense?[]:{},Q="Sheet1",he="",xe=0,me={},le=[],Oe=[],Pe={s:{r:0,c:0},e:{r:0,c:0}},pt=O.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)O.Enum=_e,e(P,function(X,ve,Se){switch(Se){case 0:O.vers=X,X>=4096&&(O.qpro=!0);break;case 6:Pe=X;break;case 204:X&&(he=X);break;case 222:he=X;break;case 15:case 51:O.qpro||(X[1].v=X[1].v.slice(1));case 13:case 14:case 16:Se==14&&(X[2]&112)==112&&(X[2]&15)>1&&(X[2]&15)<15&&(X[1].z=O.dateNF||rt[14],O.cellDates&&(X[1].t="d",X[1].v=Z1(X[1].v))),O.qpro&&X[3]>xe&&(U["!ref"]=ut(Pe),me[Q]=U,le.push(Q),U=O.dense?[]:{},Pe={s:{r:0,c:0},e:{r:0,c:0}},xe=X[3],Q=he||"Sheet"+(xe+1),he="");var it=O.dense?(U[X[0].r]||[])[X[0].c]:U[He(X[0])];if(it){it.t=X[1].t,it.v=X[1].v,X[1].z!=null&&(it.z=X[1].z),X[1].f!=null&&(it.f=X[1].f);break}O.dense?(U[X[0].r]||(U[X[0].r]=[]),U[X[0].r][X[0].c]=X[1]):U[He(X[0])]=X[1];break}},O);else if(P[2]==26||P[2]==14)O.Enum=ke,P[2]==14&&(O.qpro=!0,P.l=0),e(P,function(X,ve,Se){switch(Se){case 204:Q=X;break;case 22:X[1].v=X[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(X[3]>xe&&(U["!ref"]=ut(Pe),me[Q]=U,le.push(Q),U=O.dense?[]:{},Pe={s:{r:0,c:0},e:{r:0,c:0}},xe=X[3],Q="Sheet"+(xe+1)),pt>0&&X[0].r>=pt)break;O.dense?(U[X[0].r]||(U[X[0].r]=[]),U[X[0].r][X[0].c]=X[1]):U[He(X[0])]=X[1],Pe.e.c<X[0].c&&(Pe.e.c=X[0].c),Pe.e.r<X[0].r&&(Pe.e.r=X[0].r);break;case 27:X[14e3]&&(Oe[X[14e3][0]]=X[14e3][1]);break;case 1537:Oe[X[0]]=X[1],X[0]==xe&&(Q=X[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(U["!ref"]=ut(Pe),me[he||Q]=U,le.push(he||Q),!Oe.length)return{SheetNames:le,Sheets:me};for(var b={},ee=[],ue=0;ue<Oe.length;++ue)me[le[ue]]?(ee.push(Oe[ue]||le[ue]),b[Oe[ue]]=me[Oe[ue]]||me[le[ue]]):(ee.push(Oe[ue]),b[Oe[ue]]={"!ref":"A1"});return{SheetNames:ee,Sheets:b}}function r(P,W){var O=W||{};if(+O.codepage>=0&&po(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var U=Xt(),Q=Ke(P["!ref"]),he=Array.isArray(P),xe=[];se(U,0,s(1030)),se(U,6,l(Q));for(var me=Math.min(Q.e.r,8191),le=Q.s.r;le<=me;++le)for(var Oe=Nt(le),Pe=Q.s.c;Pe<=Q.e.c;++Pe){le===Q.s.r&&(xe[Pe]=Lt(Pe));var pt=xe[Pe]+Oe,b=he?(P[le]||[])[Pe]:P[pt];if(!(!b||b.t=="z"))if(b.t=="n")(b.v|0)==b.v&&b.v>=-32768&&b.v<=32767?se(U,13,m(le,Pe,b.v)):se(U,14,x(le,Pe,b.v));else{var ee=ur(b);se(U,15,h(le,Pe,ee.slice(0,239)))}}return se(U,1),U.end()}function i(P,W){var O=W||{};if(+O.codepage>=0&&po(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var U=Xt();se(U,0,o(P));for(var Q=0,he=0;Q<P.SheetNames.length;++Q)(P.Sheets[P.SheetNames[Q]]||{})["!ref"]&&se(U,27,ge(P.SheetNames[Q],he++));var xe=0;for(Q=0;Q<P.SheetNames.length;++Q){var me=P.Sheets[P.SheetNames[Q]];if(!(!me||!me["!ref"])){for(var le=Ke(me["!ref"]),Oe=Array.isArray(me),Pe=[],pt=Math.min(le.e.r,8191),b=le.s.r;b<=pt;++b)for(var ee=Nt(b),ue=le.s.c;ue<=le.e.c;++ue){b===le.s.r&&(Pe[ue]=Lt(ue));var X=Pe[ue]+ee,ve=Oe?(me[b]||[])[ue]:me[X];if(!(!ve||ve.t=="z"))if(ve.t=="n")se(U,23,B(b,ue,xe,ve.v));else{var Se=ur(ve);se(U,22,I(b,ue,xe,Se.slice(0,239)))}}++xe}}return se(U,1),U.end()}function s(P){var W=K(2);return W.write_shift(2,P),W}function o(P){var W=K(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var O=0,U=0,Q=0,he=0;he<P.SheetNames.length;++he){var xe=P.SheetNames[he],me=P.Sheets[xe];if(!(!me||!me["!ref"])){++Q;var le=ln(me["!ref"]);O<le.e.r&&(O=le.e.r),U<le.e.c&&(U=le.e.c)}}return O>8191&&(O=8191),W.write_shift(2,O),W.write_shift(1,Q),W.write_shift(1,U),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function a(P,W,O){var U={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&O.qpro?(U.s.c=P.read_shift(1),P.l++,U.s.r=P.read_shift(2),U.e.c=P.read_shift(1),P.l++,U.e.r=P.read_shift(2),U):(U.s.c=P.read_shift(2),U.s.r=P.read_shift(2),W==12&&O.qpro&&(P.l+=2),U.e.c=P.read_shift(2),U.e.r=P.read_shift(2),W==12&&O.qpro&&(P.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function l(P){var W=K(8);return W.write_shift(2,P.s.c),W.write_shift(2,P.s.r),W.write_shift(2,P.e.c),W.write_shift(2,P.e.r),W}function u(P,W,O){var U=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(U[0].c=P.read_shift(1),U[3]=P.read_shift(1),U[0].r=P.read_shift(2),P.l+=2):(U[2]=P.read_shift(1),U[0].c=P.read_shift(2),U[0].r=P.read_shift(2)),U}function d(P,W,O){var U=P.l+W,Q=u(P,W,O);if(Q[1].t="s",O.vers==20768){P.l++;var he=P.read_shift(1);return Q[1].v=P.read_shift(he,"utf8"),Q}return O.qpro&&P.l++,Q[1].v=P.read_shift(U-P.l,"cstr"),Q}function h(P,W,O){var U=K(7+O.length);U.write_shift(1,255),U.write_shift(2,W),U.write_shift(2,P),U.write_shift(1,39);for(var Q=0;Q<U.length;++Q){var he=O.charCodeAt(Q);U.write_shift(1,he>=128?95:he)}return U.write_shift(1,0),U}function p(P,W,O){var U=u(P,W,O);return U[1].v=P.read_shift(2,"i"),U}function m(P,W,O){var U=K(7);return U.write_shift(1,255),U.write_shift(2,W),U.write_shift(2,P),U.write_shift(2,O,"i"),U}function y(P,W,O){var U=u(P,W,O);return U[1].v=P.read_shift(8,"f"),U}function x(P,W,O){var U=K(13);return U.write_shift(1,255),U.write_shift(2,W),U.write_shift(2,P),U.write_shift(8,O,"f"),U}function E(P,W,O){var U=P.l+W,Q=u(P,W,O);if(Q[1].v=P.read_shift(8,"f"),O.qpro)P.l=U;else{var he=P.read_shift(2);C(P.slice(P.l,P.l+he),Q),P.l+=he}return Q}function T(P,W,O){var U=W&32768;return W&=-32769,W=(U?P:0)+(W>=8192?W-16384:W),(U?"":"$")+(O?Lt(W):Nt(W))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(P,W){tn(P,0);for(var O=[],U=0,Q="",he="",xe="",me="";P.l<P.length;){var le=P[P.l++];switch(le){case 0:O.push(P.read_shift(8,"f"));break;case 1:he=T(W[0].c,P.read_shift(2),!0),Q=T(W[0].r,P.read_shift(2),!1),O.push(he+Q);break;case 2:{var Oe=T(W[0].c,P.read_shift(2),!0),Pe=T(W[0].r,P.read_shift(2),!1);he=T(W[0].c,P.read_shift(2),!0),Q=T(W[0].r,P.read_shift(2),!1),O.push(Oe+Pe+":"+he+Q)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(P.read_shift(2));break;case 6:{for(var pt="";le=P[P.l++];)pt+=String.fromCharCode(le);O.push('"'+pt.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:me=O.pop(),xe=O.pop(),O.push(["AND","OR"][le-20]+"("+xe+","+me+")");break;default:if(le<32&&v[le])me=O.pop(),xe=O.pop(),O.push(xe+v[le]+me);else if(_[le]){if(U=_[le][1],U==69&&(U=P[P.l++]),U>O.length){console.error("WK1 bad formula parse 0x"+le.toString(16)+":|"+O.join("|")+"|");return}var b=O.slice(-U);O.length-=U,O.push(_[le][0]+"("+b.join(",")+")")}else return le<=7?console.error("WK1 invalid opcode "+le.toString(16)):le<=24?console.error("WK1 unsupported op "+le.toString(16)):le<=30?console.error("WK1 invalid opcode "+le.toString(16)):le<=115?console.error("WK1 unsupported function opcode "+le.toString(16)):console.error("WK1 unrecognized opcode "+le.toString(16))}}O.length==1?W[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function D(P){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=P.read_shift(2),W[3]=P[P.l++],W[0].c=P[P.l++],W}function F(P,W){var O=D(P);return O[1].t="s",O[1].v=P.read_shift(W-4,"cstr"),O}function I(P,W,O,U){var Q=K(6+U.length);Q.write_shift(2,P),Q.write_shift(1,O),Q.write_shift(1,W),Q.write_shift(1,39);for(var he=0;he<U.length;++he){var xe=U.charCodeAt(he);Q.write_shift(1,xe>=128?95:xe)}return Q.write_shift(1,0),Q}function L(P,W){var O=D(P);O[1].v=P.read_shift(2);var U=O[1].v>>1;if(O[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return O[1].v=U,O}function M(P,W){var O=D(P),U=P.read_shift(4),Q=P.read_shift(4),he=P.read_shift(2);if(he==65535)return U===0&&Q===3221225472?(O[1].t="e",O[1].v=15):U===0&&Q===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var xe=he&32768;return he=(he&32767)-16446,O[1].v=(1-xe*2)*(Q*Math.pow(2,he+32)+U*Math.pow(2,he)),O}function B(P,W,O,U){var Q=K(14);if(Q.write_shift(2,P),Q.write_shift(1,O),Q.write_shift(1,W),U==0)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var he=0,xe=0,me=0,le=0;return U<0&&(he=1,U=-U),xe=Math.log2(U)|0,U/=Math.pow(2,xe-31),le=U>>>0,le&2147483648||(U/=2,++xe,le=U>>>0),U-=le,le|=2147483648,le>>>=0,U*=Math.pow(2,32),me=U>>>0,Q.write_shift(4,me),Q.write_shift(4,le),xe+=16383+(he?32768:0),Q.write_shift(2,xe),Q}function J(P,W){var O=M(P);return P.l+=W-14,O}function H(P,W){var O=D(P),U=P.read_shift(4);return O[1].v=U>>6,O}function Z(P,W){var O=D(P),U=P.read_shift(8,"f");return O[1].v=U,O}function Te(P,W){var O=Z(P);return P.l+=W-10,O}function ye(P,W){return P[P.l+W-1]==0?P.read_shift(W,"cstr"):""}function Ee(P,W){var O=P[P.l++];O>W-1&&(O=W-1);for(var U="";U.length<O;)U+=String.fromCharCode(P[P.l++]);return U}function Me(P,W,O){if(!(!O.qpro||W<21)){var U=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var Q=P.read_shift(W-21,"cstr");return[U,Q]}}function oe(P,W){for(var O={},U=P.l+W;P.l<U;){var Q=P.read_shift(2);if(Q==14e3){for(O[Q]=[0,""],O[Q][0]=P.read_shift(2);P[P.l];)O[Q][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return O}function ge(P,W){var O=K(5+P.length);O.write_shift(2,14e3),O.write_shift(2,W);for(var U=0;U<P.length;++U){var Q=P.charCodeAt(U);O[O.l++]=Q>127?95:Q}return O[O.l++]=0,O}var _e={0:{n:"BOF",f:Px},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ye},222:{n:"SHEETNAMELP",f:Ee},65535:{n:""}},ke={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:L},25:{n:"FORMULA19",f:J},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:H},38:{n:"??"},39:{n:"NUMBER27",f:Z},40:{n:"FORMULA28",f:Te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ye},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:t}}(),_4=/^\s|\s$|[\t\n\r]/;function Ox(e,t){if(!t.bookSST)return"";var n=[ft];n[n.length]=ie("sst",null,{xmlns:as[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var i=e[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(_4)&&(s+=' xml:space="preserve"'),s+=">"+Ve(i.t)+"</t>"),s+="</si>",n[n.length]=s}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function T4(e){return[e.read_shift(4),e.read_shift(4)]}function E4(e,t){return t||(t=K(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var S4=hI;function w4(e){var t=Xt();j(t,159,E4(e));for(var n=0;n<e.length;++n)j(t,19,S4(e[n]));return j(t,160),t.end()}function C4(e){for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function Bx(e){var t=0,n,r=C4(e),i=r.length+1,s,o,a,l,u;for(n=ii(i),n[0]=r.length,s=1;s!=i;++s)n[s]=r[s-1];for(s=i-1;s>=0;--s)o=n[s],a=t&16384?1:0,l=t<<1&32767,u=a|l,t=u^o;return t^52811}var A4=function(){function e(i,s){switch(s.type){case"base64":return t(lr(i),s);case"binary":return t(i,s);case"buffer":return t(Ue&&Buffer.isBuffer(i)?i.toString("binary"):Ao(i),s);case"array":return t(Ll(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,h){Array.isArray(a)&&(a[h]=[]);for(var p=/\\\w+\b/g,m=0,y,x=-1;y=p.exec(d);){switch(y[0]){case"\\cell":var E=d.slice(m,p.lastIndex-y[0].length);if(E[0]==" "&&(E=E.slice(1)),++x,E.length){var T={v:E,t:"s"};Array.isArray(a)?a[h][x]=T:a[He({r:h,c:x})]=T}break}m=p.lastIndex}x>u.e.c&&(u.e.c=x)}),a["!ref"]=ut(u),a}function n(i,s){return fi(e(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],o=Ke(i["!ref"]),a,l=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var h=He({r:u,c:d});a=l?(i[u]||[])[d]:i[h],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(ur(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:r}}();function Dp(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}var N4=6,nr=N4;function ol(e){return Math.floor((e+Math.round(128/nr)/256)*nr)}function al(e){return Math.floor((e-5)/nr*100+.5)/100}function Ff(e){return Math.round((e*nr+5)/nr*256)/256}function Xc(e){e.width?(e.wpx=ol(e.width),e.wch=al(e.wpx),e.MDW=nr):e.wpx?(e.wch=al(e.wpx),e.width=Ff(e.wch),e.MDW=nr):typeof e.wch=="number"&&(e.width=Ff(e.wch),e.wpx=ol(e.width),e.MDW=nr),e.customWidth&&delete e.customWidth}var I4=96,bx=I4;function ll(e){return e*96/bx}function Vx(e){return e*bx/96}function k4(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)e[r]!=null&&(t[t.length]=ie("numFmt",null,{numFmtId:r,formatCode:Ve(e[r])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ie("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function R4(e){var t=[];return t[t.length]=ie("cellXfs",null),e.forEach(function(n){t[t.length]=ie("xf",null,n)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ie("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Gx(e,t){var n=[ft,ie("styleSheet",null,{xmlns:as[0],"xmlns:vt":xt.vt})],r;return e.SSF&&(r=k4(e.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=R4(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function P4(e,t){var n=e.read_shift(2),r=Ut(e);return[n,r]}function F4(e,t,n){n||(n=K(6+4*t.length)),n.write_shift(2,e),yt(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function M4(e,t,n){var r={};r.sz=e.read_shift(2)/20;var i=_I(e);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=e.read_shift(2);switch(s===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(r.underline=o);var a=e.read_shift(1);a>0&&(r.family=a);var l=e.read_shift(1);switch(l>0&&(r.charset=l),e.l++,r.color=yI(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Ut(e),r}function D4(e,t){t||(t=K(25+4*32)),t.write_shift(2,e.sz*20),TI(e,t),t.write_shift(2,e.bold?700:400);var n=0;e.vertAlign=="superscript"?n=1:e.vertAlign=="subscript"&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),il(e.color,t);var r=0;return r=2,t.write_shift(1,r),yt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var L4=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],_u,U4=qn;function Lp(e,t){t||(t=K(4*3+8*7+16*1)),_u||(_u=Bc(L4));var n=_u[e.patternType];n==null&&(n=40),t.write_shift(4,n);var r=0;if(n!=40)for(il({auto:1},t),il({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function O4(e,t){var n=e.l+t,r=e.read_shift(2),i=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:i}}function Hx(e,t,n){n||(n=K(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function Cs(e,t){return t||(t=K(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var B4=qn;function b4(e,t){return t||(t=K(51)),t.write_shift(1,0),Cs(null,t),Cs(null,t),Cs(null,t),Cs(null,t),Cs(null,t),t.length>t.l?t.slice(0,t.l):t}function V4(e,t){return t||(t=K(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),rl(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function G4(e,t,n){var r=K(2052);return r.write_shift(4,e),rl(t,r),rl(n,r),r.length>r.l?r.slice(0,r.l):r}function H4(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&++n}),n!=0&&(j(e,615,Mn(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&j(e,44,F4(i,t[i]))}),j(e,616))}}function z4(e){var t=1;j(e,611,Mn(t)),j(e,43,D4({sz:12,color:{theme:1},name:"Calibri",family:2})),j(e,612)}function W4(e){var t=2;j(e,603,Mn(t)),j(e,45,Lp({patternType:"none"})),j(e,45,Lp({patternType:"gray125"})),j(e,604)}function q4(e){var t=1;j(e,613,Mn(t)),j(e,46,b4()),j(e,614)}function $4(e){var t=1;j(e,626,Mn(t)),j(e,47,Hx({numFmtId:0},65535)),j(e,627)}function J4(e,t){j(e,617,Mn(t.length)),t.forEach(function(n){j(e,47,Hx(n,0))}),j(e,618)}function K4(e){var t=1;j(e,619,Mn(t)),j(e,48,V4({xfId:0,name:"Normal"})),j(e,620)}function Y4(e){var t=0;j(e,505,Mn(t)),j(e,506)}function X4(e){var t=0;j(e,508,G4(t,"TableStyleMedium9","PivotStyleMedium4")),j(e,509)}function Q4(e,t){var n=Xt();return j(n,278),H4(n,e.SSF),z4(n),W4(n),q4(n),$4(n),J4(n,t.cellXfs),K4(n),Y4(n),X4(n),j(n,279),n.end()}function zx(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var n=[ft];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function j4(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ut(e)}}function Z4(e){var t=K(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),yt(e.name,t),t.slice(0,t.l)}function ek(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function tk(e){var t=K(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}function nk(e,t){var n=K(8+2*t.length);return n.write_shift(4,e),yt(t,n),n.slice(0,n.l)}function rk(e){return e.l+=4,e.read_shift(4)!=0}function ik(e,t){var n=K(8);return n.write_shift(4,e),n.write_shift(4,1),n}function sk(){var e=Xt();return j(e,332),j(e,334,Mn(1)),j(e,335,Z4({name:"XLDAPR",version:12e4,flags:3496657072})),j(e,336),j(e,339,nk(1,"XLDAPR")),j(e,52),j(e,35,Mn(514)),j(e,4096,Mn(0)),j(e,4097,dn(1)),j(e,36),j(e,53),j(e,340),j(e,337,ik(1)),j(e,51,tk([[1,0]])),j(e,338),j(e,333),e.end()}function Wx(){var e=[ft];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function ok(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=He(n);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}var Mi=1024;function qx(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[ie("xml",null,{"xmlns:v":nn.v,"xmlns:o":nn.o,"xmlns:x":nn.x,"xmlns:mv":nn.mv}).replace(/\/>/,">"),ie("o:shapelayout",ie("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ie("v:shapetype",[ie("v:stroke",null,{joinstyle:"miter"}),ie("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Mi<e*1e3;)Mi+=1e3;return t.forEach(function(s){var o=vt(s[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?ie("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ie("v:fill",l,a),d={on:"t",obscured:"t"};++Mi,i=i.concat(["<v:shape"+vo({id:"_x0000_s"+Mi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ie("v:shadow",null,d),ie("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ct("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Ct("x:AutoFill","False"),Ct("x:Row",String(o.r)),Ct("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function $x(e){var t=[ft,ie("comments",null,{xmlns:as[0]})],n=[];return t.push("<authors>"),e.forEach(function(r){r[1].forEach(function(i){var s=Ve(i.a);n.indexOf(s)==-1&&(n.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&n.indexOf("tc="+i.ID)==-1&&(n.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=n.indexOf(Ve(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(Ct("t",Ve(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,a=1;a<s.length;++a)o+=`Reply:
    `+s[a]+`
`;t.push(Ct("t",Ve(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function ak(e,t,n){var r=[ft,ie("ThreadedComments",null,{xmlns:xt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};a==0?s=l.id:l.parentId=s,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),r.push(ie("threadedComment",Ct("text",o.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function lk(e){var t=[ft,ie("personList",null,{xmlns:xt.TCMNT,"xmlns:x":as[0]}).replace(/[\/]>/,">")];return e.forEach(function(n,r){t.push(ie("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),t.push("</personList>"),t.join("")}function uk(e){var t={};t.iauthor=e.read_shift(4);var n=pi(e);return t.rfx=n.s,t.ref=He(n.s),e.l+=16,t}function fk(e,t){return t==null&&(t=K(36)),t.write_shift(4,e[1].iauthor),us(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var ck=Ut;function dk(e){return yt(e.slice(0,54))}function hk(e){var t=Xt(),n=[];return j(t,628),j(t,630),e.forEach(function(r){r[1].forEach(function(i){n.indexOf(i.a)>-1||(n.push(i.a.slice(0,54)),j(t,632,dk(i.a)))})}),j(t,631),j(t,633),e.forEach(function(r){r[1].forEach(function(i){i.iauthor=n.indexOf(i.a);var s={s:vt(r[0]),e:vt(r[0])};j(t,635,fk([s,i])),i.t&&i.t.length>0&&j(t,637,mI(i)),j(t,636),delete i.iauthor})}),j(t,634),j(t,629),t.end()}function pk(e,t){t.FullPaths.forEach(function(n,r){if(r!=0){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&ze.utils.cfb_add(e,i,t.FileIndex[r].content)}})}var Jx=["xlsb","xlsm","xlam","biff8","xla"],mk=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(r,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return a?d+=t.c:--d,l?u+=t.r:--u,i+(a?"":"$")+Lt(d)+(l?"":"$")+Nt(u)}return function(i,s){return t=s,i.replace(e,n)}}(),Qc=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,jc=function(){return function(t,n){return t.replace(Qc,function(r,i,s,o,a,l){var u=qc(o)-(s?0:n.c),d=Wc(l)-(a?0:n.r),h=d==0?"":a?d+1:"["+d+"]",p=u==0?"":s?u+1:"["+u+"]";return i+"R"+h+"C"+p})}}();function gk(e,t){return e.replace(Qc,function(n,r,i,s,o,a){return r+(i=="$"?i+s:Lt(qc(s)+t.c))+(o=="$"?o+a:Nt(Wc(a)+t.r))})}function xk(e){return e.length!=1}function at(e){e.l+=1}function Ur(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function Kx(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return Yx(e);n.biff==12&&(r=4)}var i=e.read_shift(r),s=e.read_shift(r),o=Ur(e),a=Ur(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function Yx(e){var t=Ur(e),n=Ur(e),r=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function vk(e,t,n){if(n.biff<8)return Yx(e);var r=e.read_shift(n.biff==12?4:2),i=e.read_shift(n.biff==12?4:2),s=Ur(e),o=Ur(e);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Xx(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return yk(e);var r=e.read_shift(n&&n.biff==12?4:2),i=Ur(e);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function yk(e){var t=Ur(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function _k(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function Tk(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return Ek(e);var i=e.read_shift(r>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function Ek(e){var t=e.read_shift(2),n=e.read_shift(1),r=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),i==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:i,rRel:r}}function Sk(e,t,n){var r=(e[e.l++]&96)>>5,i=Kx(e,n.biff>=2&&n.biff<=5?6:8,n);return[r,i]}function wk(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=Kx(e,s,n);return[r,i,o]}function Ck(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function Ak(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[r,i]}function Nk(e,t,n){var r=(e[e.l++]&96)>>5,i=vk(e,t-1,n);return[r,i]}function Ik(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[r]}function Up(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function kk(e,t,n){e.l+=2;for(var r=e.read_shift(n&&n.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(e.read_shift(n&&n.biff==2?1:2));return i}function Rk(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function Pk(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function Fk(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Mk(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[r]}function Qx(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function Dk(e){return e.read_shift(2),Qx(e)}function Lk(e){return e.read_shift(2),Qx(e)}function Uk(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=Xx(e,0,n);return[r,i]}function Ok(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=Tk(e,0,n);return[r,i]}function Bk(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var s=Xx(e,0,n);return[r,i,s]}function bk(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(n&&n.biff<=3?1:2);return[bR[i],ev[i],r]}function Vk(e,t,n){var r=e[e.l++],i=e.read_shift(1),s=n&&n.biff<=3?[r==88?-1:0,e.read_shift(1)]:Gk(e);return[i,(s[0]===0?ev:BR)[s[1]]]}function Gk(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Hk(e,t,n){e.l+=n&&n.biff==2?3:4}function zk(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function Wk(e){return e.l++,ko[e.read_shift(1)]}function qk(e){return e.l++,e.read_shift(2)}function $k(e){return e.l++,e.read_shift(1)!==0}function Jk(e){return e.l++,fs(e)}function Kk(e,t,n){return e.l++,Mx(e,t-1,n)}function Yk(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=BI(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=ko[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=fs(e);break;case 2:n[1]=HI(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function Xk(e,t,n){for(var r=e.read_shift(n.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((n.biff==12?pi:qI)(e));return i}function Qk(e,t,n){var r=0,i=0;n.biff==12?(r=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--i==0&&(i=256));for(var s=0,o=[];s!=r&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=Yk(e,n.biff);return o}function jk(e,t,n){var r=e.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,s=e.read_shift(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,s]}function Zk(e,t,n){if(n.biff==5)return eR(e);var r=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[r,i,s]}function eR(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}function tR(e,t,n){var r=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function nR(e,t,n){var r=e.read_shift(1)>>>5&3,i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function rR(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[r]}function iR(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[r,i]}var sR=qn,oR=qn,aR=qn;function Ro(e,t,n){return e.l+=2,[_k(e)]}function Zc(e){return e.l+=6,[]}var lR=Ro,uR=Zc,fR=Zc,cR=Ro;function jx(e){return e.l+=2,[Px(e),e.read_shift(2)&1]}var dR=Ro,hR=jx,pR=Zc,mR=Ro,gR=Ro,xR=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function vR(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=xR[n>>2&31];return{ixti:t,coltype:n&3,rt:o,idx:r,c:i,C:s}}function yR(e){return e.l+=2,[e.read_shift(4)]}function _R(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function TR(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function ER(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function SR(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function wR(e){return e.l+=4,[0,0]}var Op={1:{n:"PtgExp",f:zk},2:{n:"PtgTbl",f:aR},3:{n:"PtgAdd",f:at},4:{n:"PtgSub",f:at},5:{n:"PtgMul",f:at},6:{n:"PtgDiv",f:at},7:{n:"PtgPower",f:at},8:{n:"PtgConcat",f:at},9:{n:"PtgLt",f:at},10:{n:"PtgLe",f:at},11:{n:"PtgEq",f:at},12:{n:"PtgGe",f:at},13:{n:"PtgGt",f:at},14:{n:"PtgNe",f:at},15:{n:"PtgIsect",f:at},16:{n:"PtgUnion",f:at},17:{n:"PtgRange",f:at},18:{n:"PtgUplus",f:at},19:{n:"PtgUminus",f:at},20:{n:"PtgPercent",f:at},21:{n:"PtgParen",f:at},22:{n:"PtgMissArg",f:at},23:{n:"PtgStr",f:Kk},26:{n:"PtgSheet",f:_R},27:{n:"PtgEndSheet",f:TR},28:{n:"PtgErr",f:Wk},29:{n:"PtgBool",f:$k},30:{n:"PtgInt",f:qk},31:{n:"PtgNum",f:Jk},32:{n:"PtgArray",f:Ik},33:{n:"PtgFunc",f:bk},34:{n:"PtgFuncVar",f:Vk},35:{n:"PtgName",f:jk},36:{n:"PtgRef",f:Uk},37:{n:"PtgArea",f:Sk},38:{n:"PtgMemArea",f:tR},39:{n:"PtgMemErr",f:sR},40:{n:"PtgMemNoMem",f:oR},41:{n:"PtgMemFunc",f:nR},42:{n:"PtgRefErr",f:rR},43:{n:"PtgAreaErr",f:Ck},44:{n:"PtgRefN",f:Ok},45:{n:"PtgAreaN",f:Nk},46:{n:"PtgMemAreaN",f:ER},47:{n:"PtgMemNoMemN",f:SR},57:{n:"PtgNameX",f:Zk},58:{n:"PtgRef3d",f:Bk},59:{n:"PtgArea3d",f:wk},60:{n:"PtgRefErr3d",f:iR},61:{n:"PtgAreaErr3d",f:Ak},255:{}},CR={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},AR={1:{n:"PtgElfLel",f:jx},2:{n:"PtgElfRw",f:mR},3:{n:"PtgElfCol",f:lR},6:{n:"PtgElfRwV",f:gR},7:{n:"PtgElfColV",f:cR},10:{n:"PtgElfRadical",f:dR},11:{n:"PtgElfRadicalS",f:pR},13:{n:"PtgElfColS",f:uR},15:{n:"PtgElfColSV",f:fR},16:{n:"PtgElfRadicalLel",f:hR},25:{n:"PtgList",f:vR},29:{n:"PtgSxName",f:yR},255:{}},NR={0:{n:"PtgAttrNoop",f:wR},1:{n:"PtgAttrSemi",f:Mk},2:{n:"PtgAttrIf",f:Pk},4:{n:"PtgAttrChoose",f:kk},8:{n:"PtgAttrGoto",f:Rk},16:{n:"PtgAttrSum",f:Hk},32:{n:"PtgAttrBaxcel",f:Up},33:{n:"PtgAttrBaxcel",f:Up},64:{n:"PtgAttrSpace",f:Dk},65:{n:"PtgAttrSpaceSemi",f:Lk},128:{n:"PtgAttrIfError",f:Fk},255:{}};function IR(e,t,n,r){if(r.biff<8)return qn(e,t);for(var i=e.l+t,s=[],o=0;o!==n.length;++o)switch(n[o][0]){case"PtgArray":n[o][1]=Qk(e,0,r),s.push(n[o][1]);break;case"PtgMemArea":n[o][2]=Xk(e,n[o][1],r),s.push(n[o][2]);break;case"PtgExp":r&&r.biff==12&&(n[o][1][1]=e.read_shift(4),s.push(n[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[o][0]}return t=i-e.l,t!==0&&s.push(qn(e,t)),s}function kR(e,t,n){for(var r=e.l+t,i,s,o=[];r!=e.l;)t=r-e.l,s=e[e.l],i=Op[s]||Op[CR[s]],(s===24||s===25)&&(i=(s===24?AR:NR)[e[e.l+1]]),!i||!i.f?qn(e,t):o.push([i.n,i.f(e,t,n)]);return o}function RR(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],i=[],s=0;s<r.length;++s){var o=r[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var PR={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function FR(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Zx(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(e[r[0]][0]){case 357:return i=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[r[0]][0][3]?(i=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Bp(e,t,n){var r=Zx(e,t,n);return r=="#REF"?r:FR(r,n)}function es(e,t,n,r,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},a=[],l,u,d,h=0,p=0,m,y="";if(!e[0]||!e[0][0])return"";for(var x=-1,E="",T=0,_=e[0].length;T<_;++T){var v=e[0][T];switch(v[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),u=a.pop(),x>=0){switch(e[0][x][1][0]){case 0:E=nt(" ",e[0][x][1][1]);break;case 1:E=nt("\r",e[0][x][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}u=u+E,x=-1}a.push(u+PR[v[0]]+l);break;case"PtgIsect":l=a.pop(),u=a.pop(),a.push(u+" "+l);break;case"PtgUnion":l=a.pop(),u=a.pop(),a.push(u+","+l);break;case"PtgRange":l=a.pop(),u=a.pop(),a.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Js(v[1][1],o,i),a.push(Ks(d,s));break;case"PtgRefN":d=n?Js(v[1][1],n,i):v[1][1],a.push(Ks(d,s));break;case"PtgRef3d":h=v[1][1],d=Js(v[1][2],o,i),y=Bp(r,h,i),a.push(y+"!"+Ks(d,s));break;case"PtgFunc":case"PtgFuncVar":var C=v[1][0],D=v[1][1];C||(C=0),C&=127;var F=C==0?[]:a.slice(-C);a.length-=C,D==="User"&&(D=F.shift()),a.push(D+"("+F.join(",")+")");break;case"PtgBool":a.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(v[1]);break;case"PtgNum":a.push(String(v[1]));break;case"PtgStr":a.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(v[1]);break;case"PtgAreaN":m=Ep(v[1][1],n?{s:n}:o,i),a.push(vu(m,i));break;case"PtgArea":m=Ep(v[1][1],o,i),a.push(vu(m,i));break;case"PtgArea3d":h=v[1][1],m=v[1][2],y=Bp(r,h,i),a.push(y+"!"+vu(m,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=v[1][2];var I=(r.names||[])[p-1]||(r[0]||[])[p],L=I?I.Name:"SH33TJSNAME"+String(p);L&&L.slice(0,6)=="_xlfn."&&!i.xlfn&&(L=L.slice(6)),a.push(L);break;case"PtgNameX":var M=v[1][1];p=v[1][2];var B;if(i.biff<=5)M<0&&(M=-M),r[M]&&(B=r[M][p]);else{var J="";if(((r[M]||[])[0]||[])[0]==14849||(((r[M]||[])[0]||[])[0]==1025?r[M][p]&&r[M][p].itab>0&&(J=r.SheetNames[r[M][p].itab-1]+"!"):J=r.SheetNames[p-1]+"!"),r[M]&&r[M][p])J+=r[M][p].Name;else if(r[0]&&r[0][p])J+=r[0][p].Name;else{var H=(Zx(r,M,i)||"").split(";;");H[p-1]?J=H[p-1]:J+="SH33TJSERRX"}a.push(J);break}B||(B={Name:"SH33TJSERRY"}),a.push(B.Name);break;case"PtgParen":var Z="(",Te=")";if(x>=0){switch(E="",e[0][x][1][0]){case 2:Z=nt(" ",e[0][x][1][1])+Z;break;case 3:Z=nt("\r",e[0][x][1][1])+Z;break;case 4:Te=nt(" ",e[0][x][1][1])+Te;break;case 5:Te=nt("\r",e[0][x][1][1])+Te;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}a.push(Z+a.pop()+Te);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":d={c:v[1][1],r:v[1][0]};var ye={c:n.c,r:n.r};if(r.sharedf[He(d)]){var Ee=r.sharedf[He(d)];a.push(es(Ee,o,ye,r,i))}else{var Me=!1;for(l=0;l!=r.arrayf.length;++l)if(u=r.arrayf[l],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){a.push(es(u[1],o,ye,r,i)),Me=!0;break}Me||a.push(v[1])}break;case"PtgArray":a.push("{"+RR(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&oe.indexOf(e[0][T][0])==-1){v=e[0][x];var ge=!0;switch(v[1][0]){case 4:ge=!1;case 0:E=nt(" ",v[1][1]);break;case 5:ge=!1;case 1:E=nt("\r",v[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}a.push((ge?E:"")+a.pop()+(ge?"":E)),x=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function MR(e){if(e==null){var t=K(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return si(e);return si(0)}function DR(e,t,n,r,i){var s=oi(t,n,i),o=MR(e.v),a=K(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var u=K(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var h=wt([s,o,a,u]);return h}function Ul(e,t,n){var r=e.read_shift(4),i=kR(e,r,n),s=e.read_shift(4),o=s>0?IR(e,s,i,n):null;return[i,o]}var LR=Ul,Ol=Ul,UR=Ul,OR=Ul,BR={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ev={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},bR={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function VR(e){var t="of:="+e.replace(Qc,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function GR(e){return e.replace(/\./,"!")}var Ys=typeof Map<"u";function e0(e,t,n){var r=0,i=e.length;if(n){if(Ys?n.has(t):Object.prototype.hasOwnProperty.call(n,t)){for(var s=Ys?n.get(t):n[t];r<s.length;++r)if(e[s[r]].t===t)return e.Count++,s[r]}}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t},e.Count++,e.Unique++,n&&(Ys?(n.has(t)||n.set(t,[]),n.get(t).push(i)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(i))),i}function Bl(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(nr=t.MDW),t.width!=null?n.customWidth=1:t.wpx!=null?r=al(t.wpx):t.wch!=null&&(r=t.wch),r>-1?(n.width=Ff(r),n.customWidth=1):t.width!=null&&(n.width=t.width),t.hidden&&(n.hidden=!0),t.level!=null&&(n.outlineLevel=n.level=t.level),n}function tv(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function Hr(e,t,n){var r=n.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(r==null&&n.ssf){for(;i<392;++i)if(n.ssf[i]==null){X1(t.z,i),n.ssf[i]=t.z,n.revssf[t.z]=r=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===r)return i;return e[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function HR(e,t,n){if(e&&e["!ref"]){var r=Ke(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}function zR(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+ut(e[n])+'"/>';return t+"</mergeCells>"}function WR(e,t,n,r,i){var s=!1,o={},a=null;if(r.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch{}s=!0,o.codeName=xo(Ve(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),a=(a||"")+ie("outlinePr",null,u)}!s&&!a||(i[i.length]=ie("sheetPr",a,o))}var qR=["objects","scenarios","selectLockedCells","selectUnlockedCells"],$R=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function JR(e){var t={sheet:1};return qR.forEach(function(n){e[n]!=null&&e[n]&&(t[n]="1")}),$R.forEach(function(n){e[n]!=null&&!e[n]&&(t[n]="0")}),e.password&&(t.password=Bx(e.password).toString(16).toUpperCase()),ie("sheetProtection",null,t)}function KR(e){return tv(e),ie("pageMargins",null,e)}function YR(e,t){for(var n=["<cols>"],r,i=0;i!=t.length;++i)(r=t[i])&&(n[n.length]=ie("col",null,Bl(i,r)));return n[n.length]="</cols>",n.join("")}function XR(e,t,n,r){var i=typeof e.ref=="string"?e.ref:ut(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,o=ln(i);o.s.r==o.e.r&&(o.e.r=ln(t["!ref"]).e.r,i=ut(o));for(var a=0;a<s.length;++a){var l=s[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),ie("autoFilter",null,{ref:i})}function QR(e,t,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),ie("sheetViews",ie("sheetView",null,i),{})}function jR(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=ko[e.v];break;case"d":r&&r.cellDates?i=Ht(e.v,-1).toISOString():(e=jt(e),e.t="n",i=""+(e.v=Qt(Ht(e.v)))),typeof e.z>"u"&&(e.z=rt[14]);break;default:i=e.v;break}var a=Ct("v",Ve(i)),l={r:t},u=Hr(r.cellXfs,e,r);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){a=Ct("v",""+e0(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;a=ie("f",Ve(e.f),d)+(e.v!=null?a:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),ie("c",a,l)}function ZR(e,t,n,r){var i=[],s=[],o=Ke(e["!ref"]),a="",l,u="",d=[],h=0,p=0,m=e["!rows"],y=Array.isArray(e),x={r:u},E,T=-1;for(p=o.s.c;p<=o.e.c;++p)d[p]=Lt(p);for(h=o.s.r;h<=o.e.r;++h){for(s=[],u=Nt(h),p=o.s.c;p<=o.e.c;++p){l=d[p]+u;var _=y?(e[h]||[])[p]:e[l];_!==void 0&&(a=jR(_,l,e,t))!=null&&s.push(a)}(s.length>0||m&&m[h])&&(x={r:u},m&&m[h]&&(E=m[h],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=ll(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level)),i[i.length]=ie("row",s.join(""),x))}if(m)for(;h<m.length;++h)m&&m[h]&&(x={r:h+1},E=m[h],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=ll(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level),i[i.length]=ie("row","",x));return i.join("")}function nv(e,t,n,r){var i=[ft,ie("worksheet",null,{xmlns:as[0],"xmlns:r":xt.r})],s=n.SheetNames[e],o=0,a="",l=n.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",d=Ke(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=ut(d)}r||(r={}),l["!comments"]=[];var h=[];WR(l,n,e,t,i),i[i.length]=ie("dimension",null,{ref:u}),i[i.length]=QR(l,t,e,n),t.sheetFormat&&(i[i.length]=ie("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=YR(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=ZR(l,t),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=JR(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=XR(l["!autofilter"],l,n,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=zR(l["!merges"]));var p=-1,m,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=be(r,-1,Ve(x[1].Target).replace(/#.*$/,""),De.HLINK),m["r:id"]="rId"+y),(p=x[1].Target.indexOf("#"))>-1&&(m.location=Ve(x[1].Target.slice(p+1))),x[1].Tooltip&&(m.tooltip=Ve(x[1].Tooltip)),i[i.length]=ie("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=KR(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Ct("ignoredErrors",ie("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(y=be(r,-1,"../drawings/drawing"+(e+1)+".xml",De.DRAW),i[i.length]=ie("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=h),l["!comments"].length>0&&(y=be(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",De.VML),i[i.length]=ie("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function e3(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=r,s&7&&(n.level=s&7),s&16&&(n.hidden=!0),s&32&&(n.hpt=i/20),n}function t3(e,t,n){var r=K(145),i=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var s=320;i.hpx?s=ll(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var a=0,l=r.l;r.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var h=-1,p=-1,m=d<<10;m<d+1<<10;++m){u.c=m;var y=Array.isArray(n)?(n[u.r]||[])[u.c]:n[He(u)];y&&(h<0&&(h=m),p=m)}h<0||(++a,r.write_shift(4,h),r.write_shift(4,p))}var x=r.l;return r.l=l,r.write_shift(4,a),r.l=x,r.length>r.l?r.slice(0,r.l):r}function n3(e,t,n,r){var i=t3(r,n,t);(i.length>17||(t["!rows"]||[])[r])&&j(e,0,i)}var r3=pi,i3=us;function s3(){}function o3(e,t){var n={},r=e[e.l];return++e.l,n.above=!(r&64),n.left=!(r&128),e.l+=18,n.name=gI(e),n}function a3(e,t,n){n==null&&(n=K(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return il({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),xx(e,n),n.slice(0,n.l)}function l3(e){var t=_n(e);return[t]}function u3(e,t,n){return n==null&&(n=K(8)),ci(t,n)}function f3(e){var t=di(e);return[t]}function c3(e,t,n){return n==null&&(n=K(4)),hi(t,n)}function d3(e){var t=_n(e),n=e.read_shift(1);return[t,n,"b"]}function h3(e,t,n){return n==null&&(n=K(9)),ci(t,n),n.write_shift(1,e.v?1:0),n}function p3(e){var t=di(e),n=e.read_shift(1);return[t,n,"b"]}function m3(e,t,n){return n==null&&(n=K(5)),hi(t,n),n.write_shift(1,e.v?1:0),n}function g3(e){var t=_n(e),n=e.read_shift(1);return[t,n,"e"]}function x3(e,t,n){return n==null&&(n=K(9)),ci(t,n),n.write_shift(1,e.v),n}function v3(e){var t=di(e),n=e.read_shift(1);return[t,n,"e"]}function y3(e,t,n){return n==null&&(n=K(8)),hi(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}function _3(e){var t=_n(e),n=e.read_shift(4);return[t,n,"s"]}function T3(e,t,n){return n==null&&(n=K(12)),ci(t,n),n.write_shift(4,t.v),n}function E3(e){var t=di(e),n=e.read_shift(4);return[t,n,"s"]}function S3(e,t,n){return n==null&&(n=K(8)),hi(t,n),n.write_shift(4,t.v),n}function w3(e){var t=_n(e),n=fs(e);return[t,n,"n"]}function C3(e,t,n){return n==null&&(n=K(16)),ci(t,n),si(e.v,n),n}function A3(e){var t=di(e),n=fs(e);return[t,n,"n"]}function N3(e,t,n){return n==null&&(n=K(12)),hi(t,n),si(e.v,n),n}function I3(e){var t=_n(e),n=vx(e);return[t,n,"n"]}function k3(e,t,n){return n==null&&(n=K(12)),ci(t,n),yx(e.v,n),n}function R3(e){var t=di(e),n=vx(e);return[t,n,"n"]}function P3(e,t,n){return n==null&&(n=K(8)),hi(t,n),yx(e.v,n),n}function F3(e){var t=_n(e),n=$c(e);return[t,n,"is"]}function M3(e){var t=_n(e),n=Ut(e);return[t,n,"str"]}function D3(e,t,n){return n==null&&(n=K(12+4*e.v.length)),ci(t,n),yt(e.v,n),n.length>n.l?n.slice(0,n.l):n}function L3(e){var t=di(e),n=Ut(e);return[t,n,"str"]}function U3(e,t,n){return n==null&&(n=K(8+4*e.v.length)),hi(t,n),yt(e.v,n),n.length>n.l?n.slice(0,n.l):n}function O3(e,t,n){var r=e.l+t,i=_n(e);i.r=n["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(n.cellFormula){e.l+=2;var a=Ol(e,r-e.l,n);o[3]=es(a,null,i,n.supbooks,n)}else e.l=r;return o}function B3(e,t,n){var r=e.l+t,i=_n(e);i.r=n["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(n.cellFormula){e.l+=2;var a=Ol(e,r-e.l,n);o[3]=es(a,null,i,n.supbooks,n)}else e.l=r;return o}function b3(e,t,n){var r=e.l+t,i=_n(e);i.r=n["!row"];var s=fs(e),o=[i,s,"n"];if(n.cellFormula){e.l+=2;var a=Ol(e,r-e.l,n);o[3]=es(a,null,i,n.supbooks,n)}else e.l=r;return o}function V3(e,t,n){var r=e.l+t,i=_n(e);i.r=n["!row"];var s=Ut(e),o=[i,s,"str"];if(n.cellFormula){e.l+=2;var a=Ol(e,r-e.l,n);o[3]=es(a,null,i,n.supbooks,n)}else e.l=r;return o}var G3=pi,H3=us;function z3(e,t){return t==null&&(t=K(4)),t.write_shift(4,e),t}function W3(e,t){var n=e.l+t,r=pi(e),i=Jc(e),s=Ut(e),o=Ut(e),a=Ut(e);e.l=n;var l={rfx:r,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function q3(e,t){var n=K(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));us({s:vt(e[0]),e:vt(e[0])},n),Kc("rId"+t,n);var r=e[1].Target.indexOf("#"),i=r==-1?"":e[1].Target.slice(r+1);return yt(i||"",n),yt(e[1].Tooltip||"",n),yt("",n),n.slice(0,n.l)}function $3(){}function J3(e,t,n){var r=e.l+t,i=_x(e),s=e.read_shift(1),o=[i];if(o[2]=s,n.cellFormula){var a=LR(e,r-e.l,n);o[1]=a}else e.l=r;return o}function K3(e,t,n){var r=e.l+t,i=pi(e),s=[i];if(n.cellFormula){var o=OR(e,r-e.l,n);s[1]=o,e.l=r}else e.l=r;return s}function Y3(e,t,n){n==null&&(n=K(18));var r=Bl(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),n.write_shift(2,i),n}var rv=["left","right","top","bottom","header","footer"];function X3(e){var t={};return rv.forEach(function(n){t[n]=fs(e)}),t}function Q3(e,t){return t==null&&(t=K(6*8)),tv(e),rv.forEach(function(n){si(e[n],t)}),t}function j3(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Z3(e,t,n){n==null&&(n=K(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function eP(e){var t=K(24);return t.write_shift(4,4),t.write_shift(4,1),us(e,t),t}function tP(e,t){return t==null&&(t=K(16*4+2)),t.write_shift(2,e.password?Bx(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?t.write_shift(4,e[n[0]]!=null&&!e[n[0]]?1:0):t.write_shift(4,e[n[0]]!=null&&e[n[0]]?0:1)}),t}function nP(){}function rP(){}function iP(e,t,n,r,i,s,o){if(t.v===void 0)return!1;var a="";switch(t.t){case"b":a=t.v?"1":"0";break;case"d":t=jt(t),t.z=t.z||rt[14],t.v=Qt(Ht(t.v)),t.t="n";break;case"n":case"e":a=""+t.v;break;default:a=t.v;break}var l={r:n,c:r};switch(l.s=Hr(i.cellXfs,t,i),t.l&&s["!links"].push([He(l),t.l]),t.c&&s["!comments"].push([He(l),t.c]),t.t){case"s":case"str":return i.bookSST?(a=e0(i.Strings,t.v,i.revStrings),l.t="s",l.v=a,o?j(e,18,S3(t,l)):j(e,7,T3(t,l))):(l.t="str",o?j(e,17,U3(t,l)):j(e,6,D3(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?j(e,13,P3(t,l)):j(e,2,k3(t,l)):o?j(e,16,N3(t,l)):j(e,5,C3(t,l)),!0;case"b":return l.t="b",o?j(e,15,m3(t,l)):j(e,4,h3(t,l)),!0;case"e":return l.t="e",o?j(e,14,y3(t,l)):j(e,3,x3(t,l)),!0}return o?j(e,12,c3(t,l)):j(e,1,u3(t,l)),!0}function sP(e,t,n,r){var i=Ke(t["!ref"]||"A1"),s,o="",a=[];j(e,145);var l=Array.isArray(t),u=i.e.r;t["!rows"]&&(u=Math.max(i.e.r,t["!rows"].length-1));for(var d=i.s.r;d<=u;++d){o=Nt(d),n3(e,t,i,d);var h=!1;if(d<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){d===i.s.r&&(a[p]=Lt(p)),s=a[p]+o;var m=l?(t[d]||[])[p]:t[s];if(!m){h=!1;continue}h=iP(e,m,d,p,r,t,h)}}j(e,146)}function oP(e,t){!t||!t["!merges"]||(j(e,177,z3(t["!merges"].length)),t["!merges"].forEach(function(n){j(e,176,H3(n))}),j(e,178))}function aP(e,t){!t||!t["!cols"]||(j(e,390),t["!cols"].forEach(function(n,r){n&&j(e,60,Y3(r,n))}),j(e,391))}function lP(e,t){!t||!t["!ref"]||(j(e,648),j(e,649,eP(Ke(t["!ref"]))),j(e,650))}function uP(e,t,n){t["!links"].forEach(function(r){if(r[1].Target){var i=be(n,-1,r[1].Target.replace(/#.*$/,""),De.HLINK);j(e,494,q3(r,i))}}),delete t["!links"]}function fP(e,t,n,r){if(t["!comments"].length>0){var i=be(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",De.VML);j(e,551,Kc("rId"+i)),t["!legacy"]=i}}function cP(e,t,n,r){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:ut(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,a=ln(s);a.s.r==a.e.r&&(a.e.r=ln(t["!ref"]).e.r,s=ut(a));for(var l=0;l<o.length;++l){var u=o[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+n.SheetNames[r]+"'!"+s;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+s}),j(e,161,us(Ke(s))),j(e,162)}}function dP(e,t,n){j(e,133),j(e,137,Z3(t,n)),j(e,138),j(e,134)}function hP(e,t){t["!protect"]&&j(e,535,tP(t["!protect"]))}function pP(e,t,n,r){var i=Xt(),s=n.SheetNames[e],o=n.Sheets[s]||{},a=s;try{n&&n.Workbook&&(a=n.Workbook.Sheets[e].CodeName||a)}catch{}var l=Ke(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],j(i,129),(n.vbaraw||o["!outline"])&&j(i,147,a3(a,o["!outline"])),j(i,148,i3(l)),dP(i,o,n.Workbook),aP(i,o),sP(i,o,e,t),hP(i,o),cP(i,o,n,e),oP(i,o),uP(i,o,r),o["!margins"]&&j(i,476,Q3(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&lP(i,o),fP(i,o,e,r),j(i,130),i.end()}function mP(e,t){e.l+=10;var n=Ut(e);return{name:n}}var gP=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function xP(e){return!e.Workbook||!e.Workbook.WBProps?"false":KN(e.Workbook.WBProps.date1904)?"true":"false"}var vP="][*?/\\".split("");function iv(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return vP.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function yP(e,t,n){e.forEach(function(r,i){iv(r);for(var s=0;s<i;++s)if(r==e[s])throw new Error("Duplicate Sheet Name: "+r);if(n){var o=t&&t[i]&&t[i].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function _P(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];yP(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)HR(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}function sv(e){var t=[ft];t[t.length]=ie("workbook",null,{xmlns:as[0],"xmlns:r":xt.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(gP.forEach(function(a){e.Workbook.WBProps[a[0]]!=null&&e.Workbook.WBProps[a[0]]!=a[1]&&(r[a[0]]=e.Workbook.WBProps[a[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=ie("workbookPr",null,r);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:Ve(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=ie("sheet",null,o)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(t[t.length]=ie("definedName",Ve(a.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function TP(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=Pf(e),n.name=Ut(e),n}function EP(e,t){return t||(t=K(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Kc(e.strRelID,t),yt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function SP(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var i=t>8?Ut(e):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function wP(e,t){t||(t=K(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),xx(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function CP(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=xI(e),o=UR(e,0,n),a=Jc(e);e.l=r;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function AP(e,t){j(e,143);for(var n=0;n!=t.SheetNames.length;++n){var r=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,i={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]};j(e,156,EP(i))}j(e,144)}function NP(e,t){t||(t=K(127));for(var n=0;n!=4;++n)t.write_shift(4,0);return yt("SheetJS",t),yt(Xa.version,t),yt(Xa.version,t),yt("7262",t),t.length>t.l?t.slice(0,t.l):t}function IP(e,t){t||(t=K(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var n=120;return t.write_shift(1,n),t.length>t.l?t.slice(0,t.l):t}function kP(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var n=t.Workbook.Sheets,r=0,i=-1,s=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&i==-1?i=r:n[r].Hidden==1&&s==-1&&(s=r);s>i||(j(e,135),j(e,158,IP(i)),j(e,136))}}function RP(e,t){var n=Xt();return j(n,131),j(n,128,NP()),j(n,153,wP(e.Workbook&&e.Workbook.WBProps||null)),kP(n,e),AP(n,e),j(n,132),n.end()}function PP(e,t,n){return(t.slice(-4)===".bin"?RP:sv)(e)}function FP(e,t,n,r,i){return(t.slice(-4)===".bin"?pP:nv)(e,n,r,i)}function MP(e,t,n){return(t.slice(-4)===".bin"?Q4:Gx)(e,n)}function DP(e,t,n){return(t.slice(-4)===".bin"?w4:Ox)(e,n)}function LP(e,t,n){return(t.slice(-4)===".bin"?hk:$x)(e)}function UP(e){return(e.slice(-4)===".bin"?sk:Wx)()}function OP(e,t){var n=[];return e.Props&&n.push(MI(e.Props,t)),e.Custprops&&n.push(DI(e.Props,e.Custprops)),n.join("")}function BP(){return""}function bP(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(r,i){var s=[];s.push(ie("NumberFormat",null,{"ss:Format":Ve(rt[r.numFmtId])}));var o={"ss:ID":"s"+(21+i)};n.push(ie("Style",s.join(""),o))}),ie("Styles",n.join(""))}function ov(e){return ie("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+jc(e.Ref,{r:0,c:0})})}function VP(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var i=t[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||n.push(ov(i)))}return ie("Names",n.join(""))}function GP(e,t,n,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==n&&(a.Name.match(/^_xlfn\./)||s.push(ov(a)))}return s.join("")}function HP(e,t,n,r){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(ie("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(ie("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(ie("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(ie("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<n&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Ct("ProtectContents","True")),e["!protect"].objects&&i.push(Ct("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Ct("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Ct("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Ct("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":ie("WorksheetOptions",i.join(""),{xmlns:nn.x})}function zP(e){return e.map(function(t){var n=JN(t.t||""),r=ie("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return ie("Comment",r,{"ss:Author":t.a})}).join("")}function WP(e,t,n,r,i,s,o){if(!e||e.v==null&&e.f==null)return"";var a={};if(e.f&&(a["ss:Formula"]="="+Ve(jc(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var l=vt(e.F.slice(t.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(e.l&&e.l.Target&&(a["ss:HRef"]=Ve(e.l.Target),e.l.Tooltip&&(a["x:HRefScreenTip"]=Ve(e.l.Tooltip))),n["!merges"])for(var u=n["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(a["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(a["ss:MergeDown"]=u[d].e.r-u[d].s.r));var h="",p="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":h="Number",p=String(e.v);break;case"b":h="Boolean",p=e.v?"1":"0";break;case"e":h="Error",p=ko[e.v];break;case"d":h="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||rt[14]);break;case"s":h="String",p=$N(e.v||"");break}var m=Hr(r.cellXfs,e,r);a["ss:StyleID"]="s"+(21+m),a["ss:Index"]=o.c+1;var y=e.v!=null?p:"",x=e.t=="z"?"":'<Data ss:Type="'+h+'">'+y+"</Data>";return(e.c||[]).length>0&&(x+=zP(e.c)),ie("Cell",x,a)}function qP(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Vx(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function $P(e,t,n,r){if(!e["!ref"])return"";var i=Ke(e["!ref"]),s=e["!merges"]||[],o=0,a=[];e["!cols"]&&e["!cols"].forEach(function(E,T){Xc(E);var _=!!E.width,v=Bl(T,E),C={"ss:Index":T+1};_&&(C["ss:Width"]=ol(v.width)),E.hidden&&(C["ss:Hidden"]="1"),a.push(ie("Column",null,C))});for(var l=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var d=[qP(u,(e["!rows"]||[])[u])],h=i.s.c;h<=i.e.c;++h){var p=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>h)&&!(s[o].s.r>u)&&!(s[o].e.c<h)&&!(s[o].e.r<u)){(s[o].s.c!=h||s[o].s.r!=u)&&(p=!0);break}if(!p){var m={r:u,c:h},y=He(m),x=l?(e[u]||[])[h]:e[y];d.push(WP(x,y,e,t,n,r,m))}}d.push("</Row>"),d.length>2&&a.push(d.join(""))}return a.join("")}function JP(e,t,n){var r=[],i=n.SheetNames[e],s=n.Sheets[i],o=s?GP(s,t,e,n):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=s?$P(s,t,e,n):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(HP(s,t,e,n)),r.join("")}function KP(e,t){t||(t={}),e.SSF||(e.SSF=jt(rt)),e.SSF&&(Ml(),Fl(e.SSF),t.revssf=Dl(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Hr(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(OP(e,t)),n.push(BP()),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(ie("Worksheet",JP(r,t,e),{"ss:Name":Ve(e.SheetNames[r])}));return n[2]=bP(e,t),n[3]=VP(e),ft+ie("Workbook",n.join(""),{xmlns:nn.ss,"xmlns:o":nn.o,"xmlns:x":nn.x,"xmlns:ss":nn.ss,"xmlns:dt":nn.dt,"xmlns:html":nn.html})}var Tu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function YP(e,t){var n=[],r=[],i=[],s=0,o,a=cp(wp,"n"),l=cp(Cp,"n");if(e.Props)for(o=kt(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(a,o[s])?n:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=kt(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(a,o[s])?n:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],e.Custprops[o[s]]]);var u=[];for(s=0;s<i.length;++s)Rx.indexOf(i[s][0])>-1||Nx.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);r.length&&ze.utils.cfb_add(t,"/SummaryInformation",Rp(r,Tu.SI,l,Cp)),(n.length||u.length)&&ze.utils.cfb_add(t,"/DocumentSummaryInformation",Rp(n,Tu.DSI,a,wp,u.length?u:null,Tu.UDI))}function XP(e,t){var n=t||{},r=ze.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return ze.utils.cfb_add(r,i,av(e,n)),n.biff==8&&(e.Props||e.Custprops)&&YP(e,r),n.biff==8&&e.vbaraw&&pk(r,ze.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var QP={0:{f:e3},1:{f:l3},2:{f:I3},3:{f:g3},4:{f:d3},5:{f:w3},6:{f:M3},7:{f:_3},8:{f:V3},9:{f:b3},10:{f:O3},11:{f:B3},12:{f:f3},13:{f:R3},14:{f:v3},15:{f:p3},16:{f:A3},17:{f:L3},18:{f:E3},19:{f:$c},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:CP},40:{},42:{},43:{f:M4},44:{f:P4},45:{f:U4},46:{f:B4},47:{f:O4},48:{},49:{f:fI},50:{},51:{f:ek},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:c4},62:{f:F3},63:{f:ok},64:{f:nP},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:j3},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:o3},148:{f:r3,p:16},151:{f:$3},152:{},153:{f:SP},154:{},155:{},156:{f:TP},157:{},158:{},159:{T:1,f:T4},160:{T:-1},161:{T:1,f:pi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:G3},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:j4},336:{T:-1},337:{f:rk,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:s4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:J3},427:{f:K3},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:X3},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:s3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:W3},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ck},633:{T:1},634:{T:-1},635:{T:1,f:uk},636:{T:-1},637:{f:pI},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:mP},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:rP},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function se(e,t,n,r){var i=t;if(!isNaN(i)){var s=r||(n||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&zc(n)&&e.push(n)}}function jP(e,t,n,r){var i=(n||[]).length||0;if(i<=8224)return se(e,t,n,i);var s=t;if(!isNaN(s)){for(var o=n.parts||[],a=0,l=0,u=0;u+(o[a]||8224)<=8224;)u+=o[a]||8224,a++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,u),e.push(n.slice(l,l+u)),l+=u;l<i;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[a]||8224)<=8224;)u+=o[a]||8224,a++;d.write_shift(2,u),e.push(n.slice(l,l+u)),l+=u}}}function Po(e,t,n){return e||(e=K(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function ZP(e,t,n,r){var i=K(9);return Po(i,e,t),Fx(n,r||"b",i),i}function eF(e,t,n){var r=K(8+2*n.length);return Po(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function tF(e,t,n,r){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Qt(Ht(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?se(e,2,m4(n,r,i)):se(e,3,p4(n,r,i));return;case"b":case"e":se(e,5,ZP(n,r,t.v,t.t));return;case"s":case"str":se(e,4,eF(n,r,(t.v||"").slice(0,255)));return}se(e,1,Po(null,n,r))}function nF(e,t,n,r){var i=Array.isArray(t),s=Ke(t["!ref"]||"A1"),o,a="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=ut(s)}for(var u=s.s.r;u<=s.e.r;++u){a=Nt(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(l[d]=Lt(d)),o=l[d]+a;var h=i?(t[u]||[])[d]:t[o];h&&tF(e,h,u,d)}}}function rF(e,t){for(var n=t||{},r=Xt(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==n.sheet&&(i=s);if(i==0&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return se(r,n.biff==4?1033:n.biff==3?521:9,Yc(e,16,n)),nF(r,e.Sheets[e.SheetNames[i]],i,n),se(r,10),r.end()}function iF(e,t,n){se(e,49,QI({sz:12,name:"Arial"},n))}function sF(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&se(e,1054,e4(i,t[i],n))})}function oF(e,t){var n=K(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),se(e,2151,n),n=K(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),Lx(Ke(t["!ref"]||"A1"),n),n.write_shift(4,4),se(e,2152,n)}function aF(e,t){for(var n=0;n<16;++n)se(e,224,Fp({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){se(e,224,Fp(r,0,t))})}function lF(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];se(e,440,l4(r)),r[1].Tooltip&&se(e,2048,u4(r))}delete t["!links"]}function uF(e,t){if(t){var n=0;t.forEach(function(r,i){++n<=256&&r&&se(e,125,d4(Bl(i,r),i))})}}function fF(e,t,n,r,i){var s=16+Hr(i.cellXfs,t,i);if(t.v==null&&!t.bf){se(e,513,oi(n,r,s));return}if(t.bf)se(e,6,DR(t,n,r,i,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?Qt(Ht(t.v)):t.v;se(e,515,i4(n,r,o,s));break;case"b":case"e":se(e,517,r4(n,r,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var a=e0(i.Strings,t.v,i.revStrings);se(e,253,jI(n,r,a,s))}else se(e,516,ZI(n,r,(t.v||"").slice(0,255),s,i));break;default:se(e,513,oi(n,r,s))}}function cF(e,t,n){var r=Xt(),i=n.SheetNames[e],s=n.Sheets[i]||{},o=(n||{}).Workbook||{},a=(o.Sheets||[])[e]||{},l=Array.isArray(s),u=t.biff==8,d,h="",p=[],m=Ke(s["!ref"]||"A1"),y=u?65536:16384;if(m.e.c>255||m.e.r>=y){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,y-1)}se(r,2057,Yc(n,16,t)),se(r,13,dn(1)),se(r,12,dn(100)),se(r,15,Vt(!0)),se(r,17,Vt(!1)),se(r,16,si(.001)),se(r,95,Vt(!0)),se(r,42,Vt(!1)),se(r,43,Vt(!1)),se(r,130,dn(1)),se(r,128,n4()),se(r,131,Vt(!1)),se(r,132,Vt(!1)),u&&uF(r,s["!cols"]),se(r,512,t4(m,t)),u&&(s["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){h=Nt(x);for(var E=m.s.c;E<=m.e.c;++E){x===m.s.r&&(p[E]=Lt(E)),d=p[E]+h;var T=l?(s[x]||[])[E]:s[d];T&&(fF(r,T,x,E,t),u&&T.l&&s["!links"].push([d,T.l]))}}var _=a.CodeName||a.name||i;return u&&se(r,574,XI((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&se(r,229,a4(s["!merges"])),u&&lF(r,s),se(r,442,Dx(_)),u&&oF(r,s),se(r,10),r.end()}function dF(e,t,n){var r=Xt(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=n.biff==8,l=n.biff==5;if(se(r,2057,Yc(e,5,n)),n.bookType=="xla"&&se(r,135),se(r,225,a?dn(1200):null),se(r,193,OI(2)),l&&se(r,191),l&&se(r,192),se(r,226),se(r,92,$I("SheetJS",n)),se(r,66,dn(a?1200:1252)),a&&se(r,353,dn(0)),a&&se(r,448),se(r,317,h4(e.SheetNames.length)),a&&e.vbaraw&&se(r,211),a&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";se(r,442,Dx(u))}se(r,156,dn(17)),se(r,25,Vt(!1)),se(r,18,Vt(!1)),se(r,19,dn(0)),a&&se(r,431,Vt(!1)),a&&se(r,444,dn(0)),se(r,61,YI()),se(r,64,Vt(!1)),se(r,141,dn(0)),se(r,34,Vt(xP(e)=="true")),se(r,14,Vt(!0)),a&&se(r,439,Vt(!1)),se(r,218,dn(0)),iF(r,e,n),sF(r,e.SSF,n),aF(r,n),a&&se(r,352,Vt(!1));var d=r.end(),h=Xt();a&&se(h,140,f4()),a&&n.Strings&&jP(h,252,KI(n.Strings)),se(h,10);var p=h.end(),m=Xt(),y=0,x=0;for(x=0;x<e.SheetNames.length;++x)y+=(a?12:11)+(a?2:1)*e.SheetNames[x].length;var E=d.length+y+p.length;for(x=0;x<e.SheetNames.length;++x){var T=s[x]||{};se(m,133,JI({pos:E,hs:T.Hidden||0,dt:0,name:e.SheetNames[x]},n)),E+=t[x].length}var _=m.end();if(y!=_.length)throw new Error("BS8 "+y+" != "+_.length);var v=[];return d.length&&v.push(d),_.length&&v.push(_),p.length&&v.push(p),wt(v)}function hF(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=jt(rt)),e&&e.SSF&&(Ml(),Fl(e.SSF),n.revssf=Dl(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,t0(n),n.cellXfs=[],Hr(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)r[r.length]=cF(i,n,e);return r.unshift(dF(e,r,n)),wt(r)}function av(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(!(!r||!r["!ref"])){var i=ln(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return hF(e,t);case 4:case 3:case 2:return rF(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function pF(e,t,n,r){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var a=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>n||i[u].s.c>o)&&!(i[u].e.r<n||i[u].e.c<o)){if(i[u].s.r<n||i[u].s.c<o){a=-1;break}a=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(a<0)){var d=He({r:n,c:o}),h=r.dense?(e[n]||[])[o]:e[d],p=h&&h.v!=null&&(h.h||qN(h.w||(ur(h),h.w)||""))||"",m={};a>1&&(m.rowspan=a),l>1&&(m.colspan=l),r.editable?p='<span contenteditable="true">'+p+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),m.id=(r.id||"sjs")+"-"+d,s.push(ie("td",p,m))}}var y="<tr>";return y+s.join("")+"</tr>"}var mF='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',gF="</body></html>";function xF(e,t,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function lv(e,t){var n=t||{},r=n.header!=null?n.header:mF,i=n.footer!=null?n.footer:gF,s=[r],o=ln(e["!ref"]);n.dense=Array.isArray(e),s.push(xF(e,o,n));for(var a=o.s.r;a<=o.e.r;++a)s.push(pF(e,o,a,n));return s.push("</table>"+i),s.join("")}function uv(e,t,n){var r=n||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var o=typeof r.origin=="string"?vt(r.origin):r.origin;i=o.r,s=o.c}var a=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,a.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var d=ln(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),i==-1&&(u.e.r=i=d.e.r+1)}var h=[],p=0,m=e["!rows"]||(e["!rows"]=[]),y=0,x=0,E=0,T=0,_=0,v=0;for(e["!cols"]||(e["!cols"]=[]);y<a.length&&x<l;++y){var C=a[y];if(bp(C)){if(r.display)continue;m[x]={hidden:!0}}var D=C.children;for(E=T=0;E<D.length;++E){var F=D[E];if(!(r.display&&bp(F))){var I=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):YN(F.innerHTML),L=F.getAttribute("data-z")||F.getAttribute("z");for(p=0;p<h.length;++p){var M=h[p];M.s.c==T+s&&M.s.r<x+i&&x+i<=M.e.r&&(T=M.e.c+1-s,p=-1)}v=+F.getAttribute("colspan")||1,((_=+F.getAttribute("rowspan")||1)>1||v>1)&&h.push({s:{r:x+i,c:T+s},e:{r:x+i+(_||1)-1,c:T+s+(v||1)-1}});var B={t:"s",v:I},J=F.getAttribute("data-t")||F.getAttribute("t")||"";I!=null&&(I.length==0?B.t=J||"z":r.raw||I.trim().length==0||J=="s"||(I==="TRUE"?B={t:"b",v:!0}:I==="FALSE"?B={t:"b",v:!1}:isNaN(tr(I))?isNaN(go(I).getDate())||(B={t:"d",v:Ht(I)},r.cellDates||(B={t:"n",v:Qt(B.v)}),B.z=r.dateNF||rt[14]):B={t:"n",v:tr(I)})),B.z===void 0&&L!=null&&(B.z=L);var H="",Z=F.getElementsByTagName("A");if(Z&&Z.length)for(var Te=0;Te<Z.length&&!(Z[Te].hasAttribute("href")&&(H=Z[Te].getAttribute("href"),H.charAt(0)!="#"));++Te);H&&H.charAt(0)!="#"&&(B.l={Target:H}),r.dense?(e[x+i]||(e[x+i]=[]),e[x+i][T+s]=B):e[He({c:T+s,r:x+i})]=B,u.e.c<T+s&&(u.e.c=T+s),T+=v}}++x}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,x-1+i),e["!ref"]=ut(u),x>=l&&(e["!fullref"]=ut((u.e.r=a.length-y+x-1+i,u))),e}function fv(e,t){var n=t||{},r=n.dense?[]:{};return uv(r,e,t)}function vF(e,t){return fi(fv(e,t),t)}function bp(e){var t="",n=yF(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function yF(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var _F=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+vo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ft+t}}(),Vp=function(){var e=function(s){return Ve(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(s,o,a){var l=[];l.push('      <table:table table:name="'+Ve(o.SheetNames[a])+`" table:style-name="ta1">
`);var u=0,d=0,h=ln(s["!ref"]||"A1"),p=s["!merges"]||[],m=0,y=Array.isArray(s);if(s["!cols"])for(d=0;d<=h.e.c;++d)l.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",E=s["!rows"]||[];for(u=0;u<h.s.r;++u)x=E[u]?' table:style-name="ro'+E[u].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=h.e.r;++u){for(x=E[u]?' table:style-name="ro'+E[u].ods+'"':"",l.push("        <table:table-row"+x+`>
`),d=0;d<h.s.c;++d)l.push(t);for(;d<=h.e.c;++d){var T=!1,_={},v="";for(m=0;m!=p.length;++m)if(!(p[m].s.c>d)&&!(p[m].s.r>u)&&!(p[m].e.c<d)&&!(p[m].e.r<u)){(p[m].s.c!=d||p[m].s.r!=u)&&(T=!0),_["table:number-columns-spanned"]=p[m].e.c-p[m].s.c+1,_["table:number-rows-spanned"]=p[m].e.r-p[m].s.r+1;break}if(T){l.push(n);continue}var C=He({r:u,c:d}),D=y?(s[u]||[])[d]:s[C];if(D&&D.f&&(_["table:formula"]=Ve(VR(D.f)),D.F&&D.F.slice(0,C.length)==C)){var F=ln(D.F);_["table:number-matrix-columns-spanned"]=F.e.c-F.s.c+1,_["table:number-matrix-rows-spanned"]=F.e.r-F.s.r+1}if(!D){l.push(t);continue}switch(D.t){case"b":v=D.v?"TRUE":"FALSE",_["office:value-type"]="boolean",_["office:boolean-value"]=D.v?"true":"false";break;case"n":v=D.w||String(D.v||0),_["office:value-type"]="float",_["office:value"]=D.v||0;break;case"s":case"str":v=D.v==null?"":D.v,_["office:value-type"]="string";break;case"d":v=D.w||Ht(D.v).toISOString(),_["office:value-type"]="date",_["office:date-value"]=Ht(D.v).toISOString(),_["table:style-name"]="ce1";break;default:l.push(t);continue}var I=e(v);if(D.l&&D.l.Target){var L=D.l.Target;L=L.charAt(0)=="#"?"#"+GR(L.slice(1)):L,L.charAt(0)!="#"&&!L.match(/^\w+:/)&&(L="../"+L),I=ie("text:a",I,{"xlink:href":L.replace(/&/g,"&amp;")})}l.push("          "+ie("table:table-cell",ie("text:p",I,{}),_)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var h=u["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Xc(h),h.ods=a;var p=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=l;var h=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,a){var l=[ft],u=vo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=vo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+u+d+`>
`),l.push(Cx().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)l.push(r(o.Sheets[o.SheetNames[h]],o,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function cv(e,t){if(t.bookType=="fods")return Vp(e,t);var n=bc(),r="",i=[],s=[];return r="mimetype",Ie(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",Ie(n,r,Vp(e,t)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",Ie(n,r,_F(e,t)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",Ie(n,r,ft+Cx()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",Ie(n,r,FI(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",Ie(n,r,RI(i)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ul(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function TF(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):kn(xo(e))}function EF(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}function Or(e){var t=e.reduce(function(i,s){return i+s.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(i){n.set(i,r),r+=i.length}),n}function SF(e,t,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=n>=0?0:128}function yo(e,t){var n=t?t[0]:0,r=e[n]&127;e:if(e[n++]>=128&&(r|=(e[n]&127)<<7,e[n++]<128||(r|=(e[n]&127)<<14,e[n++]<128)||(r|=(e[n]&127)<<21,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),r}function Be(e){var t=new Uint8Array(7);t[0]=e&127;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383||(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)||(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)||(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)||(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103))break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function $i(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function ct(e){for(var t=[],n=[0];n[0]<e.length;){var r=n[0],i=yo(e,n),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=n[0];e[n[0]++]>=128;);a=e.slice(l,n[0])}break;case 5:o=4,a=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,a=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=yo(e,n),a=e.slice(n[0],n[0]+o),n[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var u={data:a,type:s};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function Tt(e){var t=[];return e.forEach(function(n,r){n.forEach(function(i){i.data&&(t.push(Be(r*8+i.type)),i.type==2&&t.push(Be(i.data.length)),t.push(i.data))})}),Or(t)}function wn(e){for(var t,n=[],r=[0];r[0]<e.length;){var i=yo(e,r),s=ct(e.slice(r[0],r[0]+i));r[0]+=i;var o={id:$i(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=ct(a.data),u=$i(l[3][0].data);o.messages.push({meta:l,data:e.slice(r[0],r[0]+u)}),r[0]+=u}),(t=s[3])!=null&&t[0]&&(o.merge=$i(s[3][0].data)>>>0>0),n.push(o)}return n}function xi(e){var t=[];return e.forEach(function(n){var r=[];r[1]=[{data:Be(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:Be(+!!n.merge),type:0}]);var i=[];n.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Be(o.data.length)}],r[2].push({data:Tt(o.meta),type:2})});var s=Tt(r);t.push(Be(s.length)),t.push(s),i.forEach(function(o){return t.push(o)})}),Or(t)}function wF(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=yo(t,n),i=[];n[0]<t.length;){var s=t[n[0]]&3;if(s==0){var o=t[n[0]++]>>2;if(o<60)++o;else{var a=o-59;o=t[n[0]],a>1&&(o|=t[n[0]+1]<<8),a>2&&(o|=t[n[0]+2]<<16),a>3&&(o|=t[n[0]+3]<<24),o>>>=0,o++,n[0]+=a}i.push(t.slice(n[0],n[0]+o)),n[0]+=o;continue}else{var l=0,u=0;if(s==1?(u=(t[n[0]]>>2&7)+4,l=(t[n[0]++]&224)<<3,l|=t[n[0]++]):(u=(t[n[0]++]>>2)+1,s==2?(l=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(l=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),i=[Or(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var d=Or(i);if(d.length!=r)throw new Error("Unexpected length: ".concat(d.length," != ").concat(r));return d}function Cn(e){for(var t=[],n=0;n<e.length;){var r=e[n++],i=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(wF(r,e.slice(n,n+i))),n+=i}if(n!==e.length)throw new Error("data is not a valid framed stream!");return Or(t)}function vi(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),i=new Uint8Array(4);t.push(i);var s=Be(r),o=s.length;t.push(s),r<=60?(o++,t.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),o+=r,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,n+=r}return Or(t)}function Eu(e,t){var n=new Uint8Array(32),r=ul(n),i=12,s=0;switch(n[0]=5,e.t){case"n":n[1]=2,SF(n,i,e.v),s|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,s,!0),n.slice(0,i)}function Su(e,t){var n=new Uint8Array(32),r=ul(n),i=12,s=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,s,!0),n.slice(0,i)}function gr(e){var t=ct(e);return yo(t[1][0].data)}function CF(e,t,n){var r,i,s,o;if(!((r=e[6])!=null&&r[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&$i(e[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,u=ul(e[7][0].data),d=0,h=[],p=ul(e[4][0].data),m=0,y=[],x=0;x<t.length;++x){if(t[x]==null){u.setUint16(x*2,65535,!0),p.setUint16(x*2,65535);continue}u.setUint16(x*2,d,!0),p.setUint16(x*2,m,!0);var E,T;switch(typeof t[x]){case"string":E=Eu({t:"s",v:t[x]},n),T=Su({t:"s",v:t[x]},n);break;case"number":E=Eu({t:"n",v:t[x]},n),T=Su({t:"n",v:t[x]},n);break;case"boolean":E=Eu({t:"b",v:t[x]},n),T=Su({t:"b",v:t[x]},n);break;default:throw new Error("Unsupported value "+t[x])}h.push(E),d+=E.length,y.push(T),m+=T.length,++l}for(e[2][0].data=Be(l);x<e[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),p.setUint16(x*2,65535,!0);return e[6][0].data=Or(h),e[3][0].data=Or(y),l}function AF(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=ln(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ut(r)));var s=fl(n,{range:r,header:1}),o=["~Sh33tJ5~"];s.forEach(function(W){return W.forEach(function(O){typeof O=="string"&&o.push(O)})});var a={},l=[],u=ze.read(t.numbers,{type:"base64"});u.FileIndex.map(function(W,O){return[W,u.FullPaths[O]]}).forEach(function(W){var O=W[0],U=W[1];if(O.type==2&&O.name.match(/\.iwa/)){var Q=O.content,he=Cn(Q),xe=wn(he);xe.forEach(function(me){l.push(me.id),a[me.id]={deps:[],location:U,type:$i(me.messages[0].meta[1][0].data)}})}}),l.sort(function(W,O){return W-O});var d=l.filter(function(W){return W>1}).map(function(W){return[W,Be(W)]});u.FileIndex.map(function(W,O){return[W,u.FullPaths[O]]}).forEach(function(W){var O=W[0];if(W[1],!!O.name.match(/\.iwa/)){var U=wn(Cn(O.content));U.forEach(function(Q){Q.messages.forEach(function(he){d.forEach(function(xe){Q.messages.some(function(me){return $i(me.meta[1][0].data)!=11006&&EF(me.data,xe[1])})&&a[xe[0]].deps.push(Q.id)})})})}});for(var h=ze.find(u,a[1].location),p=wn(Cn(h.content)),m,y=0;y<p.length;++y){var x=p[y];x.id==1&&(m=x)}var E=gr(ct(m.messages[0].data)[1][0].data);for(h=ze.find(u,a[E].location),p=wn(Cn(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(m=x);for(E=gr(ct(m.messages[0].data)[2][0].data),h=ze.find(u,a[E].location),p=wn(Cn(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(m=x);for(E=gr(ct(m.messages[0].data)[2][0].data),h=ze.find(u,a[E].location),p=wn(Cn(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(m=x);var T=ct(m.messages[0].data);{T[6][0].data=Be(r.e.r+1),T[7][0].data=Be(r.e.c+1);var _=gr(T[46][0].data),v=ze.find(u,a[_].location),C=wn(Cn(v.content));{for(var D=0;D<C.length&&C[D].id!=_;++D);if(C[D].id!=_)throw"Bad ColumnRowUIDMapArchive";var F=ct(C[D].messages[0].data);F[1]=[],F[2]=[],F[3]=[];for(var I=0;I<=r.e.c;++I){var L=[];L[1]=L[2]=[{type:0,data:Be(I+420690)}],F[1].push({type:2,data:Tt(L)}),F[2].push({type:0,data:Be(I)}),F[3].push({type:0,data:Be(I)})}F[4]=[],F[5]=[],F[6]=[];for(var M=0;M<=r.e.r;++M)L=[],L[1]=L[2]=[{type:0,data:Be(M+726270)}],F[4].push({type:2,data:Tt(L)}),F[5].push({type:0,data:Be(M)}),F[6].push({type:0,data:Be(M)});C[D].messages[0].data=Tt(F)}v.content=vi(xi(C)),v.size=v.content.length,delete T[46];var B=ct(T[4][0].data);{B[7][0].data=Be(r.e.r+1);var J=ct(B[1][0].data),H=gr(J[2][0].data);v=ze.find(u,a[H].location),C=wn(Cn(v.content));{if(C[0].id!=H)throw"Bad HeaderStorageBucket";var Z=ct(C[0].messages[0].data);for(M=0;M<s.length;++M){var Te=ct(Z[2][0].data);Te[1][0].data=Be(M),Te[4][0].data=Be(s[M].length),Z[2][M]={type:Z[2][0].type,data:Tt(Te)}}C[0].messages[0].data=Tt(Z)}v.content=vi(xi(C)),v.size=v.content.length;var ye=gr(B[2][0].data);v=ze.find(u,a[ye].location),C=wn(Cn(v.content));{if(C[0].id!=ye)throw"Bad HeaderStorageBucket";for(Z=ct(C[0].messages[0].data),I=0;I<=r.e.c;++I)Te=ct(Z[2][0].data),Te[1][0].data=Be(I),Te[4][0].data=Be(r.e.r+1),Z[2][I]={type:Z[2][0].type,data:Tt(Te)};C[0].messages[0].data=Tt(Z)}v.content=vi(xi(C)),v.size=v.content.length;var Ee=gr(B[4][0].data);(function(){for(var W=ze.find(u,a[Ee].location),O=wn(Cn(W.content)),U,Q=0;Q<O.length;++Q){var he=O[Q];he.id==Ee&&(U=he)}var xe=ct(U.messages[0].data);{xe[3]=[];var me=[];o.forEach(function(Pe,pt){me[1]=[{type:0,data:Be(pt)}],me[2]=[{type:0,data:Be(1)}],me[3]=[{type:2,data:TF(Pe)}],xe[3].push({type:2,data:Tt(me)})})}U.messages[0].data=Tt(xe);var le=xi(O),Oe=vi(le);W.content=Oe,W.size=W.content.length})();var Me=ct(B[3][0].data);{var oe=Me[1][0];delete Me[2];var ge=ct(oe.data);{var _e=gr(ge[2][0].data);(function(){for(var W=ze.find(u,a[_e].location),O=wn(Cn(W.content)),U,Q=0;Q<O.length;++Q){var he=O[Q];he.id==_e&&(U=he)}var xe=ct(U.messages[0].data);{delete xe[6],delete Me[7];var me=new Uint8Array(xe[5][0].data);xe[5]=[];for(var le=0,Oe=0;Oe<=r.e.r;++Oe){var Pe=ct(me);le+=CF(Pe,s[Oe],o),Pe[1][0].data=Be(Oe),xe[5].push({data:Tt(Pe),type:2})}xe[1]=[{type:0,data:Be(r.e.c+1)}],xe[2]=[{type:0,data:Be(r.e.r+1)}],xe[3]=[{type:0,data:Be(le)}],xe[4]=[{type:0,data:Be(r.e.r+1)}]}U.messages[0].data=Tt(xe);var pt=xi(O),b=vi(pt);W.content=b,W.size=W.content.length})()}oe.data=Tt(ge)}B[3][0].data=Tt(Me)}T[4][0].data=Tt(B)}m.messages[0].data=Tt(T);var ke=xi(p),P=vi(ke);return h.content=P,h.size=h.content.length,u}function NF(e){return function(n){for(var r=0;r!=e.length;++r){var i=e[r];n[i[0]]===void 0&&(n[i[0]]=i[1]),i[2]==="n"&&(n[i[0]]=Number(n[i[0]]))}}}function t0(e){NF([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function IF(e,t){return t.bookType=="ods"?cv(e,t):t.bookType=="numbers"?AF(e,t):t.bookType=="xlsb"?kF(e,t):RF(e,t)}function kF(e,t){Mi=1024,e&&!e.SSF&&(e.SSF=jt(rt)),e&&e.SSF&&(Ml(),Fl(e.SSF),t.revssf=Dl(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ys?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n=t.bookType=="xlsb"?"bin":"xml",r=Jx.indexOf(t.bookType)>-1,i=Ex();t0(t=t||{});var s=bc(),o="",a=0;if(t.cellXfs=[],Hr(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ie(s,o,Ax(e.Props,t)),i.coreprops.push(o),be(t.rels,2,o,De.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Ie(s,o,Ix(e.Props)),i.extprops.push(o),be(t.rels,3,o,De.EXT_PROPS),e.Custprops!==e.Props&&kt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ie(s,o,kx(e.Custprops)),i.custprops.push(o),be(t.rels,4,o,De.CUST_PROPS)),a=1;a<=e.SheetNames.length;++a){var d={"!id":{}},h=e.Sheets[e.SheetNames[a-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+a+"."+n,Ie(s,o,FP(a-1,o,t,e,d)),i.sheets.push(o),be(t.wbrels,-1,"worksheets/sheet"+a+"."+n,De.WS[0])}if(h){var m=h["!comments"],y=!1,x="";m&&m.length>0&&(x="xl/comments"+a+"."+n,Ie(s,x,LP(m,x)),i.comments.push(x),be(d,-1,"../comments"+a+"."+n,De.CMNT),y=!0),h["!legacy"]&&y&&Ie(s,"xl/drawings/vmlDrawing"+a+".vml",qx(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Ie(s,wx(o),Wi(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,Ie(s,o,DP(t.Strings,o,t)),i.strs.push(o),be(t.wbrels,-1,"sharedStrings."+n,De.SST)),o="xl/workbook."+n,Ie(s,o,PP(e,o)),i.workbooks.push(o),be(t.rels,1,o,De.WB),o="xl/theme/theme1.xml",Ie(s,o,zx(e.Themes,t)),i.themes.push(o),be(t.wbrels,-1,"theme/theme1.xml",De.THEME),o="xl/styles."+n,Ie(s,o,MP(e,o,t)),i.styles.push(o),be(t.wbrels,-1,"styles."+n,De.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",Ie(s,o,e.vbaraw),i.vba.push(o),be(t.wbrels,-1,"vbaProject.bin",De.VBA)),o="xl/metadata."+n,Ie(s,o,UP(o)),i.metadata.push(o),be(t.wbrels,-1,"metadata."+n,De.XLMETA),Ie(s,"[Content_Types].xml",Sx(i,t)),Ie(s,"_rels/.rels",Wi(t.rels)),Ie(s,"xl/_rels/workbook."+n+".rels",Wi(t.wbrels)),delete t.revssf,delete t.ssf,s}function RF(e,t){Mi=1024,e&&!e.SSF&&(e.SSF=jt(rt)),e&&e.SSF&&(Ml(),Fl(e.SSF),t.revssf=Dl(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ys?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=Jx.indexOf(t.bookType)>-1,i=Ex();t0(t=t||{});var s=bc(),o="",a=0;if(t.cellXfs=[],Hr(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ie(s,o,Ax(e.Props,t)),i.coreprops.push(o),be(t.rels,2,o,De.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Ie(s,o,Ix(e.Props)),i.extprops.push(o),be(t.rels,3,o,De.EXT_PROPS),e.Custprops!==e.Props&&kt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ie(s,o,kx(e.Custprops)),i.custprops.push(o),be(t.rels,4,o,De.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,a=1;a<=e.SheetNames.length;++a){var h={"!id":{}},p=e.Sheets[e.SheetNames[a-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+a+"."+n,Ie(s,o,nv(a-1,t,e,h)),i.sheets.push(o),be(t.wbrels,-1,"worksheets/sheet"+a+"."+n,De.WS[0])}if(p){var y=p["!comments"],x=!1,E="";if(y&&y.length>0){var T=!1;y.forEach(function(_){_[1].forEach(function(v){v.T==!0&&(T=!0)})}),T&&(E="xl/threadedComments/threadedComment"+a+"."+n,Ie(s,E,ak(y,d,t)),i.threadedcomments.push(E),be(h,-1,"../threadedComments/threadedComment"+a+"."+n,De.TCMNT)),E="xl/comments"+a+"."+n,Ie(s,E,$x(y)),i.comments.push(E),be(h,-1,"../comments"+a+"."+n,De.CMNT),x=!0}p["!legacy"]&&x&&Ie(s,"xl/drawings/vmlDrawing"+a+".vml",qx(a,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&Ie(s,wx(o),Wi(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,Ie(s,o,Ox(t.Strings,t)),i.strs.push(o),be(t.wbrels,-1,"sharedStrings."+n,De.SST)),o="xl/workbook."+n,Ie(s,o,sv(e)),i.workbooks.push(o),be(t.rels,1,o,De.WB),o="xl/theme/theme1.xml",Ie(s,o,zx(e.Themes,t)),i.themes.push(o),be(t.wbrels,-1,"theme/theme1.xml",De.THEME),o="xl/styles."+n,Ie(s,o,Gx(e,t)),i.styles.push(o),be(t.wbrels,-1,"styles."+n,De.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",Ie(s,o,e.vbaraw),i.vba.push(o),be(t.wbrels,-1,"vbaProject.bin",De.VBA)),o="xl/metadata."+n,Ie(s,o,Wx()),i.metadata.push(o),be(t.wbrels,-1,"metadata."+n,De.XLMETA),d.length>1&&(o="xl/persons/person.xml",Ie(s,o,lk(d)),i.people.push(o),be(t.wbrels,-1,"persons/person.xml",De.PEOPLE)),Ie(s,"[Content_Types].xml",Sx(i,t)),Ie(s,"_rels/.rels",Wi(t.rels)),Ie(s,"xl/_rels/workbook."+n+".rels",Wi(t.wbrels)),delete t.revssf,delete t.ssf,s}function PF(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=lr(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function dv(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return No(t.file,ze.write(e,{type:Ue?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return ze.write(e,t)}function FF(e,t){var n=jt(t||{}),r=IF(e,n);return MF(r,n)}function MF(e,t){var n={},r=Ue?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?ze.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Pl(i))}return t.password&&typeof encrypt_agile<"u"?dv(encrypt_agile(i,t.password),t):t.type==="file"?No(t.file,i):t.type=="string"?qs(i):i}function DF(e,t){var n=t||{},r=XP(e,n);return dv(r,n)}function bn(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return mo(xo(r));case"binary":return xo(r);case"string":return e;case"file":return No(t.file,r,"utf8");case"buffer":return Ue?hr(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):bn(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function LF(e,t){switch(t.type){case"base64":return mo(e);case"binary":return e;case"string":return e;case"file":return No(t.file,e,"binary");case"buffer":return Ue?hr(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function sa(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return t.type=="base64"?mo(n):t.type=="string"?qs(n):n;case"file":return No(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function hv(e,t){uN(),_P(e);var n=jt(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=hv(e,n);return n.type="array",Pl(r)}var i=0;if(n.sheet&&(typeof n.sheet=="number"?i=n.sheet:i=e.SheetNames.indexOf(n.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return bn(KP(e,n),n);case"slk":case"sylk":return bn(x4.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"htm":case"html":return bn(lv(e.Sheets[e.SheetNames[i]],n),n);case"txt":return LF(pv(e.Sheets[e.SheetNames[i]],n),n);case"csv":return bn(n0(e.Sheets[e.SheetNames[i]],n),n,"\uFEFF");case"dif":return bn(v4.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"dbf":return sa(g4.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"prn":return bn(y4.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"rtf":return bn(A4.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"eth":return bn(Ux.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"fods":return bn(cv(e,n),n);case"wk1":return sa(Mp.sheet_to_wk1(e.Sheets[e.SheetNames[i]],n),n);case"wk3":return sa(Mp.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),sa(av(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),DF(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return FF(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function UF(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(e.bookType=n.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function OF(e,t,n){var r={};return r.type="file",r.file=t,UF(r),hv(e,r)}function BF(e,t,n,r,i,s,o,a){var l=Nt(n),u=a.defval,d=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),h=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:n,enumerable:!1})}catch{p.__rowNum__=n}else p.__rowNum__=n;if(!o||e[n])for(var m=t.s.c;m<=t.e.c;++m){var y=o?e[n][m]:e[r[m]+l];if(y===void 0||y.t===void 0){if(u===void 0)continue;s[m]!=null&&(p[s[m]]=u);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[m]!=null){if(x==null)if(y.t=="e"&&x===null)p[s[m]]=null;else if(u!==void 0)p[s[m]]=u;else if(d&&x===null)p[s[m]]=null;else continue;else p[s[m]]=d&&(y.t!=="n"||y.t==="n"&&a.rawNumbers!==!1)?x:ur(y,x,a);x!=null&&(h=!1)}}return{row:p,isempty:h}}function fl(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},r=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?r=1:u.header==="A"?r=2:Array.isArray(u.header)?r=3:u.header==null&&(r=0),typeof d){case"string":l=Ke(d);break;case"number":l=Ke(e["!ref"]),l.s.r=d;break;default:l=d}r>0&&(i=0);var h=Nt(l.s.r),p=[],m=[],y=0,x=0,E=Array.isArray(e),T=l.s.r,_=0,v={};E&&!e[T]&&(e[T]=[]);var C=u.skipHidden&&e["!cols"]||[],D=u.skipHidden&&e["!rows"]||[];for(_=l.s.c;_<=l.e.c;++_)if(!(C[_]||{}).hidden)switch(p[_]=Lt(_),n=E?e[T][_]:e[p[_]+h],r){case 1:s[_]=_-l.s.c;break;case 2:s[_]=p[_];break;case 3:s[_]=u.header[_-l.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),a=o=ur(n,null,u),x=v[o]||0,!x)v[o]=1;else{do a=o+"_"+x++;while(v[a]);v[o]=x,v[a]=1}s[_]=a}for(T=l.s.r+i;T<=l.e.r;++T)if(!(D[T]||{}).hidden){var F=BF(e,l,T,p,r,s,E,u);(F.isempty===!1||(r===1?u.blankrows!==!1:u.blankrows))&&(m[y++]=F.row)}return m.length=y,m}var Gp=/"/g;function bF(e,t,n,r,i,s,o,a){for(var l=!0,u=[],d="",h=Nt(n),p=t.s.c;p<=t.e.c;++p)if(r[p]){var m=a.dense?(e[n]||[])[p]:e[r[p]+h];if(m==null)d="";else if(m.v!=null){l=!1,d=""+(a.rawNumbers&&m.t=="n"?m.v:ur(m,null,a));for(var y=0,x=0;y!==d.length;++y)if((x=d.charCodeAt(y))===i||x===s||x===34||a.forceQuotes){d='"'+d.replace(Gp,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(l=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(Gp,'""')+'"')):d="";u.push(d)}return a.blankrows===!1&&l?null:u.join(o)}function n0(e,t){var n=[],r=t??{};if(e==null||e["!ref"]==null)return"";var i=Ke(e["!ref"]),s=r.FS!==void 0?r.FS:",",o=s.charCodeAt(0),a=r.RS!==void 0?r.RS:`
`,l=a.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",h=[];r.dense=Array.isArray(e);for(var p=r.skipHidden&&e["!cols"]||[],m=r.skipHidden&&e["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(p[y]||{}).hidden||(h[y]=Lt(y));for(var x=0,E=i.s.r;E<=i.e.r;++E)(m[E]||{}).hidden||(d=bF(e,i,E,h,o,l,s,r),d!=null&&(r.strip&&(d=d.replace(u,"")),(d||r.blankrows!==!1)&&n.push((x++?a:"")+d)));return delete r.dense,n.join("")}function pv(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=n0(e,t);return n}function VF(e){var t="",n,r="";if(e==null||e["!ref"]==null)return[];var i=Ke(e["!ref"]),s="",o=[],a,l=[],u=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)o[a]=Lt(a);for(var d=i.s.r;d<=i.e.r;++d)for(s=Nt(d),a=i.s.c;a<=i.e.c;++a)if(t=o[a]+s,n=u?(e[d]||[])[a]:e[t],r="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;r=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}l[l.length]=t+"="+r}return l}function mv(e,t,n){var r=n||{},i=+!r.skipHeader,s=e||{},o=0,a=0;if(s&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?vt(r.origin):r.origin;o=l.r,a=l.c}var u,d={s:{c:0,r:0},e:{c:a,r:o+t.length-1+i}};if(s["!ref"]){var h=Ke(s["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),o==-1&&(o=h.e.r+1,d.e.r=o+t.length-1+i)}else o==-1&&(o=0,d.e.r=t.length-1+i);var p=r.header||[],m=0;t.forEach(function(x,E){kt(x).forEach(function(T){(m=p.indexOf(T))==-1&&(p[m=p.length]=T);var _=x[T],v="z",C="",D=He({c:a+m,r:o+E+i});u=_o(s,D),_&&typeof _=="object"&&!(_ instanceof Date)?s[D]=_:(typeof _=="number"?v="n":typeof _=="boolean"?v="b":typeof _=="string"?v="s":_ instanceof Date?(v="d",r.cellDates||(v="n",_=Qt(_)),C=r.dateNF||rt[14]):_===null&&r.nullError&&(v="e",_=0),u?(u.t=v,u.v=_,delete u.w,delete u.R,C&&(u.z=C)):s[D]=u={t:v,v:_},C&&(u.z=C))})}),d.e.c=Math.max(d.e.c,a+p.length-1);var y=Nt(o);if(i)for(m=0;m<p.length;++m)s[Lt(m+a)+y]={t:"s",v:p[m]};return s["!ref"]=ut(d),s}function GF(e,t){return mv(null,e,t)}function _o(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var r=vt(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?_o(e,He(t)):_o(e,He({r:t,c:n||0}))}function HF(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function zF(){return{SheetNames:[],Sheets:{}}}function WF(e,t,n,r){var i=1;if(!n)for(;i<=65535&&e.SheetNames.indexOf(n="Sheet"+i)!=-1;++i,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||n;for(++i;i<=65535&&e.SheetNames.indexOf(n=o+i)!=-1;++i);}if(iv(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function qF(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=HF(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n}function $F(e,t){return e.z=t,e}function gv(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function JF(e,t,n){return gv(e,"#"+t,n)}function KF(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function YF(e,t,n,r){for(var i=typeof t!="string"?t:Ke(t),s=typeof t=="string"?t:ut(t),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=_o(e,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=n,r&&(l.D=!0))}return e}var Kn={encode_col:Lt,encode_row:Nt,encode_cell:He,encode_range:ut,decode_col:qc,decode_row:Wc,split_cell:uI,decode_cell:vt,decode_range:ln,format_cell:ur,sheet_add_aoa:gx,sheet_add_json:mv,sheet_add_dom:uv,aoa_to_sheet:ls,json_to_sheet:GF,table_to_sheet:fv,table_to_book:vF,sheet_to_csv:n0,sheet_to_txt:pv,sheet_to_json:fl,sheet_to_html:lv,sheet_to_formulae:VF,sheet_to_row_object_array:fl,sheet_get_cell:_o,book_new:zF,book_append_sheet:WF,book_set_sheet_visibility:qF,cell_set_number_format:$F,cell_set_hyperlink:gv,cell_set_internal_link:JF,cell_add_comment:KF,sheet_set_array_formula:YF,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const XF={en:{builder:"Builder",aiWizard:"Nuts AI",savePlay:"Save & Play",exit:"Exit",save:"Save",open:"Open",export:"Export Project",exportXLSX:"Export XLSX",import:"Import Project",general:"General",features:"Features",entities:"Entities",matrix:"Matrix Scoring",projectName:"Project Name",description:"Description",definedFeatures:"Defined Features",definedFeaturesDesc:"Define traits and their possible states.",addFeature:"Add Feature",featureName:"Feature Name",imageURL:"Image URL (optional)",states:"States",addState:"Add State",manageEntities:"Entities",manageEntitiesDesc:"Manage the taxa included in your key.",addEntity:"Add Entity",scoringMatrix:"Scoring Matrix",scoringMatrixDesc:"Click cells to toggle state association",taxaFeatures:"Taxa / Features",aiTitle:"Nuts AI Wizard",aiDesc:"Generate or Extract keys using Gemini AI.",topic:"Key Topic / Subject",topicPlace:"e.g. Freshwater Fishes, Garden Weeds",geography:"Geography / Biome",taxonomy:"Taxonomy Filter",numEntities:"Approx. # of Entities",numFeatures:"Approx. # of Features",generating:"Nozes IA is thinking... (15-45s)",cancel:"Cancel",generate:"Generate Key",savedMsg:"Project saved to browser storage!",errGen:"Failed to generate key. Check console.",featureFocus:"Feature Focus",focusGeneral:"General (All)",focusRepro:"Reproductive Only",focusVeg:"Vegetative Only",options:"Options",fetchSpeciesImg:"Fetch Species Images",fetchFeatureImg:"Fetch Feature Images",fetchLinks:"Fetch External Links",detailLevel:"Detail Level",detailSimple:"Simplified",detailBalanced:"Balanced",detailExpert:"Expert / High",detailOriginal:"Original Fidelity",noSaved:"No saved projects.",close:"Close",modeTopic:"Generate from Topic",modeImport:"Import from File",uploadLabel:"Upload PDF, Image, or Text",uploadDesc:"The AI will study the document and extract entities and features automatically.",supportedFormats:"Supports: .pdf, .txt, .jpg, .png",dropFile:"Drop file here",removeFile:"Remove file",analyzing:"Analyzing document...",promptCopied:"Prompt copied to clipboard!",configSettings:"Configuration",links:"Additional Links / Resources",addLink:"Add Link",editTraits:"Edit Characteristics",traitEditor:"Trait Editor",copyPrompt:"Copy",missingKey:"Missing API Key. Please configure it in the main menu Settings."},pt:{builder:"Construtor",aiWizard:"Nozes IA",savePlay:"Salvar & Testar",exit:"Sair",save:"Salvar",open:"Abrir",export:"Exportar Projeto",exportXLSX:"Exportar XLSX",import:"Importar Projeto",general:"Geral",features:"Caractersticas",entities:"Entidades",matrix:"Matriz",projectName:"Nome do Projeto",description:"Descrio",definedFeatures:"Caractersticas Definidas",definedFeaturesDesc:"Defina caractersticas e seus estados possveis.",addFeature:"Adicionar Caracterstica",featureName:"Nome",imageURL:"URL da Imagem (opcional)",states:"Estados",addState:"Adicionar Estado",manageEntities:"Entidades",manageEntitiesDesc:"Gerencie os txons includos na chave.",addEntity:"Adicionar Entidade",scoringMatrix:"Matriz de Pontuao",scoringMatrixDesc:"Clique nas clulas para associar estados",taxaFeatures:"Txons / Caractersticas",aiTitle:"Assistente Nozes IA",aiDesc:"Gere ou Extraia chaves usando Gemini IA.",topic:"Tpico / Assunto",topicPlace:"ex: Peixes de gua Doce, Ervas Daninhas",geography:"Geografia / Bioma",taxonomy:"Filtro Taxonmico",numEntities:"Aprox. # de Entidades",numFeatures:"Aprox. # de Caractersticas",generating:"Nozes IA est pensando... (15-45s)",cancel:"Cancelar",generate:"Gerar Chave",savedMsg:"Projeto salvo no navegador!",errGen:"Falha ao gerar chave. Verifique o console.",featureFocus:"Foco das Caractersticas",focusGeneral:"Geral (Todas)",focusRepro:"Apenas Reprodutivas",focusVeg:"Apenas Vegetativas",options:"Opes",fetchSpeciesImg:"Buscar Imagens de Espcies",fetchFeatureImg:"Buscar Imagens de Caractersticas",fetchLinks:"Buscar Links/Materiais",detailLevel:"Nvel de Detalhe",detailSimple:"Simplificado",detailBalanced:"Equilibrado",detailExpert:"Especialista / Alto",detailOriginal:"Fidelidade Original",noSaved:"Nenhum projeto salvo.",close:"Fechar",modeTopic:"Gerar por Tpico",modeImport:"Importar Arquivo",uploadLabel:"Upload PDF, Imagem ou Texto",uploadDesc:"A IA estudar o documento e extrair entidades e caractersticas automaticamente.",supportedFormats:"Suporta: .pdf, .txt, .jpg, .png",dropFile:"Solte o arquivo aqui",removeFile:"Remover arquivo",analyzing:"Analisando documento...",promptCopied:"Prompt copiado para a rea de transferncia!",configSettings:"Configurao",links:"Links Adicionais / Materiais",addLink:"Adicionar Link",editTraits:"Editar Caractersticas",traitEditor:"Editor de Caractersticas",copyPrompt:"Copiar",missingKey:"Falta a Chave da API. Configure-a nas Configuraes do menu principal."}},QF=({initialProject:e,onSave:t,onCancel:n,language:r,defaultModel:i,apiKey:s})=>{var pt;const o=XF[r],[a,l]=Ne.useState(e||{id:Math.random().toString(36).substr(2,9),name:r==="pt"?"Nova Chave":"New Key",description:"",features:[],entities:[]}),[u,d]=Ne.useState("GENERAL"),[h,p]=Ne.useState({topic:"",count:10,featureCount:5,geography:"",taxonomy:"",language:r,featureFocus:"general",includeSpeciesImages:!0,includeFeatureImages:!0,includeLinks:!0,model:i,detailLevel:2}),[m,y]=Ne.useState(!1),[x,E]=Ne.useState(!1),[T,_]=Ne.useState("TOPIC"),[v,C]=Ne.useState(null),[D,F]=Ne.useState([]),[I,L]=Ne.useState(!1),[M,B]=Ne.useState(!1),[J,H]=Ne.useState(!1),[Z,Te]=Ne.useState(""),[ye,Ee]=Ne.useState(null);Ne.useEffect(()=>{p(b=>({...b,language:r}))},[r]),Ne.useEffect(()=>{p(b=>({...b,model:i}))},[i]),Ne.useEffect(()=>{const b=localStorage.getItem("lucidgen_projects");if(b)try{F(JSON.parse(b))}catch{console.error("Failed to load local projects")}},[]);const Me=b=>l(ee=>({...ee,...b})),oe=()=>{const b=[a,...D.filter(ee=>ee.id!==a.id)];F(b),localStorage.setItem("lucidgen_projects",JSON.stringify(b)),alert(o.savedMsg)},ge=b=>{l(b),L(!1)},_e=()=>{const b="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a)),ee=document.createElement("a");ee.setAttribute("href",b),ee.setAttribute("download",`${a.name.replace(/\s+/g,"_")}.json`),document.body.appendChild(ee),ee.click(),ee.remove()},ke=()=>{const b=Kn.book_new(),ee=a.entities.map(ot=>{var mt,Tn;return{ID:ot.id,Name:ot.name,Description:ot.description,ImageURL:ot.imageUrl,LinkLabels:((mt=ot.links)==null?void 0:mt.map($n=>$n.label).join("; "))||"",LinkURLs:((Tn=ot.links)==null?void 0:Tn.map($n=>$n.url).join("; "))||""}}),ue=Kn.json_to_sheet(ee);Kn.book_append_sheet(b,ue,"Entities");const X=a.features.map(ot=>({ID:ot.id,Name:ot.name,ImageURL:ot.imageUrl,States:ot.states.map(mt=>mt.label).join("; ")})),ve=Kn.json_to_sheet(X);Kn.book_append_sheet(b,ve,"Features");const Se=a.entities.map(ot=>{const mt={Entity:ot.name};return a.features.forEach(Tn=>{const $n=ot.traits[Tn.id]||[],cs=Tn.states.filter(En=>$n.includes(En.id)).map(En=>En.label).join(", ");mt[Tn.name]=cs}),mt}),it=Kn.json_to_sheet(Se);Kn.book_append_sheet(b,it,"Matrix");const Un=[{Name:a.name,Description:a.description,ExportDate:new Date().toISOString().split("T")[0],TotalEntities:a.entities.length,TotalFeatures:a.features.length}],pr=Kn.json_to_sheet(Un);Kn.book_append_sheet(b,pr,"Project Info"),OF(b,`${a.name.replace(/\s+/g,"_")}.xlsx`)},P=b=>{const ee=new FileReader;b.target.files&&b.target.files[0]&&(ee.readAsText(b.target.files[0],"UTF-8"),ee.onload=ue=>{var X;try{const ve=JSON.parse((X=ue.target)==null?void 0:X.result);ve.name&&ve.features&&ve.entities?l(ve):alert("Invalid project file format.")}catch{alert("Error parsing JSON file.")}})},W=b=>{b.target.files&&b.target.files[0]&&C(b.target.files[0])},O=b=>new Promise((ee,ue)=>{const X=new FileReader;X.onload=()=>{const Se=X.result.split(",")[1];ee(Se)},X.onerror=ve=>ue(ve),X.readAsDataURL(b)}),U=async()=>{if(!s){alert(o.missingKey);return}y(!0);try{let b={...h};if(T==="IMPORT"&&v){const ue=await O(v);b.importedFile={data:ue,mimeType:v.type},b.topic=`Imported: ${v.name}`}else if(T==="TOPIC"){if(!b.topic.trim())return;b.importedFile=void 0}const ee=await sN(b,s,ue=>{navigator.clipboard.writeText(ue).then(()=>{console.log("Prompt copied")}).catch(X=>console.error("Could not copy prompt",X))});l(ee),E(!1),d("MATRIX")}catch(b){console.error(b),alert(o.errGen)}finally{y(!1)}},Q=async()=>{try{let b={...h};if(T==="IMPORT"&&v){const ve=await O(v);b.importedFile={data:ve,mimeType:v.type},b.topic=`Imported: ${v.name}`}else if(T==="TOPIC"){if(!b.topic.trim()){alert("Please enter a topic first.");return}b.importedFile=void 0}const{systemInstruction:ee,prompt:ue}=L1(b),X=`SYSTEM:
${ee}

USER PROMPT:
${ue}`;Te(X),H(!0),E(!1)}catch(b){console.error("Failed to build prompt",b)}},he=async()=>{if(!s){alert(o.missingKey);return}y(!0),H(!1);try{const b=await oN(Z,s,h.model);l(b),d("MATRIX")}catch(b){console.error(b),alert(o.errGen)}finally{y(!1)}},xe=()=>{H(!1),E(!0)},me=()=>{const b={id:Math.random().toString(36).substr(2,9),name:r==="pt"?"Nova Caracterstica":"New Feature",imageUrl:"",states:[{id:Math.random().toString(36).substr(2,9),label:r==="pt"?"Estado 1":"State 1"}]};l(ee=>({...ee,features:[...ee.features,b]}))},le=()=>{const b={id:Math.random().toString(36).substr(2,9),name:r==="pt"?"Nova Entidade":"New Entity",description:"...",links:[],traits:{}};l(ee=>({...ee,entities:[...ee.entities,b]}))},Oe=(b,ee,ue)=>{l(X=>{const ve=X.entities.map(Se=>{if(Se.id!==b)return Se;const it=Se.traits[ee]||[],Un=it.includes(ue);let pr;return Un?pr=it.filter(ot=>ot!==ue):pr=[...it,ue],{...Se,traits:{...Se.traits,[ee]:pr}}});return{...X,entities:ve}})},Pe=b=>b===1?o.detailSimple:b===3?o.detailExpert:T==="IMPORT"?o.detailOriginal:o.detailBalanced;return g.jsxs("div",{className:"flex flex-col h-full bg-white font-sans absolute inset-0",children:[g.jsxs("div",{className:"border-b px-4 py-3 flex justify-between items-center bg-slate-900 text-white shadow-md z-30 shrink-0",children:[g.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[g.jsx("button",{onClick:()=>B(!M),className:"md:hidden text-slate-300 hover:text-white",children:g.jsx(S_,{size:24})}),g.jsxs("h2",{className:"text-base md:text-xl font-bold flex items-center gap-2 truncate",children:[g.jsx("span",{className:"bg-emerald-500 text-[10px] md:text-xs text-white px-2 py-1 rounded uppercase tracking-wider shadow-sm hidden sm:inline-block",children:o.builder}),g.jsx("span",{className:"truncate max-w-[150px] md:max-w-[300px]",children:a.name})]}),g.jsx("div",{className:"h-6 w-px bg-slate-700 mx-2 hidden md:block"}),g.jsxs("div",{className:"hidden md:flex items-center gap-1 text-sm",children:[g.jsxs("button",{onClick:oe,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:o.save,children:[g.jsx(qa,{size:14})," ",g.jsx("span",{className:"hidden sm:inline",children:o.save})]}),g.jsxs("button",{onClick:()=>L(!0),className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:o.open,children:[g.jsx(Gs,{size:14})," ",g.jsx("span",{className:"hidden sm:inline",children:o.open})]}),g.jsxs("button",{onClick:_e,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:o.export,children:[g.jsx(Ed,{size:14})," ",g.jsx("span",{className:"hidden sm:inline",children:o.export})]}),g.jsxs("button",{onClick:ke,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:o.exportXLSX,children:[g.jsx(wd,{size:14})," ",g.jsx("span",{className:"hidden sm:inline",children:o.exportXLSX})]}),g.jsxs("label",{className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white cursor-pointer",title:o.import,children:[g.jsx(va,{size:14})," ",g.jsx("span",{className:"hidden sm:inline",children:o.import}),g.jsx("input",{type:"file",accept:".json",onChange:P,className:"hidden"})]})]})]}),g.jsxs("div",{className:"flex gap-2 md:gap-3",children:[g.jsxs("button",{onClick:()=>E(!0),className:"flex items-center gap-2 px-3 py-1.5 md:px-4 md:py-2 bg-gradient-to-r from-amber-500 to-yellow-500 hover:from-amber-400 hover:to-yellow-400 text-white rounded-lg transition-all shadow-lg shadow-amber-900/30 text-xs md:text-sm font-bold border border-amber-400/20 group",children:[g.jsx(Vs,{size:16,className:"text-white fill-white/20 group-hover:scale-110 transition-transform"})," ",g.jsx("span",{className:"hidden sm:inline",children:o.aiWizard}),g.jsx("span",{className:"sm:hidden",children:"IA"})]}),g.jsxs("button",{onClick:()=>t(a),className:"flex items-center gap-2 px-3 py-1.5 md:px-5 md:py-2 bg-emerald-600 hover:bg-emerald-500 rounded-lg transition-all text-xs md:text-sm font-semibold shadow-lg shadow-emerald-900/30 text-white",children:[g.jsx(yf,{size:16})," ",g.jsx("span",{className:"hidden sm:inline",children:o.savePlay})]}),g.jsxs("button",{onClick:n,className:"px-2 py-1.5 md:px-4 md:py-2 text-slate-400 hover:text-white transition-colors text-xs md:text-sm font-medium",children:[g.jsx(Hn,{size:20,className:"md:hidden"})," ",g.jsx("span",{className:"hidden md:inline",children:o.exit})]})]})]}),M&&g.jsxs("div",{className:"md:hidden bg-slate-800 text-slate-200 border-b border-slate-700 p-2 grid grid-cols-4 gap-2 text-xs font-medium z-20",children:[g.jsxs("button",{onClick:()=>{oe(),B(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[g.jsx(qa,{size:18})," ",o.save]}),g.jsxs("button",{onClick:()=>{L(!0),B(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[g.jsx(Gs,{size:18})," ",o.open]}),g.jsxs("button",{onClick:()=>{_e(),B(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[g.jsx(Ed,{size:18})," ",o.export]}),g.jsxs("button",{onClick:()=>{ke(),B(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[g.jsx(wd,{size:18})," ",o.exportXLSX]}),g.jsxs("label",{className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded cursor-pointer",children:[g.jsx(va,{size:18})," ",o.import,g.jsx("input",{type:"file",accept:".json",onChange:P,className:"hidden"})]})]}),g.jsx("div",{className:"flex border-b bg-white overflow-x-auto whitespace-nowrap shrink-0",children:[{id:"GENERAL",label:o.general,icon:d_},{id:"FEATURES",label:o.features,icon:E_},{id:"ENTITIES",label:o.entities,icon:n1},{id:"MATRIX",label:o.matrix,icon:pu}].map(b=>g.jsxs("button",{onClick:()=>d(b.id),className:`flex items-center gap-2 px-4 py-3 md:py-4 text-xs md:text-sm font-medium transition-all border-b-2 relative top-[2px] min-w-fit ${u===b.id?"border-emerald-600 text-emerald-600 bg-emerald-50/50 rounded-t-lg":"border-transparent text-slate-500 hover:text-slate-800 hover:bg-slate-50/50"}`,children:[g.jsx(b.icon,{size:16})," ",b.label]},b.id))}),g.jsx("div",{className:"flex-1 overflow-auto bg-slate-50 p-4 md:p-6 pb-20 md:pb-6",children:g.jsxs("div",{className:`mx-auto bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden ${u==="MATRIX"?"max-w-none":"max-w-6xl"}`,children:[u==="GENERAL"&&g.jsx("div",{className:"p-6 md:p-8 space-y-8 max-w-2xl",children:g.jsxs("div",{children:[g.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 border-b pb-2",children:o.general}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1",children:o.projectName}),g.jsx("input",{value:a.name,onChange:b=>Me({name:b.target.value}),className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all font-medium text-slate-800"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1",children:o.description}),g.jsx("textarea",{value:a.description,onChange:b=>Me({description:b.target.value}),className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all h-32 text-slate-700"})]})]})]})}),u==="FEATURES"&&g.jsxs("div",{className:"p-4 md:p-8",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:o.definedFeatures}),g.jsx("p",{className:"text-xs md:text-sm text-slate-500",children:o.definedFeaturesDesc})]}),g.jsxs("button",{onClick:me,className:"flex items-center gap-2 text-sm bg-slate-900 text-white px-4 py-2 rounded-lg hover:bg-slate-700 shadow-md transition-all",children:[g.jsx(Qo,{size:16})," ",g.jsx("span",{className:"hidden sm:inline",children:o.addFeature})]})]}),g.jsx("div",{className:"grid gap-6 md:grid-cols-2 xl:grid-cols-3",children:a.features.map((b,ee)=>g.jsxs("div",{className:"border border-slate-200 rounded-xl p-5 bg-white relative group hover:border-emerald-300 hover:shadow-md transition-all",children:[g.jsx("button",{className:"absolute top-3 right-3 text-slate-300 hover:text-red-500 md:opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-red-50 rounded",onClick:()=>{const ue=a.features.filter(X=>X.id!==b.id);l(X=>({...X,features:ue}))},children:g.jsx(mu,{size:16})}),g.jsxs("div",{className:"mb-4 space-y-2",children:[g.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:o.featureName}),g.jsx("input",{value:b.name,onChange:ue=>{const X=[...a.features];X[ee].name=ue.target.value,l(ve=>({...ve,features:X}))},className:"font-bold text-lg text-slate-800 bg-transparent border-b border-transparent hover:border-slate-300 focus:border-emerald-500 outline-none w-full pb-1"}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Hs,{size:14,className:"text-slate-400"}),g.jsx("input",{value:b.imageUrl||"",onChange:ue=>{const X=[...a.features];X[ee].imageUrl=ue.target.value,l(ve=>({...ve,features:X}))},className:"text-xs flex-1 bg-slate-50 border border-slate-200 rounded px-2 py-1 outline-none focus:border-emerald-400",placeholder:o.imageURL})]})]}),g.jsxs("div",{className:"space-y-2 pl-3 border-l-2 border-slate-100",children:[g.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider block mb-1",children:o.states}),b.states.map((ue,X)=>g.jsxs("div",{className:"flex items-center gap-2 group/state",children:[g.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-300 group-focus-within/state:bg-emerald-400"}),g.jsx("input",{value:ue.label,onChange:ve=>{const Se=[...a.features];Se[ee].states[X].label=ve.target.value,l(it=>({...it,features:Se}))},className:"text-sm bg-transparent outline-none w-full text-slate-600 focus:text-slate-900 focus:font-medium"}),g.jsx("button",{onClick:()=>{const ve=[...a.features];ve[ee].states=ve[ee].states.filter(Se=>Se.id!==ue.id),l(Se=>({...Se,features:ve}))},className:"text-slate-300 hover:text-red-400 md:opacity-0 group-hover/state:opacity-100 transition-opacity",children:g.jsx(Hn,{size:12})})]},ue.id)),g.jsxs("button",{onClick:()=>{const ue=[...a.features];ue[ee].states.push({id:Math.random().toString(36).substr(2,9),label:"..."}),l(X=>({...X,features:ue}))},className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium mt-3 flex items-center gap-1 bg-emerald-50 w-fit px-2 py-1 rounded",children:[g.jsx(Qo,{size:10})," ",o.addState]})]})]},b.id))})]}),u==="ENTITIES"&&g.jsxs("div",{className:"p-4 md:p-8",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:o.manageEntities}),g.jsx("p",{className:"text-xs md:text-sm text-slate-500",children:o.manageEntitiesDesc})]}),g.jsxs("button",{onClick:le,className:"flex items-center gap-2 text-sm bg-slate-900 text-white px-4 py-2 rounded-lg hover:bg-slate-700 shadow-md transition-all",children:[g.jsx(Qo,{size:16})," ",g.jsx("span",{className:"hidden sm:inline",children:o.addEntity})]})]}),g.jsx("div",{className:"space-y-4",children:a.entities.map((b,ee)=>g.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 items-start border border-slate-200 p-4 md:p-6 rounded-xl bg-white hover:shadow-md transition-shadow",children:[g.jsxs("div",{className:"w-full sm:w-48 space-y-2 flex-shrink-0",children:[g.jsx("div",{className:"aspect-[4/3] bg-slate-100 rounded-lg overflow-hidden border border-slate-200",children:b.imageUrl?g.jsx("img",{src:b.imageUrl,className:"w-full h-full object-cover",alt:"preview"}):g.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-300",children:g.jsx(Hs,{size:32})})}),g.jsx("input",{value:b.imageUrl||"",onChange:ue=>{const X=[...a.entities];X[ee].imageUrl=ue.target.value,l(ve=>({...ve,entities:X}))},className:"text-xs w-full px-2 py-1.5 bg-slate-50 border border-slate-200 rounded outline-none focus:border-emerald-500 text-slate-600",placeholder:o.imageURL}),g.jsxs("button",{onClick:()=>Ee(b.id),className:"w-full flex items-center justify-center gap-2 text-xs bg-slate-100 hover:bg-slate-200 text-slate-700 py-3 md:py-2 rounded-lg font-medium transition-colors border border-slate-200",children:[g.jsx(Xo,{size:12})," ",o.editTraits]})]}),g.jsxs("div",{className:"flex-1 space-y-4 w-full",children:[g.jsxs("div",{className:"flex justify-between items-start gap-2",children:[g.jsx("input",{value:b.name,onChange:ue=>{const X=[...a.entities];X[ee].name=ue.target.value,l(ve=>({...ve,entities:X}))},className:"text-xl font-bold bg-transparent border-b border-transparent hover:border-slate-300 focus:border-emerald-500 outline-none w-full pb-1 text-slate-800"}),g.jsx("button",{onClick:()=>{const ue=a.entities.filter(X=>X.id!==b.id);l(X=>({...X,entities:ue}))},className:"text-slate-300 hover:text-red-500 p-2 hover:bg-red-50 rounded transition-colors",children:g.jsx(mu,{size:18})})]}),g.jsx("textarea",{value:b.description,onChange:ue=>{const X=[...a.entities];X[ee].description=ue.target.value,l(ve=>({...ve,entities:X}))},className:"text-sm text-slate-600 bg-slate-50 border border-transparent focus:bg-white focus:border-emerald-500 w-full h-24 outline-none resize-none rounded-lg p-3 transition-colors"}),g.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100",children:[g.jsxs("h5",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 flex items-center gap-2",children:[g.jsx(vf,{size:12})," ",o.links]}),g.jsxs("div",{className:"space-y-2",children:[(b.links||[]).map((ue,X)=>g.jsxs("div",{className:"flex gap-2",children:[g.jsx("input",{placeholder:"Label",value:ue.label,onChange:ve=>{const Se=[...a.entities];Se[ee].links||(Se[ee].links=[]),Se[ee].links[X].label=ve.target.value,l(it=>({...it,entities:Se}))},className:"text-xs flex-1 px-2 py-1 border border-slate-200 rounded outline-none focus:border-emerald-400"}),g.jsx("input",{placeholder:"URL",value:ue.url,onChange:ve=>{const Se=[...a.entities];Se[ee].links||(Se[ee].links=[]),Se[ee].links[X].url=ve.target.value,l(it=>({...it,entities:Se}))},className:"text-xs flex-[2] px-2 py-1 border border-slate-200 rounded outline-none focus:border-emerald-400"}),g.jsx("button",{onClick:()=>{const ve=[...a.entities];ve[ee].links||(ve[ee].links=[]),ve[ee].links=ve[ee].links.filter((Se,it)=>it!==X),l(Se=>({...Se,entities:ve}))},className:"text-slate-400 hover:text-red-500",children:g.jsx(Hn,{size:14})})]},ue.id||X)),g.jsxs("button",{onClick:()=>{const ue=[...a.entities];ue[ee].links||(ue[ee].links=[]),ue[ee].links.push({id:Math.random().toString(36).substr(2,9),label:"",url:""}),l(X=>({...X,entities:ue}))},className:"text-xs flex items-center gap-1 text-emerald-600 hover:text-emerald-700 font-medium",children:[g.jsx(Qo,{size:12})," ",o.addLink]})]})]})]})]},b.id))})]}),u==="MATRIX"&&g.jsxs("div",{className:"flex flex-col h-full bg-slate-50 min-h-[500px]",children:[g.jsxs("div",{className:"p-4 border-b bg-white flex justify-between items-center",children:[g.jsx("h3",{className:"font-semibold text-slate-700",children:o.scoringMatrix}),g.jsx("span",{className:"text-xs text-slate-400 hidden sm:inline",children:o.scoringMatrixDesc})]}),g.jsx("div",{className:"overflow-auto custom-scrollbar flex-1 relative bg-slate-200/50",children:g.jsx("div",{className:"inline-block min-w-full align-top",children:g.jsxs("div",{className:"grid",style:{gridTemplateColumns:`minmax(150px, 250px) repeat(${a.features.reduce((b,ee)=>b+ee.states.length,0)}, minmax(50px, 1fr))`},children:[g.jsx("div",{className:"sticky top-0 left-0 z-30 bg-slate-800 text-white p-2 md:p-4 font-bold border-r border-slate-700 shadow-md flex items-end text-xs md:text-sm",children:o.taxaFeatures}),a.features.map(b=>g.jsxs("div",{className:"sticky top-0 z-20 bg-slate-800 text-white border-r border-slate-700 shadow-md text-center",style:{gridColumn:`span ${b.states.length}`},children:[g.jsx("div",{className:"p-1 md:p-2 border-b border-slate-600 font-semibold truncate text-[10px] md:text-sm bg-slate-900/50",children:b.name}),g.jsx("div",{className:"flex",children:b.states.map(ee=>g.jsx("div",{className:"flex-1 p-1 md:p-2 text-[10px] md:text-xs text-slate-300 border-r border-slate-700 last:border-0 h-full flex items-center justify-center min-w-[50px] break-words",children:ee.label},ee.id))})]},b.id)),a.entities.map((b,ee)=>g.jsxs(jp.Fragment,{children:[g.jsxs("div",{className:`sticky left-0 z-10 bg-white p-2 md:p-3 border-r border-b border-slate-200 flex items-center gap-2 md:gap-3 shadow-[4px_0_10px_-4px_rgba(0,0,0,0.1)] hover:bg-slate-50 group ${ee%2===0?"bg-white":"bg-slate-50/50"}`,children:[g.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 rounded bg-slate-200 overflow-hidden flex-shrink-0",children:b.imageUrl&&g.jsx("img",{src:b.imageUrl,className:"w-full h-full object-cover"})}),g.jsx("span",{className:"font-medium text-slate-700 text-xs md:text-sm group-hover:text-emerald-600 transition-colors truncate",children:b.name})]}),a.features.map(ue=>ue.states.map(X=>{var Se;const ve=(Se=b.traits[ue.id])==null?void 0:Se.includes(X.id);return g.jsx("div",{className:`border-b border-r border-slate-100 flex items-center justify-center p-2 hover:bg-emerald-50 transition-colors ${ee%2===0?"bg-white":"bg-slate-50/50"}`,children:g.jsx("button",{onClick:()=>Oe(b.id,ue.id,X.id),className:`w-8 h-8 md:w-8 md:h-8 rounded-md flex items-center justify-center transition-all duration-200 transform active:scale-95 touch-manipulation ${ve?"bg-emerald-600 text-white shadow-sm":"bg-slate-100 text-slate-300 hover:bg-slate-200"}`,children:ve&&g.jsx(pu,{size:16,strokeWidth:3})})},`${b.id}-${X.id}`)}))]},b.id))]})})})]})]})}),ye&&g.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:g.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col max-h-[90vh] animate-in fade-in zoom-in-95 overflow-hidden",children:[g.jsxs("div",{className:"bg-slate-50 p-4 border-b flex justify-between items-center",children:[g.jsxs("h3",{className:"font-bold text-slate-800 text-lg flex items-center gap-2 truncate",children:[g.jsx(Xo,{size:18,className:"text-emerald-600"}),g.jsxs("span",{className:"truncate",children:[o.traitEditor,": ",g.jsx("span",{className:"text-emerald-600",children:(pt=a.entities.find(b=>b.id===ye))==null?void 0:pt.name})]})]}),g.jsx("button",{onClick:()=>Ee(null),className:"text-slate-400 hover:text-slate-600 p-1",children:g.jsx(Hn,{size:20})})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 space-y-6 custom-scrollbar",children:[a.features.map(b=>g.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4",children:[g.jsxs("h4",{className:"font-bold text-slate-700 mb-3 flex items-center gap-2",children:[b.name,b.imageUrl&&g.jsx("a",{href:b.imageUrl,target:"_blank",rel:"noopener noreferrer",className:"text-slate-400 hover:text-emerald-500",children:g.jsx(Nc,{size:12})})]}),g.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:b.states.map(ee=>{var X,ve;const ue=(ve=(X=a.entities.find(Se=>Se.id===ye))==null?void 0:X.traits[b.id])==null?void 0:ve.includes(ee.id);return g.jsxs("button",{onClick:()=>Oe(ye,b.id,ee.id),className:`text-sm px-3 py-3 md:py-2 rounded-lg border text-left flex items-center justify-between transition-all touch-manipulation active:scale-[0.98] ${ue?"bg-emerald-600 text-white border-emerald-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-emerald-300 hover:text-emerald-600"}`,children:[g.jsx("span",{className:"truncate mr-2 text-xs md:text-sm",children:ee.label}),ue&&g.jsx(pu,{size:14})]},ee.id)})})]},b.id)),a.features.length===0&&g.jsx("div",{className:"text-center text-slate-400 py-10",children:"Nenhuma caracterstica definida no projeto."})]}),g.jsx("div",{className:"p-4 border-t bg-slate-50 shrink-0",children:g.jsx("button",{onClick:()=>Ee(null),className:"w-full py-3 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-500 shadow-lg shadow-emerald-900/10",children:o.close})})]})}),x&&g.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:g.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full overflow-hidden animate-in fade-in zoom-in-95 duration-200 border border-slate-200 max-h-[90vh] flex flex-col",children:[g.jsxs("div",{className:"bg-gradient-to-r from-amber-500 to-yellow-500 p-4 md:p-6 text-white shrink-0",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[g.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:g.jsx(Vs,{size:24,className:"text-white"})}),g.jsx("h3",{className:"text-xl md:text-2xl font-bold",children:o.aiTitle})]}),g.jsx("p",{className:"text-amber-50 text-xs md:text-sm font-medium drop-shadow-sm",children:o.aiDesc})]}),g.jsxs("div",{className:"flex border-b border-slate-200 bg-slate-50 shrink-0",children:[g.jsx("button",{onClick:()=>_("TOPIC"),className:`flex-1 py-3 text-sm font-bold transition-colors border-b-2 ${T==="TOPIC"?"border-amber-500 text-amber-600 bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:g.jsxs("span",{className:"flex items-center justify-center gap-2",children:[g.jsx(Rd,{size:16})," ",o.modeTopic]})}),g.jsx("button",{onClick:()=>_("IMPORT"),className:`flex-1 py-3 text-sm font-bold transition-colors border-b-2 ${T==="IMPORT"?"border-amber-500 text-amber-600 bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:g.jsxs("span",{className:"flex items-center justify-center gap-2",children:[g.jsx(x_,{size:16})," ",o.modeImport]})})]}),g.jsxs("div",{className:"p-4 md:p-6 space-y-5 overflow-y-auto custom-scrollbar flex-1 bg-white",children:[T==="TOPIC"?g.jsxs(g.Fragment,{children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:o.topic}),g.jsx("input",{value:h.topic,onChange:b=>p(ee=>({...ee,topic:b.target.value})),placeholder:o.topicPlace,className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-amber-500 focus:border-amber-500 outline-none text-base md:text-lg",disabled:m})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-1.5",children:o.geography}),g.jsx("input",{value:h.geography,onChange:b=>p(ee=>({...ee,geography:b.target.value})),placeholder:"e.g. Amazon",className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-500 outline-none text-sm",disabled:m})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-1.5",children:o.taxonomy}),g.jsx("input",{value:h.taxonomy,onChange:b=>p(ee=>({...ee,taxonomy:b.target.value})),placeholder:"e.g. Felidae",className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-500 outline-none text-sm",disabled:m})]})]})]}):g.jsxs("div",{className:"flex flex-col gap-4",children:[g.jsxs("div",{className:"text-center space-y-2 mb-2",children:[g.jsx("h4",{className:"font-bold text-slate-800 text-lg",children:o.uploadLabel}),g.jsx("p",{className:"text-slate-500 text-sm",children:o.uploadDesc})]}),g.jsx("div",{className:`border-2 border-dashed rounded-xl p-6 flex flex-col items-center justify-center transition-all bg-slate-50 ${v?"border-amber-500 bg-amber-50/30":"border-slate-300 hover:border-amber-400"}`,children:v?g.jsxs("div",{className:"flex flex-col items-center gap-3",children:[g.jsx(v_,{size:48,className:"text-amber-600"}),g.jsx("span",{className:"font-bold text-slate-800 text-sm text-center break-all",children:v.name}),g.jsxs("span",{className:"text-xs text-slate-400",children:[(v.size/1024).toFixed(1)," KB"]}),g.jsxs("button",{onClick:()=>C(null),className:"mt-2 text-red-500 text-xs font-bold hover:underline flex items-center gap-1 p-2",children:[g.jsx(mu,{size:12})," ",o.removeFile]})]}):g.jsxs("label",{className:"cursor-pointer flex flex-col items-center gap-3 w-full h-full",children:[g.jsx("div",{className:"p-4 bg-white rounded-full shadow-sm",children:g.jsx(va,{size:24,className:"text-amber-500"})}),g.jsx("span",{className:"font-bold text-slate-600",children:o.dropFile}),g.jsx("span",{className:"text-xs text-slate-400",children:o.supportedFormats}),g.jsx("input",{type:"file",className:"hidden",accept:".pdf,.txt,.jpg,.jpeg,.png",onChange:W})]})})]}),g.jsxs("div",{className:"pt-4 border-t border-slate-100 space-y-5",children:[g.jsxs("h5",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[g.jsx(Id,{size:12})," ",o.configSettings]}),g.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:[g.jsxs("div",{className:"flex justify-between items-center mb-4",children:[g.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase flex items-center gap-1",children:[g.jsx(w_,{size:14})," ",o.detailLevel]}),g.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-100 px-2 py-1 rounded",children:Pe(h.detailLevel)})]}),g.jsx("input",{type:"range",min:"1",max:"3",step:"1",value:h.detailLevel,onChange:b=>p(ee=>({...ee,detailLevel:parseInt(b.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500 mb-2",disabled:m}),g.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 font-medium uppercase tracking-wide",children:[g.jsxs("span",{className:`flex flex-col items-center gap-1 ${h.detailLevel===1?"text-amber-600":""}`,children:[g.jsx(f_,{size:16})," Simple"]}),g.jsxs("span",{className:`flex flex-col items-center gap-1 ${h.detailLevel===2?"text-amber-600":""}`,children:[g.jsx(Vs,{size:16})," Bal."]}),g.jsxs("span",{className:`flex flex-col items-center gap-1 ${h.detailLevel===3?"text-amber-600":""}`,children:[g.jsx(__,{size:16})," Expert"]})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-2",children:o.featureFocus}),g.jsx("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:["general","reproductive","vegetative"].map(b=>g.jsx("button",{onClick:()=>p(ee=>({...ee,featureFocus:b})),className:`flex-1 py-2 rounded-md text-[10px] md:text-xs font-medium transition-all ${h.featureFocus===b?"bg-white text-amber-600 shadow-sm":"text-slate-500 hover:text-slate-800"}`,disabled:m,children:b==="general"?o.focusGeneral:b==="reproductive"?o.focusRepro:o.focusVeg},b))})]}),T==="TOPIC"&&g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[g.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:o.numEntities}),g.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:h.count})]}),g.jsx("input",{type:"range",min:"3",max:"30",step:"1",value:h.count,onChange:b=>p(ee=>({...ee,count:parseInt(b.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500",disabled:m})]}),g.jsxs("div",{children:[g.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[g.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:o.numFeatures}),g.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:h.featureCount})]}),g.jsx("input",{type:"range",min:"2",max:"10",step:"1",value:h.featureCount,onChange:b=>p(ee=>({...ee,featureCount:parseInt(b.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500",disabled:m})]})]}),g.jsxs("div",{className:"space-y-3",children:[g.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Hs,{size:16,className:"text-slate-400 group-hover:text-amber-500 transition-colors"}),g.jsx("span",{className:"text-sm font-medium text-slate-700",children:o.fetchSpeciesImg})]}),g.jsx("div",{className:`w-11 h-6 flex items-center rounded-full p-1 transition-colors ${h.includeSpeciesImages?"bg-amber-500":"bg-slate-300"}`,children:g.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${h.includeSpeciesImages?"translate-x-5":""}`})}),g.jsx("input",{type:"checkbox",className:"hidden",checked:h.includeSpeciesImages,onChange:b=>p(ee=>({...ee,includeSpeciesImages:b.target.checked})),disabled:m})]}),g.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Id,{size:16,className:"text-slate-400 group-hover:text-amber-500 transition-colors"}),g.jsx("span",{className:"text-sm font-medium text-slate-700",children:o.fetchFeatureImg})]}),g.jsx("div",{className:`w-11 h-6 flex items-center rounded-full p-1 transition-colors ${h.includeFeatureImages?"bg-amber-500":"bg-slate-300"}`,children:g.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${h.includeFeatureImages?"translate-x-5":""}`})}),g.jsx("input",{type:"checkbox",className:"hidden",checked:h.includeFeatureImages,onChange:b=>p(ee=>({...ee,includeFeatureImages:b.target.checked})),disabled:m})]}),g.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(vf,{size:16,className:"text-slate-400 group-hover:text-amber-500 transition-colors"}),g.jsx("span",{className:"text-sm font-medium text-slate-700",children:o.fetchLinks})]}),g.jsx("div",{className:`w-11 h-6 flex items-center rounded-full p-1 transition-colors ${h.includeLinks?"bg-amber-500":"bg-slate-300"}`,children:g.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${h.includeLinks?"translate-x-5":""}`})}),g.jsx("input",{type:"checkbox",className:"hidden",checked:h.includeLinks,onChange:b=>p(ee=>({...ee,includeLinks:b.target.checked})),disabled:m})]})]})]}),m&&g.jsxs("div",{className:"bg-amber-50 text-amber-700 p-3 rounded-lg text-sm flex items-center justify-center gap-2",children:[g.jsx(Nd,{className:"animate-spin",size:16})," ",T==="IMPORT"?o.analyzing:o.generating]})]}),g.jsxs("div",{className:"p-4 bg-slate-50 border-t flex gap-3 shrink-0 safe-area-bottom",children:[g.jsx("button",{onClick:()=>E(!1),className:"flex-none w-16 md:w-20 py-2.5 text-slate-600 font-medium hover:bg-slate-200 rounded-xl transition-colors text-center text-xs md:text-sm",disabled:m,children:o.cancel}),g.jsxs("button",{onClick:Q,className:"w-auto px-3 py-2 text-xs bg-white border border-slate-300 text-slate-700 font-bold rounded-xl hover:bg-slate-50 hover:border-amber-400 hover:text-amber-600 shadow-sm transition-all flex items-center justify-center gap-2",disabled:m||T==="TOPIC"&&!h.topic||T==="IMPORT"&&!v,title:"View and edit the prompt before sending",children:[g.jsx(Xo,{size:14})," ",g.jsx("span",{className:"hidden sm:inline",children:"View/Edit Prompt"})]}),g.jsxs("button",{onClick:U,className:"flex-1 py-2.5 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 text-sm",disabled:m||T==="TOPIC"&&!h.topic||T==="IMPORT"&&!v,children:[o.generate," ",g.jsx(Rd,{size:16,className:"opacity-70"})]})]})]})}),J&&g.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-[60] flex items-center justify-center p-4",children:g.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col h-[80vh] max-h-[90vh] animate-in fade-in zoom-in-95 overflow-hidden",children:[g.jsxs("div",{className:"bg-slate-800 p-4 border-b border-slate-700 flex justify-between items-center text-white shrink-0",children:[g.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[g.jsx(Xo,{size:18,className:"text-amber-400"}),"Prompt Editor"]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(Z),alert(o.promptCopied)},className:"flex items-center gap-1.5 px-3 py-1.5 text-xs hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",children:[g.jsx(g_,{size:12})," ",o.copyPrompt]}),g.jsx("button",{onClick:xe,className:"text-slate-400 hover:text-white p-1",children:g.jsx(Hn,{size:20})})]})]}),g.jsx("div",{className:"flex-1 p-2 bg-slate-100 min-h-0",children:g.jsx("textarea",{value:Z,onChange:b=>Te(b.target.value),className:"w-full h-full p-4 bg-slate-900 text-slate-200 font-mono text-sm rounded-lg resize-none outline-none border-2 border-transparent focus:border-amber-500",spellCheck:"false"})}),g.jsxs("div",{className:"p-4 border-t bg-slate-50 shrink-0 flex items-center justify-end gap-4",children:[g.jsx("button",{onClick:xe,className:"px-6 py-2 text-slate-600 font-medium hover:bg-slate-200 rounded-xl transition-colors",disabled:m,children:o.cancel}),g.jsx("button",{onClick:he,className:"px-6 py-2 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 flex items-center gap-2",disabled:m,children:m?g.jsxs(g.Fragment,{children:[g.jsx(Nd,{className:"animate-spin",size:16})," ",o.generating]}):g.jsx(g.Fragment,{children:o.generate})})]})]})}),I&&g.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:g.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",children:[g.jsxs("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[g.jsx(Gs,{className:"text-emerald-600",size:20}),o.open]}),g.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto mb-4 custom-scrollbar",children:D.length===0?g.jsx("p",{className:"text-slate-500 text-sm text-center py-8 border-2 border-dashed border-slate-200 rounded-lg",children:o.noSaved}):D.map(b=>g.jsxs("button",{onClick:()=>ge(b),className:"w-full text-left p-3 hover:bg-emerald-50 rounded-lg border border-slate-100 hover:border-emerald-200 group transition-all",children:[g.jsx("div",{className:"font-medium text-slate-800 group-hover:text-emerald-700",children:b.name}),g.jsx("div",{className:"text-xs text-slate-400 truncate",children:b.description||"No description"})]},b.id))}),g.jsx("button",{onClick:()=>L(!1),className:"w-full py-2.5 bg-slate-100 text-slate-600 rounded-xl font-medium hover:bg-slate-200 transition-colors",children:o.close})]})})]})},jF=()=>{const[e,t]=Ne.useState("HOME"),[n,r]=Ne.useState(null),[i,s]=Ne.useState("pt"),[o,a]=Ne.useState([]),[l,u]=Ne.useState(!1),[d,h]=Ne.useState(!1),[p,m]=Ne.useState(!1),[y,x]=Ne.useState("ABOUT"),[E,T]=Ne.useState("gemini-2.5-flash"),[_,v]=Ne.useState("");Ne.useEffect(()=>{const H=localStorage.getItem("nozesia_projects");if(H)try{a(JSON.parse(H))}catch{console.error("Failed to load local projects")}const Z=localStorage.getItem("nozesia_settings");if(Z)try{const Te=JSON.parse(Z);Te.model&&T(Te.model),Te.apiKey&&v(Te.apiKey)}catch{console.error("Failed to load settings")}},[]);const C=()=>{const H=E.trim(),Z=_.trim();localStorage.setItem("nozesia_settings",JSON.stringify({model:H,apiKey:Z})),h(!1)},D={id:"demo-1",name:"Exemplo: Grandes Felinos",description:"Identifique espcies comuns de grandes felinos.",features:[{id:"f1",name:"Padro da Pelagem",states:[{id:"s1",label:"Listras"},{id:"s2",label:"Manchas"},{id:"s3",label:"Liso"}]},{id:"f2",name:"Habitat",states:[{id:"s4",label:"Selva"},{id:"s5",label:"Savana"}]}],entities:[{id:"e1",name:"Tigre",description:"O maior dos felinos.",imageUrl:"https://picsum.photos/id/237/400/300",links:[],traits:{f1:["s1"],f2:["s4"]}},{id:"e2",name:"Leo",description:"O rei da selva.",imageUrl:"https://picsum.photos/id/1003/400/300",links:[],traits:{f1:["s3"],f2:["s5"]}},{id:"e3",name:"Leopardo",description:"Escalador especialista.",imageUrl:"https://picsum.photos/id/1074/400/300",links:[],traits:{f1:["s2"],f2:["s4","s5"]}}]},F={en:{subtitle:"v2.1 Tropical",tagline:"Biological Identification AI",desc:"Create and share professional matrix identification keys. Powered by Gemini AI for instant taxonomy generation.",createNew:"Create / Edit Key",openSaved:"Open Saved",importJson:"Import Project",demo:"Try Demo",savedProj:"Saved Projects",close:"Close",noSaved:"No saved projects found.",invalid:"Invalid project file.",settings:"Settings",aiModel:"AI Model",apiKey:"Gemini API Key",getKey:"Get Key",save:"Save",apiKeyNotice:"Your API Key is stored locally in your browser and used only to communicate with Google.",help:"About & Help",helpContent:{intro:"NOZES is an intelligent platform for creating and using matrix identification keys, designed for biologists, students, and nature enthusiasts.",step1Title:"1. Nozes AI Wizard",step1Desc:"Use the 'Nuts AI' button in the builder to automatically generate a key. You can describe a topic (e.g., 'Brazilian Cerrado Trees') OR upload a PDF/Image reference. The AI will study the material and create species, features, and the scoring matrix for you.",step2Title:"2. The Builder",step2Desc:"Refine your key manually. You can add new features, upload images for species, and adjust the matrix relationships between taxa and traits. Use the 'Export Project' button to save your work as a JSON file, which is essential for backups.",step3Title:"3. The Player",step3Desc:"This is the end-user view. Select observed features to filter down the list of species until you identify your specimen.",importExportTitle:"4. Import & Export",importExportDesc:"Always save your work by clicking 'Export Project'. This downloads a .json file. To resume work later or on another device, use 'Import Project' and select that file. You can also export to Excel (XLSX) for spreadsheets."}},pt:{subtitle:"v2.1 Tropical",tagline:"Inteligncia para Identificao Biolgica",desc:"Crie e compartilhe chaves de identificao matriciais profissionais. Poder da Gemini AI para gerao instantnea de taxonomia.",createNew:"Criar / Editar Chave",openSaved:"Abrir Chave",importJson:"Importar Projeto",demo:"Ver Demo",savedProj:"Projetos Salvos",close:"Fechar",noSaved:"Nenhum projeto salvo.",invalid:"Arquivo invlido.",settings:"Configuraes",aiModel:"Modelo IA",apiKey:"Chave API Gemini",getKey:"Obter Chave",save:"Salvar",apiKeyNotice:"Sua API Key  salva localmente no navegador e usada apenas para comunicar com o Google.",help:"Sobre e Ajuda",helpContent:{intro:"O NOZES  uma plataforma inteligente para criao e uso de chaves de identificao matriciais, projetada para bilogos, estudantes e entusiastas da natureza.",step1Title:"1. Assistente Nozes IA",step1Desc:"Use o boto 'Nozes IA' no construtor para gerar uma chave automaticamente. Voc pode descrever um tpico (ex: 'rvores do Cerrado') OU fazer upload de um PDF/Imagem de referncia. A IA estudar o material e criar espcies, caractersticas e a matriz para voc.",step2Title:"2. O Construtor",step2Desc:"Refine sua chave manualmente. Adicione novas caractersticas, insira imagens e ajuste a matriz. Use o boto 'Exportar Projeto' para salvar seu trabalho em arquivo JSON (backup essencial).",step3Title:"3. O Player",step3Desc:"Esta  a viso do usurio final. Selecione as caractersticas observadas para filtrar a lista de espcies at identificar seu espcime.",importExportTitle:"4. Importar & Exportar",importExportDesc:"Sempre salve seu trabalho clicando em 'Exportar Projeto'. Isso baixa um arquivo .json. Para continuar depois ou em outro dispositivo, use 'Importar Projeto' e selecione esse arquivo. Voc tambm pode exportar para Excel (XLSX)."}}}[i],I=()=>{t("BUILDER")},L=()=>{r(D),t("PLAYER")},M=H=>{const Z=localStorage.getItem("nozesia_projects");let Te=[];if(Z)try{Te=JSON.parse(Z)}catch(Ee){console.error("Failed to parse projects",Ee)}const ye=[H,...Te.filter(Ee=>Ee.id!==H.id)];localStorage.setItem("nozesia_projects",JSON.stringify(ye)),a(ye),r(H),t("PLAYER")},B=H=>{r(H),t("PLAYER"),u(!1)},J=H=>{const Z=new FileReader;H.target.files&&H.target.files[0]&&(Z.readAsText(H.target.files[0],"UTF-8"),Z.onload=Te=>{var ye;try{const Ee=JSON.parse((ye=Te.target)==null?void 0:ye.result);Ee.name&&Ee.features&&Ee.entities?(r(Ee),t("PLAYER")):alert(F.invalid)}catch{alert(F.invalid)}})};return e==="PLAYER"&&n?g.jsx(k_,{project:n,onBack:()=>t("HOME"),language:i}):e==="BUILDER"?g.jsx(QF,{initialProject:n,onSave:M,onCancel:()=>t("HOME"),language:i,defaultModel:E,apiKey:_}):g.jsxs("div",{className:"min-h-screen bg-[#0f2e24] flex items-center justify-center p-4 md:p-6 relative overflow-hidden font-sans",children:[g.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden pointer-events-none",children:[g.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[400px] md:w-[600px] h-[400px] md:h-[600px] bg-emerald-600/20 rounded-full blur-[80px] md:blur-[120px]"}),g.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[300px] md:w-[500px] h-[300px] md:h-[500px] bg-teal-500/20 rounded-full blur-[80px] md:blur-[100px]"}),g.jsx(Ad,{className:"absolute top-[10%] right-[15%] text-emerald-800/20 w-20 h-20 md:w-32 md:h-32 rotate-12"}),g.jsx(A_,{className:"absolute bottom-[20%] left-[10%] text-emerald-800/20 w-32 h-32 md:w-48 md:h-48 -rotate-12"})]}),g.jsxs("div",{className:"max-w-6xl w-full grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12 items-center z-10",children:[g.jsxs("div",{className:"text-white space-y-6 md:space-y-8",children:[g.jsxs("div",{className:"flex justify-between items-start",children:[g.jsx("div",{className:"inline-flex items-center gap-2 bg-emerald-900/50 text-emerald-300 px-3 py-1 rounded-full text-[10px] md:text-xs font-semibold tracking-wider uppercase border border-emerald-500/30 backdrop-blur-sm",children:F.subtitle}),g.jsxs("div",{className:"flex gap-2",children:[g.jsxs("div",{className:"flex bg-emerald-900/50 rounded-lg p-1 border border-emerald-500/30 backdrop-blur-sm",children:[g.jsx("button",{onClick:()=>s("pt"),className:`px-3 py-1 rounded text-xs font-bold transition-colors ${i==="pt"?"bg-emerald-500 text-white":"text-emerald-400 hover:text-white"}`,children:"PT"}),g.jsx("button",{onClick:()=>s("en"),className:`px-3 py-1 rounded text-xs font-bold transition-colors ${i==="en"?"bg-emerald-500 text-white":"text-emerald-400 hover:text-white"}`,children:"EN"})]}),g.jsx("button",{onClick:()=>m(!0),className:"bg-emerald-900/50 rounded-lg p-1.5 border border-emerald-500/30 backdrop-blur-sm text-emerald-400 hover:text-white hover:bg-emerald-800/50 transition-colors",title:F.help,children:g.jsx(m_,{size:20})}),g.jsx("button",{onClick:()=>h(!0),className:`bg-emerald-900/50 rounded-lg p-1.5 border backdrop-blur-sm transition-colors ${_?"border-emerald-500/30 text-emerald-400 hover:text-white hover:bg-emerald-800/50":"border-amber-500 text-amber-500 animate-pulse"}`,title:F.settings,children:g.jsx(kd,{size:20})})]})]}),g.jsxs("div",{children:[g.jsxs("div",{className:"flex items-center gap-3 md:gap-4 mb-2",children:[g.jsx("div",{className:"bg-amber-800/20 p-2 md:p-3 rounded-2xl border-2 border-amber-600/30 backdrop-blur-md shadow-[0_0_30px_rgba(217,119,6,0.2)]",children:g.jsx(Vs,{className:"text-amber-500 w-12 h-12 md:w-20 md:h-20",strokeWidth:1.5})}),g.jsx("h1",{className:"text-5xl md:text-7xl font-black tracking-tight leading-none text-transparent bg-clip-text bg-gradient-to-br from-amber-300 via-amber-500 to-orange-400 drop-shadow-sm",children:"NOZES"})]}),g.jsx("h2",{className:"text-lg md:text-2xl text-emerald-100/80 font-light pl-2",children:F.tagline})]}),g.jsx("p",{className:"text-slate-300 text-base md:text-lg leading-relaxed max-w-lg border-l-4 border-amber-500/50 pl-4 md:pl-6",children:F.desc}),g.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 md:gap-4 pt-2",children:[g.jsxs("button",{onClick:I,className:"col-span-1 sm:col-span-2 flex items-center justify-center gap-3 px-8 py-4 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white rounded-xl font-bold transition-all shadow-xl shadow-emerald-900/50 hover:scale-[1.02] text-lg border-t border-emerald-400/20 active:scale-95",children:[g.jsx(Cd,{className:"w-5 h-5"}),F.createNew]}),g.jsxs("button",{onClick:()=>u(!0),className:"flex items-center justify-center gap-2 px-6 py-3 bg-emerald-900/40 hover:bg-emerald-800/40 text-emerald-100 rounded-xl font-medium transition-all border border-emerald-500/20 hover:border-emerald-500/50 backdrop-blur-sm active:scale-95",children:[g.jsx(Gs,{className:"w-4 h-4"}),F.openSaved]}),g.jsxs("label",{className:"flex items-center justify-center gap-2 px-6 py-3 bg-emerald-900/40 hover:bg-emerald-800/40 text-emerald-100 rounded-xl font-medium transition-all border border-emerald-500/20 hover:border-emerald-500/50 backdrop-blur-sm cursor-pointer active:scale-95",children:[g.jsx(va,{className:"w-4 h-4"}),F.importJson,g.jsx("input",{type:"file",accept:".json",onChange:J,className:"hidden"})]}),g.jsxs("button",{onClick:L,className:"col-span-1 sm:col-span-2 mt-2 text-sm text-emerald-400 hover:text-emerald-200 flex items-center justify-center gap-2 font-medium py-2",children:[g.jsx(yf,{className:"w-3 h-3"}),F.demo]})]})]}),g.jsx("div",{className:"relative hidden lg:block transform perspective-1000 hover:rotate-y-2 transition-transform duration-700",children:g.jsxs("div",{className:"relative bg-gradient-to-br from-emerald-900/80 to-teal-900/80 backdrop-blur-md border border-emerald-500/20 p-8 rounded-3xl shadow-2xl",children:[g.jsx("div",{className:"absolute -top-10 -right-10 text-emerald-400/10",children:g.jsx(y_,{size:200})}),g.jsxs("div",{className:"flex items-center gap-3 mb-8 border-b border-emerald-500/20 pb-6",children:[g.jsx("div",{className:"w-3 h-3 rounded-full bg-red-400/80"}),g.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-400/80"}),g.jsx("div",{className:"w-3 h-3 rounded-full bg-green-400/80"}),g.jsx("div",{className:"ml-auto text-xs text-amber-500/80 font-mono tracking-widest font-bold",children:"NOZES.IA-v2"})]}),g.jsx("div",{className:"space-y-6 opacity-90",children:g.jsxs("div",{className:"flex gap-6",children:[g.jsxs("div",{className:"w-1/3 space-y-3",children:[g.jsx("div",{className:"h-2 bg-emerald-700/50 rounded w-1/2 mb-4"}),g.jsxs("div",{className:"h-10 bg-emerald-500/20 border-l-2 border-emerald-400 rounded-r flex items-center px-3 text-emerald-200 text-xs gap-2",children:[g.jsx(Ad,{size:12})," Folhas"]}),g.jsx("div",{className:"h-10 bg-emerald-900/30 rounded flex items-center px-3 text-emerald-600/50 text-xs",children:"Flores"}),g.jsx("div",{className:"h-10 bg-emerald-900/30 rounded flex items-center px-3 text-emerald-600/50 text-xs",children:"Caule"})]}),g.jsx("div",{className:"w-2/3 grid grid-cols-2 gap-3",children:[1,2,3,4].map(H=>g.jsxs("div",{className:"bg-emerald-950/50 rounded-lg p-3 border border-emerald-500/10 flex flex-col gap-2",children:[g.jsx("div",{className:"aspect-video bg-emerald-900/50 rounded flex items-center justify-center",children:g.jsx(h_,{className:"text-emerald-700/50",size:20})}),g.jsx("div",{className:"h-1.5 bg-emerald-800/50 rounded w-3/4"}),g.jsx("div",{className:"h-1.5 bg-emerald-800/30 rounded w-1/2"})]},H))})]})}),g.jsxs("div",{className:"mt-8 pt-6 border-t border-emerald-500/20 flex justify-between items-center text-emerald-400/40 text-xs",children:[g.jsx("span",{children:"Gemini 2.5 Flash Integrated"}),g.jsx("span",{children:"100% Client-Side"})]})]})})]}),d&&g.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:g.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[g.jsx(kd,{className:"text-emerald-600",size:20}),F.settings]}),g.jsx("button",{onClick:()=>h(!1),className:"text-slate-400 hover:text-slate-600 p-2",children:g.jsx(Hn,{size:24})})]}),g.jsxs("div",{className:"space-y-4 mb-6",children:[g.jsxs("div",{children:[g.jsxs("div",{className:"flex justify-between items-center mb-2",children:[g.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:F.apiKey}),g.jsxs("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-xs font-medium text-emerald-600 hover:text-emerald-700 hover:underline flex items-center gap-1",children:[F.getKey," ",g.jsx(Nc,{size:12})]})]}),g.jsxs("div",{className:"relative",children:[g.jsx(T_,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),g.jsx("input",{type:"password",value:_,onChange:H=>v(H.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none",placeholder:"AIzaSy..."})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:F.aiModel}),g.jsx("input",{value:E,onChange:H=>T(H.target.value),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none",placeholder:"gemini-2.5-flash"}),g.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Default: gemini-2.5-flash"})]}),g.jsx("div",{className:"bg-amber-50 p-3 rounded-lg border border-amber-100",children:g.jsx("p",{className:"text-xs text-amber-700",children:F.apiKeyNotice})})]}),g.jsxs("button",{onClick:C,className:"w-full py-3 bg-emerald-600 text-white rounded-xl font-bold hover:bg-emerald-500 transition-colors flex items-center justify-center gap-2",children:[g.jsx(qa,{size:16})," ",F.save]})]})}),p&&g.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:g.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-0 overflow-hidden animate-in fade-in zoom-in-95 flex flex-col max-h-[85vh]",children:[g.jsxs("div",{className:"p-4 md:p-6 border-b flex justify-between items-center bg-slate-50",children:[g.jsxs("div",{className:"flex gap-4 items-center",children:[g.jsxs("h3",{className:"text-lg md:text-xl font-bold text-slate-800 flex items-center gap-2",children:[g.jsx(r1,{className:"text-emerald-600",size:24}),F.help]}),g.jsxs("div",{className:"flex bg-slate-200/50 p-1 rounded-lg",children:[g.jsx("button",{onClick:()=>x("ABOUT"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${y==="ABOUT"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Sobre"}),g.jsx("button",{onClick:()=>x("HELP"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${y==="HELP"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Ajuda"})]})]}),g.jsx("button",{onClick:()=>m(!1),className:"text-slate-400 hover:text-slate-600 p-2",children:g.jsx(Hn,{size:24})})]}),g.jsx("div",{className:"p-4 md:p-6 overflow-y-auto custom-scrollbar space-y-6 md:space-y-8",children:y==="ABOUT"?g.jsxs(g.Fragment,{children:[g.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:" Sobre o Criador"}),g.jsxs("div",{className:"creator-info space-y-4 text-slate-700",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-semibold text-emerald-700",children:"Diogo Bueno Kanoute"}),g.jsx("p",{className:"font-medium",children:"Parabotnico e Dendrlogo em Inventrio Florestal"}),g.jsx("p",{className:"text-sm md:text-base mt-2",children:"Desenvolvedor especializado em Tecnologias de Inteligncia Artificial e Banco de Dados para Inventrio Florestal, Ecologia, Botnica, Dendrometria e Dendrologia."})]}),g.jsx("h4",{className:"text-lg font-bold text-slate-800 mt-8 border-t pt-4",children:" Links e Contatos"}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[g.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[g.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:"Identificao Botnica"}),g.jsx("a",{href:"https://go.hotmart.com/G103222293V",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"Curso Online na Hotmart"})]}),g.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[g.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" Fototeca DBK no SPLink"}),g.jsx("a",{href:"https://specieslink.net/col/FDBK",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"specieslink.net/col/FDBK"})]}),g.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[g.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" Instagram Cientfico"}),g.jsx("a",{href:"https://instagram.com/fotografandomato",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"@fotografandomato"})]}),g.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[g.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" Biblioteca Botnica"}),g.jsx("a",{href:"https://drive.google.com/drive/folders/0B4wGMi_KVTvOWm51UzNnNVJjaEk?resourcekey=0-8e69zvcLn2zMXuphNmC56A&usp=drive_link",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"PDFs e Material de Referncia"})]}),g.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[g.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" E-mail"}),g.jsx("a",{href:"mailto:diogokanoute@gmail.com",className:"text-emerald-600 hover:underline font-medium",children:"diogokanoute@gmail.com"})]}),g.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[g.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" WhatsApp Cientfico"}),g.jsx("a",{href:"https://wa.me/5521998501623",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"+55 21 998501623"})]})]}),g.jsx("p",{className:"text-sm text-slate-500 italic mt-6 bg-amber-50 p-4 rounded-lg border border-amber-100",children:"Entre em contato para dvidas sobre o app, cursos de Identificao Botnica, tecnologias de IA aplicadas  Dendrologia ou servios de Inventrio Florestal (Mata Atlntica, Cerrado, Amaznia e Caatinga)."})]})]}):g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"bg-emerald-50 p-4 rounded-xl border border-emerald-100 text-slate-700 leading-relaxed text-sm md:text-base",children:F.helpContent.intro}),g.jsxs("div",{className:"grid gap-6",children:[g.jsxs("div",{className:"flex gap-4",children:[g.jsx("div",{className:"bg-amber-100 p-3 rounded-full h-fit text-amber-600 shrink-0",children:g.jsx(Vs,{size:24})}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:F.helpContent.step1Title}),g.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:F.helpContent.step1Desc})]})]}),g.jsxs("div",{className:"flex gap-4",children:[g.jsx("div",{className:"bg-blue-100 p-3 rounded-full h-fit text-blue-600 shrink-0",children:g.jsx(Cd,{size:24})}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:F.helpContent.step2Title}),g.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:F.helpContent.step2Desc})]})]}),g.jsxs("div",{className:"flex gap-4",children:[g.jsx("div",{className:"bg-emerald-100 p-3 rounded-full h-fit text-emerald-600 shrink-0",children:g.jsx(yf,{size:24})}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:F.helpContent.step3Title}),g.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:F.helpContent.step3Desc})]})]}),g.jsxs("div",{className:"flex gap-4",children:[g.jsx("div",{className:"bg-purple-100 p-3 rounded-full h-fit text-purple-600 shrink-0",children:g.jsx(qa,{size:24})}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:F.helpContent.importExportTitle}),g.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:F.helpContent.importExportDesc})]})]})]})]})}),g.jsx("div",{className:"p-4 bg-slate-50 border-t",children:g.jsx("button",{onClick:()=>m(!1),className:"w-full py-3 bg-emerald-600 text-white rounded-xl font-bold hover:bg-emerald-500 transition-colors",children:F.close})})]})}),l&&g.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:g.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",children:[g.jsxs("div",{className:"flex justify-between items-center mb-4",children:[g.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[g.jsx(Gs,{className:"text-emerald-600",size:20}),F.openSaved]}),g.jsx("button",{onClick:()=>u(!1),className:"text-slate-400 hover:text-slate-600 p-1",children:g.jsx(Hn,{size:20})})]}),g.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto mb-4 custom-scrollbar",children:o.length===0?g.jsx("p",{className:"text-slate-500 text-sm text-center py-8 border-2 border-dashed border-slate-200 rounded-lg",children:F.noSaved}):o.map(H=>g.jsxs("button",{onClick:()=>B(H),className:"w-full text-left p-3 hover:bg-emerald-50 rounded-lg border border-slate-100 hover:border-emerald-200 group transition-all",children:[g.jsx("div",{className:"font-medium text-slate-800 group-hover:text-emerald-700",children:H.name}),g.jsx("div",{className:"text-xs text-slate-400 truncate",children:H.description||"No description"})]},H.id))}),g.jsx("button",{onClick:()=>u(!1),className:"w-full py-3 bg-slate-100 text-slate-600 rounded-xl font-medium hover:bg-slate-200 transition-colors",children:F.close})]})})]})},xv=document.getElementById("root");if(!xv)throw new Error("Could not find root element to mount to");const ZF=wu.createRoot(xv);ZF.render(g.jsx(jp.StrictMode,{children:g.jsx(jF,{})}));

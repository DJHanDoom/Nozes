(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function oT(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var U1={exports:{}},Pu={},B1={exports:{}},rt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ll=Symbol.for("react.element"),lT=Symbol.for("react.portal"),cT=Symbol.for("react.fragment"),uT=Symbol.for("react.strict_mode"),fT=Symbol.for("react.profiler"),dT=Symbol.for("react.provider"),hT=Symbol.for("react.context"),pT=Symbol.for("react.forward_ref"),mT=Symbol.for("react.suspense"),xT=Symbol.for("react.memo"),gT=Symbol.for("react.lazy"),Dp=Symbol.iterator;function vT(e){return e===null||typeof e!="object"?null:(e=Dp&&e[Dp]||e["@@iterator"],typeof e=="function"?e:null)}var $1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j1=Object.assign,G1={};function Za(e,t,r){this.props=e,this.context=t,this.refs=G1,this.updater=r||$1}Za.prototype.isReactComponent={};Za.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Za.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function V1(){}V1.prototype=Za.prototype;function I0(e,t,r){this.props=e,this.context=t,this.refs=G1,this.updater=r||$1}var F0=I0.prototype=new V1;F0.constructor=I0;j1(F0,Za.prototype);F0.isPureReactComponent=!0;var Lp=Array.isArray,H1=Object.prototype.hasOwnProperty,R0={current:null},z1={key:!0,ref:!0,__self:!0,__source:!0};function W1(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)H1.call(t,n)&&!z1.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var c=Array(o),l=0;l<o;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Ll,type:e,key:s,ref:a,props:i,_owner:R0.current}}function yT(e,t){return{$$typeof:Ll,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function P0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ll}function wT(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Op=/\/+/g;function df(e,t){return typeof e=="object"&&e!==null&&e.key!=null?wT(""+e.key):t.toString(36)}function Ac(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Ll:case lT:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+df(a,0):n,Lp(i)?(r="",e!=null&&(r=e.replace(Op,"$&/")+"/"),Ac(i,t,r,"",function(l){return l})):i!=null&&(P0(i)&&(i=yT(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Op,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",Lp(e))for(var o=0;o<e.length;o++){s=e[o];var c=n+df(s,o);a+=Ac(s,t,r,c,i)}else if(c=vT(e),typeof c=="function")for(e=c.call(e),o=0;!(s=e.next()).done;)s=s.value,c=n+df(s,o++),a+=Ac(s,t,r,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Ql(e,t,r){if(e==null)return e;var n=[],i=0;return Ac(e,n,"","",function(s){return t.call(r,s,i++)}),n}function ET(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var $r={current:null},bc={transition:null},TT={ReactCurrentDispatcher:$r,ReactCurrentBatchConfig:bc,ReactCurrentOwner:R0};function q1(){throw Error("act(...) is not supported in production builds of React.")}rt.Children={map:Ql,forEach:function(e,t,r){Ql(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Ql(e,function(){t++}),t},toArray:function(e){return Ql(e,function(t){return t})||[]},only:function(e){if(!P0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};rt.Component=Za;rt.Fragment=cT;rt.Profiler=fT;rt.PureComponent=I0;rt.StrictMode=uT;rt.Suspense=mT;rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TT;rt.act=q1;rt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=j1({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=R0.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)H1.call(t,c)&&!z1.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var l=0;l<c;l++)o[l]=arguments[l+2];n.children=o}return{$$typeof:Ll,type:e.type,key:i,ref:s,props:n,_owner:a}};rt.createContext=function(e){return e={$$typeof:hT,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:dT,_context:e},e.Consumer=e};rt.createElement=W1;rt.createFactory=function(e){var t=W1.bind(null,e);return t.type=e,t};rt.createRef=function(){return{current:null}};rt.forwardRef=function(e){return{$$typeof:pT,render:e}};rt.isValidElement=P0;rt.lazy=function(e){return{$$typeof:gT,_payload:{_status:-1,_result:e},_init:ET}};rt.memo=function(e,t){return{$$typeof:xT,type:e,compare:t===void 0?null:t}};rt.startTransition=function(e){var t=bc.transition;bc.transition={};try{e()}finally{bc.transition=t}};rt.unstable_act=q1;rt.useCallback=function(e,t){return $r.current.useCallback(e,t)};rt.useContext=function(e){return $r.current.useContext(e)};rt.useDebugValue=function(){};rt.useDeferredValue=function(e){return $r.current.useDeferredValue(e)};rt.useEffect=function(e,t){return $r.current.useEffect(e,t)};rt.useId=function(){return $r.current.useId()};rt.useImperativeHandle=function(e,t,r){return $r.current.useImperativeHandle(e,t,r)};rt.useInsertionEffect=function(e,t){return $r.current.useInsertionEffect(e,t)};rt.useLayoutEffect=function(e,t){return $r.current.useLayoutEffect(e,t)};rt.useMemo=function(e,t){return $r.current.useMemo(e,t)};rt.useReducer=function(e,t,r){return $r.current.useReducer(e,t,r)};rt.useRef=function(e){return $r.current.useRef(e)};rt.useState=function(e){return $r.current.useState(e)};rt.useSyncExternalStore=function(e,t,r){return $r.current.useSyncExternalStore(e,t,r)};rt.useTransition=function(){return $r.current.useTransition()};rt.version="18.3.1";B1.exports=rt;var ke=B1.exports;const ws=oT(ke);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _T=ke,ST=Symbol.for("react.element"),kT=Symbol.for("react.fragment"),CT=Object.prototype.hasOwnProperty,NT=_T.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,AT={key:!0,ref:!0,__self:!0,__source:!0};function J1(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)CT.call(t,n)&&!AT.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:ST,type:e,key:s,ref:a,props:i,_owner:NT.current}}Pu.Fragment=kT;Pu.jsx=J1;Pu.jsxs=J1;U1.exports=Pu;var f=U1.exports,ld={},K1={exports:{}},hn={},Y1={exports:{}},X1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(oe,J){var de=oe.length;oe.push(J);e:for(;0<de;){var Z=de-1>>>1,R=oe[Z];if(0<i(R,J))oe[Z]=J,oe[de]=R,de=Z;else break e}}function r(oe){return oe.length===0?null:oe[0]}function n(oe){if(oe.length===0)return null;var J=oe[0],de=oe.pop();if(de!==J){oe[0]=de;e:for(var Z=0,R=oe.length,G=R>>>1;Z<G;){var F=2*(Z+1)-1,O=oe[F],X=F+1,he=oe[X];if(0>i(O,de))X<R&&0>i(he,O)?(oe[Z]=he,oe[X]=de,Z=X):(oe[Z]=O,oe[F]=de,Z=F);else if(X<R&&0>i(he,de))oe[Z]=he,oe[X]=de,Z=X;else break e}}return J}function i(oe,J){var de=oe.sortIndex-J.sortIndex;return de!==0?de:oe.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var c=[],l=[],u=1,h=null,m=3,x=!1,g=!1,v=!1,y=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(oe){for(var J=r(l);J!==null;){if(J.callback===null)n(l);else if(J.startTime<=oe)n(l),J.sortIndex=J.expirationTime,t(c,J);else break;J=r(l)}}function k(oe){if(v=!1,T(oe),!g)if(r(c)!==null)g=!0,te(b);else{var J=r(l);J!==null&&ge(k,J.startTime-oe)}}function b(oe,J){g=!1,v&&(v=!1,E(B),B=-1),x=!0;var de=m;try{for(T(J),h=r(c);h!==null&&(!(h.expirationTime>J)||oe&&!Y());){var Z=h.callback;if(typeof Z=="function"){h.callback=null,m=h.priorityLevel;var R=Z(h.expirationTime<=J);J=e.unstable_now(),typeof R=="function"?h.callback=R:h===r(c)&&n(c),T(J)}else n(c);h=r(c)}if(h!==null)var G=!0;else{var F=r(l);F!==null&&ge(k,F.startTime-J),G=!1}return G}finally{h=null,m=de,x=!1}}var I=!1,S=null,B=-1,D=5,H=-1;function Y(){return!(e.unstable_now()-H<D)}function q(){if(S!==null){var oe=e.unstable_now();H=oe;var J=!0;try{J=S(!0,oe)}finally{J?ue():(I=!1,S=null)}}else I=!1}var ue;if(typeof w=="function")ue=function(){w(q)};else if(typeof MessageChannel<"u"){var Te=new MessageChannel,W=Te.port2;Te.port1.onmessage=q,ue=function(){W.postMessage(null)}}else ue=function(){y(q,0)};function te(oe){S=oe,I||(I=!0,ue())}function ge(oe,J){B=y(function(){oe(e.unstable_now())},J)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(oe){oe.callback=null},e.unstable_continueExecution=function(){g||x||(g=!0,te(b))},e.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<oe?Math.floor(1e3/oe):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(oe){switch(m){case 1:case 2:case 3:var J=3;break;default:J=m}var de=m;m=J;try{return oe()}finally{m=de}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(oe,J){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var de=m;m=oe;try{return J()}finally{m=de}},e.unstable_scheduleCallback=function(oe,J,de){var Z=e.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?Z+de:Z):de=Z,oe){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=de+R,oe={id:u++,callback:J,priorityLevel:oe,startTime:de,expirationTime:R,sortIndex:-1},de>Z?(oe.sortIndex=de,t(l,oe),r(c)===null&&oe===r(l)&&(v?(E(B),B=-1):v=!0,ge(k,de-Z))):(oe.sortIndex=R,t(c,oe),g||x||(g=!0,te(b))),oe},e.unstable_shouldYield=Y,e.unstable_wrapCallback=function(oe){var J=m;return function(){var de=m;m=J;try{return oe.apply(this,arguments)}finally{m=de}}}})(X1);Y1.exports=X1;var bT=Y1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IT=ke,fn=bT;function _e(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Q1=new Set,il={};function qs(e,t){Ga(e,t),Ga(e+"Capture",t)}function Ga(e,t){for(il[e]=t,e=0;e<t.length;e++)Q1.add(t[e])}var Ei=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cd=Object.prototype.hasOwnProperty,FT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Up={},Bp={};function RT(e){return cd.call(Bp,e)?!0:cd.call(Up,e)?!1:FT.test(e)?Bp[e]=!0:(Up[e]=!0,!1)}function PT(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function MT(e,t,r,n){if(t===null||typeof t>"u"||PT(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function jr(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var yr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){yr[e]=new jr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];yr[t]=new jr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){yr[e]=new jr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){yr[e]=new jr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){yr[e]=new jr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){yr[e]=new jr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){yr[e]=new jr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){yr[e]=new jr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){yr[e]=new jr(e,5,!1,e.toLowerCase(),null,!1,!1)});var M0=/[\-:]([a-z])/g;function D0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(M0,D0);yr[t]=new jr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(M0,D0);yr[t]=new jr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(M0,D0);yr[t]=new jr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){yr[e]=new jr(e,1,!1,e.toLowerCase(),null,!1,!1)});yr.xlinkHref=new jr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){yr[e]=new jr(e,1,!1,e.toLowerCase(),null,!0,!0)});function L0(e,t,r,n){var i=yr.hasOwnProperty(t)?yr[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(MT(t,r,i,n)&&(r=null),n||i===null?RT(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ni=IT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zl=Symbol.for("react.element"),da=Symbol.for("react.portal"),ha=Symbol.for("react.fragment"),O0=Symbol.for("react.strict_mode"),ud=Symbol.for("react.profiler"),Z1=Symbol.for("react.provider"),ev=Symbol.for("react.context"),U0=Symbol.for("react.forward_ref"),fd=Symbol.for("react.suspense"),dd=Symbol.for("react.suspense_list"),B0=Symbol.for("react.memo"),ji=Symbol.for("react.lazy"),tv=Symbol.for("react.offscreen"),$p=Symbol.iterator;function go(e){return e===null||typeof e!="object"?null:(e=$p&&e[$p]||e["@@iterator"],typeof e=="function"?e:null)}var Ot=Object.assign,hf;function bo(e){if(hf===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);hf=t&&t[1]||""}return`
`+hf+e}var pf=!1;function mf(e,t){if(!e||pf)return"";pf=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var n=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){n=l}e.call(t.prototype)}else{try{throw Error()}catch(l){n=l}e()}}catch(l){if(l&&n&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var c=`
`+i[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=o);break}}}finally{pf=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?bo(e):""}function DT(e){switch(e.tag){case 5:return bo(e.type);case 16:return bo("Lazy");case 13:return bo("Suspense");case 19:return bo("SuspenseList");case 0:case 2:case 15:return e=mf(e.type,!1),e;case 11:return e=mf(e.type.render,!1),e;case 1:return e=mf(e.type,!0),e;default:return""}}function hd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ha:return"Fragment";case da:return"Portal";case ud:return"Profiler";case O0:return"StrictMode";case fd:return"Suspense";case dd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ev:return(e.displayName||"Context")+".Consumer";case Z1:return(e._context.displayName||"Context")+".Provider";case U0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case B0:return t=e.displayName||null,t!==null?t:hd(e.type)||"Memo";case ji:t=e._payload,e=e._init;try{return hd(e(t))}catch{}}return null}function LT(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return hd(t);case 8:return t===O0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ns(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function rv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function OT(e){var t=rv(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ec(e){e._valueTracker||(e._valueTracker=OT(e))}function nv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=rv(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Gc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function pd(e,t){var r=t.checked;return Ot({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function jp(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ns(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function iv(e,t){t=t.checked,t!=null&&L0(e,"checked",t,!1)}function md(e,t){iv(e,t);var r=ns(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?xd(e,t.type,r):t.hasOwnProperty("defaultValue")&&xd(e,t.type,ns(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Gp(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function xd(e,t,r){(t!=="number"||Gc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Io=Array.isArray;function Aa(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ns(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function gd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(_e(91));return Ot({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Vp(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(_e(92));if(Io(r)){if(1<r.length)throw Error(_e(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ns(r)}}function sv(e,t){var r=ns(t.value),n=ns(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Hp(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function av(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?av(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var tc,ov=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(tc=tc||document.createElement("div"),tc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=tc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function sl(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Oo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},UT=["Webkit","ms","Moz","O"];Object.keys(Oo).forEach(function(e){UT.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Oo[t]=Oo[e]})});function lv(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Oo.hasOwnProperty(e)&&Oo[e]?(""+t).trim():t+"px"}function cv(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=lv(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var BT=Ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yd(e,t){if(t){if(BT[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(_e(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(_e(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(_e(61))}if(t.style!=null&&typeof t.style!="object")throw Error(_e(62))}}function wd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ed=null;function $0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Td=null,ba=null,Ia=null;function zp(e){if(e=Bl(e)){if(typeof Td!="function")throw Error(_e(280));var t=e.stateNode;t&&(t=Uu(t),Td(e.stateNode,e.type,t))}}function uv(e){ba?Ia?Ia.push(e):Ia=[e]:ba=e}function fv(){if(ba){var e=ba,t=Ia;if(Ia=ba=null,zp(e),t)for(e=0;e<t.length;e++)zp(t[e])}}function dv(e,t){return e(t)}function hv(){}var xf=!1;function pv(e,t,r){if(xf)return e(t,r);xf=!0;try{return dv(e,t,r)}finally{xf=!1,(ba!==null||Ia!==null)&&(hv(),fv())}}function al(e,t){var r=e.stateNode;if(r===null)return null;var n=Uu(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(_e(231,t,typeof r));return r}var _d=!1;if(Ei)try{var vo={};Object.defineProperty(vo,"passive",{get:function(){_d=!0}}),window.addEventListener("test",vo,vo),window.removeEventListener("test",vo,vo)}catch{_d=!1}function $T(e,t,r,n,i,s,a,o,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(r,l)}catch(u){this.onError(u)}}var Uo=!1,Vc=null,Hc=!1,Sd=null,jT={onError:function(e){Uo=!0,Vc=e}};function GT(e,t,r,n,i,s,a,o,c){Uo=!1,Vc=null,$T.apply(jT,arguments)}function VT(e,t,r,n,i,s,a,o,c){if(GT.apply(this,arguments),Uo){if(Uo){var l=Vc;Uo=!1,Vc=null}else throw Error(_e(198));Hc||(Hc=!0,Sd=l)}}function Js(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function mv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Wp(e){if(Js(e)!==e)throw Error(_e(188))}function HT(e){var t=e.alternate;if(!t){if(t=Js(e),t===null)throw Error(_e(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Wp(i),e;if(s===n)return Wp(i),t;s=s.sibling}throw Error(_e(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(_e(189))}}if(r.alternate!==n)throw Error(_e(190))}if(r.tag!==3)throw Error(_e(188));return r.stateNode.current===r?e:t}function xv(e){return e=HT(e),e!==null?gv(e):null}function gv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=gv(e);if(t!==null)return t;e=e.sibling}return null}var vv=fn.unstable_scheduleCallback,qp=fn.unstable_cancelCallback,zT=fn.unstable_shouldYield,WT=fn.unstable_requestPaint,Ht=fn.unstable_now,qT=fn.unstable_getCurrentPriorityLevel,j0=fn.unstable_ImmediatePriority,yv=fn.unstable_UserBlockingPriority,zc=fn.unstable_NormalPriority,JT=fn.unstable_LowPriority,wv=fn.unstable_IdlePriority,Mu=null,ai=null;function KT(e){if(ai&&typeof ai.onCommitFiberRoot=="function")try{ai.onCommitFiberRoot(Mu,e,void 0,(e.current.flags&128)===128)}catch{}}var Gn=Math.clz32?Math.clz32:QT,YT=Math.log,XT=Math.LN2;function QT(e){return e>>>=0,e===0?32:31-(YT(e)/XT|0)|0}var rc=64,nc=4194304;function Fo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Wc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Fo(o):(s&=a,s!==0&&(n=Fo(s)))}else a=r&~i,a!==0?n=Fo(a):s!==0&&(n=Fo(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Gn(t),i=1<<r,n|=e[r],t&=~i;return n}function ZT(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function e_(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-Gn(s),o=1<<a,c=i[a];c===-1?(!(o&r)||o&n)&&(i[a]=ZT(o,t)):c<=t&&(e.expiredLanes|=o),s&=~o}}function kd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ev(){var e=rc;return rc<<=1,!(rc&4194240)&&(rc=64),e}function gf(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ol(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Gn(t),e[t]=r}function t_(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Gn(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function G0(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Gn(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var gt=0;function Tv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var _v,V0,Sv,kv,Cv,Cd=!1,ic=[],Ki=null,Yi=null,Xi=null,ol=new Map,ll=new Map,Vi=[],r_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Jp(e,t){switch(e){case"focusin":case"focusout":Ki=null;break;case"dragenter":case"dragleave":Yi=null;break;case"mouseover":case"mouseout":Xi=null;break;case"pointerover":case"pointerout":ol.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ll.delete(t.pointerId)}}function yo(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Bl(t),t!==null&&V0(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function n_(e,t,r,n,i){switch(t){case"focusin":return Ki=yo(Ki,e,t,r,n,i),!0;case"dragenter":return Yi=yo(Yi,e,t,r,n,i),!0;case"mouseover":return Xi=yo(Xi,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return ol.set(s,yo(ol.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,ll.set(s,yo(ll.get(s)||null,e,t,r,n,i)),!0}return!1}function Nv(e){var t=ks(e.target);if(t!==null){var r=Js(t);if(r!==null){if(t=r.tag,t===13){if(t=mv(r),t!==null){e.blockedOn=t,Cv(e.priority,function(){Sv(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ic(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Nd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Ed=n,r.target.dispatchEvent(n),Ed=null}else return t=Bl(r),t!==null&&V0(t),e.blockedOn=r,!1;t.shift()}return!0}function Kp(e,t,r){Ic(e)&&r.delete(t)}function i_(){Cd=!1,Ki!==null&&Ic(Ki)&&(Ki=null),Yi!==null&&Ic(Yi)&&(Yi=null),Xi!==null&&Ic(Xi)&&(Xi=null),ol.forEach(Kp),ll.forEach(Kp)}function wo(e,t){e.blockedOn===t&&(e.blockedOn=null,Cd||(Cd=!0,fn.unstable_scheduleCallback(fn.unstable_NormalPriority,i_)))}function cl(e){function t(i){return wo(i,e)}if(0<ic.length){wo(ic[0],e);for(var r=1;r<ic.length;r++){var n=ic[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ki!==null&&wo(Ki,e),Yi!==null&&wo(Yi,e),Xi!==null&&wo(Xi,e),ol.forEach(t),ll.forEach(t),r=0;r<Vi.length;r++)n=Vi[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Vi.length&&(r=Vi[0],r.blockedOn===null);)Nv(r),r.blockedOn===null&&Vi.shift()}var Fa=Ni.ReactCurrentBatchConfig,qc=!0;function s_(e,t,r,n){var i=gt,s=Fa.transition;Fa.transition=null;try{gt=1,H0(e,t,r,n)}finally{gt=i,Fa.transition=s}}function a_(e,t,r,n){var i=gt,s=Fa.transition;Fa.transition=null;try{gt=4,H0(e,t,r,n)}finally{gt=i,Fa.transition=s}}function H0(e,t,r,n){if(qc){var i=Nd(e,t,r,n);if(i===null)Nf(e,t,n,Jc,r),Jp(e,n);else if(n_(i,e,t,r,n))n.stopPropagation();else if(Jp(e,n),t&4&&-1<r_.indexOf(e)){for(;i!==null;){var s=Bl(i);if(s!==null&&_v(s),s=Nd(e,t,r,n),s===null&&Nf(e,t,n,Jc,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Nf(e,t,n,null,r)}}var Jc=null;function Nd(e,t,r,n){if(Jc=null,e=$0(n),e=ks(e),e!==null)if(t=Js(e),t===null)e=null;else if(r=t.tag,r===13){if(e=mv(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jc=e,null}function Av(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qT()){case j0:return 1;case yv:return 4;case zc:case JT:return 16;case wv:return 536870912;default:return 16}default:return 16}}var zi=null,z0=null,Fc=null;function bv(){if(Fc)return Fc;var e,t=z0,r=t.length,n,i="value"in zi?zi.value:zi.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return Fc=i.slice(e,1<n?1-n:void 0)}function Rc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function sc(){return!0}function Yp(){return!1}function pn(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?sc:Yp,this.isPropagationStopped=Yp,this}return Ot(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=sc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=sc)},persist:function(){},isPersistent:sc}),t}var eo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},W0=pn(eo),Ul=Ot({},eo,{view:0,detail:0}),o_=pn(Ul),vf,yf,Eo,Du=Ot({},Ul,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:q0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Eo&&(Eo&&e.type==="mousemove"?(vf=e.screenX-Eo.screenX,yf=e.screenY-Eo.screenY):yf=vf=0,Eo=e),vf)},movementY:function(e){return"movementY"in e?e.movementY:yf}}),Xp=pn(Du),l_=Ot({},Du,{dataTransfer:0}),c_=pn(l_),u_=Ot({},Ul,{relatedTarget:0}),wf=pn(u_),f_=Ot({},eo,{animationName:0,elapsedTime:0,pseudoElement:0}),d_=pn(f_),h_=Ot({},eo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),p_=pn(h_),m_=Ot({},eo,{data:0}),Qp=pn(m_),x_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},g_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},v_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function y_(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=v_[e])?!!t[e]:!1}function q0(){return y_}var w_=Ot({},Ul,{key:function(e){if(e.key){var t=x_[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Rc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?g_[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:q0,charCode:function(e){return e.type==="keypress"?Rc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Rc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),E_=pn(w_),T_=Ot({},Du,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zp=pn(T_),__=Ot({},Ul,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:q0}),S_=pn(__),k_=Ot({},eo,{propertyName:0,elapsedTime:0,pseudoElement:0}),C_=pn(k_),N_=Ot({},Du,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),A_=pn(N_),b_=[9,13,27,32],J0=Ei&&"CompositionEvent"in window,Bo=null;Ei&&"documentMode"in document&&(Bo=document.documentMode);var I_=Ei&&"TextEvent"in window&&!Bo,Iv=Ei&&(!J0||Bo&&8<Bo&&11>=Bo),em=" ",tm=!1;function Fv(e,t){switch(e){case"keyup":return b_.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var pa=!1;function F_(e,t){switch(e){case"compositionend":return Rv(t);case"keypress":return t.which!==32?null:(tm=!0,em);case"textInput":return e=t.data,e===em&&tm?null:e;default:return null}}function R_(e,t){if(pa)return e==="compositionend"||!J0&&Fv(e,t)?(e=bv(),Fc=z0=zi=null,pa=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Iv&&t.locale!=="ko"?null:t.data;default:return null}}var P_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!P_[e.type]:t==="textarea"}function Pv(e,t,r,n){uv(n),t=Kc(t,"onChange"),0<t.length&&(r=new W0("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var $o=null,ul=null;function M_(e){Hv(e,0)}function Lu(e){var t=ga(e);if(nv(t))return e}function D_(e,t){if(e==="change")return t}var Mv=!1;if(Ei){var Ef;if(Ei){var Tf="oninput"in document;if(!Tf){var nm=document.createElement("div");nm.setAttribute("oninput","return;"),Tf=typeof nm.oninput=="function"}Ef=Tf}else Ef=!1;Mv=Ef&&(!document.documentMode||9<document.documentMode)}function im(){$o&&($o.detachEvent("onpropertychange",Dv),ul=$o=null)}function Dv(e){if(e.propertyName==="value"&&Lu(ul)){var t=[];Pv(t,ul,e,$0(e)),pv(M_,t)}}function L_(e,t,r){e==="focusin"?(im(),$o=t,ul=r,$o.attachEvent("onpropertychange",Dv)):e==="focusout"&&im()}function O_(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Lu(ul)}function U_(e,t){if(e==="click")return Lu(t)}function B_(e,t){if(e==="input"||e==="change")return Lu(t)}function $_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var qn=typeof Object.is=="function"?Object.is:$_;function fl(e,t){if(qn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!cd.call(t,i)||!qn(e[i],t[i]))return!1}return!0}function sm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function am(e,t){var r=sm(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=sm(r)}}function Lv(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Lv(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ov(){for(var e=window,t=Gc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Gc(e.document)}return t}function K0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function j_(e){var t=Ov(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Lv(r.ownerDocument.documentElement,r)){if(n!==null&&K0(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=am(r,s);var a=am(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var G_=Ei&&"documentMode"in document&&11>=document.documentMode,ma=null,Ad=null,jo=null,bd=!1;function om(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;bd||ma==null||ma!==Gc(n)||(n=ma,"selectionStart"in n&&K0(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),jo&&fl(jo,n)||(jo=n,n=Kc(Ad,"onSelect"),0<n.length&&(t=new W0("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ma)))}function ac(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var xa={animationend:ac("Animation","AnimationEnd"),animationiteration:ac("Animation","AnimationIteration"),animationstart:ac("Animation","AnimationStart"),transitionend:ac("Transition","TransitionEnd")},_f={},Uv={};Ei&&(Uv=document.createElement("div").style,"AnimationEvent"in window||(delete xa.animationend.animation,delete xa.animationiteration.animation,delete xa.animationstart.animation),"TransitionEvent"in window||delete xa.transitionend.transition);function Ou(e){if(_f[e])return _f[e];if(!xa[e])return e;var t=xa[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Uv)return _f[e]=t[r];return e}var Bv=Ou("animationend"),$v=Ou("animationiteration"),jv=Ou("animationstart"),Gv=Ou("transitionend"),Vv=new Map,lm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cs(e,t){Vv.set(e,t),qs(t,[e])}for(var Sf=0;Sf<lm.length;Sf++){var kf=lm[Sf],V_=kf.toLowerCase(),H_=kf[0].toUpperCase()+kf.slice(1);cs(V_,"on"+H_)}cs(Bv,"onAnimationEnd");cs($v,"onAnimationIteration");cs(jv,"onAnimationStart");cs("dblclick","onDoubleClick");cs("focusin","onFocus");cs("focusout","onBlur");cs(Gv,"onTransitionEnd");Ga("onMouseEnter",["mouseout","mouseover"]);Ga("onMouseLeave",["mouseout","mouseover"]);Ga("onPointerEnter",["pointerout","pointerover"]);Ga("onPointerLeave",["pointerout","pointerover"]);qs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));qs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));qs("onBeforeInput",["compositionend","keypress","textInput","paste"]);qs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));qs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));qs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ro="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),z_=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ro));function cm(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,VT(n,t,void 0,e),e.currentTarget=null}function Hv(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],c=o.instance,l=o.currentTarget;if(o=o.listener,c!==s&&i.isPropagationStopped())break e;cm(i,o,l),s=c}else for(a=0;a<n.length;a++){if(o=n[a],c=o.instance,l=o.currentTarget,o=o.listener,c!==s&&i.isPropagationStopped())break e;cm(i,o,l),s=c}}}if(Hc)throw e=Sd,Hc=!1,Sd=null,e}function St(e,t){var r=t[Md];r===void 0&&(r=t[Md]=new Set);var n=e+"__bubble";r.has(n)||(zv(t,e,2,!1),r.add(n))}function Cf(e,t,r){var n=0;t&&(n|=4),zv(r,e,n,t)}var oc="_reactListening"+Math.random().toString(36).slice(2);function dl(e){if(!e[oc]){e[oc]=!0,Q1.forEach(function(r){r!=="selectionchange"&&(z_.has(r)||Cf(r,!1,e),Cf(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[oc]||(t[oc]=!0,Cf("selectionchange",!1,t))}}function zv(e,t,r,n){switch(Av(t)){case 1:var i=s_;break;case 4:i=a_;break;default:i=H0}r=i.bind(null,t,r,e),i=void 0,!_d||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Nf(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;a=a.return}for(;o!==null;){if(a=ks(o),a===null)return;if(c=a.tag,c===5||c===6){n=s=a;continue e}o=o.parentNode}}n=n.return}pv(function(){var l=s,u=$0(r),h=[];e:{var m=Vv.get(e);if(m!==void 0){var x=W0,g=e;switch(e){case"keypress":if(Rc(r)===0)break e;case"keydown":case"keyup":x=E_;break;case"focusin":g="focus",x=wf;break;case"focusout":g="blur",x=wf;break;case"beforeblur":case"afterblur":x=wf;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Xp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=c_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=S_;break;case Bv:case $v:case jv:x=d_;break;case Gv:x=C_;break;case"scroll":x=o_;break;case"wheel":x=A_;break;case"copy":case"cut":case"paste":x=p_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Zp}var v=(t&4)!==0,y=!v&&e==="scroll",E=v?m!==null?m+"Capture":null:m;v=[];for(var w=l,T;w!==null;){T=w;var k=T.stateNode;if(T.tag===5&&k!==null&&(T=k,E!==null&&(k=al(w,E),k!=null&&v.push(hl(w,k,T)))),y)break;w=w.return}0<v.length&&(m=new x(m,g,null,r,u),h.push({event:m,listeners:v}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",m&&r!==Ed&&(g=r.relatedTarget||r.fromElement)&&(ks(g)||g[Ti]))break e;if((x||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,x?(g=r.relatedTarget||r.toElement,x=l,g=g?ks(g):null,g!==null&&(y=Js(g),g!==y||g.tag!==5&&g.tag!==6)&&(g=null)):(x=null,g=l),x!==g)){if(v=Xp,k="onMouseLeave",E="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(v=Zp,k="onPointerLeave",E="onPointerEnter",w="pointer"),y=x==null?m:ga(x),T=g==null?m:ga(g),m=new v(k,w+"leave",x,r,u),m.target=y,m.relatedTarget=T,k=null,ks(u)===l&&(v=new v(E,w+"enter",g,r,u),v.target=T,v.relatedTarget=y,k=v),y=k,x&&g)t:{for(v=x,E=g,w=0,T=v;T;T=oa(T))w++;for(T=0,k=E;k;k=oa(k))T++;for(;0<w-T;)v=oa(v),w--;for(;0<T-w;)E=oa(E),T--;for(;w--;){if(v===E||E!==null&&v===E.alternate)break t;v=oa(v),E=oa(E)}v=null}else v=null;x!==null&&um(h,m,x,v,!1),g!==null&&y!==null&&um(h,y,g,v,!0)}}e:{if(m=l?ga(l):window,x=m.nodeName&&m.nodeName.toLowerCase(),x==="select"||x==="input"&&m.type==="file")var b=D_;else if(rm(m))if(Mv)b=B_;else{b=O_;var I=L_}else(x=m.nodeName)&&x.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(b=U_);if(b&&(b=b(e,l))){Pv(h,b,r,u);break e}I&&I(e,m,l),e==="focusout"&&(I=m._wrapperState)&&I.controlled&&m.type==="number"&&xd(m,"number",m.value)}switch(I=l?ga(l):window,e){case"focusin":(rm(I)||I.contentEditable==="true")&&(ma=I,Ad=l,jo=null);break;case"focusout":jo=Ad=ma=null;break;case"mousedown":bd=!0;break;case"contextmenu":case"mouseup":case"dragend":bd=!1,om(h,r,u);break;case"selectionchange":if(G_)break;case"keydown":case"keyup":om(h,r,u)}var S;if(J0)e:{switch(e){case"compositionstart":var B="onCompositionStart";break e;case"compositionend":B="onCompositionEnd";break e;case"compositionupdate":B="onCompositionUpdate";break e}B=void 0}else pa?Fv(e,r)&&(B="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(B="onCompositionStart");B&&(Iv&&r.locale!=="ko"&&(pa||B!=="onCompositionStart"?B==="onCompositionEnd"&&pa&&(S=bv()):(zi=u,z0="value"in zi?zi.value:zi.textContent,pa=!0)),I=Kc(l,B),0<I.length&&(B=new Qp(B,e,null,r,u),h.push({event:B,listeners:I}),S?B.data=S:(S=Rv(r),S!==null&&(B.data=S)))),(S=I_?F_(e,r):R_(e,r))&&(l=Kc(l,"onBeforeInput"),0<l.length&&(u=new Qp("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:l}),u.data=S))}Hv(h,t)})}function hl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Kc(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=al(e,r),s!=null&&n.unshift(hl(e,s,i)),s=al(e,t),s!=null&&n.push(hl(e,s,i))),e=e.return}return n}function oa(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function um(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var o=r,c=o.alternate,l=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&l!==null&&(o=l,i?(c=al(r,s),c!=null&&a.unshift(hl(r,c,o))):i||(c=al(r,s),c!=null&&a.push(hl(r,c,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var W_=/\r\n?/g,q_=/\u0000|\uFFFD/g;function fm(e){return(typeof e=="string"?e:""+e).replace(W_,`
`).replace(q_,"")}function lc(e,t,r){if(t=fm(t),fm(e)!==t&&r)throw Error(_e(425))}function Yc(){}var Id=null,Fd=null;function Rd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Pd=typeof setTimeout=="function"?setTimeout:void 0,J_=typeof clearTimeout=="function"?clearTimeout:void 0,dm=typeof Promise=="function"?Promise:void 0,K_=typeof queueMicrotask=="function"?queueMicrotask:typeof dm<"u"?function(e){return dm.resolve(null).then(e).catch(Y_)}:Pd;function Y_(e){setTimeout(function(){throw e})}function Af(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),cl(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);cl(t)}function Qi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function hm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var to=Math.random().toString(36).slice(2),ii="__reactFiber$"+to,pl="__reactProps$"+to,Ti="__reactContainer$"+to,Md="__reactEvents$"+to,X_="__reactListeners$"+to,Q_="__reactHandles$"+to;function ks(e){var t=e[ii];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ti]||r[ii]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=hm(e);e!==null;){if(r=e[ii])return r;e=hm(e)}return t}e=r,r=e.parentNode}return null}function Bl(e){return e=e[ii]||e[Ti],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ga(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(_e(33))}function Uu(e){return e[pl]||null}var Dd=[],va=-1;function us(e){return{current:e}}function Nt(e){0>va||(e.current=Dd[va],Dd[va]=null,va--)}function Tt(e,t){va++,Dd[va]=e.current,e.current=t}var is={},Fr=us(is),Yr=us(!1),Ls=is;function Va(e,t){var r=e.type.contextTypes;if(!r)return is;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Xr(e){return e=e.childContextTypes,e!=null}function Xc(){Nt(Yr),Nt(Fr)}function pm(e,t,r){if(Fr.current!==is)throw Error(_e(168));Tt(Fr,t),Tt(Yr,r)}function Wv(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(_e(108,LT(e)||"Unknown",i));return Ot({},r,n)}function Qc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||is,Ls=Fr.current,Tt(Fr,e),Tt(Yr,Yr.current),!0}function mm(e,t,r){var n=e.stateNode;if(!n)throw Error(_e(169));r?(e=Wv(e,t,Ls),n.__reactInternalMemoizedMergedChildContext=e,Nt(Yr),Nt(Fr),Tt(Fr,e)):Nt(Yr),Tt(Yr,r)}var hi=null,Bu=!1,bf=!1;function qv(e){hi===null?hi=[e]:hi.push(e)}function Z_(e){Bu=!0,qv(e)}function fs(){if(!bf&&hi!==null){bf=!0;var e=0,t=gt;try{var r=hi;for(gt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}hi=null,Bu=!1}catch(i){throw hi!==null&&(hi=hi.slice(e+1)),vv(j0,fs),i}finally{gt=t,bf=!1}}return null}var ya=[],wa=0,Zc=null,eu=0,_n=[],Sn=0,Os=null,pi=1,mi="";function Es(e,t){ya[wa++]=eu,ya[wa++]=Zc,Zc=e,eu=t}function Jv(e,t,r){_n[Sn++]=pi,_n[Sn++]=mi,_n[Sn++]=Os,Os=e;var n=pi;e=mi;var i=32-Gn(n)-1;n&=~(1<<i),r+=1;var s=32-Gn(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,pi=1<<32-Gn(t)+i|r<<i|n,mi=s+e}else pi=1<<s|r<<i|n,mi=e}function Y0(e){e.return!==null&&(Es(e,1),Jv(e,1,0))}function X0(e){for(;e===Zc;)Zc=ya[--wa],ya[wa]=null,eu=ya[--wa],ya[wa]=null;for(;e===Os;)Os=_n[--Sn],_n[Sn]=null,mi=_n[--Sn],_n[Sn]=null,pi=_n[--Sn],_n[Sn]=null}var un=null,cn=null,Ft=!1,Bn=null;function Kv(e,t){var r=kn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function xm(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,un=e,cn=Qi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,un=e,cn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Os!==null?{id:pi,overflow:mi}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=kn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,un=e,cn=null,!0):!1;default:return!1}}function Ld(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Od(e){if(Ft){var t=cn;if(t){var r=t;if(!xm(e,t)){if(Ld(e))throw Error(_e(418));t=Qi(r.nextSibling);var n=un;t&&xm(e,t)?Kv(n,r):(e.flags=e.flags&-4097|2,Ft=!1,un=e)}}else{if(Ld(e))throw Error(_e(418));e.flags=e.flags&-4097|2,Ft=!1,un=e}}}function gm(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;un=e}function cc(e){if(e!==un)return!1;if(!Ft)return gm(e),Ft=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Rd(e.type,e.memoizedProps)),t&&(t=cn)){if(Ld(e))throw Yv(),Error(_e(418));for(;t;)Kv(e,t),t=Qi(t.nextSibling)}if(gm(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(_e(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){cn=Qi(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}cn=null}}else cn=un?Qi(e.stateNode.nextSibling):null;return!0}function Yv(){for(var e=cn;e;)e=Qi(e.nextSibling)}function Ha(){cn=un=null,Ft=!1}function Q0(e){Bn===null?Bn=[e]:Bn.push(e)}var eS=Ni.ReactCurrentBatchConfig;function To(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(_e(309));var n=r.stateNode}if(!n)throw Error(_e(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(_e(284));if(!r._owner)throw Error(_e(290,e))}return e}function uc(e,t){throw e=Object.prototype.toString.call(t),Error(_e(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vm(e){var t=e._init;return t(e._payload)}function Xv(e){function t(E,w){if(e){var T=E.deletions;T===null?(E.deletions=[w],E.flags|=16):T.push(w)}}function r(E,w){if(!e)return null;for(;w!==null;)t(E,w),w=w.sibling;return null}function n(E,w){for(E=new Map;w!==null;)w.key!==null?E.set(w.key,w):E.set(w.index,w),w=w.sibling;return E}function i(E,w){return E=rs(E,w),E.index=0,E.sibling=null,E}function s(E,w,T){return E.index=T,e?(T=E.alternate,T!==null?(T=T.index,T<w?(E.flags|=2,w):T):(E.flags|=2,w)):(E.flags|=1048576,w)}function a(E){return e&&E.alternate===null&&(E.flags|=2),E}function o(E,w,T,k){return w===null||w.tag!==6?(w=Lf(T,E.mode,k),w.return=E,w):(w=i(w,T),w.return=E,w)}function c(E,w,T,k){var b=T.type;return b===ha?u(E,w,T.props.children,k,T.key):w!==null&&(w.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ji&&vm(b)===w.type)?(k=i(w,T.props),k.ref=To(E,w,T),k.return=E,k):(k=Bc(T.type,T.key,T.props,null,E.mode,k),k.ref=To(E,w,T),k.return=E,k)}function l(E,w,T,k){return w===null||w.tag!==4||w.stateNode.containerInfo!==T.containerInfo||w.stateNode.implementation!==T.implementation?(w=Of(T,E.mode,k),w.return=E,w):(w=i(w,T.children||[]),w.return=E,w)}function u(E,w,T,k,b){return w===null||w.tag!==7?(w=Fs(T,E.mode,k,b),w.return=E,w):(w=i(w,T),w.return=E,w)}function h(E,w,T){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Lf(""+w,E.mode,T),w.return=E,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Zl:return T=Bc(w.type,w.key,w.props,null,E.mode,T),T.ref=To(E,null,w),T.return=E,T;case da:return w=Of(w,E.mode,T),w.return=E,w;case ji:var k=w._init;return h(E,k(w._payload),T)}if(Io(w)||go(w))return w=Fs(w,E.mode,T,null),w.return=E,w;uc(E,w)}return null}function m(E,w,T,k){var b=w!==null?w.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return b!==null?null:o(E,w,""+T,k);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Zl:return T.key===b?c(E,w,T,k):null;case da:return T.key===b?l(E,w,T,k):null;case ji:return b=T._init,m(E,w,b(T._payload),k)}if(Io(T)||go(T))return b!==null?null:u(E,w,T,k,null);uc(E,T)}return null}function x(E,w,T,k,b){if(typeof k=="string"&&k!==""||typeof k=="number")return E=E.get(T)||null,o(w,E,""+k,b);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Zl:return E=E.get(k.key===null?T:k.key)||null,c(w,E,k,b);case da:return E=E.get(k.key===null?T:k.key)||null,l(w,E,k,b);case ji:var I=k._init;return x(E,w,T,I(k._payload),b)}if(Io(k)||go(k))return E=E.get(T)||null,u(w,E,k,b,null);uc(w,k)}return null}function g(E,w,T,k){for(var b=null,I=null,S=w,B=w=0,D=null;S!==null&&B<T.length;B++){S.index>B?(D=S,S=null):D=S.sibling;var H=m(E,S,T[B],k);if(H===null){S===null&&(S=D);break}e&&S&&H.alternate===null&&t(E,S),w=s(H,w,B),I===null?b=H:I.sibling=H,I=H,S=D}if(B===T.length)return r(E,S),Ft&&Es(E,B),b;if(S===null){for(;B<T.length;B++)S=h(E,T[B],k),S!==null&&(w=s(S,w,B),I===null?b=S:I.sibling=S,I=S);return Ft&&Es(E,B),b}for(S=n(E,S);B<T.length;B++)D=x(S,E,B,T[B],k),D!==null&&(e&&D.alternate!==null&&S.delete(D.key===null?B:D.key),w=s(D,w,B),I===null?b=D:I.sibling=D,I=D);return e&&S.forEach(function(Y){return t(E,Y)}),Ft&&Es(E,B),b}function v(E,w,T,k){var b=go(T);if(typeof b!="function")throw Error(_e(150));if(T=b.call(T),T==null)throw Error(_e(151));for(var I=b=null,S=w,B=w=0,D=null,H=T.next();S!==null&&!H.done;B++,H=T.next()){S.index>B?(D=S,S=null):D=S.sibling;var Y=m(E,S,H.value,k);if(Y===null){S===null&&(S=D);break}e&&S&&Y.alternate===null&&t(E,S),w=s(Y,w,B),I===null?b=Y:I.sibling=Y,I=Y,S=D}if(H.done)return r(E,S),Ft&&Es(E,B),b;if(S===null){for(;!H.done;B++,H=T.next())H=h(E,H.value,k),H!==null&&(w=s(H,w,B),I===null?b=H:I.sibling=H,I=H);return Ft&&Es(E,B),b}for(S=n(E,S);!H.done;B++,H=T.next())H=x(S,E,B,H.value,k),H!==null&&(e&&H.alternate!==null&&S.delete(H.key===null?B:H.key),w=s(H,w,B),I===null?b=H:I.sibling=H,I=H);return e&&S.forEach(function(q){return t(E,q)}),Ft&&Es(E,B),b}function y(E,w,T,k){if(typeof T=="object"&&T!==null&&T.type===ha&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Zl:e:{for(var b=T.key,I=w;I!==null;){if(I.key===b){if(b=T.type,b===ha){if(I.tag===7){r(E,I.sibling),w=i(I,T.props.children),w.return=E,E=w;break e}}else if(I.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ji&&vm(b)===I.type){r(E,I.sibling),w=i(I,T.props),w.ref=To(E,I,T),w.return=E,E=w;break e}r(E,I);break}else t(E,I);I=I.sibling}T.type===ha?(w=Fs(T.props.children,E.mode,k,T.key),w.return=E,E=w):(k=Bc(T.type,T.key,T.props,null,E.mode,k),k.ref=To(E,w,T),k.return=E,E=k)}return a(E);case da:e:{for(I=T.key;w!==null;){if(w.key===I)if(w.tag===4&&w.stateNode.containerInfo===T.containerInfo&&w.stateNode.implementation===T.implementation){r(E,w.sibling),w=i(w,T.children||[]),w.return=E,E=w;break e}else{r(E,w);break}else t(E,w);w=w.sibling}w=Of(T,E.mode,k),w.return=E,E=w}return a(E);case ji:return I=T._init,y(E,w,I(T._payload),k)}if(Io(T))return g(E,w,T,k);if(go(T))return v(E,w,T,k);uc(E,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,w!==null&&w.tag===6?(r(E,w.sibling),w=i(w,T),w.return=E,E=w):(r(E,w),w=Lf(T,E.mode,k),w.return=E,E=w),a(E)):r(E,w)}return y}var za=Xv(!0),Qv=Xv(!1),tu=us(null),ru=null,Ea=null,Z0=null;function eh(){Z0=Ea=ru=null}function th(e){var t=tu.current;Nt(tu),e._currentValue=t}function Ud(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ra(e,t){ru=e,Z0=Ea=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Kr=!0),e.firstContext=null)}function bn(e){var t=e._currentValue;if(Z0!==e)if(e={context:e,memoizedValue:t,next:null},Ea===null){if(ru===null)throw Error(_e(308));Ea=e,ru.dependencies={lanes:0,firstContext:e}}else Ea=Ea.next=e;return t}var Cs=null;function rh(e){Cs===null?Cs=[e]:Cs.push(e)}function Zv(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,rh(t)):(r.next=i.next,i.next=r),t.interleaved=r,_i(e,n)}function _i(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Gi=!1;function nh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ey(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function gi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Zi(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,st&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,_i(e,r)}return i=n.interleaved,i===null?(t.next=t,rh(n)):(t.next=i.next,i.next=t),n.interleaved=t,_i(e,r)}function Pc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,G0(e,r)}}function ym(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function nu(e,t,r,n){var i=e.updateQueue;Gi=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var c=o,l=c.next;c.next=null,a===null?s=l:a.next=l,a=c;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=l:o.next=l,u.lastBaseUpdate=c))}if(s!==null){var h=i.baseState;a=0,u=l=c=null,o=s;do{var m=o.lane,x=o.eventTime;if((n&m)===m){u!==null&&(u=u.next={eventTime:x,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,v=o;switch(m=t,x=r,v.tag){case 1:if(g=v.payload,typeof g=="function"){h=g.call(x,h,m);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,m=typeof g=="function"?g.call(x,h,m):g,m==null)break e;h=Ot({},h,m);break e;case 2:Gi=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=i.effects,m===null?i.effects=[o]:m.push(o))}else x={eventTime:x,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(l=u=x,c=h):u=u.next=x,a|=m;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;m=o,o=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(u===null&&(c=h),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Bs|=a,e.lanes=a,e.memoizedState=h}}function wm(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(_e(191,i));i.call(n)}}}var $l={},oi=us($l),ml=us($l),xl=us($l);function Ns(e){if(e===$l)throw Error(_e(174));return e}function ih(e,t){switch(Tt(xl,t),Tt(ml,e),Tt(oi,$l),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:vd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=vd(t,e)}Nt(oi),Tt(oi,t)}function Wa(){Nt(oi),Nt(ml),Nt(xl)}function ty(e){Ns(xl.current);var t=Ns(oi.current),r=vd(t,e.type);t!==r&&(Tt(ml,e),Tt(oi,r))}function sh(e){ml.current===e&&(Nt(oi),Nt(ml))}var Pt=us(0);function iu(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var If=[];function ah(){for(var e=0;e<If.length;e++)If[e]._workInProgressVersionPrimary=null;If.length=0}var Mc=Ni.ReactCurrentDispatcher,Ff=Ni.ReactCurrentBatchConfig,Us=0,Lt=null,tr=null,or=null,su=!1,Go=!1,gl=0,tS=0;function Er(){throw Error(_e(321))}function oh(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!qn(e[r],t[r]))return!1;return!0}function lh(e,t,r,n,i,s){if(Us=s,Lt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Mc.current=e===null||e.memoizedState===null?sS:aS,e=r(n,i),Go){s=0;do{if(Go=!1,gl=0,25<=s)throw Error(_e(301));s+=1,or=tr=null,t.updateQueue=null,Mc.current=oS,e=r(n,i)}while(Go)}if(Mc.current=au,t=tr!==null&&tr.next!==null,Us=0,or=tr=Lt=null,su=!1,t)throw Error(_e(300));return e}function ch(){var e=gl!==0;return gl=0,e}function ri(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return or===null?Lt.memoizedState=or=e:or=or.next=e,or}function In(){if(tr===null){var e=Lt.alternate;e=e!==null?e.memoizedState:null}else e=tr.next;var t=or===null?Lt.memoizedState:or.next;if(t!==null)or=t,tr=e;else{if(e===null)throw Error(_e(310));tr=e,e={memoizedState:tr.memoizedState,baseState:tr.baseState,baseQueue:tr.baseQueue,queue:tr.queue,next:null},or===null?Lt.memoizedState=or=e:or=or.next=e}return or}function vl(e,t){return typeof t=="function"?t(e):t}function Rf(e){var t=In(),r=t.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=e;var n=tr,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,c=null,l=s;do{var u=l.lane;if((Us&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),n=l.hasEagerState?l.eagerState:e(n,l.action);else{var h={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(o=c=h,a=n):c=c.next=h,Lt.lanes|=u,Bs|=u}l=l.next}while(l!==null&&l!==s);c===null?a=n:c.next=o,qn(n,t.memoizedState)||(Kr=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Lt.lanes|=s,Bs|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Pf(e){var t=In(),r=t.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);qn(s,t.memoizedState)||(Kr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function ry(){}function ny(e,t){var r=Lt,n=In(),i=t(),s=!qn(n.memoizedState,i);if(s&&(n.memoizedState=i,Kr=!0),n=n.queue,uh(ay.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||or!==null&&or.memoizedState.tag&1){if(r.flags|=2048,yl(9,sy.bind(null,r,n,i,t),void 0,null),ur===null)throw Error(_e(349));Us&30||iy(r,t,i)}return i}function iy(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Lt.updateQueue,t===null?(t={lastEffect:null,stores:null},Lt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function sy(e,t,r,n){t.value=r,t.getSnapshot=n,oy(t)&&ly(e)}function ay(e,t,r){return r(function(){oy(t)&&ly(e)})}function oy(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!qn(e,r)}catch{return!0}}function ly(e){var t=_i(e,1);t!==null&&Vn(t,e,1,-1)}function Em(e){var t=ri();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vl,lastRenderedState:e},t.queue=e,e=e.dispatch=iS.bind(null,Lt,e),[t.memoizedState,e]}function yl(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Lt.updateQueue,t===null?(t={lastEffect:null,stores:null},Lt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function cy(){return In().memoizedState}function Dc(e,t,r,n){var i=ri();Lt.flags|=e,i.memoizedState=yl(1|t,r,void 0,n===void 0?null:n)}function $u(e,t,r,n){var i=In();n=n===void 0?null:n;var s=void 0;if(tr!==null){var a=tr.memoizedState;if(s=a.destroy,n!==null&&oh(n,a.deps)){i.memoizedState=yl(t,r,s,n);return}}Lt.flags|=e,i.memoizedState=yl(1|t,r,s,n)}function Tm(e,t){return Dc(8390656,8,e,t)}function uh(e,t){return $u(2048,8,e,t)}function uy(e,t){return $u(4,2,e,t)}function fy(e,t){return $u(4,4,e,t)}function dy(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function hy(e,t,r){return r=r!=null?r.concat([e]):null,$u(4,4,dy.bind(null,t,e),r)}function fh(){}function py(e,t){var r=In();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&oh(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function my(e,t){var r=In();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&oh(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function xy(e,t,r){return Us&21?(qn(r,t)||(r=Ev(),Lt.lanes|=r,Bs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Kr=!0),e.memoizedState=r)}function rS(e,t){var r=gt;gt=r!==0&&4>r?r:4,e(!0);var n=Ff.transition;Ff.transition={};try{e(!1),t()}finally{gt=r,Ff.transition=n}}function gy(){return In().memoizedState}function nS(e,t,r){var n=ts(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},vy(e))yy(t,r);else if(r=Zv(e,t,r,n),r!==null){var i=Ur();Vn(r,e,n,i),wy(r,t,n)}}function iS(e,t,r){var n=ts(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(vy(e))yy(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,qn(o,a)){var c=t.interleaved;c===null?(i.next=i,rh(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=Zv(e,t,i,n),r!==null&&(i=Ur(),Vn(r,e,n,i),wy(r,t,n))}}function vy(e){var t=e.alternate;return e===Lt||t!==null&&t===Lt}function yy(e,t){Go=su=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function wy(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,G0(e,r)}}var au={readContext:bn,useCallback:Er,useContext:Er,useEffect:Er,useImperativeHandle:Er,useInsertionEffect:Er,useLayoutEffect:Er,useMemo:Er,useReducer:Er,useRef:Er,useState:Er,useDebugValue:Er,useDeferredValue:Er,useTransition:Er,useMutableSource:Er,useSyncExternalStore:Er,useId:Er,unstable_isNewReconciler:!1},sS={readContext:bn,useCallback:function(e,t){return ri().memoizedState=[e,t===void 0?null:t],e},useContext:bn,useEffect:Tm,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Dc(4194308,4,dy.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Dc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Dc(4,2,e,t)},useMemo:function(e,t){var r=ri();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ri();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=nS.bind(null,Lt,e),[n.memoizedState,e]},useRef:function(e){var t=ri();return e={current:e},t.memoizedState=e},useState:Em,useDebugValue:fh,useDeferredValue:function(e){return ri().memoizedState=e},useTransition:function(){var e=Em(!1),t=e[0];return e=rS.bind(null,e[1]),ri().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Lt,i=ri();if(Ft){if(r===void 0)throw Error(_e(407));r=r()}else{if(r=t(),ur===null)throw Error(_e(349));Us&30||iy(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Tm(ay.bind(null,n,s,e),[e]),n.flags|=2048,yl(9,sy.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=ri(),t=ur.identifierPrefix;if(Ft){var r=mi,n=pi;r=(n&~(1<<32-Gn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=gl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=tS++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},aS={readContext:bn,useCallback:py,useContext:bn,useEffect:uh,useImperativeHandle:hy,useInsertionEffect:uy,useLayoutEffect:fy,useMemo:my,useReducer:Rf,useRef:cy,useState:function(){return Rf(vl)},useDebugValue:fh,useDeferredValue:function(e){var t=In();return xy(t,tr.memoizedState,e)},useTransition:function(){var e=Rf(vl)[0],t=In().memoizedState;return[e,t]},useMutableSource:ry,useSyncExternalStore:ny,useId:gy,unstable_isNewReconciler:!1},oS={readContext:bn,useCallback:py,useContext:bn,useEffect:uh,useImperativeHandle:hy,useInsertionEffect:uy,useLayoutEffect:fy,useMemo:my,useReducer:Pf,useRef:cy,useState:function(){return Pf(vl)},useDebugValue:fh,useDeferredValue:function(e){var t=In();return tr===null?t.memoizedState=e:xy(t,tr.memoizedState,e)},useTransition:function(){var e=Pf(vl)[0],t=In().memoizedState;return[e,t]},useMutableSource:ry,useSyncExternalStore:ny,useId:gy,unstable_isNewReconciler:!1};function On(e,t){if(e&&e.defaultProps){t=Ot({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Bd(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ot({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ju={isMounted:function(e){return(e=e._reactInternals)?Js(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ur(),i=ts(e),s=gi(n,i);s.payload=t,r!=null&&(s.callback=r),t=Zi(e,s,i),t!==null&&(Vn(t,e,i,n),Pc(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ur(),i=ts(e),s=gi(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Zi(e,s,i),t!==null&&(Vn(t,e,i,n),Pc(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ur(),n=ts(e),i=gi(r,n);i.tag=2,t!=null&&(i.callback=t),t=Zi(e,i,n),t!==null&&(Vn(t,e,n,r),Pc(t,e,n))}};function _m(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!fl(r,n)||!fl(i,s):!0}function Ey(e,t,r){var n=!1,i=is,s=t.contextType;return typeof s=="object"&&s!==null?s=bn(s):(i=Xr(t)?Ls:Fr.current,n=t.contextTypes,s=(n=n!=null)?Va(e,i):is),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ju,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Sm(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&ju.enqueueReplaceState(t,t.state,null)}function $d(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},nh(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=bn(s):(s=Xr(t)?Ls:Fr.current,i.context=Va(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Bd(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&ju.enqueueReplaceState(i,i.state,null),nu(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function qa(e,t){try{var r="",n=t;do r+=DT(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Mf(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function jd(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var lS=typeof WeakMap=="function"?WeakMap:Map;function Ty(e,t,r){r=gi(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){lu||(lu=!0,Xd=n),jd(e,t)},r}function _y(e,t,r){r=gi(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){jd(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){jd(e,t),typeof n!="function"&&(es===null?es=new Set([this]):es.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function km(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new lS;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=TS.bind(null,e,t,r),t.then(e,e))}function Cm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Nm(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=gi(-1,1),t.tag=2,Zi(r,t,1))),r.lanes|=1),e)}var cS=Ni.ReactCurrentOwner,Kr=!1;function Dr(e,t,r,n){t.child=e===null?Qv(t,null,r,n):za(t,e.child,r,n)}function Am(e,t,r,n,i){r=r.render;var s=t.ref;return Ra(t,i),n=lh(e,t,r,n,s,i),r=ch(),e!==null&&!Kr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Si(e,t,i)):(Ft&&r&&Y0(t),t.flags|=1,Dr(e,t,n,i),t.child)}function bm(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!yh(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,Sy(e,t,s,n,i)):(e=Bc(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:fl,r(a,n)&&e.ref===t.ref)return Si(e,t,i)}return t.flags|=1,e=rs(s,n),e.ref=t.ref,e.return=t,t.child=e}function Sy(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(fl(s,n)&&e.ref===t.ref)if(Kr=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Kr=!0);else return t.lanes=e.lanes,Si(e,t,i)}return Gd(e,t,r,n,i)}function ky(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tt(_a,nn),nn|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Tt(_a,nn),nn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Tt(_a,nn),nn|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Tt(_a,nn),nn|=n;return Dr(e,t,i,r),t.child}function Cy(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Gd(e,t,r,n,i){var s=Xr(r)?Ls:Fr.current;return s=Va(t,s),Ra(t,i),r=lh(e,t,r,n,s,i),n=ch(),e!==null&&!Kr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Si(e,t,i)):(Ft&&n&&Y0(t),t.flags|=1,Dr(e,t,r,i),t.child)}function Im(e,t,r,n,i){if(Xr(r)){var s=!0;Qc(t)}else s=!1;if(Ra(t,i),t.stateNode===null)Lc(e,t),Ey(t,r,n),$d(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var c=a.context,l=r.contextType;typeof l=="object"&&l!==null?l=bn(l):(l=Xr(r)?Ls:Fr.current,l=Va(t,l));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||c!==l)&&Sm(t,a,n,l),Gi=!1;var m=t.memoizedState;a.state=m,nu(t,n,a,i),c=t.memoizedState,o!==n||m!==c||Yr.current||Gi?(typeof u=="function"&&(Bd(t,r,u,n),c=t.memoizedState),(o=Gi||_m(t,r,o,n,m,c,l))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),a.props=n,a.state=c,a.context=l,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,ey(e,t),o=t.memoizedProps,l=t.type===t.elementType?o:On(t.type,o),a.props=l,h=t.pendingProps,m=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=bn(c):(c=Xr(r)?Ls:Fr.current,c=Va(t,c));var x=r.getDerivedStateFromProps;(u=typeof x=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||m!==c)&&Sm(t,a,n,c),Gi=!1,m=t.memoizedState,a.state=m,nu(t,n,a,i);var g=t.memoizedState;o!==h||m!==g||Yr.current||Gi?(typeof x=="function"&&(Bd(t,r,x,n),g=t.memoizedState),(l=Gi||_m(t,r,l,n,m,g,c)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),a.props=n,a.state=g,a.context=c,n=l):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return Vd(e,t,r,n,s,i)}function Vd(e,t,r,n,i,s){Cy(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&mm(t,r,!1),Si(e,t,s);n=t.stateNode,cS.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=za(t,e.child,null,s),t.child=za(t,null,o,s)):Dr(e,t,o,s),t.memoizedState=n.state,i&&mm(t,r,!0),t.child}function Ny(e){var t=e.stateNode;t.pendingContext?pm(e,t.pendingContext,t.pendingContext!==t.context):t.context&&pm(e,t.context,!1),ih(e,t.containerInfo)}function Fm(e,t,r,n,i){return Ha(),Q0(i),t.flags|=256,Dr(e,t,r,n),t.child}var Hd={dehydrated:null,treeContext:null,retryLane:0};function zd(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ay(e,t,r){var n=t.pendingProps,i=Pt.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Tt(Pt,i&1),e===null)return Od(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Hu(a,n,0,null),e=Fs(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=zd(r),t.memoizedState=Hd,e):dh(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return uS(e,t,a,n,o,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,o=i.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=rs(i,c),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=rs(o,s):(s=Fs(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?zd(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=Hd,n}return s=e.child,e=s.sibling,n=rs(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function dh(e,t){return t=Hu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function fc(e,t,r,n){return n!==null&&Q0(n),za(t,e.child,null,r),e=dh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function uS(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=Mf(Error(_e(422))),fc(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Hu({mode:"visible",children:n.children},i,0,null),s=Fs(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&za(t,e.child,null,a),t.child.memoizedState=zd(a),t.memoizedState=Hd,s);if(!(t.mode&1))return fc(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(_e(419)),n=Mf(s,n,void 0),fc(e,t,a,n)}if(o=(a&e.childLanes)!==0,Kr||o){if(n=ur,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,_i(e,i),Vn(n,e,i,-1))}return vh(),n=Mf(Error(_e(421))),fc(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=_S.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,cn=Qi(i.nextSibling),un=t,Ft=!0,Bn=null,e!==null&&(_n[Sn++]=pi,_n[Sn++]=mi,_n[Sn++]=Os,pi=e.id,mi=e.overflow,Os=t),t=dh(t,n.children),t.flags|=4096,t)}function Rm(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Ud(e.return,t,r)}function Df(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function by(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Dr(e,t,n.children,r),n=Pt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Rm(e,r,t);else if(e.tag===19)Rm(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Tt(Pt,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&iu(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Df(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&iu(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Df(t,!0,r,null,s);break;case"together":Df(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Lc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Si(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Bs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(_e(153));if(t.child!==null){for(e=t.child,r=rs(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=rs(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function fS(e,t,r){switch(t.tag){case 3:Ny(t),Ha();break;case 5:ty(t);break;case 1:Xr(t.type)&&Qc(t);break;case 4:ih(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Tt(tu,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Tt(Pt,Pt.current&1),t.flags|=128,null):r&t.child.childLanes?Ay(e,t,r):(Tt(Pt,Pt.current&1),e=Si(e,t,r),e!==null?e.sibling:null);Tt(Pt,Pt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return by(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Tt(Pt,Pt.current),n)break;return null;case 22:case 23:return t.lanes=0,ky(e,t,r)}return Si(e,t,r)}var Iy,Wd,Fy,Ry;Iy=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Wd=function(){};Fy=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Ns(oi.current);var s=null;switch(r){case"input":i=pd(e,i),n=pd(e,n),s=[];break;case"select":i=Ot({},i,{value:void 0}),n=Ot({},n,{value:void 0}),s=[];break;case"textarea":i=gd(e,i),n=gd(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Yc)}yd(r,n);var a;r=null;for(l in i)if(!n.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var o=i[l];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(il.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in n){var c=n[l];if(o=i!=null?i[l]:void 0,n.hasOwnProperty(l)&&c!==o&&(c!=null||o!=null))if(l==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(s||(s=[]),s.push(l,r)),r=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(s=s||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(il.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&St("scroll",e),s||o===c||(s=[])):(s=s||[]).push(l,c))}r&&(s=s||[]).push("style",r);var l=s;(t.updateQueue=l)&&(t.flags|=4)}};Ry=function(e,t,r,n){r!==n&&(t.flags|=4)};function _o(e,t){if(!Ft)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Tr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function dS(e,t,r){var n=t.pendingProps;switch(X0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tr(t),null;case 1:return Xr(t.type)&&Xc(),Tr(t),null;case 3:return n=t.stateNode,Wa(),Nt(Yr),Nt(Fr),ah(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(cc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Bn!==null&&(e0(Bn),Bn=null))),Wd(e,t),Tr(t),null;case 5:sh(t);var i=Ns(xl.current);if(r=t.type,e!==null&&t.stateNode!=null)Fy(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(_e(166));return Tr(t),null}if(e=Ns(oi.current),cc(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[ii]=t,n[pl]=s,e=(t.mode&1)!==0,r){case"dialog":St("cancel",n),St("close",n);break;case"iframe":case"object":case"embed":St("load",n);break;case"video":case"audio":for(i=0;i<Ro.length;i++)St(Ro[i],n);break;case"source":St("error",n);break;case"img":case"image":case"link":St("error",n),St("load",n);break;case"details":St("toggle",n);break;case"input":jp(n,s),St("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},St("invalid",n);break;case"textarea":Vp(n,s),St("invalid",n)}yd(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&lc(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&lc(n.textContent,o,e),i=["children",""+o]):il.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&St("scroll",n)}switch(r){case"input":ec(n),Gp(n,s,!0);break;case"textarea":ec(n),Hp(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Yc)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=av(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[ii]=t,e[pl]=n,Iy(e,t,!1,!1),t.stateNode=e;e:{switch(a=wd(r,n),r){case"dialog":St("cancel",e),St("close",e),i=n;break;case"iframe":case"object":case"embed":St("load",e),i=n;break;case"video":case"audio":for(i=0;i<Ro.length;i++)St(Ro[i],e);i=n;break;case"source":St("error",e),i=n;break;case"img":case"image":case"link":St("error",e),St("load",e),i=n;break;case"details":St("toggle",e),i=n;break;case"input":jp(e,n),i=pd(e,n),St("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Ot({},n,{value:void 0}),St("invalid",e);break;case"textarea":Vp(e,n),i=gd(e,n),St("invalid",e);break;default:i=n}yd(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var c=o[s];s==="style"?cv(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ov(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&sl(e,c):typeof c=="number"&&sl(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(il.hasOwnProperty(s)?c!=null&&s==="onScroll"&&St("scroll",e):c!=null&&L0(e,s,c,a))}switch(r){case"input":ec(e),Gp(e,n,!1);break;case"textarea":ec(e),Hp(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ns(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Aa(e,!!n.multiple,s,!1):n.defaultValue!=null&&Aa(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Yc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Tr(t),null;case 6:if(e&&t.stateNode!=null)Ry(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(_e(166));if(r=Ns(xl.current),Ns(oi.current),cc(t)){if(n=t.stateNode,r=t.memoizedProps,n[ii]=t,(s=n.nodeValue!==r)&&(e=un,e!==null))switch(e.tag){case 3:lc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&lc(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ii]=t,t.stateNode=n}return Tr(t),null;case 13:if(Nt(Pt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ft&&cn!==null&&t.mode&1&&!(t.flags&128))Yv(),Ha(),t.flags|=98560,s=!1;else if(s=cc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(_e(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(_e(317));s[ii]=t}else Ha(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Tr(t),s=!1}else Bn!==null&&(e0(Bn),Bn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Pt.current&1?nr===0&&(nr=3):vh())),t.updateQueue!==null&&(t.flags|=4),Tr(t),null);case 4:return Wa(),Wd(e,t),e===null&&dl(t.stateNode.containerInfo),Tr(t),null;case 10:return th(t.type._context),Tr(t),null;case 17:return Xr(t.type)&&Xc(),Tr(t),null;case 19:if(Nt(Pt),s=t.memoizedState,s===null)return Tr(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)_o(s,!1);else{if(nr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=iu(e),a!==null){for(t.flags|=128,_o(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Tt(Pt,Pt.current&1|2),t.child}e=e.sibling}s.tail!==null&&Ht()>Ja&&(t.flags|=128,n=!0,_o(s,!1),t.lanes=4194304)}else{if(!n)if(e=iu(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),_o(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Ft)return Tr(t),null}else 2*Ht()-s.renderingStartTime>Ja&&r!==1073741824&&(t.flags|=128,n=!0,_o(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ht(),t.sibling=null,r=Pt.current,Tt(Pt,n?r&1|2:r&1),t):(Tr(t),null);case 22:case 23:return gh(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?nn&1073741824&&(Tr(t),t.subtreeFlags&6&&(t.flags|=8192)):Tr(t),null;case 24:return null;case 25:return null}throw Error(_e(156,t.tag))}function hS(e,t){switch(X0(t),t.tag){case 1:return Xr(t.type)&&Xc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Wa(),Nt(Yr),Nt(Fr),ah(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return sh(t),null;case 13:if(Nt(Pt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(_e(340));Ha()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Nt(Pt),null;case 4:return Wa(),null;case 10:return th(t.type._context),null;case 22:case 23:return gh(),null;case 24:return null;default:return null}}var dc=!1,Cr=!1,pS=typeof WeakSet=="function"?WeakSet:Set,Be=null;function Ta(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ut(e,t,n)}else r.current=null}function qd(e,t,r){try{r()}catch(n){Ut(e,t,n)}}var Pm=!1;function mS(e,t){if(Id=qc,e=Ov(),K0(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,c=-1,l=0,u=0,h=e,m=null;t:for(;;){for(var x;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(c=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(x=h.firstChild)!==null;)m=h,h=x;for(;;){if(h===e)break t;if(m===r&&++l===i&&(o=a),m===s&&++u===n&&(c=a),(x=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=x}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Fd={focusedElem:e,selectionRange:r},qc=!1,Be=t;Be!==null;)if(t=Be,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Be=e;else for(;Be!==null;){t=Be;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var v=g.memoizedProps,y=g.memoizedState,E=t.stateNode,w=E.getSnapshotBeforeUpdate(t.elementType===t.type?v:On(t.type,v),y);E.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var T=t.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_e(163))}}catch(k){Ut(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,Be=e;break}Be=t.return}return g=Pm,Pm=!1,g}function Vo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&qd(t,r,s)}i=i.next}while(i!==n)}}function Gu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Jd(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Py(e){var t=e.alternate;t!==null&&(e.alternate=null,Py(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ii],delete t[pl],delete t[Md],delete t[X_],delete t[Q_])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function My(e){return e.tag===5||e.tag===3||e.tag===4}function Mm(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||My(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Kd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Yc));else if(n!==4&&(e=e.child,e!==null))for(Kd(e,t,r),e=e.sibling;e!==null;)Kd(e,t,r),e=e.sibling}function Yd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Yd(e,t,r),e=e.sibling;e!==null;)Yd(e,t,r),e=e.sibling}var mr=null,Un=!1;function Ui(e,t,r){for(r=r.child;r!==null;)Dy(e,t,r),r=r.sibling}function Dy(e,t,r){if(ai&&typeof ai.onCommitFiberUnmount=="function")try{ai.onCommitFiberUnmount(Mu,r)}catch{}switch(r.tag){case 5:Cr||Ta(r,t);case 6:var n=mr,i=Un;mr=null,Ui(e,t,r),mr=n,Un=i,mr!==null&&(Un?(e=mr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):mr.removeChild(r.stateNode));break;case 18:mr!==null&&(Un?(e=mr,r=r.stateNode,e.nodeType===8?Af(e.parentNode,r):e.nodeType===1&&Af(e,r),cl(e)):Af(mr,r.stateNode));break;case 4:n=mr,i=Un,mr=r.stateNode.containerInfo,Un=!0,Ui(e,t,r),mr=n,Un=i;break;case 0:case 11:case 14:case 15:if(!Cr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&qd(r,t,a),i=i.next}while(i!==n)}Ui(e,t,r);break;case 1:if(!Cr&&(Ta(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Ut(r,t,o)}Ui(e,t,r);break;case 21:Ui(e,t,r);break;case 22:r.mode&1?(Cr=(n=Cr)||r.memoizedState!==null,Ui(e,t,r),Cr=n):Ui(e,t,r);break;default:Ui(e,t,r)}}function Dm(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new pS),t.forEach(function(n){var i=SS.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Dn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:mr=o.stateNode,Un=!1;break e;case 3:mr=o.stateNode.containerInfo,Un=!0;break e;case 4:mr=o.stateNode.containerInfo,Un=!0;break e}o=o.return}if(mr===null)throw Error(_e(160));Dy(s,a,i),mr=null,Un=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){Ut(i,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ly(t,e),t=t.sibling}function Ly(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Dn(t,e),Qn(e),n&4){try{Vo(3,e,e.return),Gu(3,e)}catch(v){Ut(e,e.return,v)}try{Vo(5,e,e.return)}catch(v){Ut(e,e.return,v)}}break;case 1:Dn(t,e),Qn(e),n&512&&r!==null&&Ta(r,r.return);break;case 5:if(Dn(t,e),Qn(e),n&512&&r!==null&&Ta(r,r.return),e.flags&32){var i=e.stateNode;try{sl(i,"")}catch(v){Ut(e,e.return,v)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&iv(i,s),wd(o,a);var l=wd(o,s);for(a=0;a<c.length;a+=2){var u=c[a],h=c[a+1];u==="style"?cv(i,h):u==="dangerouslySetInnerHTML"?ov(i,h):u==="children"?sl(i,h):L0(i,u,h,l)}switch(o){case"input":md(i,s);break;case"textarea":sv(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var x=s.value;x!=null?Aa(i,!!s.multiple,x,!1):m!==!!s.multiple&&(s.defaultValue!=null?Aa(i,!!s.multiple,s.defaultValue,!0):Aa(i,!!s.multiple,s.multiple?[]:"",!1))}i[pl]=s}catch(v){Ut(e,e.return,v)}}break;case 6:if(Dn(t,e),Qn(e),n&4){if(e.stateNode===null)throw Error(_e(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(v){Ut(e,e.return,v)}}break;case 3:if(Dn(t,e),Qn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{cl(t.containerInfo)}catch(v){Ut(e,e.return,v)}break;case 4:Dn(t,e),Qn(e);break;case 13:Dn(t,e),Qn(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(mh=Ht())),n&4&&Dm(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Cr=(l=Cr)||u,Dn(t,e),Cr=l):Dn(t,e),Qn(e),n&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!u&&e.mode&1)for(Be=e,u=e.child;u!==null;){for(h=Be=u;Be!==null;){switch(m=Be,x=m.child,m.tag){case 0:case 11:case 14:case 15:Vo(4,m,m.return);break;case 1:Ta(m,m.return);var g=m.stateNode;if(typeof g.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(v){Ut(n,r,v)}}break;case 5:Ta(m,m.return);break;case 22:if(m.memoizedState!==null){Om(h);continue}}x!==null?(x.return=m,Be=x):Om(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{i=h.stateNode,l?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,c=h.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=lv("display",a))}catch(v){Ut(e,e.return,v)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(v){Ut(e,e.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Dn(t,e),Qn(e),n&4&&Dm(e);break;case 21:break;default:Dn(t,e),Qn(e)}}function Qn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(My(r)){var n=r;break e}r=r.return}throw Error(_e(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(sl(i,""),n.flags&=-33);var s=Mm(e);Yd(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=Mm(e);Kd(e,o,a);break;default:throw Error(_e(161))}}catch(c){Ut(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function xS(e,t,r){Be=e,Oy(e)}function Oy(e,t,r){for(var n=(e.mode&1)!==0;Be!==null;){var i=Be,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||dc;if(!a){var o=i.alternate,c=o!==null&&o.memoizedState!==null||Cr;o=dc;var l=Cr;if(dc=a,(Cr=c)&&!l)for(Be=i;Be!==null;)a=Be,c=a.child,a.tag===22&&a.memoizedState!==null?Um(i):c!==null?(c.return=a,Be=c):Um(i);for(;s!==null;)Be=s,Oy(s),s=s.sibling;Be=i,dc=o,Cr=l}Lm(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Be=s):Lm(e)}}function Lm(e){for(;Be!==null;){var t=Be;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Cr||Gu(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Cr)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:On(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&wm(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}wm(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&cl(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_e(163))}Cr||t.flags&512&&Jd(t)}catch(m){Ut(t,t.return,m)}}if(t===e){Be=null;break}if(r=t.sibling,r!==null){r.return=t.return,Be=r;break}Be=t.return}}function Om(e){for(;Be!==null;){var t=Be;if(t===e){Be=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Be=r;break}Be=t.return}}function Um(e){for(;Be!==null;){var t=Be;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Gu(4,t)}catch(c){Ut(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){Ut(t,i,c)}}var s=t.return;try{Jd(t)}catch(c){Ut(t,s,c)}break;case 5:var a=t.return;try{Jd(t)}catch(c){Ut(t,a,c)}}}catch(c){Ut(t,t.return,c)}if(t===e){Be=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Be=o;break}Be=t.return}}var gS=Math.ceil,ou=Ni.ReactCurrentDispatcher,hh=Ni.ReactCurrentOwner,Cn=Ni.ReactCurrentBatchConfig,st=0,ur=null,Xt=null,vr=0,nn=0,_a=us(0),nr=0,wl=null,Bs=0,Vu=0,ph=0,Ho=null,Jr=null,mh=0,Ja=1/0,di=null,lu=!1,Xd=null,es=null,hc=!1,Wi=null,cu=0,zo=0,Qd=null,Oc=-1,Uc=0;function Ur(){return st&6?Ht():Oc!==-1?Oc:Oc=Ht()}function ts(e){return e.mode&1?st&2&&vr!==0?vr&-vr:eS.transition!==null?(Uc===0&&(Uc=Ev()),Uc):(e=gt,e!==0||(e=window.event,e=e===void 0?16:Av(e.type)),e):1}function Vn(e,t,r,n){if(50<zo)throw zo=0,Qd=null,Error(_e(185));Ol(e,r,n),(!(st&2)||e!==ur)&&(e===ur&&(!(st&2)&&(Vu|=r),nr===4&&Hi(e,vr)),Qr(e,n),r===1&&st===0&&!(t.mode&1)&&(Ja=Ht()+500,Bu&&fs()))}function Qr(e,t){var r=e.callbackNode;e_(e,t);var n=Wc(e,e===ur?vr:0);if(n===0)r!==null&&qp(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&qp(r),t===1)e.tag===0?Z_(Bm.bind(null,e)):qv(Bm.bind(null,e)),K_(function(){!(st&6)&&fs()}),r=null;else{switch(Tv(n)){case 1:r=j0;break;case 4:r=yv;break;case 16:r=zc;break;case 536870912:r=wv;break;default:r=zc}r=zy(r,Uy.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Uy(e,t){if(Oc=-1,Uc=0,st&6)throw Error(_e(327));var r=e.callbackNode;if(Pa()&&e.callbackNode!==r)return null;var n=Wc(e,e===ur?vr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=uu(e,n);else{t=n;var i=st;st|=2;var s=$y();(ur!==e||vr!==t)&&(di=null,Ja=Ht()+500,Is(e,t));do try{wS();break}catch(o){By(e,o)}while(!0);eh(),ou.current=s,st=i,Xt!==null?t=0:(ur=null,vr=0,t=nr)}if(t!==0){if(t===2&&(i=kd(e),i!==0&&(n=i,t=Zd(e,i))),t===1)throw r=wl,Is(e,0),Hi(e,n),Qr(e,Ht()),r;if(t===6)Hi(e,n);else{if(i=e.current.alternate,!(n&30)&&!vS(i)&&(t=uu(e,n),t===2&&(s=kd(e),s!==0&&(n=s,t=Zd(e,s))),t===1))throw r=wl,Is(e,0),Hi(e,n),Qr(e,Ht()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(_e(345));case 2:Ts(e,Jr,di);break;case 3:if(Hi(e,n),(n&130023424)===n&&(t=mh+500-Ht(),10<t)){if(Wc(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Ur(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Pd(Ts.bind(null,e,Jr,di),t);break}Ts(e,Jr,di);break;case 4:if(Hi(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-Gn(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=Ht()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*gS(n/1960))-n,10<n){e.timeoutHandle=Pd(Ts.bind(null,e,Jr,di),n);break}Ts(e,Jr,di);break;case 5:Ts(e,Jr,di);break;default:throw Error(_e(329))}}}return Qr(e,Ht()),e.callbackNode===r?Uy.bind(null,e):null}function Zd(e,t){var r=Ho;return e.current.memoizedState.isDehydrated&&(Is(e,t).flags|=256),e=uu(e,t),e!==2&&(t=Jr,Jr=r,t!==null&&e0(t)),e}function e0(e){Jr===null?Jr=e:Jr.push.apply(Jr,e)}function vS(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!qn(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Hi(e,t){for(t&=~ph,t&=~Vu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Gn(t),n=1<<r;e[r]=-1,t&=~n}}function Bm(e){if(st&6)throw Error(_e(327));Pa();var t=Wc(e,0);if(!(t&1))return Qr(e,Ht()),null;var r=uu(e,t);if(e.tag!==0&&r===2){var n=kd(e);n!==0&&(t=n,r=Zd(e,n))}if(r===1)throw r=wl,Is(e,0),Hi(e,t),Qr(e,Ht()),r;if(r===6)throw Error(_e(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ts(e,Jr,di),Qr(e,Ht()),null}function xh(e,t){var r=st;st|=1;try{return e(t)}finally{st=r,st===0&&(Ja=Ht()+500,Bu&&fs())}}function $s(e){Wi!==null&&Wi.tag===0&&!(st&6)&&Pa();var t=st;st|=1;var r=Cn.transition,n=gt;try{if(Cn.transition=null,gt=1,e)return e()}finally{gt=n,Cn.transition=r,st=t,!(st&6)&&fs()}}function gh(){nn=_a.current,Nt(_a)}function Is(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,J_(r)),Xt!==null)for(r=Xt.return;r!==null;){var n=r;switch(X0(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Xc();break;case 3:Wa(),Nt(Yr),Nt(Fr),ah();break;case 5:sh(n);break;case 4:Wa();break;case 13:Nt(Pt);break;case 19:Nt(Pt);break;case 10:th(n.type._context);break;case 22:case 23:gh()}r=r.return}if(ur=e,Xt=e=rs(e.current,null),vr=nn=t,nr=0,wl=null,ph=Vu=Bs=0,Jr=Ho=null,Cs!==null){for(t=0;t<Cs.length;t++)if(r=Cs[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Cs=null}return e}function By(e,t){do{var r=Xt;try{if(eh(),Mc.current=au,su){for(var n=Lt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}su=!1}if(Us=0,or=tr=Lt=null,Go=!1,gl=0,hh.current=null,r===null||r.return===null){nr=1,wl=t,Xt=null;break}e:{var s=e,a=r.return,o=r,c=t;if(t=vr,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var x=Cm(a);if(x!==null){x.flags&=-257,Nm(x,a,o,s,t),x.mode&1&&km(s,l,t),t=x,c=l;var g=t.updateQueue;if(g===null){var v=new Set;v.add(c),t.updateQueue=v}else g.add(c);break e}else{if(!(t&1)){km(s,l,t),vh();break e}c=Error(_e(426))}}else if(Ft&&o.mode&1){var y=Cm(a);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Nm(y,a,o,s,t),Q0(qa(c,o));break e}}s=c=qa(c,o),nr!==4&&(nr=2),Ho===null?Ho=[s]:Ho.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var E=Ty(s,c,t);ym(s,E);break e;case 1:o=c;var w=s.type,T=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(es===null||!es.has(T)))){s.flags|=65536,t&=-t,s.lanes|=t;var k=_y(s,o,t);ym(s,k);break e}}s=s.return}while(s!==null)}Gy(r)}catch(b){t=b,Xt===r&&r!==null&&(Xt=r=r.return);continue}break}while(!0)}function $y(){var e=ou.current;return ou.current=au,e===null?au:e}function vh(){(nr===0||nr===3||nr===2)&&(nr=4),ur===null||!(Bs&268435455)&&!(Vu&268435455)||Hi(ur,vr)}function uu(e,t){var r=st;st|=2;var n=$y();(ur!==e||vr!==t)&&(di=null,Is(e,t));do try{yS();break}catch(i){By(e,i)}while(!0);if(eh(),st=r,ou.current=n,Xt!==null)throw Error(_e(261));return ur=null,vr=0,nr}function yS(){for(;Xt!==null;)jy(Xt)}function wS(){for(;Xt!==null&&!zT();)jy(Xt)}function jy(e){var t=Hy(e.alternate,e,nn);e.memoizedProps=e.pendingProps,t===null?Gy(e):Xt=t,hh.current=null}function Gy(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=hS(r,t),r!==null){r.flags&=32767,Xt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{nr=6,Xt=null;return}}else if(r=dS(r,t,nn),r!==null){Xt=r;return}if(t=t.sibling,t!==null){Xt=t;return}Xt=t=e}while(t!==null);nr===0&&(nr=5)}function Ts(e,t,r){var n=gt,i=Cn.transition;try{Cn.transition=null,gt=1,ES(e,t,r,n)}finally{Cn.transition=i,gt=n}return null}function ES(e,t,r,n){do Pa();while(Wi!==null);if(st&6)throw Error(_e(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(_e(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(t_(e,s),e===ur&&(Xt=ur=null,vr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||hc||(hc=!0,zy(zc,function(){return Pa(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Cn.transition,Cn.transition=null;var a=gt;gt=1;var o=st;st|=4,hh.current=null,mS(e,r),Ly(r,e),j_(Fd),qc=!!Id,Fd=Id=null,e.current=r,xS(r),WT(),st=o,gt=a,Cn.transition=s}else e.current=r;if(hc&&(hc=!1,Wi=e,cu=i),s=e.pendingLanes,s===0&&(es=null),KT(r.stateNode),Qr(e,Ht()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(lu)throw lu=!1,e=Xd,Xd=null,e;return cu&1&&e.tag!==0&&Pa(),s=e.pendingLanes,s&1?e===Qd?zo++:(zo=0,Qd=e):zo=0,fs(),null}function Pa(){if(Wi!==null){var e=Tv(cu),t=Cn.transition,r=gt;try{if(Cn.transition=null,gt=16>e?16:e,Wi===null)var n=!1;else{if(e=Wi,Wi=null,cu=0,st&6)throw Error(_e(331));var i=st;for(st|=4,Be=e.current;Be!==null;){var s=Be,a=s.child;if(Be.flags&16){var o=s.deletions;if(o!==null){for(var c=0;c<o.length;c++){var l=o[c];for(Be=l;Be!==null;){var u=Be;switch(u.tag){case 0:case 11:case 15:Vo(8,u,s)}var h=u.child;if(h!==null)h.return=u,Be=h;else for(;Be!==null;){u=Be;var m=u.sibling,x=u.return;if(Py(u),u===l){Be=null;break}if(m!==null){m.return=x,Be=m;break}Be=x}}}var g=s.alternate;if(g!==null){var v=g.child;if(v!==null){g.child=null;do{var y=v.sibling;v.sibling=null,v=y}while(v!==null)}}Be=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Be=a;else e:for(;Be!==null;){if(s=Be,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Vo(9,s,s.return)}var E=s.sibling;if(E!==null){E.return=s.return,Be=E;break e}Be=s.return}}var w=e.current;for(Be=w;Be!==null;){a=Be;var T=a.child;if(a.subtreeFlags&2064&&T!==null)T.return=a,Be=T;else e:for(a=w;Be!==null;){if(o=Be,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Gu(9,o)}}catch(b){Ut(o,o.return,b)}if(o===a){Be=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,Be=k;break e}Be=o.return}}if(st=i,fs(),ai&&typeof ai.onPostCommitFiberRoot=="function")try{ai.onPostCommitFiberRoot(Mu,e)}catch{}n=!0}return n}finally{gt=r,Cn.transition=t}}return!1}function $m(e,t,r){t=qa(r,t),t=Ty(e,t,1),e=Zi(e,t,1),t=Ur(),e!==null&&(Ol(e,1,t),Qr(e,t))}function Ut(e,t,r){if(e.tag===3)$m(e,e,r);else for(;t!==null;){if(t.tag===3){$m(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(es===null||!es.has(n))){e=qa(r,e),e=_y(t,e,1),t=Zi(t,e,1),e=Ur(),t!==null&&(Ol(t,1,e),Qr(t,e));break}}t=t.return}}function TS(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ur(),e.pingedLanes|=e.suspendedLanes&r,ur===e&&(vr&r)===r&&(nr===4||nr===3&&(vr&130023424)===vr&&500>Ht()-mh?Is(e,0):ph|=r),Qr(e,t)}function Vy(e,t){t===0&&(e.mode&1?(t=nc,nc<<=1,!(nc&130023424)&&(nc=4194304)):t=1);var r=Ur();e=_i(e,t),e!==null&&(Ol(e,t,r),Qr(e,r))}function _S(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Vy(e,r)}function SS(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(_e(314))}n!==null&&n.delete(t),Vy(e,r)}var Hy;Hy=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Yr.current)Kr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Kr=!1,fS(e,t,r);Kr=!!(e.flags&131072)}else Kr=!1,Ft&&t.flags&1048576&&Jv(t,eu,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Lc(e,t),e=t.pendingProps;var i=Va(t,Fr.current);Ra(t,r),i=lh(null,t,n,e,i,r);var s=ch();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Xr(n)?(s=!0,Qc(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,nh(t),i.updater=ju,t.stateNode=i,i._reactInternals=t,$d(t,n,e,r),t=Vd(null,t,n,!0,s,r)):(t.tag=0,Ft&&s&&Y0(t),Dr(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Lc(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=CS(n),e=On(n,e),i){case 0:t=Gd(null,t,n,e,r);break e;case 1:t=Im(null,t,n,e,r);break e;case 11:t=Am(null,t,n,e,r);break e;case 14:t=bm(null,t,n,On(n.type,e),r);break e}throw Error(_e(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:On(n,i),Gd(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:On(n,i),Im(e,t,n,i,r);case 3:e:{if(Ny(t),e===null)throw Error(_e(387));n=t.pendingProps,s=t.memoizedState,i=s.element,ey(e,t),nu(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=qa(Error(_e(423)),t),t=Fm(e,t,n,r,i);break e}else if(n!==i){i=qa(Error(_e(424)),t),t=Fm(e,t,n,r,i);break e}else for(cn=Qi(t.stateNode.containerInfo.firstChild),un=t,Ft=!0,Bn=null,r=Qv(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ha(),n===i){t=Si(e,t,r);break e}Dr(e,t,n,r)}t=t.child}return t;case 5:return ty(t),e===null&&Od(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,Rd(n,i)?a=null:s!==null&&Rd(n,s)&&(t.flags|=32),Cy(e,t),Dr(e,t,a,r),t.child;case 6:return e===null&&Od(t),null;case 13:return Ay(e,t,r);case 4:return ih(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=za(t,null,n,r):Dr(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:On(n,i),Am(e,t,n,i,r);case 7:return Dr(e,t,t.pendingProps,r),t.child;case 8:return Dr(e,t,t.pendingProps.children,r),t.child;case 12:return Dr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,Tt(tu,n._currentValue),n._currentValue=a,s!==null)if(qn(s.value,a)){if(s.children===i.children&&!Yr.current){t=Si(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=gi(-1,r&-r),c.tag=2;var l=s.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),Ud(s.return,r,t),o.lanes|=r;break}c=c.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(_e(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Ud(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Dr(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Ra(t,r),i=bn(i),n=n(i),t.flags|=1,Dr(e,t,n,r),t.child;case 14:return n=t.type,i=On(n,t.pendingProps),i=On(n.type,i),bm(e,t,n,i,r);case 15:return Sy(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:On(n,i),Lc(e,t),t.tag=1,Xr(n)?(e=!0,Qc(t)):e=!1,Ra(t,r),Ey(t,n,i),$d(t,n,i,r),Vd(null,t,n,!0,e,r);case 19:return by(e,t,r);case 22:return ky(e,t,r)}throw Error(_e(156,t.tag))};function zy(e,t){return vv(e,t)}function kS(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(e,t,r,n){return new kS(e,t,r,n)}function yh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function CS(e){if(typeof e=="function")return yh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===U0)return 11;if(e===B0)return 14}return 2}function rs(e,t){var r=e.alternate;return r===null?(r=kn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Bc(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")yh(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case ha:return Fs(r.children,i,s,t);case O0:a=8,i|=8;break;case ud:return e=kn(12,r,t,i|2),e.elementType=ud,e.lanes=s,e;case fd:return e=kn(13,r,t,i),e.elementType=fd,e.lanes=s,e;case dd:return e=kn(19,r,t,i),e.elementType=dd,e.lanes=s,e;case tv:return Hu(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Z1:a=10;break e;case ev:a=9;break e;case U0:a=11;break e;case B0:a=14;break e;case ji:a=16,n=null;break e}throw Error(_e(130,e==null?e:typeof e,""))}return t=kn(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function Fs(e,t,r,n){return e=kn(7,e,n,t),e.lanes=r,e}function Hu(e,t,r,n){return e=kn(22,e,n,t),e.elementType=tv,e.lanes=r,e.stateNode={isHidden:!1},e}function Lf(e,t,r){return e=kn(6,e,null,t),e.lanes=r,e}function Of(e,t,r){return t=kn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function NS(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gf(0),this.expirationTimes=gf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gf(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function wh(e,t,r,n,i,s,a,o,c){return e=new NS(e,t,r,o,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=kn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},nh(s),e}function AS(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:da,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Wy(e){if(!e)return is;e=e._reactInternals;e:{if(Js(e)!==e||e.tag!==1)throw Error(_e(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Xr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(_e(171))}if(e.tag===1){var r=e.type;if(Xr(r))return Wv(e,r,t)}return t}function qy(e,t,r,n,i,s,a,o,c){return e=wh(r,n,!0,e,i,s,a,o,c),e.context=Wy(null),r=e.current,n=Ur(),i=ts(r),s=gi(n,i),s.callback=t??null,Zi(r,s,i),e.current.lanes=i,Ol(e,i,n),Qr(e,n),e}function zu(e,t,r,n){var i=t.current,s=Ur(),a=ts(i);return r=Wy(r),t.context===null?t.context=r:t.pendingContext=r,t=gi(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Zi(i,t,a),e!==null&&(Vn(e,i,a,s),Pc(e,i,a)),a}function fu(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function jm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Eh(e,t){jm(e,t),(e=e.alternate)&&jm(e,t)}function bS(){return null}var Jy=typeof reportError=="function"?reportError:function(e){console.error(e)};function Th(e){this._internalRoot=e}Wu.prototype.render=Th.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(_e(409));zu(e,t,null,null)};Wu.prototype.unmount=Th.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;$s(function(){zu(null,e,null,null)}),t[Ti]=null}};function Wu(e){this._internalRoot=e}Wu.prototype.unstable_scheduleHydration=function(e){if(e){var t=kv();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Vi.length&&t!==0&&t<Vi[r].priority;r++);Vi.splice(r,0,e),r===0&&Nv(e)}};function _h(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function qu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Gm(){}function IS(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var l=fu(a);s.call(l)}}var a=qy(t,n,e,0,null,!1,!1,"",Gm);return e._reactRootContainer=a,e[Ti]=a.current,dl(e.nodeType===8?e.parentNode:e),$s(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var l=fu(c);o.call(l)}}var c=wh(e,0,!1,null,null,!1,!1,"",Gm);return e._reactRootContainer=c,e[Ti]=c.current,dl(e.nodeType===8?e.parentNode:e),$s(function(){zu(t,c,r,n)}),c}function Ju(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var c=fu(a);o.call(c)}}zu(t,a,e,i)}else a=IS(r,t,e,i,n);return fu(a)}_v=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Fo(t.pendingLanes);r!==0&&(G0(t,r|1),Qr(t,Ht()),!(st&6)&&(Ja=Ht()+500,fs()))}break;case 13:$s(function(){var n=_i(e,1);if(n!==null){var i=Ur();Vn(n,e,1,i)}}),Eh(e,1)}};V0=function(e){if(e.tag===13){var t=_i(e,134217728);if(t!==null){var r=Ur();Vn(t,e,134217728,r)}Eh(e,134217728)}};Sv=function(e){if(e.tag===13){var t=ts(e),r=_i(e,t);if(r!==null){var n=Ur();Vn(r,e,t,n)}Eh(e,t)}};kv=function(){return gt};Cv=function(e,t){var r=gt;try{return gt=e,t()}finally{gt=r}};Td=function(e,t,r){switch(t){case"input":if(md(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Uu(n);if(!i)throw Error(_e(90));nv(n),md(n,i)}}}break;case"textarea":sv(e,r);break;case"select":t=r.value,t!=null&&Aa(e,!!r.multiple,t,!1)}};dv=xh;hv=$s;var FS={usingClientEntryPoint:!1,Events:[Bl,ga,Uu,uv,fv,xh]},So={findFiberByHostInstance:ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RS={bundleType:So.bundleType,version:So.version,rendererPackageName:So.rendererPackageName,rendererConfig:So.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ni.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=xv(e),e===null?null:e.stateNode},findFiberByHostInstance:So.findFiberByHostInstance||bS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pc.isDisabled&&pc.supportsFiber)try{Mu=pc.inject(RS),ai=pc}catch{}}hn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FS;hn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_h(t))throw Error(_e(200));return AS(e,t,null,r)};hn.createRoot=function(e,t){if(!_h(e))throw Error(_e(299));var r=!1,n="",i=Jy;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=wh(e,1,!1,null,null,r,!1,n,i),e[Ti]=t.current,dl(e.nodeType===8?e.parentNode:e),new Th(t)};hn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(_e(188)):(e=Object.keys(e).join(","),Error(_e(268,e)));return e=xv(t),e=e===null?null:e.stateNode,e};hn.flushSync=function(e){return $s(e)};hn.hydrate=function(e,t,r){if(!qu(t))throw Error(_e(200));return Ju(null,e,t,!0,r)};hn.hydrateRoot=function(e,t,r){if(!_h(e))throw Error(_e(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=Jy;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=qy(t,null,e,1,r??null,i,!1,s,a),e[Ti]=t.current,dl(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Wu(t)};hn.render=function(e,t,r){if(!qu(t))throw Error(_e(200));return Ju(null,e,t,!1,r)};hn.unmountComponentAtNode=function(e){if(!qu(e))throw Error(_e(40));return e._reactRootContainer?($s(function(){Ju(null,null,e,!1,function(){e._reactRootContainer=null,e[Ti]=null})}),!0):!1};hn.unstable_batchedUpdates=xh;hn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!qu(r))throw Error(_e(200));if(e==null||e._reactInternals===void 0)throw Error(_e(38));return Ju(e,t,r,!1,n)};hn.version="18.3.1-next-f1338f8080-20240426";function Ky(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ky)}catch(e){console.error(e)}}Ky(),K1.exports=hn;var PS=K1.exports,Vm=PS;ld.createRoot=Vm.createRoot,ld.hydrateRoot=Vm.hydrateRoot;/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MS=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Yy=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var DS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LS=ke.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:a,...o},c)=>ke.createElement("svg",{ref:c,...DS,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:Yy("lucide",i),...o},[...a.map(([l,u])=>ke.createElement(l,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=(e,t)=>{const r=ke.forwardRef(({className:n,...i},s)=>ke.createElement(LS,{ref:s,iconNode:t,className:Yy(`lucide-${MS(e)}`,n),...i}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uf=$e("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OS=$e("Baby",[["path",{d:"M9 12h.01",key:"157uk2"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"5yv0yz"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const US=$e("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BS=$e("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=$e("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $S=$e("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jS=$e("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0=$e("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const du=$e("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GS=$e("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VS=$e("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HS=$e("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hm=$e("Combine",[["path",{d:"M10 18H5a3 3 0 0 1-3-3v-1",key:"ru65g8"}],["path",{d:"M14 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"e30een"}],["path",{d:"M20 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"2ahx8o"}],["path",{d:"m7 21 3-3-3-3",key:"127cv2"}],["rect",{x:"14",y:"14",width:"8",height:"8",rx:"2",key:"1b0bso"}],["rect",{x:"2",y:"2",width:"8",height:"8",rx:"2",key:"1x09vl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zS=$e("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r0=$e("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WS=$e("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=$e("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bf=$e("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wo=$e("FileCode",[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zm=$e("FileSearch",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0=$e("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $f=$e("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jf=$e("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qS=$e("Flower2",[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=$e("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=$e("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JS=$e("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xy=$e("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qm=$e("Hammer",[["path",{d:"m15 12-8.373 8.373a1 1 0 1 1-3-3L12 9",key:"eefl8a"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172V7l-2.26-2.26a6 6 0 0 0-4.202-1.756L9 2.96l.92.82A6.18 6.18 0 0 1 12 8.4V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"b7pghm"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=$e("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=$e("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0=$e("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sh=$e("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KS=$e("LayoutList",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hu=$e("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0=$e("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=$e("ListPlus",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=$e("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gf=$e("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XS=$e("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QS=$e("Microscope",[["path",{d:"M6 18h8",key:"1borvv"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M14 22a7 7 0 1 0 0-14h-1",key:"1jwaiy"}],["path",{d:"M9 14h2",key:"197e7h"}],["path",{d:"M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z",key:"1bmzmy"}],["path",{d:"M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3",key:"1drr47"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mc=$e("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o0=$e("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ko=$e("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZS=$e("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pu=$e("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Km=$e("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ym=$e("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xm=$e("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qm=$e("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xc=$e("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ek=$e("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vf=$e("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tk=$e("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rk=$e("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nk=$e("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=$e("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ik=$e("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $i=$e("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hf=$e("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=$e("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var mu={};mu.version="0.18.5";var Qy=1252,sk=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],kh={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ch=function(e){sk.indexOf(e)!=-1&&(Qy=kh[0]=e)};function ak(){Ch(1252)}var $n=function(e){Ch(e)};function Nh(){$n(1200),ak()}function Zm(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function ok(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Zy(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Po=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?ok(e.slice(2)):t==254&&r==255?Zy(e.slice(2)):t==65279?e.slice(1):e},gc=function(t){return String.fromCharCode(t)},ex=function(t){return String.fromCharCode(t)},El,qi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Tl(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,c=0,l=0;l<e.length;)r=e.charCodeAt(l++),s=r>>2,n=e.charCodeAt(l++),a=(r&3)<<4|n>>4,i=e.charCodeAt(l++),o=(n&15)<<2|i>>6,c=i&63,isNaN(n)?o=c=64:isNaN(i)&&(c=64),t+=qi.charAt(s)+qi.charAt(a)+qi.charAt(o)+qi.charAt(c);return t}function dn(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)s=qi.indexOf(e.charAt(l++)),a=qi.indexOf(e.charAt(l++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=qi.indexOf(e.charAt(l++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=qi.indexOf(e.charAt(l++)),i=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(i));return t}var et=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ai=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ss(e){return et?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function tx(e){return et?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var on=function(t){return et?Ai(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ku(e){if(typeof ArrayBuffer>"u")return on(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function ds(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function lk(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Ah(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ah(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var lr=et?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ai(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function ck(e){for(var t=[],r=0,n=e.length+250,i=ss(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=ss(65535),n=65530)}return t.push(i.slice(0,r)),lr(t)}var Br=/\u0000/g,Mo=/[\u0001-\u0006]/g;function Da(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function jn(e,t){var r=""+e;return r.length>=t?r:Bt("0",t-r.length)+r}function bh(e,t){var r=""+e;return r.length>=t?r:Bt(" ",t-r.length)+r}function xu(e,t){var r=""+e;return r.length>=t?r:r+Bt(" ",t-r.length)}function uk(e,t){var r=""+Math.round(e);return r.length>=t?r:Bt("0",t-r.length)+r}function fk(e,t){var r=""+e;return r.length>=t?r:Bt("0",t-r.length)+r}var rx=Math.pow(2,32);function la(e,t){if(e>rx||e<-rx)return uk(e,t);var r=Math.round(e);return fk(r,t)}function gu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var nx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],zf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function dk(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var He={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},ix={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},hk={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function vu(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,c=1,l=0,u=0,h=Math.floor(i);l<t&&(h=Math.floor(i),o=h*a+s,u=h*l+c,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,c=l,l=u;if(u>t&&(l>t?(u=c,o=s):(u=l,o=a)),!r)return[0,n*o,u];var m=Math.floor(n*o/u);return[m,n*o-m*u,u]}function bs(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=yk(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var e2=new Date(1899,11,31,0,0,0),pk=e2.getTime(),mk=new Date(1900,2,1,0,0,0);function t2(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=mk&&(r+=24*60*60*1e3),(r-(pk+(e.getTimezoneOffset()-e2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ih(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function xk(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function gk(e){var t=e<0?12:11,r=Ih(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function vk(e){var t=Ih(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function _l(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=gk(e):t===10?r=e.toFixed(10).substr(0,12):r=vk(e),Ih(xk(r.toUpperCase()))}function js(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):_l(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Fn(14,t2(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function yk(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function wk(e,t,r,n){var i="",s=0,a=0,o=r.y,c,l=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,l=t.length;break;case 3:return zf[r.m-1][1];case 5:return zf[r.m-1][0];default:return zf[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,l=t.length;break;case 3:return nx[r.q][0];default:return nx[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?jn(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=jn(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}l=t.length===3?1:2;break;case 101:c=o,l=1;break}var u=l>0?jn(c,l):"";return u}function Ji(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var r2=/%/g;function Ek(e,t,r){var n=t.replace(r2,""),i=t.length-n.length;return vi(e,n,r*Math.pow(10,2*i))+Bt("%",i)}function Tk(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return vi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function n2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+n2(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,u){return c+l+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var i2=/# (\?+)( ?)\/( ?)(\d+)/;function _k(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Bt(" ",e[1].length+1+e[4].length):bh(a,e[1].length)+e[2]+"/"+e[3]+jn(o,e[4].length))}function Sk(e,t,r){return r+(t===0?"":""+t)+Bt(" ",e[1].length+2+e[4].length)}var s2=/^#*0*\.([0#]+)/,a2=/\).*[0#]/,o2=/\(###\) ###\\?-####/;function Lr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function sx(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function ax(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function kk(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Ck(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function vn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(a2)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?vn("n",n,r):"("+vn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Tk(e,t,r);if(t.indexOf("%")!==-1)return Ek(e,t,r);if(t.indexOf("E")!==-1)return n2(t,r);if(t.charCodeAt(0)===36)return"$"+vn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+la(c,t.length);if(t.match(/^[#?]+$/))return i=la(r,0),i==="0"&&(i=""),i.length>t.length?i:Lr(t.substr(0,t.length-i.length))+i;if(s=t.match(i2))return _k(s,c,l);if(t.match(/^#+0+$/))return l+la(c,t.length-t.indexOf("0"));if(s=t.match(s2))return i=sx(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Lr(s[1])).replace(/\.$/,"."+Lr(s[1])).replace(/\.(\d*)$/,function(g,v){return"."+v+Bt("0",Lr(s[1]).length-v.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+sx(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+Ji(la(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+vn(e,t,-r):Ji(""+(Math.floor(r)+kk(r,s[1].length)))+"."+jn(ax(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return vn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Da(vn(e,t.replace(/[\\-]/g,""),r)),a=0,Da(Da(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(t.match(o2))return i=vn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=vu(c,Math.pow(10,a)-1,!1),i=""+l,u=vi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=xu(o[2],a),u.length<s[4].length&&(u=Lr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=vu(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?bh(o[1],a)+s[2]+"/"+s[3]+xu(o[2],a):Bt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=la(r,0),t.length<=i.length?i:Lr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=t.indexOf(".")-a,m=t.length-i.length-h;return Lr(t.substr(0,h)+i+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=ax(r,s[1].length),r<0?"-"+vn(e,t,-r):Ji(Ck(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?jn(0,3-g.length):"")+g})+"."+jn(a,s[1].length);switch(t){case"###,##0.00":return vn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=Ji(la(c,0));return x!=="0"?l+x:"";case"###,###.00":return vn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return vn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Nk(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return vi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Ak(e,t,r){var n=t.replace(r2,""),i=t.length-n.length;return vi(e,n,r*Math.pow(10,2*i))+Bt("%",i)}function l2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+l2(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,u){return c+l+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ei(e,t,r){if(e.charCodeAt(0)===40&&!t.match(a2)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ei("n",n,r):"("+ei("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Nk(e,t,r);if(t.indexOf("%")!==-1)return Ak(e,t,r);if(t.indexOf("E")!==-1)return l2(t,r);if(t.charCodeAt(0)===36)return"$"+ei(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+jn(c,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Lr(t.substr(0,t.length-i.length))+i;if(s=t.match(i2))return Sk(s,c,l);if(t.match(/^#+0+$/))return l+jn(c,t.length-t.indexOf("0"));if(s=t.match(s2))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Lr(s[1])).replace(/\.$/,"."+Lr(s[1])),i=i.replace(/\.(\d*)$/,function(g,v){return"."+v+Bt("0",Lr(s[1]).length-v.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+Ji(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ei(e,t,-r):Ji(""+r)+"."+Bt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ei(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Da(ei(e,t.replace(/[\\-]/g,""),r)),a=0,Da(Da(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(t.match(o2))return i=ei(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=vu(c,Math.pow(10,a)-1,!1),i=""+l,u=vi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=xu(o[2],a),u.length<s[4].length&&(u=Lr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=vu(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?bh(o[1],a)+s[2]+"/"+s[3]+xu(o[2],a):Bt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Lr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=t.indexOf(".")-a,m=t.length-i.length-h;return Lr(t.substr(0,h)+i+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ei(e,t,-r):Ji(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?jn(0,3-g.length):"")+g})+"."+jn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=Ji(""+c);return x!=="0"?l+x:"";default:if(t.match(/\.[0#?]*$/))return ei(e,t.slice(0,t.lastIndexOf(".")),r)+Lr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function vi(e,t,r){return(r|0)===r?ei(e,t,r):vn(e,t,r)}function bk(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var c2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ro(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":gu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(c2))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Ik(e,t,r,n){for(var i=[],s="",a=0,o="",c="t",l,u,h,m="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!gu(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var x=e.charAt(++a),g=x==="("||x===")"?x:"t";i[i.length]={t:g,v:x},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(l==null&&(l=bs(t,r,e.charAt(a+1)==="2"),l==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||l==null&&(l=bs(t,r),l==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),i[i.length]={t:o,v:s},c=o;break;case"A":case"a":case"":var v={t:o,v:o};if(l==null&&(l=bs(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(l!=null&&(v.v=l.H>=12?"P":"A"),v.t="T",m="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(l!=null&&(v.v=l.H>=12?"PM":"AM"),v.t="T",a+=5,m="h"):e.substr(a,5).toUpperCase()==="/"?(l!=null&&(v.v=l.H>=12?"":""),v.t="T",a+=5,m="h"):(v.t="t",++a),l==null&&v.t==="T")return"";i[i.length]=v,c=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(c2)){if(l==null&&(l=bs(t,r),l==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ro(e)||(i[i.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},c=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var y=0,E=0,w;for(a=i.length-1,c="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=m,c="h",y<1&&(y=1);break;case"s":(w=i[a].v.match(/\.0+$/))&&(E=Math.max(E,w[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=i[a].t;break;case"m":c==="s"&&(i[a].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&i[a].v.match(/[Hh]/)&&(y=1),y<2&&i[a].v.match(/[Mm]/)&&(y=2),y<3&&i[a].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var T="",k;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=wk(i[a].t.charCodeAt(0),i[a].v,l,E),i[a].t="t";break;case"n":case"?":for(k=a+1;i[k]!=null&&((o=i[k].t)==="?"||o==="D"||(o===" "||o==="t")&&i[k+1]!=null&&(i[k+1].t==="?"||i[k+1].t==="t"&&i[k+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[k].v==="/"||i[k].v===" "&&i[k+1]!=null&&i[k+1].t=="?"));)i[a].v+=i[k].v,i[k]={v:"",t:";"},++k;T+=i[a].v,a=k-1;break;case"G":i[a].t="t",i[a].v=js(t,r);break}var b="",I,S;if(T.length>0){T.charCodeAt(0)==40?(I=t<0&&T.charCodeAt(0)===45?-t:t,S=vi("n",T,I)):(I=t<0&&n>1?-t:t,S=vi("n",T,I),I<0&&i[0]&&i[0].t=="t"&&(S=S.substr(1),i[0].v="-"+i[0].v)),k=S.length-1;var B=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){B=a;break}var D=i.length;if(B===i.length&&S.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(k>=i[a].v.length-1?(k-=i[a].v.length,i[a].v=S.substr(k+1,i[a].v.length)):k<0?i[a].v="":(i[a].v=S.substr(0,k+1),k=-1),i[a].t="t",D=a);k>=0&&D<i.length&&(i[D].v=S.substr(0,k+1)+i[D].v)}else if(B!==i.length&&S.indexOf("E")===-1){for(k=S.indexOf(".")-1,a=B;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===B?i[a].v.indexOf(".")-1:i[a].v.length-1,b=i[a].v.substr(u+1);u>=0;--u)k>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(b=S.charAt(k--)+b);i[a].v=b,i[a].t="t",D=a}for(k>=0&&D<i.length&&(i[D].v=S.substr(0,k+1)+i[D].v),k=S.indexOf(".")+1,a=B;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==B)){for(u=i[a].v.indexOf(".")>-1&&a===B?i[a].v.indexOf(".")+1:0,b=i[a].v.substr(0,u);u<i[a].v.length;++u)k<S.length&&(b+=S.charAt(k++));i[a].v=b,i[a].t="t",D=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(I=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=vi(i[a].t,i[a].v,I),i[a].t="t");var H="";for(a=0;a!==i.length;++a)i[a]!=null&&(H+=i[a].v);return H}var ox=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function lx(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Fk(e,t){var r=bk(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(ox),o=r[1].match(ox);return lx(t,a)?[n,r[0]]:lx(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Fn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:He)[e],n==null&&(n=r.table&&r.table[ix[e]]||He[ix[e]]),n==null&&(n=hk[e]||"General");break}if(gu(n,0))return js(t,r);t instanceof Date&&(t=t2(t,r.date1904));var i=Fk(n,t);if(gu(i[1]))return js(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Ik(i[1],t,r,i[0])}function yi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(He[r]==null){t<0&&(t=r);continue}if(He[r]==e){t=r;break}}t<0&&(t=391)}return He[t]=e,t}function Yu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&yi(e[t],t)}function no(){He=dk()}var Rk={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},u2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Pk(e){var t=typeof e=="number"?He[e]:e;return t=t.replace(u2,"(\\d+)"),new RegExp("^"+t+"$")}function Mk(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,c=-1;(t.match(u2)||[]).forEach(function(h,m){var x=parseInt(r[m+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=x;break;case"d":s=x;break;case"h":a=x;break;case"s":c=x;break;case"m":a>=0?o=x:i=x;break}}),c>=0&&o==-1&&i>=0&&(o=i,i=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?l:n==-1&&i==-1&&s==-1?u:l+"T"+u}var Dk=function(){var e={};e.version="1.2.0";function t(){for(var S=0,B=new Array(256),D=0;D!=256;++D)S=D,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,B[D]=S;return typeof Int32Array<"u"?new Int32Array(B):B}var r=t();function n(S){var B=0,D=0,H=0,Y=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(H=0;H!=256;++H)Y[H]=S[H];for(H=0;H!=256;++H)for(D=S[H],B=256+H;B<4096;B+=256)D=Y[B]=D>>>8^S[D&255];var q=[];for(H=1;H!=16;++H)q[H-1]=typeof Int32Array<"u"?Y.subarray(H*256,H*256+256):Y.slice(H*256,H*256+256);return q}var i=n(r),s=i[0],a=i[1],o=i[2],c=i[3],l=i[4],u=i[5],h=i[6],m=i[7],x=i[8],g=i[9],v=i[10],y=i[11],E=i[12],w=i[13],T=i[14];function k(S,B){for(var D=B^-1,H=0,Y=S.length;H<Y;)D=D>>>8^r[(D^S.charCodeAt(H++))&255];return~D}function b(S,B){for(var D=B^-1,H=S.length-15,Y=0;Y<H;)D=T[S[Y++]^D&255]^w[S[Y++]^D>>8&255]^E[S[Y++]^D>>16&255]^y[S[Y++]^D>>>24]^v[S[Y++]]^g[S[Y++]]^x[S[Y++]]^m[S[Y++]]^h[S[Y++]]^u[S[Y++]]^l[S[Y++]]^c[S[Y++]]^o[S[Y++]]^a[S[Y++]]^s[S[Y++]]^r[S[Y++]];for(H+=15;Y<H;)D=D>>>8^r[(D^S[Y++])&255];return~D}function I(S,B){for(var D=B^-1,H=0,Y=S.length,q=0,ue=0;H<Y;)q=S.charCodeAt(H++),q<128?D=D>>>8^r[(D^q)&255]:q<2048?(D=D>>>8^r[(D^(192|q>>6&31))&255],D=D>>>8^r[(D^(128|q&63))&255]):q>=55296&&q<57344?(q=(q&1023)+64,ue=S.charCodeAt(H++)&1023,D=D>>>8^r[(D^(240|q>>8&7))&255],D=D>>>8^r[(D^(128|q>>2&63))&255],D=D>>>8^r[(D^(128|ue>>6&15|(q&3)<<4))&255],D=D>>>8^r[(D^(128|ue&63))&255]):(D=D>>>8^r[(D^(224|q>>12&15))&255],D=D>>>8^r[(D^(128|q>>6&63))&255],D=D>>>8^r[(D^(128|q&63))&255]);return~D}return e.table=r,e.bstr=k,e.buf=b,e.str=I,e}(),je=function(){var t={};t.version="1.2.1";function r(A,L){for(var P=A.split("/"),M=L.split("/"),U=0,j=0,re=Math.min(P.length,M.length);U<re;++U){if(j=P[U].length-M[U].length)return j;if(P[U]!=M[U])return P[U]<M[U]?-1:1}return P.length-M.length}function n(A){if(A.charAt(A.length-1)=="/")return A.slice(0,-1).indexOf("/")===-1?A:n(A.slice(0,-1));var L=A.lastIndexOf("/");return L===-1?A:A.slice(0,L+1)}function i(A){if(A.charAt(A.length-1)=="/")return i(A.slice(0,-1));var L=A.lastIndexOf("/");return L===-1?A:A.slice(L+1)}function s(A,L){typeof L=="string"&&(L=new Date(L));var P=L.getHours();P=P<<6|L.getMinutes(),P=P<<5|L.getSeconds()>>>1,A.write_shift(2,P);var M=L.getFullYear()-1980;M=M<<4|L.getMonth()+1,M=M<<5|L.getDate(),A.write_shift(2,M)}function a(A){var L=A.read_shift(2)&65535,P=A.read_shift(2)&65535,M=new Date,U=P&31;P>>>=5;var j=P&15;P>>>=4,M.setMilliseconds(0),M.setFullYear(P+1980),M.setMonth(j-1),M.setDate(U);var re=L&31;L>>>=5;var fe=L&63;return L>>>=6,M.setHours(L),M.setMinutes(fe),M.setSeconds(re<<1),M}function o(A){xr(A,0);for(var L={},P=0;A.l<=A.length-4;){var M=A.read_shift(2),U=A.read_shift(2),j=A.l+U,re={};switch(M){case 21589:P=A.read_shift(1),P&1&&(re.mtime=A.read_shift(4)),U>5&&(P&2&&(re.atime=A.read_shift(4)),P&4&&(re.ctime=A.read_shift(4))),re.mtime&&(re.mt=new Date(re.mtime*1e3));break}A.l=j,L[M]=re}return L}var c;function l(){return c||(c={})}function u(A,L){if(A[0]==80&&A[1]==75)return Yn(A,L);if((A[0]|32)==109&&(A[1]|32)==105)return Yl(A,L);if(A.length<512)throw new Error("CFB file size "+A.length+" < 512");var P=3,M=512,U=0,j=0,re=0,fe=0,ee=0,ne=[],ie=A.slice(0,512);xr(ie,0);var we=h(ie);switch(P=we[0],P){case 3:M=512;break;case 4:M=4096;break;case 0:if(we[1]==0)return Yn(A,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}M!==512&&(ie=A.slice(0,M),xr(ie,28));var Ae=A.slice(0,M);m(ie,P);var Oe=ie.read_shift(4,"i");if(P===3&&Oe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Oe);ie.l+=4,re=ie.read_shift(4,"i"),ie.l+=4,ie.chk("00100000","Mini Stream Cutoff Size: "),fe=ie.read_shift(4,"i"),U=ie.read_shift(4,"i"),ee=ie.read_shift(4,"i"),j=ie.read_shift(4,"i");for(var Se=-1,Me=0;Me<109&&(Se=ie.read_shift(4,"i"),!(Se<0));++Me)ne[Me]=Se;var qe=x(A,M);y(ee,j,qe,M,ne);var vt=w(qe,re,ne,M);vt[re].name="!Directory",U>0&&fe!==ue&&(vt[fe].name="!MiniFAT"),vt[ne[0]].name="!FAT",vt.fat_addrs=ne,vt.ssz=M;var Et={},sr=[],Di=[],Li=[];T(re,vt,qe,sr,U,Et,Di,fe),g(Di,Li,sr),sr.shift();var Oi={FileIndex:Di,FullPaths:Li};return L&&L.raw&&(Oi.raw={header:Ae,sectors:qe}),Oi}function h(A){if(A[A.l]==80&&A[A.l+1]==75)return[0,0];A.chk(Te,"Header Signature: "),A.l+=16;var L=A.read_shift(2,"u");return[A.read_shift(2,"u"),L]}function m(A,L){var P=9;switch(A.l+=2,P=A.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}A.chk("0600","Mini Sector Shift: "),A.chk("000000000000","Reserved: ")}function x(A,L){for(var P=Math.ceil(A.length/L)-1,M=[],U=1;U<P;++U)M[U-1]=A.slice(U*L,(U+1)*L);return M[P-1]=A.slice(P*L),M}function g(A,L,P){for(var M=0,U=0,j=0,re=0,fe=0,ee=P.length,ne=[],ie=[];M<ee;++M)ne[M]=ie[M]=M,L[M]=P[M];for(;fe<ie.length;++fe)M=ie[fe],U=A[M].L,j=A[M].R,re=A[M].C,ne[M]===M&&(U!==-1&&ne[U]!==U&&(ne[M]=ne[U]),j!==-1&&ne[j]!==j&&(ne[M]=ne[j])),re!==-1&&(ne[re]=M),U!==-1&&M!=ne[M]&&(ne[U]=ne[M],ie.lastIndexOf(U)<fe&&ie.push(U)),j!==-1&&M!=ne[M]&&(ne[j]=ne[M],ie.lastIndexOf(j)<fe&&ie.push(j));for(M=1;M<ee;++M)ne[M]===M&&(j!==-1&&ne[j]!==j?ne[M]=ne[j]:U!==-1&&ne[U]!==U&&(ne[M]=ne[U]));for(M=1;M<ee;++M)if(A[M].type!==0){if(fe=M,fe!=ne[fe])do fe=ne[fe],L[M]=L[fe]+"/"+L[M];while(fe!==0&&ne[fe]!==-1&&fe!=ne[fe]);ne[M]=-1}for(L[0]+="/",M=1;M<ee;++M)A[M].type!==2&&(L[M]+="/")}function v(A,L,P){for(var M=A.start,U=A.size,j=[],re=M;P&&U>0&&re>=0;)j.push(L.slice(re*q,re*q+q)),U-=q,re=Ss(P,re*4);return j.length===0?le(0):lr(j).slice(0,A.size)}function y(A,L,P,M,U){var j=ue;if(A===ue){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(A!==-1){var re=P[A],fe=(M>>>2)-1;if(!re)return;for(var ee=0;ee<fe&&(j=Ss(re,ee*4))!==ue;++ee)U.push(j);y(Ss(re,M-4),L-1,P,M,U)}}function E(A,L,P,M,U){var j=[],re=[];U||(U=[]);var fe=M-1,ee=0,ne=0;for(ee=L;ee>=0;){U[ee]=!0,j[j.length]=ee,re.push(A[ee]);var ie=P[Math.floor(ee*4/M)];if(ne=ee*4&fe,M<4+ne)throw new Error("FAT boundary crossed: "+ee+" 4 "+M);if(!A[ie])break;ee=Ss(A[ie],ne)}return{nodes:j,data:wx([re])}}function w(A,L,P,M){var U=A.length,j=[],re=[],fe=[],ee=[],ne=M-1,ie=0,we=0,Ae=0,Oe=0;for(ie=0;ie<U;++ie)if(fe=[],Ae=ie+L,Ae>=U&&(Ae-=U),!re[Ae]){ee=[];var Se=[];for(we=Ae;we>=0;){Se[we]=!0,re[we]=!0,fe[fe.length]=we,ee.push(A[we]);var Me=P[Math.floor(we*4/M)];if(Oe=we*4&ne,M<4+Oe)throw new Error("FAT boundary crossed: "+we+" 4 "+M);if(!A[Me]||(we=Ss(A[Me],Oe),Se[we]))break}j[Ae]={nodes:fe,data:wx([ee])}}return j}function T(A,L,P,M,U,j,re,fe){for(var ee=0,ne=M.length?2:0,ie=L[A].data,we=0,Ae=0,Oe;we<ie.length;we+=128){var Se=ie.slice(we,we+128);xr(Se,64),Ae=Se.read_shift(2),Oe=Oh(Se,0,Ae-ne),M.push(Oe);var Me={name:Oe,type:Se.read_shift(1),color:Se.read_shift(1),L:Se.read_shift(4,"i"),R:Se.read_shift(4,"i"),C:Se.read_shift(4,"i"),clsid:Se.read_shift(16),state:Se.read_shift(4,"i"),start:0,size:0},qe=Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2);qe!==0&&(Me.ct=k(Se,Se.l-8));var vt=Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2);vt!==0&&(Me.mt=k(Se,Se.l-8)),Me.start=Se.read_shift(4,"i"),Me.size=Se.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=ue,Me.name=""),Me.type===5?(ee=Me.start,U>0&&ee!==ue&&(L[ee].name="!StreamData")):Me.size>=4096?(Me.storage="fat",L[Me.start]===void 0&&(L[Me.start]=E(P,Me.start,L.fat_addrs,L.ssz)),L[Me.start].name=Me.name,Me.content=L[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:ee!==ue&&Me.start!==ue&&L[ee]&&(Me.content=v(Me,L[ee].data,(L[fe]||{}).data))),Me.content&&xr(Me.content,0),j[Oe]=Me,re.push(Me)}}function k(A,L){return new Date((an(A,L+4)/1e7*Math.pow(2,32)+an(A,L)/1e7-11644473600)*1e3)}function b(A,L){return l(),u(c.readFileSync(A),L)}function I(A,L){var P=L&&L.type;switch(P||et&&Buffer.isBuffer(A)&&(P="buffer"),P||"base64"){case"file":return b(A,L);case"base64":return u(on(dn(A)),L);case"binary":return u(on(A),L)}return u(A,L)}function S(A,L){var P=L||{},M=P.root||"Root Entry";if(A.FullPaths||(A.FullPaths=[]),A.FileIndex||(A.FileIndex=[]),A.FullPaths.length!==A.FileIndex.length)throw new Error("inconsistent CFB structure");A.FullPaths.length===0&&(A.FullPaths[0]=M+"/",A.FileIndex[0]={name:M,type:5}),P.CLSID&&(A.FileIndex[0].clsid=P.CLSID),B(A)}function B(A){var L="Sh33tJ5";if(!je.find(A,"/"+L)){var P=le(4);P[0]=55,P[1]=P[3]=50,P[2]=54,A.FileIndex.push({name:L,type:2,content:P,size:4,L:69,R:69,C:69}),A.FullPaths.push(A.FullPaths[0]+L),D(A)}}function D(A,L){S(A);for(var P=!1,M=!1,U=A.FullPaths.length-1;U>=0;--U){var j=A.FileIndex[U];switch(j.type){case 0:M?P=!0:(A.FileIndex.pop(),A.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(j.R*j.L*j.C)&&(P=!0),j.R>-1&&j.L>-1&&j.R==j.L&&(P=!0);break;default:P=!0;break}}if(!(!P&&!L)){var re=new Date(1987,1,19),fe=0,ee=Object.create?Object.create(null):{},ne=[];for(U=0;U<A.FullPaths.length;++U)ee[A.FullPaths[U]]=!0,A.FileIndex[U].type!==0&&ne.push([A.FullPaths[U],A.FileIndex[U]]);for(U=0;U<ne.length;++U){var ie=n(ne[U][0]);M=ee[ie],M||(ne.push([ie,{name:i(ie).replace("/",""),type:1,clsid:te,ct:re,mt:re,content:null}]),ee[ie]=!0)}for(ne.sort(function(Oe,Se){return r(Oe[0],Se[0])}),A.FullPaths=[],A.FileIndex=[],U=0;U<ne.length;++U)A.FullPaths[U]=ne[U][0],A.FileIndex[U]=ne[U][1];for(U=0;U<ne.length;++U){var we=A.FileIndex[U],Ae=A.FullPaths[U];if(we.name=i(Ae).replace("/",""),we.L=we.R=we.C=-(we.color=1),we.size=we.content?we.content.length:0,we.start=0,we.clsid=we.clsid||te,U===0)we.C=ne.length>1?1:-1,we.size=0,we.type=5;else if(Ae.slice(-1)=="/"){for(fe=U+1;fe<ne.length&&n(A.FullPaths[fe])!=Ae;++fe);for(we.C=fe>=ne.length?-1:fe,fe=U+1;fe<ne.length&&n(A.FullPaths[fe])!=n(Ae);++fe);we.R=fe>=ne.length?-1:fe,we.type=1}else n(A.FullPaths[U+1]||"")==n(Ae)&&(we.R=U+1),we.type=2}}}function H(A,L){var P=L||{};if(P.fileType=="mad")return fo(A,P);switch(D(A),P.fileType){case"zip":return co(A,P)}var M=function(Oe){for(var Se=0,Me=0,qe=0;qe<Oe.FileIndex.length;++qe){var vt=Oe.FileIndex[qe];if(vt.content){var Et=vt.content.length;Et>0&&(Et<4096?Se+=Et+63>>6:Me+=Et+511>>9)}}for(var sr=Oe.FullPaths.length+3>>2,Di=Se+7>>3,Li=Se+127>>7,Oi=Di+Me+sr+Li,fr=Oi+127>>7,sa=fr<=109?0:Math.ceil((fr-109)/127);Oi+fr+sa+127>>7>fr;)sa=++fr<=109?0:Math.ceil((fr-109)/127);var Pn=[1,sa,fr,Li,sr,Me,Se,0];return Oe.FileIndex[0].size=Se<<6,Pn[7]=(Oe.FileIndex[0].start=Pn[0]+Pn[1]+Pn[2]+Pn[3]+Pn[4]+Pn[5])+(Pn[6]+7>>3),Pn}(A),U=le(M[7]<<9),j=0,re=0;{for(j=0;j<8;++j)U.write_shift(1,W[j]);for(j=0;j<8;++j)U.write_shift(2,0);for(U.write_shift(2,62),U.write_shift(2,3),U.write_shift(2,65534),U.write_shift(2,9),U.write_shift(2,6),j=0;j<3;++j)U.write_shift(2,0);for(U.write_shift(4,0),U.write_shift(4,M[2]),U.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),U.write_shift(4,0),U.write_shift(4,4096),U.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:ue),U.write_shift(4,M[3]),U.write_shift(-4,M[1]?M[0]-1:ue),U.write_shift(4,M[1]),j=0;j<109;++j)U.write_shift(-4,j<M[2]?M[1]+j:-1)}if(M[1])for(re=0;re<M[1];++re){for(;j<236+re*127;++j)U.write_shift(-4,j<M[2]?M[1]+j:-1);U.write_shift(-4,re===M[1]-1?ue:re+1)}var fe=function(Oe){for(re+=Oe;j<re-1;++j)U.write_shift(-4,j+1);Oe&&(++j,U.write_shift(-4,ue))};for(re=j=0,re+=M[1];j<re;++j)U.write_shift(-4,ge.DIFSECT);for(re+=M[2];j<re;++j)U.write_shift(-4,ge.FATSECT);fe(M[3]),fe(M[4]);for(var ee=0,ne=0,ie=A.FileIndex[0];ee<A.FileIndex.length;++ee)ie=A.FileIndex[ee],ie.content&&(ne=ie.content.length,!(ne<4096)&&(ie.start=re,fe(ne+511>>9)));for(fe(M[6]+7>>3);U.l&511;)U.write_shift(-4,ge.ENDOFCHAIN);for(re=j=0,ee=0;ee<A.FileIndex.length;++ee)ie=A.FileIndex[ee],ie.content&&(ne=ie.content.length,!(!ne||ne>=4096)&&(ie.start=re,fe(ne+63>>6)));for(;U.l&511;)U.write_shift(-4,ge.ENDOFCHAIN);for(j=0;j<M[4]<<2;++j){var we=A.FullPaths[j];if(!we||we.length===0){for(ee=0;ee<17;++ee)U.write_shift(4,0);for(ee=0;ee<3;++ee)U.write_shift(4,-1);for(ee=0;ee<12;++ee)U.write_shift(4,0);continue}ie=A.FileIndex[j],j===0&&(ie.start=ie.size?ie.start-1:ue);var Ae=j===0&&P.root||ie.name;if(ne=2*(Ae.length+1),U.write_shift(64,Ae,"utf16le"),U.write_shift(2,ne),U.write_shift(1,ie.type),U.write_shift(1,ie.color),U.write_shift(-4,ie.L),U.write_shift(-4,ie.R),U.write_shift(-4,ie.C),ie.clsid)U.write_shift(16,ie.clsid,"hex");else for(ee=0;ee<4;++ee)U.write_shift(4,0);U.write_shift(4,ie.state||0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,ie.start),U.write_shift(4,ie.size),U.write_shift(4,0)}for(j=1;j<A.FileIndex.length;++j)if(ie=A.FileIndex[j],ie.size>=4096)if(U.l=ie.start+1<<9,et&&Buffer.isBuffer(ie.content))ie.content.copy(U,U.l,0,ie.size),U.l+=ie.size+511&-512;else{for(ee=0;ee<ie.size;++ee)U.write_shift(1,ie.content[ee]);for(;ee&511;++ee)U.write_shift(1,0)}for(j=1;j<A.FileIndex.length;++j)if(ie=A.FileIndex[j],ie.size>0&&ie.size<4096)if(et&&Buffer.isBuffer(ie.content))ie.content.copy(U,U.l,0,ie.size),U.l+=ie.size+63&-64;else{for(ee=0;ee<ie.size;++ee)U.write_shift(1,ie.content[ee]);for(;ee&63;++ee)U.write_shift(1,0)}if(et)U.l=U.length;else for(;U.l<U.length;)U.write_shift(1,0);return U}function Y(A,L){var P=A.FullPaths.map(function(ee){return ee.toUpperCase()}),M=P.map(function(ee){var ne=ee.split("/");return ne[ne.length-(ee.slice(-1)=="/"?2:1)]}),U=!1;L.charCodeAt(0)===47?(U=!0,L=P[0].slice(0,-1)+L):U=L.indexOf("/")!==-1;var j=L.toUpperCase(),re=U===!0?P.indexOf(j):M.indexOf(j);if(re!==-1)return A.FileIndex[re];var fe=!j.match(Mo);for(j=j.replace(Br,""),fe&&(j=j.replace(Mo,"!")),re=0;re<P.length;++re)if((fe?P[re].replace(Mo,"!"):P[re]).replace(Br,"")==j||(fe?M[re].replace(Mo,"!"):M[re]).replace(Br,"")==j)return A.FileIndex[re];return null}var q=64,ue=-2,Te="d0cf11e0a1b11ae1",W=[208,207,17,224,161,177,26,225],te="00000000000000000000000000000000",ge={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ue,FREESECT:-1,HEADER_SIGNATURE:Te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(A,L,P){l();var M=H(A,P);c.writeFileSync(L,M)}function J(A){for(var L=new Array(A.length),P=0;P<A.length;++P)L[P]=String.fromCharCode(A[P]);return L.join("")}function de(A,L){var P=H(A,L);switch(L&&L.type||"buffer"){case"file":return l(),c.writeFileSync(L.filename,P),P;case"binary":return typeof P=="string"?P:J(P);case"base64":return Tl(typeof P=="string"?P:J(P));case"buffer":if(et)return Buffer.isBuffer(P)?P:Ai(P);case"array":return typeof P=="string"?on(P):P}return P}var Z;function R(A){try{var L=A.InflateRaw,P=new L;if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),P.bytesRead)Z=A;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function G(A,L){if(!Z)return qt(A,L);var P=Z.InflateRaw,M=new P,U=M._processChunk(A.slice(A.l),M._finishFlushFlag);return A.l+=M.bytesRead,U}function F(A){return Z?Z.deflateRawSync(A):Ke(A)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(A){var L=(A<<1|A<<11)&139536|(A<<5|A<<15)&558144;return(L>>16|L>>8|L)&255}for(var ve=typeof Uint8Array<"u",ye=ve?new Uint8Array(256):[],Ge=0;Ge<256;++Ge)ye[Ge]=ae(Ge);function C(A,L){var P=ye[A&255];return L<=8?P>>>8-L:(P=P<<8|ye[A>>8&255],L<=16?P>>>16-L:(P=P<<8|ye[A>>16&255],P>>>24-L))}function Re(A,L){var P=L&7,M=L>>>3;return(A[M]|(P<=6?0:A[M+1]<<8))>>>P&3}function Ve(A,L){var P=L&7,M=L>>>3;return(A[M]|(P<=5?0:A[M+1]<<8))>>>P&7}function dt(A,L){var P=L&7,M=L>>>3;return(A[M]|(P<=4?0:A[M+1]<<8))>>>P&15}function Ze(A,L){var P=L&7,M=L>>>3;return(A[M]|(P<=3?0:A[M+1]<<8))>>>P&31}function Ie(A,L){var P=L&7,M=L>>>3;return(A[M]|(P<=1?0:A[M+1]<<8))>>>P&127}function wt(A,L,P){var M=L&7,U=L>>>3,j=(1<<P)-1,re=A[U]>>>M;return P<8-M||(re|=A[U+1]<<8-M,P<16-M)||(re|=A[U+2]<<16-M,P<24-M)||(re|=A[U+3]<<24-M),re&j}function Mr(A,L,P){var M=L&7,U=L>>>3;return M<=5?A[U]|=(P&7)<<M:(A[U]|=P<<M&255,A[U+1]=(P&7)>>8-M),L+3}function Gr(A,L,P){var M=L&7,U=L>>>3;return P=(P&1)<<M,A[U]|=P,L+1}function Vr(A,L,P){var M=L&7,U=L>>>3;return P<<=M,A[U]|=P&255,P>>>=8,A[U+1]=P,L+8}function ra(A,L,P){var M=L&7,U=L>>>3;return P<<=M,A[U]|=P&255,P>>>=8,A[U+1]=P&255,A[U+2]=P>>>8,L+16}function tn(A,L){var P=A.length,M=2*P>L?2*P:L+5,U=0;if(P>=L)return A;if(et){var j=tx(M);if(A.copy)A.copy(j);else for(;U<A.length;++U)j[U]=A[U];return j}else if(ve){var re=new Uint8Array(M);if(re.set)re.set(A);else for(;U<P;++U)re[U]=A[U];return re}return A.length=M,A}function Qt(A){for(var L=new Array(A),P=0;P<A;++P)L[P]=0;return L}function mn(A,L,P){var M=1,U=0,j=0,re=0,fe=0,ee=A.length,ne=ve?new Uint16Array(32):Qt(32);for(j=0;j<32;++j)ne[j]=0;for(j=ee;j<P;++j)A[j]=0;ee=A.length;var ie=ve?new Uint16Array(ee):Qt(ee);for(j=0;j<ee;++j)ne[U=A[j]]++,M<U&&(M=U),ie[j]=0;for(ne[0]=0,j=1;j<=M;++j)ne[j+16]=fe=fe+ne[j-1]<<1;for(j=0;j<ee;++j)fe=A[j],fe!=0&&(ie[j]=ne[fe+16]++);var we=0;for(j=0;j<ee;++j)if(we=A[j],we!=0)for(fe=C(ie[j],M)>>M-we,re=(1<<M+4-we)-1;re>=0;--re)L[fe|re<<we]=we&15|j<<4;return M}var Kn=ve?new Uint16Array(512):Qt(512),ui=ve?new Uint16Array(32):Qt(32);if(!ve){for(var lt=0;lt<512;++lt)Kn[lt]=0;for(lt=0;lt<32;++lt)ui[lt]=0}(function(){for(var A=[],L=0;L<32;L++)A.push(5);mn(A,ui,32);var P=[];for(L=0;L<=143;L++)P.push(8);for(;L<=255;L++)P.push(9);for(;L<=279;L++)P.push(7);for(;L<=287;L++)P.push(8);mn(P,Kn,288)})();var rn=function(){for(var L=ve?new Uint8Array(32768):[],P=0,M=0;P<he.length-1;++P)for(;M<he[P+1];++M)L[M]=P;for(;M<32768;++M)L[M]=29;var U=ve?new Uint8Array(259):[];for(P=0,M=0;P<X.length-1;++P)for(;M<X[P+1];++M)U[M]=P;function j(fe,ee){for(var ne=0;ne<fe.length;){var ie=Math.min(65535,fe.length-ne),we=ne+ie==fe.length;for(ee.write_shift(1,+we),ee.write_shift(2,ie),ee.write_shift(2,~ie&65535);ie-- >0;)ee[ee.l++]=fe[ne++]}return ee.l}function re(fe,ee){for(var ne=0,ie=0,we=ve?new Uint16Array(32768):[];ie<fe.length;){var Ae=Math.min(65535,fe.length-ie);if(Ae<10){for(ne=Mr(ee,ne,+(ie+Ae==fe.length)),ne&7&&(ne+=8-(ne&7)),ee.l=ne/8|0,ee.write_shift(2,Ae),ee.write_shift(2,~Ae&65535);Ae-- >0;)ee[ee.l++]=fe[ie++];ne=ee.l*8;continue}ne=Mr(ee,ne,+(ie+Ae==fe.length)+2);for(var Oe=0;Ae-- >0;){var Se=fe[ie];Oe=(Oe<<5^Se)&32767;var Me=-1,qe=0;if((Me=we[Oe])&&(Me|=ie&-32768,Me>ie&&(Me-=32768),Me<ie))for(;fe[Me+qe]==fe[ie+qe]&&qe<250;)++qe;if(qe>2){Se=U[qe],Se<=22?ne=Vr(ee,ne,ye[Se+1]>>1)-1:(Vr(ee,ne,3),ne+=5,Vr(ee,ne,ye[Se-23]>>5),ne+=3);var vt=Se<8?0:Se-4>>2;vt>0&&(ra(ee,ne,qe-X[Se]),ne+=vt),Se=L[ie-Me],ne=Vr(ee,ne,ye[Se]>>3),ne-=3;var Et=Se<4?0:Se-2>>1;Et>0&&(ra(ee,ne,ie-Me-he[Se]),ne+=Et);for(var sr=0;sr<qe;++sr)we[Oe]=ie&32767,Oe=(Oe<<5^fe[ie])&32767,++ie;Ae-=qe-1}else Se<=143?Se=Se+48:ne=Gr(ee,ne,1),ne=Vr(ee,ne,ye[Se]),we[Oe]=ie&32767,++ie}ne=Vr(ee,ne,0)-1}return ee.l=(ne+7)/8|0,ee.l}return function(ee,ne){return ee.length<8?j(ee,ne):re(ee,ne)}}();function Ke(A){var L=le(50+Math.floor(A.length*1.1)),P=rn(A,L);return L.slice(0,P)}var _t=ve?new Uint16Array(32768):Qt(32768),nt=ve?new Uint16Array(32768):Qt(32768),ht=ve?new Uint16Array(128):Qt(128),Gt=1,Pi=1;function Mi(A,L){var P=Ze(A,L)+257;L+=5;var M=Ze(A,L)+1;L+=5;var U=dt(A,L)+4;L+=4;for(var j=0,re=ve?new Uint8Array(19):Qt(19),fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,ne=ve?new Uint8Array(8):Qt(8),ie=ve?new Uint8Array(8):Qt(8),we=re.length,Ae=0;Ae<U;++Ae)re[O[Ae]]=j=Ve(A,L),ee<j&&(ee=j),ne[j]++,L+=3;var Oe=0;for(ne[0]=0,Ae=1;Ae<=ee;++Ae)ie[Ae]=Oe=Oe+ne[Ae-1]<<1;for(Ae=0;Ae<we;++Ae)(Oe=re[Ae])!=0&&(fe[Ae]=ie[Oe]++);var Se=0;for(Ae=0;Ae<we;++Ae)if(Se=re[Ae],Se!=0){Oe=ye[fe[Ae]]>>8-Se;for(var Me=(1<<7-Se)-1;Me>=0;--Me)ht[Oe|Me<<Se]=Se&7|Ae<<3}var qe=[];for(ee=1;qe.length<P+M;)switch(Oe=ht[Ie(A,L)],L+=Oe&7,Oe>>>=3){case 16:for(j=3+Re(A,L),L+=2,Oe=qe[qe.length-1];j-- >0;)qe.push(Oe);break;case 17:for(j=3+Ve(A,L),L+=3;j-- >0;)qe.push(0);break;case 18:for(j=11+Ie(A,L),L+=7;j-- >0;)qe.push(0);break;default:qe.push(Oe),ee<Oe&&(ee=Oe);break}var vt=qe.slice(0,P),Et=qe.slice(P);for(Ae=P;Ae<286;++Ae)vt[Ae]=0;for(Ae=M;Ae<30;++Ae)Et[Ae]=0;return Gt=mn(vt,_t,286),Pi=mn(Et,nt,30),L}function xs(A,L){if(A[0]==3&&!(A[1]&3))return[ss(L),2];for(var P=0,M=0,U=tx(L||1<<18),j=0,re=U.length>>>0,fe=0,ee=0;!(M&1);){if(M=Ve(A,P),P+=3,M>>>1)M>>1==1?(fe=9,ee=5):(P=Mi(A,P),fe=Gt,ee=Pi);else{P&7&&(P+=8-(P&7));var ne=A[P>>>3]|A[(P>>>3)+1]<<8;if(P+=32,ne>0)for(!L&&re<j+ne&&(U=tn(U,j+ne),re=U.length);ne-- >0;)U[j++]=A[P>>>3],P+=8;continue}for(;;){!L&&re<j+32767&&(U=tn(U,j+32767),re=U.length);var ie=wt(A,P,fe),we=M>>>1==1?Kn[ie]:_t[ie];if(P+=we&15,we>>>=4,!(we>>>8&255))U[j++]=we;else{if(we==256)break;we-=257;var Ae=we<8?0:we-4>>2;Ae>5&&(Ae=0);var Oe=j+X[we];Ae>0&&(Oe+=wt(A,P,Ae),P+=Ae),ie=wt(A,P,ee),we=M>>>1==1?ui[ie]:nt[ie],P+=we&15,we>>>=4;var Se=we<4?0:we-2>>1,Me=he[we];for(Se>0&&(Me+=wt(A,P,Se),P+=Se),!L&&re<Oe&&(U=tn(U,Oe+100),re=U.length);j<Oe;)U[j]=U[j-Me],++j}}}return L?[U,P+7>>>3]:[U.slice(0,j),P+7>>>3]}function qt(A,L){var P=A.slice(A.l||0),M=xs(P,L);return A.l+=M[1],M[0]}function xn(A,L){if(A)typeof console<"u"&&console.error(L);else throw new Error(L)}function Yn(A,L){var P=A;xr(P,0);var M=[],U=[],j={FileIndex:M,FullPaths:U};S(j,{root:L.root});for(var re=P.length-4;(P[re]!=80||P[re+1]!=75||P[re+2]!=5||P[re+3]!=6)&&re>=0;)--re;P.l=re+4,P.l+=4;var fe=P.read_shift(2);P.l+=6;var ee=P.read_shift(4);for(P.l=ee,re=0;re<fe;++re){P.l+=20;var ne=P.read_shift(4),ie=P.read_shift(4),we=P.read_shift(2),Ae=P.read_shift(2),Oe=P.read_shift(2);P.l+=8;var Se=P.read_shift(4),Me=o(P.slice(P.l+we,P.l+we+Ae));P.l+=we+Ae+Oe;var qe=P.l;P.l=Se+4,na(P,ne,ie,j,Me),P.l=qe}return j}function na(A,L,P,M,U){A.l+=2;var j=A.read_shift(2),re=A.read_shift(2),fe=a(A);if(j&8257)throw new Error("Unsupported ZIP encryption");for(var ee=A.read_shift(4),ne=A.read_shift(4),ie=A.read_shift(4),we=A.read_shift(2),Ae=A.read_shift(2),Oe="",Se=0;Se<we;++Se)Oe+=String.fromCharCode(A[A.l++]);if(Ae){var Me=o(A.slice(A.l,A.l+Ae));(Me[21589]||{}).mt&&(fe=Me[21589].mt),((U||{})[21589]||{}).mt&&(fe=U[21589].mt)}A.l+=Ae;var qe=A.slice(A.l,A.l+ne);switch(re){case 8:qe=G(A,ie);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+re)}var vt=!1;j&8&&(ee=A.read_shift(4),ee==134695760&&(ee=A.read_shift(4),vt=!0),ne=A.read_shift(4),ie=A.read_shift(4)),ne!=L&&xn(vt,"Bad compressed size: "+L+" != "+ne),ie!=P&&xn(vt,"Bad uncompressed size: "+P+" != "+ie),wr(M,Oe,qe,{unsafe:!0,mt:fe})}function co(A,L){var P=L||{},M=[],U=[],j=le(1),re=P.compression?8:0,fe=0,ee=0,ne=0,ie=0,we=0,Ae=A.FullPaths[0],Oe=Ae,Se=A.FileIndex[0],Me=[],qe=0;for(ee=1;ee<A.FullPaths.length;++ee)if(Oe=A.FullPaths[ee].slice(Ae.length),Se=A.FileIndex[ee],!(!Se.size||!Se.content||Oe=="Sh33tJ5")){var vt=ie,Et=le(Oe.length);for(ne=0;ne<Oe.length;++ne)Et.write_shift(1,Oe.charCodeAt(ne)&127);Et=Et.slice(0,Et.l),Me[we]=Dk.buf(Se.content,0);var sr=Se.content;re==8&&(sr=F(sr)),j=le(30),j.write_shift(4,67324752),j.write_shift(2,20),j.write_shift(2,fe),j.write_shift(2,re),Se.mt?s(j,Se.mt):j.write_shift(4,0),j.write_shift(-4,Me[we]),j.write_shift(4,sr.length),j.write_shift(4,Se.content.length),j.write_shift(2,Et.length),j.write_shift(2,0),ie+=j.length,M.push(j),ie+=Et.length,M.push(Et),ie+=sr.length,M.push(sr),j=le(46),j.write_shift(4,33639248),j.write_shift(2,0),j.write_shift(2,20),j.write_shift(2,fe),j.write_shift(2,re),j.write_shift(4,0),j.write_shift(-4,Me[we]),j.write_shift(4,sr.length),j.write_shift(4,Se.content.length),j.write_shift(2,Et.length),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(4,0),j.write_shift(4,vt),qe+=j.l,U.push(j),qe+=Et.length,U.push(Et),++we}return j=le(22),j.write_shift(4,101010256),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,we),j.write_shift(2,we),j.write_shift(4,qe),j.write_shift(4,ie),j.write_shift(2,0),lr([lr(M),lr(U),j])}var gs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function uf(A,L){if(A.ctype)return A.ctype;var P=A.name||"",M=P.match(/\.([^\.]+)$/);return M&&gs[M[1]]||L&&(M=(P=L).match(/[\.\\]([^\.\\])+$/),M&&gs[M[1]])?gs[M[1]]:"application/octet-stream"}function Zt(A){for(var L=Tl(A),P=[],M=0;M<L.length;M+=76)P.push(L.slice(M,M+76));return P.join(`\r
`)+`\r
`}function vs(A){var L=A.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ne){var ie=ne.charCodeAt(0).toString(16).toUpperCase();return"="+(ie.length==1?"0"+ie:ie)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var P=[],M=L.split(`\r
`),U=0;U<M.length;++U){var j=M[U];if(j.length==0){P.push("");continue}for(var re=0;re<j.length;){var fe=76,ee=j.slice(re,re+fe);ee.charAt(fe-1)=="="?fe--:ee.charAt(fe-2)=="="?fe-=2:ee.charAt(fe-3)=="="&&(fe-=3),ee=j.slice(re,re+fe),re+=fe,re<j.length&&(ee+="="),P.push(ee)}}return P.join(`\r
`)}function fi(A){for(var L=[],P=0;P<A.length;++P){for(var M=A[P];P<=A.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+A[++P];L.push(M)}for(var U=0;U<L.length;++U)L[U]=L[U].replace(/[=][0-9A-Fa-f]{2}/g,function(j){return String.fromCharCode(parseInt(j.slice(1),16))});return on(L.join(`\r
`))}function uo(A,L,P){for(var M="",U="",j="",re,fe=0;fe<10;++fe){var ee=L[fe];if(!ee||ee.match(/^\s*$/))break;var ne=ee.match(/^(.*?):\s*([^\s].*)$/);if(ne)switch(ne[1].toLowerCase()){case"content-location":M=ne[2].trim();break;case"content-type":j=ne[2].trim();break;case"content-transfer-encoding":U=ne[2].trim();break}}switch(++fe,U.toLowerCase()){case"base64":re=on(dn(L.slice(fe).join("")));break;case"quoted-printable":re=fi(L.slice(fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+U)}var ie=wr(A,M.slice(P.length),re,{unsafe:!0});j&&(ie.ctype=j)}function Yl(A,L){if(J(A.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var P=L&&L.root||"",M=(et&&Buffer.isBuffer(A)?A.toString("binary"):J(A)).split(`\r
`),U=0,j="";for(U=0;U<M.length;++U)if(j=M[U],!!/^Content-Location:/i.test(j)&&(j=j.slice(j.indexOf("file")),P||(P=j.slice(0,j.lastIndexOf("/")+1)),j.slice(0,P.length)!=P))for(;P.length>0&&(P=P.slice(0,P.length-1),P=P.slice(0,P.lastIndexOf("/")+1),j.slice(0,P.length)!=P););var re=(M[1]||"").match(/boundary="(.*?)"/);if(!re)throw new Error("MAD cannot find boundary");var fe="--"+(re[1]||""),ee=[],ne=[],ie={FileIndex:ee,FullPaths:ne};S(ie);var we,Ae=0;for(U=0;U<M.length;++U){var Oe=M[U];Oe!==fe&&Oe!==fe+"--"||(Ae++&&uo(ie,M.slice(we,U),P),we=U)}return ie}function fo(A,L){var P=L||{},M=P.boundary||"SheetJS";M="------="+M;for(var U=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],j=A.FullPaths[0],re=j,fe=A.FileIndex[0],ee=1;ee<A.FullPaths.length;++ee)if(re=A.FullPaths[ee].slice(j.length),fe=A.FileIndex[ee],!(!fe.size||!fe.content||re=="Sh33tJ5")){re=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(qe){return"_x"+qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(qe){return"_u"+qe.charCodeAt(0).toString(16)+"_"});for(var ne=fe.content,ie=et&&Buffer.isBuffer(ne)?ne.toString("binary"):J(ne),we=0,Ae=Math.min(1024,ie.length),Oe=0,Se=0;Se<=Ae;++Se)(Oe=ie.charCodeAt(Se))>=32&&Oe<128&&++we;var Me=we>=Ae*4/5;U.push(M),U.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+re),U.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),U.push("Content-Type: "+uf(fe,re)),U.push(""),U.push(Me?vs(ie):Zt(ie))}return U.push(M+`--\r
`),U.join(`\r
`)}function Xl(A){var L={};return S(L,A),L}function wr(A,L,P,M){var U=M&&M.unsafe;U||S(A);var j=!U&&je.find(A,L);if(!j){var re=A.FullPaths[0];L.slice(0,re.length)==re?re=L:(re.slice(-1)!="/"&&(re+="/"),re=(re+L).replace("//","/")),j={name:i(L),type:2},A.FileIndex.push(j),A.FullPaths.push(re),U||je.utils.cfb_gc(A)}return j.content=P,j.size=P?P.length:0,M&&(M.CLSID&&(j.clsid=M.CLSID),M.mt&&(j.mt=M.mt),M.ct&&(j.ct=M.ct)),j}function it(A,L){S(A);var P=je.find(A,L);if(P){for(var M=0;M<A.FileIndex.length;++M)if(A.FileIndex[M]==P)return A.FileIndex.splice(M,1),A.FullPaths.splice(M,1),!0}return!1}function Hr(A,L,P){S(A);var M=je.find(A,L);if(M){for(var U=0;U<A.FileIndex.length;++U)if(A.FileIndex[U]==M)return A.FileIndex[U].name=i(P),A.FullPaths[U]=P,!0}return!1}function ia(A){D(A,!0)}return t.find=Y,t.read=I,t.parse=u,t.write=de,t.writeFile=oe,t.utils={cfb_new:Xl,cfb_add:wr,cfb_del:it,cfb_mov:Hr,cfb_gc:ia,ReadShift:qo,CheckField:R2,prep_blob:xr,bconcat:lr,use_zlib:R,_deflateRaw:Ke,_inflateRaw:qt,consts:ge},t}();function Lk(e){return typeof e=="string"?Ku(e):Array.isArray(e)?lk(e):e}function jl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Ku(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?si(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([Lk(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=ds(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Ok(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function jt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function cx(e,t){for(var r=[],n=jt(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function Xu(e){for(var t=[],r=jt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Qu(e){for(var t=[],r=jt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function Uk(e){for(var t=[],r=jt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var yu=new Date(1899,11,30,0,0,0);function ir(e,t){var r=e.getTime(),n=yu.getTime()+(e.getTimezoneOffset()-yu.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var f2=new Date,Bk=yu.getTime()+(f2.getTimezoneOffset()-yu.getTimezoneOffset())*6e4,ux=f2.getTimezoneOffset();function Zu(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Bk),t.getTimezoneOffset()!==ux&&t.setTime(t.getTime()+(t.getTimezoneOffset()-ux)*6e4),t}function $k(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var fx=new Date("2017-02-19T19:06:09.000Z"),d2=isNaN(fx.getFullYear())?new Date("2/19/17"):fx,jk=d2.getFullYear()==2017;function At(e,t){var r=new Date(e);if(jk)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(d2.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Gs(e,t){if(et&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return si(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return si(Zy(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return si(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return si(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function bt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=bt(e[r]));return t}function Bt(e,t){for(var r="";r.length<t;)r+=e;return r}function Hn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var Gk=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ka(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&Gk.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Vk=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function h2(e){return e?e.content&&e.type?Gs(e.content,!0):e.data?Po(e.data):e.asNodeBuffer&&et?Po(e.asNodeBuffer().toString("binary")):e.asBinary?Po(e.asBinary()):e._data&&e._data.getContent?Po(Gs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function p2(e){if(!e)return null;if(e.data)return Zm(e.data);if(e.asNodeBuffer&&et)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Zm(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Hk(e){return e&&e.name.slice(-4)===".bin"?p2(e):h2(e)}function En(e,t){for(var r=e.FullPaths||jt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Fh(e,t){var r=En(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Kt(e,t,r){if(!r)return Hk(Fh(e,t));if(!t)return null;try{return Kt(e,t)}catch{return null}}function ln(e,t,r){if(!r)return h2(Fh(e,t));if(!t)return null;try{return ln(e,t)}catch{return null}}function zk(e,t,r){return p2(Fh(e,t))}function dx(e){for(var t=e.FullPaths||jt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Qe(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return et?n=Ai(r):n=ck(r),je.utils.cfb_add(e,t,n)}je.utils.cfb_add(e,t,r)}else e.file(t,r)}function Rh(){return je.utils.cfb_new()}function m2(e,t){switch(t.type){case"base64":return je.read(e,{type:"base64"});case"binary":return je.read(e,{type:"binary"});case"buffer":case"array":return je.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Do(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Wt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Wk=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,hx=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,qk=/<[^>]*>/g,Pr=Wt.match(hx)?hx:qk,Jk=/<\w*:/,Kk=/<(\/?)\w+:/;function We(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var a=e.match(Wk),o=0,c="",l=0,u="",h="",m=1;if(a)for(l=0;l!=a.length;++l){for(h=a[l],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(u=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(m=(i=h.charCodeAt(s+1))==34||i==39?1:0,c=h.slice(s+1+m,h.length-m),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,n[u.toLowerCase()]=c;else{var x=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[x]&&u.slice(o-3,o)=="ext")continue;n[x]=c,n[x.toLowerCase()]=c}}return n}function li(e){return e.replace(Kk,"<$1")}var x2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ph=Xu(x2),at=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(o,c){return x2[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),Mh=/[&<>'"]/g,Yk=/[\u0000-\u0008\u000b-\u001f]/g;function xt(e){var t=e+"";return t.replace(Mh,function(r){return Ph[r]}).replace(Yk,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function px(e){return xt(e).replace(/ /g,"_x0020_")}var g2=/[\u0000-\u001f]/g;function Dh(e){var t=e+"";return t.replace(Mh,function(r){return Ph[r]}).replace(/\n/g,"<br/>").replace(g2,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Xk(e){var t=e+"";return t.replace(Mh,function(r){return Ph[r]}).replace(g2,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var mx=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Qk(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ct(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Wf(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function xx(e){var t=ss(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function gx(e){return Ai(e,"binary").toString("utf8")}var vc="foo bar baz",yt=et&&(gx(vc)==Wf(vc)&&gx||xx(vc)==Wf(vc)&&xx)||Wf,si=et?function(e){return Ai(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Sl=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),v2=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),Zk=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),eC=/<\/?(?:vt:)?variant>/g,tC=/<(?:vt:)([^>]*)>([\s\S]*)</;function vx(e,t){var r=We(e),n=e.match(Zk(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(eC,"").match(tC);a&&i.push({v:yt(a[2]),t:a[1]})}),i}var y2=/(^\s|\s$|\n)/;function gr(e,t){return"<"+e+(t.match(y2)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function kl(e){return jt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ce(e,t,r){return"<"+e+(r!=null?kl(r):"")+(t!=null?(t.match(y2)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function l0(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function rC(e,t){switch(typeof e){case"string":var r=Ce("vt:lpwstr",xt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ce((e|0)==e?"vt:i4":"vt:r8",xt(String(e)));case"boolean":return Ce("vt:bool",e?"true":"false")}if(e instanceof Date)return Ce("vt:filetime",l0(e));throw new Error("Unable to serialize "+e)}function Lh(e){if(et&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return yt(ds(Ah(e)));throw new Error("Bad input format: expected Buffer or string")}var Cl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,rr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ks=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],sn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function nC(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function iC(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var yx=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},wx=et?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ai(t)})):yx(e)}:yx,Ex=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(xi(e,i)));return n.join("").replace(Br,"")},Oh=et?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Br,""):Ex(e,t,r)}:Ex,Tx=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},w2=et?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Tx(e,t,r)}:Tx,_x=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(fa(e,i)));return n.join("")},Gl=et?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):_x(t,r,n)}:_x,E2=function(e,t){var r=an(e,t);return r>0?Gl(e,t+4,t+4+r-1):""},T2=E2,_2=function(e,t){var r=an(e,t);return r>0?Gl(e,t+4,t+4+r-1):""},S2=_2,k2=function(e,t){var r=2*an(e,t);return r>0?Gl(e,t+4,t+4+r-1):""},C2=k2,N2=function(t,r){var n=an(t,r);return n>0?Oh(t,r+4,r+4+n):""},A2=N2,b2=function(e,t){var r=an(e,t);return r>0?Gl(e,t+4,t+4+r):""},I2=b2,F2=function(e,t){return nC(e,t)},wu=F2,Uh=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};et&&(T2=function(t,r){if(!Buffer.isBuffer(t))return E2(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},S2=function(t,r){if(!Buffer.isBuffer(t))return _2(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},C2=function(t,r){if(!Buffer.isBuffer(t))return k2(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},A2=function(t,r){if(!Buffer.isBuffer(t))return N2(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},I2=function(t,r){if(!Buffer.isBuffer(t))return b2(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},wu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):F2(t,r)},Uh=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var fa=function(e,t){return e[t]},xi=function(e,t){return e[t+1]*256+e[t]},sC=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},an=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ss=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},aC=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function qo(e,t){var r="",n,i,s=[],a,o,c,l;switch(t){case"dbcs":if(l=this.l,et&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(xi(this,l)),l+=2;e*=2;break;case"utf8":r=Gl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Oh(this,this.l,this.l+e);break;case"wstr":return qo.call(this,e,"dbcs");case"lpstr-ansi":r=T2(this,this.l),e=4+an(this,this.l);break;case"lpstr-cp":r=S2(this,this.l),e=4+an(this,this.l);break;case"lpwstr":r=C2(this,this.l),e=4+2*an(this,this.l);break;case"lpp4":e=4+an(this,this.l),r=A2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+an(this,this.l),r=I2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=fa(this,this.l+e++))!==0;)s.push(gc(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=xi(this,this.l+e))!==0;)s.push(gc(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",l=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=fa(this,l),this.l=l+1,o=qo.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(gc(xi(this,l))),l+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",l=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=fa(this,l),this.l=l+1,o=qo.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(gc(fa(this,l))),l+=1}r=s.join("");break;default:switch(e){case 1:return n=fa(this,this.l),this.l++,n;case 2:return n=(t==="i"?sC:xi)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ss:aC)(this,this.l),this.l+=4,n):(i=an(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=wu(this,this.l):i=wu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=w2(this,this.l,e);break}}return this.l+=e,r}var oC=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},lC=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},cC=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function uC(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)cC(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,oC(this,t,this.l);break;case 8:if(n=8,r==="f"){iC(this,t,this.l);break}case 16:break;case-4:n=4,lC(this,t,this.l);break}return this.l+=n,this}function R2(e,t){var r=w2(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function xr(e,t){e.l=t,e.read_shift=qo,e.chk=R2,e.write_shift=uC}function Rr(e,t){e.l+=t}function le(e){var t=ss(e);return xr(t,0),t}function bi(e,t,r){if(e){var n,i,s;xr(e,e.l||0);for(var a=e.length,o=0,c=0;e.l<a;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var l=Rl[o]||Rl[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;c=e.l+s;var u=l.f&&l.f(e,s,r);if(e.l=c,t(u,l,o))return}}}function Zr(){var e=[],t=et?256:2048,r=function(l){var u=le(l);return xr(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(l){return n&&l<n.length-n.l?n:(i(),n=r(Math.max(l+1,t)))},a=function(){return i(),lr(e)},o=function(l){i(),n=l,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function xe(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=Rl[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=e.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Uh(r)&&e.push(r)}}function Jo(e,t,r){var n=bt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Sx(e,t,r){var n=bt(e);return n.s=Jo(n.s,t.s,r),n.e=Jo(n.e,t.s,r),n}function Ko(e,t){if(e.cRel&&e.c<0)for(e=bt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=bt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ze(e);return!e.cRel&&e.cRel!=null&&(r=hC(r)),!e.rRel&&e.rRel!=null&&(r=fC(r)),r}function qf(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Mt(e.s.c)+":"+(e.e.cRel?"":"$")+Mt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+zt(e.s.r)+":"+(e.e.rRel?"":"$")+zt(e.e.r):Ko(e.s,t.biff)+":"+Ko(e.e,t.biff)}function Bh(e){return parseInt(dC(e),10)-1}function zt(e){return""+(e+1)}function fC(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function dC(e){return e.replace(/\$(\d+)$/,"$1")}function $h(e){for(var t=pC(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Mt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function hC(e){return e.replace(/^([A-Z])/,"$$$1")}function pC(e){return e.replace(/^\$([A-Z])/,"$1")}function mC(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Dt(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function ze(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function en(e){var t=e.indexOf(":");return t==-1?{s:Dt(e),e:Dt(e)}:{s:Dt(e.slice(0,t)),e:Dt(e.slice(t+1))}}function Xe(e,t){return typeof t>"u"||typeof t=="number"?Xe(e.s,e.e):(typeof e!="string"&&(e=ze(e)),typeof t!="string"&&(t=ze(t)),e==t?e:e+":"+t)}function ot(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function kx(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Fn(e.z,r?ir(t):t)}catch{}try{return e.w=Fn((e.XF||{}).numFmtId||(r?14:0),r?ir(t):t)}catch{return""+t}}function ki(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ii[e.v]||e.v:t==null?kx(e,e.v):kx(e,t))}function hs(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function P2(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Dt(n.origin):n.origin;a=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=ot(s["!ref"]);l.s.c=u.s.c,l.s.r=u.s.r,l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),a==-1&&(l.e.r=a=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[h].length;++m)if(!(typeof t[h][m]>"u")){var x={v:t[h][m]},g=a+h,v=o+m;if(l.s.r>g&&(l.s.r=g),l.s.c>v&&(l.s.c=v),l.e.r<g&&(l.e.r=g),l.e.c<v&&(l.e.c=v),t[h][m]&&typeof t[h][m]=="object"&&!Array.isArray(t[h][m])&&!(t[h][m]instanceof Date))x=t[h][m];else if(Array.isArray(x.v)&&(x.f=t[h][m][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||He[14],n.cellDates?(x.t="d",x.w=Fn(x.z,ir(x.v))):(x.t="n",x.v=ir(x.v),x.w=Fn(x.z,x.v))):x.t="s";if(i)s[g]||(s[g]=[]),s[g][v]&&s[g][v].z&&(x.z=s[g][v].z),s[g][v]=x;else{var y=ze({c:v,r:g});s[y]&&s[y].z&&(x.z=s[y].z),s[y]=x}}}return l.s.c<1e7&&(s["!ref"]=Xe(l)),s}function io(e,t){return P2(null,e,t)}function xC(e){return e.read_shift(4,"i")}function zn(e,t){return t||(t=le(4)),t.write_shift(4,e),t}function Ir(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function cr(e,t){var r=!1;return t==null&&(r=!0,t=le(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function gC(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function vC(e,t){return t||(t=le(4)),t.write_shift(2,0),t.write_shift(2,0),t}function jh(e,t){var r=e.l,n=e.read_shift(1),i=Ir(e),s=[],a={t:i,h:i};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)s.push(gC(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function yC(e,t){var r=!1;return t==null&&(r=!0,t=le(15+4*e.t.length)),t.write_shift(1,0),cr(e.t,t),r?t.slice(0,t.l):t}var wC=jh;function EC(e,t){var r=!1;return t==null&&(r=!0,t=le(23+4*e.t.length)),t.write_shift(1,1),cr(e.t,t),t.write_shift(4,1),vC({},t),r?t.slice(0,t.l):t}function Rn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ys(e,t){return t==null&&(t=le(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Xs(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Qs(e,t){return t==null&&(t=le(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var TC=Ir,M2=cr;function Gh(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Eu(e,t){var r=!1;return t==null&&(r=!0,t=le(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var _C=Ir,c0=Gh,Vh=Eu;function Hh(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?wu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ss(t,0)>>2;return r?i/100:i}function D2(e,t){t==null&&(t=le(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function L2(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function SC(e,t){return t||(t=le(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Zs=L2,so=SC;function Ar(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Vs(e,t){return(t||le(8)).write_shift(8,e,"f")}function kC(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var l=Rs[i];l&&(t.rgb=Al(l));break;case 2:t.rgb=Al([a,o,c]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Tu(e,t){if(t||(t=le(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function CC(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function NC(e,t){t||(t=le(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function O2(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function AC(e){return O2(e,1)}function bC(e){return O2(e,2)}var zh=2,qr=3,yc=11,Cx=12,_u=19,wc=64,IC=65,FC=71,RC=4108,PC=4126,ar=80,U2=81,MC=[ar,U2],u0={1:{n:"CodePage",t:zh},2:{n:"Category",t:ar},3:{n:"PresentationFormat",t:ar},4:{n:"ByteCount",t:qr},5:{n:"LineCount",t:qr},6:{n:"ParagraphCount",t:qr},7:{n:"SlideCount",t:qr},8:{n:"NoteCount",t:qr},9:{n:"HiddenCount",t:qr},10:{n:"MultimediaClipCount",t:qr},11:{n:"ScaleCrop",t:yc},12:{n:"HeadingPairs",t:RC},13:{n:"TitlesOfParts",t:PC},14:{n:"Manager",t:ar},15:{n:"Company",t:ar},16:{n:"LinksUpToDate",t:yc},17:{n:"CharacterCount",t:qr},19:{n:"SharedDoc",t:yc},22:{n:"HyperlinksChanged",t:yc},23:{n:"AppVersion",t:qr,p:"version"},24:{n:"DigSig",t:IC},26:{n:"ContentType",t:ar},27:{n:"ContentStatus",t:ar},28:{n:"Language",t:ar},29:{n:"Version",t:ar},255:{},2147483648:{n:"Locale",t:_u},2147483651:{n:"Behavior",t:_u},1919054434:{}},f0={1:{n:"CodePage",t:zh},2:{n:"Title",t:ar},3:{n:"Subject",t:ar},4:{n:"Author",t:ar},5:{n:"Keywords",t:ar},6:{n:"Comments",t:ar},7:{n:"Template",t:ar},8:{n:"LastAuthor",t:ar},9:{n:"RevNumber",t:ar},10:{n:"EditTime",t:wc},11:{n:"LastPrinted",t:wc},12:{n:"CreatedDate",t:wc},13:{n:"ModifiedDate",t:wc},14:{n:"PageCount",t:qr},15:{n:"WordCount",t:qr},16:{n:"CharCount",t:qr},17:{n:"Thumbnail",t:FC},18:{n:"Application",t:ar},19:{n:"DocSecurity",t:qr},255:{},2147483648:{n:"Locale",t:_u},2147483651:{n:"Behavior",t:_u},1919054434:{}},Nx={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},DC=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function LC(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var OC=LC([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Rs=bt(OC),Ii={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},B2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},d0={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ec={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Wh(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function UC(e){var t=Wh();if(!e||!e.match)return t;var r={};if((e.match(Pr)||[]).forEach(function(n){var i=We(n);switch(i[0].replace(Jk,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[d0[i.ContentType]]!==void 0&&t[d0[i.ContentType]].push(i.PartName);break}}),t.xmlns!==rr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function $2(e,t){var r=Uk(d0),n=[],i;n[n.length]=Wt,n[n.length]=Ce("Types",null,{xmlns:rr.CT,"xmlns:xsd":rr.xsd,"xmlns:xsi":rr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Ce("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(i=e[c][0],n[n.length]=Ce("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Ec[c][t.bookType]||Ec[c].xlsx}))},a=function(c){(e[c]||[]).forEach(function(l){n[n.length]=Ce("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:Ec[c][t.bookType]||Ec[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(l){n[n.length]=Ce("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:r[c][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var tt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Nl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Yo(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Pr)||[]).forEach(function(i){var s=We(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Do(s.Target,t);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function La(e){var t=[Wt,Ce("Relationships",null,{xmlns:rr.RELS})];return jt(e["!id"]).forEach(function(r){t[t.length]=Ce("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function mt(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[tt.HLINK,tt.XPATH,tt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var BC="application/vnd.oasis.opendocument.spreadsheet";function $C(e,t){for(var r=Lh(e),n,i;n=Cl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=We(n[0],!1),i.path=="/"&&i.type!==BC)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function jC(e){var t=[Wt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Ax(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function GC(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function VC(e){var t=[Wt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Ax(e[r][0],e[r][1])),t.push(GC("",e[r][0]));return t.push(Ax("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function j2(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+mu.version+"</meta:generator></office:meta></office:document-meta>"}var Nn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],HC=function(){for(var e=new Array(Nn.length),t=0;t<Nn.length;++t){var r=Nn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function G2(e){var t={};e=yt(e);for(var r=0;r<Nn.length;++r){var n=Nn[r],i=e.match(HC[r]);i!=null&&i.length>0&&(t[n[1]]=at(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=At(t[n[1]]))}return t}function Jf(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=xt(t),n[n.length]=r?Ce(e,t,r):gr(e,t))}function V2(e,t){var r=t||{},n=[Wt,Ce("cp:coreProperties",null,{"xmlns:cp":rr.CORE_PROPS,"xmlns:dc":rr.dc,"xmlns:dcterms":rr.dcterms,"xmlns:dcmitype":rr.dcmitype,"xmlns:xsi":rr.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Jf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:l0(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&Jf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:l0(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Nn.length;++s){var a=Nn[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Jf(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ps=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],H2=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function z2(e,t,r,n){var i=[];if(typeof e=="string")i=vx(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(u){return{v:u}}));var a=typeof t=="string"?vx(t,n).map(function(u){return u.v}):t,o=0,c=0;if(a.length>0)for(var l=0;l!==i.length;l+=2){switch(c=+i[l+1].v,i[l].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=a.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=a.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=a.slice(o,o+c);break}o+=c}}function zC(e,t,r){var n={};return t||(t={}),e=yt(e),Ps.forEach(function(i){var s=(e.match(Sl(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=at(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var a=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&z2(n.HeadingPairs,n.TitlesOfParts,t,r),t}function W2(e){var t=[],r=Ce;return e||(e={}),e.Application="SheetJS",t[t.length]=Wt,t[t.length]=Ce("Properties",null,{xmlns:rr.EXT_PROPS,"xmlns:vt":rr.vt}),Ps.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=xt(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+xt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var WC=/<[^>]+>[^<]*/g;function qC(e,t){var r={},n="",i=e.match(WC);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=We(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=at(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var c=a.split(">"),l=c[0].slice(4),u=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":r[n]=at(u);break;case"bool":r[n]=Ct(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=At(u);break;case"cy":case"error":r[n]=at(u);break;default:if(l.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",a,l,c)}}else if(a.slice(0,2)!=="</"){if(t.WTF)throw new Error(a)}}}return r}function q2(e){var t=[Wt,Ce("Properties",null,{xmlns:rr.CUST_PROPS,"xmlns:vt":rr.vt})];if(!e)return t.join("");var r=1;return jt(e).forEach(function(i){++r,t[t.length]=Ce("property",rC(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:xt(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var h0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Kf;function JC(e,t,r){Kf||(Kf=Xu(h0)),t=Kf[t]||t,e[t]=r}function KC(e,t){var r=[];return jt(h0).map(function(n){for(var i=0;i<Nn.length;++i)if(Nn[i][1]==n)return Nn[i];for(i=0;i<Ps.length;++i)if(Ps[i][1]==n)return Ps[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(gr(h0[n[1]]||n[1],i))}}),Ce("DocumentProperties",r.join(""),{xmlns:sn.o})}function YC(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&jt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var a=0;a<Nn.length;++a)if(s==Nn[a][1])return;for(a=0;a<Ps.length;++a)if(s==Ps[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=e[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),i.push(Ce(px(s),o,{"dt:dt":c}))}}),t&&jt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Ce(px(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+sn.o+'">'+i.join("")+"</"+n+">"}function qh(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function XC(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=le(8);return a.write_shift(4,n),a.write_shift(4,i),a}function J2(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function K2(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Y2(e,t,r){return t===31?K2(e):J2(e,t,r)}function p0(e,t,r){return Y2(e,t,r===!1?0:4)}function QC(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Y2(e,t,0)}function ZC(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Br,""),e.l-i&2&&(e.l+=2)}return r}function eN(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Br,"");return r}function tN(e){var t=e.l,r=Su(e,U2);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Su(e,qr);return[r,n]}function rN(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(tN(e));return r}function bx(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),a=e.read_shift(4);n[s]=e.read_shift(a,t===1200?"utf16le":"utf8").replace(Br,"").replace(Mo,"!"),t===1200&&a%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function X2(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function nN(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Su(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==Cx&&n!==t&&MC.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Cx?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return J2(e,n,4).replace(Br,"");case 31:return K2(e);case 64:return qh(e);case 65:return X2(e);case 71:return nN(e);case 80:return p0(e,n,!s.raw).replace(Br,"");case 81:return QC(e,n).replace(Br,"");case 4108:return rN(e);case 4126:case 4127:return n==4127?ZC(e):eN(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Ix(e,t){var r=le(4),n=le(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=le(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=XC(t);break;case 31:case 80:for(n=le(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return lr([r,n])}function Fx(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],a=0,o=0,c=-1,l={};for(a=0;a!=i;++a){var u=e.read_shift(4),h=e.read_shift(4);s[a]=[u,h+r]}s.sort(function(w,T){return w[1]-T[1]});var m={};for(a=0;a!=i;++a){if(e.l!==s[a][1]){var x=!0;if(a>0&&t)switch(t[s[a-1][0]].t){case 2:e.l+2===s[a][1]&&(e.l+=2,x=!1);break;case 80:e.l<=s[a][1]&&(e.l=s[a][1],x=!1);break;case 4108:e.l<=s[a][1]&&(e.l=s[a][1],x=!1);break}if((!t||a==0)&&e.l<=s[a][1]&&(x=!1,e.l=s[a][1]),x)throw new Error("Read Error: Expected address "+s[a][1]+" at "+e.l+" :"+a)}if(t){var g=t[s[a][0]];if(m[g.n]=Su(e,g.t,{raw:!0}),g.p==="version"&&(m[g.n]=String(m[g.n]>>16)+"."+("0000"+String(m[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(m[g.n]){case 0:m[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:$n(o=m[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[g.n])}}else if(s[a][0]===1){if(o=m.CodePage=Su(e,zh),$n(o),c!==-1){var v=e.l;e.l=s[c][1],l=bx(e,o),e.l=v}}else if(s[a][0]===0){if(o===0){c=a,e.l=s[a+1][1];continue}l=bx(e,o)}else{var y=l[s[a][0]],E;switch(e[e.l]){case 65:e.l+=4,E=X2(e);break;case 30:e.l+=4,E=p0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,E=p0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,E=e.read_shift(4,"i");break;case 19:e.l+=4,E=e.read_shift(4);break;case 5:e.l+=4,E=e.read_shift(8,"f");break;case 11:e.l+=4,E=Vt(e,4);break;case 64:e.l+=4,E=At(qh(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[y]=E}}return e.l=r+n,m}var Q2=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function iN(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Rx(e,t,r){var n=le(8),i=[],s=[],a=8,o=0,c=le(8),l=le(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),s.push(c),i.push(l),a+=8+c.length,!t){l=le(8),l.write_shift(4,0),i.unshift(l);var u=[le(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(c=le(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=lr(u),s.unshift(c),a+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Q2.indexOf(e[o][0])>-1||H2.indexOf(e[o][0])>-1)&&e[o][1]!=null){var m=e[o][1],x=0;if(t){x=+t[e[o][0]];var g=r[x];if(g.p=="version"&&typeof m=="string"){var v=m.split(".");m=(+v[0]<<16)+(+v[1]||0)}c=Ix(g.t,m)}else{var y=iN(m);y==-1&&(y=31,m=String(m)),c=Ix(y,m)}s.push(c),l=le(8),l.write_shift(4,t?x:2+o),i.push(l),a+=8+c.length}var E=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,E),E+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),lr([n].concat(i).concat(s))}function Px(e,t,r){var n=e.content;if(!n)return{};xr(n,0);var i,s,a,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),u=n.read_shift(16);if(u!==je.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),c=n.read_shift(4));var h=Fx(n,t),m={SystemIdentifier:l};for(var x in h)m[x]=h[x];if(m.FMTID=s,i===1)return m;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var g;try{g=Fx(n,null)}catch{}for(x in g)m[x]=g[x];return m.FMTID=[s,a],m}function Mx(e,t,r,n,i,s){var a=le(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,je.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var c=Rx(e,r,n);if(o.push(c),i){var l=Rx(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+c.length),o.push(l)}return lr(o)}function Bi(e,t){return e.read_shift(t),null}function sN(e,t){t||(t=le(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function aN(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Vt(e,t){return e.read_shift(t)===1}function Or(e,t){return t||(t=le(2)),t.write_shift(2,+!!e),t}function Yt(e){return e.read_shift(2,"u")}function Tn(e,t){return t||(t=le(2)),t.write_shift(2,e),t}function Z2(e,t){return aN(e,t,Yt)}function oN(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function ew(e,t,r){return r||(r=le(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Vl(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function lN(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,c={};i&&(a=e.read_shift(2)),n&&(o=e.read_shift(4));var l=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,l);return i&&(e.l+=4*a),n&&(e.l+=o),c.t=u,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function cN(e){var t=e.t||"",r=le(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=le(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return lr(i)}function Hs(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Hl(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Hs(e,n,r)}function ea(e,t,r){if(r.biff>5)return Hl(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function tw(e,t,r){return r||(r=le(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function uN(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function fN(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Br,"");return n&&(e.l+=24),i}function dN(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=e.read_shift(s>>1,"utf16le").replace(Br,"");return r+a}function hN(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return fN(e);case"0303000000000000c000000000000046":return dN(e);default:throw new Error("Unsupported Moniker "+r)}}function Tc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Br,""):"";return r}function Dx(e,t){t||(t=le(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function pN(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,a,o,c,l="",u,h;i&16&&(s=Tc(e,r-e.l)),i&128&&(a=Tc(e,r-e.l)),(i&257)===257&&(o=Tc(e,r-e.l)),(i&257)===1&&(c=hN(e,r-e.l)),i&8&&(l=Tc(e,r-e.l)),i&32&&(u=e.read_shift(16)),i&64&&(h=qh(e)),e.l=r;var m=a||o||c||"";m&&l&&(m+="#"+l),m||(m="#"+l),i&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var x={Target:m};return u&&(x.guid=u),h&&(x.time=h),s&&(x.Tooltip=s),x}function mN(e){var t=le(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(s==28)n=n.slice(1),Dx(n,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&Dx(i>-1?n.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function rw(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function nw(e,t){var r=rw(e);return r[3]=0,r}function ci(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function zs(e,t,r,n){return n||(n=le(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function xN(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function gN(e,t,r){return t===0?"":ea(e,t,r)}function vN(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function iw(e){var t=e.read_shift(2),r=Hh(e);return[t,r]}function yN(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=Vl(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function ef(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function sw(e,t){return t||(t=le(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function aw(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var wN=aw;function ow(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function EN(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function TN(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function _r(e){e.l+=2,e.l+=e.read_shift(2)}var _N={0:_r,4:_r,5:_r,6:_r,7:TN,8:_r,9:_r,10:_r,11:_r,12:_r,13:EN,14:_r,15:_r,16:_r,17:_r,18:_r,19:_r,20:_r,21:ow};function SN(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(_N[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function _c(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Jh(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=le(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function kN(e,t){return t===0||e.read_shift(2),1200}function CN(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=ea(e,0,r);return e.read_shift(t+n-e.l),i}function NN(e,t){var r=!t||t.biff==8,n=le(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function AN(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function bN(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Vl(e,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function IN(e,t){var r=!t||t.biff>=8?2:1,n=le(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function FN(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],a=0;a!=i&&e.l<r;++a)s.push(lN(e));return s.Count=n,s.Unique=i,s}function RN(e,t){var r=le(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=cN(e[i]);var s=lr([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function PN(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function MN(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function DN(e){var t=xN(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function LN(e){return e.read_shift(2),e.read_shift(4)}function Lx(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function ON(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:c,TabRatio:l}}function UN(){var e=le(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function BN(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function $N(e){var t=le(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function jN(){}function GN(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Vl(e,0,r),n}function VN(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=le(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function HN(e){var t=ci(e);return t.isst=e.read_shift(4),t}function zN(e,t,r,n){var i=le(10);return zs(e,t,n,i),i.write_shift(4,r),i}function WN(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=ci(e);r.biff==2&&e.l++;var s=Hl(e,n-e.l,r);return i.val=s,i}function qN(e,t,r,n,i){var s=!i||i.biff==8,a=le(8+ +s+(1+s)*r.length);return zs(e,t,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function JN(e,t,r){var n=e.read_shift(2),i=ea(e,0,r);return[n,i]}function KN(e,t,r,n){var i=r&&r.biff==5;n||(n=le(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var YN=ea;function Ox(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),a=e.read_shift(i),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:a,c}}}function XN(e,t){var r=t.biff==8||!t.biff?4:2,n=le(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function QN(e){var t=e.read_shift(2),r=e.read_shift(2),n=iw(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function ZN(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(iw(e));if(e.l!==r)throw new Error("MulRK read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function eA(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function tA(e,t,r,n){var i={},s=e.read_shift(4),a=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return i.patternType=DC[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function rA(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=tA(e,t,n.fStyle,r),n}function Ux(e,t,r,n){var i=r&&r.biff==5;n||(n=le(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function nA(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function iA(e){var t=le(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Bx(e,t,r){var n=ci(e);(r.biff==2||t==9)&&++e.l;var i=oN(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function sA(e,t,r,n,i,s){var a=le(8);return zs(e,t,n,a),ew(r,s,a),a}function aA(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ci(e),i=Ar(e);return n.val=i,n}function oA(e,t,r,n){var i=le(14);return zs(e,t,n,i),Vs(r,i),i}var $x=gN;function lA(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Hs(e,s),o=[];n>e.l;)o.push(Hl(e));return[s,i,a,o]}function jx(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=yN(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var cA=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Gx(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),a=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var l=Hs(e,a,r);i&32&&(l=cA[l.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var h=n==e.l||o===0||!(u>0)?[]:SF(e,u,r,o);return{chKey:s,Name:l,itab:c,rgce:h}}function lw(e,t,r){if(r.biff<8)return uA(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(vN(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function uA(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Vl(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function fA(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=Hs(e,n,r),a=Hs(e,i,r);return[s,a]}function dA(e,t,r){var n=aw(e);e.l++;var i=e.read_shift(1);return t-=8,[kF(e,t,r),i,n]}function Vx(e,t,r){var n=wN(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,TF(e,t,r)]}function hA(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function pA(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=ea(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,a,s]}}function mA(e,t,r){return pA(e,t,r)}function xA(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(ef(e));return r}function gA(e){var t=le(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)sw(e[r],t);return t}function vA(e,t,r){if(r&&r.biff<8)return wA(e,t,r);var n=ow(e),i=SN(e,t-22,n[1]);return{cmo:n,ft:i}}var yA={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function wA(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var a=[];return a.push((yA[n]||Rr)(e,t,r)),{cmo:[i,n,s],ft:a}}function EA(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:a=uN(e,6,r);var o=e.read_shift(2);e.read_shift(2),Yt(e,2);var c=e.read_shift(2);e.l+=c;for(var l=1;l<e.lens.length-1;++l){if(e.l-n!=e.lens[l])throw new Error("TxO: bad continue record");var u=e[e.l],h=Hs(e,e.lens[l+1]-e.lens[l]-1);if(i+=h,i.length>=(u?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function TA(e,t){var r=ef(e);e.l+=16;var n=pN(e,t-24);return[r,n]}function _A(e){var t=le(24),r=Dt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return lr([t,mN(e[1])])}function SA(e,t){e.read_shift(2);var r=ef(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Br,""),[r,n]}function kA(e){var t=e[1].Tooltip,r=le(10+2*(t.length+1));r.write_shift(2,2048);var n=Dt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function CA(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Nx[r]||r,r=e.read_shift(2),t[1]=Nx[r]||r,t}function NA(e){return e||(e=le(4)),e.write_shift(2,1),e.write_shift(2,1),e}function AA(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(nw(e));return r}function bA(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(nw(e));return r}function IA(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function cw(e,t,r){if(!r.cellStyles)return Rr(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var l={s:i,e:s,w:a,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(l.level=c>>8&7),l}function FA(e,t){var r=le(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function RA(e,t){var r={};return t<32||(e.l+=16,r.header=Ar(e),r.footer=Ar(e),e.l+=2),r}function PA(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function MA(e){for(var t=le(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var DA=ci,LA=Z2,OA=Hl;function UA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function BA(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ci(e);++e.l;var i=ea(e,t-7,r);return n.t="str",n.val=i,n}function $A(e){var t=ci(e);++e.l;var r=Ar(e);return t.t="n",t.val=r,t}function jA(e,t,r){var n=le(15);return Jl(n,e,t),n.write_shift(8,r,"f"),n}function GA(e){var t=ci(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function VA(e,t,r){var n=le(9);return Jl(n,e,t),n.write_shift(2,r),n}function HA(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function zA(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function WA(e,t,r){var n=e.l+t,i=ci(e),s=e.read_shift(2),a=Hs(e,s,r);return e.l=n,i.t="str",i.val=a,i}var qA=[2,3,48,49,131,139,140,245],m0=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Xu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var l=[],u=ss(1);switch(c.type){case"base64":u=on(dn(o));break;case"binary":u=on(o);break;case"buffer":case"array":u=o;break}xr(u,0);var h=u.read_shift(1),m=!!(h&136),x=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:x=!0,m=!0;break;case 49:x=!0,m=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var v=0,y=521;h==2&&(v=u.read_shift(2)),u.l+=3,h!=2&&(v=u.read_shift(4)),v>1048576&&(v=1e6),h!=2&&(y=u.read_shift(2));var E=u.read_shift(2),w=c.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=e[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var T=[],k={},b=Math.min(u.length,h==2?521:y-10-(x?264:0)),I=g?32:11;u.l<b&&u[u.l]!=13;)switch(k={},k.name=El.utils.decode(w,u.slice(u.l,u.l+I)).replace(/[\u0000\r\n].*$/g,""),u.l+=I,k.type=String.fromCharCode(u.read_shift(1)),h!=2&&!g&&(k.offset=u.read_shift(4)),k.len=u.read_shift(1),h==2&&(k.offset=u.read_shift(2)),k.dec=u.read_shift(1),k.name.length&&T.push(k),h!=2&&(u.l+=g?13:14),k.type){case"B":(!x||k.len!=8)&&c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(u[u.l]!==13&&(u.l=y-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=y;var S=0,B=0;for(l[0]=[],B=0;B!=T.length;++B)l[0][B]=T[B].name;for(;v-- >0;){if(u[u.l]===42){u.l+=E;continue}for(++u.l,l[++S]=[],B=0,B=0;B!=T.length;++B){var D=u.slice(u.l,u.l+T[B].len);u.l+=T[B].len,xr(D,0);var H=El.utils.decode(w,D);switch(T[B].type){case"C":H.trim().length&&(l[S][B]=H.replace(/\s+$/,""));break;case"D":H.length===8?l[S][B]=new Date(+H.slice(0,4),+H.slice(4,6)-1,+H.slice(6,8)):l[S][B]=H;break;case"F":l[S][B]=parseFloat(H.trim());break;case"+":case"I":l[S][B]=g?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(H.trim().toUpperCase()){case"Y":case"T":l[S][B]=!0;break;case"N":case"F":l[S][B]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+H+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));l[S][B]="##MEMO##"+(g?parseInt(H.trim(),10):D.read_shift(4));break;case"N":H=H.replace(/\u0000/g,"").trim(),H&&H!="."&&(l[S][B]=+H||0);break;case"@":l[S][B]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":l[S][B]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":l[S][B]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[S][B]=-D.read_shift(-8,"f");break;case"B":if(x&&T[B].len==8){l[S][B]=D.read_shift(8,"f");break}case"G":case"P":D.l+=T[B].len;break;case"0":if(T[B].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[B].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=T,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var u=io(r(o,l),l);return u["!cols"]=l.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete l.DBF,u}function i(o,c){try{return hs(n(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var l=c||{};if(+l.codepage>=0&&$n(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var u=Zr(),h=Au(o,{header:1,raw:!0,cellDates:!0}),m=h[0],x=h.slice(1),g=o["!cols"]||[],v=0,y=0,E=0,w=1;for(v=0;v<m.length;++v){if(((g[v]||{}).DBF||{}).name){m[v]=g[v].DBF.name,++E;continue}if(m[v]!=null){if(++E,typeof m[v]=="number"&&(m[v]=m[v].toString(10)),typeof m[v]!="string")throw new Error("DBF Invalid column name "+m[v]+" |"+typeof m[v]+"|");if(m.indexOf(m[v])!==v){for(y=0;y<1024;++y)if(m.indexOf(m[v]+"_"+y)==-1){m[v]+="_"+y;break}}}}var T=ot(o["!ref"]),k=[],b=[],I=[];for(v=0;v<=T.e.c-T.s.c;++v){var S="",B="",D=0,H=[];for(y=0;y<x.length;++y)x[y][v]!=null&&H.push(x[y][v]);if(H.length==0||m[v]==null){k[v]="?";continue}for(y=0;y<H.length;++y){switch(typeof H[y]){case"number":B="B";break;case"string":B="C";break;case"boolean":B="L";break;case"object":B=H[y]instanceof Date?"D":"C";break;default:B="C"}D=Math.max(D,String(H[y]).length),S=S&&S!=B?"C":B}D>250&&(D=250),B=((g[v]||{}).DBF||{}).type,B=="C"&&g[v].DBF.len>D&&(D=g[v].DBF.len),S=="B"&&B=="N"&&(S="N",I[v]=g[v].DBF.dec,D=g[v].DBF.len),b[v]=S=="C"||B=="N"?D:s[S]||0,w+=b[v],k[v]=S}var Y=u.next(32);for(Y.write_shift(4,318902576),Y.write_shift(4,x.length),Y.write_shift(2,296+32*E),Y.write_shift(2,w),v=0;v<4;++v)Y.write_shift(4,0);for(Y.write_shift(4,0|(+t[Qy]||3)<<8),v=0,y=0;v<m.length;++v)if(m[v]!=null){var q=u.next(32),ue=(m[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);q.write_shift(1,ue,"sbcs"),q.write_shift(1,k[v]=="?"?"C":k[v],"sbcs"),q.write_shift(4,y),q.write_shift(1,b[v]||s[k[v]]||0),q.write_shift(1,I[v]||0),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(1,0),q.write_shift(4,0),q.write_shift(4,0),y+=b[v]||s[k[v]]||0}var Te=u.next(264);for(Te.write_shift(4,13),v=0;v<65;++v)Te.write_shift(4,0);for(v=0;v<x.length;++v){var W=u.next(w);for(W.write_shift(1,0),y=0;y<m.length;++y)if(m[y]!=null)switch(k[y]){case"L":W.write_shift(1,x[v][y]==null?63:x[v][y]?84:70);break;case"B":W.write_shift(8,x[v][y]||0,"f");break;case"N":var te="0";for(typeof x[v][y]=="number"&&(te=x[v][y].toFixed(I[y]||0)),E=0;E<b[y]-te.length;++E)W.write_shift(1,32);W.write_shift(1,te,"sbcs");break;case"D":x[v][y]?(W.write_shift(4,("0000"+x[v][y].getFullYear()).slice(-4),"sbcs"),W.write_shift(2,("00"+(x[v][y].getMonth()+1)).slice(-2),"sbcs"),W.write_shift(2,("00"+x[v][y].getDate()).slice(-2),"sbcs")):W.write_shift(8,"00000000","sbcs");break;case"C":var ge=String(x[v][y]!=null?x[v][y]:"").slice(0,b[y]);for(W.write_shift(1,ge,"sbcs"),E=0;E<b[y]-ge.length;++E)W.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),uw=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+jt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,x){var g=e[x];return typeof g=="number"?ex(g):g},n=function(m,x,g){var v=x.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return v==59?m:ex(v)};e["|"]=254;function i(m,x){switch(x.type){case"base64":return s(dn(m),x);case"binary":return s(m,x);case"buffer":return s(et&&Buffer.isBuffer(m)?m.toString("binary"):ds(m),x);case"array":return s(Gs(m),x)}throw new Error("Unrecognized type "+x.type)}function s(m,x){var g=m.split(/[\n\r]+/),v=-1,y=-1,E=0,w=0,T=[],k=[],b=null,I={},S=[],B=[],D=[],H=0,Y;for(+x.codepage>=0&&$n(+x.codepage);E!==g.length;++E){H=0;var q=g[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ue=q.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),Te=ue[0],W;if(q.length>0)switch(Te){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ue[1].charAt(0)=="P"&&k.push(q.slice(3).replace(/;;/g,";"));break;case"C":var te=!1,ge=!1,oe=!1,J=!1,de=-1,Z=-1;for(w=1;w<ue.length;++w)switch(ue[w].charAt(0)){case"A":break;case"X":y=parseInt(ue[w].slice(1))-1,ge=!0;break;case"Y":for(v=parseInt(ue[w].slice(1))-1,ge||(y=0),Y=T.length;Y<=v;++Y)T[Y]=[];break;case"K":W=ue[w].slice(1),W.charAt(0)==='"'?W=W.slice(1,W.length-1):W==="TRUE"?W=!0:W==="FALSE"?W=!1:isNaN(Hn(W))?isNaN(Ka(W).getDate())||(W=At(W)):(W=Hn(W),b!==null&&ro(b)&&(W=Zu(W))),te=!0;break;case"E":J=!0;var R=Oa(ue[w].slice(1),{r:v,c:y});T[v][y]=[T[v][y],R];break;case"S":oe=!0,T[v][y]=[T[v][y],"S5S"];break;case"G":break;case"R":de=parseInt(ue[w].slice(1))-1;break;case"C":Z=parseInt(ue[w].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+q)}if(te&&(T[v][y]&&T[v][y].length==2?T[v][y][0]=W:T[v][y]=W,b=null),oe){if(J)throw new Error("SYLK shared formula cannot have own formula");var G=de>-1&&T[de][Z];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");T[v][y][1]=Aw(G[1],{r:v-de,c:y-Z})}break;case"F":var F=0;for(w=1;w<ue.length;++w)switch(ue[w].charAt(0)){case"X":y=parseInt(ue[w].slice(1))-1,++F;break;case"Y":for(v=parseInt(ue[w].slice(1))-1,Y=T.length;Y<=v;++Y)T[Y]=[];break;case"M":H=parseInt(ue[w].slice(1))/20;break;case"F":break;case"G":break;case"P":b=k[parseInt(ue[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=ue[w].slice(1).split(" "),Y=parseInt(D[0],10);Y<=parseInt(D[1],10);++Y)H=parseInt(D[2],10),B[Y-1]=H===0?{hidden:!0}:{wch:H},as(B[Y-1]);break;case"C":y=parseInt(ue[w].slice(1))-1,B[y]||(B[y]={});break;case"R":v=parseInt(ue[w].slice(1))-1,S[v]||(S[v]={}),H>0?(S[v].hpt=H,S[v].hpx=Xa(H)):H===0&&(S[v].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+q)}F<1&&(b=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+q)}}return S.length>0&&(I["!rows"]=S),B.length>0&&(I["!cols"]=B),x&&x.sheetRows&&(T=T.slice(0,x.sheetRows)),[T,I]}function a(m,x){var g=i(m,x),v=g[0],y=g[1],E=io(v,x);return jt(y).forEach(function(w){E[w]=y[w]}),E}function o(m,x){return hs(a(m,x),x)}function c(m,x,g,v){var y="C;Y"+(g+1)+";X"+(v+1)+";K";switch(m.t){case"n":y+=m.v||0,m.f&&!m.F&&(y+=";E"+ep(m.f,{r:g,c:v}));break;case"b":y+=m.v?"TRUE":"FALSE";break;case"e":y+=m.w||m.v;break;case"d":y+='"'+(m.w||m.v)+'"';break;case"s":y+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function l(m,x){x.forEach(function(g,v){var y="F;W"+(v+1)+" "+(v+1)+" ";g.hidden?y+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=bl(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Il(g.wpx)),typeof g.wch=="number"&&(y+=Math.round(g.wch))),y.charAt(y.length-1)!=" "&&m.push(y)})}function u(m,x){x.forEach(function(g,v){var y="F;";g.hidden?y+="M0;":g.hpt?y+="M"+20*g.hpt+";":g.hpx&&(y+="M"+20*Fl(g.hpx)+";"),y.length>2&&m.push(y+"R"+(v+1))})}function h(m,x){var g=["ID;PWXL;N;E"],v=[],y=ot(m["!ref"]),E,w=Array.isArray(m),T=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),m["!cols"]&&l(g,m["!cols"]),m["!rows"]&&u(g,m["!rows"]),g.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var k=y.s.r;k<=y.e.r;++k)for(var b=y.s.c;b<=y.e.c;++b){var I=ze({r:k,c:b});E=w?(m[k]||[])[b]:m[I],!(!E||E.v==null&&(!E.f||E.F))&&v.push(c(E,m,k,b))}return g.join(T)+T+v.join(T)+T+"E"+T}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),fw=function(){function e(s,a){switch(a.type){case"base64":return t(dn(s),a);case"binary":return t(s,a);case"buffer":return t(et&&Buffer.isBuffer(s)?s.toString("binary"):ds(s),a);case"array":return t(Gs(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),c=-1,l=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++c]=[],l=0;continue}if(!(c<0)){var m=o[u].trim().split(","),x=m[0],g=m[1];++u;for(var v=o[u]||"";(v.match(/["]/g)||[]).length&1&&u<o.length-1;)v+=`
`+o[++u];switch(v=v.trim(),+x){case-1:if(v==="BOT"){h[++c]=[],l=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?h[c][l]=!0:v==="FALSE"?h[c][l]=!1:isNaN(Hn(g))?isNaN(Ka(g).getDate())?h[c][l]=g:h[c][l]=At(g):h[c][l]=Hn(g),++l;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),h[c][l++]=v!==""?v:null;break}if(v==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return io(e(s,a),a)}function n(s,a){return hs(r(s,a),a)}var i=function(){var s=function(c,l,u,h,m){c.push(l),c.push(u+","+h),c.push('"'+m.replace(/"/g,'""')+'"')},a=function(c,l,u,h){c.push(l+","+u),c.push(l==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var l=[],u=ot(c["!ref"]),h,m=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,u.e.r-u.s.r+1,""),s(l,"TUPLES",0,u.e.c-u.s.c+1,""),s(l,"DATA",0,0,"");for(var x=u.s.r;x<=u.e.r;++x){a(l,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var v=ze({r:x,c:g});if(h=m?(c[x]||[])[g]:c[v],!h){a(l,1,0,"");continue}switch(h.t){case"n":var y=h.w;!y&&h.v!=null&&(y=h.v),y==null?h.f&&!h.F?a(l,1,0,"="+h.f):a(l,1,0,""):a(l,0,y,"V");break;case"b":a(l,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(l,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Fn(h.z||He[14],ir(At(h.v)))),a(l,0,h.w,"V");break;default:a(l,1,0,"")}}}a(l,-1,0,"EOD");var E=`\r
`,w=l.join(E);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),dw=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,m){for(var x=h.split(`
`),g=-1,v=-1,y=0,E=[];y!==x.length;++y){var w=x[y].trim().split(":");if(w[0]==="cell"){var T=Dt(w[1]);if(E.length<=T.r)for(g=E.length;g<=T.r;++g)E[g]||(E[g]=[]);switch(g=T.r,v=T.c,w[2]){case"t":E[g][v]=e(w[3]);break;case"v":E[g][v]=+w[3];break;case"vtf":var k=w[w.length-1];case"vtc":switch(w[3]){case"nl":E[g][v]=!!+w[4];break;default:E[g][v]=+w[4];break}w[2]=="vtf"&&(E[g][v]=[E[g][v],k])}}}return m&&m.sheetRows&&(E=E.slice(0,m.sheetRows)),E}function n(h,m){return io(r(h,m),m)}function i(h,m){return hs(n(h,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(h){if(!h||!h["!ref"])return"";for(var m=[],x=[],g,v="",y=en(h["!ref"]),E=Array.isArray(h),w=y.s.r;w<=y.e.r;++w)for(var T=y.s.c;T<=y.e.c;++T)if(v=ze({r:w,c:T}),g=E?(h[w]||[])[T]:h[v],!(!g||g.v==null||g.t==="z")){switch(x=["cell",v,"t"],g.t){case"s":case"str":x.push(t(g.v));break;case"n":g.f?(x[2]="vtf",x[3]="n",x[4]=g.v,x[5]=t(g.f)):(x[2]="v",x[3]=g.v);break;case"b":x[2]="vt"+(g.f?"f":"c"),x[3]="nl",x[4]=g.v?"1":"0",x[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var k=ir(At(g.v));x[2]="vtc",x[3]="nd",x[4]=""+k,x[5]=g.w||Fn(g.z||He[14],k);break;case"e":continue}m.push(x.join(":"))}return m.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function u(h){return[s,a,o,a,l(h),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),Ya=function(){function e(u,h,m,x,g){g.raw?h[m][x]=u:u===""||(u==="TRUE"?h[m][x]=!0:u==="FALSE"?h[m][x]=!1:isNaN(Hn(u))?isNaN(Ka(u).getDate())?h[m][x]=u:h[m][x]=At(u):h[m][x]=Hn(u))}function t(u,h){var m=h||{},x=[];if(!u||u.length===0)return x;for(var g=u.split(/[\r\n]/),v=g.length-1;v>=0&&g[v].length===0;)--v;for(var y=10,E=0,w=0;w<=v;++w)E=g[w].indexOf(" "),E==-1?E=g[w].length:E++,y=Math.max(y,E);for(w=0;w<=v;++w){x[w]=[];var T=0;for(e(g[w].slice(0,y).trim(),x,w,T,m),T=1;T<=(g[w].length-y)/10+1;++T)e(g[w].slice(y+(T-1)*10,y+T*10).trim(),x,w,T,m)}return m.sheetRows&&(x=x.slice(0,m.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var h={},m=!1,x=0,g=0;x<u.length;++x)(g=u.charCodeAt(x))==34?m=!m:!m&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(x in h)Object.prototype.hasOwnProperty.call(h,x)&&g.push([h[x],x]);if(!g.length){h=n;for(x in h)Object.prototype.hasOwnProperty.call(h,x)&&g.push([h[x],x])}return g.sort(function(v,y){return v[0]-y[0]||n[v[1]]-n[y[1]]}),r[g.pop()[1]]||44}function s(u,h){var m=h||{},x="",g=m.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(x=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(x=u.charAt(4),u=u.slice(6)):x=i(u.slice(0,1024)):m&&m.FS?x=m.FS:x=i(u.slice(0,1024));var y=0,E=0,w=0,T=0,k=0,b=x.charCodeAt(0),I=!1,S=0,B=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var D=m.dateNF!=null?Pk(m.dateNF):null;function H(){var Y=u.slice(T,k),q={};if(Y.charAt(0)=='"'&&Y.charAt(Y.length-1)=='"'&&(Y=Y.slice(1,-1).replace(/""/g,'"')),Y.length===0)q.t="z";else if(m.raw)q.t="s",q.v=Y;else if(Y.trim().length===0)q.t="s",q.v=Y;else if(Y.charCodeAt(0)==61)Y.charCodeAt(1)==34&&Y.charCodeAt(Y.length-1)==34?(q.t="s",q.v=Y.slice(2,-1).replace(/""/g,'"')):l4(Y)?(q.t="n",q.f=Y.slice(1)):(q.t="s",q.v=Y);else if(Y=="TRUE")q.t="b",q.v=!0;else if(Y=="FALSE")q.t="b",q.v=!1;else if(!isNaN(w=Hn(Y)))q.t="n",m.cellText!==!1&&(q.w=Y),q.v=w;else if(!isNaN(Ka(Y).getDate())||D&&Y.match(D)){q.z=m.dateNF||He[14];var ue=0;D&&Y.match(D)&&(Y=Mk(Y,m.dateNF,Y.match(D)||[]),ue=1),m.cellDates?(q.t="d",q.v=At(Y,ue)):(q.t="n",q.v=ir(At(Y,ue))),m.cellText!==!1&&(q.w=Fn(q.z,q.v instanceof Date?ir(q.v):q.v)),m.cellNF||delete q.z}else q.t="s",q.v=Y;if(q.t=="z"||(m.dense?(g[y]||(g[y]=[]),g[y][E]=q):g[ze({c:E,r:y})]=q),T=k+1,B=u.charCodeAt(T),v.e.c<E&&(v.e.c=E),v.e.r<y&&(v.e.r=y),S==b)++E;else if(E=0,++y,m.sheetRows&&m.sheetRows<=y)return!0}e:for(;k<u.length;++k)switch(S=u.charCodeAt(k)){case 34:B===34&&(I=!I);break;case b:case 10:case 13:if(!I&&H())break e;break}return k-T>0&&H(),g["!ref"]=Xe(v),g}function a(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):io(t(u,h),h)}function o(u,h){var m="",x=h.type=="string"?[0,0,0,0]:lp(u,h);switch(h.type){case"base64":m=dn(u);break;case"binary":m=u;break;case"buffer":h.codepage==65001?m=u.toString("utf8"):h.codepage&&typeof El<"u"||(m=et&&Buffer.isBuffer(u)?u.toString("binary"):ds(u));break;case"array":m=Gs(u);break;case"string":m=u;break;default:throw new Error("Unrecognized type "+h.type)}return x[0]==239&&x[1]==187&&x[2]==191?m=yt(m.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?m=yt(m):h.type=="binary"&&typeof El<"u",m.slice(0,19)=="socialcalc:version:"?dw.to_sheet(h.type=="string"?m:yt(m),h):a(m,h)}function c(u,h){return hs(o(u,h),h)}function l(u){for(var h=[],m=ot(u["!ref"]),x,g=Array.isArray(u),v=m.s.r;v<=m.e.r;++v){for(var y=[],E=m.s.c;E<=m.e.c;++E){var w=ze({r:v,c:E});if(x=g?(u[v]||[])[E]:u[w],!x||x.v==null){y.push("          ");continue}for(var T=(x.w||(ki(x),x.w)||"").slice(0,10);T.length<10;)T+=" ";y.push(T+(E===0?" ":""))}h.push(y.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function JA(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=uw.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Ya.to_workbook(e,t)}}var Ms=function(){function e(R,G,F){if(R){xr(R,R.l||0);for(var O=F.Enum||de;R.l<R.length;){var X=R.read_shift(2),he=O[X]||O[65535],ae=R.read_shift(2),ve=R.l+ae,ye=he.f&&he.f(R,ae,F);if(R.l=ve,G(ye,he,X))return}}}function t(R,G){switch(G.type){case"base64":return r(on(dn(R)),G);case"binary":return r(on(R),G);case"buffer":case"array":return r(R,G)}throw"Unsupported type "+G.type}function r(R,G){if(!R)return R;var F=G||{},O=F.dense?[]:{},X="Sheet1",he="",ae=0,ve={},ye=[],Ge=[],C={s:{r:0,c:0},e:{r:0,c:0}},Re=F.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)F.Enum=de,e(R,function(Ie,wt,Mr){switch(Mr){case 0:F.vers=Ie,Ie>=4096&&(F.qpro=!0);break;case 6:C=Ie;break;case 204:Ie&&(he=Ie);break;case 222:he=Ie;break;case 15:case 51:F.qpro||(Ie[1].v=Ie[1].v.slice(1));case 13:case 14:case 16:Mr==14&&(Ie[2]&112)==112&&(Ie[2]&15)>1&&(Ie[2]&15)<15&&(Ie[1].z=F.dateNF||He[14],F.cellDates&&(Ie[1].t="d",Ie[1].v=Zu(Ie[1].v))),F.qpro&&Ie[3]>ae&&(O["!ref"]=Xe(C),ve[X]=O,ye.push(X),O=F.dense?[]:{},C={s:{r:0,c:0},e:{r:0,c:0}},ae=Ie[3],X=he||"Sheet"+(ae+1),he="");var Gr=F.dense?(O[Ie[0].r]||[])[Ie[0].c]:O[ze(Ie[0])];if(Gr){Gr.t=Ie[1].t,Gr.v=Ie[1].v,Ie[1].z!=null&&(Gr.z=Ie[1].z),Ie[1].f!=null&&(Gr.f=Ie[1].f);break}F.dense?(O[Ie[0].r]||(O[Ie[0].r]=[]),O[Ie[0].r][Ie[0].c]=Ie[1]):O[ze(Ie[0])]=Ie[1];break}},F);else if(R[2]==26||R[2]==14)F.Enum=Z,R[2]==14&&(F.qpro=!0,R.l=0),e(R,function(Ie,wt,Mr){switch(Mr){case 204:X=Ie;break;case 22:Ie[1].v=Ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ie[3]>ae&&(O["!ref"]=Xe(C),ve[X]=O,ye.push(X),O=F.dense?[]:{},C={s:{r:0,c:0},e:{r:0,c:0}},ae=Ie[3],X="Sheet"+(ae+1)),Re>0&&Ie[0].r>=Re)break;F.dense?(O[Ie[0].r]||(O[Ie[0].r]=[]),O[Ie[0].r][Ie[0].c]=Ie[1]):O[ze(Ie[0])]=Ie[1],C.e.c<Ie[0].c&&(C.e.c=Ie[0].c),C.e.r<Ie[0].r&&(C.e.r=Ie[0].r);break;case 27:Ie[14e3]&&(Ge[Ie[14e3][0]]=Ie[14e3][1]);break;case 1537:Ge[Ie[0]]=Ie[1],Ie[0]==ae&&(X=Ie[1]);break}},F);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(O["!ref"]=Xe(C),ve[he||X]=O,ye.push(he||X),!Ge.length)return{SheetNames:ye,Sheets:ve};for(var Ve={},dt=[],Ze=0;Ze<Ge.length;++Ze)ve[ye[Ze]]?(dt.push(Ge[Ze]||ye[Ze]),Ve[Ge[Ze]]=ve[Ge[Ze]]||ve[ye[Ze]]):(dt.push(Ge[Ze]),Ve[Ge[Ze]]={"!ref":"A1"});return{SheetNames:dt,Sheets:Ve}}function n(R,G){var F=G||{};if(+F.codepage>=0&&$n(+F.codepage),F.type=="string")throw new Error("Cannot write WK1 to JS string");var O=Zr(),X=ot(R["!ref"]),he=Array.isArray(R),ae=[];Ne(O,0,s(1030)),Ne(O,6,c(X));for(var ve=Math.min(X.e.r,8191),ye=X.s.r;ye<=ve;++ye)for(var Ge=zt(ye),C=X.s.c;C<=X.e.c;++C){ye===X.s.r&&(ae[C]=Mt(C));var Re=ae[C]+Ge,Ve=he?(R[ye]||[])[C]:R[Re];if(!(!Ve||Ve.t=="z"))if(Ve.t=="n")(Ve.v|0)==Ve.v&&Ve.v>=-32768&&Ve.v<=32767?Ne(O,13,x(ye,C,Ve.v)):Ne(O,14,v(ye,C,Ve.v));else{var dt=ki(Ve);Ne(O,15,h(ye,C,dt.slice(0,239)))}}return Ne(O,1),O.end()}function i(R,G){var F=G||{};if(+F.codepage>=0&&$n(+F.codepage),F.type=="string")throw new Error("Cannot write WK3 to JS string");var O=Zr();Ne(O,0,a(R));for(var X=0,he=0;X<R.SheetNames.length;++X)(R.Sheets[R.SheetNames[X]]||{})["!ref"]&&Ne(O,27,J(R.SheetNames[X],he++));var ae=0;for(X=0;X<R.SheetNames.length;++X){var ve=R.Sheets[R.SheetNames[X]];if(!(!ve||!ve["!ref"])){for(var ye=ot(ve["!ref"]),Ge=Array.isArray(ve),C=[],Re=Math.min(ye.e.r,8191),Ve=ye.s.r;Ve<=Re;++Ve)for(var dt=zt(Ve),Ze=ye.s.c;Ze<=ye.e.c;++Ze){Ve===ye.s.r&&(C[Ze]=Mt(Ze));var Ie=C[Ze]+dt,wt=Ge?(ve[Ve]||[])[Ze]:ve[Ie];if(!(!wt||wt.t=="z"))if(wt.t=="n")Ne(O,23,H(Ve,Ze,ae,wt.v));else{var Mr=ki(wt);Ne(O,22,S(Ve,Ze,ae,Mr.slice(0,239)))}}++ae}}return Ne(O,1),O.end()}function s(R){var G=le(2);return G.write_shift(2,R),G}function a(R){var G=le(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var F=0,O=0,X=0,he=0;he<R.SheetNames.length;++he){var ae=R.SheetNames[he],ve=R.Sheets[ae];if(!(!ve||!ve["!ref"])){++X;var ye=en(ve["!ref"]);F<ye.e.r&&(F=ye.e.r),O<ye.e.c&&(O=ye.e.c)}}return F>8191&&(F=8191),G.write_shift(2,F),G.write_shift(1,X),G.write_shift(1,O),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(R,G,F){var O={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&F.qpro?(O.s.c=R.read_shift(1),R.l++,O.s.r=R.read_shift(2),O.e.c=R.read_shift(1),R.l++,O.e.r=R.read_shift(2),O):(O.s.c=R.read_shift(2),O.s.r=R.read_shift(2),G==12&&F.qpro&&(R.l+=2),O.e.c=R.read_shift(2),O.e.r=R.read_shift(2),G==12&&F.qpro&&(R.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function c(R){var G=le(8);return G.write_shift(2,R.s.c),G.write_shift(2,R.s.r),G.write_shift(2,R.e.c),G.write_shift(2,R.e.r),G}function l(R,G,F){var O=[{c:0,r:0},{t:"n",v:0},0,0];return F.qpro&&F.vers!=20768?(O[0].c=R.read_shift(1),O[3]=R.read_shift(1),O[0].r=R.read_shift(2),R.l+=2):(O[2]=R.read_shift(1),O[0].c=R.read_shift(2),O[0].r=R.read_shift(2)),O}function u(R,G,F){var O=R.l+G,X=l(R,G,F);if(X[1].t="s",F.vers==20768){R.l++;var he=R.read_shift(1);return X[1].v=R.read_shift(he,"utf8"),X}return F.qpro&&R.l++,X[1].v=R.read_shift(O-R.l,"cstr"),X}function h(R,G,F){var O=le(7+F.length);O.write_shift(1,255),O.write_shift(2,G),O.write_shift(2,R),O.write_shift(1,39);for(var X=0;X<O.length;++X){var he=F.charCodeAt(X);O.write_shift(1,he>=128?95:he)}return O.write_shift(1,0),O}function m(R,G,F){var O=l(R,G,F);return O[1].v=R.read_shift(2,"i"),O}function x(R,G,F){var O=le(7);return O.write_shift(1,255),O.write_shift(2,G),O.write_shift(2,R),O.write_shift(2,F,"i"),O}function g(R,G,F){var O=l(R,G,F);return O[1].v=R.read_shift(8,"f"),O}function v(R,G,F){var O=le(13);return O.write_shift(1,255),O.write_shift(2,G),O.write_shift(2,R),O.write_shift(8,F,"f"),O}function y(R,G,F){var O=R.l+G,X=l(R,G,F);if(X[1].v=R.read_shift(8,"f"),F.qpro)R.l=O;else{var he=R.read_shift(2);k(R.slice(R.l,R.l+he),X),R.l+=he}return X}function E(R,G,F){var O=G&32768;return G&=-32769,G=(O?R:0)+(G>=8192?G-16384:G),(O?"":"$")+(F?Mt(G):zt(G))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(R,G){xr(R,0);for(var F=[],O=0,X="",he="",ae="",ve="";R.l<R.length;){var ye=R[R.l++];switch(ye){case 0:F.push(R.read_shift(8,"f"));break;case 1:he=E(G[0].c,R.read_shift(2),!0),X=E(G[0].r,R.read_shift(2),!1),F.push(he+X);break;case 2:{var Ge=E(G[0].c,R.read_shift(2),!0),C=E(G[0].r,R.read_shift(2),!1);he=E(G[0].c,R.read_shift(2),!0),X=E(G[0].r,R.read_shift(2),!1),F.push(Ge+C+":"+he+X)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:F.push("("+F.pop()+")");break;case 5:F.push(R.read_shift(2));break;case 6:{for(var Re="";ye=R[R.l++];)Re+=String.fromCharCode(ye);F.push('"'+Re.replace(/"/g,'""')+'"')}break;case 8:F.push("-"+F.pop());break;case 23:F.push("+"+F.pop());break;case 22:F.push("NOT("+F.pop()+")");break;case 20:case 21:ve=F.pop(),ae=F.pop(),F.push(["AND","OR"][ye-20]+"("+ae+","+ve+")");break;default:if(ye<32&&T[ye])ve=F.pop(),ae=F.pop(),F.push(ae+T[ye]+ve);else if(w[ye]){if(O=w[ye][1],O==69&&(O=R[R.l++]),O>F.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+F.join("|")+"|");return}var Ve=F.slice(-O);F.length-=O,F.push(w[ye][0]+"("+Ve.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}F.length==1?G[1].f=""+F[0]:console.error("WK1 bad formula parse |"+F.join("|")+"|")}function b(R){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=R.read_shift(2),G[3]=R[R.l++],G[0].c=R[R.l++],G}function I(R,G){var F=b(R);return F[1].t="s",F[1].v=R.read_shift(G-4,"cstr"),F}function S(R,G,F,O){var X=le(6+O.length);X.write_shift(2,R),X.write_shift(1,F),X.write_shift(1,G),X.write_shift(1,39);for(var he=0;he<O.length;++he){var ae=O.charCodeAt(he);X.write_shift(1,ae>=128?95:ae)}return X.write_shift(1,0),X}function B(R,G){var F=b(R);F[1].v=R.read_shift(2);var O=F[1].v>>1;if(F[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return F[1].v=O,F}function D(R,G){var F=b(R),O=R.read_shift(4),X=R.read_shift(4),he=R.read_shift(2);if(he==65535)return O===0&&X===3221225472?(F[1].t="e",F[1].v=15):O===0&&X===3489660928?(F[1].t="e",F[1].v=42):F[1].v=0,F;var ae=he&32768;return he=(he&32767)-16446,F[1].v=(1-ae*2)*(X*Math.pow(2,he+32)+O*Math.pow(2,he)),F}function H(R,G,F,O){var X=le(14);if(X.write_shift(2,R),X.write_shift(1,F),X.write_shift(1,G),O==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var he=0,ae=0,ve=0,ye=0;return O<0&&(he=1,O=-O),ae=Math.log2(O)|0,O/=Math.pow(2,ae-31),ye=O>>>0,ye&2147483648||(O/=2,++ae,ye=O>>>0),O-=ye,ye|=2147483648,ye>>>=0,O*=Math.pow(2,32),ve=O>>>0,X.write_shift(4,ve),X.write_shift(4,ye),ae+=16383+(he?32768:0),X.write_shift(2,ae),X}function Y(R,G){var F=D(R);return R.l+=G-14,F}function q(R,G){var F=b(R),O=R.read_shift(4);return F[1].v=O>>6,F}function ue(R,G){var F=b(R),O=R.read_shift(8,"f");return F[1].v=O,F}function Te(R,G){var F=ue(R);return R.l+=G-10,F}function W(R,G){return R[R.l+G-1]==0?R.read_shift(G,"cstr"):""}function te(R,G){var F=R[R.l++];F>G-1&&(F=G-1);for(var O="";O.length<F;)O+=String.fromCharCode(R[R.l++]);return O}function ge(R,G,F){if(!(!F.qpro||G<21)){var O=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var X=R.read_shift(G-21,"cstr");return[O,X]}}function oe(R,G){for(var F={},O=R.l+G;R.l<O;){var X=R.read_shift(2);if(X==14e3){for(F[X]=[0,""],F[X][0]=R.read_shift(2);R[R.l];)F[X][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return F}function J(R,G){var F=le(5+R.length);F.write_shift(2,14e3),F.write_shift(2,G);for(var O=0;O<R.length;++O){var X=R.charCodeAt(O);F[F.l++]=X>127?95:X}return F[F.l++]=0,F}var de={0:{n:"BOF",f:Yt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:W},222:{n:"SHEETNAMELP",f:te},65535:{n:""}},Z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:B},25:{n:"FORMULA19",f:Y},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:q},38:{n:"??"},39:{n:"NUMBER27",f:ue},40:{n:"FORMULA28",f:Te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:W},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ge},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function KA(e){var t={},r=e.match(Pr),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=We(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=kh[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var YA=function(){var e=Sl("t"),t=Sl("rPr");function r(s){var a=s.match(e);if(!a)return{t:"s",v:""};var o={t:"s",v:at(a[1])},c=s.match(t);return c&&(o.s=KA(c[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),XA=function(){var t=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),a.push("</"+c+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),QA=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,ZA=/<(?:\w+:)?r>/,eb=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Kh(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=at(yt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=yt(e),r&&(n.h=Dh(n.t))):e.match(ZA)&&(n.r=yt(e),n.t=at(yt((e.replace(eb,"").match(QA)||[]).join("").replace(Pr,""))),r&&(n.h=XA(YA(n.r)))),n):{t:""}}var tb=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,rb=/<(?:\w+:)?(?:si|sstItem)>/g,nb=/<\/(?:\w+:)?(?:si|sstItem)>/;function ib(e,t){var r=[],n="";if(!e)return r;var i=e.match(tb);if(i){n=i[2].replace(rb,"").split(nb);for(var s=0;s!=n.length;++s){var a=Kh(n[s].trim(),t);a!=null&&(r[r.length]=a)}i=We(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var sb=/^\s|\s$|[\t\n\r]/;function hw(e,t){if(!t.bookSST)return"";var r=[Wt];r[r.length]=Ce("sst",null,{xmlns:Ks[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(sb)&&(s+=' xml:space="preserve"'),s+=">"+xt(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function ab(e){return[e.read_shift(4),e.read_shift(4)]}function ob(e,t){var r=[],n=!1;return bi(e,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function lb(e,t){return t||(t=le(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var cb=yC;function ub(e){var t=Zr();xe(t,159,lb(e));for(var r=0;r<e.length;++r)xe(t,19,cb(e[r]));return xe(t,160),t.end()}function pw(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function wi(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function fb(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=wi(e,4),t.U=wi(e,4),t.W=wi(e,4),t}function db(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function hb(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(db(e));return t}function pb(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function mb(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=wi(e,4),t.U=wi(e,4),t.W=wi(e,4),t}function xb(e){var t=mb(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function mw(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function xw(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function gb(e){var t=wi(e);switch(t.Minor){case 2:return[t.Minor,vb(e)];case 3:return[t.Minor,yb()];case 4:return[t.Minor,wb(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function vb(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=mw(e,r),i=xw(e,e.length-e.l);return{t:"Std",h:n,v:i}}function yb(){throw new Error("File is password-protected: ECMA-376 Extensible")}function wb(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Pr,function(s){var a=We(s);switch(li(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function Eb(e,t){var r={},n=r.EncryptionVersionInfo=wi(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=mw(e,i),t-=i,r.EncryptionVerifier=xw(e,t),r}function Tb(e){var t={},r=t.EncryptionVersionInfo=wi(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Yh(e){var t=0,r,n=pw(e),i=n.length+1,s,a,o,c,l;for(r=ss(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=t&16384?1:0,c=t<<1&32767,l=o|c,t=l^a;return t^52811}var gw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=t[a.length-1],c=104,l=a.length-1;l>=0;--l)for(var u=a[l],h=0;h!=7;++h)u&64&&(o^=r[c]),u*=2,--c;return o};return function(a){for(var o=pw(a),c=s(o),l=o.length,u=ss(16),h=0;h!=16;++h)u[h]=0;var m,x,g;for((l&1)===1&&(m=c>>8,u[l]=i(e[0],m),--l,m=c&255,x=o[o.length-1],u[l]=i(x,m));l>0;)--l,m=c>>8,u[l]=i(o[l],m),--l,m=c&255,u[l]=i(o[l],m);for(l=15,g=15-o.length;g>0;)m=c>>8,u[l]=i(e[g],m),--l,--g,m=c&255,u[l]=i(o[l],m),--l,--g;return u}}(),_b=function(e,t,r,n,i){i||(i=t),n||(n=gw(e));var s,a;for(s=0;s!=t.length;++s)a=t[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},Sb=function(e){var t=0,r=gw(e);return function(n){var i=_b("",n,t,r);return t=i[1],i[0]}};function kb(e,t,r,n){var i={key:Yt(e),verificationBytes:Yt(e)};return r.password&&(i.verifier=Yh(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Sb(r.password)),i}function Cb(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Tb(e):n.Data=Eb(e,t),n}function Nb(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Cb(e,t-2,n):kb(e,r.biff>=8?t:t-2,r,n),n}var vw=function(){function e(i,s){switch(s.type){case"base64":return t(dn(i),s);case"binary":return t(i,s);case"buffer":return t(et&&Buffer.isBuffer(i)?i.toString("binary"):ds(i),s);case"array":return t(Gs(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var m=/\\\w+\b/g,x=0,g,v=-1;g=m.exec(u);){switch(g[0]){case"\\cell":var y=u.slice(x,m.lastIndex-g[0].length);if(y[0]==" "&&(y=y.slice(1)),++v,y.length){var E={v:y,t:"s"};Array.isArray(o)?o[h][v]=E:o[ze({r:h,c:v})]=E}break}x=m.lastIndex}v>l.e.c&&(l.e.c=v)}),o["!ref"]=Xe(l),o}function r(i,s){return hs(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=ot(i["!ref"]),o,c=Array.isArray(i),l=a.s.r;l<=a.e.r;++l){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var h=ze({r:l,c:u});o=c?(i[l]||[])[u]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ki(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Ab(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Al(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function bb(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),a=i-s;if(a===0)return[0,0,t];var o=0,c=0,l=i+s;switch(c=a/(l>1?2-l:l),i){case t:o=((r-n)/a+6)%6;break;case r:o=(n-t)/a+2;break;case n:o=(t-r)/a+4;break}return[o/6,c,l/2]}function Ib(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=i*o,a[0]+=i,a[1]+=c;break;case 1:c=i*(2-o),a[0]+=c,a[1]+=i;break;case 2:c=i*(o-2),a[1]+=i,a[2]+=c;break;case 3:c=i*(4-o),a[1]+=c,a[2]+=i;break;case 4:c=i*(o-4),a[2]+=i,a[0]+=c;break;case 5:c=i*(6-o),a[2]+=c,a[0]+=i;break}for(var l=0;l!=3;++l)a[l]=Math.round(a[l]*255);return a}function ku(e,t){if(t===0)return e;var r=bb(Ab(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Al(Ib(r))}var yw=6,Fb=15,Rb=1,Nr=yw;function bl(e){return Math.floor((e+Math.round(128/Nr)/256)*Nr)}function Il(e){return Math.floor((e-5)/Nr*100+.5)/100}function Cu(e){return Math.round((e*Nr+5)/Nr*256)/256}function Yf(e){return Cu(Il(bl(e)))}function Xh(e){var t=Math.abs(e-Yf(e)),r=Nr;if(t>.005)for(Nr=Rb;Nr<Fb;++Nr)Math.abs(e-Yf(e))<=t&&(t=Math.abs(e-Yf(e)),r=Nr);Nr=r}function as(e){e.width?(e.wpx=bl(e.width),e.wch=Il(e.wpx),e.MDW=Nr):e.wpx?(e.wch=Il(e.wpx),e.width=Cu(e.wch),e.MDW=Nr):typeof e.wch=="number"&&(e.width=Cu(e.wch),e.wpx=bl(e.width),e.MDW=Nr),e.customWidth&&delete e.customWidth}var Pb=96,ww=Pb;function Fl(e){return e*96/ww}function Xa(e){return e*ww/96}var Mb={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Db(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(Pr)||[]).forEach(function(a){var o=We(a);switch(li(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Ct(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Ct(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function Lb(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(Pr)||[]).forEach(function(a){var o=We(a);switch(li(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function Ob(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(Pr)||[]).forEach(function(a){var o=We(a);switch(li(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=yt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Ct(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Ct(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Ct(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Ct(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Ct(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Ct(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Ct(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=kh[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Ct(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var c=Rs[i.color.index];i.color.index==81&&(c=Rs[1]),c||(c=Rs[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=ku(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function Ub(e,t,r){t.NumberFmt=[];for(var n=jt(He),i=0;i<n.length;++i)t.NumberFmt[n[i]]=He[n[i]];var s=e[0].match(Pr);if(s)for(i=0;i<s.length;++i){var a=We(s[i]);switch(li(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=at(yt(a.formatCode)),c=parseInt(a.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}yi(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function Bb(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ce("numFmt",null,{numFmtId:n,formatCode:xt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ce("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Sc=["numFmtId","fillId","fontId","borderId","xfId"],kc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function $b(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Pr)||[]).forEach(function(s){var a=We(s),o=0;switch(li(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Sc.length;++o)n[Sc[o]]&&(n[Sc[o]]=parseInt(n[Sc[o]],10));for(o=0;o<kc.length;++o)n[kc[o]]&&(n[kc[o]]=Ct(n[kc[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};a.vertical&&(c.vertical=a.vertical),a.horizontal&&(c.horizontal=a.horizontal),a.textRotation!=null&&(c.textRotation=a.textRotation),a.indent&&(c.indent=a.indent),a.wrapText&&(c.wrapText=Ct(a.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function jb(e){var t=[];return t[t.length]=Ce("cellXfs",null),e.forEach(function(r){t[t.length]=Ce("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ce("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Gb=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&Ub(h,u,l),(h=o.match(i))&&Ob(h,u,c,l),(h=o.match(n))&&Lb(h,u,c,l),(h=o.match(s))&&Db(h,u,c,l),(h=o.match(r))&&$b(h,u,l),u}}();function Ew(e,t){var r=[Wt,Ce("styleSheet",null,{xmlns:Ks[0],"xmlns:vt":rr.vt})],n;return e.SSF&&(n=Bb(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=jb(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Vb(e,t){var r=e.read_shift(2),n=Ir(e);return[r,n]}function Hb(e,t,r){r||(r=le(6+4*t.length)),r.write_shift(2,e),cr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function zb(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=CC(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=kC(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ir(e),n}function Wb(e,t){t||(t=le(25+4*32)),t.write_shift(2,e.sz*20),NC(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Tu(e.color,t);var n=0;return n=2,t.write_shift(1,n),cr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var qb=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Xf,Jb=Rr;function Hx(e,t){t||(t=le(4*3+8*7+16*1)),Xf||(Xf=Xu(qb));var r=Xf[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Tu({auto:1},t),Tu({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Kb(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function Tw(e,t,r){r||(r=le(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Co(e,t){return t||(t=le(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Yb=Rr;function Xb(e,t){return t||(t=le(51)),t.write_shift(1,0),Co(null,t),Co(null,t),Co(null,t),Co(null,t),Co(null,t),t.length>t.l?t.slice(0,t.l):t}function Qb(e,t){return t||(t=le(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Eu(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Zb(e,t,r){var n=le(2052);return n.write_shift(4,e),Eu(t,n),Eu(r,n),n.length>n.l?n.slice(0,n.l):n}function eI(e,t,r){var n={};n.NumberFmt=[];for(var i in He)n.NumberFmt[i]=He[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return bi(e,function(c,l,u){switch(u){case 44:n.NumberFmt[c[0]]=c[1],yi(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=ku(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(u),a=!0;break;case 38:s.pop(),a=!1;break;default:if(l.T>0)s.push(u);else if(l.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function tI(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(xe(e,615,zn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&xe(e,44,Hb(i,t[i]))}),xe(e,616))}}function rI(e){var t=1;xe(e,611,zn(t)),xe(e,43,Wb({sz:12,color:{theme:1},name:"Calibri",family:2})),xe(e,612)}function nI(e){var t=2;xe(e,603,zn(t)),xe(e,45,Hx({patternType:"none"})),xe(e,45,Hx({patternType:"gray125"})),xe(e,604)}function iI(e){var t=1;xe(e,613,zn(t)),xe(e,46,Xb()),xe(e,614)}function sI(e){var t=1;xe(e,626,zn(t)),xe(e,47,Tw({numFmtId:0},65535)),xe(e,627)}function aI(e,t){xe(e,617,zn(t.length)),t.forEach(function(r){xe(e,47,Tw(r,0))}),xe(e,618)}function oI(e){var t=1;xe(e,619,zn(t)),xe(e,48,Qb({xfId:0,name:"Normal"})),xe(e,620)}function lI(e){var t=0;xe(e,505,zn(t)),xe(e,506)}function cI(e){var t=0;xe(e,508,Zb(t,"TableStyleMedium9","PivotStyleMedium4")),xe(e,509)}function uI(e,t){var r=Zr();return xe(r,278),tI(r,e.SSF),rI(r),nI(r),iI(r),sI(r),aI(r,t.cellXfs),oI(r),lI(r),cI(r),xe(r,279),r.end()}var fI=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function dI(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Pr)||[]).forEach(function(i){var s=We(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[fI.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function hI(){}function pI(){}var mI=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,xI=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,gI=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function vI(e,t,r){t.themeElements={};var n;[["clrScheme",mI,dI],["fontScheme",xI,hI],["fmtScheme",gI,pI]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var yI=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function _w(e,t){(!e||e.length===0)&&(e=Qh());var r,n={};if(!(r=e.match(yI)))throw new Error("themeElements not found in theme");return vI(r[0],n,t),n.raw=e,n}function Qh(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Wt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function wI(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var a;try{a=m2(s,{type:"array"})}catch{return}var o=ln(a,"theme/theme/theme1.xml",!0);if(o)return _w(o,r)}}function EI(e){return e.read_shift(4)}function TI(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=_I(e,4);break;case 2:t.xclrValue=rw(e);break;case 3:t.xclrValue=EI(e);break;case 4:e.l+=4;break}return e.l+=8,t}function _I(e,t){return Rr(e,t)}function SI(e,t){return Rr(e,t)}function kI(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=TI(e);break;case 6:n[1]=SI(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function CI(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(kI(e,r-e.l));return{ixfe:n,ext:s}}function NI(e,t){t.forEach(function(r){switch(r[0]){}})}function AI(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ir(e)}}function bI(e){var t=le(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),cr(e.name,t),t.slice(0,t.l)}function II(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function FI(e){var t=le(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function RI(e,t){var r=le(8+2*t.length);return r.write_shift(4,e),cr(t,r),r.slice(0,r.l)}function PI(e){return e.l+=4,e.read_shift(4)!=0}function MI(e,t){var r=le(8);return r.write_shift(4,e),r.write_shift(4,1),r}function DI(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return bi(e,function(c,l,u){switch(u){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(u),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!l.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function LI(){var e=Zr();return xe(e,332),xe(e,334,zn(1)),xe(e,335,bI({name:"XLDAPR",version:12e4,flags:3496657072})),xe(e,336),xe(e,339,RI(1,"XLDAPR")),xe(e,52),xe(e,35,zn(514)),xe(e,4096,zn(0)),xe(e,4097,Tn(1)),xe(e,36),xe(e,53),xe(e,340),xe(e,337,MI(1)),xe(e,51,FI([[1,0]])),xe(e,338),xe(e,333),e.end()}function OI(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,a;return e.replace(Pr,function(o){var c=We(o);switch(li(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==c.name&&(a=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+c.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function Sw(){var e=[Wt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function UI(e){var t=[];if(!e)return t;var r=1;return(e.match(Pr)||[]).forEach(function(n){var i=We(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function BI(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ze(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function $I(e,t,r){var n=[];return bi(e,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function jI(e,t,r,n){if(!e)return e;var i=n||{},s=!1;bi(e,function(o,c,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},i)}function GI(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Ca=1024;function kw(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Ce("xml",null,{"xmlns:v":sn.v,"xmlns:o":sn.o,"xmlns:x":sn.x,"xmlns:mv":sn.mv}).replace(/\/>/,">"),Ce("o:shapelayout",Ce("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ce("v:shapetype",[Ce("v:stroke",null,{joinstyle:"miter"}),Ce("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ca<e*1e3;)Ca+=1e3;return t.forEach(function(s){var a=Dt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Ce("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=Ce("v:fill",c,o),u={on:"t",obscured:"t"};++Ca,i=i.concat(["<v:shape"+kl({id:"_x0000_s"+Ca,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,Ce("v:shadow",null,u),Ce("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",gr("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),gr("x:AutoFill","False"),gr("x:Row",String(a.r)),gr("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function zx(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(a){var o=Dt(a.ref);if(i?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[a.ref],!s){s={t:"z"},i?e[o.r][o.c]=s:e[a.ref]=s;var c=ot(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=Xe(c);l!==e["!ref"]&&(e["!ref"]=l)}s.c||(s.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}s.c.push(u)})}function VI(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=We(o[0]),l={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=Dt(c.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!h&&!!h[1]&&Kh(h[1])||{r:"",t:"",h:""};l.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),l.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(l.h=m.h),n.push(l)}}}}),n}function Cw(e){var t=[Wt,Ce("comments",null,{xmlns:Ks[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=xt(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=r.indexOf(xt(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(gr("t",xt(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(gr("t",xt(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function HI(e,t){var r=[],n=!1,i={},s=0;return e.replace(Pr,function(o,c){var l=We(o);switch(li(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":i.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function zI(e,t,r){var n=[Wt,Ce("ThreadedComments",null,{xmlns:rr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(Ce("threadedComment",gr("text",a.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function WI(e,t){var r=[],n=!1;return e.replace(Pr,function(s){var a=We(s);switch(li(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function qI(e){var t=[Wt,Ce("personList",null,{xmlns:rr.TCMNT,"xmlns:x":Ks[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ce("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function JI(e){var t={};t.iauthor=e.read_shift(4);var r=Zs(e);return t.rfx=r.s,t.ref=ze(r.s),e.l+=16,t}function KI(e,t){return t==null&&(t=le(36)),t.write_shift(4,e[1].iauthor),so(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var YI=Ir;function XI(e){return cr(e.slice(0,54))}function QI(e,t){var r=[],n=[],i={},s=!1;return bi(e,function(o,c,l){switch(l){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}function ZI(e){var t=Zr(),r=[];return xe(t,628),xe(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),xe(t,632,XI(i.a)))})}),xe(t,631),xe(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Dt(n[0]),e:Dt(n[0])};xe(t,635,KI([s,i])),i.t&&i.t.length>0&&xe(t,637,EC(i)),xe(t,636),delete i.iauthor})}),xe(t,634),xe(t,629),t.end()}var e4="application/vnd.ms-office.vbaProject";function t4(e){var t=je.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");je.utils.cfb_add(t,i,e.FileIndex[n].content)}}),je.write(t)}function r4(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&je.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var Nw=["xlsb","xlsm","xlam","biff8","xla"];function n4(){return{"!type":"dialog"}}function i4(){return{"!type":"dialog"}}function s4(){return{"!type":"macro"}}function a4(){return{"!type":"macro"}}var Oa=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,c?l+=t.r:--l,i+(o?"":"$")+Mt(u)+(c?"":"$")+zt(l)}return function(i,s){return t=s,i.replace(e,r)}}(),Zh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ep=function(){return function(t,r){return t.replace(Zh,function(n,i,s,a,o,c){var l=$h(a)-(s?0:r.c),u=Bh(c)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",m=l==0?"":s?l+1:"["+l+"]";return i+"R"+h+"C"+m})}}();function Aw(e,t){return e.replace(Zh,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Mt($h(s)+t.c))+(a=="$"?a+o:zt(Bh(o)+t.r))})}function o4(e,t,r){var n=en(t),i=n.s,s=Dt(r),a={r:s.r-i.r,c:s.c-i.c};return Aw(e,a)}function l4(e){return e.length!=1}function Wx(e){return e.replace(/_xlfn\./g,"")}function Jt(e){e.l+=1}function os(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function bw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Iw(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=os(e),o=os(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Iw(e){var t=os(e),r=os(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function c4(e,t,r){if(r.biff<8)return Iw(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=os(e),a=os(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function Fw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return u4(e);var n=e.read_shift(r&&r.biff==12?4:2),i=os(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function u4(e){var t=os(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function f4(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function d4(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return h4(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function h4(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function p4(e,t,r){var n=(e[e.l++]&96)>>5,i=bw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function m4(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=bw(e,s,r);return[n,i,a]}function x4(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function g4(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function v4(e,t,r){var n=(e[e.l++]&96)>>5,i=c4(e,t-1,r);return[n,i]}function y4(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function qx(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function w4(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function E4(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function T4(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function _4(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function S4(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Rw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function k4(e){return e.read_shift(2),Rw(e)}function C4(e){return e.read_shift(2),Rw(e)}function N4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Fw(e,0,r);return[n,i]}function A4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=d4(e,0,r);return[n,i]}function b4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=Fw(e,0,r);return[n,i,s]}function I4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[PF[i],Dw[i],n]}function F4(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:R4(e);return[i,(s[0]===0?Dw:RF)[s[1]]]}function R4(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function P4(e,t,r){e.l+=r&&r.biff==2?3:4}function M4(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function D4(e){return e.l++,Ii[e.read_shift(1)]}function L4(e){return e.l++,e.read_shift(2)}function O4(e){return e.l++,e.read_shift(1)!==0}function U4(e){return e.l++,Ar(e)}function B4(e,t,r){return e.l++,Vl(e,t-1,r)}function $4(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Vt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ii[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ar(e);break;case 2:r[1]=ea(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function j4(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Zs:ef)(e));return i}function G4(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=$4(e,r.biff);return a}function V4(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function H4(e,t,r){if(r.biff==5)return z4(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function z4(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function W4(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function q4(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function J4(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function K4(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var Y4=Rr,X4=Rr,Q4=Rr;function zl(e,t,r){return e.l+=2,[f4(e)]}function tp(e){return e.l+=6,[]}var Z4=zl,eF=tp,tF=tp,rF=zl;function Pw(e){return e.l+=2,[Yt(e),e.read_shift(2)&1]}var nF=zl,iF=Pw,sF=tp,aF=zl,oF=zl,lF=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function cF(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=lF[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function uF(e){return e.l+=2,[e.read_shift(4)]}function fF(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function dF(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function hF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function pF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function mF(e){return e.l+=4,[0,0]}var Jx={1:{n:"PtgExp",f:M4},2:{n:"PtgTbl",f:Q4},3:{n:"PtgAdd",f:Jt},4:{n:"PtgSub",f:Jt},5:{n:"PtgMul",f:Jt},6:{n:"PtgDiv",f:Jt},7:{n:"PtgPower",f:Jt},8:{n:"PtgConcat",f:Jt},9:{n:"PtgLt",f:Jt},10:{n:"PtgLe",f:Jt},11:{n:"PtgEq",f:Jt},12:{n:"PtgGe",f:Jt},13:{n:"PtgGt",f:Jt},14:{n:"PtgNe",f:Jt},15:{n:"PtgIsect",f:Jt},16:{n:"PtgUnion",f:Jt},17:{n:"PtgRange",f:Jt},18:{n:"PtgUplus",f:Jt},19:{n:"PtgUminus",f:Jt},20:{n:"PtgPercent",f:Jt},21:{n:"PtgParen",f:Jt},22:{n:"PtgMissArg",f:Jt},23:{n:"PtgStr",f:B4},26:{n:"PtgSheet",f:fF},27:{n:"PtgEndSheet",f:dF},28:{n:"PtgErr",f:D4},29:{n:"PtgBool",f:O4},30:{n:"PtgInt",f:L4},31:{n:"PtgNum",f:U4},32:{n:"PtgArray",f:y4},33:{n:"PtgFunc",f:I4},34:{n:"PtgFuncVar",f:F4},35:{n:"PtgName",f:V4},36:{n:"PtgRef",f:N4},37:{n:"PtgArea",f:p4},38:{n:"PtgMemArea",f:W4},39:{n:"PtgMemErr",f:Y4},40:{n:"PtgMemNoMem",f:X4},41:{n:"PtgMemFunc",f:q4},42:{n:"PtgRefErr",f:J4},43:{n:"PtgAreaErr",f:x4},44:{n:"PtgRefN",f:A4},45:{n:"PtgAreaN",f:v4},46:{n:"PtgMemAreaN",f:hF},47:{n:"PtgMemNoMemN",f:pF},57:{n:"PtgNameX",f:H4},58:{n:"PtgRef3d",f:b4},59:{n:"PtgArea3d",f:m4},60:{n:"PtgRefErr3d",f:K4},61:{n:"PtgAreaErr3d",f:g4},255:{}},xF={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},gF={1:{n:"PtgElfLel",f:Pw},2:{n:"PtgElfRw",f:aF},3:{n:"PtgElfCol",f:Z4},6:{n:"PtgElfRwV",f:oF},7:{n:"PtgElfColV",f:rF},10:{n:"PtgElfRadical",f:nF},11:{n:"PtgElfRadicalS",f:sF},13:{n:"PtgElfColS",f:eF},15:{n:"PtgElfColSV",f:tF},16:{n:"PtgElfRadicalLel",f:iF},25:{n:"PtgList",f:cF},29:{n:"PtgSxName",f:uF},255:{}},vF={0:{n:"PtgAttrNoop",f:mF},1:{n:"PtgAttrSemi",f:S4},2:{n:"PtgAttrIf",f:T4},4:{n:"PtgAttrChoose",f:w4},8:{n:"PtgAttrGoto",f:E4},16:{n:"PtgAttrSum",f:P4},32:{n:"PtgAttrBaxcel",f:qx},33:{n:"PtgAttrBaxcel",f:qx},64:{n:"PtgAttrSpace",f:k4},65:{n:"PtgAttrSpaceSemi",f:C4},128:{n:"PtgAttrIfError",f:_4},255:{}};function Wl(e,t,r,n){if(n.biff<8)return Rr(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=G4(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=j4(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(Rr(e,t)),s}function ql(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=Jx[s]||Jx[xF[s]],(s===24||s===25)&&(i=(s===24?gF:vF)[e[e.l+1]]),!i||!i.f?Rr(e,t):a.push([i.n,i.f(e,t,r)]);return a}function yF(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var wF={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function EF(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Mw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Kx(e,t,r){var n=Mw(e,t,r);return n=="#REF"?n:EF(n,r)}function kr(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],c,l,u,h=0,m=0,x,g="";if(!e[0]||!e[0][0])return"";for(var v=-1,y="",E=0,w=e[0].length;E<w;++E){var T=e[0][E];switch(T[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),v>=0){switch(e[0][v][1][0]){case 0:y=Bt(" ",e[0][v][1][1]);break;case 1:y=Bt("\r",e[0][v][1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}l=l+y,v=-1}o.push(l+wF[T[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Jo(T[1][1],a,i),o.push(Ko(u,s));break;case"PtgRefN":u=r?Jo(T[1][1],r,i):T[1][1],o.push(Ko(u,s));break;case"PtgRef3d":h=T[1][1],u=Jo(T[1][2],a,i),g=Kx(n,h,i),o.push(g+"!"+Ko(u,s));break;case"PtgFunc":case"PtgFuncVar":var k=T[1][0],b=T[1][1];k||(k=0),k&=127;var I=k==0?[]:o.slice(-k);o.length-=k,b==="User"&&(b=I.shift()),o.push(b+"("+I.join(",")+")");break;case"PtgBool":o.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(T[1]);break;case"PtgNum":o.push(String(T[1]));break;case"PtgStr":o.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(T[1]);break;case"PtgAreaN":x=Sx(T[1][1],r?{s:r}:a,i),o.push(qf(x,i));break;case"PtgArea":x=Sx(T[1][1],a,i),o.push(qf(x,i));break;case"PtgArea3d":h=T[1][1],x=T[1][2],g=Kx(n,h,i),o.push(g+"!"+qf(x,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=T[1][2];var S=(n.names||[])[m-1]||(n[0]||[])[m],B=S?S.Name:"SH33TJSNAME"+String(m);B&&B.slice(0,6)=="_xlfn."&&!i.xlfn&&(B=B.slice(6)),o.push(B);break;case"PtgNameX":var D=T[1][1];m=T[1][2];var H;if(i.biff<=5)D<0&&(D=-D),n[D]&&(H=n[D][m]);else{var Y="";if(((n[D]||[])[0]||[])[0]==14849||(((n[D]||[])[0]||[])[0]==1025?n[D][m]&&n[D][m].itab>0&&(Y=n.SheetNames[n[D][m].itab-1]+"!"):Y=n.SheetNames[m-1]+"!"),n[D]&&n[D][m])Y+=n[D][m].Name;else if(n[0]&&n[0][m])Y+=n[0][m].Name;else{var q=(Mw(n,D,i)||"").split(";;");q[m-1]?Y=q[m-1]:Y+="SH33TJSERRX"}o.push(Y);break}H||(H={Name:"SH33TJSERRY"}),o.push(H.Name);break;case"PtgParen":var ue="(",Te=")";if(v>=0){switch(y="",e[0][v][1][0]){case 2:ue=Bt(" ",e[0][v][1][1])+ue;break;case 3:ue=Bt("\r",e[0][v][1][1])+ue;break;case 4:Te=Bt(" ",e[0][v][1][1])+Te;break;case 5:Te=Bt("\r",e[0][v][1][1])+Te;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}o.push(ue+o.pop()+Te);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:T[1][1],r:T[1][0]};var W={c:r.c,r:r.r};if(n.sharedf[ze(u)]){var te=n.sharedf[ze(u)];o.push(kr(te,a,W,n,i))}else{var ge=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(u.c<l[0].s.c||u.c>l[0].e.c)&&!(u.r<l[0].s.r||u.r>l[0].e.r)){o.push(kr(l[1],a,W,n,i)),ge=!0;break}ge||o.push(T[1])}break;case"PtgArray":o.push("{"+yF(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&v>=0&&oe.indexOf(e[0][E][0])==-1){T=e[0][v];var J=!0;switch(T[1][0]){case 4:J=!1;case 0:y=Bt(" ",T[1][1]);break;case 5:J=!1;case 1:y=Bt("\r",T[1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}o.push((J?y:"")+o.pop()+(J?"":y)),v=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function TF(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],Rr(e,t-2)];var o=ql(e,a,r);return t!==a+i&&(s=Wl(e,t-a-i,o,r)),e.l=n,[o,s]}function _F(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],Rr(e,t-2)];var o=ql(e,a,r);return t!==a+i&&(s=Wl(e,t-a-i,o,r)),e.l=n,[o,s]}function SF(e,t,r,n){var i=e.l+t,s=ql(e,n,r),a;return i!==e.l&&(a=Wl(e,i-e.l,s,r)),[s,a]}function kF(e,t,r){var n=e.l+t,i,s=e.read_shift(2),a=ql(e,s,r);return s==65535?[[],Rr(e,t-2)]:(t!==s+2&&(i=Wl(e,n-s-2,a,r)),[a,i])}function CF(e){var t;if(xi(e,e.l+6)!==65535)return[Ar(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function NF(e){if(e==null){var t=le(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Vs(e);return Vs(0)}function Qf(e,t,r){var n=e.l+t,i=ci(e);r.biff==2&&++e.l;var s=CF(e),a=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=_F(e,n-e.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function AF(e,t,r,n,i){var s=zs(t,r,i),a=NF(e.v),o=le(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=le(e.bf.length),u=0;u<e.bf.length;++u)l[u]=e.bf[u];var h=lr([s,a,o,l]);return h}function tf(e,t,r){var n=e.read_shift(4),i=ql(e,n,r),s=e.read_shift(4),a=s>0?Wl(e,s,i,r):null;return[i,a]}var bF=tf,rf=tf,IF=tf,FF=tf,RF={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Dw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},PF={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Yx(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function MF(e){var t="of:="+e.replace(Zh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Zf(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function DF(e){return e.replace(/\./,"!")}var Xo={},Ua={},Qo=typeof Map<"u";function rp(e,t,r){var n=0,i=e.length;if(r){if(Qo?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Qo?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Qo?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function nf(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Nr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Il(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Cu(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Ds(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ps(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){yi(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Lw(e,t,r,n,i,s){try{n.cellNF&&(e.z=He[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=At(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(He[t]==null&&yi(Rk[t]||"General",t),e.t==="e")e.w=e.w||Ii[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=_l(e.v);else if(e.t==="d"){var a=ir(e.v);(a|0)===a?e.w=a.toString(10):e.w=_l(a)}else{if(e.v===void 0)return"";e.w=js(e.v,Ua)}else e.t==="d"?e.w=Fn(t,ir(e.v),Ua):e.w=Fn(t,e.v,Ua)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ku(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ku(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function LF(e,t,r){if(e&&e["!ref"]){var n=ot(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function OF(e,t){var r=ot(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Xe(r))}var UF=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,BF=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,$F=/<(?:\w:)?hyperlink [^>]*>/mg,jF=/"(\w*:\w*)"/,GF=/<(?:\w:)?col\b[^>]*[\/]?>/g,VF=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,HF=/<(?:\w:)?pageMargins[^>]*\/>/g,Ow=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,zF=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,WF=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function qF(e,t,r,n,i,s,a){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",u="",h=e.match(BF);h?(l=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):l=u=e;var m=l.match(Ow);m?np(m[0],o,i,r):(m=l.match(zF))&&KF(m[0],m[1]||"",o,i,r);var x=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var g=l.slice(x,x+50).match(jF);g&&OF(o,g[1])}var v=l.match(WF);v&&v[1]&&lR(v[1],i);var y=[];if(t.cellStyles){var E=l.match(GF);E&&nR(y,E)}h&&fR(h[1],o,t,c,s,a);var w=u.match(VF);w&&(o["!autofilter"]=sR(w[0]));var T=[],k=u.match(UF);if(k)for(x=0;x!=k.length;++x)T[x]=ot(k[x].slice(k[x].indexOf('"')+1));var b=u.match($F);b&&eR(o,b,n);var I=u.match(HF);if(I&&(o["!margins"]=tR(We(I[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Xe(c)),t.sheetRows>0&&o["!ref"]){var S=ot(o["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>c.e.r&&(S.e.r=c.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>c.e.c&&(S.e.c=c.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Xe(S))}return y.length>0&&(o["!cols"]=y),T.length>0&&(o["!merges"]=T),o}function JF(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Xe(e[r])+'"/>';return t+"</mergeCells>"}function np(e,t,r,n){var i=We(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=at(yt(i.codeName)))}function KF(e,t,r,n,i){np(e.slice(0,e.indexOf(">")),r,n,i)}function YF(e,t,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,a.codeName=si(xt(c))}if(e&&e["!outline"]){var l={summaryBelow:1,summaryRight:1};e["!outline"].above&&(l.summaryBelow=0),e["!outline"].left&&(l.summaryRight=0),o=(o||"")+Ce("outlinePr",null,l)}!s&&!o||(i[i.length]=Ce("sheetPr",o,a))}var XF=["objects","scenarios","selectLockedCells","selectUnlockedCells"],QF=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ZF(e){var t={sheet:1};return XF.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),QF.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Yh(e.password).toString(16).toUpperCase()),Ce("sheetProtection",null,t)}function eR(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=We(yt(t[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+at(s.location))):(s.Target="#"+at(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=ot(s.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var u=ze({c:l,r:c});n?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function tR(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function rR(e){return Ds(e),Ce("pageMargins",null,e)}function nR(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=We(t[n],!0);i.hidden&&(i.hidden=Ct(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Xh(i.width)),as(i);s<=a;)e[s++]=bt(i)}}function iR(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Ce("col",null,nf(i,n)));return r[r.length]="</cols>",r.join("")}function sR(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function aR(e,t,r,n){var i=typeof e.ref=="string"?e.ref:Xe(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=en(i);a.s.r==a.e.r&&(a.e.r=en(t["!ref"]).e.r,i=Xe(a));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ce("autoFilter",null,{ref:i})}var oR=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function lR(e,t){t.Views||(t.Views=[{}]),(e.match(oR)||[]).forEach(function(r,n){var i=We(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Ct(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function cR(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ce("sheetViews",Ce("sheetView",null,i),{})}function uR(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Ii[e.v];break;case"d":n&&n.cellDates?i=At(e.v,-1).toISOString():(e=bt(e),e.t="n",i=""+(e.v=ir(At(e.v)))),typeof e.z>"u"&&(e.z=He[14]);break;default:i=e.v;break}var o=gr("v",xt(i)),c={r:t},l=ps(n.cellXfs,e,n);switch(l!==0&&(c.s=l),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=gr("v",""+rp(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=a),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Ce("f",xt(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Ce("c",o,c)}var fR=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Sl("v"),a=Sl("f");return function(c,l,u,h,m,x){for(var g=0,v="",y=[],E=[],w=0,T=0,k=0,b="",I,S,B=0,D=0,H,Y,q=0,ue=0,Te=Array.isArray(x.CellXf),W,te=[],ge=[],oe=Array.isArray(l),J=[],de={},Z=!1,R=!!u.sheetStubs,G=c.split(t),F=0,O=G.length;F!=O;++F){v=G[F].trim();var X=v.length;if(X!==0){var he=0;e:for(g=0;g<X;++g)switch(v[g]){case">":if(v[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(S=We(v.slice(he,g),!0),B=S.r!=null?parseInt(S.r,10):B+1,D=-1,u.sheetRows&&u.sheetRows<B)continue;de={},Z=!1,S.ht&&(Z=!0,de.hpt=parseFloat(S.ht),de.hpx=Xa(de.hpt)),S.hidden=="1"&&(Z=!0,de.hidden=!0),S.outlineLevel!=null&&(Z=!0,de.level=+S.outlineLevel),Z&&(J[B-1]=de)}break;case"<":he=g;break}if(he>=g)break;if(S=We(v.slice(he,g),!0),B=S.r!=null?parseInt(S.r,10):B+1,D=-1,!(u.sheetRows&&u.sheetRows<B)){h.s.r>B-1&&(h.s.r=B-1),h.e.r<B-1&&(h.e.r=B-1),u&&u.cellStyles&&(de={},Z=!1,S.ht&&(Z=!0,de.hpt=parseFloat(S.ht),de.hpx=Xa(de.hpt)),S.hidden=="1"&&(Z=!0,de.hidden=!0),S.outlineLevel!=null&&(Z=!0,de.level=+S.outlineLevel),Z&&(J[B-1]=de)),y=v.slice(g).split(e);for(var ae=0;ae!=y.length&&y[ae].trim().charAt(0)=="<";++ae);for(y=y.slice(ae),g=0;g!=y.length;++g)if(v=y[g].trim(),v.length!==0){if(E=v.match(r),w=g,T=0,k=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,E!=null&&E.length===2){for(w=0,b=E[1],T=0;T!=b.length&&!((k=b.charCodeAt(T)-64)<1||k>26);++T)w=26*w+k;--w,D=w}else++D;for(T=0;T!=v.length&&v.charCodeAt(T)!==62;++T);if(++T,S=We(v.slice(0,T),!0),S.r||(S.r=ze({r:B-1,c:D})),b=v.slice(T),I={t:""},(E=b.match(s))!=null&&E[1]!==""&&(I.v=at(E[1])),u.cellFormula){if((E=b.match(a))!=null&&E[1]!==""){if(I.f=at(yt(E[1])).replace(/\r\n/g,`
`),u.xlfn||(I.f=Wx(I.f)),E[0].indexOf('t="array"')>-1)I.F=(b.match(i)||[])[1],I.F.indexOf(":")>-1&&te.push([ot(I.F),I.F]);else if(E[0].indexOf('t="shared"')>-1){Y=We(E[0]);var ve=at(yt(E[1]));u.xlfn||(ve=Wx(ve)),ge[parseInt(Y.si,10)]=[Y,ve,S.r]}}else(E=b.match(/<f[^>]*\/>/))&&(Y=We(E[0]),ge[Y.si]&&(I.f=o4(ge[Y.si][1],ge[Y.si][2],S.r)));var ye=Dt(S.r);for(T=0;T<te.length;++T)ye.r>=te[T][0].s.r&&ye.r<=te[T][0].e.r&&ye.c>=te[T][0].s.c&&ye.c<=te[T][0].e.c&&(I.F=te[T][1])}if(S.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(R)I.t="z";else continue;else I.t=S.t||"n";switch(h.s.c>D&&(h.s.c=D),h.e.c<D&&(h.e.c=D),I.t){case"n":if(I.v==""||I.v==null){if(!R)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!R)continue;I.t="z"}else H=Xo[parseInt(I.v,10)],I.v=H.t,I.r=H.r,u.cellHTML&&(I.h=H.h);break;case"str":I.t="s",I.v=I.v!=null?yt(I.v):"",u.cellHTML&&(I.h=Dh(I.v));break;case"inlineStr":E=b.match(n),I.t="s",E!=null&&(H=Kh(E[1]))?(I.v=H.t,u.cellHTML&&(I.h=H.h)):I.v="";break;case"b":I.v=Ct(I.v);break;case"d":u.cellDates?I.v=At(I.v,1):(I.v=ir(At(I.v,1)),I.t="n");break;case"e":(!u||u.cellText!==!1)&&(I.w=I.v),I.v=B2[I.v];break}if(q=ue=0,W=null,Te&&S.s!==void 0&&(W=x.CellXf[S.s],W!=null&&(W.numFmtId!=null&&(q=W.numFmtId),u.cellStyles&&W.fillId!=null&&(ue=W.fillId))),Lw(I,q,ue,u,m,x),u.cellDates&&Te&&I.t=="n"&&ro(He[q])&&(I.t="d",I.v=Zu(I.v)),S.cm&&u.xlmeta){var Ge=(u.xlmeta.Cell||[])[+S.cm-1];Ge&&Ge.type=="XLDAPR"&&(I.D=!0)}if(oe){var C=Dt(S.r);l[C.r]||(l[C.r]=[]),l[C.r][C.c]=I}else l[S.r]=I}}}}J.length>0&&(l["!rows"]=J)}}();function dR(e,t,r,n){var i=[],s=[],a=ot(e["!ref"]),o="",c,l="",u=[],h=0,m=0,x=e["!rows"],g=Array.isArray(e),v={r:l},y,E=-1;for(m=a.s.c;m<=a.e.c;++m)u[m]=Mt(m);for(h=a.s.r;h<=a.e.r;++h){for(s=[],l=zt(h),m=a.s.c;m<=a.e.c;++m){c=u[m]+l;var w=g?(e[h]||[])[m]:e[c];w!==void 0&&(o=uR(w,c,e,t))!=null&&s.push(o)}(s.length>0||x&&x[h])&&(v={r:l},x&&x[h]&&(y=x[h],y.hidden&&(v.hidden=1),E=-1,y.hpx?E=Fl(y.hpx):y.hpt&&(E=y.hpt),E>-1&&(v.ht=E,v.customHeight=1),y.level&&(v.outlineLevel=y.level)),i[i.length]=Ce("row",s.join(""),v))}if(x)for(;h<x.length;++h)x&&x[h]&&(v={r:h+1},y=x[h],y.hidden&&(v.hidden=1),E=-1,y.hpx?E=Fl(y.hpx):y.hpt&&(E=y.hpt),E>-1&&(v.ht=E,v.customHeight=1),y.level&&(v.outlineLevel=y.level),i[i.length]=Ce("row","",v));return i.join("")}function Uw(e,t,r,n){var i=[Wt,Ce("worksheet",null,{xmlns:Ks[0],"xmlns:r":rr.r})],s=r.SheetNames[e],a=0,o="",c=r.Sheets[s];c==null&&(c={});var l=c["!ref"]||"A1",u=ot(l);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),l=Xe(u)}n||(n={}),c["!comments"]=[];var h=[];YF(c,r,e,t,i),i[i.length]=Ce("dimension",null,{ref:l}),i[i.length]=cR(c,t,e,r),t.sheetFormat&&(i[i.length]=Ce("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=iR(c,c["!cols"])),i[a=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=dR(c,t),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),c["!protect"]&&(i[i.length]=ZF(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=aR(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=JF(c["!merges"]));var m=-1,x,g=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(v){v[1].Target&&(x={ref:v[0]},v[1].Target.charAt(0)!="#"&&(g=mt(n,-1,xt(v[1].Target).replace(/#.*$/,""),tt.HLINK),x["r:id"]="rId"+g),(m=v[1].Target.indexOf("#"))>-1&&(x.location=xt(v[1].Target.slice(m+1))),v[1].Tooltip&&(x.tooltip=xt(v[1].Tooltip)),i[i.length]=Ce("hyperlink",null,x))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=rR(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=gr("ignoredErrors",Ce("ignoredError",null,{numberStoredAsText:1,sqref:l}))),h.length>0&&(g=mt(n,-1,"../drawings/drawing"+(e+1)+".xml",tt.DRAW),i[i.length]=Ce("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=h),c["!comments"].length>0&&(g=mt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",tt.VML),i[i.length]=Ce("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function hR(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function pR(e,t,r){var n=le(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=Fl(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var l={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,m=-1,x=u<<10;x<u+1<<10;++x){l.c=x;var g=Array.isArray(r)?(r[l.r]||[])[l.c]:r[ze(l)];g&&(h<0&&(h=x),m=x)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,m))}var v=n.l;return n.l=c,n.write_shift(4,o),n.l=v,n.length>n.l?n.slice(0,n.l):n}function mR(e,t,r,n){var i=pR(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&xe(e,0,i)}var xR=Zs,gR=so;function vR(){}function yR(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=TC(e),r}function wR(e,t,r){r==null&&(r=le(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Tu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),M2(e,r),r.slice(0,r.l)}function ER(e){var t=Rn(e);return[t]}function TR(e,t,r){return r==null&&(r=le(8)),Ys(t,r)}function _R(e){var t=Xs(e);return[t]}function SR(e,t,r){return r==null&&(r=le(4)),Qs(t,r)}function kR(e){var t=Rn(e),r=e.read_shift(1);return[t,r,"b"]}function CR(e,t,r){return r==null&&(r=le(9)),Ys(t,r),r.write_shift(1,e.v?1:0),r}function NR(e){var t=Xs(e),r=e.read_shift(1);return[t,r,"b"]}function AR(e,t,r){return r==null&&(r=le(5)),Qs(t,r),r.write_shift(1,e.v?1:0),r}function bR(e){var t=Rn(e),r=e.read_shift(1);return[t,r,"e"]}function IR(e,t,r){return r==null&&(r=le(9)),Ys(t,r),r.write_shift(1,e.v),r}function FR(e){var t=Xs(e),r=e.read_shift(1);return[t,r,"e"]}function RR(e,t,r){return r==null&&(r=le(8)),Qs(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function PR(e){var t=Rn(e),r=e.read_shift(4);return[t,r,"s"]}function MR(e,t,r){return r==null&&(r=le(12)),Ys(t,r),r.write_shift(4,t.v),r}function DR(e){var t=Xs(e),r=e.read_shift(4);return[t,r,"s"]}function LR(e,t,r){return r==null&&(r=le(8)),Qs(t,r),r.write_shift(4,t.v),r}function OR(e){var t=Rn(e),r=Ar(e);return[t,r,"n"]}function UR(e,t,r){return r==null&&(r=le(16)),Ys(t,r),Vs(e.v,r),r}function Bw(e){var t=Xs(e),r=Ar(e);return[t,r,"n"]}function BR(e,t,r){return r==null&&(r=le(12)),Qs(t,r),Vs(e.v,r),r}function $R(e){var t=Rn(e),r=Hh(e);return[t,r,"n"]}function jR(e,t,r){return r==null&&(r=le(12)),Ys(t,r),D2(e.v,r),r}function GR(e){var t=Xs(e),r=Hh(e);return[t,r,"n"]}function VR(e,t,r){return r==null&&(r=le(8)),Qs(t,r),D2(e.v,r),r}function HR(e){var t=Rn(e),r=jh(e);return[t,r,"is"]}function zR(e){var t=Rn(e),r=Ir(e);return[t,r,"str"]}function WR(e,t,r){return r==null&&(r=le(12+4*e.v.length)),Ys(t,r),cr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function qR(e){var t=Xs(e),r=Ir(e);return[t,r,"str"]}function JR(e,t,r){return r==null&&(r=le(8+4*e.v.length)),Qs(t,r),cr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function KR(e,t,r){var n=e.l+t,i=Rn(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=rf(e,n-e.l,r);a[3]=kr(o,null,i,r.supbooks,r)}else e.l=n;return a}function YR(e,t,r){var n=e.l+t,i=Rn(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=rf(e,n-e.l,r);a[3]=kr(o,null,i,r.supbooks,r)}else e.l=n;return a}function XR(e,t,r){var n=e.l+t,i=Rn(e);i.r=r["!row"];var s=Ar(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=rf(e,n-e.l,r);a[3]=kr(o,null,i,r.supbooks,r)}else e.l=n;return a}function QR(e,t,r){var n=e.l+t,i=Rn(e);i.r=r["!row"];var s=Ir(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=rf(e,n-e.l,r);a[3]=kr(o,null,i,r.supbooks,r)}else e.l=n;return a}var ZR=Zs,e3=so;function t3(e,t){return t==null&&(t=le(4)),t.write_shift(4,e),t}function r3(e,t){var r=e.l+t,n=Zs(e),i=Gh(e),s=Ir(e),a=Ir(e),o=Ir(e);e.l=r;var c={rfx:n,relId:i,loc:s,display:o};return a&&(c.Tooltip=a),c}function n3(e,t){var r=le(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));so({s:Dt(e[0]),e:Dt(e[0])},r),Vh("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return cr(i||"",r),cr(e[1].Tooltip||"",r),cr("",r),r.slice(0,r.l)}function i3(){}function s3(e,t,r){var n=e.l+t,i=L2(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=bF(e,n-e.l,r);a[1]=o}else e.l=n;return a}function a3(e,t,r){var n=e.l+t,i=Zs(e),s=[i];if(r.cellFormula){var a=FF(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}function o3(e,t,r){r==null&&(r=le(18));var n=nf(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var $w=["left","right","top","bottom","header","footer"];function l3(e){var t={};return $w.forEach(function(r){t[r]=Ar(e)}),t}function c3(e,t){return t==null&&(t=le(6*8)),Ds(e),$w.forEach(function(r){Vs(e[r],t)}),t}function u3(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function f3(e,t,r){r==null&&(r=le(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function d3(e){var t=le(24);return t.write_shift(4,4),t.write_shift(4,1),so(e,t),t}function h3(e,t){return t==null&&(t=le(16*4+2)),t.write_shift(2,e.password?Yh(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function p3(){}function m3(){}function x3(e,t,r,n,i,s,a){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},l,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,m=!1,x,g,v,y,E,w,T,k,b,I=[];o.biff=12,o["!row"]=0;var S=0,B=!1,D=[],H={},Y=o.supbooks||i.supbooks||[[]];if(Y.sharedf=H,Y.arrayf=D,Y.SheetNames=i.SheetNames||i.Sheets.map(function(oe){return oe.name}),!o.supbooks&&(o.supbooks=Y,i.Names))for(var q=0;q<i.Names.length;++q)Y[0][q+1]=i.Names[q];var ue=[],Te=[],W=!1;Rl[16]={n:"BrtShortReal",f:Bw};var te;if(bi(e,function(J,de,Z){if(!m)switch(Z){case 148:l=J;break;case 0:x=J,o.sheetRows&&o.sheetRows<=x.r&&(m=!0),k=zt(y=x.r),o["!row"]=x.r,(J.hidden||J.hpt||J.level!=null)&&(J.hpt&&(J.hpx=Xa(J.hpt)),Te[J.r]=J);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:J[2]},J[2]){case"n":g.v=J[1];break;case"s":T=Xo[J[1]],g.v=T.t,g.r=T.r;break;case"b":g.v=!!J[1];break;case"e":g.v=J[1],o.cellText!==!1&&(g.w=Ii[g.v]);break;case"str":g.t="s",g.v=J[1];break;case"is":g.t="s",g.v=J[1].t;break}if((v=a.CellXf[J[0].iStyleRef])&&Lw(g,v.numFmtId,null,o,s,a),E=J[0].c==-1?E+1:J[0].c,o.dense?(c[y]||(c[y]=[]),c[y][E]=g):c[Mt(E)+k]=g,o.cellFormula){for(B=!1,S=0;S<D.length;++S){var R=D[S];x.r>=R[0].s.r&&x.r<=R[0].e.r&&E>=R[0].s.c&&E<=R[0].e.c&&(g.F=Xe(R[0]),B=!0)}!B&&J.length>3&&(g.f=J[3])}if(u.s.r>x.r&&(u.s.r=x.r),u.s.c>E&&(u.s.c=E),u.e.r<x.r&&(u.e.r=x.r),u.e.c<E&&(u.e.c=E),o.cellDates&&v&&g.t=="n"&&ro(He[v.numFmtId])){var G=bs(g.v);G&&(g.t="d",g.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}te&&(te.type=="XLDAPR"&&(g.D=!0),te=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;g={t:"z",v:void 0},E=J[0].c==-1?E+1:J[0].c,o.dense?(c[y]||(c[y]=[]),c[y][E]=g):c[Mt(E)+k]=g,u.s.r>x.r&&(u.s.r=x.r),u.s.c>E&&(u.s.c=E),u.e.r<x.r&&(u.e.r=x.r),u.e.c<E&&(u.e.c=E),te&&(te.type=="XLDAPR"&&(g.D=!0),te=void 0);break;case 176:I.push(J);break;case 49:te=((o.xlmeta||{}).Cell||[])[J-1];break;case 494:var F=n["!id"][J.relId];for(F?(J.Target=F.Target,J.loc&&(J.Target+="#"+J.loc),J.Rel=F):J.relId==""&&(J.Target="#"+J.loc),y=J.rfx.s.r;y<=J.rfx.e.r;++y)for(E=J.rfx.s.c;E<=J.rfx.e.c;++E)o.dense?(c[y]||(c[y]=[]),c[y][E]||(c[y][E]={t:"z",v:void 0}),c[y][E].l=J):(w=ze({c:E,r:y}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=J);break;case 426:if(!o.cellFormula)break;D.push(J),b=o.dense?c[y][E]:c[Mt(E)+k],b.f=kr(J[1],u,{r:x.r,c:E},Y,o),b.F=Xe(J[0]);break;case 427:if(!o.cellFormula)break;H[ze(J[0].s)]=J[1],b=o.dense?c[y][E]:c[Mt(E)+k],b.f=kr(J[1],u,{r:x.r,c:E},Y,o);break;case 60:if(!o.cellStyles)break;for(;J.e>=J.s;)ue[J.e--]={width:J.w/256,hidden:!!(J.flags&1),level:J.level},W||(W=!0,Xh(J.w/256)),as(ue[J.e+1]);break;case 161:c["!autofilter"]={ref:Xe(J)};break;case 476:c["!margins"]=J;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),J.name&&(i.Sheets[r].CodeName=J.name),(J.above||J.left)&&(c["!outline"]={above:J.above,left:J.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),J.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!de.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Z.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(u.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=Xe(l||u)),o.sheetRows&&c["!ref"]){var ge=ot(c["!ref"]);o.sheetRows<=+ge.e.r&&(ge.e.r=o.sheetRows-1,ge.e.r>u.e.r&&(ge.e.r=u.e.r),ge.e.r<ge.s.r&&(ge.s.r=ge.e.r),ge.e.c>u.e.c&&(ge.e.c=u.e.c),ge.e.c<ge.s.c&&(ge.s.c=ge.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Xe(ge))}return I.length>0&&(c["!merges"]=I),ue.length>0&&(c["!cols"]=ue),Te.length>0&&(c["!rows"]=Te),c}function g3(e,t,r,n,i,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=bt(t),t.z=t.z||He[14],t.v=ir(At(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=ps(i.cellXfs,t,i),t.l&&s["!links"].push([ze(c),t.l]),t.c&&s["!comments"].push([ze(c),t.c]),t.t){case"s":case"str":return i.bookSST?(o=rp(i.Strings,t.v,i.revStrings),c.t="s",c.v=o,a?xe(e,18,LR(t,c)):xe(e,7,MR(t,c))):(c.t="str",a?xe(e,17,JR(t,c)):xe(e,6,WR(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?xe(e,13,VR(t,c)):xe(e,2,jR(t,c)):a?xe(e,16,BR(t,c)):xe(e,5,UR(t,c)),!0;case"b":return c.t="b",a?xe(e,15,AR(t,c)):xe(e,4,CR(t,c)),!0;case"e":return c.t="e",a?xe(e,14,RR(t,c)):xe(e,3,IR(t,c)),!0}return a?xe(e,12,SR(t,c)):xe(e,1,TR(t,c)),!0}function v3(e,t,r,n){var i=ot(t["!ref"]||"A1"),s,a="",o=[];xe(e,145);var c=Array.isArray(t),l=i.e.r;t["!rows"]&&(l=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=l;++u){a=zt(u),mR(e,t,i,u);var h=!1;if(u<=i.e.r)for(var m=i.s.c;m<=i.e.c;++m){u===i.s.r&&(o[m]=Mt(m)),s=o[m]+a;var x=c?(t[u]||[])[m]:t[s];if(!x){h=!1;continue}h=g3(e,x,u,m,n,t,h)}}xe(e,146)}function y3(e,t){!t||!t["!merges"]||(xe(e,177,t3(t["!merges"].length)),t["!merges"].forEach(function(r){xe(e,176,e3(r))}),xe(e,178))}function w3(e,t){!t||!t["!cols"]||(xe(e,390),t["!cols"].forEach(function(r,n){r&&xe(e,60,o3(n,r))}),xe(e,391))}function E3(e,t){!t||!t["!ref"]||(xe(e,648),xe(e,649,d3(ot(t["!ref"]))),xe(e,650))}function T3(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=mt(r,-1,n[1].Target.replace(/#.*$/,""),tt.HLINK);xe(e,494,n3(n,i))}}),delete t["!links"]}function _3(e,t,r,n){if(t["!comments"].length>0){var i=mt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",tt.VML);xe(e,551,Vh("rId"+i)),t["!legacy"]=i}}function S3(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:Xe(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=en(s);o.s.r==o.e.r&&(o.e.r=en(t["!ref"]).e.r,s=Xe(o));for(var c=0;c<a.length;++c){var l=a[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),xe(e,161,so(ot(s))),xe(e,162)}}function k3(e,t,r){xe(e,133),xe(e,137,f3(t,r)),xe(e,138),xe(e,134)}function C3(e,t){t["!protect"]&&xe(e,535,h3(t["!protect"]))}function N3(e,t,r,n){var i=Zr(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=ot(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],xe(i,129),(r.vbaraw||a["!outline"])&&xe(i,147,wR(o,a["!outline"])),xe(i,148,gR(c)),k3(i,a,r.Workbook),w3(i,a),v3(i,a,e,t),C3(i,a),S3(i,a,r,e),y3(i,a),T3(i,a,n),a["!margins"]&&xe(i,476,c3(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&E3(i,a),_3(i,a,e,n),xe(i,130),i.end()}function A3(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(t[+a[1]]=r?+a[2]:a[2])});var i=at((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function b3(e,t,r,n,i,s){var a=s||{"!type":"chart"};if(!e)return s;var o=0,c=0,l="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var m=A3(h);u.s.r=u.s.c=0,u.e.c=o,l=Mt(o),m[0].forEach(function(x,g){a[l+zt(g)]={t:"n",v:x,z:m[1]},c=g}),u.e.r<c&&(u.e.r=c),++o}),o>0&&(a["!ref"]=Xe(u)),a}function I3(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=e.match(Ow);return o&&np(o[0],s,i,r),(a=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function F3(e,t){e.l+=10;var r=Ir(e);return{name:r}}function R3(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return bi(e,function(c,l,u){switch(u){case 550:s["!rel"]=c;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),c.name&&(i.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var ip=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],P3=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],M3=[],D3=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Xx(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Ct(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Qx(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ct(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function jw(e){Qx(e.WBProps,ip),Qx(e.CalcPr,D3),Xx(e.WBView,P3),Xx(e.Sheets,M3),Ua.date1904=Ct(e.WBProps.date1904)}function L3(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ct(e.Workbook.WBProps.date1904)?"true":"false"}var O3="][*?/\\".split("");function Gw(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return O3.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function U3(e,t,r){e.forEach(function(n,i){Gw(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[i]&&t[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function B3(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];U3(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)LF(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var $3=/<\w+:workbook/;function j3(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(e.replace(Pr,function(c,l){var u=We(c);switch(li(u[0])){case"<?xml":break;case"<workbook":c.match($3)&&(i="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ip.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Ct(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=yt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=at(yt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=yt(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),Ct(u.hidden||"0")&&(s.Hidden=!0),a=l+c.length;break;case"</definedName>":s.Ref=at(yt(e.slice(a,l))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),Ks.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return jw(r),r}function Vw(e){var t=[Wt];t[t.length]=Ce("workbook",null,{xmlns:Ks[0],"xmlns:r":rr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(ip.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ce("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var a={name:xt(e.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=Ce("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Ce("definedName",xt(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function G3(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=c0(e),r.name=Ir(e),r}function V3(e,t){return t||(t=le(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Vh(e.strRelID,t),cr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function H3(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Ir(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function z3(e,t){t||(t=le(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),M2(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function W3(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function q3(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=_C(e),a=IF(e,0,r),o=Gh(e);e.l=n;var c={Name:s,Ptg:a};return i<268435455&&(c.Sheet=i),o&&(c.Comment=o),c}function J3(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],Rl[16]={n:"BrtFRTArchID$",f:W3},bi(e,function(c,l,u){switch(u){case 156:a.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=kr(c.Ptg,null,null,a,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,c]):a[0]=[u,c],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(c),a.XTI=a.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!l.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),jw(r),r.Names=s,r.supbooks=a,r}function K3(e,t){xe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};xe(e,156,V3(i))}xe(e,144)}function Y3(e,t){t||(t=le(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return cr("SheetJS",t),cr(mu.version,t),cr(mu.version,t),cr("7262",t),t.length>t.l?t.slice(0,t.l):t}function X3(e,t){t||(t=le(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Q3(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(xe(e,135),xe(e,158,X3(i)),xe(e,136))}}function Z3(e,t){var r=Zr();return xe(r,131),xe(r,128,Y3()),xe(r,153,z3(e.Workbook&&e.Workbook.WBProps||null)),Q3(r,e),K3(r,e),xe(r,132),r.end()}function eP(e,t,r){return t.slice(-4)===".bin"?J3(e,r):j3(e,r)}function tP(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?x3(e,n,r,i,s,a,o):qF(e,n,r,i,s,a,o)}function rP(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?R3(e,n,r,i,s):I3(e,n,r,i,s)}function nP(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?s4():a4()}function iP(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?n4():i4()}function sP(e,t,r,n){return t.slice(-4)===".bin"?eI(e,r,n):Gb(e,r,n)}function aP(e,t,r){return _w(e,r)}function oP(e,t,r){return t.slice(-4)===".bin"?ob(e,r):ib(e,r)}function lP(e,t,r){return t.slice(-4)===".bin"?QI(e,r):VI(e,r)}function cP(e,t,r){return t.slice(-4)===".bin"?$I(e):UI(e)}function uP(e,t,r,n){return r.slice(-4)===".bin"?jI(e,t,r,n):void 0}function fP(e,t,r){return t.slice(-4)===".bin"?DI(e,t,r):OI(e,t,r)}function dP(e,t,r){return(t.slice(-4)===".bin"?Z3:Vw)(e)}function hP(e,t,r,n,i){return(t.slice(-4)===".bin"?N3:Uw)(e,r,n,i)}function pP(e,t,r){return(t.slice(-4)===".bin"?uI:Ew)(e,r)}function mP(e,t,r){return(t.slice(-4)===".bin"?ub:hw)(e,r)}function xP(e,t,r){return(t.slice(-4)===".bin"?ZI:Cw)(e)}function gP(e){return(e.slice(-4)===".bin"?LI:Sw)()}var Hw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,zw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ln(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(Hw),s,a,o,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(zw),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function vP(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Hw),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(zw),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Zo;function yP(e,t){var r=Zo[e]||at(e);return r==="General"?js(t):Fn(r,t)}function wP(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Ct(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=At(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[at(t)]=i}function EP(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ii[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=_l(e.v):e.w=js(e.v):e.w=yP(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Zo[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&ro(n)){var i=bs(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function TP(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Mb[n.Pattern]||n.Pattern)}e[t.ID]=t}function _P(e,t,r,n,i,s,a,o,c,l){var u="General",h=n.StyleID,m={};l=l||{};var x=[],g=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(u=s[h].nf),s[h].Interior&&x.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ct(e);break;case"String":n.t="s",n.r=mx(at(e)),n.v=e.indexOf("<")>-1?at(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(At(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=at(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=B2[e],l.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=mx(t||e));break}if(EP(n,u,l),l.cellFormula!==!1)if(n.Formula){var v=at(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=Oa(v,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Oa("RC:RC",i):n.ArrayRange&&(n.F=Oa(n.ArrayRange,i),c.push([ot(n.F),n.F]))}else for(g=0;g<c.length;++g)i.r>=c[g][0].s.r&&i.r<=c[g][0].e.r&&i.c>=c[g][0].s.c&&i.c<=c[g][0].e.c&&(n.F=c[g][1]);l.cellStyles&&(x.forEach(function(y){!m.patternType&&y.patternType&&(m.patternType=y.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function SP(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ed(e,t){var r=t||{};no();var n=Po(Lh(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=yt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=bt(r);return a.type="string",Ya.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(wt){i.indexOf("<"+wt)>=0&&(s=!0)}),s)return cM(n,r);Zo={"General Number":"General","General Date":He[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":He[15],"Short Date":He[14],"Long Time":He[19],"Medium Time":He[18],"Short Time":He[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:He[2],Standard:He[4],Percent:He[10],Scientific:He[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l,u={},h=[],m=r.dense?[]:{},x="",g={},v={},y=Ln('<Data ss:Type="String">'),E=0,w=0,T=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},b={},I={},S="",B=0,D=[],H={},Y={},q=0,ue=[],Te=[],W={},te=[],ge,oe=!1,J=[],de=[],Z={},R=0,G=0,F={Sheets:[],WBProps:{date1904:!1}},O={};Cl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var X="";o=Cl.exec(n);)switch(o[3]=(X=o[3]).toLowerCase()){case"data":if(X=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?_P(n.slice(E,o.index),S,y,c[c.length-1][0]=="comment"?W:g,{c:w,r:T},b,te[w],v,J,r):(S="",y=Ln(o[0]),E=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Te.length>0&&(g.c=Te),(!r.sheetRows||r.sheetRows>T)&&g.v!==void 0&&(r.dense?(m[T]||(m[T]=[]),m[T][w]=g):m[Mt(w)+zt(T)]=g),g.HRef&&(g.l={Target:at(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(R=w+(parseInt(g.MergeAcross,10)|0),G=T+(parseInt(g.MergeDown,10)|0),D.push({s:{c:w,r:T},e:{c:R,r:G}})),!r.sheetStubs)g.MergeAcross?w=R+1:++w;else if(g.MergeAcross||g.MergeDown){for(var he=w;he<=R;++he)for(var ae=T;ae<=G;++ae)(he>w||ae>T)&&(r.dense?(m[ae]||(m[ae]=[]),m[ae][he]={t:"z"}):m[Mt(he)+zt(ae)]={t:"z"});w=R+1}else++w;else g=vP(o[0]),g.Index&&(w=+g.Index-1),w<k.s.c&&(k.s.c=w),w>k.e.c&&(k.e.c=w),o[0].slice(-2)==="/>"&&++w,Te=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(T<k.s.r&&(k.s.r=T),T>k.e.r&&(k.e.r=T),o[0].slice(-2)==="/>"&&(v=Ln(o[0]),v.Index&&(T=+v.Index-1)),w=0,++T):(v=Ln(o[0]),v.Index&&(T=+v.Index-1),Z={},(v.AutoFitHeight=="0"||v.Height)&&(Z.hpx=parseInt(v.Height,10),Z.hpt=Fl(Z.hpx),de[T]=Z),v.Hidden=="1"&&(Z.hidden=!0,de[T]=Z));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));h.push(x),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(m["!ref"]=Xe(k),r.sheetRows&&r.sheetRows<=k.e.r&&(m["!fullref"]=m["!ref"],k.e.r=r.sheetRows-1,m["!ref"]=Xe(k))),D.length&&(m["!merges"]=D),te.length>0&&(m["!cols"]=te),de.length>0&&(m["!rows"]=de),u[x]=m}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=w=0,c.push([o[3],!1]),l=Ln(o[0]),x=at(l.Name),m=r.dense?[]:{},D=[],J=[],de=[],O={name:x,Hidden:0},F.Sheets.push(O);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),te=[],oe=!1}break;case"style":o[1]==="/"?TP(b,I,r):I=Ln(o[0]);break;case"numberformat":I.nf=at(Ln(o[0]).Format||"General"),Zo[I.nf]&&(I.nf=Zo[I.nf]);for(var ve=0;ve!=392&&He[ve]!=I.nf;++ve);if(ve==392){for(ve=57;ve!=392;++ve)if(He[ve]==null){yi(I.nf,ve);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ge=Ln(o[0]),ge.Hidden&&(ge.hidden=!0,delete ge.Hidden),ge.Width&&(ge.wpx=parseInt(ge.Width,10)),!oe&&ge.wpx>10){oe=!0,Nr=yw;for(var ye=0;ye<te.length;++ye)te[ye]&&as(te[ye])}oe&&as(ge),te[ge.Index-1||te.length]=ge;for(var Ge=0;Ge<+ge.Span;++Ge)te[te.length]=bt(ge);break;case"namedrange":if(o[1]==="/")break;F.Names||(F.Names=[]);var C=We(o[0]),Re={Name:C.Name,Ref:Oa(C.RefersTo.slice(1),{r:0,c:0})};F.Sheets.length>0&&(Re.Sheet=F.Sheets.length-1),F.Names.push(Re);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?S+=n.slice(B,o.index):B=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;I.Interior=Ln(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?JC(H,X,n.slice(q,o.index)):q=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));SP(W),Te.push(W)}else c.push([o[3],!1]),l=Ln(o[0]),W={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ve=Ln(o[0]);m["!autofilter"]={ref:Oa(Ve.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return ng(n,r);var dt=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:dt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:dt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":F.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:dt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:dt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(q,o.index)){case"SheetHidden":O.Hidden=1;break;case"SheetVeryHidden":O.Hidden=2;break}else q=o.index+o[0].length;break;case"header":m["!margins"]||Ds(m["!margins"]={},"xlml"),isNaN(+We(o[0]).Margin)||(m["!margins"].header=+We(o[0]).Margin);break;case"footer":m["!margins"]||Ds(m["!margins"]={},"xlml"),isNaN(+We(o[0]).Margin)||(m["!margins"].footer=+We(o[0]).Margin);break;case"pagemargins":var Ze=We(o[0]);m["!margins"]||Ds(m["!margins"]={},"xlml"),isNaN(+Ze.Top)||(m["!margins"].top=+Ze.Top),isNaN(+Ze.Left)||(m["!margins"].left=+Ze.Left),isNaN(+Ze.Right)||(m["!margins"].right=+Ze.Right),isNaN(+Ze.Bottom)||(m["!margins"].bottom=+Ze.Bottom);break;case"displayrighttoleft":F.Views||(F.Views=[]),F.Views[0]||(F.Views[0]={}),F.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:dt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:dt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:dt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:dt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:dt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:dt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:dt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:dt=!1}break;case"smarttags":break;default:dt=!1;break}if(dt||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?wP(Y,X,ue,n.slice(q,o.index)):(ue=o,q=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Ie={};return!r.bookSheets&&!r.bookProps&&(Ie.Sheets=u),Ie.SheetNames=h,Ie.Workbook=F,Ie.SSF=bt(He),Ie.Props=H,Ie.Custprops=Y,Ie}function x0(e,t){switch(ap(t=t||{}),t.type||"base64"){case"base64":return ed(dn(e),t);case"binary":case"buffer":case"file":return ed(e,t);case"array":return ed(ds(e),t)}}function kP(e,t){var r=[];return e.Props&&r.push(KC(e.Props,t)),e.Custprops&&r.push(YC(e.Props,e.Custprops)),r.join("")}function CP(){return""}function NP(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(Ce("NumberFormat",null,{"ss:Format":xt(He[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(Ce("Style",s.join(""),a))}),Ce("Styles",r.join(""))}function Ww(e){return Ce("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ep(e.Ref,{r:0,c:0})})}function AP(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(Ww(i)))}return Ce("Names",r.join(""))}function bP(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(Ww(o)))}return s.join("")}function IP(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Ce("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Ce("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Ce("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Ce("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(gr("ProtectContents","True")),e["!protect"].objects&&i.push(gr("ProtectObjects","True")),e["!protect"].scenarios&&i.push(gr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(gr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(gr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":Ce("WorksheetOptions",i.join(""),{xmlns:sn.x})}function FP(e){return e.map(function(t){var r=Qk(t.t||""),n=Ce("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ce("Comment",n,{"ss:Author":t.a})}).join("")}function RP(e,t,r,n,i,s,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+xt(ep(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var c=Dt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=xt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=xt(e.l.Tooltip))),r["!merges"])for(var l=r["!merges"],u=0;u!=l.length;++u)l[u].s.c!=a.c||l[u].s.r!=a.r||(l[u].e.c>l[u].s.c&&(o["ss:MergeAcross"]=l[u].e.c-l[u].s.c),l[u].e.r>l[u].s.r&&(o["ss:MergeDown"]=l[u].e.r-l[u].s.r));var h="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",m=String(e.v);break;case"b":h="Boolean",m=e.v?"1":"0";break;case"e":h="Error",m=Ii[e.v];break;case"d":h="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||He[14]);break;case"s":h="String",m=Xk(e.v||"");break}var x=ps(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+x),o["ss:Index"]=a.c+1;var g=e.v!=null?m:"",v=e.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(e.c||[]).length>0&&(v+=FP(e.c)),Ce("Cell",v,o)}function PP(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Xa(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function MP(e,t,r,n){if(!e["!ref"])return"";var i=ot(e["!ref"]),s=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(y,E){as(y);var w=!!y.width,T=nf(E,y),k={"ss:Index":E+1};w&&(k["ss:Width"]=bl(T.width)),y.hidden&&(k["ss:Hidden"]="1"),o.push(Ce("Column",null,k))});for(var c=Array.isArray(e),l=i.s.r;l<=i.e.r;++l){for(var u=[PP(l,(e["!rows"]||[])[l])],h=i.s.c;h<=i.e.c;++h){var m=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>l)&&!(s[a].e.c<h)&&!(s[a].e.r<l)){(s[a].s.c!=h||s[a].s.r!=l)&&(m=!0);break}if(!m){var x={r:l,c:h},g=ze(x),v=c?(e[l]||[])[h]:e[g];u.push(RP(v,g,e,t,r,n,x))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function DP(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],a=s?bP(s,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?MP(s,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(IP(s,t,e,r)),n.join("")}function LP(e,t){t||(t={}),e.SSF||(e.SSF=bt(He)),e.SSF&&(no(),Yu(e.SSF),t.revssf=Qu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ps(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(kP(e,t)),r.push(CP()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ce("Worksheet",DP(n,t,e),{"ss:Name":xt(e.SheetNames[n])}));return r[2]=NP(e,t),r[3]=AP(e),Wt+Ce("Workbook",r.join(""),{xmlns:sn.ss,"xmlns:o":sn.o,"xmlns:x":sn.x,"xmlns:ss":sn.ss,"xmlns:dt":sn.dt,"xmlns:html":sn.html})}function OP(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=AC(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=bC(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var UP=[60,1084,2066,2165,2175];function BP(e,t,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var c=xi(r,r.l),l=g0[c],u=0;l!=null&&UP.indexOf(c)>-1;)s=xi(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),o=r.slice(u,r.l+4+s),a.push(o),r.l+=4+s,l=g0[c=xi(r,r.l)];var h=lr(a);xr(h,0);var m=0;h.lens=[];for(var x=0;x<a.length;++x)h.lens.push(m),m+=a[x].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,i)}function Zn(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=He[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ii[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=_l(e.v):e.w=js(e.v):e.w=Fn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&ro(He[n]||String(n))){var i=bs(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Cc(e,t,r){return{v:e,ixfe:t,t:r}}function $P(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},a={},o=null,c=[],l="",u={},h,m="",x,g,v,y,E={},w=[],T,k,b=[],I=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},B={},D=function(Ke){return Ke<8?Rs[Ke]:Ke<64&&I[Ke-8]||Rs[Ke]},H=function(Ke,_t,nt){var ht=_t.XF.data;if(!(!ht||!ht.patternType||!nt||!nt.cellStyles)){_t.s={},_t.s.patternType=ht.patternType;var Gt;(Gt=Al(D(ht.icvFore)))&&(_t.s.fgColor={rgb:Gt}),(Gt=Al(D(ht.icvBack)))&&(_t.s.bgColor={rgb:Gt})}},Y=function(Ke,_t,nt){if(!(Z>1)&&!(nt.sheetRows&&Ke.r>=nt.sheetRows)){if(nt.cellStyles&&_t.XF&&_t.XF.data&&H(Ke,_t,nt),delete _t.ixfe,delete _t.XF,h=Ke,m=ze(Ke),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Ke.r<a.s.r&&(a.s.r=Ke.r),Ke.c<a.s.c&&(a.s.c=Ke.c),Ke.r+1>a.e.r&&(a.e.r=Ke.r+1),Ke.c+1>a.e.c&&(a.e.c=Ke.c+1),nt.cellFormula&&_t.f){for(var ht=0;ht<w.length;++ht)if(!(w[ht][0].s.c>Ke.c||w[ht][0].s.r>Ke.r)&&!(w[ht][0].e.c<Ke.c||w[ht][0].e.r<Ke.r)){_t.F=Xe(w[ht][0]),(w[ht][0].s.c!=Ke.c||w[ht][0].s.r!=Ke.r)&&delete _t.f,_t.f&&(_t.f=""+kr(w[ht][1],a,Ke,J,q));break}}nt.dense?(i[Ke.r]||(i[Ke.r]=[]),i[Ke.r][Ke.c]=_t):i[m]=_t}},q={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(q.password=t.password);var ue,Te=[],W=[],te=[],ge=[],oe=!1,J=[];J.SheetNames=q.snames,J.sharedf=q.sharedf,J.arrayf=q.arrayf,J.names=[],J.XTI=[];var de=0,Z=0,R=0,G=[],F=[],O;q.codepage=1200,$n(1200);for(var X=!1;e.l<e.length-1;){var he=e.l,ae=e.read_shift(2);if(ae===0&&de===10)break;var ve=e.l===e.length?0:e.read_shift(2),ye=g0[ae];if(ye&&ye.f){if(t.bookSheets&&de===133&&ae!==133)break;if(de=ae,ye.r===2||ye.r==12){var Ge=e.read_shift(2);if(ve-=2,!q.enc&&Ge!==ae&&((Ge&255)<<8|Ge>>8)!==ae)throw new Error("rt mismatch: "+Ge+"!="+ae);ye.r==12&&(e.l+=10,ve-=10)}var C={};if(ae===10?C=ye.f(e,ve,q):C=BP(ae,ye,e,ve,q),Z==0&&[9,521,1033,2057].indexOf(de)===-1)continue;switch(ae){case 34:r.opts.Date1904=S.WBProps.date1904=C;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(q.enc||(e.l=0),q.enc=C,!t.password)throw new Error("File is password-protected");if(C.valid==null)throw new Error("Encryption scheme unsupported");if(!C.valid)throw new Error("Password is incorrect");break;case 92:q.lastuser=C;break;case 66:var Re=Number(C);switch(Re){case 21010:Re=1200;break;case 32768:Re=1e4;break;case 32769:Re=1252;break}$n(q.codepage=Re),X=!0;break;case 317:q.rrtabid=C;break;case 25:q.winlocked=C;break;case 439:r.opts.RefreshAll=C;break;case 12:r.opts.CalcCount=C;break;case 16:r.opts.CalcDelta=C;break;case 17:r.opts.CalcIter=C;break;case 13:r.opts.CalcMode=C;break;case 14:r.opts.CalcPrecision=C;break;case 95:r.opts.CalcSaveRecalc=C;break;case 15:q.CalcRefMode=C;break;case 2211:r.opts.FullCalc=C;break;case 129:C.fDialog&&(i["!type"]="dialog"),C.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),C.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:b.push(C);break;case 430:J.push([C]),J[J.length-1].XTI=[];break;case 35:case 547:J[J.length-1].push(C);break;case 24:case 536:O={Name:C.Name,Ref:kr(C.rgce,a,null,J,q)},C.itab>0&&(O.Sheet=C.itab-1),J.names.push(O),J[0]||(J[0]=[],J[0].XTI=[]),J[J.length-1].push(C),C.Name=="_xlnm._FilterDatabase"&&C.itab>0&&C.rgce&&C.rgce[0]&&C.rgce[0][0]&&C.rgce[0][0][0]=="PtgArea3d"&&(F[C.itab-1]={ref:Xe(C.rgce[0][0][1][2])});break;case 22:q.ExternCount=C;break;case 23:J.length==0&&(J[0]=[],J[0].XTI=[]),J[J.length-1].XTI=J[J.length-1].XTI.concat(C),J.XTI=J.XTI.concat(C);break;case 2196:if(q.biff<8)break;O!=null&&(O.Comment=C[1]);break;case 18:i["!protect"]=C;break;case 19:C!==0&&q.WTF&&console.error("Password verifier: "+C);break;case 133:s[C.pos]=C,q.snames.push(C.name);break;case 10:{if(--Z)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=Xe(a),t.sheetRows&&t.sheetRows<=a.e.r){var Ve=a.e.r;a.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Xe(a),a.e.r=Ve}a.e.r++,a.e.c++}Te.length>0&&(i["!merges"]=Te),W.length>0&&(i["!objects"]=W),te.length>0&&(i["!cols"]=te),ge.length>0&&(i["!rows"]=ge),S.Sheets.push(B)}l===""?u=i:n[l]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(q.biff===8&&(q.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[C.BIFFVer]||8),q.biffguess=C.BIFFVer==0,C.BIFFVer==0&&C.dt==4096&&(q.biff=5,X=!0,$n(q.codepage=28591)),q.biff==8&&C.BIFFVer==0&&C.dt==16&&(q.biff=2),Z++)break;if(i=t.dense?[]:{},q.biff<8&&!X&&(X=!0,$n(q.codepage=t.codepage||1252)),q.biff<5||C.BIFFVer==0&&C.dt==4096){l===""&&(l="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var dt={pos:e.l-ve,name:l};s[dt.pos]=dt,q.snames.push(l)}else l=(s[he]||{name:""}).name;C.dt==32&&(i["!type"]="chart"),C.dt==64&&(i["!type"]="macro"),Te=[],W=[],q.arrayf=w=[],te=[],ge=[],oe=!1,B={Hidden:(s[he]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[C.r]||[])[C.c]:i[ze({c:C.c,r:C.r})])&&++C.c,T={ixfe:C.ixfe,XF:b[C.ixfe]||{},v:C.val,t:"n"},R>0&&(T.z=G[T.ixfe>>8&63]),Zn(T,t,r.opts.Date1904),Y({c:C.c,r:C.r},T,t);break;case 5:case 517:T={ixfe:C.ixfe,XF:b[C.ixfe],v:C.val,t:C.t},R>0&&(T.z=G[T.ixfe>>8&63]),Zn(T,t,r.opts.Date1904),Y({c:C.c,r:C.r},T,t);break;case 638:T={ixfe:C.ixfe,XF:b[C.ixfe],v:C.rknum,t:"n"},R>0&&(T.z=G[T.ixfe>>8&63]),Zn(T,t,r.opts.Date1904),Y({c:C.c,r:C.r},T,t);break;case 189:for(var Ze=C.c;Ze<=C.C;++Ze){var Ie=C.rkrec[Ze-C.c][0];T={ixfe:Ie,XF:b[Ie],v:C.rkrec[Ze-C.c][1],t:"n"},R>0&&(T.z=G[T.ixfe>>8&63]),Zn(T,t,r.opts.Date1904),Y({c:Ze,r:C.r},T,t)}break;case 6:case 518:case 1030:{if(C.val=="String"){o=C;break}if(T=Cc(C.val,C.cell.ixfe,C.tt),T.XF=b[T.ixfe],t.cellFormula){var wt=C.formula;if(wt&&wt[0]&&wt[0][0]&&wt[0][0][0]=="PtgExp"){var Mr=wt[0][0][1][0],Gr=wt[0][0][1][1],Vr=ze({r:Mr,c:Gr});E[Vr]?T.f=""+kr(C.formula,a,C.cell,J,q):T.F=((t.dense?(i[Mr]||[])[Gr]:i[Vr])||{}).F}else T.f=""+kr(C.formula,a,C.cell,J,q)}R>0&&(T.z=G[T.ixfe>>8&63]),Zn(T,t,r.opts.Date1904),Y(C.cell,T,t),o=C}break;case 7:case 519:if(o)o.val=C,T=Cc(C,o.cell.ixfe,"s"),T.XF=b[T.ixfe],t.cellFormula&&(T.f=""+kr(o.formula,a,o.cell,J,q)),R>0&&(T.z=G[T.ixfe>>8&63]),Zn(T,t,r.opts.Date1904),Y(o.cell,T,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(C);var ra=ze(C[0].s);if(x=t.dense?(i[C[0].s.r]||[])[C[0].s.c]:i[ra],t.cellFormula&&x){if(!o||!ra||!x)break;x.f=""+kr(C[1],a,C[0],J,q),x.F=Xe(C[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;E[ze(o.cell)]=C[0],x=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[ze(o.cell)],(x||{}).f=""+kr(C[0],a,h,J,q)}}break;case 253:T=Cc(c[C.isst].t,C.ixfe,"s"),c[C.isst].h&&(T.h=c[C.isst].h),T.XF=b[T.ixfe],R>0&&(T.z=G[T.ixfe>>8&63]),Zn(T,t,r.opts.Date1904),Y({c:C.c,r:C.r},T,t);break;case 513:t.sheetStubs&&(T={ixfe:C.ixfe,XF:b[C.ixfe],t:"z"},R>0&&(T.z=G[T.ixfe>>8&63]),Zn(T,t,r.opts.Date1904),Y({c:C.c,r:C.r},T,t));break;case 190:if(t.sheetStubs)for(var tn=C.c;tn<=C.C;++tn){var Qt=C.ixfe[tn-C.c];T={ixfe:Qt,XF:b[Qt],t:"z"},R>0&&(T.z=G[T.ixfe>>8&63]),Zn(T,t,r.opts.Date1904),Y({c:tn,r:C.r},T,t)}break;case 214:case 516:case 4:T=Cc(C.val,C.ixfe,"s"),T.XF=b[T.ixfe],R>0&&(T.z=G[T.ixfe>>8&63]),Zn(T,t,r.opts.Date1904),Y({c:C.c,r:C.r},T,t);break;case 0:case 512:Z===1&&(a=C);break;case 252:c=C;break;case 1054:if(q.biff==4){G[R++]=C[1];for(var mn=0;mn<R+163&&He[mn]!=C[1];++mn);mn>=163&&yi(C[1],R+163)}else yi(C[1],C[0]);break;case 30:{G[R++]=C;for(var Kn=0;Kn<R+163&&He[Kn]!=C;++Kn);Kn>=163&&yi(C,R+163)}break;case 229:Te=Te.concat(C);break;case 93:W[C.cmo[0]]=q.lastobj=C;break;case 438:q.lastobj.TxO=C;break;case 127:q.lastobj.ImData=C;break;case 440:for(y=C[0].s.r;y<=C[0].e.r;++y)for(v=C[0].s.c;v<=C[0].e.c;++v)x=t.dense?(i[y]||[])[v]:i[ze({c:v,r:y})],x&&(x.l=C[1]);break;case 2048:for(y=C[0].s.r;y<=C[0].e.r;++y)for(v=C[0].s.c;v<=C[0].e.c;++v)x=t.dense?(i[y]||[])[v]:i[ze({c:v,r:y})],x&&x.l&&(x.l.Tooltip=C[1]);break;case 28:{if(q.biff<=5&&q.biff>=2)break;x=t.dense?(i[C[0].r]||[])[C[0].c]:i[ze(C[0])];var ui=W[C[2]];x||(t.dense?(i[C[0].r]||(i[C[0].r]=[]),x=i[C[0].r][C[0].c]={t:"z"}):x=i[ze(C[0])]={t:"z"},a.e.r=Math.max(a.e.r,C[0].r),a.s.r=Math.min(a.s.r,C[0].r),a.e.c=Math.max(a.e.c,C[0].c),a.s.c=Math.min(a.s.c,C[0].c)),x.c||(x.c=[]),g={a:C[1],t:ui.TxO.t},x.c.push(g)}break;case 2173:NI(b[C.ixfe],C.ext);break;case 125:{if(!q.cellStyles)break;for(;C.e>=C.s;)te[C.e--]={width:C.w/256,level:C.level||0,hidden:!!(C.flags&1)},oe||(oe=!0,Xh(C.w/256)),as(te[C.e+1])}break;case 520:{var lt={};C.level!=null&&(ge[C.r]=lt,lt.level=C.level),C.hidden&&(ge[C.r]=lt,lt.hidden=!0),C.hpt&&(ge[C.r]=lt,lt.hpt=C.hpt,lt.hpx=Xa(C.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Ds(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=C;break;case 161:i["!margins"]||Ds(i["!margins"]={}),i["!margins"].header=C.header,i["!margins"].footer=C.footer;break;case 574:C.RTL&&(S.Views[0].RTL=!0);break;case 146:I=C;break;case 2198:ue=C;break;case 140:k=C;break;case 442:l?B.CodeName=C||B.name:S.WBProps.CodeName=C||"ThisWorkbook";break}}else ye||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),e.l+=ve}return r.SheetNames=jt(s).sort(function(rn,Ke){return Number(rn)-Number(Ke)}).map(function(rn){return s[rn].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&F.forEach(function(rn,Ke){r.Sheets[r.SheetNames[Ke]]["!autofilter"]=rn}),r.Strings=c,r.SSF=bt(He),q.enc&&(r.Encryption=q.enc),ue&&(r.Themes=ue),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),J.names.length>0&&(S.Names=J.names),r.Workbook=S,r}var el={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function jP(e,t,r){var n=je.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=Px(n,u0,el.DSI);for(var s in i)t[s]=i[s]}catch(l){if(r.WTF)throw l}var a=je.find(e,"/!SummaryInformation");if(a&&a.size>0)try{var o=Px(a,f0,el.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(l){if(r.WTF)throw l}t.HeadingPairs&&t.TitlesOfParts&&(z2(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function GP(e,t){var r=[],n=[],i=[],s=0,a,o=cx(u0,"n"),c=cx(f0,"n");if(e.Props)for(a=jt(e.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],e.Props[a[s]]]);if(e.Custprops)for(a=jt(e.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],e.Custprops[a[s]]]);var l=[];for(s=0;s<i.length;++s)Q2.indexOf(i[s][0])>-1||H2.indexOf(i[s][0])>-1||i[s][1]!=null&&l.push(i[s]);n.length&&je.utils.cfb_add(t,"/SummaryInformation",Mx(n,el.SI,c,f0)),(r.length||l.length)&&je.utils.cfb_add(t,"/DocumentSummaryInformation",Mx(r,el.DSI,o,u0,l.length?l:null,el.UDI))}function qw(e,t){t||(t={}),ap(t),Nh(),t.codepage&&Ch(t.codepage);var r,n;if(e.FullPaths){if(je.find(e,"/encryption"))throw new Error("File is password-protected");r=je.find(e,"!CompObj"),n=je.find(e,"/Workbook")||je.find(e,"/Book")}else{switch(t.type){case"base64":e=on(dn(e));break;case"binary":e=on(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}xr(e,0),n={content:e}}var i,s;if(r&&OP(r),t.bookProps&&!t.bookSheets)i={};else{var a=et?"buffer":"array";if(n&&n.content)i=$P(n.content,t);else if((s=je.find(e,"PerfectOffice_MAIN"))&&s.content)i=Ms.to_workbook(s.content,(t.type=a,t));else if((s=je.find(e,"NativeContent_MAIN"))&&s.content)i=Ms.to_workbook(s.content,(t.type=a,t));else throw(s=je.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&je.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=t4(e))}var o={};return e.FullPaths&&jP(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}function VP(e,t){var r=t||{},n=je.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return je.utils.cfb_add(n,i,Jw(e,r)),r.biff==8&&(e.Props||e.Custprops)&&GP(e,n),r.biff==8&&e.vbaraw&&r4(n,je.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Rl={0:{f:hR},1:{f:ER},2:{f:$R},3:{f:bR},4:{f:kR},5:{f:OR},6:{f:zR},7:{f:PR},8:{f:QR},9:{f:XR},10:{f:KR},11:{f:YR},12:{f:_R},13:{f:GR},14:{f:FR},15:{f:NR},16:{f:Bw},17:{f:qR},18:{f:DR},19:{f:jh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:q3},40:{},42:{},43:{f:zb},44:{f:Vb},45:{f:Jb},46:{f:Yb},47:{f:Kb},48:{},49:{f:xC},50:{},51:{f:II},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:cw},62:{f:HR},63:{f:BI},64:{f:p3},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Rr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:u3},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:yR},148:{f:xR,p:16},151:{f:i3},152:{},153:{f:H3},154:{},155:{},156:{f:G3},157:{},158:{},159:{T:1,f:ab},160:{T:-1},161:{T:1,f:Zs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ZR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:AI},336:{T:-1},337:{f:PI,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:c0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:lw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:s3},427:{f:a3},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:l3},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:vR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:r3},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:c0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:YI},633:{T:1},634:{T:-1},635:{T:1,f:JI},636:{T:-1},637:{f:wC},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:F3},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:m3},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},g0={6:{f:Qf},10:{f:Bi},12:{f:Yt},13:{f:Yt},14:{f:Vt},15:{f:Vt},16:{f:Ar},17:{f:Vt},18:{f:Vt},19:{f:Yt},20:{f:$x},21:{f:$x},23:{f:lw},24:{f:Gx},25:{f:Vt},26:{},27:{},28:{f:mA},29:{},34:{f:Vt},35:{f:jx},38:{f:Ar},39:{f:Ar},40:{f:Ar},41:{f:Ar},42:{f:Vt},43:{f:Vt},47:{f:Nb},49:{f:GN},51:{f:Yt},60:{},61:{f:ON},64:{f:Vt},65:{f:jN},66:{f:Yt},77:{},80:{},81:{},82:{},85:{f:Yt},89:{},90:{},91:{},92:{f:CN},93:{f:vA},94:{},95:{f:Vt},96:{},97:{},99:{f:Vt},125:{f:cw},128:{f:nA},129:{f:AN},130:{f:Yt},131:{f:Vt},132:{f:Vt},133:{f:bN},134:{},140:{f:CA},141:{f:Yt},144:{},146:{f:bA},151:{},152:{},153:{},154:{},155:{},156:{f:Yt},157:{},158:{},160:{f:LA},161:{f:RA},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:ZN},190:{f:eA},193:{f:Bi},197:{},198:{},199:{},200:{},201:{},202:{f:Vt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Yt},220:{},221:{f:Vt},222:{},224:{f:rA},225:{f:kN},226:{f:Bi},227:{},229:{f:xA},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:FN},253:{f:HN},255:{f:PN},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Z2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Vt},353:{f:Bi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:lA},431:{f:Vt},432:{},433:{},434:{},437:{},438:{f:EA},439:{f:Vt},440:{f:TA},441:{},442:{f:Hl},443:{},444:{f:Yt},445:{},446:{},448:{f:Bi},449:{f:LN,r:2},450:{f:Bi},512:{f:Ox},513:{f:DA},515:{f:aA},516:{f:WN},517:{f:Bx},519:{f:OA},520:{f:MN},523:{},545:{f:Vx},549:{f:Lx},566:{},574:{f:BN},638:{f:QN},659:{},1048:{},1054:{f:JN},1084:{},1212:{f:dA},2048:{f:SA},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:_c},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Bi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:IA,r:12},2173:{f:CI,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Vt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:fA,r:12},2197:{},2198:{f:wI,r:12},2199:{},2200:{},2201:{},2202:{f:hA,r:12},2203:{f:Bi},2204:{},2205:{},2206:{},2207:{},2211:{f:DN},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Yt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:PA},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:AA},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Ox},1:{},2:{f:GA},3:{f:$A},4:{f:BA},5:{f:Bx},7:{f:HA},8:{},9:{f:_c},11:{},22:{f:Yt},30:{f:YN},31:{},32:{},33:{f:Vx},36:{},37:{f:Lx},50:{f:zA},62:{},52:{},67:{},68:{f:Yt},69:{},86:{},126:{},127:{f:UA},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:WA},223:{},234:{},354:{},421:{},518:{f:Qf},521:{f:_c},536:{f:Gx},547:{f:jx},561:{},579:{},1030:{f:Qf},1033:{f:_c},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ne(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Uh(r)&&e.push(r)}}function HP(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Ne(e,t,r,i);var s=t;if(!isNaN(s)){for(var a=r.parts||[],o=0,c=0,l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,l),e.push(r.slice(c,c+l)),c+=l;c<i;){for(u=e.next(4),u.write_shift(2,60),l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;u.write_shift(2,l),e.push(r.slice(c,c+l)),c+=l}}}function Jl(e,t,r){return e||(e=le(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function zP(e,t,r,n){var i=le(9);return Jl(i,e,t),ew(r,n||"b",i),i}function WP(e,t,r){var n=le(8+2*r.length);return Jl(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function qP(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?ir(At(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Ne(e,2,VA(r,n,i)):Ne(e,3,jA(r,n,i));return;case"b":case"e":Ne(e,5,zP(r,n,t.v,t.t));return;case"s":case"str":Ne(e,4,WP(r,n,(t.v||"").slice(0,255)));return}Ne(e,1,Jl(null,r,n))}function JP(e,t,r,n){var i=Array.isArray(t),s=ot(t["!ref"]||"A1"),a,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Xe(s)}for(var l=s.s.r;l<=s.e.r;++l){o=zt(l);for(var u=s.s.c;u<=s.e.c;++u){l===s.s.r&&(c[u]=Mt(u)),a=c[u]+o;var h=i?(t[l]||[])[u]:t[a];h&&qP(e,h,l,u)}}}function KP(e,t){for(var r=t||{},n=Zr(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ne(n,r.biff==4?1033:r.biff==3?521:9,Jh(e,16,r)),JP(n,e.Sheets[e.SheetNames[i]],i,r),Ne(n,10),n.end()}function YP(e,t,r){Ne(e,49,VN({sz:12,name:"Arial"},r))}function XP(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Ne(e,1054,KN(i,t[i],r))})}function QP(e,t){var r=le(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ne(e,2151,r),r=le(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),sw(ot(t["!ref"]||"A1"),r),r.write_shift(4,4),Ne(e,2152,r)}function ZP(e,t){for(var r=0;r<16;++r)Ne(e,224,Ux({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ne(e,224,Ux(n,0,t))})}function eM(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ne(e,440,_A(n)),n[1].Tooltip&&Ne(e,2048,kA(n))}delete t["!links"]}function tM(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Ne(e,125,FA(nf(i,n),i))})}}function rM(e,t,r,n,i){var s=16+ps(i.cellXfs,t,i);if(t.v==null&&!t.bf){Ne(e,513,zs(r,n,s));return}if(t.bf)Ne(e,6,AF(t,r,n,i,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?ir(At(t.v)):t.v;Ne(e,515,oA(r,n,a,s));break;case"b":case"e":Ne(e,517,sA(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=rp(i.Strings,t.v,i.revStrings);Ne(e,253,zN(r,n,o,s))}else Ne(e,516,qN(r,n,(t.v||"").slice(0,255),s,i));break;default:Ne(e,513,zs(r,n,s))}}function nM(e,t,r){var n=Zr(),i=r.SheetNames[e],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[e]||{},c=Array.isArray(s),l=t.biff==8,u,h="",m=[],x=ot(s["!ref"]||"A1"),g=l?65536:16384;if(x.e.c>255||x.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,g-1)}Ne(n,2057,Jh(r,16,t)),Ne(n,13,Tn(1)),Ne(n,12,Tn(100)),Ne(n,15,Or(!0)),Ne(n,17,Or(!1)),Ne(n,16,Vs(.001)),Ne(n,95,Or(!0)),Ne(n,42,Or(!1)),Ne(n,43,Or(!1)),Ne(n,130,Tn(1)),Ne(n,128,iA()),Ne(n,131,Or(!1)),Ne(n,132,Or(!1)),l&&tM(n,s["!cols"]),Ne(n,512,XN(x,t)),l&&(s["!links"]=[]);for(var v=x.s.r;v<=x.e.r;++v){h=zt(v);for(var y=x.s.c;y<=x.e.c;++y){v===x.s.r&&(m[y]=Mt(y)),u=m[y]+h;var E=c?(s[v]||[])[y]:s[u];E&&(rM(n,E,v,y,t),l&&E.l&&s["!links"].push([u,E.l]))}}var w=o.CodeName||o.name||i;return l&&Ne(n,574,$N((a.Views||[])[0])),l&&(s["!merges"]||[]).length&&Ne(n,229,gA(s["!merges"])),l&&eM(n,s),Ne(n,442,tw(w)),l&&QP(n,s),Ne(n,10),n.end()}function iM(e,t,r){var n=Zr(),i=(e||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,c=r.biff==5;if(Ne(n,2057,Jh(e,5,r)),r.bookType=="xla"&&Ne(n,135),Ne(n,225,o?Tn(1200):null),Ne(n,193,sN(2)),c&&Ne(n,191),c&&Ne(n,192),Ne(n,226),Ne(n,92,NN("SheetJS",r)),Ne(n,66,Tn(o?1200:1252)),o&&Ne(n,353,Tn(0)),o&&Ne(n,448),Ne(n,317,MA(e.SheetNames.length)),o&&e.vbaraw&&Ne(n,211),o&&e.vbaraw){var l=a.CodeName||"ThisWorkbook";Ne(n,442,tw(l))}Ne(n,156,Tn(17)),Ne(n,25,Or(!1)),Ne(n,18,Or(!1)),Ne(n,19,Tn(0)),o&&Ne(n,431,Or(!1)),o&&Ne(n,444,Tn(0)),Ne(n,61,UN()),Ne(n,64,Or(!1)),Ne(n,141,Tn(0)),Ne(n,34,Or(L3(e)=="true")),Ne(n,14,Or(!0)),o&&Ne(n,439,Or(!1)),Ne(n,218,Tn(0)),YP(n,e,r),XP(n,e.SSF,r),ZP(n,r),o&&Ne(n,352,Or(!1));var u=n.end(),h=Zr();o&&Ne(h,140,NA()),o&&r.Strings&&HP(h,252,RN(r.Strings)),Ne(h,10);var m=h.end(),x=Zr(),g=0,v=0;for(v=0;v<e.SheetNames.length;++v)g+=(o?12:11)+(o?2:1)*e.SheetNames[v].length;var y=u.length+g+m.length;for(v=0;v<e.SheetNames.length;++v){var E=s[v]||{};Ne(x,133,IN({pos:y,hs:E.Hidden||0,dt:0,name:e.SheetNames[v]},r)),y+=t[v].length}var w=x.end();if(g!=w.length)throw new Error("BS8 "+g+" != "+w.length);var T=[];return u.length&&T.push(u),w.length&&T.push(w),m.length&&T.push(m),lr(T)}function sM(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=bt(He)),e&&e.SSF&&(no(),Yu(e.SSF),r.revssf=Qu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,op(r),r.cellXfs=[],ps(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=nM(i,r,e);return n.unshift(iM(e,n,r)),lr(n)}function Jw(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=en(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return sM(e,t);case 4:case 3:case 2:return KP(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Zx(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),a=i.index,o=s&&s.index||e.length,c=Vk(e.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,u=0,h=0,m=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(a=0;a<c.length;++a){var v=c[a].trim(),y=v.slice(0,3).toLowerCase();if(y=="<tr"){if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}u=0;continue}if(!(y!="<td"&&y!="<th")){var E=v.split(/<\/t[dh]>/i);for(o=0;o<E.length;++o){var w=E[o].trim();if(w.match(/<t[dh]/i)){for(var T=w,k=0;T.charAt(0)=="<"&&(k=T.indexOf(">"))>-1;)T=T.slice(k+1);for(var b=0;b<g.length;++b){var I=g[b];I.s.c==u&&I.s.r<l&&l<=I.e.r&&(u=I.e.c+1,b=-1)}var S=We(w.slice(0,w.indexOf(">")));m=S.colspan?+S.colspan:1,((h=+S.rowspan)>1||m>1)&&g.push({s:{r:l,c:u},e:{r:l+(h||1)-1,c:u+m-1}});var B=S.t||S["data-t"]||"";if(!T.length){u+=m;continue}if(T=v2(T),x.s.r>l&&(x.s.r=l),x.e.r<l&&(x.e.r=l),x.s.c>u&&(x.s.c=u),x.e.c<u&&(x.e.c=u),!T.length){u+=m;continue}var D={t:"s",v:T};r.raw||!T.trim().length||B=="s"||(T==="TRUE"?D={t:"b",v:!0}:T==="FALSE"?D={t:"b",v:!1}:isNaN(Hn(T))?isNaN(Ka(T).getDate())||(D={t:"d",v:At(T)},r.cellDates||(D={t:"n",v:ir(D.v)}),D.z=r.dateNF||He[14]):D={t:"n",v:Hn(T)}),r.dense?(n[l]||(n[l]=[]),n[l][u]=D):n[ze({r:l,c:u})]=D,u+=m}}}}return n["!ref"]=Xe(x),g.length&&(n["!merges"]=g),n}function aM(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,c=0,l=0;l<i.length;++l)if(!(i[l].s.r>r||i[l].s.c>a)&&!(i[l].e.r<r||i[l].e.c<a)){if(i[l].s.r<r||i[l].s.c<a){o=-1;break}o=i[l].e.r-i[l].s.r+1,c=i[l].e.c-i[l].s.c+1;break}if(!(o<0)){var u=ze({r,c:a}),h=n.dense?(e[r]||[])[a]:e[u],m=h&&h.v!=null&&(h.h||Dh(h.w||(ki(h),h.w)||""))||"",x={};o>1&&(x.rowspan=o),c>1&&(x.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":h&&(x["data-t"]=h&&h.t||"z",h.v!=null&&(x["data-v"]=h.v),h.z!=null&&(x["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+h.l.Target+'">'+m+"</a>")),x.id=(n.id||"sjs")+"-"+u,s.push(Ce("td",m,x))}}var g="<tr>";return g+s.join("")+"</tr>"}var oM='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',lM="</body></html>";function cM(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return hs(Zx(r[0],t),t);var n=up();return r.forEach(function(i,s){fp(n,Zx(i,t),"Sheet"+(s+1))}),n}function uM(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Kw(e,t){var r=t||{},n=r.header!=null?r.header:oM,i=r.footer!=null?r.footer:lM,s=[n],a=en(e["!ref"]);r.dense=Array.isArray(e),s.push(uM(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(aM(e,a,o,r));return s.push("</table>"+i),s.join("")}function Yw(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Dt(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=en(e["!ref"]);l.s.r=Math.min(l.s.r,u.s.r),l.s.c=Math.min(l.s.c,u.s.c),l.e.r=Math.max(l.e.r,u.e.r),l.e.c=Math.max(l.e.c,u.e.c),i==-1&&(l.e.r=i=u.e.r+1)}var h=[],m=0,x=e["!rows"]||(e["!rows"]=[]),g=0,v=0,y=0,E=0,w=0,T=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&v<c;++g){var k=o[g];if(eg(k)){if(n.display)continue;x[v]={hidden:!0}}var b=k.children;for(y=E=0;y<b.length;++y){var I=b[y];if(!(n.display&&eg(I))){var S=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):v2(I.innerHTML),B=I.getAttribute("data-z")||I.getAttribute("z");for(m=0;m<h.length;++m){var D=h[m];D.s.c==E+s&&D.s.r<v+i&&v+i<=D.e.r&&(E=D.e.c+1-s,m=-1)}T=+I.getAttribute("colspan")||1,((w=+I.getAttribute("rowspan")||1)>1||T>1)&&h.push({s:{r:v+i,c:E+s},e:{r:v+i+(w||1)-1,c:E+s+(T||1)-1}});var H={t:"s",v:S},Y=I.getAttribute("data-t")||I.getAttribute("t")||"";S!=null&&(S.length==0?H.t=Y||"z":n.raw||S.trim().length==0||Y=="s"||(S==="TRUE"?H={t:"b",v:!0}:S==="FALSE"?H={t:"b",v:!1}:isNaN(Hn(S))?isNaN(Ka(S).getDate())||(H={t:"d",v:At(S)},n.cellDates||(H={t:"n",v:ir(H.v)}),H.z=n.dateNF||He[14]):H={t:"n",v:Hn(S)})),H.z===void 0&&B!=null&&(H.z=B);var q="",ue=I.getElementsByTagName("A");if(ue&&ue.length)for(var Te=0;Te<ue.length&&!(ue[Te].hasAttribute("href")&&(q=ue[Te].getAttribute("href"),q.charAt(0)!="#"));++Te);q&&q.charAt(0)!="#"&&(H.l={Target:q}),n.dense?(e[v+i]||(e[v+i]=[]),e[v+i][E+s]=H):e[ze({c:E+s,r:v+i})]=H,l.e.c<E+s&&(l.e.c=E+s),E+=T}}++v}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),l.e.r=Math.max(l.e.r,v-1+i),e["!ref"]=Xe(l),v>=c&&(e["!fullref"]=Xe((l.e.r=o.length-g+v-1+i,l))),e}function Xw(e,t){var r=t||{},n=r.dense?[]:{};return Yw(n,e,t)}function fM(e,t){return hs(Xw(e,t),t)}function eg(e){var t="",r=dM(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function dM(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function hM(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=at(t.replace(/<[^>]*>/g,""));return[r]}var tg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Qw(e,t){var r=t||{},n=Lh(e),i=[],s,a,o={name:""},c="",l=0,u,h,m={},x=[],g=r.dense?[]:{},v,y,E={value:""},w="",T=0,k=[],b=-1,I=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},B=0,D={},H=[],Y={},q=0,ue=0,Te=[],W=1,te=1,ge=[],oe={Names:[]},J={},de=["",""],Z=[],R={},G="",F=0,O=!1,X=!1,he=0;for(Cl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=Cl.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?g["!ref"]=Xe(S):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(g["!fullref"]=g["!ref"],S.e.r=r.sheetRows-1,g["!ref"]=Xe(S)),H.length&&(g["!merges"]=H),Te.length&&(g["!rows"]=Te),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),x.push(u.name),m[u.name]=g,X=!1):v[0].charAt(v[0].length-2)!=="/"&&(u=We(v[0],!1),b=I=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,g=r.dense?[]:{},H=[],Te=[],X=!0);break;case"table-row-group":v[1]==="/"?--B:++B;break;case"table-row":case"":if(v[1]==="/"){b+=W,W=1;break}if(h=We(v[0],!1),h.?b=h.-1:b==-1&&(b=0),W=+h["number-rows-repeated"]||1,W<10)for(he=0;he<W;++he)B>0&&(Te[b+he]={level:B});I=-1;break;case"covered-table-cell":v[1]!=="/"&&++I,r.sheetStubs&&(r.dense?(g[b]||(g[b]=[]),g[b][I]={t:"z"}):g[ze({r:b,c:I})]={t:"z"}),w="",k=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++I,E=We(v[0],!1),te=parseInt(E["number-columns-repeated"]||"1",10),y={t:"z",v:null},E.formula&&r.cellFormula!=!1&&(y.f=Yx(at(E.formula))),(E.||E["value-type"])=="string"&&(y.t="s",y.v=at(E["string-value"]||""),r.dense?(g[b]||(g[b]=[]),g[b][I]=y):g[ze({r:b,c:I})]=y),I+=te-1;else if(v[1]!=="/"){++I,w="",T=0,k=[],te=1;var ae=W?b+W-1:b;if(I>S.e.c&&(S.e.c=I),I<S.s.c&&(S.s.c=I),b<S.s.r&&(S.s.r=b),ae>S.e.r&&(S.e.r=ae),E=We(v[0],!1),Z=[],R={},y={t:E.||E["value-type"],v:null},r.cellFormula)if(E.formula&&(E.formula=at(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(q=parseInt(E["number-matrix-rows-spanned"],10)||0,ue=parseInt(E["number-matrix-columns-spanned"],10)||0,Y={s:{r:b,c:I},e:{r:b+q-1,c:I+ue-1}},y.F=Xe(Y),ge.push([Y,y.F])),E.formula)y.f=Yx(E.formula);else for(he=0;he<ge.length;++he)b>=ge[he][0].s.r&&b<=ge[he][0].e.r&&I>=ge[he][0].s.c&&I<=ge[he][0].e.c&&(y.F=ge[he][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(q=parseInt(E["number-rows-spanned"],10)||0,ue=parseInt(E["number-columns-spanned"],10)||0,Y={s:{r:b,c:I},e:{r:b+q-1,c:I+ue-1}},H.push(Y)),E["number-columns-repeated"]&&(te=parseInt(E["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Ct(E["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(E.value);break;case"percentage":y.t="n",y.v=parseFloat(E.value);break;case"currency":y.t="n",y.v=parseFloat(E.value);break;case"date":y.t="d",y.v=At(E["date-value"]),r.cellDates||(y.t="n",y.v=ir(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=$k(E["time-value"])/86400,r.cellDates&&(y.t="d",y.v=Zu(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(E.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",E["string-value"]!=null&&(w=at(E["string-value"]),k=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(O=!1,y.t==="s"&&(y.v=w||"",k.length&&(y.R=k),O=T==0),J.Target&&(y.l=J),Z.length>0&&(y.c=Z,Z=[]),w&&r.cellText!==!1&&(y.w=w),O&&(y.t="z",delete y.v),(!O||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=b))for(var ve=0;ve<W;++ve){if(te=parseInt(E["number-columns-repeated"]||"1",10),r.dense)for(g[b+ve]||(g[b+ve]=[]),g[b+ve][I]=ve==0?y:bt(y);--te>0;)g[b+ve][I+te]=bt(y);else for(g[ze({r:b+ve,c:I})]=y;--te>0;)g[ze({r:b+ve,c:I+te})]=bt(y);S.e.c<=I&&(S.e.c=I)}te=parseInt(E["number-columns-repeated"]||"1",10),I+=te-1,te=0,y={},w="",k=[]}J={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((s=i.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((s=i.pop())[0]!==v[3])throw"Bad state: "+s;R.t=w,k.length&&(R.R=k),R.a=G,Z.push(R)}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!1]);G="",F=0,w="",T=0,k=[];break;case"creator":v[1]==="/"?G=n.slice(F,v.index):F=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((s=i.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!1]);w="",T=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(D[o.name]=c,(s=i.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&(c="",o=We(v[0],!1),i.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=We(v[0],!1),c+=tg[v[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=We(v[0],!1),c+=tg[v[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(l,v.index);break}else l=v.index+v[0].length;break;case"named-range":a=We(v[0],!1),de=Zf(a["cell-range-address"]);var ye={Name:a.name,Ref:de[0]+"!"+de[1]};X&&(ye.Sheet=x.length),oe.Names.push(ye);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(v[1]==="/"&&(!E||!E["string-value"])){var Ge=hM(n.slice(T,v.index));w=(w.length>0?w+`
`:"")+Ge[0]}else We(v[0],!1),T=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{de=Zf(We(v[0])["target-range-address"]),m[de[0]]["!autofilter"]={ref:de[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(J=We(v[0],!1),!J.href)break;J.Target=at(J.href),delete J.href,J.Target.charAt(0)=="#"&&J.Target.indexOf(".")>-1?(de=Zf(J.Target.slice(1)),J.Target="#"+de[0]+"!"+de[1]):J.Target.match(/^\.\.[\\\/]/)&&(J.Target=J.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var C={Sheets:m,SheetNames:x,Workbook:oe};return r.bookSheets&&delete C.Sheets,C}function rg(e,t){t=t||{},En(e,"META-INF/manifest.xml")&&$C(Kt(e,"META-INF/manifest.xml"),t);var r=ln(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Qw(yt(r),t);return En(e,"meta.xml")&&(n.Props=G2(Kt(e,"meta.xml"))),n}function ng(e,t){return Qw(e,t)}var pM=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+kl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Wt+t}}(),ig=function(){var e=function(s){return xt(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var c=[];c.push('      <table:table table:name="'+xt(a.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,u=0,h=en(s["!ref"]||"A1"),m=s["!merges"]||[],x=0,g=Array.isArray(s);if(s["!cols"])for(u=0;u<=h.e.c;++u)c.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var v="",y=s["!rows"]||[];for(l=0;l<h.s.r;++l)v=y[l]?' table:style-name="ro'+y[l].ods+'"':"",c.push("        <table:table-row"+v+`></table:table-row>
`);for(;l<=h.e.r;++l){for(v=y[l]?' table:style-name="ro'+y[l].ods+'"':"",c.push("        <table:table-row"+v+`>
`),u=0;u<h.s.c;++u)c.push(t);for(;u<=h.e.c;++u){var E=!1,w={},T="";for(x=0;x!=m.length;++x)if(!(m[x].s.c>u)&&!(m[x].s.r>l)&&!(m[x].e.c<u)&&!(m[x].e.r<l)){(m[x].s.c!=u||m[x].s.r!=l)&&(E=!0),w["table:number-columns-spanned"]=m[x].e.c-m[x].s.c+1,w["table:number-rows-spanned"]=m[x].e.r-m[x].s.r+1;break}if(E){c.push(r);continue}var k=ze({r:l,c:u}),b=g?(s[l]||[])[u]:s[k];if(b&&b.f&&(w["table:formula"]=xt(MF(b.f)),b.F&&b.F.slice(0,k.length)==k)){var I=en(b.F);w["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,w["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!b){c.push(t);continue}switch(b.t){case"b":T=b.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=b.v?"true":"false";break;case"n":T=b.w||String(b.v||0),w["office:value-type"]="float",w["office:value"]=b.v||0;break;case"s":case"str":T=b.v==null?"":b.v,w["office:value-type"]="string";break;case"d":T=b.w||At(b.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=At(b.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(t);continue}var S=e(T);if(b.l&&b.l.Target){var B=b.l.Target;B=B.charAt(0)=="#"?"#"+DF(B.slice(1)):B,B.charAt(0)!="#"&&!B.match(/^\w+:/)&&(B="../"+B),S=Ce("text:a",S,{"xlink:href":B.replace(/&/g,"&amp;")})}c.push("          "+Ce("table:table-cell",Ce("text:p",S,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var u=0;u<l["!cols"].length;++u)if(l["!cols"][u]){var h=l["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;as(h),h.ods=o;var m=l["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var u=0;u<l["!rows"].length;++u)if(l["!rows"][u]){l["!rows"][u].ods=c;var h=l["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var c=[Wt],l=kl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=kl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+u+`>
`),c.push(j2().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),i(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)c.push(n(a.Sheets[a.SheetNames[h]],a,h));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Zw(e,t){if(t.bookType=="fods")return ig(e,t);var r=Rh(),n="",i=[],s=[];return n="mimetype",Qe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Qe(r,n,ig(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Qe(r,n,pM(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Qe(r,n,Wt+j2()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Qe(r,n,VC(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Qe(r,n,jC(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ws(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function v0(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):yt(ds(e))}function mM(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):on(si(e))}function xM(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ls(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function sg(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function gM(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function vM(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function Pl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function pt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function $t(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ct(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Pl(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Pl(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var l={data:o,type:s};t[i]==null?t[i]=[l]:t[i].push(l)}return t}function pr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(pt(n*8+i.type)),i.type==2&&t.push(pt(i.data.length)),t.push(i.data))})}),ls(t)}function sp(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function yn(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Pl(e,n),s=ct(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:$t(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=ct(o.data),l=$t(c[3][0].data);a.messages.push({meta:c,data:e.slice(n[0],n[0]+l)}),n[0]+=l}),(t=s[3])!=null&&t[0]&&(a.merge=$t(s[3][0].data)>>>0>0),r.push(a)}return r}function ca(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:pt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:pt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:pt(a.data.length)}],n[2].push({data:pr(a.meta),type:2})});var s=pr(n);t.push(pt(s.length)),t.push(s),i.forEach(function(a){return t.push(a)})}),ls(t)}function yM(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Pl(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,l=0;if(s==1?(l=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(l=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[ls(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(i.push(i[0].slice(-c)),l-=c;l>=i[i.length-1].length;)i.push(i[i.length-1]),l-=i[i.length-1].length;i.push(i[0].slice(-c,-c+l))}}var u=ls(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function wn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(yM(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ls(t)}function ua(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=pt(n),a=s.length;t.push(s),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return ls(t)}function wM(e,t,r,n){var i=Ws(e),s=i.getUint32(4,!0),a=(n>1?12:8)+sg(s&(n>1?3470:398))*4,o=-1,c=-1,l=NaN,u=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=sg(s&(n>1?12288:4096))*4,s&16&&(c=i.getUint32(a,!0),a+=4),s&32&&(l=i.getFloat64(a,!0),a+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:t[c]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(c>-1)h={t:"s",v:t[c]};else if(!isNaN(l))h={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function EM(e,t,r){var n=Ws(e),i=n.getUint32(8,!0),s=12,a=-1,o=-1,c=NaN,l=NaN,u=new Date(2001,0,1);i&1&&(c=gM(e,s),s+=16),i&2&&(l=n.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return h}function td(e,t){var r=new Uint8Array(32),n=Ws(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,vM(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function rd(e,t){var r=new Uint8Array(32),n=Ws(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function TM(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return wM(e,t,r,e[0]);case 5:return EM(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Sr(e){var t=ct(e);return Pl(t[1][0].data)}function ag(e,t){var r=ct(t.data),n=$t(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=ct(a.data),c=$t(o[1][0].data)>>>0;switch(n){case 1:s[c]=v0(o[3][0].data);break;case 8:{var l=e[Sr(o[9][0].data)][0],u=ct(l.data),h=e[Sr(u[1][0].data)][0],m=$t(h.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var x=ct(h.data);s[c]=x[3].map(function(g){return v0(g.data)}).join("")}break}}),s}function _M(e,t){var r,n,i,s,a,o,c,l,u,h,m,x,g,v,y=ct(e),E=$t(y[1][0].data)>>>0,w=$t(y[2][0].data)>>>0,T=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&$t(y[8][0].data)>0||!1,k,b;if((s=(i=y[7])==null?void 0:i[0])!=null&&s.data&&t!=0)k=(o=(a=y[7])==null?void 0:a[0])==null?void 0:o.data,b=(l=(c=y[6])==null?void 0:c[0])==null?void 0:l.data;else if((h=(u=y[4])==null?void 0:u[0])!=null&&h.data&&t!=1)k=(x=(m=y[4])==null?void 0:m[0])==null?void 0:x.data,b=(v=(g=y[3])==null?void 0:g[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var I=T?4:1,S=Ws(k),B=[],D=0;D<k.length/2;++D){var H=S.getUint16(D*2,!0);H<65535&&B.push([D,H])}if(B.length!=w)throw"Expected ".concat(w," cells, found ").concat(B.length);var Y=[];for(D=0;D<B.length-1;++D)Y[B[D][0]]=b.subarray(B[D][1]*I,B[D+1][1]*I);return B.length>=1&&(Y[B[B.length-1][0]]=b.subarray(B[B.length-1][1]*I)),{R:E,cells:Y}}function SM(e,t){var r,n=ct(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?$t(n[7][0].data)>>>0>0?1:0:-1,s=sp(n[5],function(a){return _M(a,i)});return{nrows:$t(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(c,l){if(a[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));a[o.R][l]=c}),a},[])}}function kM(e,t,r){var n,i=ct(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=($t(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=($t(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Xe(s);var a=ct(i[4][0].data),o=ag(e,e[Sr(a[4][0].data)][0]),c=(n=a[17])!=null&&n[0]?ag(e,e[Sr(a[17][0].data)][0]):[],l=ct(a[3][0].data),u=0;l[1].forEach(function(h){var m=ct(h.data),x=e[Sr(m[2][0].data)][0],g=$t(x.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var v=SM(e,x);v.data.forEach(function(y,E){y.forEach(function(w,T){var k=ze({r:u+E,c:T}),b=TM(w,o,c);b&&(r[k]=b)})}),u+=v.nrows})}function CM(e,t){var r=ct(t.data),n={"!ref":"A1"},i=e[Sr(r[2][0].data)],s=$t(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return kM(e,i[0],n),n}function NM(e,t){var r,n=ct(t.data),i={name:(r=n[1])!=null&&r[0]?v0(n[1][0].data):"",sheets:[]},s=sp(n[2],Sr);return s.forEach(function(a){e[a].forEach(function(o){var c=$t(o.meta[1][0].data);c==6e3&&i.sheets.push(CM(e,o))})}),i}function AM(e,t){var r=up(),n=ct(t.data),i=sp(n[1],Sr);if(i.forEach(function(s){e[s].forEach(function(a){var o=$t(a.meta[1][0].data);if(o==2){var c=NM(e,a);c.sheets.forEach(function(l,u){fp(r,l,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function nd(e){var t,r,n,i,s={},a=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=wn(c.content)}catch(h){return console.log("?? "+c.content.length+" "+(h.message||h))}var u;try{u=yn(l)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&$t(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(c){s[c].forEach(function(l){var u=$t(l.meta[1][0].data)>>>0;if(u==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return AM(s,o)}function bM(e,t,r){var n,i,s,a;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=e[8])==null?void 0:s[0])==null?void 0:a.data)&&$t(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=Ws(e[7][0].data),u=0,h=[],m=Ws(e[4][0].data),x=0,g=[],v=0;v<t.length;++v){if(t[v]==null){l.setUint16(v*2,65535,!0),m.setUint16(v*2,65535);continue}l.setUint16(v*2,u,!0),m.setUint16(v*2,x,!0);var y,E;switch(typeof t[v]){case"string":y=td({t:"s",v:t[v]},r),E=rd({t:"s",v:t[v]},r);break;case"number":y=td({t:"n",v:t[v]},r),E=rd({t:"n",v:t[v]},r);break;case"boolean":y=td({t:"b",v:t[v]},r),E=rd({t:"b",v:t[v]},r);break;default:throw new Error("Unsupported value "+t[v])}h.push(y),u+=y.length,g.push(E),x+=E.length,++c}for(e[2][0].data=pt(c);v<e[7][0].data.length/2;++v)l.setUint16(v*2,65535,!0),m.setUint16(v*2,65535,!0);return e[6][0].data=ls(h),e[3][0].data=ls(g),c}function IM(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=en(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Xe(n)));var s=Au(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(G){return G.forEach(function(F){typeof F=="string"&&a.push(F)})});var o={},c=[],l=je.read(t.numbers,{type:"base64"});l.FileIndex.map(function(G,F){return[G,l.FullPaths[F]]}).forEach(function(G){var F=G[0],O=G[1];if(F.type==2&&F.name.match(/\.iwa/)){var X=F.content,he=wn(X),ae=yn(he);ae.forEach(function(ve){c.push(ve.id),o[ve.id]={deps:[],location:O,type:$t(ve.messages[0].meta[1][0].data)}})}}),c.sort(function(G,F){return G-F});var u=c.filter(function(G){return G>1}).map(function(G){return[G,pt(G)]});l.FileIndex.map(function(G,F){return[G,l.FullPaths[F]]}).forEach(function(G){var F=G[0];if(G[1],!!F.name.match(/\.iwa/)){var O=yn(wn(F.content));O.forEach(function(X){X.messages.forEach(function(he){u.forEach(function(ae){X.messages.some(function(ve){return $t(ve.meta[1][0].data)!=11006&&xM(ve.data,ae[1])})&&o[ae[0]].deps.push(X.id)})})})}});for(var h=je.find(l,o[1].location),m=yn(wn(h.content)),x,g=0;g<m.length;++g){var v=m[g];v.id==1&&(x=v)}var y=Sr(ct(x.messages[0].data)[1][0].data);for(h=je.find(l,o[y].location),m=yn(wn(h.content)),g=0;g<m.length;++g)v=m[g],v.id==y&&(x=v);for(y=Sr(ct(x.messages[0].data)[2][0].data),h=je.find(l,o[y].location),m=yn(wn(h.content)),g=0;g<m.length;++g)v=m[g],v.id==y&&(x=v);for(y=Sr(ct(x.messages[0].data)[2][0].data),h=je.find(l,o[y].location),m=yn(wn(h.content)),g=0;g<m.length;++g)v=m[g],v.id==y&&(x=v);var E=ct(x.messages[0].data);{E[6][0].data=pt(n.e.r+1),E[7][0].data=pt(n.e.c+1);var w=Sr(E[46][0].data),T=je.find(l,o[w].location),k=yn(wn(T.content));{for(var b=0;b<k.length&&k[b].id!=w;++b);if(k[b].id!=w)throw"Bad ColumnRowUIDMapArchive";var I=ct(k[b].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var S=0;S<=n.e.c;++S){var B=[];B[1]=B[2]=[{type:0,data:pt(S+420690)}],I[1].push({type:2,data:pr(B)}),I[2].push({type:0,data:pt(S)}),I[3].push({type:0,data:pt(S)})}I[4]=[],I[5]=[],I[6]=[];for(var D=0;D<=n.e.r;++D)B=[],B[1]=B[2]=[{type:0,data:pt(D+726270)}],I[4].push({type:2,data:pr(B)}),I[5].push({type:0,data:pt(D)}),I[6].push({type:0,data:pt(D)});k[b].messages[0].data=pr(I)}T.content=ua(ca(k)),T.size=T.content.length,delete E[46];var H=ct(E[4][0].data);{H[7][0].data=pt(n.e.r+1);var Y=ct(H[1][0].data),q=Sr(Y[2][0].data);T=je.find(l,o[q].location),k=yn(wn(T.content));{if(k[0].id!=q)throw"Bad HeaderStorageBucket";var ue=ct(k[0].messages[0].data);for(D=0;D<s.length;++D){var Te=ct(ue[2][0].data);Te[1][0].data=pt(D),Te[4][0].data=pt(s[D].length),ue[2][D]={type:ue[2][0].type,data:pr(Te)}}k[0].messages[0].data=pr(ue)}T.content=ua(ca(k)),T.size=T.content.length;var W=Sr(H[2][0].data);T=je.find(l,o[W].location),k=yn(wn(T.content));{if(k[0].id!=W)throw"Bad HeaderStorageBucket";for(ue=ct(k[0].messages[0].data),S=0;S<=n.e.c;++S)Te=ct(ue[2][0].data),Te[1][0].data=pt(S),Te[4][0].data=pt(n.e.r+1),ue[2][S]={type:ue[2][0].type,data:pr(Te)};k[0].messages[0].data=pr(ue)}T.content=ua(ca(k)),T.size=T.content.length;var te=Sr(H[4][0].data);(function(){for(var G=je.find(l,o[te].location),F=yn(wn(G.content)),O,X=0;X<F.length;++X){var he=F[X];he.id==te&&(O=he)}var ae=ct(O.messages[0].data);{ae[3]=[];var ve=[];a.forEach(function(C,Re){ve[1]=[{type:0,data:pt(Re)}],ve[2]=[{type:0,data:pt(1)}],ve[3]=[{type:2,data:mM(C)}],ae[3].push({type:2,data:pr(ve)})})}O.messages[0].data=pr(ae);var ye=ca(F),Ge=ua(ye);G.content=Ge,G.size=G.content.length})();var ge=ct(H[3][0].data);{var oe=ge[1][0];delete ge[2];var J=ct(oe.data);{var de=Sr(J[2][0].data);(function(){for(var G=je.find(l,o[de].location),F=yn(wn(G.content)),O,X=0;X<F.length;++X){var he=F[X];he.id==de&&(O=he)}var ae=ct(O.messages[0].data);{delete ae[6],delete ge[7];var ve=new Uint8Array(ae[5][0].data);ae[5]=[];for(var ye=0,Ge=0;Ge<=n.e.r;++Ge){var C=ct(ve);ye+=bM(C,s[Ge],a),C[1][0].data=pt(Ge),ae[5].push({data:pr(C),type:2})}ae[1]=[{type:0,data:pt(n.e.c+1)}],ae[2]=[{type:0,data:pt(n.e.r+1)}],ae[3]=[{type:0,data:pt(ye)}],ae[4]=[{type:0,data:pt(n.e.r+1)}]}O.messages[0].data=pr(ae);var Re=ca(F),Ve=ua(Re);G.content=Ve,G.size=G.content.length})()}oe.data=pr(J)}H[3][0].data=pr(ge)}E[4][0].data=pr(H)}x.messages[0].data=pr(E);var Z=ca(m),R=ua(Z);return h.content=R,h.size=h.content.length,l}function eE(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function ap(e){eE([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function op(e){eE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function FM(e){return tt.WS.indexOf(e)>-1?"sheet":e==tt.CS?"chart":e==tt.DS?"dialog":e==tt.MS?"macro":e&&e.length?e:"sheet"}function RM(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,FM(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function PM(e,t,r,n,i,s,a,o,c,l,u,h){try{s[n]=Yo(ln(e,r,!0),t);var m=Kt(e,t),x;switch(o){case"sheet":x=tP(m,t,i,c,s[n],l,u,h);break;case"chart":if(x=rP(m,t,i,c,s[n],l,u,h),!x||!x["!drawel"])break;var g=Do(x["!drawel"].Target,t),v=Nl(g),y=GI(ln(e,g,!0),Yo(ln(e,v,!0),g)),E=Do(y,g),w=Nl(E);x=b3(ln(e,E,!0),E,c,Yo(ln(e,w,!0),E),l,x);break;case"macro":x=nP(m,t,i,c,s[n],l,u,h);break;case"dialog":x=iP(m,t,i,c,s[n],l,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=x;var T=[];s&&s[n]&&jt(s[n]).forEach(function(k){var b="";if(s[n][k].Type==tt.CMNT){b=Do(s[n][k].Target,t);var I=lP(Kt(e,b,!0),b,c);if(!I||!I.length)return;zx(x,I,!1)}s[n][k].Type==tt.TCMNT&&(b=Do(s[n][k].Target,t),T=T.concat(HI(Kt(e,b,!0),c)))}),T&&T.length&&zx(x,T,!0,c.people||[])}catch(k){if(c.WTF)throw k}}function gn(e){return e.charAt(0)=="/"?e.slice(1):e}function MM(e,t){if(no(),t=t||{},ap(t),En(e,"META-INF/manifest.xml")||En(e,"objectdata.xml"))return rg(e,t);if(En(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof nd<"u"){if(e.FileIndex)return nd(e);var r=je.utils.cfb_new();return dx(e).forEach(function(Te){Qe(r,Te,zk(e,Te))}),nd(r)}throw new Error("Unsupported NUMBERS file")}if(!En(e,"[Content_Types].xml"))throw En(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):En(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=dx(e),i=UC(ln(e,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Kt(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Kt(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},l={};if(!t.bookSheets&&!t.bookProps){if(Xo=[],i.sst)try{Xo=oP(Kt(e,gn(i.sst)),i.sst,t)}catch(Te){if(t.WTF)throw Te}t.cellStyles&&i.themes.length&&(c=aP(ln(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(l=sP(Kt(e,gn(i.style)),i.style,c,t))}i.links.map(function(Te){try{var W=Yo(ln(e,Nl(gn(Te))),Te);return uP(Kt(e,gn(Te)),W,Te,t)}catch{}});var u=eP(Kt(e,gn(i.workbooks[0])),i.workbooks[0],t),h={},m="";i.coreprops.length&&(m=Kt(e,gn(i.coreprops[0]),!0),m&&(h=G2(m)),i.extprops.length!==0&&(m=Kt(e,gn(i.extprops[0]),!0),m&&zC(m,h,t)));var x={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(m=ln(e,gn(i.custprops[0]),!0),m&&(x=qC(m,t)));var g={};if((t.bookSheets||t.bookProps)&&(u.Sheets?a=u.Sheets.map(function(W){return W.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),t.bookProps&&(g.Props=h,g.Custprops=x),t.bookSheets&&typeof a<"u"&&(g.SheetNames=a),t.bookSheets?g.SheetNames:t.bookProps))return g;a={};var v={};t.bookDeps&&i.calcchain&&(v=cP(Kt(e,gn(i.calcchain)),i.calcchain));var y=0,E={},w,T;{var k=u.Sheets;h.Worksheets=k.length,h.SheetNames=[];for(var b=0;b!=k.length;++b)h.SheetNames[b]=k[b].name}var I=s?"bin":"xml",S=i.workbooks[0].lastIndexOf("/"),B=(i.workbooks[0].slice(0,S+1)+"_rels/"+i.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");En(e,B)||(B="xl/_rels/workbook."+I+".rels");var D=Yo(ln(e,B,!0),B.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=fP(Kt(e,gn(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=WI(Kt(e,gn(i.people[0])),t)),D&&(D=RM(D,u.Sheets));var H=Kt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=h.Worksheets;++y){var Y="sheet";if(D&&D[y]?(w="xl/"+D[y][1].replace(/[\/]?xl\//,""),En(e,w)||(w=D[y][1]),En(e,w)||(w=B.replace(/_rels\/.*$/,"")+D[y][1]),Y=D[y][2]):(w="xl/worksheets/sheet"+(y+1-H)+"."+I,w=w.replace(/sheet0\./,"sheet.")),T=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(h.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var q=!1,ue=0;ue!=t.sheets.length;++ue)typeof t.sheets[ue]=="number"&&t.sheets[ue]==y&&(q=1),typeof t.sheets[ue]=="string"&&t.sheets[ue].toLowerCase()==h.SheetNames[y].toLowerCase()&&(q=1);if(!q)continue e}}PM(e,w,T,h.SheetNames[y],y,E,a,Y,t,u,c,l)}return g={Directory:i,Workbook:u,Props:h,Custprops:x,Deps:v,Sheets:a,SheetNames:h.SheetNames,Strings:Xo,Styles:l,Themes:c,SSF:bt(He)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(Te,W){Te=Te.replace(/^Root Entry[\/]/,""),g.keys.push(Te),g.files[Te]=e.FileIndex[W]}))),t&&t.bookVBA&&(i.vba.length>0?g.vbaraw=Kt(e,gn(i.vba[0]),!0):i.defaults&&i.defaults.bin===e4&&(g.vbaraw=Kt(e,"xl/vbaProject.bin",!0))),g}function DM(e,t){var r=t||{},n="Workbook",i=je.find(e,n);try{if(n="/!DataSpaces/Version",i=je.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(fb(i.content),n="/!DataSpaces/DataSpaceMap",i=je.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=hb(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=je.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=pb(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=je.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);xb(i.content)}catch{}if(n="/EncryptionInfo",i=je.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=gb(i.content);if(n="/EncryptedPackage",i=je.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function LM(e,t){return t.bookType=="ods"?Zw(e,t):t.bookType=="numbers"?IM(e,t):t.bookType=="xlsb"?OM(e,t):UM(e,t)}function OM(e,t){Ca=1024,e&&!e.SSF&&(e.SSF=bt(He)),e&&e.SSF&&(no(),Yu(e.SSF),t.revssf=Qu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Qo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Nw.indexOf(t.bookType)>-1,i=Wh();op(t=t||{});var s=Rh(),a="",o=0;if(t.cellXfs=[],ps(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Qe(s,a,V2(e.Props,t)),i.coreprops.push(a),mt(t.rels,2,a,tt.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Qe(s,a,W2(e.Props)),i.extprops.push(a),mt(t.rels,3,a,tt.EXT_PROPS),e.Custprops!==e.Props&&jt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Qe(s,a,q2(e.Custprops)),i.custprops.push(a),mt(t.rels,4,a,tt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Qe(s,a,hP(o-1,a,t,e,u)),i.sheets.push(a),mt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,tt.WS[0])}if(h){var x=h["!comments"],g=!1,v="";x&&x.length>0&&(v="xl/comments"+o+"."+r,Qe(s,v,xP(x,v)),i.comments.push(v),mt(u,-1,"../comments"+o+"."+r,tt.CMNT),g=!0),h["!legacy"]&&g&&Qe(s,"xl/drawings/vmlDrawing"+o+".vml",kw(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Qe(s,Nl(a),La(u))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Qe(s,a,mP(t.Strings,a,t)),i.strs.push(a),mt(t.wbrels,-1,"sharedStrings."+r,tt.SST)),a="xl/workbook."+r,Qe(s,a,dP(e,a)),i.workbooks.push(a),mt(t.rels,1,a,tt.WB),a="xl/theme/theme1.xml",Qe(s,a,Qh(e.Themes,t)),i.themes.push(a),mt(t.wbrels,-1,"theme/theme1.xml",tt.THEME),a="xl/styles."+r,Qe(s,a,pP(e,a,t)),i.styles.push(a),mt(t.wbrels,-1,"styles."+r,tt.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Qe(s,a,e.vbaraw),i.vba.push(a),mt(t.wbrels,-1,"vbaProject.bin",tt.VBA)),a="xl/metadata."+r,Qe(s,a,gP(a)),i.metadata.push(a),mt(t.wbrels,-1,"metadata."+r,tt.XLMETA),Qe(s,"[Content_Types].xml",$2(i,t)),Qe(s,"_rels/.rels",La(t.rels)),Qe(s,"xl/_rels/workbook."+r+".rels",La(t.wbrels)),delete t.revssf,delete t.ssf,s}function UM(e,t){Ca=1024,e&&!e.SSF&&(e.SSF=bt(He)),e&&e.SSF&&(no(),Yu(e.SSF),t.revssf=Qu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Qo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Nw.indexOf(t.bookType)>-1,i=Wh();op(t=t||{});var s=Rh(),a="",o=0;if(t.cellXfs=[],ps(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Qe(s,a,V2(e.Props,t)),i.coreprops.push(a),mt(t.rels,2,a,tt.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Qe(s,a,W2(e.Props)),i.extprops.push(a),mt(t.rels,3,a,tt.EXT_PROPS),e.Custprops!==e.Props&&jt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Qe(s,a,q2(e.Custprops)),i.custprops.push(a),mt(t.rels,4,a,tt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],x=(m||{})["!type"]||"sheet";switch(x){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Qe(s,a,Uw(o-1,t,e,h)),i.sheets.push(a),mt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,tt.WS[0])}if(m){var g=m["!comments"],v=!1,y="";if(g&&g.length>0){var E=!1;g.forEach(function(w){w[1].forEach(function(T){T.T==!0&&(E=!0)})}),E&&(y="xl/threadedComments/threadedComment"+o+"."+r,Qe(s,y,zI(g,u,t)),i.threadedcomments.push(y),mt(h,-1,"../threadedComments/threadedComment"+o+"."+r,tt.TCMNT)),y="xl/comments"+o+"."+r,Qe(s,y,Cw(g)),i.comments.push(y),mt(h,-1,"../comments"+o+"."+r,tt.CMNT),v=!0}m["!legacy"]&&v&&Qe(s,"xl/drawings/vmlDrawing"+o+".vml",kw(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}h["!id"].rId1&&Qe(s,Nl(a),La(h))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Qe(s,a,hw(t.Strings,t)),i.strs.push(a),mt(t.wbrels,-1,"sharedStrings."+r,tt.SST)),a="xl/workbook."+r,Qe(s,a,Vw(e)),i.workbooks.push(a),mt(t.rels,1,a,tt.WB),a="xl/theme/theme1.xml",Qe(s,a,Qh(e.Themes,t)),i.themes.push(a),mt(t.wbrels,-1,"theme/theme1.xml",tt.THEME),a="xl/styles."+r,Qe(s,a,Ew(e,t)),i.styles.push(a),mt(t.wbrels,-1,"styles."+r,tt.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Qe(s,a,e.vbaraw),i.vba.push(a),mt(t.wbrels,-1,"vbaProject.bin",tt.VBA)),a="xl/metadata."+r,Qe(s,a,Sw()),i.metadata.push(a),mt(t.wbrels,-1,"metadata."+r,tt.XLMETA),u.length>1&&(a="xl/persons/person.xml",Qe(s,a,qI(u)),i.people.push(a),mt(t.wbrels,-1,"persons/person.xml",tt.PEOPLE)),Qe(s,"[Content_Types].xml",$2(i,t)),Qe(s,"_rels/.rels",La(t.rels)),Qe(s,"xl/_rels/workbook."+r+".rels",La(t.wbrels)),delete t.revssf,delete t.ssf,s}function lp(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=dn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function BM(e,t){return je.find(e,"EncryptedPackage")?DM(e,t):qw(e,t)}function $M(e,t){var r,n=e,i=t||{};return i.type||(i.type=et&&Buffer.isBuffer(e)?"buffer":"base64"),r=m2(n,i),MM(r,i)}function tE(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return x0(e.slice(r),t);default:break e}return Ya.to_workbook(e,t)}function jM(e,t){var r="",n=lp(e,t);switch(t.type){case"base64":r=dn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Gs(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=yt(r)),t.type="binary",tE(r,t)}function GM(e,t){var r=e;return t.type=="base64"&&(r=dn(r)),r=El.utils.decode(1200,r.slice(2),"str"),t.type="binary",tE(r,t)}function VM(e){return e.match(/[^\x00-\x7F]/)?si(e):e}function id(e,t,r,n){return n?(r.type="string",Ya.to_workbook(e,r)):Ya.to_workbook(t,r)}function Nu(e,t){Nh();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Nu(new Uint8Array(e),(r=bt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ua={},r.dateNF&&(Ua.dateNF=r.dateNF),r.type||(r.type=et&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=et?"buffer":"binary",n=Ok(e),typeof Uint8Array<"u"&&!et&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=VM(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=bt(r),r.type="array",Nu(Ah(n),r)}switch((i=lp(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return BM(je.read(n,r),r);break;case 9:if(i[1]<=8)return qw(n,r);break;case 60:return x0(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return JA(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return fw.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?$M(n,r):id(e,n,r,s);case 239:return i[3]===60?x0(n,r):id(e,n,r,s);case 255:if(i[1]===254)return GM(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Ms.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Ms.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return m0.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return vw.to_workbook(n,r);break;case 10:case 13:case 32:return jM(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return qA.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?m0.to_workbook(n,r):id(e,n,r,s)}function rE(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return jl(t.file,je.write(e,{type:et?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return je.write(e,t)}function HM(e,t){var r=bt(t||{}),n=LM(e,r);return zM(n,r)}function zM(e,t){var r={},n=et?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?je.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Ku(i))}return t.password&&typeof encrypt_agile<"u"?rE(encrypt_agile(i,t.password),t):t.type==="file"?jl(t.file,i):t.type=="string"?yt(i):i}function WM(e,t){var r=t||{},n=VP(e,r);return rE(n,r)}function ti(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Tl(si(n));case"binary":return si(n);case"string":return e;case"file":return jl(t.file,n,"utf8");case"buffer":return et?Ai(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ti(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function qM(e,t){switch(t.type){case"base64":return Tl(e);case"binary":return e;case"string":return e;case"file":return jl(t.file,e,"binary");case"buffer":return et?Ai(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Nc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Tl(r):t.type=="string"?yt(r):r;case"file":return jl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function nE(e,t){Nh(),B3(e);var r=bt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=nE(e,r);return r.type="array",Ku(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ti(LP(e,r),r);case"slk":case"sylk":return ti(uw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return ti(Kw(e.Sheets[e.SheetNames[i]],r),r);case"txt":return qM(sE(e.Sheets[e.SheetNames[i]],r),r);case"csv":return ti(cp(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return ti(fw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Nc(m0.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return ti(Ya.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return ti(vw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return ti(dw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return ti(Zw(e,r),r);case"wk1":return Nc(Ms.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Nc(Ms.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Nc(Jw(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),WM(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return HM(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function JM(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function iE(e,t,r){var n={};return n.type="file",n.file=t,JM(n),nE(e,n)}function KM(e,t,r,n,i,s,a,o){var c=zt(r),l=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!a||e[r])for(var x=t.s.c;x<=t.e.c;++x){var g=a?e[r][x]:e[n[x]+c];if(g===void 0||g.t===void 0){if(l===void 0)continue;s[x]!=null&&(m[s[x]]=l);continue}var v=g.v;switch(g.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[x]!=null){if(v==null)if(g.t=="e"&&v===null)m[s[x]]=null;else if(l!==void 0)m[s[x]]=l;else if(u&&v===null)m[s[x]]=null;else continue;else m[s[x]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?v:ki(g,v,o);v!=null&&(h=!1)}}return{row:m,isempty:h}}function Au(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},u=l.range!=null?l.range:e["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof u){case"string":c=ot(u);break;case"number":c=ot(e["!ref"]),c.s.r=u;break;default:c=u}n>0&&(i=0);var h=zt(c.s.r),m=[],x=[],g=0,v=0,y=Array.isArray(e),E=c.s.r,w=0,T={};y&&!e[E]&&(e[E]=[]);var k=l.skipHidden&&e["!cols"]||[],b=l.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(k[w]||{}).hidden)switch(m[w]=Mt(w),r=y?e[E][w]:e[m[w]+h],n){case 1:s[w]=w-c.s.c;break;case 2:s[w]=m[w];break;case 3:s[w]=l.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=ki(r,null,l),v=T[a]||0,!v)T[a]=1;else{do o=a+"_"+v++;while(T[o]);T[a]=v,T[o]=1}s[w]=o}for(E=c.s.r+i;E<=c.e.r;++E)if(!(b[E]||{}).hidden){var I=KM(e,c,E,m,n,s,y,l);(I.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(x[g++]=I.row)}return x.length=g,x}var og=/"/g;function YM(e,t,r,n,i,s,a,o){for(var c=!0,l=[],u="",h=zt(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var x=o.dense?(e[r]||[])[m]:e[n[m]+h];if(x==null)u="";else if(x.v!=null){c=!1,u=""+(o.rawNumbers&&x.t=="n"?x.v:ki(x,null,o));for(var g=0,v=0;g!==u.length;++g)if((v=u.charCodeAt(g))===i||v===s||v===34||o.forceQuotes){u='"'+u.replace(og,'""')+'"';break}u=="ID"&&(u='"ID"')}else x.f!=null&&!x.F?(c=!1,u="="+x.f,u.indexOf(",")>=0&&(u='"'+u.replace(og,'""')+'"')):u="";l.push(u)}return o.blankrows===!1&&c?null:l.join(a)}function cp(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=ot(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(m[g]||{}).hidden||(h[g]=Mt(g));for(var v=0,y=i.s.r;y<=i.e.r;++y)(x[y]||{}).hidden||(u=YM(e,i,y,h,a,c,s,n),u!=null&&(n.strip&&(u=u.replace(l,"")),(u||n.blankrows!==!1)&&r.push((v++?o:"")+u)));return delete n.dense,r.join("")}function sE(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=cp(e,t);return r}function XM(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=ot(e["!ref"]),s="",a=[],o,c=[],l=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=Mt(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=zt(u),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=l?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function aE(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Dt(n.origin):n.origin;a=c.r,o=c.c}var l,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var h=ot(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(a=h.e.r+1,u.e.r=a+t.length-1+i)}else a==-1&&(a=0,u.e.r=t.length-1+i);var m=n.header||[],x=0;t.forEach(function(v,y){jt(v).forEach(function(E){(x=m.indexOf(E))==-1&&(m[x=m.length]=E);var w=v[E],T="z",k="",b=ze({c:o+x,r:a+y+i});l=Ml(s,b),w&&typeof w=="object"&&!(w instanceof Date)?s[b]=w:(typeof w=="number"?T="n":typeof w=="boolean"?T="b":typeof w=="string"?T="s":w instanceof Date?(T="d",n.cellDates||(T="n",w=ir(w)),k=n.dateNF||He[14]):w===null&&n.nullError&&(T="e",w=0),l?(l.t=T,l.v=w,delete l.w,delete l.R,k&&(l.z=k)):s[b]=l={t:T,v:w},k&&(l.z=k))})}),u.e.c=Math.max(u.e.c,o+m.length-1);var g=zt(a);if(i)for(x=0;x<m.length;++x)s[Mt(x+o)+g]={t:"s",v:m[x]};return s["!ref"]=Xe(u),s}function QM(e,t){return aE(null,e,t)}function Ml(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Dt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Ml(e,ze(t)):Ml(e,ze({r:t,c:r||0}))}function ZM(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function up(){return{SheetNames:[],Sheets:{}}}function fp(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(Gw(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function e5(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=ZM(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function t5(e,t){return e.z=t,e}function oE(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function r5(e,t,r){return oE(e,"#"+t,r)}function n5(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function i5(e,t,r,n){for(var i=typeof t!="string"?t:ot(t),s=typeof t=="string"?t:Xe(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var c=Ml(e,a,o);c.t="n",c.F=s,delete c.v,a==i.s.r&&o==i.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Wr={encode_col:Mt,encode_row:zt,encode_cell:ze,encode_range:Xe,decode_col:$h,decode_row:Bh,split_cell:mC,decode_cell:Dt,decode_range:en,format_cell:ki,sheet_add_aoa:P2,sheet_add_json:aE,sheet_add_dom:Yw,aoa_to_sheet:io,json_to_sheet:QM,table_to_sheet:Xw,table_to_book:fM,sheet_to_csv:cp,sheet_to_txt:sE,sheet_to_json:Au,sheet_to_html:Kw,sheet_to_formulae:XM,sheet_to_row_object_array:Au,sheet_get_cell:Ml,book_new:up,book_append_sheet:fp,book_set_sheet_visibility:e5,cell_set_number_format:t5,cell_set_hyperlink:oE,cell_set_internal_link:r5,cell_add_comment:n5,sheet_set_array_formula:i5,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const s5=(e,t)=>{const r=JSON.stringify(e);return`<!DOCTYPE html>
<html lang="${t}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${e.name} - NOZESia Key</title>
  <script src="https://cdn.tailwindcss.com"><\/script>
  <style>
    .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
  </style>
</head>
<body class="bg-slate-100 font-sans">
  <div id="app"></div>
  <script>
    const project = ${r};
    const lang = "${t}";
    const t = {
      en: {
        features: "Features", selected: "selected", matches: "Matches", discarded: "Discarded",
        restart: "Restart", noMatches: "No matches found.", tryUnselecting: "Try unselecting some features.",
        potential: "potential matches", identified: "1 Entity identified", close: "Close",
        speciesDetails: "Species Details", morphology: "Morphology & Traits", resources: "Resources",
        createdWith: "Created with NOZESia", viewResults: "View Results", excluded: "Excluded by selection",
        scientificName: "Scientific Name", family: "Family", taxonomy: "Taxonomy"
      },
      pt: {
        features: "Caractersticas", selected: "selecionado(s)", matches: "Compatveis", discarded: "Descartados",
        restart: "Reiniciar", noMatches: "Nenhum resultado.", tryUnselecting: "Tente remover selees.",
        potential: "matches potenciais", identified: "1 Entidade identificada", close: "Fechar",
        speciesDetails: "Detalhes da Espcie", morphology: "Morfologia & Caractersticas", resources: "Recursos Adicionais",
        createdWith: "Criado com NOZESia", viewResults: "Ver Resultados", excluded: "Excludo pela seleo",
        scientificName: "Nome Cientfico", family: "Famlia", taxonomy: "Taxonomia"
      }
    };
    const strings = t[lang];
    
    let selections = {};
    let showDiscarded = false;
    let viewingEntity = null;
    let viewingStateImage = null;
    let mobileTab = 'FILTERS';
    let hideEmptyFeatures = true;
    
    function toggleSelection(featureId, stateId) {
      if (!selections[featureId]) selections[featureId] = [];
      const idx = selections[featureId].indexOf(stateId);
      if (idx >= 0) {
        selections[featureId].splice(idx, 1);
        if (selections[featureId].length === 0) delete selections[featureId];
      } else {
        selections[featureId].push(stateId);
      }
      render();
    }
    
    function resetKey() { selections = {}; render(); }
    function setMobileTab(tab) { mobileTab = tab; render(); }
    function toggleDiscarded() { showDiscarded = !showDiscarded; render(); }
    function toggleHideEmpty() { hideEmptyFeatures = !hideEmptyFeatures; render(); }
    function viewEntity(entity) { viewingEntity = entity; render(); }
    function closeEntity() { viewingEntity = null; render(); }
    function viewStateImage(url, label, featureName) { viewingStateImage = {url, label, featureName}; render(); }
    function closeStateImage() { viewingStateImage = null; render(); }
    
    function getFilteredEntities() {
      const remaining = [], discarded = [];
      project.entities.forEach(entity => {
        let isMatch = true;
        for (const [fid, sids] of Object.entries(selections)) {
          const entityStates = entity.traits[fid] || [];
          if (!sids.some(id => entityStates.includes(id))) { isMatch = false; break; }
        }
        if (isMatch) remaining.push(entity); else discarded.push(entity);
      });
      return { remaining, discarded };
    }
    
    function getTotalSelections() {
      return Object.values(selections).reduce((a, c) => a + c.length, 0);
    }

    function hasRemainingEntitiesForFeature(featureId, remainingEntities) {
      return remainingEntities.some(entity => {
        const entityStates = entity.traits[featureId] || [];
        return entityStates.length > 0;
      });
    }
    
    function render() {
      const { remaining, discarded } = getFilteredEntities();
      const totalSel = getTotalSelections();
      
      let entityModalHTML = '';
      if (viewingEntity) {
        const e = viewingEntity;
        const traitsHTML = project.features.map(f => {
          const stateIds = e.traits[f.id] || [];
          const stateLabels = stateIds.map(sid => f.states.find(s => s.id === sid)?.label).filter(Boolean).join(', ');
          return stateLabels ? \`<div class="flex justify-between py-2 border-b border-slate-100"><span class="text-slate-500">\${f.name}</span><span class="font-medium text-slate-800">\${stateLabels}</span></div>\` : '';
        }).join('');
        const linksHTML = e.links && e.links.length > 0 ? \`<div class="mt-6"><h4 class="font-semibold text-slate-700 mb-3">\${strings.resources}</h4><div class="space-y-2">\${e.links.map(l => \`<a href="\${l.url}" target="_blank" class="flex items-center gap-2 text-emerald-600 hover:underline text-sm"><span></span>\${l.label}</a>\`).join('')}</div></div>\` : '';
        const taxonomyHTML = (e.scientificName || e.family) ? \`
          <div class="mt-4 p-3 bg-emerald-50 rounded-lg border border-emerald-100">
            <h4 class="font-semibold text-emerald-800 mb-2 text-sm flex items-center gap-1"> \${strings.taxonomy}</h4>
            \${e.scientificName ? \`<div class="flex justify-between py-1"><span class="text-emerald-600 text-sm">\${strings.scientificName}</span><span class="font-medium text-emerald-800 italic">\${e.scientificName}</span></div>\` : ''}
            \${e.family ? \`<div class="flex justify-between py-1"><span class="text-emerald-600 text-sm">\${strings.family}</span><span class="font-medium text-emerald-800">\${e.family}</span></div>\` : ''}
          </div>
        \` : '';
        entityModalHTML = \`
          <div class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4" onclick="if(event.target===this)closeEntity()">
            <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col">
              <div class="relative h-48 sm:h-64 bg-slate-200 shrink-0">
                \${e.imageUrl ? \`<img src="\${e.imageUrl}" class="w-full h-full object-cover" onerror="this.style.display='none'">\` : '<div class="w-full h-full flex items-center justify-center text-slate-400 text-6xl"></div>'}
                <button onclick="closeEntity()" class="absolute top-3 right-3 bg-black/40 hover:bg-black/60 text-white rounded-full p-2"></button>
              </div>
              <div class="p-6 overflow-y-auto custom-scrollbar">
                <h2 class="text-2xl font-bold text-slate-800 mb-1">\${e.name}</h2>
                \${e.scientificName && e.scientificName !== e.name ? \`<p class="text-slate-500 italic mb-2">\${e.scientificName}</p>\` : ''}
                \${e.family ? \`<span class="inline-block bg-emerald-100 text-emerald-700 text-xs px-2 py-1 rounded-full mb-3">\${e.family}</span>\` : ''}
                \${e.description ? \`<p class="text-slate-600 mb-4">\${e.description}</p>\` : ''}
                \${taxonomyHTML}
                <div class="mt-4"><h4 class="font-semibold text-slate-700 mb-2">\${strings.morphology}</h4><div class="text-sm">\${traitsHTML}</div></div>
                \${linksHTML}
              </div>
            </div>
          </div>
        \`;
      }
      
      // State Image Modal
      let stateImageModalHTML = '';
      if (viewingStateImage) {
        stateImageModalHTML = \`
          <div class="fixed inset-0 bg-black/80 z-[60] flex items-center justify-center p-4" onclick="if(event.target===this)closeStateImage()">
            <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full overflow-hidden" onclick="event.stopPropagation()">
              <div class="relative">
                <img src="\${viewingStateImage.url}" alt="\${viewingStateImage.label}" class="w-full max-h-[60vh] object-contain bg-slate-100">
                <button onclick="closeStateImage()" class="absolute top-3 right-3 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full transition-colors"></button>
              </div>
              <div class="p-4 bg-white">
                <h4 class="font-semibold text-slate-800">\${viewingStateImage.label}</h4>
                <p class="text-sm text-slate-500">\${viewingStateImage.featureName}</p>
              </div>
            </div>
          </div>
        \`;
      }
      
      // Filter features and states based on hideEmptyFeatures
      const featuresHTML = project.features
        .map(f => {
          // Get all state IDs that are present in remaining entities
          const usedStateIds = new Set();
          if (hideEmptyFeatures) {
            remaining.forEach(entity => {
              const entityStates = entity.traits[f.id] || [];
              entityStates.forEach(stateId => usedStateIds.add(stateId));
            });

            // If no states are used, skip this feature
            if (usedStateIds.size === 0) return '';
          }

          // Filter states to only show those that are used (when hideEmptyFeatures is true)
          const visibleStates = hideEmptyFeatures
            ? f.states.filter(s => usedStateIds.has(s.id))
            : f.states;

          const selStates = selections[f.id] || [];
          return \`
            <div class="bg-slate-50 rounded-xl p-4">
              <h4 class="font-semibold text-slate-700 mb-3 flex items-center gap-2">
                \${f.imageUrl ? \`<img src="\${f.imageUrl}" class="w-6 h-6 rounded object-cover">\` : ''}
                \${f.name}
                \${selStates.length > 0 ? \`<span class="ml-auto text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full">\${selStates.length}</span>\` : ''}
              </h4>
              <div class="flex flex-wrap gap-2">
                \${visibleStates.map(s => {
                  const isSel = selStates.includes(s.id);
                  const hasImg = s.imageUrl ? true : false;
                  return \`<div class="flex items-center gap-1">
                    \${hasImg ? \`<button onclick="viewStateImage('\${s.imageUrl}', '\${s.label.replace(/'/g, "\\\\'")}', '\${f.name.replace(/'/g, "\\\\'")}')" class="w-6 h-6 rounded overflow-hidden border border-slate-200 hover:border-emerald-400 transition-colors shrink-0" title="Ver imagem"><img src="\${s.imageUrl}" class="w-full h-full object-cover"></button>\` : ''}
                    <button onclick="toggleSelection('\${f.id}','\${s.id}')" class="px-3 py-1.5 rounded-lg text-sm font-medium transition-all \${isSel ? 'bg-emerald-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-100 border border-slate-200'}">\${s.label}</button>
                  </div>\`;
                }).join('')}
              </div>
            </div>
          \`;
        })
        .filter(html => html !== '')
        .join('');
      
      const entityCard = (e, isDiscarded = false) => \`
        <div onclick="viewEntity(project.entities.find(x=>x.id==='\${e.id}'))" class="bg-white rounded-xl shadow-sm hover:shadow-lg transition-all cursor-pointer overflow-hidden border \${isDiscarded ? 'border-red-200 opacity-60' : 'border-slate-200 hover:border-emerald-300'}">
          <div class="h-32 bg-slate-100 relative">
            \${e.imageUrl ? \`<img src="\${e.imageUrl}" class="w-full h-full object-cover" onerror="this.parentElement.innerHTML='<div class=\\\\'w-full h-full flex items-center justify-center text-slate-300 text-4xl\\\\'></div>'">\` : '<div class="w-full h-full flex items-center justify-center text-slate-300 text-4xl"></div>'}
            \${isDiscarded ? '<div class="absolute inset-0 bg-red-500/20 flex items-center justify-center"><span class="bg-red-500 text-white text-xs px-2 py-1 rounded"></span></div>' : ''}
            \${e.family ? \`<span class="absolute top-2 left-2 bg-emerald-600/90 text-white text-[10px] px-1.5 py-0.5 rounded">\${e.family}</span>\` : ''}
          </div>
          <div class="p-3">
            <h4 class="font-semibold text-slate-800 text-sm truncate">\${e.name}</h4>
            \${e.scientificName && e.scientificName !== e.name ? \`<p class="text-xs text-slate-400 italic truncate">\${e.scientificName}</p>\` : ''}
            \${e.description ? \`<p class="text-xs text-slate-500 mt-1 line-clamp-2">\${e.description}</p>\` : ''}
          </div>
        </div>
      \`;
      
      const remainingHTML = remaining.length > 0 
        ? remaining.map(e => entityCard(e)).join('')
        : \`<div class="col-span-full text-center py-12 text-slate-500"><div class="text-4xl mb-3"></div><p class="font-medium">\${strings.noMatches}</p><p class="text-sm">\${strings.tryUnselecting}</p></div>\`;
      
      const discardedHTML = discarded.length > 0 && showDiscarded
        ? \`<div class="mt-6 pt-6 border-t"><h4 class="font-semibold text-slate-500 mb-4 flex items-center gap-2"> \${strings.discarded} (\${discarded.length})</h4><div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">\${discarded.map(e => entityCard(e, true)).join('')}</div></div>\`
        : '';
      
      document.getElementById('app').innerHTML = \`
        <div class="min-h-screen flex flex-col">
          <header class="bg-white border-b px-4 py-3 flex justify-between items-center shadow-sm">
            <div class="flex items-center gap-3">
              <span class="bg-emerald-600 text-white text-xs px-2 py-1 rounded font-bold">KEY</span>
              <h1 class="text-lg font-bold text-slate-800 truncate">\${project.name}</h1>
            </div>
            <button onclick="resetKey()" class="flex items-center gap-2 px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg"> \${strings.restart}</button>
          </header>
          
          <div class="md:hidden flex border-b bg-white">
            <button onclick="setMobileTab('FILTERS')" class="flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 \${mobileTab==='FILTERS'?'text-emerald-600 border-b-2 border-emerald-600':'text-slate-500 bg-slate-50'}">
               \${strings.features} \${totalSel>0?\`<span class="bg-emerald-600 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center">\${totalSel}</span>\`:''}
            </button>
            <button onclick="setMobileTab('RESULTS')" class="flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 \${mobileTab==='RESULTS'?'text-emerald-600 border-b-2 border-emerald-600':'text-slate-500 bg-slate-50'}">
               \${strings.matches} <span class="bg-slate-200 text-slate-700 text-xs px-1.5 py-0.5 rounded-full">\${remaining.length}</span>
            </button>
          </div>
          
          <div class="flex-1 flex flex-col md:flex-row overflow-hidden">
            <div class="w-full md:w-1/3 lg:w-1/4 bg-white md:border-r flex-col h-full \${mobileTab==='FILTERS'?'flex':'hidden md:flex'}">
              <div class="hidden md:block p-4 border-b bg-slate-50">
                <div class="flex items-center justify-between">
                  <h3 class="font-semibold text-slate-700 flex items-center gap-2"> \${strings.features}</h3>
                  <button onclick="toggleHideEmpty()" class="flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-lg transition-all \${hideEmptyFeatures ? 'bg-emerald-100 text-emerald-700' : 'text-slate-600 bg-slate-100 hover:bg-slate-200'}" title="\${hideEmptyFeatures ? 'Mostrar todas' : 'Ocultar vazias'}">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="\${hideEmptyFeatures ? 'M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z' : 'M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21'}"></path></svg>
                  </button>
                </div>
              </div>
              <div class="flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar">\${featuresHTML}</div>
            </div>
            
            <div class="flex-1 flex flex-col h-full \${mobileTab==='RESULTS'?'flex':'hidden md:flex'}">
              <div class="p-4 border-b bg-slate-50 flex justify-between items-center">
                <div>
                  <span class="font-semibold text-slate-700">\${remaining.length === 1 ? strings.identified : remaining.length + ' ' + strings.potential}</span>
                </div>
                \${discarded.length > 0 ? \`<button onclick="toggleDiscarded()" class="text-sm text-slate-500 hover:text-slate-700 flex items-center gap-1">\${showDiscarded?'':''} \${strings.discarded} (\${discarded.length})</button>\` : ''}
              </div>
              <div class="flex-1 overflow-y-auto p-4 custom-scrollbar">
                <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">\${remainingHTML}</div>
                \${discardedHTML}
              </div>
            </div>
          </div>
          
          <footer class="bg-white border-t px-4 py-2 text-center text-xs text-slate-400">
            \${strings.createdWith}  <a href="https://djhandoom.github.io/nozes/" target="_blank" class="text-emerald-600 hover:underline">djhandoom.github.io/nozes</a>
          </footer>
        </div>
        \${entityModalHTML}
        \${stateImageModalHTML}
      \`;
    }
    
    render();
  <\/script>
</body>
</html>`},a5={en:{player:"PLAYER",restart:"Restart",exit:"Exit",features:"Features",selected:"selected",matches:"Matches",discarded:"Discarded",identified:"1 Entity identified",potential:"potential matches",excluded:"Excluded by selection",noMatches:"No matches found.",tryUnselecting:"Try unselecting some features.",speciesDetails:"Species Details",morphology:"Morphology & Traits",close:"Close",resources:"Resources",viewResults:"View Results",openSaved:"Open",editKey:"Edit",exportJson:"JSON",exportXlsx:"XLSX",exportHtml:"HTML"},pt:{player:"PLAYER",restart:"Reiniciar",exit:"Sair",features:"Caractersticas",selected:"selecionado(s)",matches:"Compatveis",discarded:"Descartados",identified:"1 Entidade identificada",potential:"matches potenciais",excluded:"Excludo pela seleo",noMatches:"Nenhum resultado.",tryUnselecting:"Tente remover selees.",speciesDetails:"Detalhes da Espcie",morphology:"Morfologia & Caractersticas",close:"Fechar",resources:"Recursos Adicionais",viewResults:"Ver Resultados",openSaved:"Abrir",editKey:"Editar",exportJson:"JSON",exportXlsx:"XLSX",exportHtml:"HTML"}},o5=({project:e,onBack:t,language:r,onOpenSaved:n,onEditKey:i})=>{const s=a5[r],[a,o]=ke.useState({}),[c,l]=ke.useState(!1),[u,h]=ke.useState(null),[m,x]=ke.useState(null),[g,v]=ke.useState(null),[y,E]=ke.useState("FILTERS"),[w,T]=ke.useState(!0),[k,b]=ke.useState(e);ke.useEffect(()=>{b(e),o({}),S(!1)},[e]);const[I,S]=ke.useState(!1),[B,D]=ke.useState({}),H=Z=>{if(B[Z.id]){b(B[Z.id]),o({});return}const R=localStorage.getItem("nozesia_projects");if(R)try{const F=JSON.parse(R).find(O=>O.id===Z.projectId);F&&(D(O=>({...O,[Z.id]:F})),b(F),o({}))}catch(G){console.error("Failed to load sub-key:",G)}},Y=()=>{b(e),o({})},q=(Z,R)=>{o(G=>{const F=G[Z]||[],O=F.includes(R);let X;if(O?X=F.filter(he=>he!==R):X=[...F,R],X.length===0){const{[Z]:he,...ae}=G;return ae}return{...G,[Z]:X}})},ue=()=>o({}),{remaining:Te,discarded:W}=ke.useMemo(()=>{const Z=[],R=[];return k.entities.forEach(G=>{let F=!0;for(const[O,X]of Object.entries(a)){const he=G.traits[O]||[];if(!X.some(ve=>he.includes(ve))){F=!1;break}}F?Z.push(G):R.push(G)}),{remaining:Z,discarded:R}},[k.entities,a]),te=Object.values(a).reduce((Z,R)=>Z+R.length,0),ge=ke.useMemo(()=>w?k.features.map(Z=>{const R=new Set;return Te.forEach(G=>{(G.traits[Z.id]||[]).forEach(O=>R.add(O))}),R.size===0?null:{...Z,states:Z.states.filter(G=>R.has(G.id))}}).filter(Z=>Z!==null):k.features,[k.features,w,Te]),oe=()=>{const Z=JSON.stringify(e,null,2),R=new Blob([Z],{type:"application/json"}),G=URL.createObjectURL(R),F=document.createElement("a");F.href=G,F.download=`${e.name.replace(/\s+/g,"_")}.json`,F.click(),URL.revokeObjectURL(G)},J=()=>{new Map(e.features.map(X=>[X.id,X]));const Z=["Entity",...e.features.map(X=>X.name)],R=e.entities.map(X=>{const he=[X.name];return e.features.forEach(ae=>{const ye=(X.traits[ae.id]||[]).map(Ge=>{var C;return((C=ae.states.find(Re=>Re.id===Ge))==null?void 0:C.label)||""}).filter(Boolean).join(", ");he.push(ye)}),he}),G=[Z,...R],F=Wr.aoa_to_sheet(G),O=Wr.book_new();Wr.book_append_sheet(O,F,"Matrix"),iE(O,`${e.name.replace(/\s+/g,"_")}.xlsx`)},de=()=>{const Z=s5(e,r),R=new Blob([Z],{type:"text/html;charset=utf-8"}),G=URL.createObjectURL(R),F=document.createElement("a");F.href=G,F.download=`${e.name.replace(/\s+/g,"_")}.html`,F.click(),URL.revokeObjectURL(G)};return f.jsxs("div",{className:"flex flex-col h-full bg-slate-100 font-sans absolute inset-0",children:[f.jsxs("header",{className:"bg-white border-b px-4 py-3 flex justify-between items-center shadow-sm z-30 shrink-0",children:[f.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[f.jsx("button",{onClick:t,className:"md:hidden p-2 -ml-2 text-slate-500 hover:bg-slate-100 rounded-full",children:f.jsx(Uf,{size:20})}),f.jsxs("div",{className:"overflow-hidden",children:[f.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2 truncate",children:[f.jsx("span",{className:"hidden sm:inline-block bg-emerald-600 text-white text-xs px-2 py-1 rounded",children:s.player}),f.jsx("span",{className:"truncate",children:k.name})]}),k.isSubKey&&f.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500 mt-1",children:[f.jsx("button",{onClick:Y,className:"hover:text-emerald-600 transition-colors",children:e.name}),f.jsx("span",{children:""}),f.jsx("span",{className:"text-emerald-600",children:k.name})]})]})]}),f.jsxs("div",{className:"flex gap-1 sm:gap-2 shrink-0",children:[e.subKeys&&e.subKeys.length>0&&!k.isSubKey&&f.jsxs("div",{className:"relative",children:[f.jsxs("button",{onClick:()=>S(!I),className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-white bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 rounded-lg transition-all",title:r==="pt"?"Sub-chaves":"Sub-keys",children:[f.jsx(Sh,{size:18}),f.jsx("span",{className:"hidden lg:inline",children:r==="pt"?"Sub-chaves":"Sub-keys"}),f.jsx(du,{size:14})]}),I&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>S(!1)}),f.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-xl border border-slate-200 z-40 max-h-96 overflow-y-auto",children:f.jsx("div",{className:"p-2",children:e.subKeys.map(Z=>f.jsxs("button",{onClick:()=>{H(Z),S(!1)},className:"w-full text-left p-3 hover:bg-emerald-50 rounded-lg transition-colors group",children:[f.jsx("div",{className:"font-medium text-slate-800 group-hover:text-emerald-700 text-sm",children:Z.name}),f.jsx("div",{className:"text-xs text-slate-500 mt-1 line-clamp-2",children:Z.description})]},Z.id))})})]})]}),k.isSubKey&&f.jsxs("button",{onClick:Y,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-white bg-gradient-to-r from-slate-700 to-slate-600 hover:from-slate-600 hover:to-slate-500 rounded-lg transition-all",title:r==="pt"?"Voltar  chave principal":"Return to main key",children:[f.jsx(Uf,{size:18}),f.jsx("span",{className:"hidden lg:inline",children:r==="pt"?"Chave Principal":"Main Key"})]}),n&&f.jsxs("button",{onClick:n,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",title:s.openSaved,children:[f.jsx(Ma,{size:18})," ",f.jsx("span",{className:"hidden lg:inline",children:s.openSaved})]}),i&&f.jsxs("button",{onClick:i,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",title:s.editKey,children:[f.jsx(tk,{size:18})," ",f.jsx("span",{className:"hidden lg:inline",children:s.editKey})]}),f.jsxs("button",{onClick:oe,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",title:s.exportJson,children:[f.jsx(r0,{size:18})," ",f.jsx("span",{className:"hidden lg:inline",children:s.exportJson})]}),f.jsxs("button",{onClick:J,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",title:s.exportXlsx,children:[f.jsx(n0,{size:18})," ",f.jsx("span",{className:"hidden lg:inline",children:s.exportXlsx})]}),f.jsxs("button",{onClick:de,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-purple-600 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",title:s.exportHtml,children:[f.jsx(Wo,{size:18})," ",f.jsx("span",{className:"hidden lg:inline",children:s.exportHtml})]}),f.jsxs("button",{onClick:ue,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",title:s.restart,children:[f.jsx(ZS,{size:18})," ",f.jsx("span",{className:"hidden lg:inline",children:s.restart})]}),f.jsxs("button",{onClick:t,className:"hidden md:flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-600 hover:text-slate-900 transition-colors",children:[f.jsx(Uf,{size:16})," ",s.exit]})]})]}),f.jsxs("div",{className:"md:hidden flex border-b bg-white z-20 shrink-0",children:[f.jsxs("button",{onClick:()=>E("FILTERS"),className:`flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 transition-colors relative ${y==="FILTERS"?"text-emerald-600":"text-slate-500 bg-slate-50"}`,children:[f.jsx(jf,{size:16}),s.features,te>0&&f.jsx("span",{className:"bg-emerald-600 text-white text-[10px] w-5 h-5 flex items-center justify-center rounded-full",children:te}),y==="FILTERS"&&f.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-600"})]}),f.jsxs("button",{onClick:()=>E("RESULTS"),className:`flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 transition-colors relative ${y==="RESULTS"?"text-emerald-600":"text-slate-500 bg-slate-50"}`,children:[f.jsx(Xy,{size:16}),s.matches,f.jsx("span",{className:"bg-slate-200 text-slate-700 text-[10px] px-1.5 py-0.5 rounded-full font-bold",children:Te.length}),y==="RESULTS"&&f.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-600"})]})]}),f.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row relative",children:[f.jsxs("div",{className:`w-full md:w-1/3 lg:w-1/4 bg-white md:border-r flex flex-col h-full relative z-20 ${y==="FILTERS"?"flex":"hidden md:flex"}`,children:[f.jsx("div",{className:"hidden md:block p-4 border-b bg-slate-50",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("h3",{className:"font-semibold text-slate-700 flex items-center gap-2",children:[f.jsx(jf,{size:18})," ",s.features]}),f.jsx("button",{onClick:()=>T(!w),className:`flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-lg transition-all ${w?"bg-emerald-100 text-emerald-700":"text-slate-600 bg-slate-100 hover:bg-slate-200"}`,title:w?"Mostrar todas":"Ocultar vazias",children:f.jsx(Bf,{size:16})})]})}),f.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 pb-24 md:pb-4 custom-scrollbar",children:ge.map(Z=>{const R=a[Z.id]||[],G=R.length>0;return f.jsxs("div",{className:"space-y-2 relative",children:[f.jsxs("div",{className:"flex justify-between items-center sticky top-0 bg-white/95 backdrop-blur-sm py-1 z-10",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("h4",{className:`font-medium ${G?"text-emerald-600":"text-slate-700"}`,children:Z.name}),Z.imageUrl&&f.jsx(f.Fragment,{children:f.jsx("button",{className:"text-slate-400 hover:text-emerald-500 transition-colors p-1",onClick:F=>{F.stopPropagation(),h(u===Z.id?null:Z.id)},children:f.jsx(ka,{size:14})})})]}),G&&f.jsx("span",{className:"text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full",children:R.length})]}),u===Z.id&&Z.imageUrl&&f.jsxs("div",{className:"mb-2 rounded-lg overflow-hidden border border-slate-200 shadow-sm animate-in fade-in zoom-in-95",children:[f.jsx("img",{src:Z.imageUrl,alt:Z.name,className:"w-full h-32 object-cover"}),f.jsx("div",{className:"bg-slate-50 p-1 text-center",children:f.jsx("button",{onClick:()=>h(null),className:"text-xs text-slate-500 underline",children:"Fechar"})})]}),f.jsx("div",{className:"grid grid-cols-1 gap-1",children:Z.states.map(F=>{const O=R.includes(F.id);return f.jsxs("div",{className:"flex items-center gap-1",children:[F.imageUrl&&f.jsx("button",{onClick:X=>{X.stopPropagation(),v({url:F.imageUrl,label:F.label,featureName:Z.name})},className:"w-8 h-8 rounded overflow-hidden border border-slate-200 hover:border-emerald-400 transition-colors shrink-0",title:r==="pt"?"Ver imagem":"View image",children:f.jsx("img",{src:F.imageUrl,alt:F.label,className:"w-full h-full object-cover"})}),f.jsxs("button",{onClick:()=>q(Z.id,F.id),className:`flex-1 text-left px-3 py-3 md:py-2 text-sm rounded-lg transition-all flex items-center justify-between group active:scale-[0.98] touch-manipulation ${O?"bg-emerald-600 text-white shadow-md":"bg-slate-50 text-slate-600 border border-transparent hover:bg-slate-100 hover:border-slate-200"}`,children:[f.jsx("span",{className:"leading-tight",children:F.label}),O&&f.jsx(t0,{size:16,className:"shrink-0"})]})]},F.id)})})]},Z.id)})}),f.jsx("div",{className:"md:hidden absolute bottom-4 left-4 right-4 z-30",children:f.jsxs("button",{onClick:()=>E("RESULTS"),className:"w-full bg-slate-900 text-white font-bold py-3 rounded-xl shadow-lg shadow-slate-900/20 flex items-center justify-center gap-2 animate-in slide-in-from-bottom-5",children:[s.viewResults," (",Te.length,")"]})})]}),f.jsxs("div",{className:`flex-1 bg-slate-100 flex-col h-full overflow-hidden ${y==="RESULTS"?"flex":"hidden md:flex"}`,children:[f.jsxs("div",{className:"p-3 md:p-4 bg-white border-b flex justify-between items-center shadow-sm shrink-0",children:[f.jsxs("div",{className:"flex gap-2 md:gap-4 w-full md:w-auto bg-slate-100 p-1 rounded-lg",children:[f.jsxs("button",{className:`flex-1 md:flex-none text-xs md:text-sm font-medium px-3 py-1.5 rounded-md transition-all ${c?"text-slate-500":"bg-white text-slate-800 shadow-sm"}`,onClick:()=>l(!1),children:[s.matches," (",Te.length,")"]}),f.jsxs("button",{className:`flex-1 md:flex-none text-xs md:text-sm font-medium px-3 py-1.5 rounded-md transition-all ${c?"bg-white text-slate-800 shadow-sm":"text-slate-500"}`,onClick:()=>l(!0),children:[s.discarded," (",W.length,")"]})]}),f.jsx("div",{className:"text-xs text-slate-400 hidden sm:block",children:Te.length===1?s.identified:`${Te.length} ${s.potential}`})]}),f.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 custom-scrollbar",onClick:()=>h(null),children:f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 pb-20 md:pb-0",children:[(c?W:Te).map(Z=>f.jsxs("div",{onClick:()=>x(Z),className:`bg-white rounded-xl overflow-hidden shadow-sm hover:shadow-lg transition-all border cursor-pointer active:scale-[0.98] touch-manipulation ${c?"opacity-60 grayscale":""}`,children:[f.jsxs("div",{className:"h-48 md:h-40 bg-slate-200 relative group",children:[f.jsx("img",{src:Z.imageUrl||"https://picsum.photos/400/300",alt:Z.name,className:"w-full h-full object-cover",loading:"lazy"}),f.jsxs("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2 text-white font-medium",children:[f.jsx(Bf,{size:20})," ",f.jsx("span",{className:"hidden md:inline",children:"Ver Detalhes"})]}),f.jsx("div",{className:"md:hidden absolute bottom-2 right-2 bg-black/50 text-white p-1.5 rounded-full backdrop-blur-sm",children:f.jsx(Bf,{size:16})})]}),f.jsxs("div",{className:"p-4",children:[f.jsxs("h3",{className:"font-bold text-slate-800 text-lg mb-1 flex justify-between items-center",children:[Z.name,f.jsx(i0,{size:16,className:"text-slate-300"})]}),(Z.scientificName||Z.family)&&f.jsxs("p",{className:"text-xs text-slate-400 italic mb-1",children:[Z.scientificName,Z.scientificName&&Z.family?"  ":"",Z.family]}),f.jsx("p",{className:"text-slate-500 text-xs line-clamp-3",children:Z.description}),c&&f.jsxs("div",{className:"mt-3 pt-2 border-t border-slate-100 text-xs text-red-500 flex items-center gap-1",children:[f.jsx(er,{size:12})," ",s.excluded]})]})]},Z.id)),!c&&Te.length===0&&f.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-20 text-slate-400 px-4 text-center",children:[f.jsx(jf,{size:48,className:"mb-4 opacity-50"}),f.jsx("p",{className:"text-lg font-medium text-slate-600",children:s.noMatches}),f.jsx("p",{className:"text-sm",children:s.tryUnselecting}),f.jsx("button",{onClick:ue,className:"mt-6 px-6 py-2 bg-slate-200 text-slate-700 rounded-lg font-medium hover:bg-slate-300",children:s.restart})]})]})})]})]}),m&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-0 md:p-4 animate-in fade-in duration-200",children:f.jsxs("div",{className:"bg-white md:rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col h-full md:h-auto md:max-h-[90vh] overflow-hidden",children:[f.jsxs("div",{className:"relative h-64 md:h-64 shrink-0 bg-slate-900",children:[m.imageUrl?f.jsx("img",{src:m.imageUrl,className:"w-full h-full object-cover opacity-90",alt:m.name}):f.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-600 bg-slate-200",children:f.jsx(ka,{size:48})}),f.jsx("button",{onClick:()=>x(null),className:"absolute top-4 right-4 bg-black/40 hover:bg-black/60 text-white p-2 rounded-full transition-colors z-10 backdrop-blur-sm",children:f.jsx(er,{size:24})}),f.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 via-black/50 to-transparent p-6 pt-12",children:[f.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white shadow-sm leading-tight",children:m.name}),(m.scientificName||m.family)&&f.jsxs("p",{className:"text-white/80 italic text-sm md:text-base mt-1",children:[m.scientificName,m.scientificName&&m.family?"  ":"",m.family]})]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8 custom-scrollbar bg-white",children:[f.jsxs("div",{children:[f.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-3",children:[f.jsx(US,{size:14})," ",s.speciesDetails]}),f.jsx("p",{className:"text-slate-800 leading-relaxed text-base md:text-lg font-serif",children:m.description})]}),m.links&&m.links.length>0&&f.jsxs("div",{children:[f.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-3",children:[f.jsx(a0,{size:14})," ",s.resources]}),f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:m.links.map((Z,R)=>f.jsxs("a",{href:Z.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 rounded-lg border border-slate-200 bg-slate-50 hover:bg-slate-100 hover:border-emerald-300 transition-all group active:scale-[0.98]",children:[f.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm text-slate-400 group-hover:text-emerald-600",children:f.jsx(Sa,{size:16})}),f.jsx("span",{className:"text-sm font-medium text-slate-700 group-hover:text-emerald-700 truncate flex-1",children:Z.label||Z.url})]},R))})]}),f.jsx("div",{className:"border-t border-slate-100"}),f.jsxs("div",{children:[f.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-4",children:[f.jsx(rk,{size:14})," ",s.morphology]}),f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4",children:e.features.map(Z=>{const R=m.traits[Z.id];if(!R||R.length===0)return null;const G=R.map(F=>{const O=Z.states.find(X=>X.id===F);return O?O.label:"?"}).join(", ");return f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 flex flex-col",children:[f.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:Z.name}),f.jsx("span",{className:"text-sm font-semibold text-slate-800",children:G})]},Z.id)})}),Object.keys(m.traits).length===0&&f.jsx("p",{className:"text-slate-400 text-sm italic",children:"Nenhuma caracterstica registrada."})]})]}),f.jsx("div",{className:"p-4 border-t bg-slate-50 shrink-0 safe-area-bottom",children:f.jsx("button",{onClick:()=>x(null),className:"w-full py-3 bg-slate-900 text-white font-bold rounded-xl hover:bg-slate-800 transition-colors shadow-lg",children:s.close})})]})}),g&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[60] flex items-center justify-center p-4",onClick:()=>v(null),children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full overflow-hidden animate-in fade-in zoom-in-95",onClick:Z=>Z.stopPropagation(),children:[f.jsxs("div",{className:"relative",children:[f.jsx("img",{src:g.url,alt:g.label,className:"w-full max-h-[60vh] object-contain bg-slate-100"}),f.jsx("button",{onClick:()=>v(null),className:"absolute top-3 right-3 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full transition-colors",children:f.jsx(er,{size:18})})]}),f.jsxs("div",{className:"p-4 bg-white",children:[f.jsx("h4",{className:"font-semibold text-slate-800",children:g.label}),f.jsx("p",{className:"text-sm text-slate-500",children:g.featureName})]})]})})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let l5,c5;function u5(){return{geminiUrl:l5,vertexUrl:c5}}function f5(e,t,r,n){var i,s;if(!(e!=null&&e.baseUrl)){const a=u5();return t?(i=a.vertexUrl)!==null&&i!==void 0?i:r:(s=a.geminiUrl)!==null&&s!==void 0?s:n}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Fi{}function Le(e,t){const r=/\{([^}]+)\}/g;return e.replace(r,(n,i)=>{if(Object.prototype.hasOwnProperty.call(t,i)){const s=t[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function p(e,t,r){for(let s=0;s<t.length-1;s++){const a=t[s];if(a.endsWith("[]")){const o=a.slice(0,-2);if(!(o in e))if(Array.isArray(r))e[o]=Array.from({length:r.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(e[o])){const c=e[o];if(Array.isArray(r))for(let l=0;l<c.length;l++){const u=c[l];p(u,t.slice(s+1),r[l])}else for(const l of c)p(l,t.slice(s+1),r)}return}else if(a.endsWith("[0]")){const o=a.slice(0,-3);o in e||(e[o]=[{}]);const c=e[o];p(c[0],t.slice(s+1),r);return}(!e[a]||typeof e[a]!="object")&&(e[a]={}),e=e[a]}const n=t[t.length-1],i=e[n];if(i!==void 0){if(!r||typeof r=="object"&&Object.keys(r).length===0||r===i)return;if(typeof i=="object"&&typeof r=="object"&&i!==null&&r!==null)Object.assign(i,r);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else n==="_self"&&typeof r=="object"&&r!==null&&!Array.isArray(r)?Object.assign(e,r):e[n]=r}function d(e,t,r=void 0){try{if(t.length===1&&t[0]==="_self")return e;for(let n=0;n<t.length;n++){if(typeof e!="object"||e===null)return r;const i=t[n];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in e){const a=e[s];return Array.isArray(a)?a.map(o=>d(o,t.slice(n+1),r)):r}else return r}else e=e[i]}return e}catch(n){if(n instanceof TypeError)return r;throw n}}function d5(e,t){for(const[r,n]of Object.entries(t)){const i=r.split("."),s=n.split("."),a=new Set;let o=-1;for(let c=0;c<i.length;c++)if(i[c]==="*"){o=c;break}if(o!==-1&&s.length>o)for(let c=o;c<s.length;c++){const l=s[c];l!=="*"&&!l.endsWith("[]")&&!l.endsWith("[0]")&&a.add(l)}y0(e,i,s,0,a)}}function y0(e,t,r,n,i){if(n>=t.length||typeof e!="object"||e===null)return;const s=t[n];if(s.endsWith("[]")){const a=s.slice(0,-2),o=e;if(a in o&&Array.isArray(o[a]))for(const c of o[a])y0(c,t,r,n+1,i)}else if(s==="*"){if(typeof e=="object"&&e!==null&&!Array.isArray(e)){const a=e,o=Object.keys(a).filter(l=>!l.startsWith("_")&&!i.has(l)),c={};for(const l of o)c[l]=a[l];for(const[l,u]of Object.entries(c)){const h=[];for(const m of r.slice(n))m==="*"?h.push(l):h.push(m);p(a,h,u)}for(const l of o)delete a[l]}}else{const a=e;s in a&&y0(a[s],t,r,n+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dp(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function h5(e){const t={},r=d(e,["operationName"]);r!=null&&p(t,["operationName"],r);const n=d(e,["resourceName"]);return n!=null&&p(t,["_url","resourceName"],n),t}function p5(e){const t={},r=d(e,["name"]);r!=null&&p(t,["name"],r);const n=d(e,["metadata"]);n!=null&&p(t,["metadata"],n);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["response","generateVideoResponse"]);return a!=null&&p(t,["response"],x5(a)),t}function m5(e){const t={},r=d(e,["name"]);r!=null&&p(t,["name"],r);const n=d(e,["metadata"]);n!=null&&p(t,["metadata"],n);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["response"]);return a!=null&&p(t,["response"],g5(a)),t}function x5(e){const t={},r=d(e,["generatedSamples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>v5(a))),p(t,["generatedVideos"],s)}const n=d(e,["raiMediaFilteredCount"]);n!=null&&p(t,["raiMediaFilteredCount"],n);const i=d(e,["raiMediaFilteredReasons"]);return i!=null&&p(t,["raiMediaFilteredReasons"],i),t}function g5(e){const t={},r=d(e,["videos"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>y5(a))),p(t,["generatedVideos"],s)}const n=d(e,["raiMediaFilteredCount"]);n!=null&&p(t,["raiMediaFilteredCount"],n);const i=d(e,["raiMediaFilteredReasons"]);return i!=null&&p(t,["raiMediaFilteredReasons"],i),t}function v5(e){const t={},r=d(e,["video"]);return r!=null&&p(t,["video"],k5(r)),t}function y5(e){const t={},r=d(e,["_self"]);return r!=null&&p(t,["video"],C5(r)),t}function w5(e){const t={},r=d(e,["operationName"]);return r!=null&&p(t,["_url","operationName"],r),t}function E5(e){const t={},r=d(e,["operationName"]);return r!=null&&p(t,["_url","operationName"],r),t}function T5(e){const t={},r=d(e,["name"]);r!=null&&p(t,["name"],r);const n=d(e,["metadata"]);n!=null&&p(t,["metadata"],n);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["response"]);return a!=null&&p(t,["response"],_5(a)),t}function _5(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["parent"]);n!=null&&p(t,["parent"],n);const i=d(e,["documentName"]);return i!=null&&p(t,["documentName"],i),t}function lE(e){const t={},r=d(e,["name"]);r!=null&&p(t,["name"],r);const n=d(e,["metadata"]);n!=null&&p(t,["metadata"],n);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["response"]);return a!=null&&p(t,["response"],S5(a)),t}function S5(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["parent"]);n!=null&&p(t,["parent"],n);const i=d(e,["documentName"]);return i!=null&&p(t,["documentName"],i),t}function k5(e){const t={},r=d(e,["uri"]);r!=null&&p(t,["uri"],r);const n=d(e,["encodedVideo"]);n!=null&&p(t,["videoBytes"],dp(n));const i=d(e,["encoding"]);return i!=null&&p(t,["mimeType"],i),t}function C5(e){const t={},r=d(e,["gcsUri"]);r!=null&&p(t,["uri"],r);const n=d(e,["bytesBase64Encoded"]);n!=null&&p(t,["videoBytes"],dp(n));const i=d(e,["mimeType"]);return i!=null&&p(t,["mimeType"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var lg;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(lg||(lg={}));var cg;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(cg||(cg={}));var ug;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(ug||(ug={}));var me;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(me||(me={}));var fg;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(fg||(fg={}));var dg;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(dg||(dg={}));var hg;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(hg||(hg={}));var pg;(function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(pg||(pg={}));var mg;(function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(mg||(mg={}));var xg;(function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.HIGH="HIGH"})(xg||(xg={}));var gg;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(gg||(gg={}));var vg;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(vg||(vg={}));var yg;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(yg||(yg={}));var wg;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE"})(wg||(wg={}));var Eg;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(Eg||(Eg={}));var Tg;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Tg||(Tg={}));var _g;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(_g||(_g={}));var Sg;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"})(Sg||(Sg={}));var kg;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(kg||(kg={}));var bu;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(bu||(bu={}));var Cg;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Cg||(Cg={}));var Ng;(function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Ng||(Ng={}));var Ag;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Ag||(Ag={}));var w0;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(w0||(w0={}));var bg;(function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"})(bg||(bg={}));var Ig;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Ig||(Ig={}));var Fg;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(Fg||(Fg={}));var Rg;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(Rg||(Rg={}));var Pg;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(Pg||(Pg={}));var Mg;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Mg||(Mg={}));var Dg;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"})(Dg||(Dg={}));var Lg;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(Lg||(Lg={}));var Og;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(Og||(Og={}));var Ug;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(Ug||(Ug={}));var Bg;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Bg||(Bg={}));var $g;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})($g||($g={}));var jg;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(jg||(jg={}));var Gg;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Gg||(Gg={}));var Vg;(function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"})(Vg||(Vg={}));var Hg;(function(e){e.ASSET="ASSET",e.STYLE="STYLE"})(Hg||(Hg={}));var zg;(function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"})(zg||(zg={}));var Wg;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(Wg||(Wg={}));var qg;(function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING"})(qg||(qg={}));var Jg;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"})(Jg||(Jg={}));var Kg;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(Kg||(Kg={}));var Yg;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(Yg||(Yg={}));var Xg;(function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Xg||(Xg={}));var Qg;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(Qg||(Qg={}));var Zg;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Zg||(Zg={}));var e1;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(e1||(e1={}));var t1;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(t1||(t1={}));var r1;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(r1||(r1={}));var n1;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(n1||(n1={}));var i1;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})(i1||(i1={}));var Na;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(Na||(Na={}));class E0{constructor(t){const r={};for(const n of t.headers.entries())r[n[0]]=n[1];this.headers=r,this.responseInternal=t}json(){return this.responseInternal.json()}}class No{get text(){var t,r,n,i,s,a,o,c;if(((i=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let l="",u=!1;const h=[];for(const m of(c=(o=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)!==null&&c!==void 0?c:[]){for(const[x,g]of Object.entries(m))x!=="text"&&x!=="thought"&&x!=="thoughtSignature"&&(g!==null||g!==void 0)&&h.push(x);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;u=!0,l+=m.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?l:void 0}get data(){var t,r,n,i,s,a,o,c;if(((i=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let l="";const u=[];for(const h of(c=(o=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)!==null&&c!==void 0?c:[]){for(const[m,x]of Object.entries(h))m!=="inlineData"&&(x!==null||x!==void 0)&&u.push(m);h.inlineData&&typeof h.inlineData.data=="string"&&(l+=atob(h.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),l.length>0?btoa(l):void 0}get functionCalls(){var t,r,n,i,s,a,o,c;if(((i=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const l=(c=(o=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||c===void 0?void 0:c.filter(u=>u.functionCall).map(u=>u.functionCall).filter(u=>u!==void 0);if((l==null?void 0:l.length)!==0)return l}get executableCode(){var t,r,n,i,s,a,o,c,l;if(((i=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const u=(c=(o=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||c===void 0?void 0:c.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((u==null?void 0:u.length)!==0)return(l=u==null?void 0:u[0])===null||l===void 0?void 0:l.code}get codeExecutionResult(){var t,r,n,i,s,a,o,c,l;if(((i=(n=(r=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||r===void 0?void 0:r.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const u=(c=(o=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||c===void 0?void 0:c.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((u==null?void 0:u.length)!==0)return(l=u==null?void 0:u[0])===null||l===void 0?void 0:l.output}}class s1{}class a1{}class N5{}class A5{}class b5{}class I5{}class o1{}class l1{}class c1{}class F5{}class Iu{_fromAPIResponse({apiResponse:t,_isVertexAI:r}){const n=new Iu;let i;const s=t;return r?i=m5(s):i=p5(s),Object.assign(n,i),n}}class u1{}class f1{}class d1{}class R5{}class P5{}class M5{}class hp{_fromAPIResponse({apiResponse:t,_isVertexAI:r}){const n=new hp,s=T5(t);return Object.assign(n,s),n}}class D5{}class L5{}class O5{}class h1{}class U5{get text(){var t,r,n;let i="",s=!1;const a=[];for(const o of(n=(r=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||r===void 0?void 0:r.parts)!==null&&n!==void 0?n:[]){for(const[c,l]of Object.entries(o))c!=="text"&&c!=="thought"&&l!==null&&a.push(c);if(typeof o.text=="string"){if(typeof o.thought=="boolean"&&o.thought)continue;s=!0,i+=o.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var t,r,n;let i="";const s=[];for(const a of(n=(r=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||r===void 0?void 0:r.parts)!==null&&n!==void 0?n:[]){for(const[o,c]of Object.entries(a))o!=="inlineData"&&c!==null&&s.push(o);a.inlineData&&typeof a.inlineData.data=="string"&&(i+=atob(a.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class B5{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class pp{_fromAPIResponse({apiResponse:t,_isVertexAI:r}){const n=new pp,s=lE(t);return Object.assign(n,s),n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ut(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const r=t.split("/",2);return`publishers/${r[0]}/models/${r[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function cE(e,t){const r=ut(e,t);return r?r.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${r}`:r.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${r}`:r:""}function uE(e){return Array.isArray(e)?e.map(t=>Fu(t)):[Fu(e)]}function Fu(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function fE(e){const t=Fu(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function dE(e){const t=Fu(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function p1(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function hE(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>p1(t)):[p1(e)]}function T0(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function m1(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function x1(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function br(e){if(e==null)throw new Error("ContentUnion is required");return T0(e)?e:{role:"user",parts:hE(e)}}function mp(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(r=>{const n=br(r);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(e.isVertexAI()){const r=br(t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]}return Array.isArray(t)?t.map(r=>br(r)):[br(t)]}function An(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(m1(e)||x1(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[br(e)]}const t=[],r=[],n=T0(e[0]);for(const i of e){const s=T0(i);if(s!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)t.push(i);else{if(m1(i)||x1(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(i)}}return n||t.push({role:"user",parts:hE(r)}),t}function $5(e,t){e.includes("null")&&(t.nullable=!0);const r=e.filter(n=>n!=="null");if(r.length===1)t.type=Object.values(me).includes(r[0].toUpperCase())?r[0].toUpperCase():me.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const n of r)t.anyOf.push({type:Object.values(me).includes(n.toUpperCase())?n.toUpperCase():me.TYPE_UNSPECIFIED})}}function Ba(e){const t={},r=["items"],n=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=e.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(t.nullable=!0,e=s[1]):s[1].type==="null"&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&$5(e.type,t);for(const[a,o]of Object.entries(e))if(o!=null)if(a=="type"){if(o==="null")throw new Error("type: null can not be the only possible type for the field.");if(o instanceof Array)continue;t.type=Object.values(me).includes(o.toUpperCase())?o.toUpperCase():me.TYPE_UNSPECIFIED}else if(r.includes(a))t[a]=Ba(o);else if(n.includes(a)){const c=[];for(const l of o){if(l.type=="null"){t.nullable=!0;continue}c.push(Ba(l))}t[a]=c}else if(i.includes(a)){const c={};for(const[l,u]of Object.entries(o))c[l]=Ba(u);t[a]=c}else{if(a==="additionalProperties")continue;t[a]=o}return t}function xp(e){return Ba(e)}function gp(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function vp(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function ao(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=Ba(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=Ba(t.response));return e}function oo(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const r of e)t.push(r);return t}function j5(e,t,r,n=1){const i=!t.startsWith(`${r}/`)&&t.split("/").length===n;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${r}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:i?`projects/${e.getProject()}/locations/${e.getLocation()}/${r}/${t}`:t:i?`${r}/${t}`:t}function Ri(e,t){if(typeof t!="string")throw new Error("name must be a string");return j5(e,t,"cachedContents")}function pE(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function ms(e){return dp(e)}function G5(e){return e!=null&&typeof e=="object"&&"name"in e}function V5(e){return e!=null&&typeof e=="object"&&"video"in e}function H5(e){return e!=null&&typeof e=="object"&&"uri"in e}function mE(e){var t;let r;if(G5(e)&&(r=e.name),!(H5(e)&&(r=e.uri,r===void 0))&&!(V5(e)&&(r=(t=e.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const i=r.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${r}`);r=i[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function xE(e,t){let r;return e.isVertexAI()?r=t?"publishers/google/models":"models":r=t?"models":"tunedModels",r}function gE(e){for(const t of["models","tunedModels","publisherModels"])if(z5(e,t))return e[t];return[]}function z5(e,t){return e!==null&&typeof e=="object"&&t in e}function W5(e,t={}){const r=e,n={name:r.name,description:r.description,parametersJsonSchema:r.inputSchema};return r.outputSchema&&(n.responseJsonSchema=r.outputSchema),t.behavior&&(n.behavior=t.behavior),{functionDeclarations:[n]}}function q5(e,t={}){const r=[],n=new Set;for(const i of e){const s=i.name;if(n.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);n.add(s);const a=W5(i,t);a.functionDeclarations&&r.push(...a.functionDeclarations)}return{functionDeclarations:r}}function vE(e,t){let r;if(typeof t=="string")if(e.isVertexAI())if(t.startsWith("gs://"))r={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))r={format:"bigquery",bigqueryUri:t};else throw new Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))r={fileName:t};else throw new Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");r={inlinedRequests:t}}else r=t;const n=[r.gcsUri,r.bigqueryUri].filter(Boolean).length,i=[r.inlinedRequests,r.fileName].filter(Boolean).length;if(e.isVertexAI()){if(i>0||n!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return r}function J5(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function yE(e){if(typeof e!="object"||e===null)return{};const t=e,r=t.inlinedResponses;if(typeof r!="object"||r===null)return e;const i=r.inlinedResponses;if(!Array.isArray(i)||i.length===0)return e;let s=!1;for(const a of i){if(typeof a!="object"||a===null)continue;const c=a.response;if(typeof c!="object"||c===null)continue;if(c.embedding!==void 0){s=!0;break}}return s&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function lo(e,t){const r=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(r))return r.split("/").pop();throw new Error(`Invalid batch job name: ${r}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(r))return r.split("/").pop();if(/^\d+$/.test(r))return r;throw new Error(`Invalid batch job name: ${r}.`)}function wE(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function K5(e){const t={},r=d(e,["responsesFile"]);r!=null&&p(t,["fileName"],r);const n=d(e,["inlinedResponses","inlinedResponses"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>bD(a))),p(t,["inlinedResponses"],s)}const i=d(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["inlinedEmbedContentResponses"],s)}return t}function Y5(e){const t={},r=d(e,["predictionsFormat"]);r!=null&&p(t,["format"],r);const n=d(e,["gcsDestination","outputUriPrefix"]);n!=null&&p(t,["gcsUri"],n);const i=d(e,["bigqueryDestination","outputUri"]);return i!=null&&p(t,["bigqueryUri"],i),t}function X5(e){const t={},r=d(e,["format"]);r!=null&&p(t,["predictionsFormat"],r);const n=d(e,["gcsUri"]);n!=null&&p(t,["gcsDestination","outputUriPrefix"],n);const i=d(e,["bigqueryUri"]);if(i!=null&&p(t,["bigqueryDestination","outputUri"],i),d(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(d(e,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}function $c(e){const t={},r=d(e,["name"]);r!=null&&p(t,["name"],r);const n=d(e,["metadata","displayName"]);n!=null&&p(t,["displayName"],n);const i=d(e,["metadata","state"]);i!=null&&p(t,["state"],wE(i));const s=d(e,["metadata","createTime"]);s!=null&&p(t,["createTime"],s);const a=d(e,["metadata","endTime"]);a!=null&&p(t,["endTime"],a);const o=d(e,["metadata","updateTime"]);o!=null&&p(t,["updateTime"],o);const c=d(e,["metadata","model"]);c!=null&&p(t,["model"],c);const l=d(e,["metadata","output"]);return l!=null&&p(t,["dest"],K5(yE(l))),t}function _0(e){const t={},r=d(e,["name"]);r!=null&&p(t,["name"],r);const n=d(e,["displayName"]);n!=null&&p(t,["displayName"],n);const i=d(e,["state"]);i!=null&&p(t,["state"],wE(i));const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["createTime"]);a!=null&&p(t,["createTime"],a);const o=d(e,["startTime"]);o!=null&&p(t,["startTime"],o);const c=d(e,["endTime"]);c!=null&&p(t,["endTime"],c);const l=d(e,["updateTime"]);l!=null&&p(t,["updateTime"],l);const u=d(e,["model"]);u!=null&&p(t,["model"],u);const h=d(e,["inputConfig"]);h!=null&&p(t,["src"],Q5(h));const m=d(e,["outputConfig"]);m!=null&&p(t,["dest"],Y5(yE(m)));const x=d(e,["completionStats"]);return x!=null&&p(t,["completionStats"],x),t}function Q5(e){const t={},r=d(e,["instancesFormat"]);r!=null&&p(t,["format"],r);const n=d(e,["gcsSource","uris"]);n!=null&&p(t,["gcsUri"],n);const i=d(e,["bigquerySource","inputUri"]);return i!=null&&p(t,["bigqueryUri"],i),t}function Z5(e,t){const r={};if(d(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=d(t,["fileName"]);n!=null&&p(r,["fileName"],n);const i=d(t,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>AD(e,a))),p(r,["requests","requests"],s)}return r}function eD(e){const t={},r=d(e,["format"]);r!=null&&p(t,["instancesFormat"],r);const n=d(e,["gcsUri"]);n!=null&&p(t,["gcsSource","uris"],n);const i=d(e,["bigqueryUri"]);if(i!=null&&p(t,["bigquerySource","inputUri"],i),d(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function tD(e){const t={},r=d(e,["data"]);if(r!=null&&p(t,["data"],r),d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function rD(e,t){const r={},n=d(t,["name"]);return n!=null&&p(r,["_url","name"],lo(e,n)),r}function nD(e,t){const r={},n=d(t,["name"]);return n!=null&&p(r,["_url","name"],lo(e,n)),r}function iD(e){const t={},r=d(e,["content"]);r!=null&&p(t,["content"],r);const n=d(e,["citationMetadata"]);n!=null&&p(t,["citationMetadata"],sD(n));const i=d(e,["tokenCount"]);i!=null&&p(t,["tokenCount"],i);const s=d(e,["finishReason"]);s!=null&&p(t,["finishReason"],s);const a=d(e,["avgLogprobs"]);a!=null&&p(t,["avgLogprobs"],a);const o=d(e,["groundingMetadata"]);o!=null&&p(t,["groundingMetadata"],o);const c=d(e,["index"]);c!=null&&p(t,["index"],c);const l=d(e,["logprobsResult"]);l!=null&&p(t,["logprobsResult"],l);const u=d(e,["safetyRatings"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(x=>x)),p(t,["safetyRatings"],m)}const h=d(e,["urlContextMetadata"]);return h!=null&&p(t,["urlContextMetadata"],h),t}function sD(e){const t={},r=d(e,["citationSources"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(i=>i)),p(t,["citations"],n)}return t}function EE(e){const t={},r=d(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>LD(s))),p(t,["parts"],i)}const n=d(e,["role"]);return n!=null&&p(t,["role"],n),t}function aD(e,t){const r={},n=d(e,["displayName"]);if(t!==void 0&&n!=null&&p(t,["batch","displayName"],n),d(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return r}function oD(e,t){const r={},n=d(e,["displayName"]);t!==void 0&&n!=null&&p(t,["displayName"],n);const i=d(e,["dest"]);return t!==void 0&&i!=null&&p(t,["outputConfig"],X5(J5(i))),r}function g1(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["src"]);i!=null&&p(r,["batch","inputConfig"],Z5(e,vE(e,i)));const s=d(t,["config"]);return s!=null&&aD(s,r),r}function lD(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["model"],ut(e,n));const i=d(t,["src"]);i!=null&&p(r,["inputConfig"],eD(vE(e,i)));const s=d(t,["config"]);return s!=null&&oD(s,r),r}function cD(e,t){const r={},n=d(e,["displayName"]);return t!==void 0&&n!=null&&p(t,["batch","displayName"],n),r}function uD(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["src"]);i!=null&&p(r,["batch","inputConfig"],gD(e,i));const s=d(t,["config"]);return s!=null&&cD(s,r),r}function fD(e,t){const r={},n=d(t,["name"]);return n!=null&&p(r,["_url","name"],lo(e,n)),r}function dD(e,t){const r={},n=d(t,["name"]);return n!=null&&p(r,["_url","name"],lo(e,n)),r}function hD(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["name"]);n!=null&&p(t,["name"],n);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);return s!=null&&p(t,["error"],s),t}function pD(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["name"]);n!=null&&p(t,["name"],n);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);return s!=null&&p(t,["error"],s),t}function mD(e,t){const r={},n=d(t,["contents"]);if(n!=null){let s=mp(e,n);Array.isArray(s)&&(s=s.map(a=>a)),p(r,["requests[]","request","content"],s)}const i=d(t,["config"]);return i!=null&&(p(r,["_self"],xD(i,r)),d5(r,{"requests[].*":"requests[].request.*"})),r}function xD(e,t){const r={},n=d(e,["taskType"]);t!==void 0&&n!=null&&p(t,["requests[]","taskType"],n);const i=d(e,["title"]);t!==void 0&&i!=null&&p(t,["requests[]","title"],i);const s=d(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&p(t,["requests[]","outputDimensionality"],s),d(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function gD(e,t){const r={},n=d(t,["fileName"]);n!=null&&p(r,["file_name"],n);const i=d(t,["inlinedRequests"]);return i!=null&&p(r,["requests"],mD(e,i)),r}function vD(e){const t={};if(d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(e,["fileUri"]);r!=null&&p(t,["fileUri"],r);const n=d(e,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function yD(e){const t={},r=d(e,["id"]);r!=null&&p(t,["id"],r);const n=d(e,["args"]);n!=null&&p(t,["args"],n);const i=d(e,["name"]);if(i!=null&&p(t,["name"],i),d(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function wD(e){const t={},r=d(e,["mode"]);r!=null&&p(t,["mode"],r);const n=d(e,["allowedFunctionNames"]);if(n!=null&&p(t,["allowedFunctionNames"],n),d(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function ED(e,t,r){const n={},i=d(t,["systemInstruction"]);r!==void 0&&i!=null&&p(r,["systemInstruction"],EE(br(i)));const s=d(t,["temperature"]);s!=null&&p(n,["temperature"],s);const a=d(t,["topP"]);a!=null&&p(n,["topP"],a);const o=d(t,["topK"]);o!=null&&p(n,["topK"],o);const c=d(t,["candidateCount"]);c!=null&&p(n,["candidateCount"],c);const l=d(t,["maxOutputTokens"]);l!=null&&p(n,["maxOutputTokens"],l);const u=d(t,["stopSequences"]);u!=null&&p(n,["stopSequences"],u);const h=d(t,["responseLogprobs"]);h!=null&&p(n,["responseLogprobs"],h);const m=d(t,["logprobs"]);m!=null&&p(n,["logprobs"],m);const x=d(t,["presencePenalty"]);x!=null&&p(n,["presencePenalty"],x);const g=d(t,["frequencyPenalty"]);g!=null&&p(n,["frequencyPenalty"],g);const v=d(t,["seed"]);v!=null&&p(n,["seed"],v);const y=d(t,["responseMimeType"]);y!=null&&p(n,["responseMimeType"],y);const E=d(t,["responseSchema"]);E!=null&&p(n,["responseSchema"],xp(E));const w=d(t,["responseJsonSchema"]);if(w!=null&&p(n,["responseJsonSchema"],w),d(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const T=d(t,["safetySettings"]);if(r!==void 0&&T!=null){let q=T;Array.isArray(q)&&(q=q.map(ue=>OD(ue))),p(r,["safetySettings"],q)}const k=d(t,["tools"]);if(r!==void 0&&k!=null){let q=oo(k);Array.isArray(q)&&(q=q.map(ue=>BD(ao(ue)))),p(r,["tools"],q)}const b=d(t,["toolConfig"]);if(r!==void 0&&b!=null&&p(r,["toolConfig"],UD(b)),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const I=d(t,["cachedContent"]);r!==void 0&&I!=null&&p(r,["cachedContent"],Ri(e,I));const S=d(t,["responseModalities"]);S!=null&&p(n,["responseModalities"],S);const B=d(t,["mediaResolution"]);B!=null&&p(n,["mediaResolution"],B);const D=d(t,["speechConfig"]);if(D!=null&&p(n,["speechConfig"],gp(D)),d(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const H=d(t,["thinkingConfig"]);H!=null&&p(n,["thinkingConfig"],H);const Y=d(t,["imageConfig"]);return Y!=null&&p(n,["imageConfig"],ND(Y)),n}function TD(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["candidates"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(l=>iD(l))),p(t,["candidates"],c)}const i=d(e,["modelVersion"]);i!=null&&p(t,["modelVersion"],i);const s=d(e,["promptFeedback"]);s!=null&&p(t,["promptFeedback"],s);const a=d(e,["responseId"]);a!=null&&p(t,["responseId"],a);const o=d(e,["usageMetadata"]);return o!=null&&p(t,["usageMetadata"],o),t}function _D(e,t){const r={},n=d(t,["name"]);return n!=null&&p(r,["_url","name"],lo(e,n)),r}function SD(e,t){const r={},n=d(t,["name"]);return n!=null&&p(r,["_url","name"],lo(e,n)),r}function kD(e){const t={};if(d(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=d(e,["enableWidget"]);return r!=null&&p(t,["enableWidget"],r),t}function CD(e){const t={};if(d(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=d(e,["timeRangeFilter"]);return r!=null&&p(t,["timeRangeFilter"],r),t}function ND(e){const t={},r=d(e,["aspectRatio"]);r!=null&&p(t,["aspectRatio"],r);const n=d(e,["imageSize"]);if(n!=null&&p(t,["imageSize"],n),d(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(d(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function AD(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["request","model"],ut(e,n));const i=d(t,["contents"]);if(i!=null){let o=An(i);Array.isArray(o)&&(o=o.map(c=>EE(c))),p(r,["request","contents"],o)}const s=d(t,["metadata"]);s!=null&&p(r,["metadata"],s);const a=d(t,["config"]);return a!=null&&p(r,["request","generationConfig"],ED(e,a,d(r,["request"],{}))),r}function bD(e){const t={},r=d(e,["response"]);r!=null&&p(t,["response"],TD(r));const n=d(e,["error"]);return n!=null&&p(t,["error"],n),t}function ID(e,t){const r={},n=d(e,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const i=d(e,["pageToken"]);if(t!==void 0&&i!=null&&p(t,["_query","pageToken"],i),d(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return r}function FD(e,t){const r={},n=d(e,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const i=d(e,["pageToken"]);t!==void 0&&i!=null&&p(t,["_query","pageToken"],i);const s=d(e,["filter"]);return t!==void 0&&s!=null&&p(t,["_query","filter"],s),r}function RD(e){const t={},r=d(e,["config"]);return r!=null&&ID(r,t),t}function PD(e){const t={},r=d(e,["config"]);return r!=null&&FD(r,t),t}function MD(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["nextPageToken"]);n!=null&&p(t,["nextPageToken"],n);const i=d(e,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>$c(a))),p(t,["batchJobs"],s)}return t}function DD(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["nextPageToken"]);n!=null&&p(t,["nextPageToken"],n);const i=d(e,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>_0(a))),p(t,["batchJobs"],s)}return t}function LD(e){const t={},r=d(e,["mediaResolution"]);r!=null&&p(t,["mediaResolution"],r);const n=d(e,["codeExecutionResult"]);n!=null&&p(t,["codeExecutionResult"],n);const i=d(e,["executableCode"]);i!=null&&p(t,["executableCode"],i);const s=d(e,["fileData"]);s!=null&&p(t,["fileData"],vD(s));const a=d(e,["functionCall"]);a!=null&&p(t,["functionCall"],yD(a));const o=d(e,["functionResponse"]);o!=null&&p(t,["functionResponse"],o);const c=d(e,["inlineData"]);c!=null&&p(t,["inlineData"],tD(c));const l=d(e,["text"]);l!=null&&p(t,["text"],l);const u=d(e,["thought"]);u!=null&&p(t,["thought"],u);const h=d(e,["thoughtSignature"]);h!=null&&p(t,["thoughtSignature"],h);const m=d(e,["videoMetadata"]);return m!=null&&p(t,["videoMetadata"],m),t}function OD(e){const t={},r=d(e,["category"]);if(r!=null&&p(t,["category"],r),d(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=d(e,["threshold"]);return n!=null&&p(t,["threshold"],n),t}function UD(e){const t={},r=d(e,["functionCallingConfig"]);r!=null&&p(t,["functionCallingConfig"],wD(r));const n=d(e,["retrievalConfig"]);return n!=null&&p(t,["retrievalConfig"],n),t}function BD(e){const t={},r=d(e,["functionDeclarations"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(h=>h)),p(t,["functionDeclarations"],u)}if(d(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(e,["googleSearchRetrieval"]);n!=null&&p(t,["googleSearchRetrieval"],n);const i=d(e,["computerUse"]);i!=null&&p(t,["computerUse"],i);const s=d(e,["fileSearch"]);s!=null&&p(t,["fileSearch"],s);const a=d(e,["codeExecution"]);if(a!=null&&p(t,["codeExecution"],a),d(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=d(e,["googleMaps"]);o!=null&&p(t,["googleMaps"],kD(o));const c=d(e,["googleSearch"]);c!=null&&p(t,["googleSearch"],CD(c));const l=d(e,["urlContext"]);return l!=null&&p(t,["urlContext"],l),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ci;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"})(Ci||(Ci={}));class ta{constructor(t,r,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=r,this.init(t,n,i)}init(t,r,n){var i,s;this.nameInternal=t,this.pageInternal=r[this.nameInternal]||[],this.sdkHttpResponseInternal=r==null?void 0:r.sdkHttpResponse,this.idxInternal=0;let a={config:{}};!n||Object.keys(n).length===0?a={config:{}}:typeof n=="object"?a=Object.assign({},n):a=n,a.config&&(a.config.pageToken=r.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(s=(i=a.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $D extends Fi{constructor(t){super(),this.apiClient=t,this.create=async r=>(this.apiClient.isVertexAI()&&(r.config=this.formatDestination(r.src,r.config)),this.createInternal(r)),this.createEmbeddings=async r=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(r)},this.list=async(r={})=>new ta(Ci.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(r),r)}createInlinedGenerateContentRequest(t){const r=g1(this.apiClient,t),n=r._url,i=Le("{model}:batchGenerateContent",n),o=r.batch.inputConfig.requests,c=o.requests,l=[];for(const u of c){const h=Object.assign({},u);if(h.systemInstruction){const m=h.systemInstruction;delete h.systemInstruction;const x=h.request;x.systemInstruction=m,h.request=x}l.push(h)}return o.requests=l,delete r.config,delete r._url,delete r._query,{path:i,body:r}}getGcsUri(t){if(typeof t=="string")return t.startsWith("gs://")?t:void 0;if(!Array.isArray(t)&&t.gcsUri&&t.gcsUri.length>0)return t.gcsUri[0]}getBigqueryUri(t){if(typeof t=="string")return t.startsWith("bq://")?t:void 0;if(!Array.isArray(t))return t.bigqueryUri}formatDestination(t,r){const n=r?Object.assign({},r):{},i=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${i}`),n.dest===void 0){const s=this.getGcsUri(t),a=this.getBigqueryUri(t);if(s)s.endsWith(".jsonl")?n.dest=`${s.slice(0,-6)}/dest`:n.dest=`${s}_dest_${i}`;else if(a)n.dest=`${a}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=lD(this.apiClient,t);return o=Le("batchPredictionJobs",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>_0(u))}else{const l=g1(this.apiClient,t);return o=Le("{model}:batchGenerateContent",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),a.then(u=>$c(u))}}async createEmbeddingsInternal(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=uD(this.apiClient,t);return s=Le("{model}:asyncBatchEmbedContent",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>$c(c))}}async get(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=SD(this.apiClient,t);return o=Le("batchPredictionJobs/{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>_0(u))}else{const l=_D(this.apiClient,t);return o=Le("batches/{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),a.then(u=>$c(u))}}async cancel(t){var r,n,i,s;let a="",o={};if(this.apiClient.isVertexAI()){const c=nD(this.apiClient,t);a=Le("batchPredictionJobs/{name}:cancel",c._url),o=c._query,delete c._url,delete c._query,await this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal})}else{const c=rD(this.apiClient,t);a=Le("batches/{name}:cancel",c._url),o=c._query,delete c._url,delete c._query,await this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=PD(t);return o=Le("batchPredictionJobs",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=DD(u),m=new h1;return Object.assign(m,h),m})}else{const l=RD(t);return o=Le("batches",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=MD(u),m=new h1;return Object.assign(m,h),m})}}async delete(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=dD(this.apiClient,t);return o=Le("batchPredictionJobs/{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>pD(u))}else{const l=fD(this.apiClient,t);return o=Le("batches/{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>hD(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jD(e){const t={},r=d(e,["data"]);if(r!=null&&p(t,["data"],r),d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function v1(e){const t={},r=d(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>u6(s))),p(t,["parts"],i)}const n=d(e,["role"]);return n!=null&&p(t,["role"],n),t}function GD(e,t){const r={},n=d(e,["ttl"]);t!==void 0&&n!=null&&p(t,["ttl"],n);const i=d(e,["expireTime"]);t!==void 0&&i!=null&&p(t,["expireTime"],i);const s=d(e,["displayName"]);t!==void 0&&s!=null&&p(t,["displayName"],s);const a=d(e,["contents"]);if(t!==void 0&&a!=null){let u=An(a);Array.isArray(u)&&(u=u.map(h=>v1(h))),p(t,["contents"],u)}const o=d(e,["systemInstruction"]);t!==void 0&&o!=null&&p(t,["systemInstruction"],v1(br(o)));const c=d(e,["tools"]);if(t!==void 0&&c!=null){let u=c;Array.isArray(u)&&(u=u.map(h=>d6(h))),p(t,["tools"],u)}const l=d(e,["toolConfig"]);if(t!==void 0&&l!=null&&p(t,["toolConfig"],f6(l)),d(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return r}function VD(e,t){const r={},n=d(e,["ttl"]);t!==void 0&&n!=null&&p(t,["ttl"],n);const i=d(e,["expireTime"]);t!==void 0&&i!=null&&p(t,["expireTime"],i);const s=d(e,["displayName"]);t!==void 0&&s!=null&&p(t,["displayName"],s);const a=d(e,["contents"]);if(t!==void 0&&a!=null){let h=An(a);Array.isArray(h)&&(h=h.map(m=>m)),p(t,["contents"],h)}const o=d(e,["systemInstruction"]);t!==void 0&&o!=null&&p(t,["systemInstruction"],br(o));const c=d(e,["tools"]);if(t!==void 0&&c!=null){let h=c;Array.isArray(h)&&(h=h.map(m=>h6(m))),p(t,["tools"],h)}const l=d(e,["toolConfig"]);t!==void 0&&l!=null&&p(t,["toolConfig"],l);const u=d(e,["kmsKeyName"]);return t!==void 0&&u!=null&&p(t,["encryption_spec","kmsKeyName"],u),r}function HD(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["model"],cE(e,n));const i=d(t,["config"]);return i!=null&&GD(i,r),r}function zD(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["model"],cE(e,n));const i=d(t,["config"]);return i!=null&&VD(i,r),r}function WD(e,t){const r={},n=d(t,["name"]);return n!=null&&p(r,["_url","name"],Ri(e,n)),r}function qD(e,t){const r={},n=d(t,["name"]);return n!=null&&p(r,["_url","name"],Ri(e,n)),r}function JD(e){const t={},r=d(e,["sdkHttpResponse"]);return r!=null&&p(t,["sdkHttpResponse"],r),t}function KD(e){const t={},r=d(e,["sdkHttpResponse"]);return r!=null&&p(t,["sdkHttpResponse"],r),t}function YD(e){const t={};if(d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(e,["fileUri"]);r!=null&&p(t,["fileUri"],r);const n=d(e,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function XD(e){const t={},r=d(e,["id"]);r!=null&&p(t,["id"],r);const n=d(e,["args"]);n!=null&&p(t,["args"],n);const i=d(e,["name"]);if(i!=null&&p(t,["name"],i),d(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function QD(e){const t={},r=d(e,["mode"]);r!=null&&p(t,["mode"],r);const n=d(e,["allowedFunctionNames"]);if(n!=null&&p(t,["allowedFunctionNames"],n),d(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function ZD(e){const t={};if(d(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=d(e,["description"]);r!=null&&p(t,["description"],r);const n=d(e,["name"]);n!=null&&p(t,["name"],n);const i=d(e,["parameters"]);i!=null&&p(t,["parameters"],i);const s=d(e,["parametersJsonSchema"]);s!=null&&p(t,["parametersJsonSchema"],s);const a=d(e,["response"]);a!=null&&p(t,["response"],a);const o=d(e,["responseJsonSchema"]);return o!=null&&p(t,["responseJsonSchema"],o),t}function e6(e,t){const r={},n=d(t,["name"]);return n!=null&&p(r,["_url","name"],Ri(e,n)),r}function t6(e,t){const r={},n=d(t,["name"]);return n!=null&&p(r,["_url","name"],Ri(e,n)),r}function r6(e){const t={};if(d(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=d(e,["enableWidget"]);return r!=null&&p(t,["enableWidget"],r),t}function n6(e){const t={};if(d(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=d(e,["timeRangeFilter"]);return r!=null&&p(t,["timeRangeFilter"],r),t}function i6(e,t){const r={},n=d(e,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const i=d(e,["pageToken"]);return t!==void 0&&i!=null&&p(t,["_query","pageToken"],i),r}function s6(e,t){const r={},n=d(e,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const i=d(e,["pageToken"]);return t!==void 0&&i!=null&&p(t,["_query","pageToken"],i),r}function a6(e){const t={},r=d(e,["config"]);return r!=null&&i6(r,t),t}function o6(e){const t={},r=d(e,["config"]);return r!=null&&s6(r,t),t}function l6(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["nextPageToken"]);n!=null&&p(t,["nextPageToken"],n);const i=d(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["cachedContents"],s)}return t}function c6(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["nextPageToken"]);n!=null&&p(t,["nextPageToken"],n);const i=d(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["cachedContents"],s)}return t}function u6(e){const t={},r=d(e,["mediaResolution"]);r!=null&&p(t,["mediaResolution"],r);const n=d(e,["codeExecutionResult"]);n!=null&&p(t,["codeExecutionResult"],n);const i=d(e,["executableCode"]);i!=null&&p(t,["executableCode"],i);const s=d(e,["fileData"]);s!=null&&p(t,["fileData"],YD(s));const a=d(e,["functionCall"]);a!=null&&p(t,["functionCall"],XD(a));const o=d(e,["functionResponse"]);o!=null&&p(t,["functionResponse"],o);const c=d(e,["inlineData"]);c!=null&&p(t,["inlineData"],jD(c));const l=d(e,["text"]);l!=null&&p(t,["text"],l);const u=d(e,["thought"]);u!=null&&p(t,["thought"],u);const h=d(e,["thoughtSignature"]);h!=null&&p(t,["thoughtSignature"],h);const m=d(e,["videoMetadata"]);return m!=null&&p(t,["videoMetadata"],m),t}function f6(e){const t={},r=d(e,["functionCallingConfig"]);r!=null&&p(t,["functionCallingConfig"],QD(r));const n=d(e,["retrievalConfig"]);return n!=null&&p(t,["retrievalConfig"],n),t}function d6(e){const t={},r=d(e,["functionDeclarations"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(h=>h)),p(t,["functionDeclarations"],u)}if(d(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(e,["googleSearchRetrieval"]);n!=null&&p(t,["googleSearchRetrieval"],n);const i=d(e,["computerUse"]);i!=null&&p(t,["computerUse"],i);const s=d(e,["fileSearch"]);s!=null&&p(t,["fileSearch"],s);const a=d(e,["codeExecution"]);if(a!=null&&p(t,["codeExecution"],a),d(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=d(e,["googleMaps"]);o!=null&&p(t,["googleMaps"],r6(o));const c=d(e,["googleSearch"]);c!=null&&p(t,["googleSearch"],n6(c));const l=d(e,["urlContext"]);return l!=null&&p(t,["urlContext"],l),t}function h6(e){const t={},r=d(e,["functionDeclarations"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(m=>ZD(m))),p(t,["functionDeclarations"],h)}const n=d(e,["retrieval"]);n!=null&&p(t,["retrieval"],n);const i=d(e,["googleSearchRetrieval"]);i!=null&&p(t,["googleSearchRetrieval"],i);const s=d(e,["computerUse"]);if(s!=null&&p(t,["computerUse"],s),d(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=d(e,["codeExecution"]);a!=null&&p(t,["codeExecution"],a);const o=d(e,["enterpriseWebSearch"]);o!=null&&p(t,["enterpriseWebSearch"],o);const c=d(e,["googleMaps"]);c!=null&&p(t,["googleMaps"],c);const l=d(e,["googleSearch"]);l!=null&&p(t,["googleSearch"],l);const u=d(e,["urlContext"]);return u!=null&&p(t,["urlContext"],u),t}function p6(e,t){const r={},n=d(e,["ttl"]);t!==void 0&&n!=null&&p(t,["ttl"],n);const i=d(e,["expireTime"]);return t!==void 0&&i!=null&&p(t,["expireTime"],i),r}function m6(e,t){const r={},n=d(e,["ttl"]);t!==void 0&&n!=null&&p(t,["ttl"],n);const i=d(e,["expireTime"]);return t!==void 0&&i!=null&&p(t,["expireTime"],i),r}function x6(e,t){const r={},n=d(t,["name"]);n!=null&&p(r,["_url","name"],Ri(e,n));const i=d(t,["config"]);return i!=null&&p6(i,r),r}function g6(e,t){const r={},n=d(t,["name"]);n!=null&&p(r,["_url","name"],Ri(e,n));const i=d(t,["config"]);return i!=null&&m6(i,r),r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class v6 extends Fi{constructor(t){super(),this.apiClient=t,this.list=async(r={})=>new ta(Ci.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(r),r)}async create(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=zD(this.apiClient,t);return o=Le("cachedContents",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>u)}else{const l=HD(this.apiClient,t);return o=Le("cachedContents",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),a.then(u=>u)}}async get(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=t6(this.apiClient,t);return o=Le("{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>u)}else{const l=e6(this.apiClient,t);return o=Le("{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),a.then(u=>u)}}async delete(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=qD(this.apiClient,t);return o=Le("{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=KD(u),m=new f1;return Object.assign(m,h),m})}else{const l=WD(this.apiClient,t);return o=Le("{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=JD(u),m=new f1;return Object.assign(m,h),m})}}async update(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=g6(this.apiClient,t);return o=Le("{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"PATCH",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>u)}else{const l=x6(this.apiClient,t);return o=Le("{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),a.then(u=>u)}}async listInternal(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=o6(t);return o=Le("cachedContents",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=c6(u),m=new d1;return Object.assign(m,h),m})}else{const l=a6(t);return o=Le("cachedContents",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=l6(u),m=new d1;return Object.assign(m,h),m})}}}function y1(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function kt(e){return this instanceof kt?(this.v=e,this):new kt(e)}function $a(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(x){return function(g){return Promise.resolve(g).then(x,h)}}function o(x,g){n[x]&&(i[x]=function(v){return new Promise(function(y,E){s.push([x,v,y,E])>1||c(x,v)})},g&&(i[x]=g(i[x])))}function c(x,g){try{l(n[x](g))}catch(v){m(s[0][3],v)}}function l(x){x.value instanceof kt?Promise.resolve(x.value.v).then(u,h):m(s[0][2],x)}function u(x){c("next",x)}function h(x){c("throw",x)}function m(x,g){x(g),s.shift(),s.length&&c(s[0][0],s[0][1])}}function tl(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof y1=="function"?y1(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(a){return new Promise(function(o,c){a=e[s](a),i(o,c,a.done,a.value)})}}function i(s,a,o,c){Promise.resolve(c).then(function(l){s({value:l,done:o})},a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function y6(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const r=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return r===void 0?!1:TE(r)}function TE(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0)return!1;return!0}function w6(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function w1(e){if(e===void 0||e.length===0)return[];const t=[],r=e.length;let n=0;for(;n<r;)if(e[n].role==="user")t.push(e[n]),n++;else{const i=[];let s=!0;for(;n<r&&e[n].role==="model";)i.push(e[n]),s&&!TE(e[n])&&(s=!1),n++;s?t.push(...i):t.pop()}return t}class E6{constructor(t,r){this.modelsModule=t,this.apiClient=r}create(t){return new T6(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class T6{constructor(t,r,n,i={},s=[]){this.apiClient=t,this.modelsModule=r,this.model=n,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),w6(s)}async sendMessage(t){var r;await this.sendPromise;const n=br(t.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(r=t.config)!==null&&r!==void 0?r:this.config});return this.sendPromise=(async()=>{var s,a,o;const c=await i,l=(a=(s=c.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content,u=c.automaticFunctionCallingHistory,h=this.getHistory(!0).length;let m=[];u!=null&&(m=(o=u.slice(h))!==null&&o!==void 0?o:[]);const x=l?[l]:[];this.recordHistory(n,x,m)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(t){var r;await this.sendPromise;const n=br(t.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(r=t.config)!==null&&r!==void 0?r:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,n)}getHistory(t=!1){const r=t?w1(this.history):this.history;return structuredClone(r)}processStreamResponse(t,r){var n,i;return $a(this,arguments,function*(){var a,o,c,l;const u=[];try{for(var h=!0,m=tl(t),x;x=yield kt(m.next()),a=x.done,!a;h=!0){l=x.value,h=!1;const g=l;if(y6(g)){const v=(i=(n=g.candidates)===null||n===void 0?void 0:n[0])===null||i===void 0?void 0:i.content;v!==void 0&&u.push(v)}yield yield kt(g)}}catch(g){o={error:g}}finally{try{!h&&!a&&(c=m.return)&&(yield kt(c.call(m)))}finally{if(o)throw o.error}}this.recordHistory(r,u)})}recordHistory(t,r,n){let i=[];r.length>0&&r.every(s=>s.role!==void 0)?i=r:i.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...w1(n)):this.history.push(t),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sf extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,sf.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _6(e){const t={},r=d(e,["file"]);return r!=null&&p(t,["file"],r),t}function S6(e){const t={},r=d(e,["sdkHttpResponse"]);return r!=null&&p(t,["sdkHttpResponse"],r),t}function k6(e){const t={},r=d(e,["name"]);return r!=null&&p(t,["_url","file"],mE(r)),t}function C6(e){const t={},r=d(e,["sdkHttpResponse"]);return r!=null&&p(t,["sdkHttpResponse"],r),t}function N6(e){const t={},r=d(e,["name"]);return r!=null&&p(t,["_url","file"],mE(r)),t}function A6(e,t){const r={},n=d(e,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const i=d(e,["pageToken"]);return t!==void 0&&i!=null&&p(t,["_query","pageToken"],i),r}function b6(e){const t={},r=d(e,["config"]);return r!=null&&A6(r,t),t}function I6(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["nextPageToken"]);n!=null&&p(t,["nextPageToken"],n);const i=d(e,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["files"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class F6 extends Fi{constructor(t){super(),this.apiClient=t,this.list=async(r={})=>new ta(Ci.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(r),r)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(r=>r)}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=b6(t);return s=Le("files",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json().then(l=>{const u=l;return u.sdkHttpResponse={headers:c.headers},u})),i.then(c=>{const l=I6(c),u=new D5;return Object.assign(u,l),u})}}async createInternal(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=_6(t);return s=Le("upload/v1beta/files",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>{const l=S6(c),u=new L5;return Object.assign(u,l),u})}}async get(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=N6(t);return s=Le("files/{file}",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>c)}}async delete(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=k6(t);return s=Le("files/{file}",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json().then(l=>{const u=l;return u.sdkHttpResponse={headers:c.headers},u})),i.then(c=>{const l=C6(c),u=new O5;return Object.assign(u,l),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jc(e){const t={},r=d(e,["data"]);if(r!=null&&p(t,["data"],r),d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function R6(e){const t={},r=d(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>J6(s))),p(t,["parts"],i)}const n=d(e,["role"]);return n!=null&&p(t,["role"],n),t}function P6(e){const t={};if(d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(e,["fileUri"]);r!=null&&p(t,["fileUri"],r);const n=d(e,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function M6(e){const t={},r=d(e,["id"]);r!=null&&p(t,["id"],r);const n=d(e,["args"]);n!=null&&p(t,["args"],n);const i=d(e,["name"]);if(i!=null&&p(t,["name"],i),d(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function D6(e){const t={};if(d(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=d(e,["description"]);r!=null&&p(t,["description"],r);const n=d(e,["name"]);n!=null&&p(t,["name"],n);const i=d(e,["parameters"]);i!=null&&p(t,["parameters"],i);const s=d(e,["parametersJsonSchema"]);s!=null&&p(t,["parametersJsonSchema"],s);const a=d(e,["response"]);a!=null&&p(t,["response"],a);const o=d(e,["responseJsonSchema"]);return o!=null&&p(t,["responseJsonSchema"],o),t}function L6(e){const t={},r=d(e,["modelSelectionConfig"]);r!=null&&p(t,["modelConfig"],r);const n=d(e,["responseJsonSchema"]);n!=null&&p(t,["responseJsonSchema"],n);const i=d(e,["audioTimestamp"]);i!=null&&p(t,["audioTimestamp"],i);const s=d(e,["candidateCount"]);s!=null&&p(t,["candidateCount"],s);const a=d(e,["enableAffectiveDialog"]);a!=null&&p(t,["enableAffectiveDialog"],a);const o=d(e,["frequencyPenalty"]);o!=null&&p(t,["frequencyPenalty"],o);const c=d(e,["logprobs"]);c!=null&&p(t,["logprobs"],c);const l=d(e,["maxOutputTokens"]);l!=null&&p(t,["maxOutputTokens"],l);const u=d(e,["mediaResolution"]);u!=null&&p(t,["mediaResolution"],u);const h=d(e,["presencePenalty"]);h!=null&&p(t,["presencePenalty"],h);const m=d(e,["responseLogprobs"]);m!=null&&p(t,["responseLogprobs"],m);const x=d(e,["responseMimeType"]);x!=null&&p(t,["responseMimeType"],x);const g=d(e,["responseModalities"]);g!=null&&p(t,["responseModalities"],g);const v=d(e,["responseSchema"]);v!=null&&p(t,["responseSchema"],v);const y=d(e,["routingConfig"]);y!=null&&p(t,["routingConfig"],y);const E=d(e,["seed"]);E!=null&&p(t,["seed"],E);const w=d(e,["speechConfig"]);w!=null&&p(t,["speechConfig"],_E(w));const T=d(e,["stopSequences"]);T!=null&&p(t,["stopSequences"],T);const k=d(e,["temperature"]);k!=null&&p(t,["temperature"],k);const b=d(e,["thinkingConfig"]);b!=null&&p(t,["thinkingConfig"],b);const I=d(e,["topK"]);I!=null&&p(t,["topK"],I);const S=d(e,["topP"]);if(S!=null&&p(t,["topP"],S),d(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function O6(e){const t={};if(d(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=d(e,["enableWidget"]);return r!=null&&p(t,["enableWidget"],r),t}function U6(e){const t={};if(d(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=d(e,["timeRangeFilter"]);return r!=null&&p(t,["timeRangeFilter"],r),t}function B6(e,t){const r={},n=d(e,["generationConfig"]);t!==void 0&&n!=null&&p(t,["setup","generationConfig"],n);const i=d(e,["responseModalities"]);t!==void 0&&i!=null&&p(t,["setup","generationConfig","responseModalities"],i);const s=d(e,["temperature"]);t!==void 0&&s!=null&&p(t,["setup","generationConfig","temperature"],s);const a=d(e,["topP"]);t!==void 0&&a!=null&&p(t,["setup","generationConfig","topP"],a);const o=d(e,["topK"]);t!==void 0&&o!=null&&p(t,["setup","generationConfig","topK"],o);const c=d(e,["maxOutputTokens"]);t!==void 0&&c!=null&&p(t,["setup","generationConfig","maxOutputTokens"],c);const l=d(e,["mediaResolution"]);t!==void 0&&l!=null&&p(t,["setup","generationConfig","mediaResolution"],l);const u=d(e,["seed"]);t!==void 0&&u!=null&&p(t,["setup","generationConfig","seed"],u);const h=d(e,["speechConfig"]);t!==void 0&&h!=null&&p(t,["setup","generationConfig","speechConfig"],vp(h));const m=d(e,["thinkingConfig"]);t!==void 0&&m!=null&&p(t,["setup","generationConfig","thinkingConfig"],m);const x=d(e,["enableAffectiveDialog"]);t!==void 0&&x!=null&&p(t,["setup","generationConfig","enableAffectiveDialog"],x);const g=d(e,["systemInstruction"]);t!==void 0&&g!=null&&p(t,["setup","systemInstruction"],R6(br(g)));const v=d(e,["tools"]);if(t!==void 0&&v!=null){let I=oo(v);Array.isArray(I)&&(I=I.map(S=>Y6(ao(S)))),p(t,["setup","tools"],I)}const y=d(e,["sessionResumption"]);t!==void 0&&y!=null&&p(t,["setup","sessionResumption"],K6(y));const E=d(e,["inputAudioTranscription"]);t!==void 0&&E!=null&&p(t,["setup","inputAudioTranscription"],E);const w=d(e,["outputAudioTranscription"]);t!==void 0&&w!=null&&p(t,["setup","outputAudioTranscription"],w);const T=d(e,["realtimeInputConfig"]);t!==void 0&&T!=null&&p(t,["setup","realtimeInputConfig"],T);const k=d(e,["contextWindowCompression"]);t!==void 0&&k!=null&&p(t,["setup","contextWindowCompression"],k);const b=d(e,["proactivity"]);return t!==void 0&&b!=null&&p(t,["setup","proactivity"],b),r}function $6(e,t){const r={},n=d(e,["generationConfig"]);t!==void 0&&n!=null&&p(t,["setup","generationConfig"],L6(n));const i=d(e,["responseModalities"]);t!==void 0&&i!=null&&p(t,["setup","generationConfig","responseModalities"],i);const s=d(e,["temperature"]);t!==void 0&&s!=null&&p(t,["setup","generationConfig","temperature"],s);const a=d(e,["topP"]);t!==void 0&&a!=null&&p(t,["setup","generationConfig","topP"],a);const o=d(e,["topK"]);t!==void 0&&o!=null&&p(t,["setup","generationConfig","topK"],o);const c=d(e,["maxOutputTokens"]);t!==void 0&&c!=null&&p(t,["setup","generationConfig","maxOutputTokens"],c);const l=d(e,["mediaResolution"]);t!==void 0&&l!=null&&p(t,["setup","generationConfig","mediaResolution"],l);const u=d(e,["seed"]);t!==void 0&&u!=null&&p(t,["setup","generationConfig","seed"],u);const h=d(e,["speechConfig"]);t!==void 0&&h!=null&&p(t,["setup","generationConfig","speechConfig"],_E(vp(h)));const m=d(e,["thinkingConfig"]);t!==void 0&&m!=null&&p(t,["setup","generationConfig","thinkingConfig"],m);const x=d(e,["enableAffectiveDialog"]);t!==void 0&&x!=null&&p(t,["setup","generationConfig","enableAffectiveDialog"],x);const g=d(e,["systemInstruction"]);t!==void 0&&g!=null&&p(t,["setup","systemInstruction"],br(g));const v=d(e,["tools"]);if(t!==void 0&&v!=null){let I=oo(v);Array.isArray(I)&&(I=I.map(S=>X6(ao(S)))),p(t,["setup","tools"],I)}const y=d(e,["sessionResumption"]);t!==void 0&&y!=null&&p(t,["setup","sessionResumption"],y);const E=d(e,["inputAudioTranscription"]);t!==void 0&&E!=null&&p(t,["setup","inputAudioTranscription"],E);const w=d(e,["outputAudioTranscription"]);t!==void 0&&w!=null&&p(t,["setup","outputAudioTranscription"],w);const T=d(e,["realtimeInputConfig"]);t!==void 0&&T!=null&&p(t,["setup","realtimeInputConfig"],T);const k=d(e,["contextWindowCompression"]);t!==void 0&&k!=null&&p(t,["setup","contextWindowCompression"],k);const b=d(e,["proactivity"]);return t!==void 0&&b!=null&&p(t,["setup","proactivity"],b),r}function j6(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["setup","model"],ut(e,n));const i=d(t,["config"]);return i!=null&&p(r,["config"],B6(i,r)),r}function G6(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["setup","model"],ut(e,n));const i=d(t,["config"]);return i!=null&&p(r,["config"],$6(i,r)),r}function V6(e){const t={},r=d(e,["musicGenerationConfig"]);return r!=null&&p(t,["musicGenerationConfig"],r),t}function H6(e){const t={},r=d(e,["weightedPrompts"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(i=>i)),p(t,["weightedPrompts"],n)}return t}function z6(e){const t={},r=d(e,["media"]);if(r!=null){let l=uE(r);Array.isArray(l)&&(l=l.map(u=>jc(u))),p(t,["mediaChunks"],l)}const n=d(e,["audio"]);n!=null&&p(t,["audio"],jc(dE(n)));const i=d(e,["audioStreamEnd"]);i!=null&&p(t,["audioStreamEnd"],i);const s=d(e,["video"]);s!=null&&p(t,["video"],jc(fE(s)));const a=d(e,["text"]);a!=null&&p(t,["text"],a);const o=d(e,["activityStart"]);o!=null&&p(t,["activityStart"],o);const c=d(e,["activityEnd"]);return c!=null&&p(t,["activityEnd"],c),t}function W6(e){const t={},r=d(e,["media"]);if(r!=null){let l=uE(r);Array.isArray(l)&&(l=l.map(u=>u)),p(t,["mediaChunks"],l)}const n=d(e,["audio"]);n!=null&&p(t,["audio"],dE(n));const i=d(e,["audioStreamEnd"]);i!=null&&p(t,["audioStreamEnd"],i);const s=d(e,["video"]);s!=null&&p(t,["video"],fE(s));const a=d(e,["text"]);a!=null&&p(t,["text"],a);const o=d(e,["activityStart"]);o!=null&&p(t,["activityStart"],o);const c=d(e,["activityEnd"]);return c!=null&&p(t,["activityEnd"],c),t}function q6(e){const t={},r=d(e,["setupComplete"]);r!=null&&p(t,["setupComplete"],r);const n=d(e,["serverContent"]);n!=null&&p(t,["serverContent"],n);const i=d(e,["toolCall"]);i!=null&&p(t,["toolCall"],i);const s=d(e,["toolCallCancellation"]);s!=null&&p(t,["toolCallCancellation"],s);const a=d(e,["usageMetadata"]);a!=null&&p(t,["usageMetadata"],Q6(a));const o=d(e,["goAway"]);o!=null&&p(t,["goAway"],o);const c=d(e,["sessionResumptionUpdate"]);return c!=null&&p(t,["sessionResumptionUpdate"],c),t}function J6(e){const t={},r=d(e,["mediaResolution"]);r!=null&&p(t,["mediaResolution"],r);const n=d(e,["codeExecutionResult"]);n!=null&&p(t,["codeExecutionResult"],n);const i=d(e,["executableCode"]);i!=null&&p(t,["executableCode"],i);const s=d(e,["fileData"]);s!=null&&p(t,["fileData"],P6(s));const a=d(e,["functionCall"]);a!=null&&p(t,["functionCall"],M6(a));const o=d(e,["functionResponse"]);o!=null&&p(t,["functionResponse"],o);const c=d(e,["inlineData"]);c!=null&&p(t,["inlineData"],jc(c));const l=d(e,["text"]);l!=null&&p(t,["text"],l);const u=d(e,["thought"]);u!=null&&p(t,["thought"],u);const h=d(e,["thoughtSignature"]);h!=null&&p(t,["thoughtSignature"],h);const m=d(e,["videoMetadata"]);return m!=null&&p(t,["videoMetadata"],m),t}function K6(e){const t={},r=d(e,["handle"]);if(r!=null&&p(t,["handle"],r),d(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function _E(e){const t={},r=d(e,["languageCode"]);r!=null&&p(t,["languageCode"],r);const n=d(e,["voiceConfig"]);if(n!=null&&p(t,["voiceConfig"],n),d(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function Y6(e){const t={},r=d(e,["functionDeclarations"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(h=>h)),p(t,["functionDeclarations"],u)}if(d(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(e,["googleSearchRetrieval"]);n!=null&&p(t,["googleSearchRetrieval"],n);const i=d(e,["computerUse"]);i!=null&&p(t,["computerUse"],i);const s=d(e,["fileSearch"]);s!=null&&p(t,["fileSearch"],s);const a=d(e,["codeExecution"]);if(a!=null&&p(t,["codeExecution"],a),d(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=d(e,["googleMaps"]);o!=null&&p(t,["googleMaps"],O6(o));const c=d(e,["googleSearch"]);c!=null&&p(t,["googleSearch"],U6(c));const l=d(e,["urlContext"]);return l!=null&&p(t,["urlContext"],l),t}function X6(e){const t={},r=d(e,["functionDeclarations"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(m=>D6(m))),p(t,["functionDeclarations"],h)}const n=d(e,["retrieval"]);n!=null&&p(t,["retrieval"],n);const i=d(e,["googleSearchRetrieval"]);i!=null&&p(t,["googleSearchRetrieval"],i);const s=d(e,["computerUse"]);if(s!=null&&p(t,["computerUse"],s),d(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=d(e,["codeExecution"]);a!=null&&p(t,["codeExecution"],a);const o=d(e,["enterpriseWebSearch"]);o!=null&&p(t,["enterpriseWebSearch"],o);const c=d(e,["googleMaps"]);c!=null&&p(t,["googleMaps"],c);const l=d(e,["googleSearch"]);l!=null&&p(t,["googleSearch"],l);const u=d(e,["urlContext"]);return u!=null&&p(t,["urlContext"],u),t}function Q6(e){const t={},r=d(e,["promptTokenCount"]);r!=null&&p(t,["promptTokenCount"],r);const n=d(e,["cachedContentTokenCount"]);n!=null&&p(t,["cachedContentTokenCount"],n);const i=d(e,["candidatesTokenCount"]);i!=null&&p(t,["responseTokenCount"],i);const s=d(e,["toolUsePromptTokenCount"]);s!=null&&p(t,["toolUsePromptTokenCount"],s);const a=d(e,["thoughtsTokenCount"]);a!=null&&p(t,["thoughtsTokenCount"],a);const o=d(e,["totalTokenCount"]);o!=null&&p(t,["totalTokenCount"],o);const c=d(e,["promptTokensDetails"]);if(c!=null){let x=c;Array.isArray(x)&&(x=x.map(g=>g)),p(t,["promptTokensDetails"],x)}const l=d(e,["cacheTokensDetails"]);if(l!=null){let x=l;Array.isArray(x)&&(x=x.map(g=>g)),p(t,["cacheTokensDetails"],x)}const u=d(e,["candidatesTokensDetails"]);if(u!=null){let x=u;Array.isArray(x)&&(x=x.map(g=>g)),p(t,["responseTokensDetails"],x)}const h=d(e,["toolUsePromptTokensDetails"]);if(h!=null){let x=h;Array.isArray(x)&&(x=x.map(g=>g)),p(t,["toolUsePromptTokensDetails"],x)}const m=d(e,["trafficType"]);return m!=null&&p(t,["trafficType"],m),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Z6(e){const t={},r=d(e,["data"]);if(r!=null&&p(t,["data"],r),d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function eL(e){const t={},r=d(e,["content"]);r!=null&&p(t,["content"],r);const n=d(e,["citationMetadata"]);n!=null&&p(t,["citationMetadata"],tL(n));const i=d(e,["tokenCount"]);i!=null&&p(t,["tokenCount"],i);const s=d(e,["finishReason"]);s!=null&&p(t,["finishReason"],s);const a=d(e,["avgLogprobs"]);a!=null&&p(t,["avgLogprobs"],a);const o=d(e,["groundingMetadata"]);o!=null&&p(t,["groundingMetadata"],o);const c=d(e,["index"]);c!=null&&p(t,["index"],c);const l=d(e,["logprobsResult"]);l!=null&&p(t,["logprobsResult"],l);const u=d(e,["safetyRatings"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(x=>x)),p(t,["safetyRatings"],m)}const h=d(e,["urlContextMetadata"]);return h!=null&&p(t,["urlContextMetadata"],h),t}function tL(e){const t={},r=d(e,["citationSources"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(i=>i)),p(t,["citations"],n)}return t}function rL(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["contents"]);if(i!=null){let s=An(i);Array.isArray(s)&&(s=s.map(a=>a)),p(r,["contents"],s)}return r}function nL(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["tokensInfo"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>s)),p(t,["tokensInfo"],i)}return t}function iL(e){const t={},r=d(e,["values"]);r!=null&&p(t,["values"],r);const n=d(e,["statistics"]);return n!=null&&p(t,["statistics"],sL(n)),t}function sL(e){const t={},r=d(e,["truncated"]);r!=null&&p(t,["truncated"],r);const n=d(e,["token_count"]);return n!=null&&p(t,["tokenCount"],n),t}function af(e){const t={},r=d(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>p8(s))),p(t,["parts"],i)}const n=d(e,["role"]);return n!=null&&p(t,["role"],n),t}function aL(e){const t={},r=d(e,["controlType"]);r!=null&&p(t,["controlType"],r);const n=d(e,["enableControlImageComputation"]);return n!=null&&p(t,["computeControl"],n),t}function oL(e){const t={};if(d(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function lL(e,t){const r={},n=d(e,["systemInstruction"]);t!==void 0&&n!=null&&p(t,["systemInstruction"],br(n));const i=d(e,["tools"]);if(t!==void 0&&i!=null){let a=i;Array.isArray(a)&&(a=a.map(o=>AE(o))),p(t,["tools"],a)}const s=d(e,["generationConfig"]);return t!==void 0&&s!=null&&p(t,["generationConfig"],ZL(s)),r}function cL(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["contents"]);if(i!=null){let a=An(i);Array.isArray(a)&&(a=a.map(o=>af(o))),p(r,["contents"],a)}const s=d(t,["config"]);return s!=null&&oL(s),r}function uL(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["contents"]);if(i!=null){let a=An(i);Array.isArray(a)&&(a=a.map(o=>o)),p(r,["contents"],a)}const s=d(t,["config"]);return s!=null&&lL(s,r),r}function fL(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["totalTokens"]);n!=null&&p(t,["totalTokens"],n);const i=d(e,["cachedContentTokenCount"]);return i!=null&&p(t,["cachedContentTokenCount"],i),t}function dL(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["totalTokens"]);return n!=null&&p(t,["totalTokens"],n),t}function hL(e,t){const r={},n=d(t,["model"]);return n!=null&&p(r,["_url","name"],ut(e,n)),r}function pL(e,t){const r={},n=d(t,["model"]);return n!=null&&p(r,["_url","name"],ut(e,n)),r}function mL(e){const t={},r=d(e,["sdkHttpResponse"]);return r!=null&&p(t,["sdkHttpResponse"],r),t}function xL(e){const t={},r=d(e,["sdkHttpResponse"]);return r!=null&&p(t,["sdkHttpResponse"],r),t}function gL(e,t){const r={},n=d(e,["outputGcsUri"]);t!==void 0&&n!=null&&p(t,["parameters","storageUri"],n);const i=d(e,["negativePrompt"]);t!==void 0&&i!=null&&p(t,["parameters","negativePrompt"],i);const s=d(e,["numberOfImages"]);t!==void 0&&s!=null&&p(t,["parameters","sampleCount"],s);const a=d(e,["aspectRatio"]);t!==void 0&&a!=null&&p(t,["parameters","aspectRatio"],a);const o=d(e,["guidanceScale"]);t!==void 0&&o!=null&&p(t,["parameters","guidanceScale"],o);const c=d(e,["seed"]);t!==void 0&&c!=null&&p(t,["parameters","seed"],c);const l=d(e,["safetyFilterLevel"]);t!==void 0&&l!=null&&p(t,["parameters","safetySetting"],l);const u=d(e,["personGeneration"]);t!==void 0&&u!=null&&p(t,["parameters","personGeneration"],u);const h=d(e,["includeSafetyAttributes"]);t!==void 0&&h!=null&&p(t,["parameters","includeSafetyAttributes"],h);const m=d(e,["includeRaiReason"]);t!==void 0&&m!=null&&p(t,["parameters","includeRaiReason"],m);const x=d(e,["language"]);t!==void 0&&x!=null&&p(t,["parameters","language"],x);const g=d(e,["outputMimeType"]);t!==void 0&&g!=null&&p(t,["parameters","outputOptions","mimeType"],g);const v=d(e,["outputCompressionQuality"]);t!==void 0&&v!=null&&p(t,["parameters","outputOptions","compressionQuality"],v);const y=d(e,["addWatermark"]);t!==void 0&&y!=null&&p(t,["parameters","addWatermark"],y);const E=d(e,["labels"]);t!==void 0&&E!=null&&p(t,["labels"],E);const w=d(e,["editMode"]);t!==void 0&&w!=null&&p(t,["parameters","editMode"],w);const T=d(e,["baseSteps"]);return t!==void 0&&T!=null&&p(t,["parameters","editConfig","baseSteps"],T),r}function vL(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["prompt"]);i!=null&&p(r,["instances[0]","prompt"],i);const s=d(t,["referenceImages"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(c=>w8(c))),p(r,["instances[0]","referenceImages"],o)}const a=d(t,["config"]);return a!=null&&gL(a,r),r}function yL(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>of(s))),p(t,["generatedImages"],i)}return t}function wL(e,t){const r={},n=d(e,["taskType"]);t!==void 0&&n!=null&&p(t,["requests[]","taskType"],n);const i=d(e,["title"]);t!==void 0&&i!=null&&p(t,["requests[]","title"],i);const s=d(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&p(t,["requests[]","outputDimensionality"],s),d(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function EL(e,t){const r={},n=d(e,["taskType"]);t!==void 0&&n!=null&&p(t,["instances[]","task_type"],n);const i=d(e,["title"]);t!==void 0&&i!=null&&p(t,["instances[]","title"],i);const s=d(e,["outputDimensionality"]);t!==void 0&&s!=null&&p(t,["parameters","outputDimensionality"],s);const a=d(e,["mimeType"]);t!==void 0&&a!=null&&p(t,["instances[]","mimeType"],a);const o=d(e,["autoTruncate"]);return t!==void 0&&o!=null&&p(t,["parameters","autoTruncate"],o),r}function TL(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["contents"]);if(i!=null){let o=mp(e,i);Array.isArray(o)&&(o=o.map(c=>c)),p(r,["requests[]","content"],o)}const s=d(t,["config"]);s!=null&&wL(s,r);const a=d(t,["model"]);return a!==void 0&&p(r,["requests[]","model"],ut(e,a)),r}function _L(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["contents"]);if(i!=null){let a=mp(e,i);Array.isArray(a)&&(a=a.map(o=>o)),p(r,["instances[]","content"],a)}const s=d(t,["config"]);return s!=null&&EL(s,r),r}function SL(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["embeddings"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["embeddings"],s)}const i=d(e,["metadata"]);return i!=null&&p(t,["metadata"],i),t}function kL(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["predictions[]","embeddings"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>iL(a))),p(t,["embeddings"],s)}const i=d(e,["metadata"]);return i!=null&&p(t,["metadata"],i),t}function CL(e){const t={},r=d(e,["endpoint"]);r!=null&&p(t,["name"],r);const n=d(e,["deployedModelId"]);return n!=null&&p(t,["deployedModelId"],n),t}function NL(e){const t={};if(d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(e,["fileUri"]);r!=null&&p(t,["fileUri"],r);const n=d(e,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function AL(e){const t={},r=d(e,["id"]);r!=null&&p(t,["id"],r);const n=d(e,["args"]);n!=null&&p(t,["args"],n);const i=d(e,["name"]);if(i!=null&&p(t,["name"],i),d(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function bL(e){const t={},r=d(e,["mode"]);r!=null&&p(t,["mode"],r);const n=d(e,["allowedFunctionNames"]);if(n!=null&&p(t,["allowedFunctionNames"],n),d(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function IL(e){const t={};if(d(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=d(e,["description"]);r!=null&&p(t,["description"],r);const n=d(e,["name"]);n!=null&&p(t,["name"],n);const i=d(e,["parameters"]);i!=null&&p(t,["parameters"],i);const s=d(e,["parametersJsonSchema"]);s!=null&&p(t,["parametersJsonSchema"],s);const a=d(e,["response"]);a!=null&&p(t,["response"],a);const o=d(e,["responseJsonSchema"]);return o!=null&&p(t,["responseJsonSchema"],o),t}function FL(e,t,r){const n={},i=d(t,["systemInstruction"]);r!==void 0&&i!=null&&p(r,["systemInstruction"],af(br(i)));const s=d(t,["temperature"]);s!=null&&p(n,["temperature"],s);const a=d(t,["topP"]);a!=null&&p(n,["topP"],a);const o=d(t,["topK"]);o!=null&&p(n,["topK"],o);const c=d(t,["candidateCount"]);c!=null&&p(n,["candidateCount"],c);const l=d(t,["maxOutputTokens"]);l!=null&&p(n,["maxOutputTokens"],l);const u=d(t,["stopSequences"]);u!=null&&p(n,["stopSequences"],u);const h=d(t,["responseLogprobs"]);h!=null&&p(n,["responseLogprobs"],h);const m=d(t,["logprobs"]);m!=null&&p(n,["logprobs"],m);const x=d(t,["presencePenalty"]);x!=null&&p(n,["presencePenalty"],x);const g=d(t,["frequencyPenalty"]);g!=null&&p(n,["frequencyPenalty"],g);const v=d(t,["seed"]);v!=null&&p(n,["seed"],v);const y=d(t,["responseMimeType"]);y!=null&&p(n,["responseMimeType"],y);const E=d(t,["responseSchema"]);E!=null&&p(n,["responseSchema"],xp(E));const w=d(t,["responseJsonSchema"]);if(w!=null&&p(n,["responseJsonSchema"],w),d(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const T=d(t,["safetySettings"]);if(r!==void 0&&T!=null){let q=T;Array.isArray(q)&&(q=q.map(ue=>E8(ue))),p(r,["safetySettings"],q)}const k=d(t,["tools"]);if(r!==void 0&&k!=null){let q=oo(k);Array.isArray(q)&&(q=q.map(ue=>A8(ao(ue)))),p(r,["tools"],q)}const b=d(t,["toolConfig"]);if(r!==void 0&&b!=null&&p(r,["toolConfig"],N8(b)),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const I=d(t,["cachedContent"]);r!==void 0&&I!=null&&p(r,["cachedContent"],Ri(e,I));const S=d(t,["responseModalities"]);S!=null&&p(n,["responseModalities"],S);const B=d(t,["mediaResolution"]);B!=null&&p(n,["mediaResolution"],B);const D=d(t,["speechConfig"]);if(D!=null&&p(n,["speechConfig"],gp(D)),d(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const H=d(t,["thinkingConfig"]);H!=null&&p(n,["thinkingConfig"],H);const Y=d(t,["imageConfig"]);return Y!=null&&p(n,["imageConfig"],i8(Y)),n}function RL(e,t,r){const n={},i=d(t,["systemInstruction"]);r!==void 0&&i!=null&&p(r,["systemInstruction"],br(i));const s=d(t,["temperature"]);s!=null&&p(n,["temperature"],s);const a=d(t,["topP"]);a!=null&&p(n,["topP"],a);const o=d(t,["topK"]);o!=null&&p(n,["topK"],o);const c=d(t,["candidateCount"]);c!=null&&p(n,["candidateCount"],c);const l=d(t,["maxOutputTokens"]);l!=null&&p(n,["maxOutputTokens"],l);const u=d(t,["stopSequences"]);u!=null&&p(n,["stopSequences"],u);const h=d(t,["responseLogprobs"]);h!=null&&p(n,["responseLogprobs"],h);const m=d(t,["logprobs"]);m!=null&&p(n,["logprobs"],m);const x=d(t,["presencePenalty"]);x!=null&&p(n,["presencePenalty"],x);const g=d(t,["frequencyPenalty"]);g!=null&&p(n,["frequencyPenalty"],g);const v=d(t,["seed"]);v!=null&&p(n,["seed"],v);const y=d(t,["responseMimeType"]);y!=null&&p(n,["responseMimeType"],y);const E=d(t,["responseSchema"]);E!=null&&p(n,["responseSchema"],xp(E));const w=d(t,["responseJsonSchema"]);w!=null&&p(n,["responseJsonSchema"],w);const T=d(t,["routingConfig"]);T!=null&&p(n,["routingConfig"],T);const k=d(t,["modelSelectionConfig"]);k!=null&&p(n,["modelConfig"],k);const b=d(t,["safetySettings"]);if(r!==void 0&&b!=null){let te=b;Array.isArray(te)&&(te=te.map(ge=>ge)),p(r,["safetySettings"],te)}const I=d(t,["tools"]);if(r!==void 0&&I!=null){let te=oo(I);Array.isArray(te)&&(te=te.map(ge=>AE(ao(ge)))),p(r,["tools"],te)}const S=d(t,["toolConfig"]);r!==void 0&&S!=null&&p(r,["toolConfig"],S);const B=d(t,["labels"]);r!==void 0&&B!=null&&p(r,["labels"],B);const D=d(t,["cachedContent"]);r!==void 0&&D!=null&&p(r,["cachedContent"],Ri(e,D));const H=d(t,["responseModalities"]);H!=null&&p(n,["responseModalities"],H);const Y=d(t,["mediaResolution"]);Y!=null&&p(n,["mediaResolution"],Y);const q=d(t,["speechConfig"]);q!=null&&p(n,["speechConfig"],NE(gp(q)));const ue=d(t,["audioTimestamp"]);ue!=null&&p(n,["audioTimestamp"],ue);const Te=d(t,["thinkingConfig"]);Te!=null&&p(n,["thinkingConfig"],Te);const W=d(t,["imageConfig"]);return W!=null&&p(n,["imageConfig"],s8(W)),n}function E1(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["contents"]);if(i!=null){let a=An(i);Array.isArray(a)&&(a=a.map(o=>af(o))),p(r,["contents"],a)}const s=d(t,["config"]);return s!=null&&p(r,["generationConfig"],FL(e,s,r)),r}function T1(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["contents"]);if(i!=null){let a=An(i);Array.isArray(a)&&(a=a.map(o=>o)),p(r,["contents"],a)}const s=d(t,["config"]);return s!=null&&p(r,["generationConfig"],RL(e,s,r)),r}function _1(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["candidates"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(l=>eL(l))),p(t,["candidates"],c)}const i=d(e,["modelVersion"]);i!=null&&p(t,["modelVersion"],i);const s=d(e,["promptFeedback"]);s!=null&&p(t,["promptFeedback"],s);const a=d(e,["responseId"]);a!=null&&p(t,["responseId"],a);const o=d(e,["usageMetadata"]);return o!=null&&p(t,["usageMetadata"],o),t}function S1(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["candidates"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>u)),p(t,["candidates"],l)}const i=d(e,["createTime"]);i!=null&&p(t,["createTime"],i);const s=d(e,["modelVersion"]);s!=null&&p(t,["modelVersion"],s);const a=d(e,["promptFeedback"]);a!=null&&p(t,["promptFeedback"],a);const o=d(e,["responseId"]);o!=null&&p(t,["responseId"],o);const c=d(e,["usageMetadata"]);return c!=null&&p(t,["usageMetadata"],c),t}function PL(e,t){const r={};if(d(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=d(e,["numberOfImages"]);t!==void 0&&n!=null&&p(t,["parameters","sampleCount"],n);const i=d(e,["aspectRatio"]);t!==void 0&&i!=null&&p(t,["parameters","aspectRatio"],i);const s=d(e,["guidanceScale"]);if(t!==void 0&&s!=null&&p(t,["parameters","guidanceScale"],s),d(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=d(e,["safetyFilterLevel"]);t!==void 0&&a!=null&&p(t,["parameters","safetySetting"],a);const o=d(e,["personGeneration"]);t!==void 0&&o!=null&&p(t,["parameters","personGeneration"],o);const c=d(e,["includeSafetyAttributes"]);t!==void 0&&c!=null&&p(t,["parameters","includeSafetyAttributes"],c);const l=d(e,["includeRaiReason"]);t!==void 0&&l!=null&&p(t,["parameters","includeRaiReason"],l);const u=d(e,["language"]);t!==void 0&&u!=null&&p(t,["parameters","language"],u);const h=d(e,["outputMimeType"]);t!==void 0&&h!=null&&p(t,["parameters","outputOptions","mimeType"],h);const m=d(e,["outputCompressionQuality"]);if(t!==void 0&&m!=null&&p(t,["parameters","outputOptions","compressionQuality"],m),d(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const x=d(e,["imageSize"]);if(t!==void 0&&x!=null&&p(t,["parameters","sampleImageSize"],x),d(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function ML(e,t){const r={},n=d(e,["outputGcsUri"]);t!==void 0&&n!=null&&p(t,["parameters","storageUri"],n);const i=d(e,["negativePrompt"]);t!==void 0&&i!=null&&p(t,["parameters","negativePrompt"],i);const s=d(e,["numberOfImages"]);t!==void 0&&s!=null&&p(t,["parameters","sampleCount"],s);const a=d(e,["aspectRatio"]);t!==void 0&&a!=null&&p(t,["parameters","aspectRatio"],a);const o=d(e,["guidanceScale"]);t!==void 0&&o!=null&&p(t,["parameters","guidanceScale"],o);const c=d(e,["seed"]);t!==void 0&&c!=null&&p(t,["parameters","seed"],c);const l=d(e,["safetyFilterLevel"]);t!==void 0&&l!=null&&p(t,["parameters","safetySetting"],l);const u=d(e,["personGeneration"]);t!==void 0&&u!=null&&p(t,["parameters","personGeneration"],u);const h=d(e,["includeSafetyAttributes"]);t!==void 0&&h!=null&&p(t,["parameters","includeSafetyAttributes"],h);const m=d(e,["includeRaiReason"]);t!==void 0&&m!=null&&p(t,["parameters","includeRaiReason"],m);const x=d(e,["language"]);t!==void 0&&x!=null&&p(t,["parameters","language"],x);const g=d(e,["outputMimeType"]);t!==void 0&&g!=null&&p(t,["parameters","outputOptions","mimeType"],g);const v=d(e,["outputCompressionQuality"]);t!==void 0&&v!=null&&p(t,["parameters","outputOptions","compressionQuality"],v);const y=d(e,["addWatermark"]);t!==void 0&&y!=null&&p(t,["parameters","addWatermark"],y);const E=d(e,["labels"]);t!==void 0&&E!=null&&p(t,["labels"],E);const w=d(e,["imageSize"]);t!==void 0&&w!=null&&p(t,["parameters","sampleImageSize"],w);const T=d(e,["enhancePrompt"]);return t!==void 0&&T!=null&&p(t,["parameters","enhancePrompt"],T),r}function DL(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["prompt"]);i!=null&&p(r,["instances[0]","prompt"],i);const s=d(t,["config"]);return s!=null&&PL(s,r),r}function LL(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["prompt"]);i!=null&&p(r,["instances[0]","prompt"],i);const s=d(t,["config"]);return s!=null&&ML(s,r),r}function OL(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>KL(a))),p(t,["generatedImages"],s)}const i=d(e,["positivePromptSafetyAttributes"]);return i!=null&&p(t,["positivePromptSafetyAttributes"],kE(i)),t}function UL(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>of(a))),p(t,["generatedImages"],s)}const i=d(e,["positivePromptSafetyAttributes"]);return i!=null&&p(t,["positivePromptSafetyAttributes"],CE(i)),t}function BL(e,t){const r={},n=d(e,["numberOfVideos"]);if(t!==void 0&&n!=null&&p(t,["parameters","sampleCount"],n),d(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=d(e,["durationSeconds"]);if(t!==void 0&&i!=null&&p(t,["parameters","durationSeconds"],i),d(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=d(e,["aspectRatio"]);t!==void 0&&s!=null&&p(t,["parameters","aspectRatio"],s);const a=d(e,["resolution"]);t!==void 0&&a!=null&&p(t,["parameters","resolution"],a);const o=d(e,["personGeneration"]);if(t!==void 0&&o!=null&&p(t,["parameters","personGeneration"],o),d(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=d(e,["negativePrompt"]);t!==void 0&&c!=null&&p(t,["parameters","negativePrompt"],c);const l=d(e,["enhancePrompt"]);if(t!==void 0&&l!=null&&p(t,["parameters","enhancePrompt"],l),d(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const u=d(e,["lastFrame"]);t!==void 0&&u!=null&&p(t,["instances[0]","lastFrame"],lf(u));const h=d(e,["referenceImages"]);if(t!==void 0&&h!=null){let m=h;Array.isArray(m)&&(m=m.map(x=>j8(x))),p(t,["instances[0]","referenceImages"],m)}if(d(e,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(d(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return r}function $L(e,t){const r={},n=d(e,["numberOfVideos"]);t!==void 0&&n!=null&&p(t,["parameters","sampleCount"],n);const i=d(e,["outputGcsUri"]);t!==void 0&&i!=null&&p(t,["parameters","storageUri"],i);const s=d(e,["fps"]);t!==void 0&&s!=null&&p(t,["parameters","fps"],s);const a=d(e,["durationSeconds"]);t!==void 0&&a!=null&&p(t,["parameters","durationSeconds"],a);const o=d(e,["seed"]);t!==void 0&&o!=null&&p(t,["parameters","seed"],o);const c=d(e,["aspectRatio"]);t!==void 0&&c!=null&&p(t,["parameters","aspectRatio"],c);const l=d(e,["resolution"]);t!==void 0&&l!=null&&p(t,["parameters","resolution"],l);const u=d(e,["personGeneration"]);t!==void 0&&u!=null&&p(t,["parameters","personGeneration"],u);const h=d(e,["pubsubTopic"]);t!==void 0&&h!=null&&p(t,["parameters","pubsubTopic"],h);const m=d(e,["negativePrompt"]);t!==void 0&&m!=null&&p(t,["parameters","negativePrompt"],m);const x=d(e,["enhancePrompt"]);t!==void 0&&x!=null&&p(t,["parameters","enhancePrompt"],x);const g=d(e,["generateAudio"]);t!==void 0&&g!=null&&p(t,["parameters","generateAudio"],g);const v=d(e,["lastFrame"]);t!==void 0&&v!=null&&p(t,["instances[0]","lastFrame"],Jn(v));const y=d(e,["referenceImages"]);if(t!==void 0&&y!=null){let T=y;Array.isArray(T)&&(T=T.map(k=>G8(k))),p(t,["instances[0]","referenceImages"],T)}const E=d(e,["mask"]);t!==void 0&&E!=null&&p(t,["instances[0]","mask"],$8(E));const w=d(e,["compressionQuality"]);return t!==void 0&&w!=null&&p(t,["parameters","compressionQuality"],w),r}function jL(e){const t={},r=d(e,["name"]);r!=null&&p(t,["name"],r);const n=d(e,["metadata"]);n!=null&&p(t,["metadata"],n);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["response","generateVideoResponse"]);return a!=null&&p(t,["response"],zL(a)),t}function GL(e){const t={},r=d(e,["name"]);r!=null&&p(t,["name"],r);const n=d(e,["metadata"]);n!=null&&p(t,["metadata"],n);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["response"]);return a!=null&&p(t,["response"],WL(a)),t}function VL(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["prompt"]);i!=null&&p(r,["instances[0]","prompt"],i);const s=d(t,["image"]);s!=null&&p(r,["instances[0]","image"],lf(s));const a=d(t,["video"]);a!=null&&p(r,["instances[0]","video"],bE(a));const o=d(t,["source"]);o!=null&&qL(o,r);const c=d(t,["config"]);return c!=null&&BL(c,r),r}function HL(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["prompt"]);i!=null&&p(r,["instances[0]","prompt"],i);const s=d(t,["image"]);s!=null&&p(r,["instances[0]","image"],Jn(s));const a=d(t,["video"]);a!=null&&p(r,["instances[0]","video"],IE(a));const o=d(t,["source"]);o!=null&&JL(o,r);const c=d(t,["config"]);return c!=null&&$L(c,r),r}function zL(e){const t={},r=d(e,["generatedSamples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>XL(a))),p(t,["generatedVideos"],s)}const n=d(e,["raiMediaFilteredCount"]);n!=null&&p(t,["raiMediaFilteredCount"],n);const i=d(e,["raiMediaFilteredReasons"]);return i!=null&&p(t,["raiMediaFilteredReasons"],i),t}function WL(e){const t={},r=d(e,["videos"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>QL(a))),p(t,["generatedVideos"],s)}const n=d(e,["raiMediaFilteredCount"]);n!=null&&p(t,["raiMediaFilteredCount"],n);const i=d(e,["raiMediaFilteredReasons"]);return i!=null&&p(t,["raiMediaFilteredReasons"],i),t}function qL(e,t){const r={},n=d(e,["prompt"]);t!==void 0&&n!=null&&p(t,["instances[0]","prompt"],n);const i=d(e,["image"]);t!==void 0&&i!=null&&p(t,["instances[0]","image"],lf(i));const s=d(e,["video"]);return t!==void 0&&s!=null&&p(t,["instances[0]","video"],bE(s)),r}function JL(e,t){const r={},n=d(e,["prompt"]);t!==void 0&&n!=null&&p(t,["instances[0]","prompt"],n);const i=d(e,["image"]);t!==void 0&&i!=null&&p(t,["instances[0]","image"],Jn(i));const s=d(e,["video"]);return t!==void 0&&s!=null&&p(t,["instances[0]","video"],IE(s)),r}function KL(e){const t={},r=d(e,["_self"]);r!=null&&p(t,["image"],a8(r));const n=d(e,["raiFilteredReason"]);n!=null&&p(t,["raiFilteredReason"],n);const i=d(e,["_self"]);return i!=null&&p(t,["safetyAttributes"],kE(i)),t}function of(e){const t={},r=d(e,["_self"]);r!=null&&p(t,["image"],SE(r));const n=d(e,["raiFilteredReason"]);n!=null&&p(t,["raiFilteredReason"],n);const i=d(e,["_self"]);i!=null&&p(t,["safetyAttributes"],CE(i));const s=d(e,["prompt"]);return s!=null&&p(t,["enhancedPrompt"],s),t}function YL(e){const t={},r=d(e,["_self"]);r!=null&&p(t,["mask"],SE(r));const n=d(e,["labels"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>s)),p(t,["labels"],i)}return t}function XL(e){const t={},r=d(e,["video"]);return r!=null&&p(t,["video"],U8(r)),t}function QL(e){const t={},r=d(e,["_self"]);return r!=null&&p(t,["video"],B8(r)),t}function ZL(e){const t={},r=d(e,["modelSelectionConfig"]);r!=null&&p(t,["modelConfig"],r);const n=d(e,["responseJsonSchema"]);n!=null&&p(t,["responseJsonSchema"],n);const i=d(e,["audioTimestamp"]);i!=null&&p(t,["audioTimestamp"],i);const s=d(e,["candidateCount"]);s!=null&&p(t,["candidateCount"],s);const a=d(e,["enableAffectiveDialog"]);a!=null&&p(t,["enableAffectiveDialog"],a);const o=d(e,["frequencyPenalty"]);o!=null&&p(t,["frequencyPenalty"],o);const c=d(e,["logprobs"]);c!=null&&p(t,["logprobs"],c);const l=d(e,["maxOutputTokens"]);l!=null&&p(t,["maxOutputTokens"],l);const u=d(e,["mediaResolution"]);u!=null&&p(t,["mediaResolution"],u);const h=d(e,["presencePenalty"]);h!=null&&p(t,["presencePenalty"],h);const m=d(e,["responseLogprobs"]);m!=null&&p(t,["responseLogprobs"],m);const x=d(e,["responseMimeType"]);x!=null&&p(t,["responseMimeType"],x);const g=d(e,["responseModalities"]);g!=null&&p(t,["responseModalities"],g);const v=d(e,["responseSchema"]);v!=null&&p(t,["responseSchema"],v);const y=d(e,["routingConfig"]);y!=null&&p(t,["routingConfig"],y);const E=d(e,["seed"]);E!=null&&p(t,["seed"],E);const w=d(e,["speechConfig"]);w!=null&&p(t,["speechConfig"],NE(w));const T=d(e,["stopSequences"]);T!=null&&p(t,["stopSequences"],T);const k=d(e,["temperature"]);k!=null&&p(t,["temperature"],k);const b=d(e,["thinkingConfig"]);b!=null&&p(t,["thinkingConfig"],b);const I=d(e,["topK"]);I!=null&&p(t,["topK"],I);const S=d(e,["topP"]);if(S!=null&&p(t,["topP"],S),d(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function e8(e,t){const r={},n=d(t,["model"]);return n!=null&&p(r,["_url","name"],ut(e,n)),r}function t8(e,t){const r={},n=d(t,["model"]);return n!=null&&p(r,["_url","name"],ut(e,n)),r}function r8(e){const t={};if(d(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=d(e,["enableWidget"]);return r!=null&&p(t,["enableWidget"],r),t}function n8(e){const t={};if(d(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=d(e,["timeRangeFilter"]);return r!=null&&p(t,["timeRangeFilter"],r),t}function i8(e){const t={},r=d(e,["aspectRatio"]);r!=null&&p(t,["aspectRatio"],r);const n=d(e,["imageSize"]);if(n!=null&&p(t,["imageSize"],n),d(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(d(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function s8(e){const t={},r=d(e,["aspectRatio"]);r!=null&&p(t,["aspectRatio"],r);const n=d(e,["imageSize"]);n!=null&&p(t,["imageSize"],n);const i=d(e,["outputMimeType"]);i!=null&&p(t,["imageOutputOptions","mimeType"],i);const s=d(e,["outputCompressionQuality"]);return s!=null&&p(t,["imageOutputOptions","compressionQuality"],s),t}function a8(e){const t={},r=d(e,["bytesBase64Encoded"]);r!=null&&p(t,["imageBytes"],ms(r));const n=d(e,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function SE(e){const t={},r=d(e,["gcsUri"]);r!=null&&p(t,["gcsUri"],r);const n=d(e,["bytesBase64Encoded"]);n!=null&&p(t,["imageBytes"],ms(n));const i=d(e,["mimeType"]);return i!=null&&p(t,["mimeType"],i),t}function lf(e){const t={};if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=d(e,["imageBytes"]);r!=null&&p(t,["bytesBase64Encoded"],ms(r));const n=d(e,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function Jn(e){const t={},r=d(e,["gcsUri"]);r!=null&&p(t,["gcsUri"],r);const n=d(e,["imageBytes"]);n!=null&&p(t,["bytesBase64Encoded"],ms(n));const i=d(e,["mimeType"]);return i!=null&&p(t,["mimeType"],i),t}function o8(e,t,r){const n={},i=d(t,["pageSize"]);r!==void 0&&i!=null&&p(r,["_query","pageSize"],i);const s=d(t,["pageToken"]);r!==void 0&&s!=null&&p(r,["_query","pageToken"],s);const a=d(t,["filter"]);r!==void 0&&a!=null&&p(r,["_query","filter"],a);const o=d(t,["queryBase"]);return r!==void 0&&o!=null&&p(r,["_url","models_url"],xE(e,o)),n}function l8(e,t,r){const n={},i=d(t,["pageSize"]);r!==void 0&&i!=null&&p(r,["_query","pageSize"],i);const s=d(t,["pageToken"]);r!==void 0&&s!=null&&p(r,["_query","pageToken"],s);const a=d(t,["filter"]);r!==void 0&&a!=null&&p(r,["_query","filter"],a);const o=d(t,["queryBase"]);return r!==void 0&&o!=null&&p(r,["_url","models_url"],xE(e,o)),n}function c8(e,t){const r={},n=d(t,["config"]);return n!=null&&o8(e,n,r),r}function u8(e,t){const r={},n=d(t,["config"]);return n!=null&&l8(e,n,r),r}function f8(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["nextPageToken"]);n!=null&&p(t,["nextPageToken"],n);const i=d(e,["_self"]);if(i!=null){let s=gE(i);Array.isArray(s)&&(s=s.map(a=>S0(a))),p(t,["models"],s)}return t}function d8(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["nextPageToken"]);n!=null&&p(t,["nextPageToken"],n);const i=d(e,["_self"]);if(i!=null){let s=gE(i);Array.isArray(s)&&(s=s.map(a=>k0(a))),p(t,["models"],s)}return t}function h8(e){const t={},r=d(e,["maskMode"]);r!=null&&p(t,["maskMode"],r);const n=d(e,["segmentationClasses"]);n!=null&&p(t,["maskClasses"],n);const i=d(e,["maskDilation"]);return i!=null&&p(t,["dilation"],i),t}function S0(e){const t={},r=d(e,["name"]);r!=null&&p(t,["name"],r);const n=d(e,["displayName"]);n!=null&&p(t,["displayName"],n);const i=d(e,["description"]);i!=null&&p(t,["description"],i);const s=d(e,["version"]);s!=null&&p(t,["version"],s);const a=d(e,["_self"]);a!=null&&p(t,["tunedModelInfo"],b8(a));const o=d(e,["inputTokenLimit"]);o!=null&&p(t,["inputTokenLimit"],o);const c=d(e,["outputTokenLimit"]);c!=null&&p(t,["outputTokenLimit"],c);const l=d(e,["supportedGenerationMethods"]);l!=null&&p(t,["supportedActions"],l);const u=d(e,["temperature"]);u!=null&&p(t,["temperature"],u);const h=d(e,["maxTemperature"]);h!=null&&p(t,["maxTemperature"],h);const m=d(e,["topP"]);m!=null&&p(t,["topP"],m);const x=d(e,["topK"]);x!=null&&p(t,["topK"],x);const g=d(e,["thinking"]);return g!=null&&p(t,["thinking"],g),t}function k0(e){const t={},r=d(e,["name"]);r!=null&&p(t,["name"],r);const n=d(e,["displayName"]);n!=null&&p(t,["displayName"],n);const i=d(e,["description"]);i!=null&&p(t,["description"],i);const s=d(e,["versionId"]);s!=null&&p(t,["version"],s);const a=d(e,["deployedModels"]);if(a!=null){let h=a;Array.isArray(h)&&(h=h.map(m=>CL(m))),p(t,["endpoints"],h)}const o=d(e,["labels"]);o!=null&&p(t,["labels"],o);const c=d(e,["_self"]);c!=null&&p(t,["tunedModelInfo"],I8(c));const l=d(e,["defaultCheckpointId"]);l!=null&&p(t,["defaultCheckpointId"],l);const u=d(e,["checkpoints"]);if(u!=null){let h=u;Array.isArray(h)&&(h=h.map(m=>m)),p(t,["checkpoints"],h)}return t}function p8(e){const t={},r=d(e,["mediaResolution"]);r!=null&&p(t,["mediaResolution"],r);const n=d(e,["codeExecutionResult"]);n!=null&&p(t,["codeExecutionResult"],n);const i=d(e,["executableCode"]);i!=null&&p(t,["executableCode"],i);const s=d(e,["fileData"]);s!=null&&p(t,["fileData"],NL(s));const a=d(e,["functionCall"]);a!=null&&p(t,["functionCall"],AL(a));const o=d(e,["functionResponse"]);o!=null&&p(t,["functionResponse"],o);const c=d(e,["inlineData"]);c!=null&&p(t,["inlineData"],Z6(c));const l=d(e,["text"]);l!=null&&p(t,["text"],l);const u=d(e,["thought"]);u!=null&&p(t,["thought"],u);const h=d(e,["thoughtSignature"]);h!=null&&p(t,["thoughtSignature"],h);const m=d(e,["videoMetadata"]);return m!=null&&p(t,["videoMetadata"],m),t}function m8(e){const t={},r=d(e,["productImage"]);return r!=null&&p(t,["image"],Jn(r)),t}function x8(e,t){const r={},n=d(e,["numberOfImages"]);t!==void 0&&n!=null&&p(t,["parameters","sampleCount"],n);const i=d(e,["baseSteps"]);t!==void 0&&i!=null&&p(t,["parameters","baseSteps"],i);const s=d(e,["outputGcsUri"]);t!==void 0&&s!=null&&p(t,["parameters","storageUri"],s);const a=d(e,["seed"]);t!==void 0&&a!=null&&p(t,["parameters","seed"],a);const o=d(e,["safetyFilterLevel"]);t!==void 0&&o!=null&&p(t,["parameters","safetySetting"],o);const c=d(e,["personGeneration"]);t!==void 0&&c!=null&&p(t,["parameters","personGeneration"],c);const l=d(e,["addWatermark"]);t!==void 0&&l!=null&&p(t,["parameters","addWatermark"],l);const u=d(e,["outputMimeType"]);t!==void 0&&u!=null&&p(t,["parameters","outputOptions","mimeType"],u);const h=d(e,["outputCompressionQuality"]);t!==void 0&&h!=null&&p(t,["parameters","outputOptions","compressionQuality"],h);const m=d(e,["enhancePrompt"]);t!==void 0&&m!=null&&p(t,["parameters","enhancePrompt"],m);const x=d(e,["labels"]);return t!==void 0&&x!=null&&p(t,["labels"],x),r}function g8(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["source"]);i!=null&&y8(i,r);const s=d(t,["config"]);return s!=null&&x8(s,r),r}function v8(e){const t={},r=d(e,["predictions"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(i=>of(i))),p(t,["generatedImages"],n)}return t}function y8(e,t){const r={},n=d(e,["prompt"]);t!==void 0&&n!=null&&p(t,["instances[0]","prompt"],n);const i=d(e,["personImage"]);t!==void 0&&i!=null&&p(t,["instances[0]","personImage","image"],Jn(i));const s=d(e,["productImages"]);if(t!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>m8(o))),p(t,["instances[0]","productImages"],a)}return r}function w8(e){const t={},r=d(e,["referenceImage"]);r!=null&&p(t,["referenceImage"],Jn(r));const n=d(e,["referenceId"]);n!=null&&p(t,["referenceId"],n);const i=d(e,["referenceType"]);i!=null&&p(t,["referenceType"],i);const s=d(e,["maskImageConfig"]);s!=null&&p(t,["maskImageConfig"],h8(s));const a=d(e,["controlImageConfig"]);a!=null&&p(t,["controlImageConfig"],aL(a));const o=d(e,["styleImageConfig"]);o!=null&&p(t,["styleImageConfig"],o);const c=d(e,["subjectImageConfig"]);return c!=null&&p(t,["subjectImageConfig"],c),t}function kE(e){const t={},r=d(e,["safetyAttributes","categories"]);r!=null&&p(t,["categories"],r);const n=d(e,["safetyAttributes","scores"]);n!=null&&p(t,["scores"],n);const i=d(e,["contentType"]);return i!=null&&p(t,["contentType"],i),t}function CE(e){const t={},r=d(e,["safetyAttributes","categories"]);r!=null&&p(t,["categories"],r);const n=d(e,["safetyAttributes","scores"]);n!=null&&p(t,["scores"],n);const i=d(e,["contentType"]);return i!=null&&p(t,["contentType"],i),t}function E8(e){const t={},r=d(e,["category"]);if(r!=null&&p(t,["category"],r),d(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=d(e,["threshold"]);return n!=null&&p(t,["threshold"],n),t}function T8(e){const t={},r=d(e,["image"]);return r!=null&&p(t,["image"],Jn(r)),t}function _8(e,t){const r={},n=d(e,["mode"]);t!==void 0&&n!=null&&p(t,["parameters","mode"],n);const i=d(e,["maxPredictions"]);t!==void 0&&i!=null&&p(t,["parameters","maxPredictions"],i);const s=d(e,["confidenceThreshold"]);t!==void 0&&s!=null&&p(t,["parameters","confidenceThreshold"],s);const a=d(e,["maskDilation"]);t!==void 0&&a!=null&&p(t,["parameters","maskDilation"],a);const o=d(e,["binaryColorThreshold"]);t!==void 0&&o!=null&&p(t,["parameters","binaryColorThreshold"],o);const c=d(e,["labels"]);return t!==void 0&&c!=null&&p(t,["labels"],c),r}function S8(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["source"]);i!=null&&C8(i,r);const s=d(t,["config"]);return s!=null&&_8(s,r),r}function k8(e){const t={},r=d(e,["predictions"]);if(r!=null){let n=r;Array.isArray(n)&&(n=n.map(i=>YL(i))),p(t,["generatedMasks"],n)}return t}function C8(e,t){const r={},n=d(e,["prompt"]);t!==void 0&&n!=null&&p(t,["instances[0]","prompt"],n);const i=d(e,["image"]);t!==void 0&&i!=null&&p(t,["instances[0]","image"],Jn(i));const s=d(e,["scribbleImage"]);return t!==void 0&&s!=null&&p(t,["instances[0]","scribble"],T8(s)),r}function NE(e){const t={},r=d(e,["languageCode"]);r!=null&&p(t,["languageCode"],r);const n=d(e,["voiceConfig"]);if(n!=null&&p(t,["voiceConfig"],n),d(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function N8(e){const t={},r=d(e,["functionCallingConfig"]);r!=null&&p(t,["functionCallingConfig"],bL(r));const n=d(e,["retrievalConfig"]);return n!=null&&p(t,["retrievalConfig"],n),t}function A8(e){const t={},r=d(e,["functionDeclarations"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(h=>h)),p(t,["functionDeclarations"],u)}if(d(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(e,["googleSearchRetrieval"]);n!=null&&p(t,["googleSearchRetrieval"],n);const i=d(e,["computerUse"]);i!=null&&p(t,["computerUse"],i);const s=d(e,["fileSearch"]);s!=null&&p(t,["fileSearch"],s);const a=d(e,["codeExecution"]);if(a!=null&&p(t,["codeExecution"],a),d(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=d(e,["googleMaps"]);o!=null&&p(t,["googleMaps"],r8(o));const c=d(e,["googleSearch"]);c!=null&&p(t,["googleSearch"],n8(c));const l=d(e,["urlContext"]);return l!=null&&p(t,["urlContext"],l),t}function AE(e){const t={},r=d(e,["functionDeclarations"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(m=>IL(m))),p(t,["functionDeclarations"],h)}const n=d(e,["retrieval"]);n!=null&&p(t,["retrieval"],n);const i=d(e,["googleSearchRetrieval"]);i!=null&&p(t,["googleSearchRetrieval"],i);const s=d(e,["computerUse"]);if(s!=null&&p(t,["computerUse"],s),d(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=d(e,["codeExecution"]);a!=null&&p(t,["codeExecution"],a);const o=d(e,["enterpriseWebSearch"]);o!=null&&p(t,["enterpriseWebSearch"],o);const c=d(e,["googleMaps"]);c!=null&&p(t,["googleMaps"],c);const l=d(e,["googleSearch"]);l!=null&&p(t,["googleSearch"],l);const u=d(e,["urlContext"]);return u!=null&&p(t,["urlContext"],u),t}function b8(e){const t={},r=d(e,["baseModel"]);r!=null&&p(t,["baseModel"],r);const n=d(e,["createTime"]);n!=null&&p(t,["createTime"],n);const i=d(e,["updateTime"]);return i!=null&&p(t,["updateTime"],i),t}function I8(e){const t={},r=d(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&p(t,["baseModel"],r);const n=d(e,["createTime"]);n!=null&&p(t,["createTime"],n);const i=d(e,["updateTime"]);return i!=null&&p(t,["updateTime"],i),t}function F8(e,t){const r={},n=d(e,["displayName"]);t!==void 0&&n!=null&&p(t,["displayName"],n);const i=d(e,["description"]);t!==void 0&&i!=null&&p(t,["description"],i);const s=d(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&p(t,["defaultCheckpointId"],s),r}function R8(e,t){const r={},n=d(e,["displayName"]);t!==void 0&&n!=null&&p(t,["displayName"],n);const i=d(e,["description"]);t!==void 0&&i!=null&&p(t,["description"],i);const s=d(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&p(t,["defaultCheckpointId"],s),r}function P8(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","name"],ut(e,n));const i=d(t,["config"]);return i!=null&&F8(i,r),r}function M8(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["config"]);return i!=null&&R8(i,r),r}function D8(e,t){const r={},n=d(e,["outputGcsUri"]);t!==void 0&&n!=null&&p(t,["parameters","storageUri"],n);const i=d(e,["safetyFilterLevel"]);t!==void 0&&i!=null&&p(t,["parameters","safetySetting"],i);const s=d(e,["personGeneration"]);t!==void 0&&s!=null&&p(t,["parameters","personGeneration"],s);const a=d(e,["includeRaiReason"]);t!==void 0&&a!=null&&p(t,["parameters","includeRaiReason"],a);const o=d(e,["outputMimeType"]);t!==void 0&&o!=null&&p(t,["parameters","outputOptions","mimeType"],o);const c=d(e,["outputCompressionQuality"]);t!==void 0&&c!=null&&p(t,["parameters","outputOptions","compressionQuality"],c);const l=d(e,["enhanceInputImage"]);t!==void 0&&l!=null&&p(t,["parameters","upscaleConfig","enhanceInputImage"],l);const u=d(e,["imagePreservationFactor"]);t!==void 0&&u!=null&&p(t,["parameters","upscaleConfig","imagePreservationFactor"],u);const h=d(e,["labels"]);t!==void 0&&h!=null&&p(t,["labels"],h);const m=d(e,["numberOfImages"]);t!==void 0&&m!=null&&p(t,["parameters","sampleCount"],m);const x=d(e,["mode"]);return t!==void 0&&x!=null&&p(t,["parameters","mode"],x),r}function L8(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["_url","model"],ut(e,n));const i=d(t,["image"]);i!=null&&p(r,["instances[0]","image"],Jn(i));const s=d(t,["upscaleFactor"]);s!=null&&p(r,["parameters","upscaleConfig","upscaleFactor"],s);const a=d(t,["config"]);return a!=null&&D8(a,r),r}function O8(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>of(s))),p(t,["generatedImages"],i)}return t}function U8(e){const t={},r=d(e,["uri"]);r!=null&&p(t,["uri"],r);const n=d(e,["encodedVideo"]);n!=null&&p(t,["videoBytes"],ms(n));const i=d(e,["encoding"]);return i!=null&&p(t,["mimeType"],i),t}function B8(e){const t={},r=d(e,["gcsUri"]);r!=null&&p(t,["uri"],r);const n=d(e,["bytesBase64Encoded"]);n!=null&&p(t,["videoBytes"],ms(n));const i=d(e,["mimeType"]);return i!=null&&p(t,["mimeType"],i),t}function $8(e){const t={},r=d(e,["image"]);r!=null&&p(t,["_self"],Jn(r));const n=d(e,["maskMode"]);return n!=null&&p(t,["maskMode"],n),t}function j8(e){const t={},r=d(e,["image"]);r!=null&&p(t,["image"],lf(r));const n=d(e,["referenceType"]);return n!=null&&p(t,["referenceType"],n),t}function G8(e){const t={},r=d(e,["image"]);r!=null&&p(t,["image"],Jn(r));const n=d(e,["referenceType"]);return n!=null&&p(t,["referenceType"],n),t}function bE(e){const t={},r=d(e,["uri"]);r!=null&&p(t,["uri"],r);const n=d(e,["videoBytes"]);n!=null&&p(t,["encodedVideo"],ms(n));const i=d(e,["mimeType"]);return i!=null&&p(t,["encoding"],i),t}function IE(e){const t={},r=d(e,["uri"]);r!=null&&p(t,["gcsUri"],r);const n=d(e,["videoBytes"]);n!=null&&p(t,["bytesBase64Encoded"],ms(n));const i=d(e,["mimeType"]);return i!=null&&p(t,["mimeType"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const V8="Content-Type",H8="X-Server-Timeout",z8="User-Agent",C0="x-goog-api-client",W8="1.30.0",q8=`google-genai-sdk/${W8}`,J8="v1beta1",K8="v1beta",k1=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Y8{constructor(t){var r,n;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:J8,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:K8,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&n.push(t.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),r=new URL(t);return r.protocol=r.protocol=="http:"?"ws":"wss",r.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,r,n){const i=[this.getRequestUrlInternal(r)];return n&&i.push(this.getBaseResourcePath()),t!==""&&i.push(t),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let r=this.clientOptions.httpOptions;t.httpOptions&&(r=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,r,n);if(t.queryParams)for(const[a,o]of Object.entries(t.queryParams))i.searchParams.append(a,String(o));let s={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=t.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,r,i.toString(),t.abortSignal),this.unaryApiCall(i,s,t.httpMethod)}patchHttpOptions(t,r){const n=JSON.parse(JSON.stringify(t));for(const[i,s]of Object.entries(r))typeof s=="object"?n[i]=Object.assign(Object.assign({},n[i]),s):s!==void 0&&(n[i]=s);return n}async requestStream(t){let r=this.clientOptions.httpOptions;t.httpOptions&&(r=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,r,n);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=t.body,s=await this.includeExtraHttpOptionsToRequestInit(s,r,i.toString(),t.abortSignal),this.streamApiCall(i,s,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,r,n,i){if(r&&r.timeout||i){const s=new AbortController,a=s.signal;if(r.timeout&&(r==null?void 0:r.timeout)>0){const o=setTimeout(()=>s.abort(),r.timeout);o&&typeof o.unref=="function"&&o.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),t.signal=a}return r&&r.extraBody!==null&&X8(t,r.extraBody),t.headers=await this.getHeadersInternal(r,n),t}async unaryApiCall(t,r,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},r),{method:n})).then(async i=>(await C1(i),new E0(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(t,r,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},r),{method:n})).then(async i=>(await C1(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(t){var r;return $a(this,arguments,function*(){const i=(r=t==null?void 0:t.body)===null||r===void 0?void 0:r.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let a="";for(;;){const{done:o,value:c}=yield kt(i.read());if(o){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const l=s.decode(c,{stream:!0});try{const h=JSON.parse(l);if("error"in h){const m=JSON.parse(JSON.stringify(h.error)),x=m.status,g=m.code,v=`got status: ${x}. ${JSON.stringify(h)}`;if(g>=400&&g<600)throw new sf({message:v,status:g})}}catch(h){if(h.name==="ApiError")throw h}a+=l;let u=a.match(k1);for(;u;){const h=u[1];try{const m=new Response(h,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield kt(new E0(m)),a=a.slice(u[0].length),u=a.match(k1)}catch(m){throw new Error(`exception parsing stream chunk ${h}. ${m}`)}}}}finally{i.releaseLock()}})}async apiCall(t,r){return fetch(t,r).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const t={},r=q8+" "+this.clientOptions.userAgentExtra;return t[z8]=r,t[C0]=r,t[V8]="application/json",t}async getHeadersInternal(t,r){const n=new Headers;if(t&&t.headers){for(const[i,s]of Object.entries(t.headers))n.append(i,s);t.timeout&&t.timeout>0&&n.append(H8,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,r),n}getFileName(t){var r;let n="";return typeof t=="string"&&(n=t.replace(/[/\\]+$/,""),n=(r=n.split(/[/\\]/).pop())!==null&&r!==void 0?r:""),n}async uploadFile(t,r){var n;const i={};r!=null&&(i.mimeType=r.mimeType,i.name=r.name,i.displayName=r.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,a=await s.stat(t);i.sizeBytes=String(a.size);const o=(n=r==null?void 0:r.mimeType)!==null&&n!==void 0?n:a.type;if(o===void 0||o==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=o;const c={file:i},l=this.getFileName(t),u=Le("upload/v1beta/files",c._url),h=await this.fetchUploadUrl(u,i.sizeBytes,i.mimeType,l,c,r==null?void 0:r.httpOptions);return s.upload(t,h,this)}async uploadFileToFileSearchStore(t,r,n){var i;const s=this.clientOptions.uploader,a=await s.stat(r),o=String(a.size),c=(i=n==null?void 0:n.mimeType)!==null&&i!==void 0?i:a.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const l=`upload/v1beta/${t}:uploadToFileSearchStore`,u=this.getFileName(r),h={};n!=null&&n.customMetadata&&(h.customMetadata=n.customMetadata),n!=null&&n.chunkingConfig&&(h.chunkingConfig=n.chunkingConfig);const m=await this.fetchUploadUrl(l,o,c,u,h,n==null?void 0:n.httpOptions);return s.uploadToFileSearchStore(r,m,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,r,n,i,s,a){var o;let c={};a?c=a:c={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r}`,"X-Goog-Upload-Header-Content-Type":`${n}`},i?{"X-Goog-Upload-File-Name":i}:{})};const l=await this.request({path:t,body:JSON.stringify(s),httpMethod:"POST",httpOptions:c});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(o=l==null?void 0:l.headers)===null||o===void 0?void 0:o["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function C1(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const r=e.status;let n;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?n=await e.json():n={error:{message:await e.text(),code:e.status,status:e.statusText}};const i=JSON.stringify(n);throw r>=400&&r<600?new sf({message:i,status:r}):new Error(i)}}function X8(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let r={};if(typeof e.body=="string"&&e.body.length>0)try{const s=JSON.parse(e.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))r=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(s,a){const o=Object.assign({},s);for(const c in a)if(Object.prototype.hasOwnProperty.call(a,c)){const l=a[c],u=o[c];l&&typeof l=="object"&&!Array.isArray(l)&&u&&typeof u=="object"&&!Array.isArray(u)?o[c]=n(u,l):(u&&l&&typeof u!=typeof l&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${c}". Original type: ${typeof u}, New type: ${typeof l}. Overwriting.`),o[c]=l)}return o}const i=n(r,t);e.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Q8="mcp_used/unknown";let Z8=!1;function FE(e){for(const t of e)if(eO(t)||typeof t=="object"&&"inputSchema"in t)return!0;return Z8}function RE(e){var t;const r=(t=e[C0])!==null&&t!==void 0?t:"";e[C0]=(r+` ${Q8}`).trimStart()}function eO(e){return e!==null&&typeof e=="object"&&e instanceof yp}function tO(e,t=100){return $a(this,arguments,function*(){let n,i=0;for(;i<t;){const s=yield kt(e.listTools({cursor:n}));for(const a of s.tools)yield yield kt(a),i++;if(!s.nextCursor)break;n=s.nextCursor}})}class yp{constructor(t=[],r){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=r}static create(t,r){return new yp(t,r)}async initialize(){var t,r,n,i;if(this.mcpTools.length>0)return;const s={},a=[];for(const u of this.mcpClients)try{for(var o=!0,c=(r=void 0,tl(tO(u))),l;l=await c.next(),t=l.done,!t;o=!0){i=l.value,o=!1;const h=i;a.push(h);const m=h.name;if(s[m])throw new Error(`Duplicate function name ${m} found in MCP tools. Please ensure function names are unique.`);s[m]=u}}catch(h){r={error:h}}finally{try{!o&&!t&&(n=c.return)&&await n.call(c)}finally{if(r)throw r.error}}this.mcpTools=a,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),q5(this.mcpTools,this.config)}async callTool(t){await this.initialize();const r=[];for(const n of t)if(n.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[n.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const a=await i.callTool({name:n.name,arguments:n.args},void 0,s);r.push({functionResponse:{name:n.name,response:a.isError?{error:a}:a}})}return r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function rO(e,t,r){const n=new B5;let i;r.data instanceof Blob?i=JSON.parse(await r.data.text()):i=JSON.parse(r.data),Object.assign(n,i),t(n)}class nO{constructor(t,r,n){this.apiClient=t,this.auth=r,this.webSocketFactory=n}async connect(t){var r,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),a=aO(this.apiClient.getDefaultHeaders()),o=this.apiClient.getApiKey(),c=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${o}`;let l=()=>{};const u=new Promise(T=>{l=T}),h=t.callbacks,m=function(){l({})},x=this.apiClient,g={onopen:m,onmessage:T=>{rO(x,h.onmessage,T)},onerror:(r=h==null?void 0:h.onerror)!==null&&r!==void 0?r:function(T){},onclose:(n=h==null?void 0:h.onclose)!==null&&n!==void 0?n:function(T){}},v=this.webSocketFactory.create(c,sO(a),g);v.connect(),await u;const w={setup:{model:ut(this.apiClient,t.model)}};return v.send(JSON.stringify(w)),new iO(v,this.apiClient)}}class iO{constructor(t,r){this.conn=t,this.apiClient=r}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const r=H6(t);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const r=V6(t);this.conn.send(JSON.stringify(r))}sendPlaybackControl(t){const r={playbackControl:t};this.conn.send(JSON.stringify(r))}play(){this.sendPlaybackControl(Na.PLAY)}pause(){this.sendPlaybackControl(Na.PAUSE)}stop(){this.sendPlaybackControl(Na.STOP)}resetContext(){this.sendPlaybackControl(Na.RESET_CONTEXT)}close(){this.conn.close()}}function sO(e){const t={};return e.forEach((r,n)=>{t[n]=r}),t}function aO(e){const t=new Headers;for(const[r,n]of Object.entries(e))t.append(r,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const oO="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function lO(e,t,r){const n=new U5;let i;r.data instanceof Blob?i=await r.data.text():r.data instanceof ArrayBuffer?i=new TextDecoder().decode(r.data):i=r.data;const s=JSON.parse(i);if(e.isVertexAI()){const a=q6(s);Object.assign(n,a)}else Object.assign(n,s);t(n)}class cO{constructor(t,r,n){this.apiClient=t,this.auth=r,this.webSocketFactory=n,this.music=new nO(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var r,n,i,s,a,o;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const c=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion();let u;const h=this.apiClient.getHeaders();t.config&&t.config.tools&&FE(t.config.tools)&&RE(h);const m=hO(h);if(this.apiClient.isVertexAI())u=`${c}/ws/google.cloud.aiplatform.${l}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m,u);else{const D=this.apiClient.getApiKey();let H="BidiGenerateContent",Y="key";D!=null&&D.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),l!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),H="BidiGenerateContentConstrained",Y="access_token"),u=`${c}/ws/google.ai.generativelanguage.${l}.GenerativeService.${H}?${Y}=${D}`}let x=()=>{};const g=new Promise(D=>{x=D}),v=t.callbacks,y=function(){var D;(D=v==null?void 0:v.onopen)===null||D===void 0||D.call(v),x({})},E=this.apiClient,w={onopen:y,onmessage:D=>{lO(E,v.onmessage,D)},onerror:(r=v==null?void 0:v.onerror)!==null&&r!==void 0?r:function(D){},onclose:(n=v==null?void 0:v.onclose)!==null&&n!==void 0?n:function(D){}},T=this.webSocketFactory.create(u,dO(m),w);T.connect(),await g;let k=ut(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&k.startsWith("publishers/")){const D=this.apiClient.getProject(),H=this.apiClient.getLocation();k=`projects/${D}/locations/${H}/`+k}let b={};this.apiClient.isVertexAI()&&((i=t.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[bu.AUDIO]}:t.config.responseModalities=[bu.AUDIO]),!((s=t.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I=(o=(a=t.config)===null||a===void 0?void 0:a.tools)!==null&&o!==void 0?o:[],S=[];for(const D of I)if(this.isCallableTool(D)){const H=D;S.push(await H.tool())}else S.push(D);S.length>0&&(t.config.tools=S);const B={model:k,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?b=G6(this.apiClient,B):b=j6(this.apiClient,B),delete b.config,T.send(JSON.stringify(b)),new fO(T,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const uO={turnComplete:!0};class fO{constructor(t,r){this.conn=t,this.apiClient=r}tLiveClientContent(t,r){if(r.turns!==null&&r.turns!==void 0){let n=[];try{n=An(r.turns),t.isVertexAI()||(n=n.map(i=>af(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof r.turns}'`)}return{clientContent:{turns:n,turnComplete:r.turnComplete}}}return{clientContent:{turnComplete:r.turnComplete}}}tLiveClienttToolResponse(t,r){let n=[];if(r.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(r.functionResponses)?n=r.functionResponses:n=[r.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const s of n){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!t.isVertexAI()&&!("id"in s))throw new Error(oO)}return{toolResponse:{functionResponses:n}}}sendClientContent(t){t=Object.assign(Object.assign({},uO),t);const r=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(r))}sendRealtimeInput(t){let r={};this.apiClient.isVertexAI()?r={realtimeInput:W6(t)}:r={realtimeInput:z6(t)},this.conn.send(JSON.stringify(r))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const r=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(r))}close(){this.conn.close()}}function dO(e){const t={};return e.forEach((r,n)=>{t[n]=r}),t}function hO(e){const t=new Headers;for(const[r,n]of Object.entries(e))t.append(r,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const N1=10;function A1(e){var t,r,n;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let i=!1;for(const a of(r=e==null?void 0:e.tools)!==null&&r!==void 0?r:[])if(ja(a)){i=!0;break}if(!i)return!0;const s=(n=e==null?void 0:e.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function ja(e){return"callTool"in e&&typeof e.callTool=="function"}function pO(e){var t,r,n;return(n=(r=(t=e.config)===null||t===void 0?void 0:t.tools)===null||r===void 0?void 0:r.some(i=>ja(i)))!==null&&n!==void 0?n:!1}function b1(e){var t;const r=[];return!((t=e==null?void 0:e.config)===null||t===void 0)&&t.tools&&e.config.tools.forEach((n,i)=>{if(ja(n))return;const s=n;s.functionDeclarations&&s.functionDeclarations.length>0&&r.push(i)}),r}function I1(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mO extends Fi{constructor(t){super(),this.apiClient=t,this.generateContent=async r=>{var n,i,s,a,o;const c=await this.processParamsMaybeAddMcpUsage(r);if(this.maybeMoveToResponseJsonSchem(r),!pO(r)||A1(r.config))return await this.generateContentInternal(c);const l=b1(r);if(l.length>0){const v=l.map(y=>`tools[${y}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${v}.`)}let u,h;const m=An(c.contents),x=(s=(i=(n=c.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:N1;let g=0;for(;g<x&&(u=await this.generateContentInternal(c),!(!u.functionCalls||u.functionCalls.length===0));){const v=u.candidates[0].content,y=[];for(const E of(o=(a=r.config)===null||a===void 0?void 0:a.tools)!==null&&o!==void 0?o:[])if(ja(E)){const T=await E.callTool(u.functionCalls);y.push(...T)}g++,h={role:"user",parts:y},c.contents=An(c.contents),c.contents.push(v),c.contents.push(h),I1(c.config)&&(m.push(v),m.push(h))}return I1(c.config)&&(u.automaticFunctionCallingHistory=m),u},this.generateContentStream=async r=>{var n,i,s,a,o;if(this.maybeMoveToResponseJsonSchem(r),A1(r.config)){const h=await this.processParamsMaybeAddMcpUsage(r);return await this.generateContentStreamInternal(h)}const c=b1(r);if(c.length>0){const h=c.map(m=>`tools[${m}]`).join(", ");throw new Error(`Incompatible tools found at ${h}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const l=(s=(i=(n=r==null?void 0:r.config)===null||n===void 0?void 0:n.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,u=(o=(a=r==null?void 0:r.config)===null||a===void 0?void 0:a.automaticFunctionCalling)===null||o===void 0?void 0:o.disable;if(l&&!u)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(r)},this.generateImages=async r=>await this.generateImagesInternal(r).then(n=>{var i;let s;const a=[];if(n!=null&&n.generatedImages)for(const c of n.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((i=c==null?void 0:c.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=c==null?void 0:c.safetyAttributes:a.push(c);let o;return s?o={generatedImages:a,positivePromptSafetyAttributes:s,sdkHttpResponse:n.sdkHttpResponse}:o={generatedImages:a,sdkHttpResponse:n.sdkHttpResponse},o}),this.list=async r=>{var n;const a={config:Object.assign(Object.assign({},{queryBase:!0}),r==null?void 0:r.config)};if(this.apiClient.isVertexAI()&&!a.config.queryBase){if(!((n=a.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");a.config.filter="labels.tune-type:*"}return new ta(Ci.PAGED_ITEM_MODELS,o=>this.listInternal(o),await this.listInternal(a),a)},this.editImage=async r=>{const n={model:r.model,prompt:r.prompt,referenceImages:[],config:r.config};return r.referenceImages&&r.referenceImages&&(n.referenceImages=r.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async r=>{let n={numberOfImages:1,mode:"upscale"};r.config&&(n=Object.assign(Object.assign({},n),r.config));const i={model:r.model,image:r.image,upscaleFactor:r.upscaleFactor,config:n};return await this.upscaleImageInternal(i)},this.generateVideos=async r=>{var n,i,s,a,o,c;if((r.prompt||r.image||r.video)&&r.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((n=r.video)===null||n===void 0)&&n.uri&&(!((i=r.video)===null||i===void 0)&&i.videoBytes)?r.video={uri:r.video.uri,mimeType:r.video.mimeType}:!((a=(s=r.source)===null||s===void 0?void 0:s.video)===null||a===void 0)&&a.uri&&(!((c=(o=r.source)===null||o===void 0?void 0:o.video)===null||c===void 0)&&c.videoBytes)&&(r.source.video={uri:r.source.video.uri,mimeType:r.source.video.mimeType})),await this.generateVideosInternal(r)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var r,n,i;const s=(r=t.config)===null||r===void 0?void 0:r.tools;if(!s)return t;const a=await Promise.all(s.map(async c=>ja(c)?await c.tool():c)),o={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:a})};if(o.config.tools=a,t.config&&t.config.tools&&FE(t.config.tools)){const c=(i=(n=t.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&i!==void 0?i:{};let l=Object.assign({},c);Object.keys(l).length===0&&(l=this.apiClient.getDefaultHeaders()),RE(l),o.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:l})}return o}async initAfcToolsMap(t){var r,n,i;const s=new Map;for(const a of(n=(r=t.config)===null||r===void 0?void 0:r.tools)!==null&&n!==void 0?n:[])if(ja(a)){const o=a,c=await o.tool();for(const l of(i=c.functionDeclarations)!==null&&i!==void 0?i:[]){if(!l.name)throw new Error("Function declaration name is required.");if(s.has(l.name))throw new Error(`Duplicate tool declaration name: ${l.name}`);s.set(l.name,o)}}return s}async processAfcStream(t){var r,n,i;const s=(i=(n=(r=t.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&i!==void 0?i:N1;let a=!1,o=0;const c=await this.initAfcToolsMap(t);return function(l,u,h){var m,x;return $a(this,arguments,function*(){for(var g,v,y,E;o<s;){a&&(o++,a=!1);const b=yield kt(l.processParamsMaybeAddMcpUsage(h)),I=yield kt(l.generateContentStreamInternal(b)),S=[],B=[];try{for(var w=!0,T=(v=void 0,tl(I)),k;k=yield kt(T.next()),g=k.done,!g;w=!0){E=k.value,w=!1;const D=E;if(yield yield kt(D),D.candidates&&(!((m=D.candidates[0])===null||m===void 0)&&m.content)){B.push(D.candidates[0].content);for(const H of(x=D.candidates[0].content.parts)!==null&&x!==void 0?x:[])if(o<s&&H.functionCall){if(!H.functionCall.name)throw new Error("Function call name was not returned by the model.");if(u.has(H.functionCall.name)){const Y=yield kt(u.get(H.functionCall.name).callTool([H.functionCall]));S.push(...Y)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${u.keys()}, mising tool: ${H.functionCall.name}`)}}}}catch(D){v={error:D}}finally{try{!w&&!g&&(y=T.return)&&(yield kt(y.call(T)))}finally{if(v)throw v.error}}if(S.length>0){a=!0;const D=new No;D.candidates=[{content:{role:"user",parts:S}}],yield yield kt(D);const H=[];H.push(...B),H.push({role:"user",parts:S});const Y=An(h.contents).concat(H);h.contents=Y}else break}})}(this,c,t)}async generateContentInternal(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=T1(this.apiClient,t);return o=Le("{model}:generateContent",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=S1(u),m=new No;return Object.assign(m,h),m})}else{const l=E1(this.apiClient,t);return o=Le("{model}:generateContent",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=_1(u),m=new No;return Object.assign(m,h),m})}}async generateContentStreamInternal(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=T1(this.apiClient,t);return o=Le("{model}:streamGenerateContent?alt=sse",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.requestStream({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}),a.then(function(h){return $a(this,arguments,function*(){var m,x,g,v;try{for(var y=!0,E=tl(h),w;w=yield kt(E.next()),m=w.done,!m;y=!0){v=w.value,y=!1;const T=v,k=S1(yield kt(T.json()));k.sdkHttpResponse={headers:T.headers};const b=new No;Object.assign(b,k),yield yield kt(b)}}catch(T){x={error:T}}finally{try{!y&&!m&&(g=E.return)&&(yield kt(g.call(E)))}finally{if(x)throw x.error}}})})}else{const l=E1(this.apiClient,t);return o=Le("{model}:streamGenerateContent?alt=sse",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.requestStream({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}),a.then(function(h){return $a(this,arguments,function*(){var m,x,g,v;try{for(var y=!0,E=tl(h),w;w=yield kt(E.next()),m=w.done,!m;y=!0){v=w.value,y=!1;const T=v,k=_1(yield kt(T.json()));k.sdkHttpResponse={headers:T.headers};const b=new No;Object.assign(b,k),yield yield kt(b)}}catch(T){x={error:T}}finally{try{!y&&!m&&(g=E.return)&&(yield kt(g.call(E)))}finally{if(x)throw x.error}}})})}}async embedContent(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=_L(this.apiClient,t);return o=Le("{model}:predict",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=kL(u),m=new s1;return Object.assign(m,h),m})}else{const l=TL(this.apiClient,t);return o=Le("{model}:batchEmbedContents",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=SL(u),m=new s1;return Object.assign(m,h),m})}}async generateImagesInternal(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=LL(this.apiClient,t);return o=Le("{model}:predict",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=UL(u),m=new a1;return Object.assign(m,h),m})}else{const l=DL(this.apiClient,t);return o=Le("{model}:predict",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=OL(u),m=new a1;return Object.assign(m,h),m})}}async editImageInternal(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=vL(this.apiClient,t);return s=Le("{model}:predict",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json().then(l=>{const u=l;return u.sdkHttpResponse={headers:c.headers},u})),i.then(c=>{const l=yL(c),u=new N5;return Object.assign(u,l),u})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=L8(this.apiClient,t);return s=Le("{model}:predict",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json().then(l=>{const u=l;return u.sdkHttpResponse={headers:c.headers},u})),i.then(c=>{const l=O8(c),u=new A5;return Object.assign(u,l),u})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=g8(this.apiClient,t);return s=Le("{model}:predict",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>{const l=v8(c),u=new b5;return Object.assign(u,l),u})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=S8(this.apiClient,t);return s=Le("{model}:predict",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>{const l=k8(c),u=new I5;return Object.assign(u,l),u})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=t8(this.apiClient,t);return o=Le("{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>k0(u))}else{const l=e8(this.apiClient,t);return o=Le("{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),a.then(u=>S0(u))}}async listInternal(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=u8(this.apiClient,t);return o=Le("{models_url}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=d8(u),m=new o1;return Object.assign(m,h),m})}else{const l=c8(this.apiClient,t);return o=Le("{models_url}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=f8(u),m=new o1;return Object.assign(m,h),m})}}async update(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=M8(this.apiClient,t);return o=Le("{model}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"PATCH",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>k0(u))}else{const l=P8(this.apiClient,t);return o=Le("{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),a.then(u=>S0(u))}}async delete(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=pL(this.apiClient,t);return o=Le("{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=xL(u),m=new l1;return Object.assign(m,h),m})}else{const l=hL(this.apiClient,t);return o=Le("{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=mL(u),m=new l1;return Object.assign(m,h),m})}}async countTokens(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=uL(this.apiClient,t);return o=Le("{model}:countTokens",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=dL(u),m=new c1;return Object.assign(m,h),m})}else{const l=cL(this.apiClient,t);return o=Le("{model}:countTokens",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=fL(u),m=new c1;return Object.assign(m,h),m})}}async computeTokens(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=rL(this.apiClient,t);return s=Le("{model}:computeTokens",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json().then(l=>{const u=l;return u.sdkHttpResponse={headers:c.headers},u})),i.then(c=>{const l=nL(c),u=new F5;return Object.assign(u,l),u})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=HL(this.apiClient,t);return o=Le("{model}:predictLongRunning",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a.then(u=>{const h=GL(u),m=new Iu;return Object.assign(m,h),m})}else{const l=VL(this.apiClient,t);return o=Le("{model}:predictLongRunning",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),a.then(u=>{const h=jL(u),m=new Iu;return Object.assign(m,h),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xO extends Fi{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const r=t.operation,n=t.config;if(r.name===void 0||r.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=r.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:r.name,resourceName:i,config:{httpOptions:s}});return r._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:r.name,config:n});return r._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(t){const r=t.operation,n=t.config;if(r.name===void 0||r.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=r.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:r.name,resourceName:i,config:{httpOptions:s}});return r._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:r.name,config:n});return r._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=E5(t);return o=Le("{operationName}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json()),a}else{const l=w5(t);return o=Le("{operationName}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),a}}async fetchPredictVideosOperationInternal(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=h5(t);return s=Le("{resourceName}:fetchPredictOperation",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gO(e){const t={},r=d(e,["data"]);if(r!=null&&p(t,["data"],r),d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function vO(e){const t={},r=d(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>NO(s))),p(t,["parts"],i)}const n=d(e,["role"]);return n!=null&&p(t,["role"],n),t}function yO(e,t,r){const n={},i=d(t,["expireTime"]);r!==void 0&&i!=null&&p(r,["expireTime"],i);const s=d(t,["newSessionExpireTime"]);r!==void 0&&s!=null&&p(r,["newSessionExpireTime"],s);const a=d(t,["uses"]);r!==void 0&&a!=null&&p(r,["uses"],a);const o=d(t,["liveConnectConstraints"]);r!==void 0&&o!=null&&p(r,["bidiGenerateContentSetup"],CO(e,o));const c=d(t,["lockAdditionalFields"]);return r!==void 0&&c!=null&&p(r,["fieldMask"],c),n}function wO(e,t){const r={},n=d(t,["config"]);return n!=null&&p(r,["config"],yO(e,n,r)),r}function EO(e){const t={};if(d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(e,["fileUri"]);r!=null&&p(t,["fileUri"],r);const n=d(e,["mimeType"]);return n!=null&&p(t,["mimeType"],n),t}function TO(e){const t={},r=d(e,["id"]);r!=null&&p(t,["id"],r);const n=d(e,["args"]);n!=null&&p(t,["args"],n);const i=d(e,["name"]);if(i!=null&&p(t,["name"],i),d(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function _O(e){const t={};if(d(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=d(e,["enableWidget"]);return r!=null&&p(t,["enableWidget"],r),t}function SO(e){const t={};if(d(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=d(e,["timeRangeFilter"]);return r!=null&&p(t,["timeRangeFilter"],r),t}function kO(e,t){const r={},n=d(e,["generationConfig"]);t!==void 0&&n!=null&&p(t,["setup","generationConfig"],n);const i=d(e,["responseModalities"]);t!==void 0&&i!=null&&p(t,["setup","generationConfig","responseModalities"],i);const s=d(e,["temperature"]);t!==void 0&&s!=null&&p(t,["setup","generationConfig","temperature"],s);const a=d(e,["topP"]);t!==void 0&&a!=null&&p(t,["setup","generationConfig","topP"],a);const o=d(e,["topK"]);t!==void 0&&o!=null&&p(t,["setup","generationConfig","topK"],o);const c=d(e,["maxOutputTokens"]);t!==void 0&&c!=null&&p(t,["setup","generationConfig","maxOutputTokens"],c);const l=d(e,["mediaResolution"]);t!==void 0&&l!=null&&p(t,["setup","generationConfig","mediaResolution"],l);const u=d(e,["seed"]);t!==void 0&&u!=null&&p(t,["setup","generationConfig","seed"],u);const h=d(e,["speechConfig"]);t!==void 0&&h!=null&&p(t,["setup","generationConfig","speechConfig"],vp(h));const m=d(e,["thinkingConfig"]);t!==void 0&&m!=null&&p(t,["setup","generationConfig","thinkingConfig"],m);const x=d(e,["enableAffectiveDialog"]);t!==void 0&&x!=null&&p(t,["setup","generationConfig","enableAffectiveDialog"],x);const g=d(e,["systemInstruction"]);t!==void 0&&g!=null&&p(t,["setup","systemInstruction"],vO(br(g)));const v=d(e,["tools"]);if(t!==void 0&&v!=null){let I=oo(v);Array.isArray(I)&&(I=I.map(S=>bO(ao(S)))),p(t,["setup","tools"],I)}const y=d(e,["sessionResumption"]);t!==void 0&&y!=null&&p(t,["setup","sessionResumption"],AO(y));const E=d(e,["inputAudioTranscription"]);t!==void 0&&E!=null&&p(t,["setup","inputAudioTranscription"],E);const w=d(e,["outputAudioTranscription"]);t!==void 0&&w!=null&&p(t,["setup","outputAudioTranscription"],w);const T=d(e,["realtimeInputConfig"]);t!==void 0&&T!=null&&p(t,["setup","realtimeInputConfig"],T);const k=d(e,["contextWindowCompression"]);t!==void 0&&k!=null&&p(t,["setup","contextWindowCompression"],k);const b=d(e,["proactivity"]);return t!==void 0&&b!=null&&p(t,["setup","proactivity"],b),r}function CO(e,t){const r={},n=d(t,["model"]);n!=null&&p(r,["setup","model"],ut(e,n));const i=d(t,["config"]);return i!=null&&p(r,["config"],kO(i,r)),r}function NO(e){const t={},r=d(e,["mediaResolution"]);r!=null&&p(t,["mediaResolution"],r);const n=d(e,["codeExecutionResult"]);n!=null&&p(t,["codeExecutionResult"],n);const i=d(e,["executableCode"]);i!=null&&p(t,["executableCode"],i);const s=d(e,["fileData"]);s!=null&&p(t,["fileData"],EO(s));const a=d(e,["functionCall"]);a!=null&&p(t,["functionCall"],TO(a));const o=d(e,["functionResponse"]);o!=null&&p(t,["functionResponse"],o);const c=d(e,["inlineData"]);c!=null&&p(t,["inlineData"],gO(c));const l=d(e,["text"]);l!=null&&p(t,["text"],l);const u=d(e,["thought"]);u!=null&&p(t,["thought"],u);const h=d(e,["thoughtSignature"]);h!=null&&p(t,["thoughtSignature"],h);const m=d(e,["videoMetadata"]);return m!=null&&p(t,["videoMetadata"],m),t}function AO(e){const t={},r=d(e,["handle"]);if(r!=null&&p(t,["handle"],r),d(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function bO(e){const t={},r=d(e,["functionDeclarations"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(h=>h)),p(t,["functionDeclarations"],u)}if(d(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=d(e,["googleSearchRetrieval"]);n!=null&&p(t,["googleSearchRetrieval"],n);const i=d(e,["computerUse"]);i!=null&&p(t,["computerUse"],i);const s=d(e,["fileSearch"]);s!=null&&p(t,["fileSearch"],s);const a=d(e,["codeExecution"]);if(a!=null&&p(t,["codeExecution"],a),d(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=d(e,["googleMaps"]);o!=null&&p(t,["googleMaps"],_O(o));const c=d(e,["googleSearch"]);c!=null&&p(t,["googleSearch"],SO(c));const l=d(e,["urlContext"]);return l!=null&&p(t,["urlContext"],l),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function IO(e){const t=[];for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){const n=e[r];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const i=Object.keys(n).map(s=>`${r}.${s}`);t.push(...i)}else t.push(r)}return t.join(",")}function FO(e,t){let r=null;const n=e.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const s=n.setup;typeof s=="object"&&s!==null?(e.bidiGenerateContentSetup=s,r=s):delete e.bidiGenerateContentSetup}else n!==void 0&&delete e.bidiGenerateContentSetup;const i=e.fieldMask;if(r){const s=IO(r);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)s?e.fieldMask=s:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const a=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let o=[];i.length>0&&(o=i.map(l=>a.includes(l)?`generationConfig.${l}`:l));const c=[];s&&c.push(s),o.length>0&&c.push(...o),c.length>0?e.fieldMask=c.join(","):delete e.fieldMask}else delete e.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}class RO extends Fi{constructor(t){super(),this.apiClient=t}async create(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const o=wO(this.apiClient,t);s=Le("auth_tokens",o._url),a=o._query,delete o.config,delete o._url,delete o._query;const c=FO(o,t.config);return i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(l=>l.json()),i.then(l=>l)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function PO(e,t){const r={},n=d(e,["displayName"]);return t!==void 0&&n!=null&&p(t,["displayName"],n),r}function MO(e){const t={},r=d(e,["config"]);return r!=null&&PO(r,t),t}function DO(e,t){const r={},n=d(e,["force"]);return t!==void 0&&n!=null&&p(t,["_query","force"],n),r}function LO(e){const t={},r=d(e,["name"]);r!=null&&p(t,["_url","name"],r);const n=d(e,["config"]);return n!=null&&DO(n,t),t}function OO(e){const t={},r=d(e,["name"]);return r!=null&&p(t,["_url","name"],r),t}function UO(e,t){const r={},n=d(e,["customMetadata"]);if(t!==void 0&&n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["customMetadata"],s)}const i=d(e,["chunkingConfig"]);return t!==void 0&&i!=null&&p(t,["chunkingConfig"],i),r}function BO(e){const t={},r=d(e,["name"]);r!=null&&p(t,["name"],r);const n=d(e,["metadata"]);n!=null&&p(t,["metadata"],n);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["response"]);return a!=null&&p(t,["response"],jO(a)),t}function $O(e){const t={},r=d(e,["fileSearchStoreName"]);r!=null&&p(t,["_url","file_search_store_name"],r);const n=d(e,["fileName"]);n!=null&&p(t,["fileName"],n);const i=d(e,["config"]);return i!=null&&UO(i,t),t}function jO(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["parent"]);n!=null&&p(t,["parent"],n);const i=d(e,["documentName"]);return i!=null&&p(t,["documentName"],i),t}function GO(e,t){const r={},n=d(e,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const i=d(e,["pageToken"]);return t!==void 0&&i!=null&&p(t,["_query","pageToken"],i),r}function VO(e){const t={},r=d(e,["config"]);return r!=null&&GO(r,t),t}function HO(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["nextPageToken"]);n!=null&&p(t,["nextPageToken"],n);const i=d(e,["fileSearchStores"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["fileSearchStores"],s)}return t}function zO(e,t){const r={},n=d(e,["mimeType"]);t!==void 0&&n!=null&&p(t,["mimeType"],n);const i=d(e,["displayName"]);t!==void 0&&i!=null&&p(t,["displayName"],i);const s=d(e,["customMetadata"]);if(t!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(c=>c)),p(t,["customMetadata"],o)}const a=d(e,["chunkingConfig"]);return t!==void 0&&a!=null&&p(t,["chunkingConfig"],a),r}function WO(e){const t={},r=d(e,["fileSearchStoreName"]);r!=null&&p(t,["_url","file_search_store_name"],r);const n=d(e,["config"]);return n!=null&&zO(n,t),t}function qO(e){const t={},r=d(e,["sdkHttpResponse"]);return r!=null&&p(t,["sdkHttpResponse"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JO(e,t){const r={},n=d(e,["force"]);return t!==void 0&&n!=null&&p(t,["_query","force"],n),r}function KO(e){const t={},r=d(e,["name"]);r!=null&&p(t,["_url","name"],r);const n=d(e,["config"]);return n!=null&&JO(n,t),t}function YO(e){const t={},r=d(e,["name"]);return r!=null&&p(t,["_url","name"],r),t}function XO(e,t){const r={},n=d(e,["pageSize"]);t!==void 0&&n!=null&&p(t,["_query","pageSize"],n);const i=d(e,["pageToken"]);return t!==void 0&&i!=null&&p(t,["_query","pageToken"],i),r}function QO(e){const t={},r=d(e,["parent"]);r!=null&&p(t,["_url","parent"],r);const n=d(e,["config"]);return n!=null&&XO(n,t),t}function ZO(e){const t={},r=d(e,["sdkHttpResponse"]);r!=null&&p(t,["sdkHttpResponse"],r);const n=d(e,["nextPageToken"]);n!=null&&p(t,["nextPageToken"],n);const i=d(e,["documents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["documents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class eU extends Fi{constructor(t){super(),this.apiClient=t,this.list=async r=>new ta(Ci.PAGED_ITEM_DOCUMENTS,n=>this.listInternal({parent:r.parent,config:n.config}),await this.listInternal(r),r)}async get(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=YO(t);return s=Le("{name}",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>c)}}async delete(t){var r,n;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=KO(t);i=Le("{name}",a._url),s=a._query,delete a._url,delete a._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=QO(t);return s=Le("{parent}/documents",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>{const l=ZO(c),u=new R5;return Object.assign(u,l),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tU extends Fi{constructor(t,r=new eU(t)){super(),this.apiClient=t,this.documents=r,this.list=async(n={})=>new ta(Ci.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(n),n)}async uploadToFileSearchStore(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(t.fileSearchStoreName,t.file,t.config)}async create(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=MO(t);return s=Le("fileSearchStores",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>c)}}async get(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=OO(t);return s=Le("{name}",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>c)}}async delete(t){var r,n;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=LO(t);i=Le("{name}",a._url),s=a._query,delete a._url,delete a._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=VO(t);return s=Le("fileSearchStores",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>{const l=HO(c),u=new P5;return Object.assign(u,l),u})}}async uploadToFileSearchStoreInternal(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=WO(t);return s=Le("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>{const l=qO(c),u=new M5;return Object.assign(u,l),u})}}async importFile(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=$O(t);return s=Le("{file_search_store_name}:importFile",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>{const l=BO(c),u=new hp;return Object.assign(u,l),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rU(e,t){const r={},n=d(e,["name"]);return n!=null&&p(r,["_url","name"],n),r}function nU(e,t){const r={},n=d(e,["name"]);return n!=null&&p(r,["_url","name"],n),r}function iU(e,t,r){const n={};if(d(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=d(e,["tunedModelDisplayName"]);if(t!==void 0&&i!=null&&p(t,["displayName"],i),d(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=d(e,["epochCount"]);t!==void 0&&s!=null&&p(t,["tuningTask","hyperparameters","epochCount"],s);const a=d(e,["learningRateMultiplier"]);if(a!=null&&p(n,["tuningTask","hyperparameters","learningRateMultiplier"],a),d(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(e,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(d(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const o=d(e,["batchSize"]);t!==void 0&&o!=null&&p(t,["tuningTask","hyperparameters","batchSize"],o);const c=d(e,["learningRate"]);if(t!==void 0&&c!=null&&p(t,["tuningTask","hyperparameters","learningRate"],c),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(d(e,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return n}function sU(e,t,r){const n={};let i=d(r,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const x=d(e,["validationDataset"]);t!==void 0&&x!=null&&p(t,["supervisedTuningSpec"],F1(x))}else if(i==="PREFERENCE_TUNING"){const x=d(e,["validationDataset"]);t!==void 0&&x!=null&&p(t,["preferenceOptimizationSpec"],F1(x))}const s=d(e,["tunedModelDisplayName"]);t!==void 0&&s!=null&&p(t,["tunedModelDisplayName"],s);const a=d(e,["description"]);t!==void 0&&a!=null&&p(t,["description"],a);let o=d(r,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const x=d(e,["epochCount"]);t!==void 0&&x!=null&&p(t,["supervisedTuningSpec","hyperParameters","epochCount"],x)}else if(o==="PREFERENCE_TUNING"){const x=d(e,["epochCount"]);t!==void 0&&x!=null&&p(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],x)}let c=d(r,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const x=d(e,["learningRateMultiplier"]);t!==void 0&&x!=null&&p(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],x)}else if(c==="PREFERENCE_TUNING"){const x=d(e,["learningRateMultiplier"]);t!==void 0&&x!=null&&p(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],x)}let l=d(r,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const x=d(e,["exportLastCheckpointOnly"]);t!==void 0&&x!=null&&p(t,["supervisedTuningSpec","exportLastCheckpointOnly"],x)}else if(l==="PREFERENCE_TUNING"){const x=d(e,["exportLastCheckpointOnly"]);t!==void 0&&x!=null&&p(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],x)}let u=d(r,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const x=d(e,["adapterSize"]);t!==void 0&&x!=null&&p(t,["supervisedTuningSpec","hyperParameters","adapterSize"],x)}else if(u==="PREFERENCE_TUNING"){const x=d(e,["adapterSize"]);t!==void 0&&x!=null&&p(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],x)}if(d(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(d(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const h=d(e,["labels"]);t!==void 0&&h!=null&&p(t,["labels"],h);const m=d(e,["beta"]);return t!==void 0&&m!=null&&p(t,["preferenceOptimizationSpec","hyperParameters","beta"],m),n}function aU(e,t){const r={},n=d(e,["baseModel"]);n!=null&&p(r,["baseModel"],n);const i=d(e,["preTunedModel"]);i!=null&&p(r,["preTunedModel"],i);const s=d(e,["trainingDataset"]);s!=null&&gU(s);const a=d(e,["config"]);return a!=null&&iU(a,r),r}function oU(e,t){const r={},n=d(e,["baseModel"]);n!=null&&p(r,["baseModel"],n);const i=d(e,["preTunedModel"]);i!=null&&p(r,["preTunedModel"],i);const s=d(e,["trainingDataset"]);s!=null&&vU(s,r,t);const a=d(e,["config"]);return a!=null&&sU(a,r,t),r}function lU(e,t){const r={},n=d(e,["name"]);return n!=null&&p(r,["_url","name"],n),r}function cU(e,t){const r={},n=d(e,["name"]);return n!=null&&p(r,["_url","name"],n),r}function uU(e,t,r){const n={},i=d(e,["pageSize"]);t!==void 0&&i!=null&&p(t,["_query","pageSize"],i);const s=d(e,["pageToken"]);t!==void 0&&s!=null&&p(t,["_query","pageToken"],s);const a=d(e,["filter"]);return t!==void 0&&a!=null&&p(t,["_query","filter"],a),n}function fU(e,t,r){const n={},i=d(e,["pageSize"]);t!==void 0&&i!=null&&p(t,["_query","pageSize"],i);const s=d(e,["pageToken"]);t!==void 0&&s!=null&&p(t,["_query","pageToken"],s);const a=d(e,["filter"]);return t!==void 0&&a!=null&&p(t,["_query","filter"],a),n}function dU(e,t){const r={},n=d(e,["config"]);return n!=null&&uU(n,r),r}function hU(e,t){const r={},n=d(e,["config"]);return n!=null&&fU(n,r),r}function pU(e,t){const r={},n=d(e,["sdkHttpResponse"]);n!=null&&p(r,["sdkHttpResponse"],n);const i=d(e,["nextPageToken"]);i!=null&&p(r,["nextPageToken"],i);const s=d(e,["tunedModels"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>PE(o))),p(r,["tuningJobs"],a)}return r}function mU(e,t){const r={},n=d(e,["sdkHttpResponse"]);n!=null&&p(r,["sdkHttpResponse"],n);const i=d(e,["nextPageToken"]);i!=null&&p(r,["nextPageToken"],i);const s=d(e,["tuningJobs"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>N0(o))),p(r,["tuningJobs"],a)}return r}function xU(e,t){const r={},n=d(e,["name"]);n!=null&&p(r,["model"],n);const i=d(e,["name"]);return i!=null&&p(r,["endpoint"],i),r}function gU(e,t){const r={};if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=d(e,["examples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>s)),p(r,["examples","examples"],i)}return r}function vU(e,t,r){const n={};let i=d(r,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const a=d(e,["gcsUri"]);t!==void 0&&a!=null&&p(t,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(i==="PREFERENCE_TUNING"){const a=d(e,["gcsUri"]);t!==void 0&&a!=null&&p(t,["preferenceOptimizationSpec","trainingDatasetUri"],a)}let s=d(r,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const a=d(e,["vertexDatasetResource"]);t!==void 0&&a!=null&&p(t,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(s==="PREFERENCE_TUNING"){const a=d(e,["vertexDatasetResource"]);t!==void 0&&a!=null&&p(t,["preferenceOptimizationSpec","trainingDatasetUri"],a)}if(d(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function PE(e,t){const r={},n=d(e,["sdkHttpResponse"]);n!=null&&p(r,["sdkHttpResponse"],n);const i=d(e,["name"]);i!=null&&p(r,["name"],i);const s=d(e,["state"]);s!=null&&p(r,["state"],pE(s));const a=d(e,["createTime"]);a!=null&&p(r,["createTime"],a);const o=d(e,["tuningTask","startTime"]);o!=null&&p(r,["startTime"],o);const c=d(e,["tuningTask","completeTime"]);c!=null&&p(r,["endTime"],c);const l=d(e,["updateTime"]);l!=null&&p(r,["updateTime"],l);const u=d(e,["description"]);u!=null&&p(r,["description"],u);const h=d(e,["baseModel"]);h!=null&&p(r,["baseModel"],h);const m=d(e,["_self"]);return m!=null&&p(r,["tunedModel"],xU(m)),r}function N0(e,t){const r={},n=d(e,["sdkHttpResponse"]);n!=null&&p(r,["sdkHttpResponse"],n);const i=d(e,["name"]);i!=null&&p(r,["name"],i);const s=d(e,["state"]);s!=null&&p(r,["state"],pE(s));const a=d(e,["createTime"]);a!=null&&p(r,["createTime"],a);const o=d(e,["startTime"]);o!=null&&p(r,["startTime"],o);const c=d(e,["endTime"]);c!=null&&p(r,["endTime"],c);const l=d(e,["updateTime"]);l!=null&&p(r,["updateTime"],l);const u=d(e,["error"]);u!=null&&p(r,["error"],u);const h=d(e,["description"]);h!=null&&p(r,["description"],h);const m=d(e,["baseModel"]);m!=null&&p(r,["baseModel"],m);const x=d(e,["tunedModel"]);x!=null&&p(r,["tunedModel"],x);const g=d(e,["preTunedModel"]);g!=null&&p(r,["preTunedModel"],g);const v=d(e,["supervisedTuningSpec"]);v!=null&&p(r,["supervisedTuningSpec"],v);const y=d(e,["preferenceOptimizationSpec"]);y!=null&&p(r,["preferenceOptimizationSpec"],y);const E=d(e,["tuningDataStats"]);E!=null&&p(r,["tuningDataStats"],E);const w=d(e,["encryptionSpec"]);w!=null&&p(r,["encryptionSpec"],w);const T=d(e,["partnerModelTuningSpec"]);T!=null&&p(r,["partnerModelTuningSpec"],T);const k=d(e,["customBaseModel"]);k!=null&&p(r,["customBaseModel"],k);const b=d(e,["experiment"]);b!=null&&p(r,["experiment"],b);const I=d(e,["labels"]);I!=null&&p(r,["labels"],I);const S=d(e,["outputUri"]);S!=null&&p(r,["outputUri"],S);const B=d(e,["pipelineJob"]);B!=null&&p(r,["pipelineJob"],B);const D=d(e,["serviceAccount"]);D!=null&&p(r,["serviceAccount"],D);const H=d(e,["tunedModelDisplayName"]);H!=null&&p(r,["tunedModelDisplayName"],H);const Y=d(e,["veoTuningSpec"]);return Y!=null&&p(r,["veoTuningSpec"],Y),r}function yU(e,t){const r={},n=d(e,["sdkHttpResponse"]);n!=null&&p(r,["sdkHttpResponse"],n);const i=d(e,["name"]);i!=null&&p(r,["name"],i);const s=d(e,["metadata"]);s!=null&&p(r,["metadata"],s);const a=d(e,["done"]);a!=null&&p(r,["done"],a);const o=d(e,["error"]);return o!=null&&p(r,["error"],o),r}function F1(e,t){const r={},n=d(e,["gcsUri"]);n!=null&&p(r,["validationDatasetUri"],n);const i=d(e,["vertexDatasetResource"]);return i!=null&&p(r,["validationDatasetUri"],i),r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wU extends Fi{constructor(t){super(),this.apiClient=t,this.get=async r=>await this.getInternal(r),this.list=async(r={})=>new ta(Ci.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(r),r),this.tune=async r=>{var n;if(this.apiClient.isVertexAI())if(r.baseModel.startsWith("projects/")){const i={tunedModelName:r.baseModel};!((n=r.config)===null||n===void 0)&&n.preTunedModelCheckpointId&&(i.checkpointId=r.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},r),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},r);return await this.tuneInternal(i)}else{const i=Object.assign({},r),s=await this.tuneMldevInternal(i);let a="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?a=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(a=s.name.split("/operations/")[0]),{name:a,state:w0.JOB_STATE_QUEUED}}}}async getInternal(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=cU(t);return o=Le("{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>N0(u))}else{const l=lU(t);return o=Le("{name}",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>PE(u))}}async listInternal(t){var r,n,i,s;let a,o="",c={};if(this.apiClient.isVertexAI()){const l=hU(t);return o=Le("tuningJobs",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=mU(u),m=new u1;return Object.assign(m,h),m})}else{const l=dU(t);return o=Le("tunedModels",l._url),c=l._query,delete l._url,delete l._query,a=this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:u.headers},m})),a.then(u=>{const h=pU(u),m=new u1;return Object.assign(m,h),m})}}async cancel(t){var r,n,i,s;let a="",o={};if(this.apiClient.isVertexAI()){const c=nU(t);a=Le("{name}:cancel",c._url),o=c._query,delete c._url,delete c._query,await this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal})}else{const c=rU(t);a=Le("{name}:cancel",c._url),o=c._query,delete c._url,delete c._query,await this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=oU(t,t);return s=Le("tuningJobs",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json().then(l=>{const u=l;return u.sdkHttpResponse={headers:c.headers},u})),i.then(c=>N0(c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var r,n;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=aU(t);return s=Le("tunedModels",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json().then(l=>{const u=l;return u.sdkHttpResponse={headers:c.headers},u})),i.then(c=>yU(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class EU{async download(t,r){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const TU=1024*1024*8,_U=3,SU=1e3,kU=2,Ru="x-goog-upload-status";async function CU(e,t,r){var n;const i=await ME(e,t,r),s=await(i==null?void 0:i.json());if(((n=i==null?void 0:i.headers)===null||n===void 0?void 0:n[Ru])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function NU(e,t,r){var n;const i=await ME(e,t,r),s=await(i==null?void 0:i.json());if(((n=i==null?void 0:i.headers)===null||n===void 0?void 0:n[Ru])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const a=lE(s),o=new pp;return Object.assign(o,a),o}async function ME(e,t,r){var n,i;let s=0,a=0,o=new E0(new Response),c="upload";for(s=e.size;a<s;){const l=Math.min(TU,s-a),u=e.slice(a,a+l);a+l>=s&&(c+=", finalize");let h=0,m=SU;for(;h<_U&&(o=await r.request({path:"",body:u,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(a),"Content-Length":String(l)}}}),!(!((n=o==null?void 0:o.headers)===null||n===void 0)&&n[Ru]));)h++,await bU(m),m=m*kU;if(a+=l,((i=o==null?void 0:o.headers)===null||i===void 0?void 0:i[Ru])!=="active")break;if(s<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return o}async function AU(e){return{size:e.size,type:e.type}}function bU(e){return new Promise(t=>setTimeout(t,e))}class IU{async upload(t,r,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await CU(t,r,n)}async uploadToFileSearchStore(t,r,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await NU(t,r,n)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await AU(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class FU{create(t,r,n){return new RU(t,r,n)}}class RU{constructor(t,r,n){this.url=t,this.headers=r,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const R1="x-goog-api-key";class PU{constructor(t){this.apiKey=t}async addAuthHeaders(t,r){if(t.get(R1)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(R1,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const MU="gl-node/";class Kl{constructor(t){var r;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(r=t.vertexai)!==null&&r!==void 0?r:!1,this.apiKey=t.apiKey;const n=f5(t.httpOptions,t.vertexai,void 0,void 0);n&&(t.httpOptions?t.httpOptions.baseUrl=n:t.httpOptions={baseUrl:n}),this.apiVersion=t.apiVersion;const i=new PU(this.apiKey);this.apiClient=new Y8({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:MU+"web",uploader:new IU,downloader:new EU}),this.models=new mO(this.apiClient),this.live=new cO(this.apiClient,i,new FU),this.batches=new $D(this.apiClient),this.chats=new E6(this.models,this.apiClient),this.caches=new v6(this.apiClient),this.files=new F6(this.apiClient),this.operations=new xO(this.apiClient),this.authTokens=new RO(this.apiClient),this.tunings=new wU(this.apiClient),this.fileSearchStores=new tU(this.apiClient)}}const wp=[{id:"gemini-1.5-flash-002",name:"Gemini 1.5 Flash",provider:"gemini",description:"Fast & cost-effective (stable)",contextWindow:1e6},{id:"gemini-1.5-pro-002",name:"Gemini 1.5 Pro",provider:"gemini",description:"Powerful for complex reasoning",contextWindow:1e6},{id:"gemini-2.0-flash-exp",name:"Gemini 2.0 Flash Exp",provider:"gemini",description:"Latest 2.0 experimental model",contextWindow:1e6},{id:"gemini-2.5-flash",name:"Gemini 2.5 Flash",provider:"gemini",description:"Fast & reliable (confirmed working)",contextWindow:1e6,isRecommended:!0},{id:"gemini-3.0-pro",name:"Gemini 3.0 Pro",provider:"gemini",description:"Most powerful Gemini model",contextWindow:1e6},{id:"gemini-3.0-flash",name:"Gemini 3.0 Flash",provider:"gemini",description:"Latest & fastest Gemini 3",contextWindow:1e6},{id:"gemini-exp-1206",name:"Gemini Exp 1206",provider:"gemini",description:"December experimental",contextWindow:1e6},{id:"gpt-4o",name:"GPT-4o",provider:"openai",description:"Most capable multimodal model",isRecommended:!0},{id:"gpt-4o-mini",name:"GPT-4o Mini",provider:"openai",description:"Fast & cost-effective"},{id:"gpt-4-turbo",name:"GPT-4 Turbo",provider:"openai",description:"High performance GPT-4"},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo",provider:"openai",description:"Legacy, low-cost option"},{id:"o1-mini",name:"o1 Mini",provider:"openai",description:"Reasoning model for math & code"},{id:"claude-3-5-sonnet-20241022",name:"Claude 3.5 Sonnet",provider:"claude",description:"Best overall Claude model",contextWindow:2e5,isRecommended:!0},{id:"claude-3-5-haiku-20241022",name:"Claude 3.5 Haiku",provider:"claude",description:"Fast & cost-efficient",contextWindow:2e5},{id:"claude-3-opus-20240229",name:"Claude 3 Opus",provider:"claude",description:"Most intelligent Claude 3",contextWindow:2e5},{id:"claude-3-sonnet-20240229",name:"Claude 3 Sonnet",provider:"claude",description:"Balanced performance",contextWindow:2e5},{id:"meta-llama/Llama-3.3-70B-Instruct",name:"Llama 3.3 70B",provider:"huggingface",description:"Meta - 128K context (needs proxy)",contextWindow:128e3,isRecommended:!0},{id:"mistralai/Mixtral-8x7B-Instruct-v0.1",name:"Mixtral 8x7B",provider:"huggingface",description:"Mistral MoE (needs proxy)"},{id:"google/gemma-2-27b-it",name:"Gemma 2 27B",provider:"huggingface",description:"Google open model (needs proxy)"}],Ao={gemini:{name:"Google Gemini",apiKeyUrl:"https://aistudio.google.com/app/apikey",icon:""},openai:{name:"OpenAI",apiKeyUrl:"https://platform.openai.com/api-keys",icon:""},claude:{name:"Anthropic Claude",apiKeyUrl:"https://console.anthropic.com/settings/keys",icon:""},huggingface:{name:"HuggingFace",apiKeyUrl:"https://huggingface.co/settings/tokens",icon:""}},P1=e=>wp.filter(t=>t.provider===e),DU=e=>wp.find(t=>t.id===e),A0=e=>{const t=DU(e);return(t==null?void 0:t.provider)||"gemini"},LU=e=>e?e>=1e6?`${(e/1e6).toFixed(0)}M`:`${(e/1e3).toFixed(0)}K`:"";async function OU(e,t,r,n){const i=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({model:t,messages:[{role:"system",content:r},{role:"user",content:n}],response_format:{type:"json_object"},max_tokens:16e3,temperature:.7})});if(!i.ok){const a=await i.text();throw new Error(`OpenAI API Error (${i.status}): ${a}`)}return{text:(await i.json()).choices[0].message.content}}async function UU(e,t,r,n){const i=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":e,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:t,max_tokens:16e3,system:r,messages:[{role:"user",content:n}]})});if(!i.ok){const a=await i.text();throw new Error(`Claude API Error (${i.status}): ${a}`)}return{text:(await i.json()).content[0].text}}async function BU(e,t,r,n){var c;const i=`${r}

${n}`,s=await fetch(`https://api-inference.huggingface.co/models/${t}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({inputs:i,parameters:{max_new_tokens:16e3,temperature:.7,return_full_text:!1}})});if(!s.ok){const l=await s.text();throw new Error(`HuggingFace API Error (${s.status}): ${l}`)}const a=await s.json();return{text:Array.isArray(a)?a[0].generated_text:a.generated_text||((c=a[0])==null?void 0:c.generated_text)||""}}const Rt=()=>Math.random().toString(36).substr(2,9),Wn=async(e,t={},r=5e3)=>{const n=new AbortController,i=setTimeout(()=>n.abort(),r);try{const s=await fetch(e,{...t,signal:n.signal});return clearTimeout(i),s}catch(s){throw clearTimeout(i),s}};async function $U(e){var t,r;try{const n=new URLSearchParams({q:e,per_page:"1",locale:"pt-BR"}),i=await Wn(`https://api.inaturalist.org/v1/taxa?${n}`,{},5e3);if(!i.ok)return null;const s=await i.json();if(s.results&&s.results.length>0){const a=s.results[0];if((t=a.default_photo)!=null&&t.medium_url)return a.default_photo.medium_url;if((r=a.default_photo)!=null&&r.square_url)return a.default_photo.square_url.replace("/square.","/medium.")}return null}catch(n){return console.warn(`iNaturalist fetch failed for "${e}":`,n),null}}async function jU(e){return null}async function GU(e){var t,r;try{const n=new URLSearchParams({q:e,per_page:"3",locale:"pt",preferred_place_id:"7122"}),i=await Wn(`https://api.inaturalist.org/v1/taxa?${n}`,{},5e3);if(!i.ok)return null;const s=await i.json();if(s.results&&s.results.length>0)for(const a of s.results){if((t=a.default_photo)!=null&&t.medium_url)return a.default_photo.medium_url;if((r=a.default_photo)!=null&&r.square_url)return a.default_photo.square_url.replace("/square.","/medium.")}return null}catch(n){return console.warn(`Biodiversity4All fetch failed for "${e}":`,n),null}}async function VU(e,t="pt"){var r,n;try{const i=t==="pt"?["pt","en"]:["en","pt"];for(const s of i){const a=`https://${s}.wikipedia.org/w/api.php`,o=new URLSearchParams({action:"query",titles:e,prop:"pageimages",pithumbsize:"400",format:"json",origin:"*",redirects:"1"}),c=await Wn(`${a}?${o}`,{},5e3);if(!c.ok)continue;const u=(r=(await c.json()).query)==null?void 0:r.pages;if(u){const h=Object.keys(u)[0],m=u[h];if(m&&!m.missing&&((n=m.thumbnail)!=null&&n.source)){let x=m.thumbnail.source;return x=x.replace(/\/\d+px-/,"/400px-"),x}}}return null}catch(i){return console.warn(`Wikipedia fetch failed for "${e}":`,i),null}}async function HU(e){var t;try{const r=`https://plantillustrations.org/api.php?action=opensearch&search=${encodeURIComponent(e)}&limit=5&format=json`,n=`https://www.biodiversitylibrary.org/api3?op=PublicationSearch&searchterm=${encodeURIComponent(e)}&searchtype=F&page=1&apikey=&format=json`,i=`https://www.biodiversitylibrary.org/api3?op=NameSearch&name=${encodeURIComponent(e)}&format=json`,s=await Wn(i,{},5e3);if(!s.ok)return null;const a=await s.json();if(a.Result&&a.Result.length>0){const o=a.Result[0];if(o.BHLTITLE){const c=`https://www.biodiversitylibrary.org/api3?op=GetTitleMetadata&id=${o.TitleID}&items=t&format=json`,l=await Wn(c,{},5e3);if(l.ok){const u=await l.json();if((t=u.Result)!=null&&t.Items){for(const h of u.Result.Items)if(h.ThumbnailUrl)return h.ThumbnailUrl}}}}return null}catch(r){return console.warn(`Plant Illustrations/BHL fetch failed for "${e}":`,r),null}}async function zU(e){var t,r,n,i,s,a,o,c;try{const l=encodeURIComponent(e),u=await Wn(`https://api.plantnet.org/v1/species?q=${l}&limit=1`,{headers:{Accept:"application/json"}},5e3);if(!u.ok){const m=await Wn(`https://my-api.plantnet.org/v2/species/search?q=${l}&lang=pt`,{headers:{Accept:"application/json"}},5e3);if(!m.ok)return null;const x=await m.json();if(x.results&&x.results.length>0){const g=x.results[0];if(g.images&&g.images.length>0){const v=g.images[0];if((t=v.url)!=null&&t.m)return v.url.m;if((r=v.url)!=null&&r.s)return v.url.s;if((n=v.url)!=null&&n.o)return v.url.o}}return null}const h=await u.json();if(h.results&&h.results.length>0)for(const m of h.results){if(m.images&&m.images.length>0){const x=m.images[0];if((i=x.url)!=null&&i.m)return x.url.m;if((s=x.url)!=null&&s.s)return x.url.s;if((a=x.url)!=null&&a.o)return x.url.o;if(typeof x.url=="string")return x.url}if(m.defaultImage){if(m.defaultImage.m)return m.defaultImage.m;if(m.defaultImage.s)return m.defaultImage.s}}if(h.species&&h.species.images&&h.species.images.length>0){const m=h.species.images[0];if((o=m.url)!=null&&o.m)return m.url.m;if((c=m.url)!=null&&c.s)return m.url.s}return null}catch(l){return console.warn(`PlantNet fetch failed for "${e}":`,l),null}}async function WU(e){var t,r;try{const n=new URLSearchParams({q:e,f:"accepted_names"}),i=await Wn(`https://powo.science.kew.org/api/2/search?${n}`,{headers:{Accept:"application/json"}},5e3);if(!i.ok){const a=new URLSearchParams({q:e,perPage:"1"}),o=await Wn(`https://www.ipni.org/api/1/search?${a}`,{headers:{Accept:"application/json"}},5e3);if(!o.ok)return null;const c=await o.json();if(c.results&&c.results.length>0){const l=c.results[0];if(l.fqId){const u=`https://powo.science.kew.org/taxon/${l.fqId}`;return null}}return null}const s=await i.json();if(s.results&&s.results.length>0)for(const a of s.results){if(a.images&&a.images.length>0){const o=a.images[0];if(o.url)return o.url;if(o.thumbnail)return o.thumbnail}if(a.fqId)try{const o=await Wn(`https://powo.science.kew.org/api/2/taxon/${a.fqId}`,{headers:{Accept:"application/json"}},5e3);if(o.ok){const c=await o.json();if(c.images&&c.images.length>0){const l=c.images[0];if(l.url)return l.url;if(l.thumbnail)return l.thumbnail}if(((r=(t=c.distribution)==null?void 0:t.images)==null?void 0:r.length)>0){const l=c.distribution.images[0];if(l.url)return l.url}}}catch{}}return null}catch(n){return console.warn(`POWO fetch failed for "${e}":`,n),null}}async function qU(e){var t,r,n;try{const i="https://commons.wikimedia.org/w/api.php",s=new URLSearchParams({action:"query",generator:"search",gsrsearch:`${e}`,gsrnamespace:"6",gsrlimit:"5",prop:"imageinfo",iiprop:"url|mime",iiurlwidth:"400",format:"json",origin:"*"}),a=await Wn(`${i}?${s}`,{},5e3);if(!a.ok)return null;const c=(t=(await a.json()).query)==null?void 0:t.pages,l=[/Flora_Brasiliensis/i,/Flora_Fluminensis/i,/Systema_Naturae/i,/Species_Plantarum/i,/Genera_Plantarum/i,/Prodromus_Systematis/i,/Historia_Naturalis/i,/\/page\d+-\d+px-/i,/\.djvu\//i,/Volume_\d+/i,/Part_\d+/i,/Book_cover/i,/Title_page/i,/Frontispiece/i,/Index_page/i,/Table_of_contents/i,/Herbarium_sheet_only/i,/\.svg\//i,/Municip[io_]/i,/Microregion/i,/Mesoregion/i,/Locator_map/i,/_location/i,/_map\./i,/_in_Brazil/i,/_in_South_America/i,/Brazil_location/i,/Estado_de_/i,/Bandeira_de_/i,/Brasao_de_/i,/Coat_of_arms/i,/Flag_of_/i,/Phylogenetic_tree/i,/Cladogram/i,/Distribution_map/i,/Range_map/i,/Logo[_\-]/i,/Icon[_\-]/i,/Stamp_of_/i,/Coin_of_/i,/Infographic/i];if(c)for(const u of Object.values(c)){const h=(r=u==null?void 0:u.imageinfo)==null?void 0:r[0];if(h!=null&&h.thumburl&&((n=h==null?void 0:h.mime)!=null&&n.startsWith("image/"))){const m=h.thumburl;if(l.some(g=>g.test(m))){console.log(`[Wikimedia] Rejected generic image: ${m.substring(0,100)}...`);continue}return m}}return null}catch(i){return console.warn(`Wikimedia Commons fetch failed for "${e}":`,i),null}}function Dl(e){if(!e)return"";let t=e.replace(/\s*\([^)]*\)\s*/g," ").trim();if(/^[A-Z][a-z]+(aceae|idae|ales|ineae|oidea|iformes)$/i.test(t))return"";const r=t.split(/\s+/);if(r.length>=2){const n=r[0],i=r[1];if(/^(aceae|idae|ales|ineae|oidea|iformes)$/i.test(i))return n;if(/^[a-z]/.test(i)&&!i.includes("."))return`${n} ${i}`}return r.length===1&&!/aceae|idae|ales$/i.test(r[0])?r[0]:t}async function JU(e,t,r="pt",n="FLORA"){const i=t?Dl(t):null,s=Dl(e),a=[i,s,t!==i?t:null,e!==s?e:null].filter(Boolean),o=[...new Set(a)];for(const c of o){if(n==="FLORA"||n==="FAUNA"){const m=await GU(c);if(m)return m;const x=await $U(c);if(x)return x}const l=await jU();if(l)return l;const u=await VU(c,r);if(u)return u;if(n==="FLORA"){const m=await HU(c);if(m)return m}const h=await qU(c);if(h)return h;if(n==="FLORA"){const m=await zU(c);if(m)return m;const x=await WU(c);if(x)return x}}return null}async function b0(e,t="pt",r,n="FLORA"){var a;const i=new Map,s=3;for(let o=0;o<e.length;o+=s){const c=e.slice(o,o+s),l=c.map(async h=>{const m=await JU(h.name,h.scientificName,t,n);return{name:h.name,url:m}});if((await Promise.all(l)).forEach(h=>{h.url&&i.set(h.name,h.url)}),r){const h=Math.min(o+s,e.length),m=((a=c[c.length-1])==null?void 0:a.name)||"";r(h,e.length,m)}o+s<e.length&&await new Promise(h=>setTimeout(h,150))}return i}function rl(e){return""}function Ep(e,t,r){const n=[];if(!e||e.length<3)return n;const i=e.trim(),s=encodeURIComponent(i);i.replace(/\s+/g,"_");const a=r==="pt"?"pt":"en";return n.push({id:Rt(),label:"Wikipedia",url:`https://${a}.wikipedia.org/wiki/Special:Search?search=${s}&go=Go`}),n.push({id:Rt(),label:"GBIF",url:`https://www.gbif.org/species/search?q=${s}`}),n.push({id:Rt(),label:"iNaturalist",url:`https://www.inaturalist.org/search?q=${s}`}),r==="pt"&&n.push({id:Rt(),label:"Flora e Funga do Brasil",url:`https://floradobrasil.jbrj.gov.br/consulta/busca.html?q=${s}`}),r==="pt"&&n.push({id:Rt(),label:"Biodiversity4All",url:`https://www.biodiversity4all.org/search?q=${s}`}),r==="pt"&&n.push({id:Rt(),label:"SIDOL",url:`https://www.sidol.com.br/busca?q=${s}`}),r==="pt"&&n.push({id:Rt(),label:"Flora Digital UFSC",url:`https://floradigital.ufsc.br/busca.php?q=${s}`}),n.push({id:Rt(),label:"Flickr",url:`https://www.flickr.com/search/?text=${s}`}),n.push({id:Rt(),label:"POWO",url:`https://powo.science.kew.org/results?q=${s}`}),n.slice(0,5)}function Qa(e){const t=e.match(/\(([A-Z][a-z]+ [a-z]+[^)]*)\)/);return t?t[1]:/^([A-Z][a-z]+)\s+([a-z]+)(\s+.*)?$/.test(e)?e.split(/\s+-\s+/)[0].trim():null}const ni=e=>{try{return JSON.parse(e)}catch{console.warn("JSON truncated. Attempting repair...");let r=e.trim();const n=s=>{let a=!1,o=!1;for(let c=0;c<s.length;c++)o?o=!1:s[c]==="\\"?o=!0:s[c]==='"'&&(a=!a);return a?s+'"':s},i=[()=>{console.log("Strategy 1: Closing brackets...");let s=n(r);s=s.replace(/,\s*$/,"");const a=[];let o=!1,c=!1;for(let l=0;l<s.length;l++){const u=s[l];if(c){c=!1;continue}if(u==="\\"){c=!0;continue}if(u==='"'){o=!o;continue}o||(u==="{"?a.push("}"):u==="["?a.push("]"):(u==="}"||u==="]")&&a.length>0&&a[a.length-1]===u&&a.pop())}return s+=a.reverse().join(""),JSON.parse(s)},()=>{console.log("Strategy 2: Truncating to last complete entity...");let s=r;const a=Math.max(s.lastIndexOf("},"),s.lastIndexOf("}]"));a>0&&(s=s.substring(0,a+1)),s=n(s);const o=[];let c=!1,l=!1;for(let u=0;u<s.length;u++){const h=s[u];if(l){l=!1;continue}if(h==="\\"){l=!0;continue}if(h==='"'){c=!c;continue}c||(h==="{"?o.push("}"):h==="["?o.push("]"):(h==="}"||h==="]")&&o.length>0&&o[o.length-1]===h&&o.pop())}return s+=o.reverse().join(""),JSON.parse(s)},()=>{console.log("Strategy 3: Dynamic walk-back (Optimized)...");let s=r;const a=Math.floor(s.length*.4);for(let o=s.length-1;o>a;o--){const c=s[o];if(c!=="}"&&c!=="]")continue;const l=s.substring(0,o+1);try{let u=n(l);const h=[];let m=!1,x=!1;for(const v of u)x?x=!1:v==="\\"?x=!0:v==='"'?m=!m:m||(v==="{"?h.push("}"):v==="["?h.push("]"):(v==="}"||v==="]")&&h.length&&h[h.length-1]===v&&h.pop());u+=h.reverse().join("");const g=JSON.parse(u);if(g.entities&&g.entities.length>0||g.features&&g.features.length>0||g.filledEntities&&g.filledEntities.length>0)return console.log(`Strategy 3 success at index ${o}`),g}catch{}}throw new Error("Strategy 3 failed")},()=>{console.warn("Strategy 4: Attempting regex-based entity extraction...");const s=/{[^{}]*"id"\s*:\s*"[^"]+"[^{}]*}/g,a=r.match(s);if(a&&a.length>0){const o=[];for(const c of a)try{o.push(JSON.parse(c))}catch{}if(o.length>0)return{entities:o}}throw new Error("Strategy 4 failed")}];for(let s=0;s<i.length;s++)try{const a=Date.now(),o=i[s]();return console.log(`JSON repair successful with strategy ${s+1} (${Date.now()-a}ms)`),o}catch{}return console.error("All repair strategies failed. Returning empty object to prevent process crash."),{}}},DE={type:me.OBJECT,properties:{name:{type:me.STRING,description:"Name of the feature (e.g., 'Wing Color')"},imageUrl:{type:me.STRING,description:"URL for feature illustration"},states:{type:me.ARRAY,items:{type:me.STRING,description:"A state description (e.g., 'Blue')"}}},required:["name","states"]},LE={type:me.OBJECT,properties:{label:{type:me.STRING,description:"Title of the link (e.g., 'Wikipedia', 'GBIF')"},url:{type:me.STRING,description:"Full URL"}},required:["label","url"]},Tp={type:me.OBJECT,properties:{projectName:{type:me.STRING},projectDescription:{type:me.STRING},features:{type:me.ARRAY,items:DE},entities:{type:me.ARRAY,items:{type:me.OBJECT,properties:{name:{type:me.STRING,description:"Entity name (can be common name or scientific name)"},id:{type:me.STRING,description:"Preserve original ID if available"},imageUrl:{type:me.STRING,description:"Preserve original image URL if available"},scientificName:{type:me.STRING,description:"Scientific binomial name (e.g., 'Panthera leo'). REQUIRED for biological species."},family:{type:me.STRING,description:"Taxonomic family name (e.g., 'Felidae', 'Fabaceae'). REQUIRED for biological species."},description:{type:me.STRING},links:{type:me.ARRAY,items:LE,description:"External resources"},traits:{type:me.ARRAY,items:{type:me.OBJECT,properties:{featureName:{type:me.STRING,description:"Must match one of the feature names exactly"},stateValue:{type:me.STRING,description:"Must match one of the state values for that feature exactly"}},required:["featureName","stateValue"]}}},required:["name","description","traits"]}}},required:["projectName","projectDescription","features","entities"]},KU={type:me.OBJECT,properties:{projectName:{type:me.STRING},projectDescription:{type:me.STRING},features:{type:me.ARRAY,items:DE},entities:{type:me.ARRAY,items:{type:me.OBJECT,properties:{name:{type:me.STRING,description:"Entity name as found in document"},scientificName:{type:me.STRING,description:"Scientific binomial name if available (e.g., 'Panthera leo')"},family:{type:me.STRING,description:"Taxonomic family name if available (e.g., 'Felidae', 'Fabaceae')"},description:{type:me.STRING},links:{type:me.ARRAY,items:LE,description:"External resources"},traits:{type:me.ARRAY,items:{type:me.OBJECT,properties:{featureName:{type:me.STRING,description:"Must match one of the feature names exactly"},stateValue:{type:me.STRING,description:"Must match one of the state values for that feature exactly"}},required:["featureName","stateValue"]}}},required:["name","description","traits"]}}},required:["projectName","projectDescription","features","entities"]},sd={type:me.OBJECT,properties:{features:{type:me.ARRAY,description:"Optional: new features to add. If not adding features, can be omitted or empty array.",items:{type:me.OBJECT,properties:{id:{type:me.STRING,description:"Generate a new unique ID for new features (9 random chars)"},name:{type:me.STRING,description:"Feature name"},imageUrl:{type:me.STRING,description:"Optional image URL for the feature"},states:{type:me.ARRAY,description:"At least 2 states required",items:{type:me.OBJECT,properties:{id:{type:me.STRING,description:"Generate a new unique ID for each state (9 random chars)"},label:{type:me.STRING,description:"State label/value"},imageUrl:{type:me.STRING,description:"Optional image URL for this state"}},required:["id","label"]}}},required:["id","name","states"]}},entities:{type:me.ARRAY,items:{type:me.OBJECT,properties:{id:{type:me.STRING,description:"REQUIRED: The exact entity ID from the input - MUST preserve original ID exactly"},name:{type:me.STRING,description:"Entity name - MUST preserve original name if not explicitly changing"},scientificName:{type:me.STRING,description:"Scientific binomial name - MUST preserve original if present"},family:{type:me.STRING,description:"Taxonomic family name - MUST preserve original if present"},description:{type:me.STRING,description:"Entity description - can be enhanced"},traitsMap:{type:me.STRING,description:'JSON string of traits object in format {"featureId": ["stateId", ...]} - MUST use exact IDs from input AND new feature IDs if adding features'}},required:["id","name","traitsMap"]}},stats:{type:me.OBJECT,properties:{processedCount:{type:me.NUMBER,description:"Number of entities processed"},modifiedCount:{type:me.NUMBER,description:"Number of entities with added/changed traits"},skippedCount:{type:me.NUMBER,description:"Number of entities skipped (no changes needed)"},featuresAdded:{type:me.NUMBER,description:"Number of new features added"}}}},required:["entities"]},M1={type:me.OBJECT,properties:{filledEntities:{type:me.ARRAY,items:{type:me.OBJECT,properties:{entityId:{type:me.STRING,description:"The exact entity ID from input"},filledTraits:{type:me.ARRAY,description:"List of traits to add",items:{type:me.OBJECT,properties:{featureId:{type:me.STRING},stateIds:{type:me.ARRAY,items:{type:me.STRING}}},required:["featureId","stateIds"]}}},required:["entityId","filledTraits"]}},stats:{type:me.OBJECT,properties:{entitiesWithGaps:{type:me.NUMBER},traitsAdded:{type:me.NUMBER}}}},required:["filledEntities"]},YU={type:me.OBJECT,properties:{validatedEntities:{type:me.ARRAY,items:{type:me.OBJECT,properties:{id:{type:me.STRING,description:"Original Entity ID (exact match)"},isValid:{type:me.BOOLEAN,description:"Whether the entity passed validation criteria"},scientificName:{type:me.STRING,description:"Corrected scientific binomial name (e.g. 'Genus species')"},family:{type:me.STRING,description:"Corrected taxonomic family"},correctionNote:{type:me.STRING,description:"Reason for correction or removal, or empty if valid"}},required:["id","isValid","scientificName","family"]}}},required:["validatedEntities"]},OE=e=>{const t=e.language==="pt"?"All content (Project Name, Description, Features, States, Entities, Descriptions) MUST be in Portuguese (Brazil).":"All content must be in English.";let r="",n="";e.category==="FAUNA"?(r="Focus on zoological characteristics. Use appropriate terminology for animals (morphology, behavior, habitat).",n="For biological entities, ALWAYS provide: 1) the scientific binomial name (e.g., 'Panthera leo', 'Ara macao'), and 2) the taxonomic family (e.g., 'Felidae', 'Psittacidae'). Both are REQUIRED for accurate classification."):e.category==="OTHER"?(r="Focus on the specific domain of the topic. Use appropriate terminology for the subject matter.",n="For non-biological entities, the scientificName field MUST NOT be left empty. Use the most precise standard name, original title, formal designation, or if none apply, simply copy the entity name. This field is REQUIRED for all entities."):(r="Focus on botanical characteristics. Use appropriate terminology for plants.",n="For biological entities, ALWAYS provide: 1) the scientific binomial name (e.g., 'Panthera leo', 'Quercus robur'), and 2) the taxonomic family (e.g., 'Felidae', 'Fabaceae'). Both are REQUIRED for accurate classification.");let i=e.includeFeatureImages?"For each feature, provide a valid, DIRECT public URL to an image file illustrating the trait if available.":"Leave `imageUrl` empty for features.";const s="Leave the 'links' array empty (links will be generated automatically from scientific names).";if(e.importedFile){let g="Extract ALL distinctive features found in the text.";e.featureFocus==="vegetative"?g="STRICTLY EXTRACT ONLY VEGETATIVE features (leaves, bark, stem, roots, growth habit). IGNORE reproductive features (flowers, fruits, seeds).":e.featureFocus==="reproductive"&&(g="STRICTLY EXTRACT ONLY REPRODUCTIVE features (flowers, fruits, seeds, inflorescence). IGNORE vegetative features.");let v="Maintain the descriptions as close to the original text as possible (Balanced).";e.detailLevel===1?v="SIMPLIFY the descriptions. Use shorter, easier sentences. Remove excessive jargon.":e.detailLevel===3&&(v="MAXIMIZE DETAIL. Keep all scientific terms, measurements, and nuances found in the text.");const y=e.requiredFeatures&&e.requiredFeatures.length>0?`7. **REQUIRED FEATURES**: Prioritize extracting the following features if present in the document: ${e.requiredFeatures.join(", ")}. If the document doesn't mention them explicitly, still try to infer reasonable states for these features based on context.`:"",E=`
      You are an expert biologist and data analyst.
      Your task is to analyze the provided document (PDF, Text, or Image) and extract a structured Matrix Identification Key.
      
      **Goal**: Extract entities and features to build a matrix.
      
      **CRITICAL INSTRUCTIONS**: 
      1. You must extract **EVERY SINGLE** species/entity found in the text. DO NOT truncate the list.
      2. **FILTER**: ${g}
      3. **DETAIL**: ${v}
      4. **SCIENTIFIC NAMES**: ${n}
      5. **MEDIA**: 
         - Feature Images: ${i}
         - External Links: ${s}
      6. ${t}
      ${y}
      
      **Format**: Return valid JSON.
      **IMPORTANT**: Do not include markdown code fences (\`\`\`json ... \`\`\`). Return raw JSON only. Ensure all keys and string values are properly escaped.
    `,w=`
      Analyze the attached file. Extract a comprehensive biological identification key.
      
      - Project Name: Derive from document title.
      - Description: Summary of content.
      - Entities: Extract ALL entities found. Include scientific names for accurate image lookup.
      - Features: Extract distinctive traits based on the focus setting.
      - Matrix: Map traits to entities.
      
      If analyzing a Dichotomous Key, flatten the logic: assign all traits accumulated along the path to the species.
    `,T=[{inlineData:{mimeType:e.importedFile.mimeType,data:e.importedFile.data}},{text:w}];return{systemInstruction:E,prompt:w,parts:T,schema:KU}}let a="";e.featureFocus==="reproductive"?a="Focus primarily on reproductive features (e.g., flowers, fruits, seeds, cones, spores, inflorescence).":e.featureFocus==="vegetative"?a="Focus primarily on vegetative features (e.g., leaves, bark, stem, roots, growth habit, phyllo taxis).":a="Use a balanced mix of vegetative and reproductive features.";let o="";e.detailLevel===1?o="AUDIENCE: Children or General Public. Use simple, common language. Short descriptions. Avoid complex jargon.":e.detailLevel===3?o="AUDIENCE: Experts/Scientists. Use precise botanical/zoological terminology. Comprehensive descriptions. High detail.":o="AUDIENCE: Students/Enthusiasts. Balanced use of scientific terms with clear explanations.";const c=`
    You are an expert taxonomist and biologist. 
    Your task is to create an interactive identification key (matrix key) based strictly on the user's constraints.
    
    Constraints:
    1.  **Language**: ${t}
    2.  **Category**: ${r}
    3.  **Topic**: The general subject.
    4.  **Geography**: Restrict entities to this region/biome.
    5.  **Taxonomy**: Restrict to this Family/Genus/Order if specified.
    6.  **Quantity**: Generate exactly or close to the requested number of entities and features.
    7.  **Focus**: ${a}
    8.  **Detail Level**: ${o}
    9.  **SCIENTIFIC NAMES**: ${n}
    10. **MEDIA**: 
        - Feature Images: ${i}
        - External Links: ${s}
    ${e.requiredFeatures&&e.requiredFeatures.length>0?`11. **REQUIRED FEATURES**: You MUST include ALL of the following features in the key: ${e.requiredFeatures.join(", ")}. These are mandatory and must be among the features generated.`:""}
    ${e.requiredSpecies&&e.requiredSpecies.length>0?`12. **REQUIRED SPECIES**: You MUST include ALL of the following species in the key: ${e.requiredSpecies.slice(0,10).join(", ")}${e.requiredSpecies.length>10?` (and ${e.requiredSpecies.length-10} more)`:""}. These species are MANDATORY. For species with incomplete data, include them anyway and fill what you can.`:""}

    Output Requirements:
    1.  List of distinctive features. Each feature must have 2+ states.
    2.  List of entities with their scientific binomial names.
    3.  Matrix: Assign correct states.
    4.  **Scientific Accuracy**: Ensure traits are factual.

    The response must be a structured JSON object.
    **IMPORTANT**: Do not include markdown code fences (\`\`\`json ... \`\`\`). Return raw JSON only. Ensure all keys and string values are properly escaped.
  `,l=e.requiredFeatures&&e.requiredFeatures.length>0?`
    MANDATORY FEATURES: The following features MUST be included in the key:
    ${e.requiredFeatures.map((g,v)=>`${v+1}. ${g}`).join(`
    `)}
`:"",u=e.requiredSpecies&&e.requiredSpecies.length>0?`
    MANDATORY SPECIES: The following species MUST be included in the key. Include them even if feature data is incomplete - fill in what you can:
    ${e.requiredSpecies.map((g,v)=>`${v+1}. ${g}`).join(`
    `)}
`:"",h=()=>{const g=[];return e.scope==="global"?g.push("Global scope"):e.scope==="national"?g.push("Brazil (national)"):e.scope==="regional"&&g.push("Regional focus"),e.biome&&g.push(`Biome: ${e.biome}`),e.stateUF&&g.push(`State/UF: ${e.stateUF}`),e.geography&&g.push(`Region: ${e.geography}`),g.length>0?g.join(", "):"Global"},m=()=>{const g=[];return e.taxonomyFamily&&g.push(`Family: ${e.taxonomyFamily}`),e.taxonomyGenus&&g.push(`Genus: ${e.taxonomyGenus}`),e.taxonomy&&g.push(e.taxonomy),g.length>0?g.join(", "):"General"},x=`
    Create an identification key for: "${e.topic}".
    
    Constraints:
    - Language: ${e.language==="pt"?"Portuguese":"English"}
    - Geographic Scope: ${h()}
    - Taxonomic Context: ${m()}
    - Target Number of Entities: ${e.count}${e.requiredSpecies&&e.requiredSpecies.length>0?" (minimum - must include all required species plus additional if needed)":""}
    - Target Number of Features: ${e.featureCount}
    - Feature Focus: ${e.featureFocus}
    - Complexity Level: ${e.detailLevel}/3
    ${l}${u}
    IMPORTANT: For each entity, you MUST provide the scientificName field with the correct binomial nomenclature (e.g., "Panthera leo" for Lion).
    ${e.taxonomyFamily?`All entities MUST belong to the family ${e.taxonomyFamily}.`:""}
    ${e.taxonomyGenus?`All entities MUST belong to the genus ${e.taxonomyGenus}.`:""}
    ${e.biome?`All entities MUST occur in the ${e.biome} biome.`:""}
    ${e.stateUF?`All entities MUST occur in ${e.stateUF}, Brazil.`:""}
    ${e.scope==="national"?"All entities MUST occur in Brazil. Use Flora do Brasil 2020 as reference for valid names.":""}
    ${e.requiredSpecies&&e.requiredSpecies.length>0?`
CRITICAL: You MUST include ALL species from the MANDATORY SPECIES list above. For any species where you lack complete information, still include them and fill in what characteristics you can determine. These species are non-negotiable.`:""}

    Ensure the features allow for effective separation of these entities.
  `;return{systemInstruction:c,prompt:x,schema:Tp,parts:void 0}},XU=async(e,t,r,n)=>{var m,x;if(!t)throw new Error("API Key is missing");const i=A0(e.model),{systemInstruction:s,prompt:a,parts:o,schema:c}=OE(e);r&&r(`SYSTEM:
${s}

USER PROMPT:
${a}`);const l=o||a;let u;if(i==="gemini"){const g=new Kl({apiKey:t});u=await cf(g,e.model,l,s,c,e.language,e.includeLinks)}else if(i==="openai"){const g=await OU(t,e.model,s,a);u=ad(g.text,e.language,e.includeLinks)}else if(i==="claude"){const g=await UU(t,e.model,s,a);u=ad(g.text,e.language,e.includeLinks)}else if(i==="huggingface")try{const g=await BU(t,e.model,s,a);u=ad(g.text,e.language,e.includeLinks)}catch(g){throw(m=g.message)!=null&&m.includes("CORS")||(x=g.message)!=null&&x.includes("Failed to fetch")?new Error(e.language==="pt"?` Erro CORS: HuggingFace Inference API no pode ser acessada diretamente do navegador.

 Solues:
1. Use Gemini, OpenAI ou Claude (funcionam no navegador)
2. Configure um servidor proxy backend
3. Use HuggingFace Inference Endpoints (pago)`:` CORS Error: HuggingFace Inference API cannot be accessed directly from the browser.

 Solutions:
1. Use Gemini, OpenAI, or Claude (work in browser)
2. Set up a backend proxy server
3. Use HuggingFace Inference Endpoints (paid)`):g}else throw new Error(`Unsupported provider: ${i}`);if(e.requiredSpecies&&e.requiredSpecies.length>0){const g=new Set(u.entities.map(y=>y.name.toLowerCase().trim())),v=new Set(u.entities.map(y=>(y.scientificName||Qa(y.name)||"").toLowerCase().trim()));for(const y of e.requiredSpecies){const E=y.toLowerCase().trim(),w=Dl(y).toLowerCase().trim();if(!(g.has(E)||g.has(w)||v.has(E)||v.has(w)||Array.from(g).some(k=>k.includes(w)||w.includes(k))||Array.from(v).some(k=>k.includes(w)||w.includes(k)))){const k=Dl(y)||y,b={id:Rt(),name:k,description:e.language==="pt"?"Espcie includa da lista obrigatria. Dados a serem preenchidos.":"Species included from required list. Data to be filled.",imageUrl:rl(),links:e.includeLinks?Ep(k,"",e.language):[],traits:{}};b.scientificName=k,u.entities.push(b),g.add(k.toLowerCase().trim()),v.add(k.toLowerCase().trim())}}}const h=100;if(e.includeSpeciesImages&&u.entities.length>0){const g=u.entities.slice(0,h).map(y=>({name:y.name,scientificName:y.scientificName||Qa(y.name)||y.name})),v=await b0(g,e.language,n,e.category);u.entities=u.entities.map((y,E)=>{const w=E<h&&v.get(y.name)||rl(y.name);return{...y,imageUrl:w}})}return u},QU=async(e,t,r="gemini-2.0-flash",n="pt")=>{if(!t)throw new Error("API Key is missing");const i=new Kl({apiKey:t});return await cf(i,r,e,"You are an expert biologist. Return ONLY valid JSON matching the schema. Do not include markdown code fences.",Tp,n,!0)},D1=async(e,t,r,n="gemini-2.0-flash",i="pt",s="refine")=>{if(!r)throw new Error("API Key is missing");const a=new Kl({apiKey:r}),o=new Map(t.features.map(h=>[h.id,h])),c=new Map(t.entities.map(h=>[h.id,h])),l=s==="fillGaps"?M1:s==="clean"?Tp:sd;let u="";if(s==="fillGaps"?u="You are an expert taxonomist. Fill missing trait data. Use exact IDs.":s==="clean"?u="You are an expert taxonomist. Clean and optimize the key. Preserve all IDs.":u="You are an expert taxonomist. Improve key while preserving all IDs.",s==="fillGaps"){const h=t.entities.filter(y=>t.features.some(E=>{const w=y.traits[E.id];return!w||w.length===0}));if(h.length===0)return t;const m=10,x=new Map,g=JSON.stringify(t.features.map(y=>({id:y.id,name:y.name,states:y.states.map(E=>({id:E.id,label:E.label}))})));for(let y=0;y<h.length;y+=m){const E=h.slice(y,y+m),w="TASK: Fill traits. FEATURES: "+g+" ENTITIES: "+JSON.stringify(E.map(T=>({id:T.id,name:T.name})));try{const T=await Lo(a,n,w,u,M1),b=(ni(T)||{}).filledEntities||[];for(const I of b){const S={};Array.isArray(I.filledTraits)&&I.filledTraits.forEach(B=>{B.featureId&&B.stateIds&&(S[B.featureId]=B.stateIds)}),Object.keys(S).length>0&&x.set(I.entityId,S)}await new Promise(I=>setTimeout(I,2e3))}catch(T){console.error(`Error in fillGaps batch ${y/m}:`,T);continue}}const v=t.entities.map(y=>{const E=x.get(y.id);if(!E)return y;const w={...y.traits};for(const[T,k]of Object.entries(E)){const b=o.get(T);if(b){const I=b.states.map(S=>S.id);w[T]=[...new Set([...w[T]||[],...k.filter(S=>I.includes(S))])]}}return{...y,traits:w}});return{...t,entities:v}}if(s==="refine"&&t.entities.length>10){const m=t.entities;let x=[],g=[];const v=new Set;try{const w=m.slice(0,10),T=await Lo(a,n,e+" DATA: "+JSON.stringify({features:t.features,entities:w}),u,sd),k=ni(T)||{};k.features&&(g=k.features),k.entities&&k.entities.forEach(b=>{const I=c.get(b.id);if(I&&!v.has(b.id)){v.add(b.id);let S={};try{S=typeof b.traitsMap=="string"?ni(b.traitsMap):b.traitsMap||{}}catch{}x.push({...I,description:b.description&&b.description.length>15?b.description:I.description,traits:Object.keys(S).length>0?S:I.traits})}})}catch(w){console.error("Error in first refine batch:",w)}const y=[...t.features,...g],E=JSON.stringify(y.map(w=>({id:w.id,name:w.name,states:w.states.map(T=>({id:T.id,label:T.label}))})));for(let w=10;w<m.length;w+=10){const T=m.slice(w,w+10),k="TASK: Refine. FEATURES: "+E+" ENTITIES: "+JSON.stringify(T);try{const b=await Lo(a,n,k,u,sd),I=ni(b)||{};I.entities&&I.entities.forEach(S=>{const B=c.get(S.id);if(B&&!v.has(S.id)){v.add(S.id);let D={};try{D=typeof S.traitsMap=="string"?ni(S.traitsMap):S.traitsMap||{}}catch{}x.push({...B,description:S.description&&S.description.length>15?S.description:B.description,traits:Object.keys(D).length>0?D:B.traits})}}),await new Promise(S=>setTimeout(S,2e3))}catch(b){console.error(`Error in refine batch ${w/10}:`,b);continue}}return t.entities.forEach(w=>{v.has(w.id)||x.push(w)}),{...t,features:y,entities:x}}try{const h=JSON.stringify({features:t.features,entities:t.entities});if(s==="clean")return await cf(a,n,e+" DATA: "+h,u,l,i,!0);const m=await Lo(a,n,e+" DATA: "+h,u,l),x=ni(m)||{},g=[],v=new Set;x.entities&&x.entities.forEach(E=>{const w=c.get(E.id);if(v.has(E.id))return;v.add(E.id);let T={};try{T=typeof E.traitsMap=="string"?ni(E.traitsMap):E.traitsMap||{}}catch{}g.push({id:E.id||(w==null?void 0:w.id)||Rt(),name:E.name||(w==null?void 0:w.name)||"Unknown",scientificName:E.scientificName||(w==null?void 0:w.scientificName),family:E.family||(w==null?void 0:w.family),description:E.description&&E.description.length>15?E.description:(w==null?void 0:w.description)||"",imageUrl:(w==null?void 0:w.imageUrl)||"",links:(w==null?void 0:w.links)||[],traits:Object.keys(T).length>0?T:(w==null?void 0:w.traits)||{}})}),(s==="expand"||s==="refine")&&t.entities.forEach(E=>{v.has(E.id)||g.push(E)});let y=t.features;return s==="refine"&&x.features&&x.features.forEach(E=>{!E.id||!E.name||!E.states||t.features.some(w=>w.name.toLowerCase()===E.name.toLowerCase())||(y=[...y,{id:E.id,name:E.name,states:E.states}])}),{...t,entities:g,features:y}}catch(h){throw h}},ZU=async(e,t,r,n="gemini-2.0-flash",i="pt")=>{if(!r)throw new Error("API Key is missing");const s=new Kl({apiKey:r}),a=JSON.stringify(t.entities.map(l=>({id:l.id,name:l.name,scientificName:l.scientificName||Qa(l.name),family:l.family})),null,2),o=`${e}

ENTITIES TO VALIDATE:
${a}`,c=`You are an expert taxonomic validator. 
Your task is to validate the scientific names and taxonomy of the provided entities.
1. Check each entity against reputable databases (GBIF, POWO, Flora do Brasil).
2. Correct spelling errors in scientific names.
3. Standardize family names.
4. Mark 'isValid' as false ONLY if the entity should be REMOVED according to the specific removal criteria in the prompt (e.g. wrong genus/family/geography).
5. If the entity is valid but name was corrected, set 'isValid' to true and provide the new 'scientificName'.
6. CRITICAL: Preserve the exact 'id' for each entity.
7. Output must be a JSON object with 'validatedEntities' array.`;try{const l=await Lo(s,n,o,c,YU);let u={};try{u=ni(l)||{}}catch(v){return console.error("[validateTaxonomy] Failed to parse AI response:",v),t}if(!u.validatedEntities||!Array.isArray(u.validatedEntities))return console.warn("[validateTaxonomy] Invalid response format, returning original project"),t;const h=new Map(u.validatedEntities.map(v=>[v.id,v])),m=[];let x=0,g=0;for(const v of t.entities){const y=h.get(v.id);if(!y){m.push(v);continue}if(y.isValid){const E=y.scientificName||v.scientificName||Qa(v.name)||void 0,w=y.family||v.family||void 0;(E!==v.scientificName||w!==v.family)&&x++,m.push({...v,scientificName:E,family:w})}else g++,console.log(`[validateTaxonomy] Removing entity ${v.name} (${v.id}): ${y.correctionNote}`)}return console.log(`[validateTaxonomy] Completed. Modified: ${x}, Removed: ${g}`),{...t,entities:m}}catch(l){throw console.error("[validateTaxonomy] Error:",l),l}};async function Lo(e,t,r,n,i){const s=c=>new Promise(l=>setTimeout(l,c)),a=["gemini-2.0-flash","gemini-1.5-flash","gemini-1.5-pro"],o=async(c,l=0)=>{try{return(await e.models.generateContent({model:c.trim(),contents:r,config:{systemInstruction:n,responseMimeType:"application/json",responseSchema:i,maxOutputTokens:65536}})).text||"{}"}catch(h){const m=h.message||"",x=h.status||0;if((x===503||x===429||m.includes("overloaded"))&&l<5){const v=Math.pow(2,l)*5e3;return console.warn(`Retrying ${c} in ${v/1e3}s (attempt ${l+1})`),await s(v),o(c,l+1)}const g=a.indexOf(c);if(g<a.length-1)return console.warn(`Falling back from ${c} to ${a[g+1]}`),o(a[g+1],0);if(!a.includes(c))return console.warn(`Model ${c} failed, falling back to standard ${a[0]}`),o(a[0],0);throw h}};return o(t||"gemini-2.0-flash")}function ad(e,t="en",r=!0){const n=ni(e);if(!n.projectName)throw new Error("Invalid AI response: missing projectName");if(!n.features||!Array.isArray(n.features))throw console.error("[parseAIResponse] Invalid features:",n.features),new Error("Invalid AI response: features must be an array");if(!n.entities||!Array.isArray(n.entities))throw console.error("[parseAIResponse] Invalid entities:",n.entities),new Error("Invalid AI response: entities must be an array");const i=n.features.map(a=>{if(!a||typeof a!="object")return console.warn("[parseAIResponse] Skipping invalid feature:",a),null;const o=(a.states||[]).map(c=>typeof c=="string"?{id:Rt(),label:c}:typeof c=="object"&&c!==null?{id:c.id||Rt(),label:c.label||c}:{id:Rt(),label:String(c)});return{id:a.id||Rt(),name:a.name||"Unnamed Feature",imageUrl:a.imageUrl||"",states:o}}).filter(a=>a!==null),s=n.entities.map(a=>{var m;if(!a||typeof a!="object")return console.warn("[parseAIResponse] Skipping invalid entity:",a),null;const o={};if(a.traits===void 0||a.traits===null)console.log(`[parseAIResponse] Entity "${a.name}" has no traits defined`);else if(Array.isArray(a.traits))a.traits.forEach(x=>{let g="",v="";if(typeof x=="string"){const y=x.indexOf(":");y>-1&&(g=x.substring(0,y).trim(),v=x.substring(y+1).trim())}else typeof x=="object"&&x!==null&&(g=x.featureName,v=x.stateValue);if(g&&v){const y=i.find(E=>E.name.toLowerCase()===g.toLowerCase());if(y){const E=y.states.find(w=>w.label.toLowerCase()===v.toLowerCase());E&&(o[y.id]||(o[y.id]=[]),o[y.id].push(E.id))}}});else if(typeof a.traits=="object"&&a.traits!==null)for(const[x,g]of Object.entries(a.traits))Array.isArray(g)&&(o[x]=g);const c=((m=a.scientificName)==null?void 0:m.trim())||Qa(a.name)||a.name,l=a.family||"",u=rl(a.name),h=r?Ep(c,l,t):[];return{id:a.id||Rt(),name:a.name||"Unnamed Entity",scientificName:c,family:l,description:a.description||"",imageUrl:a.imageUrl||u,links:a.links||h,traits:o}}).filter(a=>a!==null);return{id:Rt(),name:n.projectName||"Untitled Key",description:n.projectDescription||"",features:i,entities:s}}async function cf(e,t,r,n,i,s="en",a=!0){const o=l=>new Promise(u=>setTimeout(u,l)),c=async(l,u=0)=>{const m=["gemini-2.0-flash","gemini-1.5-flash","gemini-1.5-pro"];try{return await e.models.generateContent({model:l.trim(),contents:r,config:{systemInstruction:n,responseMimeType:"application/json",responseSchema:i,maxOutputTokens:65536}})}catch(x){const g=x.message||"",v=x.status||(g.includes("503")?503:g.includes("429")?429:0);if(g.includes("404")||g.includes("NOT_FOUND")){const y=m.indexOf(l),E=m[y+1]||m[0];if(E!==l)return console.warn(`Model ${l} not found, falling back to ${E}`),await c(E,0)}if((v===503||v===429||g.includes("overloaded")||g.includes("UNAVAILABLE"))&&u<3){const y=Math.pow(2,u)*5e3;return console.warn(`Model ${l} is overloaded (attempt ${u+1}/3). Retrying in ${y/1e3}s...`),await o(y),await c(l,u+1)}if((v===503||v===429||g.includes("overloaded"))&&u>=3){const y=m.indexOf(l),E=m[y+1];if(E)return console.warn(`Model ${l} still overloaded after 3 retries. Trying ${E}...`),await c(E,0)}throw x}};try{const u=await c(t||"gemini-2.0-flash"),h=ni(u.text||"{}");if(!h.projectName)throw new Error("Invalid AI response: missing projectName");if(!h.features||!Array.isArray(h.features))throw console.error("[parseAIResponse] Invalid features:",h.features),new Error("Invalid AI response: features must be an array");if(!h.entities||!Array.isArray(h.entities))throw console.error("[parseAIResponse] Invalid entities:",h.entities),new Error("Invalid AI response: entities must be an array");const m=h.features.map(g=>{if(!g||typeof g!="object")return console.warn("[parseAIResponse] Skipping invalid feature:",g),null;const v=(g.states||[]).map(y=>typeof y=="string"?{id:Rt(),label:y}:typeof y=="object"&&y!==null?{id:y.id||Rt(),label:y.label||y}:{id:Rt(),label:String(y)});return{id:g.id||Rt(),name:g.name||"Unnamed Feature",imageUrl:g.imageUrl||"",states:v}}).filter(g=>g!==null),x=h.entities.map(g=>{var k;if(!g||typeof g!="object")return console.warn("[parseAIResponse] Skipping invalid entity:",g),null;const v={};if(g.traits===void 0||g.traits===null)console.log(`[parseAIResponse] Entity "${g.name}" has no traits defined`);else if(Array.isArray(g.traits))g.traits.forEach(b=>{let I="",S="";if(typeof b=="string"){const B=b.indexOf(":");B>-1&&(I=b.substring(0,B).trim(),S=b.substring(B+1).trim())}else typeof b=="object"&&b!==null&&(I=b.featureName,S=b.stateValue);if(I&&S){const B=m.find(D=>D.name.toLowerCase()===I.toLowerCase());if(B){const D=B.states.find(H=>H.label.toLowerCase()===S.toLowerCase());D&&(v[B.id]||(v[B.id]=[]),v[B.id].push(D.id))}}});else if(typeof g.traits=="object"&&g.traits!==null)for(const[b,I]of Object.entries(g.traits))Array.isArray(I)&&(v[b]=I);const y=((k=g.scientificName)==null?void 0:k.trim())||Qa(g.name)||g.name,E=g.family||"",w=rl(g.name),T=a?Ep(y,E,s):[];return{id:g.id||Rt(),name:g.name||"Unnamed Entity",scientificName:y,family:E,description:g.description||"",imageUrl:g.imageUrl||w,links:g.links||T,traits:v}}).filter(g=>g!==null);return{id:h.id||Rt(),name:h.projectName||h.name,description:h.projectDescription||h.description,features:m,entities:x}}catch(l){throw console.error("Gemini Generation Error:",l),l}}const L1=async(e,t,r,n="pt")=>{if(!e)throw new Error(n==="pt"?"Chave de API necessria":"API key required");const i=new Kl({apiKey:e}),s=t.map(o=>o.join(" | ")).join(`
`),a=n==="pt"?`Voc  um especialista em taxonomia e chaves de identificao. Analise esta chave dicotmica e extraia:

1. TODAS as entidades (famlias, gneros ou espcies) mencionadas
2. TODAS as caractersticas diagnsticas mencionadas
3. Mapeie quais caractersticas cada entidade possui

CHAVE DICOTMICA:
${s}

Retorne um JSON no seguinte formato:
{
  "projectName": "Nome da chave",
  "projectDescription": "Descrio breve",
  "features": [
    {
      "name": "Nome da caracterstica",
      "states": ["Estado 1", "Estado 2"]
    }
  ],
  "entities": [
    {
      "name": "Nome da entidade",
      "scientificName": "Nome cientfico se aplicvel",
      "family": "Famlia se aplicvel",
      "description": "Breve descrio",
      "characteristics": {
        "Nome da caracterstica": ["Estados que a entidade possui"]
      }
    }
  ]
}

IMPORTANTE:
- Extraia TODAS as caractersticas mencionadas (presena de ltex, tipo de folha, nervao, etc)
- Para cada entidade, liste TODAS as caractersticas que a levam  identificao
- Se uma caracterstica no foi mencionada para uma entidade, no inclua
- Agrupe caractersticas similares (ex: "ltex branco" e "ltex amarelo" = caracterstica "Cor do ltex")
- Use os nomes cientficos completos quando mencionados
- Crie estados binrios quando apropriado (ex: "presente"/"ausente")`:`You are an expert in taxonomy and identification keys. Analyze this dichotomous key and extract:

1. ALL entities (families, genera, or species) mentioned
2. ALL diagnostic characteristics mentioned
3. Map which characteristics each entity possesses

DICHOTOMOUS KEY:
${s}

Return a JSON in the following format:
{
  "projectName": "Key name",
  "projectDescription": "Brief description",
  "features": [
    {
      "name": "Feature name",
      "states": ["State 1", "State 2"]
    }
  ],
  "entities": [
    {
      "name": "Entity name",
      "scientificName": "Scientific name if applicable",
      "family": "Family if applicable",
      "description": "Brief description",
      "characteristics": {
        "Feature name": ["States that the entity has"]
      }
    }
  ]
}

IMPORTANT:
- Extract ALL mentioned characteristics (presence of latex, leaf type, venation, etc)
- For each entity, list ALL characteristics that lead to identification
- If a characteristic wasn't mentioned for an entity, don't include it
- Group similar characteristics (e.g., "white latex" and "yellow latex" = "Latex color" feature)
- Use complete scientific names when mentioned
- Create binary states when appropriate (e.g., "present"/"absent")`;try{const o={type:me.OBJECT,properties:{projectName:{type:me.STRING},projectDescription:{type:me.STRING},features:{type:me.ARRAY,items:{type:me.OBJECT,properties:{name:{type:me.STRING},states:{type:me.ARRAY,items:{type:me.STRING}}}}},entities:{type:me.ARRAY,items:{type:me.OBJECT,properties:{name:{type:me.STRING},scientificName:{type:me.STRING},family:{type:me.STRING},description:{type:me.STRING},characteristics:{type:me.OBJECT}}}}},required:["projectName","features","entities"]};return await cf(i,"gemini-2.0-flash-exp",a,"",o,n,!1)}catch(o){throw console.error("Dichotomous key conversion error:",o),o}},e7=ke.forwardRef(({language:e,isGenerating:t,placeholder:r},n)=>{const[i,s]=ke.useState(""),[a,o]=ke.useState(!1),c=ke.useRef(null);return ke.useImperativeHandle(n,()=>({setText:l=>s(l),setComplete:l=>o(l)})),ke.useEffect(()=>{c.current&&i&&(c.current.scrollTop=c.current.scrollHeight)},[i]),f.jsx("div",{ref:c,className:"w-full flex-1 p-4 bg-gradient-to-br from-slate-900 to-slate-800 text-slate-200 font-mono text-sm rounded-lg overflow-auto custom-scrollbar border-2 border-amber-500/30",children:f.jsxs("div",{className:"whitespace-pre-wrap",children:[i||r||(e==="pt"?"Aguardando...":"Waiting..."),t&&!a&&f.jsx("span",{className:"inline-block w-2 h-4 bg-amber-400 animate-pulse ml-1 align-middle"})]})})}),t7=(e,t)=>{const r=JSON.stringify(e);return`<!DOCTYPE html>
<html lang="${t}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${e.name} - NOZESia Key</title>
  <script src="https://cdn.tailwindcss.com"><\/script>
  <style>
    .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
  </style>
</head>
<body class="bg-slate-100 font-sans">
  <div id="app"></div>
  <script>
    const project = ${r};
    const lang = "${t}";
    const t = {
      en: {
        features: "Features", selected: "selected", matches: "Matches", discarded: "Discarded",
        restart: "Restart", noMatches: "No matches found.", tryUnselecting: "Try unselecting some features.",
        potential: "potential matches", identified: "1 Entity identified", close: "Close",
        speciesDetails: "Species Details", morphology: "Morphology & Traits", resources: "Resources",
        createdWith: "Created with NOZESia", viewResults: "View Results", excluded: "Excluded by selection",
        scientificName: "Scientific Name", family: "Family", taxonomy: "Taxonomy"
      },
      pt: {
        features: "Caractersticas", selected: "selecionado(s)", matches: "Compatveis", discarded: "Descartados",
        restart: "Reiniciar", noMatches: "Nenhum resultado.", tryUnselecting: "Tente remover selees.",
        potential: "matches potenciais", identified: "1 Entidade identificada", close: "Fechar",
        speciesDetails: "Detalhes da Espcie", morphology: "Morfologia & Caractersticas", resources: "Recursos Adicionais",
        createdWith: "Criado com NOZESia", viewResults: "Ver Resultados", excluded: "Excludo pela seleo",
        scientificName: "Nome Cientfico", family: "Famlia", taxonomy: "Taxonomia"
      }
    };
    const strings = t[lang];
    
    let selections = {};
    let showDiscarded = false;
    let viewingEntity = null;
    let viewingStateImage = null; // {url, label, featureName}
    let mobileTab = 'FILTERS';
    
    function toggleSelection(featureId, stateId) {
      if (!selections[featureId]) selections[featureId] = [];
      const idx = selections[featureId].indexOf(stateId);
      if (idx >= 0) {
        selections[featureId].splice(idx, 1);
        if (selections[featureId].length === 0) delete selections[featureId];
      } else {
        selections[featureId].push(stateId);
      }
      render();
    }
    
    function resetKey() { selections = {}; render(); }
    function setMobileTab(tab) { mobileTab = tab; render(); }
    function toggleDiscarded() { showDiscarded = !showDiscarded; render(); }
    function viewEntity(entity) { viewingEntity = entity; render(); }
    function viewStateImage(url, label, featureName) { viewingStateImage = {url, label, featureName}; render(); }
    function closeStateImage() { viewingStateImage = null; render(); }
    function closeEntity() { viewingEntity = null; render(); }
    
    function getFilteredEntities() {
      const remaining = [], discarded = [];
      project.entities.forEach(entity => {
        let isMatch = true;
        for (const [fid, sids] of Object.entries(selections)) {
          const entityStates = entity.traits[fid] || [];
          if (!sids.some(id => entityStates.includes(id))) { isMatch = false; break; }
        }
        if (isMatch) remaining.push(entity); else discarded.push(entity);
      });
      return { remaining, discarded };
    }
    
    function getTotalSelections() {
      return Object.values(selections).reduce((a, c) => a + c.length, 0);
    }
    
    function render() {
      const { remaining, discarded } = getFilteredEntities();
      const totalSel = getTotalSelections();
      
      let entityModalHTML = '';
      if (viewingEntity) {
        const e = viewingEntity;
        const traitsHTML = project.features.map(f => {
          const stateIds = e.traits[f.id] || [];
          const stateLabels = stateIds.map(sid => f.states.find(s => s.id === sid)?.label).filter(Boolean).join(', ');
          return stateLabels ? \`<div class="flex justify-between py-2 border-b border-slate-100"><span class="text-slate-500">\${f.name}</span><span class="font-medium text-slate-800">\${stateLabels}</span></div>\` : '';
        }).join('');
        const linksHTML = e.links && e.links.length > 0 ? \`<div class="mt-6"><h4 class="font-semibold text-slate-700 mb-3">\${strings.resources}</h4><div class="space-y-2">\${e.links.map(l => \`<a href="\${l.url}" target="_blank" class="flex items-center gap-2 text-emerald-600 hover:underline text-sm"><span></span>\${l.label}</a>\`).join('')}</div></div>\` : '';
        const taxonomyHTML = (e.scientificName || e.family) ? \`
          <div class="mt-4 p-3 bg-emerald-50 rounded-lg border border-emerald-100">
            <h4 class="font-semibold text-emerald-800 mb-2 text-sm flex items-center gap-1"> \${strings.taxonomy}</h4>
            \${e.scientificName ? \`<div class="flex justify-between py-1"><span class="text-emerald-600 text-sm">\${strings.scientificName}</span><span class="font-medium text-emerald-800 italic">\${e.scientificName}</span></div>\` : ''}
            \${e.family ? \`<div class="flex justify-between py-1"><span class="text-emerald-600 text-sm">\${strings.family}</span><span class="font-medium text-emerald-800">\${e.family}</span></div>\` : ''}
          </div>
        \` : '';
        entityModalHTML = \`
          <div class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4" onclick="if(event.target===this)closeEntity()">
            <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col">
              <div class="relative h-48 sm:h-64 bg-slate-200 shrink-0">
                \${e.imageUrl ? \`<img src="\${e.imageUrl}" class="w-full h-full object-cover" onerror="this.style.display='none'">\` : '<div class="w-full h-full flex items-center justify-center text-slate-400 text-6xl"></div>'}
                <button onclick="closeEntity()" class="absolute top-3 right-3 bg-black/40 hover:bg-black/60 text-white rounded-full p-2"></button>
              </div>
              <div class="p-6 overflow-y-auto custom-scrollbar">
                <h2 class="text-2xl font-bold text-slate-800 mb-1">\${e.name}</h2>
                \${e.scientificName && e.scientificName !== e.name ? \`<p class="text-slate-500 italic mb-2">\${e.scientificName}</p>\` : ''}
                \${e.family ? \`<span class="inline-block bg-emerald-100 text-emerald-700 text-xs px-2 py-1 rounded-full mb-3">\${e.family}</span>\` : ''}
                \${e.description ? \`<p class="text-slate-600 mb-4">\${e.description}</p>\` : ''}
                \${taxonomyHTML}
                <div class="mt-4"><h4 class="font-semibold text-slate-700 mb-2">\${strings.morphology}</h4><div class="text-sm">\${traitsHTML}</div></div>
                \${linksHTML}
              </div>
            </div>
          </div>
        \`;
      }
      
      // State Image Modal
      let stateImageModalHTML = '';
      if (viewingStateImage) {
        stateImageModalHTML = \`
          <div class="fixed inset-0 bg-black/80 z-[60] flex items-center justify-center p-4" onclick="if(event.target===this)closeStateImage()">
            <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full overflow-hidden" onclick="event.stopPropagation()">
              <div class="relative">
                <img src="\${viewingStateImage.url}" alt="\${viewingStateImage.label}" class="w-full max-h-[60vh] object-contain bg-slate-100">
                <button onclick="closeStateImage()" class="absolute top-3 right-3 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full transition-colors"></button>
              </div>
              <div class="p-4 bg-white">
                <h4 class="font-semibold text-slate-800">\${viewingStateImage.label}</h4>
                <p class="text-sm text-slate-500">\${viewingStateImage.featureName}</p>
              </div>
            </div>
          </div>
        \`;
      }
      
      // Filter features and states based on hideEmptyFeatures
      const featuresHTML = project.features
        .map(f => {
          // Get all state IDs that are present in remaining entities
          const usedStateIds = new Set();
          if (hideEmptyFeatures) {
            remaining.forEach(entity => {
              const entityStates = entity.traits[f.id] || [];
              entityStates.forEach(stateId => usedStateIds.add(stateId));
            });

            // If no states are used, skip this feature
            if (usedStateIds.size === 0) return '';
          }

          // Filter states to only show those that are used (when hideEmptyFeatures is true)
          const visibleStates = hideEmptyFeatures
            ? f.states.filter(s => usedStateIds.has(s.id))
            : f.states;

          const selStates = selections[f.id] || [];
          return \`
            <div class="bg-slate-50 rounded-xl p-4">
              <h4 class="font-semibold text-slate-700 mb-3 flex items-center gap-2">
                \${f.imageUrl ? \`<img src="\${f.imageUrl}" class="w-6 h-6 rounded object-cover">\` : ''}
                \${f.name}
                \${selStates.length > 0 ? \`<span class="ml-auto text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full">\${selStates.length}</span>\` : ''}
              </h4>
              <div class="flex flex-wrap gap-2">
                \${visibleStates.map(s => {
                  const isSel = selStates.includes(s.id);
                  const hasImg = s.imageUrl ? true : false;
                  return \`<div class="flex items-center gap-1">
                    \${hasImg ? \`<button onclick="viewStateImage('\${s.imageUrl}', '\${s.label.replace(/'/g, "\\\\'")}', '\${f.name.replace(/'/g, "\\\\'")}')" class="w-6 h-6 rounded overflow-hidden border border-slate-200 hover:border-emerald-400 transition-colors shrink-0" title="Ver imagem"><img src="\${s.imageUrl}" class="w-full h-full object-cover"></button>\` : ''}
                    <button onclick="toggleSelection('\${f.id}','\${s.id}')" class="px-3 py-1.5 rounded-lg text-sm font-medium transition-all \${isSel ? 'bg-emerald-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-100 border border-slate-200'}">\${s.label}</button>
                  </div>\`;
                }).join('')}
              </div>
            </div>
          \`;
        })
        .filter(html => html !== '')
        .join('');
      
      const entityCard = (e, isDiscarded = false) => \`
        <div onclick="viewEntity(project.entities.find(x=>x.id==='\${e.id}'))" class="bg-white rounded-xl shadow-sm hover:shadow-lg transition-all cursor-pointer overflow-hidden border \${isDiscarded ? 'border-red-200 opacity-60' : 'border-slate-200 hover:border-emerald-300'}">
          <div class="h-32 bg-slate-100 relative">
            \${e.imageUrl ? \`<img src="\${e.imageUrl}" class="w-full h-full object-cover" onerror="this.parentElement.innerHTML='<div class=\\\\'w-full h-full flex items-center justify-center text-slate-300 text-4xl\\\\'></div>'">\` : '<div class="w-full h-full flex items-center justify-center text-slate-300 text-4xl"></div>'}
            \${isDiscarded ? '<div class="absolute inset-0 bg-red-500/20 flex items-center justify-center"><span class="bg-red-500 text-white text-xs px-2 py-1 rounded"></span></div>' : ''}
            \${e.family ? \`<span class="absolute top-2 left-2 bg-emerald-600/90 text-white text-[10px] px-1.5 py-0.5 rounded">\${e.family}</span>\` : ''}
          </div>
          <div class="p-3">
            <h4 class="font-semibold text-slate-800 text-sm truncate">\${e.name}</h4>
            \${e.scientificName && e.scientificName !== e.name ? \`<p class="text-xs text-slate-400 italic truncate">\${e.scientificName}</p>\` : ''}
            \${e.description ? \`<p class="text-xs text-slate-500 mt-1 line-clamp-2">\${e.description}</p>\` : ''}
          </div>
        </div>
      \`;
      
      const remainingHTML = remaining.length > 0 
        ? remaining.map(e => entityCard(e)).join('')
        : \`<div class="col-span-full text-center py-12 text-slate-500"><div class="text-4xl mb-3"></div><p class="font-medium">\${strings.noMatches}</p><p class="text-sm">\${strings.tryUnselecting}</p></div>\`;
      
      const discardedHTML = discarded.length > 0 && showDiscarded
        ? \`<div class="mt-6 pt-6 border-t"><h4 class="font-semibold text-slate-500 mb-4 flex items-center gap-2"> \${strings.discarded} (\${discarded.length})</h4><div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">\${discarded.map(e => entityCard(e, true)).join('')}</div></div>\`
        : '';
      
      document.getElementById('app').innerHTML = \`
        <div class="min-h-screen flex flex-col">
          <header class="bg-white border-b px-4 py-3 flex justify-between items-center shadow-sm">
            <div class="flex items-center gap-3">
              <span class="bg-emerald-600 text-white text-xs px-2 py-1 rounded font-bold">KEY</span>
              <h1 class="text-lg font-bold text-slate-800 truncate">\${project.name}</h1>
            </div>
            <button onclick="resetKey()" class="flex items-center gap-2 px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg"> \${strings.restart}</button>
          </header>
          
          <div class="md:hidden flex border-b bg-white">
            <button onclick="setMobileTab('FILTERS')" class="flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 \${mobileTab==='FILTERS'?'text-emerald-600 border-b-2 border-emerald-600':'text-slate-500 bg-slate-50'}">
               \${strings.features} \${totalSel>0?\`<span class="bg-emerald-600 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center">\${totalSel}</span>\`:''}
            </button>
            <button onclick="setMobileTab('RESULTS')" class="flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 \${mobileTab==='RESULTS'?'text-emerald-600 border-b-2 border-emerald-600':'text-slate-500 bg-slate-50'}">
               \${strings.matches} <span class="bg-slate-200 text-slate-700 text-xs px-1.5 py-0.5 rounded-full">\${remaining.length}</span>
            </button>
          </div>
          
          <div class="flex-1 flex flex-col md:flex-row overflow-hidden">
            <div class="w-full md:w-1/3 lg:w-1/4 bg-white md:border-r flex-col h-full \${mobileTab==='FILTERS'?'flex':'hidden md:flex'}">
              <div class="hidden md:block p-4 border-b bg-slate-50">
                <h3 class="font-semibold text-slate-700 flex items-center gap-2"> \${strings.features}</h3>
              </div>
              <div class="flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar">\${featuresHTML}</div>
            </div>
            
            <div class="flex-1 flex flex-col h-full \${mobileTab==='RESULTS'?'flex':'hidden md:flex'}">
              <div class="p-4 border-b bg-slate-50 flex justify-between items-center">
                <div>
                  <span class="font-semibold text-slate-700">\${remaining.length === 1 ? strings.identified : remaining.length + ' ' + strings.potential}</span>
                </div>
                \${discarded.length > 0 ? \`<button onclick="toggleDiscarded()" class="text-sm text-slate-500 hover:text-slate-700 flex items-center gap-1">\${showDiscarded?'':''} \${strings.discarded} (\${discarded.length})</button>\` : ''}
              </div>
              <div class="flex-1 overflow-y-auto p-4 custom-scrollbar">
                <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">\${remainingHTML}</div>
                \${discardedHTML}
              </div>
            </div>
          </div>
          
          <footer class="bg-white border-t px-4 py-2 text-center text-xs text-slate-400">
            \${strings.createdWith}  <a href="https://djhandoom.github.io/nozes/" target="_blank" class="text-emerald-600 hover:underline">djhandoom.github.io/nozes</a>
          </footer>
        </div>
        \${entityModalHTML}
        \${stateImageModalHTML}
      \`;
    }
    
    render();
  <\/script>
</body>
</html>`},r7={en:{builder:"Builder",aiWizard:"Nuts AI",savePlay:"Save & Play",exit:"Exit",save:"Save",open:"Open",export:"Export Project",exportXLSX:"Export XLSX",exportHTML:"Export HTML",import:"Import Project",general:"General",features:"Features",entities:"Entities",matrix:"Matrix Scoring",projectName:"Project Name",description:"Description",definedFeatures:"Defined Features",definedFeaturesDesc:"Define traits and their possible states.",addFeature:"Add Feature",featureName:"Feature Name",imageURL:"Image URL (optional)",states:"States",addState:"Add State",manageEntities:"Entities",manageEntitiesDesc:"Manage the taxa included in your key.",addEntity:"Add Entity",scoringMatrix:"Scoring Matrix",scoringMatrixDesc:"Click cells to toggle state association",taxaFeatures:"Taxa / Features",aiTitle:"Nuts AI Wizard",aiDesc:"Generate or Extract keys using Gemini AI.",topic:"Key Topic / Subject",topicPlace:"e.g. Rainforest Trees, Garden Weeds",geography:"Geographic Scope",taxonomyFamily:"Family",taxonomyGenus:"Genus",biome:"Biome",stateUF:"State/Region",scopeLabel:"Scope",scopeGlobal:"Global",scopeNational:"National (Brazil)",scopeRegional:"Regional",taxonomyFilters:"Taxonomic Filters",geographyFilters:"Geographic Filters",numEntities:"Approx. # of Entities",numFeatures:"Approx. # of Features",requiredFeatures:"Required Features",requiredFeaturesDesc:"Select features the AI must include",addCustomFeature:"Add custom feature...",selectedFeatures:"selected",requiredSpecies:"Required Species List",requiredSpeciesDesc:"Species that MUST be included (one per line)",requiredSpeciesPlaceholder:`Enter species names, one per line:
Inga edulis
Inga marginata
Inga vera`,importSpeciesList:"Import species list",importSpeciesFormats:"Supports: .txt, .csv, .doc, .json",speciesCount:"species listed",clearList:"Clear list",generating:"Nozes IA is thinking... (15-45s)",cancel:"Cancel",generate:"Generate Key",savedMsg:"Project saved to browser storage!",errGen:"Failed to generate key. Check console.",featureFocus:"Feature Focus",focusGeneral:"General (All)",focusRepro:"Reproductive Only",focusVeg:"Vegetative Only",options:"Options",fetchSpeciesImg:"Fetch Species Images",fetchFeatureImg:"Fetch Feature Images",fetchLinks:"Fetch External Links",detailLevel:"Detail Level",detailSimple:"Simplified",detailBalanced:"Balanced",detailExpert:"Expert / High",detailOriginal:"Original Fidelity",noSaved:"No saved projects.",close:"Close",clearImage:"Clear Image",modeTopic:"Generate from Topic",modeImport:"Import from File",uploadLabel:"Upload PDF, Image, or Text",uploadDesc:"The AI will study the document and extract entities and features automatically.",supportedFormats:"Supports: .pdf, .txt, .jpg, .png",dropFile:"Drop file here",removeFile:"Remove file",analyzing:"Analyzing document...",promptCopied:"Prompt copied to clipboard!",configSettings:"Configuration",links:"Additional Links / Resources",addLink:"Add Link",editTraits:"Edit Characteristics",traitEditor:"Trait Editor",copyPrompt:"Copy",missingKey:"Missing API Key. Please configure it in the main menu Settings.",apiKeyWarning:"Configure your API Key to use AI features",clickGear:"Click the key icon above",modeRefine:"Expand/Refine",refineTitle:"Enhance Current Key",refineDesc:"Use AI to expand or refine your existing identification key.",actionExpand:"Expand Entities",actionExpandDesc:"Add new species/entities similar to existing ones",actionRefine:"Refine Features",actionRefineDesc:"Improve feature descriptions and add discriminating traits",actionClean:"Clean & Optimize",actionCleanDesc:"Remove redundant features, fix inconsistencies",expandCount:"# New Entities to Add",keepExisting:"Preserve existing entities",addFeatures:"Add new discriminating features",expandFilters:"Taxonomic & Geographic Filters",expandFamily:"Family (optional)",expandGenus:"Genus (optional)",expandBiome:"Biome (optional)",expandStateUF:"State/UF (optional)",expandScope:"Geographic Scope",expandRequiredSpecies:"Required Species to Add",expandRequiredSpeciesDesc:"Species that MUST be added (one per line)",expandRequiredSpeciesPlaceholder:`Enter species to add:
Inga edulis
Inga marginata`,refineRequiredFeaturesTitle:"Required Features",refineRequiredFeaturesDesc:"Features that MUST be included in the key",addRequiredFeature:"Add feature...",customFeature:"Custom feature",improveDescriptions:"Improve descriptions",fillGaps:"Fill missing trait data",removeRedundant:"Remove redundant features",fixInconsistencies:"Fix inconsistencies",featureTypeLabel:"Feature Type",featureTypeVegetative:"Vegetative only",featureTypeReproductive:"Reproductive only",featureTypeBoth:"Both (vegetative + reproductive)",featureTypeDesc:"Focus on vegetative characters (leaves, stems, bark) or reproductive (flowers, fruits, seeds)",currentProject:"Current Project",noProjectLoaded:"No project loaded. Create or load a project first.",entitiesCount:"entities",featuresCount:"features",filterEntities:"Filter Entities",filterByFamily:"Filter by family",filterByGenus:"Filter by genus",filterByName:"Filter by name",searchPlaceholder:"Search...",allFamilies:"All families",allGenera:"All genera",clearFilters:"Clear filters",onlyWithGaps:"Only with gaps",onlyWithGapsDesc:"Show only entities with missing traits",showingEntities:"Showing",ofEntities:"of",completePhotos:"Complete Photo Collection",completePhotosDesc:"Fill missing images with valid URLs",photoTargetEntities:"Entity Images",photoTargetFeatures:"Feature Images",photoTargetBoth:"Both",actionPhotos:"Complete Photos",actionPhotosDesc:"Fill all missing images with real URLs",photosActionDesc:"Select which images to complete with valid URLs",actionValidate:"Validate Taxonomy",actionValidateDesc:"Check species names, synonyms, and geographic distribution",validateOptions:"Validation Options",validateFixNames:"Correct invalid/outdated names",validateFixNamesDesc:"Update names according to Flora do Brasil 2020 or other catalogs",validateMergeSynonyms:"Merge synonyms",validateMergeSynonymsDesc:"Combine synonymous species, preserving traits from both",validateCheckGeography:"Check geographic distribution",validateCheckGeographyDesc:"Remove species outside the defined geographic scope",validateCheckTaxonomy:"Check taxonomic scope",validateCheckTaxonomyDesc:"Remove species outside the defined family/genus",validateReference:"Reference Catalog",validateFloradobrasil:"Flora do Brasil 2020",validateGbif:"GBIF Backbone",validatePowo:"POWO (Kew)",validateCustom:"Custom/Other",photoModeReplace:"Replace All",photoModeReplaceDesc:"Clear existing and find new photos",photoModeExpand:"Only Fill Missing",photoModeExpandDesc:"Keep existing, fill empty only",photoCustomSources:"Custom Sources (optional)",photoCustomSourcesPlaceholder:`Paste URLs of image databases separated by newlines
e.g., https://inaturalist.org
https://floradobrasil.jbrj.gov.br`,modeMerge:"Merge Keys",mergeTitle:"Combine Two Keys",mergeDesc:"Import two JSON keys and merge them into one optimized key.",mergeKey1:"First Key (JSON)",mergeKey2:"Second Key (JSON)",uploadKey1:"Upload Key 1 (JSON)",uploadKey2:"Upload Key 2 (JSON)",mergeStrategy:"Merge Strategy",strategyUnion:"Union (All-inclusive)",strategyUnionDesc:"Include all features and entities from both keys",strategyIntersection:"Intersection (Common)",strategyIntersectionDesc:"Focus on shared characteristics between keys",strategyPrimary:"Primary (Key 1 base)",strategyPrimaryDesc:"Use Key 1 as base, add unique elements from Key 2",remove:"Remove",mergeAction:"Merge Keys",mergeLoaded:"loaded",stateImage:"State image",addStateImage:"Add image",viewImage:"View image",closeImage:"Close"},pt:{builder:"Construtor",aiWizard:"Nozes IA",savePlay:"Salvar & Testar",exit:"Sair",save:"Salvar",open:"Abrir",export:"Exportar Projeto",exportXLSX:"Exportar XLSX",exportHTML:"Exportar HTML",import:"Importar Projeto",general:"Geral",features:"Caractersticas",entities:"Entidades",matrix:"Matriz",projectName:"Nome do Projeto",description:"Descrio",definedFeatures:"Caractersticas Definidas",definedFeaturesDesc:"Defina caractersticas e seus estados possveis.",addFeature:"Adicionar Caracterstica",featureName:"Nome",imageURL:"URL da Imagem (opcional)",states:"Estados",addState:"Adicionar Estado",manageEntities:"Entidades",manageEntitiesDesc:"Gerencie os txons includos na chave.",addEntity:"Adicionar Entidade",scoringMatrix:"Matriz de Pontuao",scoringMatrixDesc:"Clique nas clulas para associar estados",taxaFeatures:"Txons / Caractersticas",aiTitle:"Assistente Nozes IA",aiDesc:"Gere ou Extraia chaves usando Gemini IA.",topic:"Tpico / Assunto",topicPlace:"ex: rvores da Amaznia, Ervas Daninhas",geography:"Escopo Geogrfico",taxonomyFamily:"Famlia",taxonomyGenus:"Gnero",biome:"Bioma",stateUF:"Estado/UF",scopeLabel:"Escopo",scopeGlobal:"Global",scopeNational:"Nacional (Brasil)",scopeRegional:"Regional",taxonomyFilters:"Filtros Taxonmicos",geographyFilters:"Filtros Geogrficos",numEntities:"Aprox. # de Entidades",numFeatures:"Aprox. # de Caractersticas",requiredFeatures:"Caractersticas Obrigatrias",requiredFeaturesDesc:"Selecione caractersticas que a IA deve incluir",addCustomFeature:"Adicionar caracterstica...",selectedFeatures:"selecionadas",requiredSpecies:"Lista de Espcies Obrigatrias",requiredSpeciesDesc:"Espcies que DEVEM ser includas (uma por linha)",requiredSpeciesPlaceholder:`Digite nomes de espcies, uma por linha:
Inga edulis
Inga marginata
Inga vera`,importSpeciesList:"Importar lista de espcies",importSpeciesFormats:"Suporta: .txt, .csv, .doc, .json",speciesCount:"espcies listadas",clearList:"Limpar lista",generating:"Nozes IA est pensando... (15-45s)",cancel:"Cancelar",generate:"Gerar Chave",savedMsg:"Projeto salvo no navegador!",errGen:"Falha ao gerar chave. Verifique o console.",featureFocus:"Foco das Caractersticas",focusGeneral:"Geral (Todas)",focusRepro:"Apenas Reprodutivas",focusVeg:"Apenas Vegetativas",options:"Opes",fetchSpeciesImg:"Buscar Imagens de Espcies",fetchFeatureImg:"Buscar Imagens de Caractersticas",fetchLinks:"Buscar Links/Materiais",detailLevel:"Nvel de Detalhe",detailSimple:"Simplificado",detailBalanced:"Equilibrado",detailExpert:"Especialista / Alto",detailOriginal:"Fidelidade Original",noSaved:"Nenhum projeto salvo.",close:"Fechar",modeTopic:"Gerar por Tpico",modeImport:"Importar Arquivo",uploadLabel:"Upload PDF, Imagem ou Texto",uploadDesc:"A IA estudar o documento e extrair entidades e caractersticas automaticamente.",supportedFormats:"Suporta: .pdf, .txt, .jpg, .png",dropFile:"Solte o arquivo aqui",removeFile:"Remover arquivo",analyzing:"Analisando documento...",promptCopied:"Prompt copiado para a rea de transferncia!",configSettings:"Configurao",links:"Links Adicionais / Materiais",addLink:"Adicionar Link",editTraits:"Editar Caractersticas",traitEditor:"Editor de Caractersticas",copyPrompt:"Copiar",missingKey:"Falta a Chave da API. Configure-a nas Configuraes do menu principal.",apiKeyWarning:"Configure sua Chave de API para usar a IA",clickGear:"Clique na chave acima",modeRefine:"Expandir/Refinar",refineTitle:"Aprimorar Chave Atual",refineDesc:"Use IA para expandir ou refinar sua chave de identificao existente.",actionExpand:"Expandir Entidades",actionExpandDesc:"Adicionar novas espcies/entidades similares s existentes",actionRefine:"Refinar Caractersticas",actionRefineDesc:"Melhorar descries e adicionar caractersticas discriminantes",actionClean:"Limpar & Otimizar",actionCleanDesc:"Remover caractersticas redundantes, corrigir inconsistncias",expandCount:"# Novas Entidades a Adicionar",keepExisting:"Preservar entidades existentes",addFeatures:"Adicionar novas caractersticas discriminantes",expandFilters:"Filtros Taxonmicos & Geogrficos",expandFamily:"Famlia (opcional)",expandGenus:"Gnero (opcional)",expandBiome:"Bioma (opcional)",expandStateUF:"Estado/UF (opcional)",expandScope:"Escopo Geogrfico",expandRequiredSpecies:"Espcies Obrigatrias a Adicionar",expandRequiredSpeciesDesc:"Espcies que DEVEM ser adicionadas (uma por linha)",expandRequiredSpeciesPlaceholder:`Digite espcies a adicionar:
Inga edulis
Inga marginata`,refineRequiredFeaturesTitle:"Caractersticas Obrigatrias",refineRequiredFeaturesDesc:"Caractersticas que DEVEM estar na chave",addRequiredFeature:"Adicionar caracterstica...",customFeature:"Caracterstica personalizada",improveDescriptions:"Melhorar descries",fillGaps:"Preencher dados de caractersticas faltantes",removeRedundant:"Remover caractersticas redundantes",fixInconsistencies:"Corrigir inconsistncias",featureTypeLabel:"Tipo de Caracterstica",featureTypeVegetative:"Apenas vegetativas",featureTypeReproductive:"Apenas reprodutivas",featureTypeBoth:"Ambas (vegetativas + reprodutivas)",featureTypeDesc:"Foco em caracteres vegetativos (folhas, caules, cascas) ou reprodutivos (flores, frutos, sementes)",currentProject:"Projeto Atual",noProjectLoaded:"Nenhum projeto carregado. Crie ou carregue um projeto primeiro.",entitiesCount:"entidades",featuresCount:"caractersticas",filterEntities:"Filtrar Entidades",filterByFamily:"Filtrar por famlia",filterByGenus:"Filtrar por gnero",filterByName:"Filtrar por nome",searchPlaceholder:"Buscar...",allFamilies:"Todas as famlias",allGenera:"Todos os gneros",clearFilters:"Limpar filtros",onlyWithGaps:"Apenas com lacunas",onlyWithGapsDesc:"Mostrar apenas entidades com caractersticas faltantes",showingEntities:"Exibindo",ofEntities:"de",completePhotos:"Completar Acervo Fotogrfico",completePhotosDesc:"Preencher imagens faltantes com URLs vlidas",photoTargetEntities:"Imagens de Entidades",photoTargetFeatures:"Imagens de Caractersticas",photoTargetBoth:"Ambos",actionPhotos:"Completar Fotos",actionPhotosDesc:"Preencher todas as imagens faltantes com URLs reais",photosActionDesc:"Selecione quais imagens completar com URLs vlidas",actionValidate:"Validar Taxonomia",actionValidateDesc:"Verificar nomes de espcies, sinonmias e distribuio geogrfica",validateOptions:"Opes de Validao",validateFixNames:"Corrigir nomes invlidos/desatualizados",validateFixNamesDesc:"Atualizar nomes conforme Flora do Brasil 2020 ou outros catlogos",validateMergeSynonyms:"Mesclar sinnimos",validateMergeSynonymsDesc:"Combinar espcies sinnimas, preservando caractersticas de ambas",validateCheckGeography:"Verificar distribuio geogrfica",validateCheckGeographyDesc:"Remover espcies fora do escopo geogrfico definido",validateCheckTaxonomy:"Verificar escopo taxonmico",validateCheckTaxonomyDesc:"Remover espcies fora da famlia/gnero definido",validateReference:"Catlogo de Referncia",validateFloradobrasil:"Flora do Brasil 2020",validateGbif:"GBIF Backbone",validatePowo:"POWO (Kew)",validateCustom:"Personalizado/Outro",photoModeReplace:"Substituir Todas",photoModeReplaceDesc:"Limpar existentes e buscar novas",photoModeExpand:"Apenas Preencher Faltantes",photoModeExpandDesc:"Manter existentes, preencher vazias",photoCustomSources:"Fontes Personalizadas (opcional)",photoCustomSourcesPlaceholder:`Cole URLs de bancos de imagens separados por quebras de linha
ex: https://inaturalist.org
https://floradobrasil.jbrj.gov.br`,modeMerge:"Combinar",mergeTitle:"Combinar Duas Chaves",mergeDesc:"Importe dois JSONs e combine-os em uma chave otimizada.",mergeKey1:"Primeira Chave (JSON)",mergeKey2:"Segunda Chave (JSON)",uploadKey1:"Carregar Chave 1 (JSON)",uploadKey2:"Carregar Chave 2 (JSON)",mergeStrategy:"Estratgia de Combinao",strategyUnion:"Unio (Tudo includo)",strategyUnionDesc:"Incluir todas as caractersticas e entidades de ambas as chaves",strategyIntersection:"Interseo (Comum)",strategyIntersectionDesc:"Focar nas caractersticas compartilhadas entre as chaves",strategyPrimary:"Primria (Base Chave 1)",strategyPrimaryDesc:"Usar Chave 1 como base, adicionar elementos nicos da Chave 2",remove:"Remover",mergeAction:"Combinar Chaves",mergeLoaded:"carregado",stateImage:"Imagem do estado",addStateImage:"Adicionar imagem",viewImage:"Ver imagem",closeImage:"Fechar",clearImage:"Limpar Imagem"}},nl=e=>e.toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," "),od=(e,t)=>{const r=nl(e),n=nl(t);if(r===n||r.includes(n)||n.includes(r))return!0;const i=r.split(" ").filter(a=>a.length>2),s=n.split(" ").filter(a=>a.length>2);if(i.length>0&&s.length>0&&i[0]===s[0]){const a=i.filter(o=>s.includes(o));if(a.length>=2||a.length===1&&Math.min(i.length,s.length)===1)return!0}return!1},n7=(e,t,r=!0)=>{if(console.log(`[mergeProjectsPreservingData] Starting merge: new=${e.entities.length} entities, existing=${t.entities.length} entities`),!e.entities||e.entities.length===0)return console.error("[mergeProjectsPreservingData] CRITICAL: AI returned EMPTY project! Preserving original."),t;if(e.entities.length<t.entities.length&&console.warn(`[mergeProjectsPreservingData] PARTIAL RESPONSE: AI returned ${e.entities.length} of ${t.entities.length} entities. Will merge available data and preserve remaining entities.`),!e.features||e.features.length===0)return console.error("[mergeProjectsPreservingData] CRITICAL: AI returned NO features! Preserving original."),t;const i=W=>W.entities.reduce((te,ge)=>te+Object.values(ge.traits).reduce((oe,J)=>oe+J.length,0),0),s=i(t),a=i(e);console.log(`[mergeProjectsPreservingData] Trait count - existing: ${s}, new: ${a}`);const o=new Map(t.entities.map(W=>[W.id,W])),c=new Map(t.features.map(W=>[W.id,W])),l=new Set,u=W=>W?["picsum.photos","placehold.co","placeholder.com","via.placeholder","dummyimage.com","fakeimg.pl","lorempixel.com"].some(ge=>W.includes(ge)):!0,h=W=>{if(o.has(W.id))return o.get(W.id);for(const te of t.entities)if(od(W.name,te.name))return te},m=W=>{if(c.has(W.id))return c.get(W.id);for(const te of t.features)if(od(W.name,te.name))return te},x=new Map;e.features.forEach(W=>{x.set(W.id,W.name)});let g={featureMatches:0,stateMatches:0,stateMisses:0,traitsFilled:0,traitsSkipped:0};const v=W=>{if(c.has(W))return W;const te=e.features.find(oe=>oe.id===W);if(te){const oe=m(te);if(oe)return g.featureMatches++,oe.id}const ge=x.get(W);if(ge){for(const oe of t.features)if(od(ge,oe.name))return g.featureMatches++,oe.id}return null},y=(W,te,ge)=>{const oe=c.get(te);if(!oe)return null;if(oe.states.find(G=>G.id===W))return g.stateMatches++,W;let de=null;const Z=e.features.find(G=>G.id===ge);if(Z){const G=Z.states.find(F=>F.id===W);G&&(de=G.label)}if(!de)for(const G of e.features){const F=G.states.find(O=>O.id===W);if(F){de=F.label;break}}if(!de&&W.includes("_")){const G=W.split("_").slice(0,-1).join("_").replace(/-/g," ");G.length>2&&(de=G)}if(de){const G=nl(de),F=oe.states.find(X=>nl(X.label)===G);if(F)return g.stateMatches++,F.id;const O=oe.states.find(X=>{const he=nl(X.label);return he.includes(G)||G.includes(he)});if(O)return g.stateMatches++,O.id}if(Z){const G=Z.states.findIndex(F=>F.id===W);if(G>=0&&G<oe.states.length)return g.stateMatches++,oe.states[G].id}const R=parseInt(W,10);return!isNaN(R)&&R>=0&&R<oe.states.length?(g.stateMatches++,oe.states[R].id):(g.stateMisses++,null)},E=W=>{const te=c.get(W);return te?new Set(te.states.map(ge=>ge.id)):new Set},w=W=>{const te={};for(const[ge,oe]of Object.entries(W))if(c.has(ge)){const J=E(ge),de=oe.filter(Z=>J.has(Z));de.length>0&&(te[ge]=de)}return te},T=(W,te)=>{const oe={...w(te)},J=new Set(e.features.map(de=>de.id));for(const[de,Z]of Object.entries(W)){const R=v(de);if(R){const G=[];for(const F of Z){const O=y(F,R,de);O&&G.push(O)}G.length>0&&(!oe[R]||oe[R].length===0?(oe[R]=G,g.traitsFilled++):g.traitsSkipped++)}else J.has(de)&&Z.length>0&&(oe[de]=[...Z],g.traitsFilled++)}return oe},k=e.entities.map(W=>{const te=h(W);return te&&l.add(te.id),te?{...W,id:te.id,imageUrl:!u(te.imageUrl)&&u(W.imageUrl)?te.imageUrl:W.imageUrl||te.imageUrl,links:W.links&&W.links.length>0?W.links:te.links,description:W.description&&W.description.length>20?W.description:te.description||W.description,scientificName:W.scientificName||te.scientificName,family:W.family||te.family,traits:T(W.traits,te.traits)}:W});if(r){const W=t.entities.filter(te=>!l.has(te.id));W.length>0&&(console.warn("[mergeProjectsPreservingData] "),console.warn("[mergeProjectsPreservingData] PARTIAL MERGE SUMMARY:"),console.warn(`[mergeProjectsPreservingData]    Updated: ${l.size} entities with new AI data`),console.warn(`[mergeProjectsPreservingData]    Preserved: ${W.length} entities (not in AI response)`),console.warn(`[mergeProjectsPreservingData]   Total: ${l.size+W.length} entities`),console.warn("[mergeProjectsPreservingData] "),console.log("[mergeProjectsPreservingData] Preserved entities (user can re-run for these):"),W.slice(0,10).forEach(te=>console.log(`  - "${te.name}"`)),W.length>10&&console.log(`  ... and ${W.length-10} more`),k.push(...W))}const b=new Set,I=[],S=e.features.map(W=>{const te=m(W);return te&&b.add(te.id),te?{...te,name:W.name||te.name,imageUrl:!u(te.imageUrl)&&u(W.imageUrl)?te.imageUrl:W.imageUrl||te.imageUrl,states:te.states}:(I.push(W.name),W)});if(I.length>0&&(console.log(`[mergeProjectsPreservingData]  AI added ${I.length} NEW features:`),I.forEach(W=>console.log(`  + "${W}"`))),r){const W=t.features.filter(te=>!b.has(te.id));W.length>0&&(console.warn(`[mergeProjectsPreservingData] AI omitted ${W.length} features. Re-adding them to prevent data loss:`),W.forEach(te=>console.warn(`  - "${te.name}" (ID: ${te.id})`)),S.push(...W))}console.log(`[mergeProjectsPreservingData] Final result: ${k.length} entities, ${S.length} features (${I.length} new, ${b.size} updated, ${S.length-I.length-b.size} preserved)`);const B=new Map;S.forEach(W=>{B.set(W.id,new Set(W.states.map(te=>te.id)))});let D={entitiesProcessed:0,invalidTraitsRemoved:0,entitiesWithIssues:0};const H=k.map(W=>{const te={};let ge=!1;for(const[oe,J]of Object.entries(W.traits)){const de=B.get(oe);if(de){const Z=J.filter(R=>de.has(R));Z.length>0&&(te[oe]=Z),Z.length!==J.length&&(ge=!0,D.invalidTraitsRemoved+=J.length-Z.length)}else ge=!0,D.invalidTraitsRemoved+=J.length}return D.entitiesProcessed++,ge&&D.entitiesWithIssues++,{...W,traits:te}});console.log("[mergeProjectsPreservingData] "),console.log("[mergeProjectsPreservingData] MERGE COMPLETE SUMMARY:"),console.log(`[mergeProjectsPreservingData]    Entities: ${H.length} total (${l.size} matched, ${H.length-l.size} preserved/new)`),console.log(`[mergeProjectsPreservingData]    Features: ${S.length} total`),console.log(`[mergeProjectsPreservingData]    Mapping: ${g.featureMatches} features, ${g.stateMatches} states matched, ${g.stateMisses} state misses`),console.log(`[mergeProjectsPreservingData]    Traits: ${g.traitsFilled} gaps filled, ${g.traitsSkipped} skipped (already had data)`),D.invalidTraitsRemoved>0&&console.warn(`[mergeProjectsPreservingData]    Sanitization: ${D.invalidTraitsRemoved} invalid trait IDs removed from ${D.entitiesWithIssues} entities`),console.log("[mergeProjectsPreservingData] ");const Y=new Set,q=H.filter(W=>Y.has(W.id)?(console.warn(`[mergeProjectsPreservingData] Removing duplicate entity ID: ${W.id} (${W.name})`),!1):(Y.add(W.id),!0)),ue=new Set,Te=S.filter(W=>ue.has(W.id)?(console.warn(`[mergeProjectsPreservingData] Removing duplicate feature ID: ${W.id} (${W.name})`),!1):(ue.add(W.id),!0));return(q.length!==H.length||Te.length!==S.length)&&console.warn(`[mergeProjectsPreservingData] Deduplication removed ${H.length-q.length} entity and ${S.length-Te.length} feature duplicates`),{...e,id:t.id||e.id,entities:q,features:Te}},i7=({initialProject:e,onSave:t,onCancel:r,language:n,defaultModel:i,apiKey:s,onOpenSettings:a,onProjectImported:o,openAiModalOnMount:c})=>{var Ip,Fp,Rp,Pp,Mp;const l=r7[n],u=_=>{const N=new Set,V=new Set,z=_.entities.filter(se=>N.has(se.id)?!1:(N.add(se.id),!0)),Q=_.features.filter(se=>V.has(se.id)?!1:(V.add(se.id),!0));return z.length!==_.entities.length||Q.length!==_.features.length?{..._,entities:z,features:Q}:_},[h,m]=ke.useState(u(e||{id:Math.random().toString(36).substr(2,9),name:n==="pt"?"Nova Chave":"New Key",description:"",features:[],entities:[]})),x=_=>{m(N=>{const V=typeof _=="function"?_(N):_;return u(V)})},[g,v]=ke.useState("GENERAL"),[y,E]=ke.useState({topic:"",category:"FLORA",count:10,featureCount:5,geography:"",taxonomy:"",taxonomyFamily:"",taxonomyGenus:"",biome:"",stateUF:"",scope:"national",language:n,featureFocus:"general",includeSpeciesImages:!0,includeFeatureImages:!0,includeLinks:!0,model:i,detailLevel:2}),[w,T]=ke.useState(!1),[k,b]=ke.useState(""),[I,S]=ke.useState(!1),[B,D]=ke.useState("CATEGORY"),[H,Y]=ke.useState("TOPIC"),[q,ue]=ke.useState(null),[Te,W]=ke.useState(!1),[te,ge]=ke.useState([]),[oe,J]=ke.useState(!1),[de,Z]=ke.useState(!1),[R,G]=ke.useState(null),[F,O]=ke.useState(null),[X,he]=ke.useState(null),[ae,ve]=ke.useState("EXPAND"),[ye,Ge]=ke.useState(null),[C,Re]=ke.useState({expandCount:10,keepExisting:!0,addFeatures:!0,expandFamily:"",expandGenus:"",expandBiome:"",expandStateUF:"",expandScope:"national",expandRequiredSpecies:"",refineRequiredFeatures:[],featureType:"both",improveDescriptions:!0,fillGaps:!0,removeRedundant:!1,fixInconsistencies:!0,refineFeatureCount:3,completePhotos:!1,photoTarget:"both",photoMode:"expand",photoCustomSources:"",validateFixNames:!0,validateMergeSynonyms:!0,validateCheckGeography:!0,validateCheckTaxonomy:!0,validateReference:"floradobrasil",validateFamily:"",validateGenus:"",validateBiome:"",validateStateUF:"",validateScope:"national"}),[Ve,dt]=ke.useState(null),[Ze,Ie]=ke.useState(!1),[wt,Mr]=ke.useState(null),[Gr,Vr]=ke.useState(null),[ra,tn]=ke.useState(!1),[Qt,mn]=ke.useState([]),[Kn,ui]=ke.useState(!1),[lt,rn]=ke.useState(null),[Ke,_t]=ke.useState("union"),[nt,ht]=ke.useState({searchText:"",family:"",genus:"",scientificName:"",onlyWithGaps:!1}),[Gt,Pi]=ke.useState([]),[Mi,xs]=ke.useState(!1),[qt,xn]=ke.useState(""),[Yn,na]=ke.useState(""),co=ws.useRef(null),gs=y.category==="FAUNA"?n==="pt"?[{category:"Morfolgicas",items:["Forma do corpo","Colorao","Tamanho","Tipo de pele/tegumento","Nmero de patas","Presena de cauda","Tipo de bico/boca","Dimorfismo sexual"]},{category:"Comportamentais",items:["Dieta/Alimentao","Hbito (diurno/noturno)","Comportamento social","Modo de locomoo","Vocalizao","Reproduo"]},{category:"Habitat",items:["Tipo de ambiente","Estrato","Distribuio geogrfica"]}]:[{category:"Morphological",items:["Body shape","Coloration","Size","Skin type","Number of legs","Tail presence","Beak/mouth type","Sexual dimorphism"]},{category:"Behavioral",items:["Diet","Activity pattern","Social behavior","Locomotion","Vocalization","Reproduction"]},{category:"Habitat",items:["Environment type","Stratum","Geographic distribution"]}]:y.category==="OTHER"?n==="pt"?[{category:"Visuais/Fsicas",items:["Cor predominante","Formato","Material","Tamanho","Estilo visual","Textura"]},{category:"Conceituais",items:["Gnero/Categoria","Tema","poca/Ano","Origem","Autor/Criador","Pblico-alvo"]},{category:"Outros",items:["Popularidade","Prmios","Durao/Extenso"]}]:[{category:"Visual/Physical",items:["Dominant color","Shape","Material","Size","Visual style","Texture"]},{category:"Conceptual",items:["Genre/Category","Theme","Era/Year","Origin","Author/Creator","Target audience"]},{category:"Other",items:["Popularity","Awards","Duration/Length"]}]:n==="pt"?[{category:"Vegetativas",items:["Tipo de folha (simples/composta)","Filotaxia (alterna/oposta/verticilada)","Margem foliar","Forma da folha","Textura da folha","Presena de estpulas","Tipo de nervao","Forma do caule","Tipo de casca","Hbito de crescimento","Presena de espinhos/acleos","Presena de ltex","Tipo de raiz","Presena de tricomas/pelos","Domcias"]},{category:"Reprodutivas",items:["Tipo de inflorescncia","Cor da flor","Nmero de ptalas","Simetria floral","Tipo de fruto","Cor do fruto","Tipo de semente","Deiscncia do fruto"]},{category:"Ecolgicas",items:["Ambiente/habitat","Altitude","Fenologia","Polinizadores","Disperso"]}]:[{category:"Vegetative",items:["Leaf type (simple/compound)","Phyllotaxy (alternate/opposite/whorled)","Leaf margin","Leaf shape","Leaf texture","Stipule presence","Venation type","Stem shape","Bark type","Growth habit","Spine/prickle presence","Latex presence","Root type","Trichome/hair presence","Domatia"]},{category:"Reproductive",items:["Inflorescence type","Flower color","Petal number","Floral symmetry","Fruit type","Fruit color","Seed type","Fruit dehiscence"]},{category:"Ecological",items:["Habitat/environment","Altitude","Phenology","Pollinators","Dispersal"]}],[uf,Zt]=ke.useState(!1),[vs,fi]=ke.useState(""),[uo,Yl]=ke.useState(!1),fo=ke.useRef(null),Xl=ke.useRef(""),wr=ws.useRef(null),it=_=>{var V;let N;typeof _=="function"?N=_(Xl.current):N=_,N&&!uo&&Yl(!0),!N&&uo&&Yl(!1),Xl.current=N,(V=fo.current)==null||V.setText(N)},Hr=_=>{var N;(N=fo.current)==null||N.setComplete(_)},[ia,A]=ke.useState(null),[L,P]=ke.useState(null),[M,U]=ke.useState(h.features.length>0?h.features[0].id:null),j=ws.useRef(null),[re,fe]=ke.useState(!1),ee=_=>{const N=M!==_;U(V=>V===_?null:_),N&&j.current&&setTimeout(()=>{const V=j.current;if(!V)return;const z=h.features.findIndex(pe=>pe.id===_);if(z===-1)return;let Q=200;for(let pe=0;pe<z;pe++)Q+=70;const se=V.clientWidth,K=h.features[z].states.length*90,ce=Q-se/2+K/2;V.scrollTo({left:Math.max(0,ce),behavior:"smooth"})},100)},ne=_=>{const N=h.features.findIndex(z=>z.id===M);if(N===-1)return;const V=_==="prev"?(N-1+h.features.length)%h.features.length:(N+1)%h.features.length;ee(h.features[V].id)};ke.useEffect(()=>{E(_=>({..._,language:n}))},[n]);const ie=ws.useMemo(()=>{const _=new Set;return h.entities.forEach(N=>{N.family&&N.family.trim()&&_.add(N.family.trim())}),Array.from(_).sort()},[h.entities]),we=ws.useMemo(()=>{const _=new Set;return h.entities.forEach(N=>{const z=(N.scientificName||N.name||"").split(" ")[0];z&&z.trim()&&/^[A-Z][a-z]+$/.test(z)&&_.add(z.trim())}),Array.from(_).sort()},[h.entities]),Ae=ws.useMemo(()=>h.entities.filter(_=>{var N,V,z;if(nt.searchText){const Q=nt.searchText.toLowerCase(),se=(N=_.name)==null?void 0:N.toLowerCase().includes(Q),K=(V=_.scientificName)==null?void 0:V.toLowerCase().includes(Q);if(!se&&!K)return!1}if(nt.family&&((z=_.family)==null?void 0:z.toLowerCase())!==nt.family.toLowerCase())return!1;if(nt.genus){const se=(_.scientificName||_.name||"").split(" ")[0];if((se==null?void 0:se.toLowerCase())!==nt.genus.toLowerCase())return!1}return!(nt.onlyWithGaps&&!h.features.some(se=>(_.traits[se.id]||[]).length===0))}),[h.entities,h.features,nt]),Oe=()=>{ht({searchText:"",family:"",genus:"",scientificName:"",onlyWithGaps:!1})},Se=nt.searchText||nt.family||nt.genus||nt.onlyWithGaps;ke.useEffect(()=>{E(_=>({..._,model:i}))},[i]),ke.useEffect(()=>{const _=j.current;if(!_)return;const N=()=>{fe(_.scrollTop>0)};return _.addEventListener("scroll",N),()=>_.removeEventListener("scroll",N)},[]),ke.useEffect(()=>{const _=localStorage.getItem("nozesia_projects");if(_)try{ge(JSON.parse(_))}catch{console.error("Failed to load local projects")}},[]),ke.useEffect(()=>{c&&S(!0)},[c]);const Me=_=>x(N=>({...N,..._})),qe=_=>_?["picsum.photos","placehold.co","placeholder.com","via.placeholder","dummyimage.com","fakeimg.pl","lorempixel.com","placekitten.com","loremflickr.com"].some(V=>_.toLowerCase().includes(V)):!0,vt=_=>({..._,entities:_.entities.map(N=>({...N,imageUrl:qe(N.imageUrl)?"":N.imageUrl})),features:_.features.map(N=>({...N,imageUrl:qe(N.imageUrl)?"":N.imageUrl}))}),Et=()=>{const N=[vt(h),...te.filter(V=>V.id!==h.id)];ge(N),localStorage.setItem("nozesia_projects",JSON.stringify(N)),alert(l.savedMsg)},sr=_=>{x(_),J(!1)},Di=()=>{const _=vt(h),N="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(_,null,2)),V=document.createElement("a");V.setAttribute("href",N),V.setAttribute("download",`${h.name.replace(/\s+/g,"_")}.json`),document.body.appendChild(V),V.click(),V.remove()},Li=()=>{const _=vt(h),N=Wr.book_new(),V=_.entities.map(Pe=>{var Ee,Fe;return{ID:Pe.id,Name:Pe.name,Description:Pe.description,ImageURL:Pe.imageUrl,LinkLabels:((Ee=Pe.links)==null?void 0:Ee.map(be=>be.label).join("; "))||"",LinkURLs:((Fe=Pe.links)==null?void 0:Fe.map(be=>be.url).join("; "))||""}}),z=Wr.json_to_sheet(V);Wr.book_append_sheet(N,z,"Entities");const Q=_.features.map(Pe=>({ID:Pe.id,Name:Pe.name,ImageURL:qe(Pe.imageUrl)?"":Pe.imageUrl,States:Pe.states.map(Ee=>Ee.label).join("; ")})),se=Wr.json_to_sheet(Q);Wr.book_append_sheet(N,se,"Features");const K=_.entities.map(Pe=>{const Ee={Entity:Pe.name};return _.features.forEach(Fe=>{const be=Pe.traits[Fe.id]||[],Je=Fe.states.filter(Ue=>be.includes(Ue.id)).map(Ue=>Ue.label).join(", ");Ee[Fe.name]=Je}),Ee}),ce=Wr.json_to_sheet(K);Wr.book_append_sheet(N,ce,"Matrix");const pe=[{Name:_.name,Description:_.description,ExportDate:new Date().toISOString().split("T")[0],TotalEntities:_.entities.length,TotalFeatures:_.features.length}],De=Wr.json_to_sheet(pe);Wr.book_append_sheet(N,De,"Project Info"),iE(N,`${_.name.replace(/\s+/g,"_")}.xlsx`)},Oi=()=>{const _=vt(h),N=t7(_,n),V=new Blob([N],{type:"text/html;charset=utf-8"}),z=URL.createObjectURL(V),Q=document.createElement("a");Q.href=z,Q.download=`${_.name.replace(/\s+/g,"_")}.html`,Q.click(),URL.revokeObjectURL(z)},[fr,sa]=ke.useState(!1);ke.useEffect(()=>{var _,N,V,z,Q;if(F&&!w&&!R){const se=((_=F.features)==null?void 0:_.reduce((ce,pe)=>{var De;return ce+(((De=pe.states)==null?void 0:De.length)||0)},0))||0,K=n==="pt"?` Projeto: "${F.name}"
 ${((N=F.entities)==null?void 0:N.length)||0} entidades  ${((V=F.features)==null?void 0:V.length)||0} caractersticas  ${se} estados

${fr?` Modo: Otimizar com IA

 Clique no boto amarelo abaixo para iniciar a importao.`:` Modo: Importao Fiel

 Clique no boto amarelo abaixo para confirmar a importao.`}`:` Project: "${F.name}"
 ${((z=F.entities)==null?void 0:z.length)||0} entities  ${((Q=F.features)==null?void 0:Q.length)||0} features  ${se} states

${fr?` Mode: Optimize with AI

 Click the yellow button below to start import.`:` Mode: Faithful Import

 Click the yellow button below to confirm import.`}`;it(K)}},[fr,F,w,R,n]);const Pn=()=>{var N,V;const _=localStorage.getItem("nozesia_projects");if(!_)return[];try{const z=JSON.parse(_);if(z.length===0)return[];const Q=[],se=z.reduce((Ee,Fe)=>{var be;return Ee+(((be=Fe.entities)==null?void 0:be.length)||0)},0),K=z.reduce((Ee,Fe)=>{var be;return Ee+(((be=Fe.features)==null?void 0:be.length)||0)},0),ce=z.flatMap(Ee=>{var Fe;return((Fe=Ee.entities)==null?void 0:Fe.map(be=>be.name))||[]}),pe=[...new Set(ce)],De=z.flatMap(Ee=>{var Fe;return((Fe=Ee.features)==null?void 0:Fe.map(be=>be.name))||[]}),Pe=[...new Set(De)];if(n==="pt"){if(z.length>0&&Q.push(` Voc possui ${z.length} chave${z.length>1?"s":""} salva${z.length>1?"s":""} no banco de dados`),se>0&&Q.push(` Ao todo, suas chaves contm ${se} entidades catalogadas`),K>0&&Q.push(` ${K} caractersticas morfolgicas registradas em seu acervo`),pe.length>0){const Ee=pe.sort(()=>Math.random()-.5).slice(0,3);Q.push(` Algumas espcies em suas chaves: ${Ee.join(", ")}`)}if(Pe.length>0){const Ee=Pe.sort(()=>Math.random()-.5).slice(0,3);Q.push(` Caractersticas utilizadas: ${Ee.join(", ")}`)}if(z.length>0){const Ee=z[0];Q.push(` Sua chave mais recente: "${Ee.name}"`)}if(z.length>1){const Ee=z.reduce((Fe,be)=>{var Je,Ue;return(((Je=be.entities)==null?void 0:Je.length)||0)>(((Ue=Fe.entities)==null?void 0:Ue.length)||0)?be:Fe},z[0]);((N=Ee.entities)==null?void 0:N.length)>0&&Q.push(` Maior chave: "${Ee.name}" com ${Ee.entities.length} entidades`)}}else{if(z.length>0&&Q.push(` You have ${z.length} key${z.length>1?"s":""} saved in your database`),se>0&&Q.push(` In total, your keys contain ${se} catalogued entities`),K>0&&Q.push(` ${K} morphological features recorded in your collection`),pe.length>0){const Ee=pe.sort(()=>Math.random()-.5).slice(0,3);Q.push(` Some species in your keys: ${Ee.join(", ")}`)}if(Pe.length>0){const Ee=Pe.sort(()=>Math.random()-.5).slice(0,3);Q.push(` Features used: ${Ee.join(", ")}`)}if(z.length>0){const Ee=z[0];Q.push(` Your most recent key: "${Ee.name}"`)}if(z.length>1){const Ee=z.reduce((Fe,be)=>{var Je,Ue;return(((Je=be.entities)==null?void 0:Je.length)||0)>(((Ue=Fe.entities)==null?void 0:Ue.length)||0)?be:Fe},z[0]);((V=Ee.entities)==null?void 0:V.length)>0&&Q.push(` Largest key: "${Ee.name}" with ${Ee.entities.length} entities`)}}return Q}catch(z){return console.error("Error generating curiosities:",z),[]}},BE=_=>{var It,Ye,ft,dr,Mn;const N=((It=_.entities)==null?void 0:It.length)||0,V=((Ye=_.features)==null?void 0:Ye.length)||0,z=((ft=_.features)==null?void 0:ft.reduce((hr,zr)=>{var Xn;return hr+(((Xn=zr.states)==null?void 0:Xn.length)||0)},0))||0,Q=((dr=_.description)==null?void 0:dr.includes("Chave de identificao"))||((Mn=_.features)==null?void 0:Mn.some(hr=>hr.name==="Forma de Vida"||hr.name==="Filotaxia"))||n==="pt",ce=`NervuraColetora ${Q?"PTBR":"EN"} v1 (${N}sp / ${V}crc)`;let pe=Q?"Coletor no especificado":"Collector not specified",De="",Pe="",Ee="",Fe=[],be=[],Je="";if(_.description){const hr=_.description.match(/pelo coletor[:\s]+([^\n.]+)/i)||_.description.match(/by collector[:\s]+([^\n.]+)/i);hr&&(pe=hr[1].trim());const zr=_.description.match(/Data de coleta[:\s]+([^\n]+)/i)||_.description.match(/Collection date[:\s]+([^\n]+)/i);zr&&(De=zr[1].trim());const Xn=_.description.match(/Data de exportao[:\s]+([^\n]+)/i)||_.description.match(/Export date[:\s]+([^\n]+)/i);Xn&&(Pe=Xn[1].trim());const ho=_.description.match(/Estados de coleta[:\s]+([^\n]+)/i)||_.description.match(/Collection states[:\s]+([^\n]+)/i);ho&&(Ee=ho[1].trim());const po=_.description.match(/FAMLIAS[:\s]*\n([^\n]+)/i)||_.description.match(/FAMILIES[:\s]*\n([^\n]+)/i);po&&(Fe=po[1].split(",").map(ys=>ys.trim()).filter(ys=>ys));const mo=_.description.match(/GNEROS[:\s]*\n([^\n]+)/i)||_.description.match(/GENERA[:\s]*\n([^\n]+)/i);mo&&(be=mo[1].split(",").map(ys=>ys.trim()).filter(ys=>ys));const xo=_.description.match(/FORMAS DE VIDA[:\s]*\n([^\n]+)/i)||_.description.match(/LIFE FORMS[:\s]*\n([^\n]+)/i);xo&&(Je=xo[1].trim())}if(Fe.length===0&&_.entities){const hr=new Set,zr=new Set;_.entities.forEach(Xn=>{var mo,xo;const ho=(mo=Xn.description)==null?void 0:mo.match(/Famlia[:\s]+([A-Za-z]+)/i);ho&&hr.add(ho[1]);const po=(xo=Xn.name)==null?void 0:xo.match(/^([A-Z][a-z]+)/);po&&zr.add(po[1])}),Fe=Array.from(hr),be=Array.from(zr)}let Ue="";return Q?(Ue=` Chave de identificao produzida com dados coletados no NervuraColetora pelo coletor: ${pe}.

`,De&&(Ue+=` Data de coleta: ${De}
`),Pe?Ue+=` Data de exportao: ${Pe}
`:Ue+=` Data de importao: ${new Date().toLocaleDateString("pt-BR")}
`,Ue+=`
 ESTATSTICAS:
`,Ue+=` Nmero de espcies/entidades: ${N}
`,Ue+=` Nmero de caractersticas morfolgicas: ${V}
`,Ue+=` Nmero total de estados: ${z}
`,Fe.length>0&&(Ue+=` Nmero de famlias: ${Fe.length}
`),be.length>0&&(Ue+=` Nmero de gneros: ${be.length}
`),Ee&&(Ue+=` Estados de coleta: ${Ee}
`),Je&&(Ue+=`
 FORMAS DE VIDA:
${Je}
`),Fe.length>0&&(Ue+=`
 FAMLIAS:
${Fe.join(", ")}
`),be.length>0&&(Ue+=`
 GNEROS:
${be.join(", ")}`)):(Ue=` Identification key produced with data collected in NervuraColetora by collector: ${pe}.

`,De&&(Ue+=` Collection date: ${De}
`),Pe?Ue+=` Export date: ${Pe}
`:Ue+=` Import date: ${new Date().toLocaleDateString("en-US")}
`,Ue+=`
 STATISTICS:
`,Ue+=` Number of species/entities: ${N}
`,Ue+=` Number of morphological features: ${V}
`,Ue+=` Total number of states: ${z}
`,Fe.length>0&&(Ue+=` Number of families: ${Fe.length}
`),be.length>0&&(Ue+=` Number of genera: ${be.length}
`),Ee&&(Ue+=` Collection states: ${Ee}
`),Je&&(Ue+=`
 LIFE FORMS:
${Je}
`),Fe.length>0&&(Ue+=`
 FAMILIES:
${Fe.join(", ")}
`),be.length>0&&(Ue+=`
 GENERA:
${be.join(", ")}`)),{..._,name:ce,description:Ue}},$E=_=>{const N=new FileReader;_.target.files&&_.target.files[0]&&(N.readAsText(_.target.files[0],"UTF-8"),N.onload=V=>{var z,Q;try{const se=JSON.parse((z=V.target)==null?void 0:z.result);if(se.name&&se.features&&se.entities){const K=BE(se);O(K),Zt(!0),it(""),Hr(!1);const ce=((Q=se.features)==null?void 0:Q.reduce((De,Pe)=>{var Ee;return De+(((Ee=Pe.states)==null?void 0:Ee.length)||0)},0))||0,pe=n==="pt"?` Arquivo carregado: "${se.name}"

 Nome padronizado: "${K.name}"
 ${se.entities.length} entidades  ${se.features.length} caractersticas  ${ce} estados

${fr?` Modo: Otimizar com IA

 Clique no boto amarelo abaixo para iniciar a importao.`:` Modo: Importao Fiel

 Clique no boto amarelo abaixo para confirmar a importao.`}`:` File loaded: "${se.name}"

 Standardized name: "${K.name}"
 ${se.entities.length} entities  ${se.features.length} features  ${ce} states

${fr?` Mode: Optimize with AI

 Click the yellow button below to start import.`:` Mode: Faithful Import

 Click the yellow button below to confirm import.`}`;it(pe),Hr(!0)}else alert("Formato invlido. Certifique-se que  um JSON do Nervura/Nozes.")}catch{alert("Erro ao ler o arquivo JSON.")}})},jE=async()=>{if(!F)return;const _=F,N=Pn();if(fr){T(!0),it(""),Hr(!1);const V=n==="pt"?` Analisando estrutura da chave...
 Identificando redundncias...
 Otimizando caractersticas e estados...
`:` Analyzing key structure...
 Identifying redundancies...
 Optimizing features and states...
`,z=N.length>0?(n==="pt"?`
 Curiosidades do seu acervo:
`:`
 Curiosities from your collection:
`)+N.map(ce=>`   ${ce}`).join(`
`)+`
`:"",Q=V+z;let se=0;const K=setInterval(()=>{se<Q.length?(it(ce=>ce+Q.charAt(se)),se++):clearInterval(K)},30);try{const pe=await D1(n==="pt"?"Limpe e otimize esta chave importada. MANTENHA TODO O CONTEDO EM PORTUGUS. Padronize nomes de caractersticas e estados. Remova redundncias.":"Clean and optimize this imported key. KEEP ALL CONTENT IN ENGLISH. Standardize feature and state names. Remove redundancies.",_,s,i,n,"clean");G(pe),O(null);const De=n==="pt"?`

 Otimizao concluda!
 ${pe.entities.length} entidades  ${pe.features.length} caractersticas

 Clique no boto amarelo para confirmar a importao.`:`

 Optimization complete!
 ${pe.entities.length} entities  ${pe.features.length} features

 Click the yellow button to confirm import.`;it(Pe=>Pe+De),Hr(!0)}catch(ce){console.error(ce);const pe=n==="pt"?`

 Erro na otimizao: ${ce.message}

 Voc pode tentar novamente ou importar sem otimizao.`:`

 Optimization error: ${ce.message}

 You can try again or import without optimization.`;it(De=>De+pe),Hr(!0)}finally{clearInterval(K),T(!1)}}else{it(z=>z+(n==="pt"?`

 Processando importao...
`:`

 Processing import...
`)),await new Promise(z=>setTimeout(z,500)),G(_),O(null);const V=n==="pt"?`
 Arquivo processado!

 Clique no boto amarelo para confirmar a importao.`:`
 File processed!

 Click the yellow button to confirm import.`;it(z=>z+V),Hr(!0)}},GE=_=>{var Ue,It;if(!_||_.length<2)return{format:"unknown",confidence:0,description:"Empty or invalid data"};const N=_[0].map(Ye=>(Ye==null?void 0:Ye.toString().toLowerCase().trim())||""),V=(Ue=_[1])==null?void 0:Ue.map(Ye=>(Ye==null?void 0:Ye.toString())||""),z=_.map(Ye=>Ye.join(" ")).join(" ").toLowerCase(),Q=[/chave\s+[a-h]/gi,/key\s+[a-h]/gi,/\bchave\s+\d+/gi];let se=0;if(Q.forEach(Ye=>{const ft=z.match(Ye);ft&&(se+=ft.length)}),se>=3)return{format:"linked_hub",confidence:.95,description:n==="pt"?"Chave Hub com Referncias (sistema de chaves interligadas)":"Hub Key with References (linked key system)"};const K=["passo","diagnose","identificao","prximo","step","diagnosis","result","next","couplet"];if(N.filter(Ye=>K.some(ft=>Ye.includes(ft))).length>=2)return{format:"dichotomous_sequential",confidence:.9,description:n==="pt"?"Chave Dicotmica Sequencial (passos numerados com diagnoses)":"Sequential Dichotomous Key (numbered steps with diagnoses)"};const pe=_.some(Ye=>{var ft,dr;return((ft=Ye[0])==null?void 0:ft.toString().startsWith("  "))||((dr=Ye[0])==null?void 0:dr.toString().startsWith("	"))}),De=_.some(Ye=>{var ft,dr;return((ft=Ye[0])==null?void 0:ft.toString().match(/^\d+\s*\(/))||((dr=Ye[0])==null?void 0:dr.toString().match(/^[a-z]\)/))});if(pe||De)return{format:"indented",confidence:.8,description:n==="pt"?"Chave Indentada (estrutura hierrquica)":"Indented Key (hierarchical structure)"};const Pe=["comparison","comparao","vs","versus","character","caracterstica"];if(N.filter(Ye=>Pe.some(ft=>Ye.includes(ft))).length>=1&&N.length>=3)return{format:"synoptic",confidence:.7,description:n==="pt"?"Chave Sinptica (tabela comparativa)":"Synoptic Key (comparative table)"};const Fe=V&&((It=V[0])==null?void 0:It.length)>0,be=N.length>=3,Je=_.slice(1).every(Ye=>Ye.length>=N.length*.5);return Fe&&be&&Je?{format:"matrix",confidence:.85,description:n==="pt"?"Matriz de Caractersticas (entidades  caractersticas)":"Character Matrix (entities  features)"}:{format:"unknown",confidence:0,description:n==="pt"?"Formato no reconhecido automaticamente":"Format not automatically recognized"}},VE=(_,N)=>{var Ee,Fe,be;if(!N||N.length<2)return alert(n==="pt"?"Planilha vazia ou invlida.":"Empty or invalid spreadsheet."),null;const V=N[0],z=0;if(V.slice(1).filter(Je=>Je&&Je.trim()).length===0)return alert(n==="pt"?"Nenhuma caracterstica encontrada na planilha.":"No features found in spreadsheet."),null;const se=new Map,K=[];for(let Je=1;Je<N.length;Je++){const Ue=N[Je],It=(Ee=Ue[z])==null?void 0:Ee.toString().trim();if(!It)continue;const Ye={};for(let ft=1;ft<V.length;ft++){const dr=(Fe=V[ft])==null?void 0:Fe.toString().trim();if(!dr)continue;const Mn=(be=Ue[ft])==null?void 0:be.toString().trim();if(!Mn)continue;Mn.split(/[,;]/).map(zr=>zr.trim()).filter(Boolean).forEach(zr=>{se.has(dr)||se.set(dr,new Set),se.get(dr).add(zr)}),Ye[dr]=Mn}K.push({name:It,traits:Ye})}const ce=Array.from(se.entries()).map(([Je,Ue],It)=>{const Ye=`f-${Date.now()}-${It}`,ft=Array.from(Ue).map((dr,Mn)=>({id:`s-${Date.now()}-${It}-${Mn}`,label:dr}));return{id:Ye,name:Je,states:ft}}),pe=K.map((Je,Ue)=>{const It={};return ce.forEach(Ye=>{const ft=Je.traits[Ye.name];if(!ft)return;const Mn=ft.split(/[,;]/).map(hr=>hr.trim()).filter(Boolean).map(hr=>{var zr;return(zr=Ye.states.find(Xn=>Xn.label===hr))==null?void 0:zr.id}).filter(hr=>hr!==void 0);Mn.length>0&&(It[Ye.id]=Mn)}),{id:`e-${Date.now()}-${Ue}`,name:Je.name,description:"",traits:It,links:[]}}),De=_.replace(/\.(xlsx|csv|xls)$/i,"");return{id:`proj-${Date.now()}`,name:De,description:n==="pt"?`Chave importada de ${_}`:`Key imported from ${_}`,features:ce,entities:pe}},_p=_=>{var Q;const N=(Q=_.target.files)==null?void 0:Q[0];if(!N)return;const V=N.name.toLowerCase(),z=new FileReader;if(V.endsWith(".xlsx")||V.endsWith(".xls")||V.endsWith(".csv")){z.readAsArrayBuffer(N),z.onload=se=>{var K;try{const ce=new Uint8Array((K=se.target)==null?void 0:K.result),pe=Nu(ce,{type:"array"}),De=pe.SheetNames[0],Pe=pe.Sheets[De],Ee=Wr.sheet_to_json(Pe,{header:1}),Fe=GE(Ee);if(Fe.format==="linked_hub"){Vr({data:Ee,fileName:N.name}),Mr(Fe),Ie(!0);return}if(Fe.format==="dichotomous_sequential"||Fe.format==="indented"||Fe.format==="synoptic"){Vr({data:Ee,fileName:N.name}),Mr(Fe),Ie(!0);return}const be=VE(N.name,Ee);if(!be)return;x(be);const Je=localStorage.getItem("nozesia_projects");let Ue=[];if(Je)try{Ue=JSON.parse(Je)}catch(Ye){console.error("Failed to parse projects",Ye)}const It=[be,...Ue.filter(Ye=>Ye.id!==be.id)];localStorage.setItem("nozesia_projects",JSON.stringify(It)),o&&o(be)}catch(ce){console.error(ce),alert(n==="pt"?"Erro ao processar planilha.":"Error processing spreadsheet.")}};return}z.readAsText(N,"UTF-8"),z.onload=se=>{var K;try{const ce=JSON.parse((K=se.target)==null?void 0:K.result);if(ce.name&&ce.features&&ce.entities){x(ce);const pe=localStorage.getItem("nozesia_projects");let De=[];if(pe)try{De=JSON.parse(pe)}catch(Ee){console.error("Failed to parse projects",Ee)}const Pe=[ce,...De.filter(Ee=>Ee.id!==ce.id)];localStorage.setItem("nozesia_projects",JSON.stringify(Pe)),o&&o(ce)}else alert(n==="pt"?"Formato de arquivo invlido.":"Invalid project file format.")}catch{alert(n==="pt"?"Erro ao processar arquivo JSON.":"Error parsing JSON file.")}}},HE=_=>{if(_.target.files){const N=Array.from(_.target.files);mn(N),ui(!0)}},zE=async(_,N)=>{if(!y.model||_.length===0){alert(n==="pt"?"Configure a API Key primeiro":"Configure API Key first");return}tn(!0),ui(!1);try{const V=[];for(let K=0;K<_.length;K++){const ce=_[K];b(n==="pt"?`Processando ${K+1}/${_.length}: ${ce.name}...`:`Processing ${K+1}/${_.length}: ${ce.name}...`);const pe=await ce.arrayBuffer(),De=Nu(new Uint8Array(pe),{type:"array"}),Pe=De.Sheets[De.SheetNames[0]],Ee=Wr.sheet_to_json(Pe,{header:1}),Fe=await L1(y.model,Ee,ce.name,n);K!==N&&(Fe.isSubKey=!0,Fe.parentKeyId=`main-${Date.now()}`),V.push(Fe)}const z=V[N];z.subKeys=V.filter((K,ce)=>ce!==N).map(K=>({id:K.id,name:K.name,description:K.description,projectId:K.id})),x(z);const Q=localStorage.getItem("nozesia_projects");let se=Q?JSON.parse(Q):[];V.forEach(K=>{se=[K,...se.filter(ce=>ce.id!==K.id)]}),localStorage.setItem("nozesia_projects",JSON.stringify(se)),o&&o(z),alert(n==="pt"?`${V.length} chaves importadas com sucesso!`:`${V.length} keys imported successfully!`)}catch(V){console.error("Multi-file import error:",V),alert(n==="pt"?"Erro ao processar arquivos":"Error processing files")}finally{tn(!1),b("")}},WE=_=>{_.target.files&&_.target.files[0]&&ue(_.target.files[0])},Sp=_=>{_.preventDefault(),_.stopPropagation(),W(!0)},qE=_=>{_.preventDefault(),_.stopPropagation(),W(!1)},JE=_=>{_.preventDefault(),_.stopPropagation(),W(!1);const N=_.dataTransfer.files;if(N&&N.length>0){const V=N[0],z=["application/pdf","text/plain","image/jpeg","image/png","image/jpg"],Q=[".pdf",".txt",".jpg",".jpeg",".png"],se=V.name.toLowerCase();z.includes(V.type)||Q.some(ce=>se.endsWith(ce))?ue(V):alert(n==="pt"?"Tipo de arquivo no suportado. Use PDF, TXT, JPG ou PNG.":"Unsupported file type. Use PDF, TXT, JPG or PNG.")}},KE=async _=>{if(!_.target.files||!_.target.files[0])return;const N=_.target.files[0],V=N.name.toLowerCase();try{let z="";if(V.endsWith(".txt")||V.endsWith(".csv"))z=(await N.text()).split(/[\n\r,;]+/).map(K=>K.trim()).filter(K=>K.length>0&&!K.match(/^(species|especie|nome|name|#)/i)).join(`
`);else if(V.endsWith(".json")){const Q=await N.text(),se=JSON.parse(Q);let K=[];Array.isArray(se)?K=se.map(ce=>typeof ce=="string"?ce:ce.name||ce.species||ce.especie||"").filter(Boolean):se.species?K=Array.isArray(se.species)?se.species:[se.species]:se.entities&&(K=se.entities.map(ce=>ce.name||"").filter(Boolean)),z=K.join(`
`)}else if(V.endsWith(".xlsx")||V.endsWith(".xls")){alert(n==="pt"?"Para arquivos Excel, por favor salve como .csv ou .txt primeiro, ou copie e cole a lista diretamente.":"For Excel files, please save as .csv or .txt first, or copy and paste the list directly.");return}else if(V.endsWith(".doc")||V.endsWith(".docx")){alert(n==="pt"?"Para arquivos Word, por favor copie e cole a lista diretamente no campo de texto.":"For Word files, please copy and paste the list directly into the text field.");return}if(Yn.trim()){const Q=Yn.split(`
`).filter(ce=>ce.trim()),se=z.split(`
`).filter(ce=>ce.trim()),K=[...new Set([...Q,...se])];na(K.join(`
`))}else na(z);co.current&&(co.current.value="")}catch(z){console.error("Error importing species list:",z),alert(n==="pt"?"Erro ao importar arquivo. Verifique o formato.":"Error importing file. Check the format.")}},kp=_=>new Promise((N,V)=>{const z=new FileReader;z.onload=()=>{const se=z.result.split(",")[1];N(se)},z.onerror=Q=>V(Q),z.readAsDataURL(_)}),YE=()=>{const _=[],N=n==="pt"?[" Analisando estrutura do documento..."," Identificando caractersticas taxonmicas..."," Processando matriz de identificao..."," Extraindo informaes das espcies..."]:[" Analyzing document structure..."," Identifying taxonomic features..."," Processing identification matrix..."," Extracting species information..."];if(_.push(...N),te.length>0){const V=n==="pt"?`
 Enquanto isso, voc sabia que...`:`
 Meanwhile, did you know that...`;_.push(V),te.forEach(K=>{if(K.entities&&K.entities.length>0&&[...K.entities].sort(()=>Math.random()-.5).slice(0,3).forEach(pe=>{if(pe.description&&pe.description.length>20){const De=n==="pt"?`
 "${pe.name}": ${pe.description}`:`
 "${pe.name}": ${pe.description}`;_.push(De)}if(pe.scientificName||pe.family){const De=n==="pt"?`
    ${pe.scientificName?`Nome cientfico: ${pe.scientificName}`:""}${pe.scientificName&&pe.family?" | ":""}${pe.family?`Famlia: ${pe.family}`:""}`:`
    ${pe.scientificName?`Scientific name: ${pe.scientificName}`:""}${pe.scientificName&&pe.family?" | ":""}${pe.family?`Family: ${pe.family}`:""}`;(pe.scientificName||pe.family)&&_.push(De)}}),K.features&&K.features.length>0){const ce=K.features[Math.floor(Math.random()*K.features.length)];if(ce.states&&ce.states.length>1){const pe=ce.states.map(Pe=>Pe.label).join(", "),De=n==="pt"?`
 A caracterstica "${ce.name}" pode ter os estados: ${pe}`:`
 The feature "${ce.name}" can have states: ${pe}`;_.push(De)}}});const z=te.reduce((K,ce)=>{var pe;return K+(((pe=ce.entities)==null?void 0:pe.length)||0)},0),Q=te.reduce((K,ce)=>{var pe;return K+(((pe=ce.features)==null?void 0:pe.length)||0)},0),se=n==="pt"?`

 Voc j catalogou ${z} entidades e ${Q} caractersticas em ${te.length} chave(s)!`:`

 You have cataloged ${z} entities and ${Q} features across ${te.length} key(s)!`;_.push(se)}return _},ff=()=>{it(""),Hr(!1);const N=YE().join(`
`);let V=0;wr.current&&clearInterval(wr.current),wr.current=setInterval(()=>{if(V<N.length){const z=Math.min(3,N.length-V);it(Q=>Q+N.substring(V,V+z)),V+=z}},30)},aa=_=>{var N,V,z,Q,se;if(wr.current&&(clearInterval(wr.current),wr.current=null),_){const K=((N=_.entities)==null?void 0:N.length)||0,ce=((V=_.features)==null?void 0:V.length)||0,pe=((z=_.features)==null?void 0:z.reduce((be,Je)=>{var Ue;return be+(((Ue=Je.states)==null?void 0:Ue.length)||0)},0))||0,De=((Q=_.entities)==null?void 0:Q.filter(be=>be.imageUrl&&!be.imageUrl.includes("picsum.photos")&&!be.imageUrl.includes("placehold.co")).length)||0,Pe=((se=_.entities)==null?void 0:se.filter(be=>be.links&&be.links.length>0).length)||0,Ee=n==="pt"?`

 ATENO: REVISO NECESSRIA!

Os dados gerados por IA podem conter:
 Erros taxonmicos ou nomenclaturais
 Caractersticas incorretas ou incompletas
 Associaes espcie-caracterstica imprecisas
 Fotos que no correspondem  espcie

 REVISE E CORRIJA todos os dados antes
   de utilizar esta chave para identificao.`:`

 WARNING: REVIEW REQUIRED!

AI-generated data may contain:
 Taxonomic or nomenclatural errors
 Incorrect or incomplete features
 Inaccurate species-trait associations
 Photos that don't match the species

 REVIEW AND CORRECT all data before
   using this key for identification.`,Fe=n==="pt"?`


 ANLISE CONCLUDA!


 Resumo da Gerao:

    Entidades: ${K}
    Caractersticas: ${ce}
    Estados totais: ${pe}
    Com fotos: ${De}/${K}
    Com links: ${Pe}/${K}${Ee}`:`


 ANALYSIS COMPLETE!


 Generation Summary:

    Entities: ${K}
    Features: ${ce}
    Total states: ${pe}
    With photos: ${De}/${K}
    With links: ${Pe}/${K}${Ee}`;it(be=>be+Fe)}Hr(!0)},XE=()=>{wr.current&&(clearInterval(wr.current),wr.current=null),T(!1),b(""),it(""),Hr(!1),S(!1)},QE=async()=>{if(!s){alert(l.missingKey);return}T(!0),b(l.generating),S(!1),Zt(!0),ff();try{const _=Yn.split(`
`).map(z=>z.trim()).filter(z=>z.length>0);let N={...y,requiredFeatures:Gt,requiredSpecies:_};if(H==="IMPORT"&&q){const z=await kp(q);N.importedFile={data:z,mimeType:q.type},N.topic=`Imported: ${q.name}`}else if(H==="TOPIC"){if(!N.topic.trim())return;N.importedFile=void 0}const V=await XU(N,s,z=>{fi(z)},(z,Q,se)=>{const K=y.language==="pt"?` Buscando imagens: ${z}/${Q} - ${se}`:` Fetching images: ${z}/${Q} - ${se}`;b(K),it(ce=>{const pe=`
 ${se}...`;return ce.includes(pe)?ce:ce+pe})});aa(V),await new Promise(z=>setTimeout(z,2500)),x(V),Zt(!1),v("MATRIX")}catch(_){console.error(_),aa(),it(N=>N+(n==="pt"?`

 ERRO: No foi possvel gerar a chave.`:`

 ERROR: Could not generate the key.`)),await new Promise(N=>setTimeout(N,2e3)),alert(l.errGen),Zt(!1)}finally{T(!1),b("")}},Cp=()=>{var z,Q,se;const _=h.features.map(K=>({id:K.id,name:K.name,states:K.states.map(ce=>({id:ce.id,label:ce.label}))})),N=h.entities.map(K=>({id:K.id,name:K.name,scientificName:K.scientificName||"",family:K.family||"",description:K.description||"",traitsMap:JSON.stringify(K.traits)}));let V="";if(ae==="PHOTOS"){Ge(null);const K=C.photoTarget==="entities"||C.photoTarget==="both",ce=C.photoTarget==="features"||C.photoTarget==="both",pe=C.photoMode==="replace",De=(z=C.photoCustomSources)==null?void 0:z.trim();let Pe={name:h.name};K&&(Pe.entities=h.entities.map(be=>({name:be.name,searchName:Dl(be.scientificName||be.name),currentUrl:pe?"":be.imageUrl||""})).filter(be=>pe||!be.currentUrl)),ce&&(Pe.features=h.features.map(be=>({name:be.name,currentUrl:pe?"":be.imageUrl||""})).filter(be=>pe||!be.currentUrl));const Ee=JSON.stringify(Pe,null,2);let Fe="";De?Fe=`
USER-PREFERRED SOURCES (check these FIRST, in order):
${De.split(`
`).filter(Je=>Je.trim()).map((Je,Ue)=>`${Ue+1}. ${Je.trim()}`).join(`
`)}

If user sources don't have the image, then check these scientific databases:`:Fe=`
SCIENTIFIC IMAGE SOURCES (check in this order):`,V=`
# PHOTO COLLECTION TASK

You are an expert at finding HIGH-QUALITY, VALID image URLs from scientific databases.

## PROJECT: "${h.name}"
${h.description?`Description: ${h.description}`:""}

## ITEMS NEEDING PHOTOS:
${Ee}

## YOUR TASK:
Find ONE valid, high-quality image URL for each item listed above.
${pe?"REPLACE ALL URLs - ignore any existing URLs and find new ones.":"ONLY FILL EMPTY URLs - skip items that already have a URL."}

## HOW TO FIND GOOD PHOTOS:

 CRITICAL: For image searches, ALWAYS use the "searchName" field (genus + epithet only).
NEVER use author names in image searches (e.g., search "Andira fraxinifolia", NOT "Andira fraxinifolia Benth.").

${Fe}
1. **iNaturalist** - Search: https://www.inaturalist.org/taxa/search?q=[searchName]
   - Navigate to species page  Photos tab  Right-click image  Copy Image Address
   - Valid format: https://inaturalist-open-data.s3.amazonaws.com/photos/[id]/medium.jpg

2. **GBIF** - Search: https://www.gbif.org/species/search?q=[species_name]
   - Go to species page  Gallery  Click image  Copy direct URL
   
3. **Flickr Commons** - Scientific/botanical photos with open licenses
   - Valid format: https://live.staticflickr.com/[path].jpg

4. **Biodiversity Heritage Library** - For historical botanical illustrations
   - Valid format: https://www.biodiversitylibrary.org/pagethumb/[id]

5. **Wikimedia Commons** - ONLY use if you know the EXACT filename exists
   - Valid format: https://upload.wikimedia.org/wikipedia/commons/thumb/X/XX/Exact_Filename.jpg/400px-Exact_Filename.jpg

${n==="pt"?`
6. **Flora e Funga do Brasil** - Para espcies brasileiras
   - https://floradobrasil.jbrj.gov.br

7. **Species Link** - Rede de herbrios brasileiros
   - http://www.splink.org.br
`:""}

## CRITICAL RULES:
1.  URL MUST be a DIRECT image link ending in .jpg, .jpeg, .png, .gif, or .webp
2.  URL MUST work when opened directly in a browser (no login required)
3.  DO NOT use Google Images, Pinterest, or any search result pages
4.  DO NOT guess or make up URLs - only use URLs you are confident exist
5.  DO NOT use Wikimedia URLs unless you know the exact filename
6.  NEVER use placeholder, mockup, picsum, placehold.co, or any fake/generated images

## IF NO REAL PHOTO FOUND:
Leave the imageUrl as empty string "" - DO NOT use any placeholder or fake URLs.
It's better to have no image than a fake/mockup image.

## OUTPUT FORMAT:
Return a JSON array with the results:
\`\`\`json
{
  ${K?`"entities": [
    { "name": "Species Name", "imageUrl": "https://direct-image-url.jpg" }
  ]${ce?",":""}`:""}
  ${ce?`"features": [
    { "name": "Feature Name", "imageUrl": "https://direct-image-url.jpg" }
  ]`:""}
}
\`\`\`

Language: ${n==="pt"?"Portuguese":"English"}
Total items to process: ${(K&&((Q=Pe.entities)==null?void 0:Q.length)||0)+(ce&&((se=Pe.features)==null?void 0:se.length)||0)}
`}else if(ae==="EXPAND"){const K=[];C.expandFamily&&K.push(`FAMILY RESTRICTION: Only add species from family "${C.expandFamily}"`),C.expandGenus&&K.push(`GENUS RESTRICTION: Only add species from genus "${C.expandGenus}"`),C.expandBiome&&K.push(`BIOME RESTRICTION: Only add species that occur in "${C.expandBiome}" biome`),C.expandStateUF&&K.push(`STATE/UF RESTRICTION: Only add species that occur in "${C.expandStateUF}" state, Brazil`),C.expandScope==="national"?K.push("GEOGRAPHIC SCOPE: Only add species native to or occurring in Brazil"):C.expandScope==="regional"&&(C.expandBiome||C.expandStateUF)&&K.push("GEOGRAPHIC SCOPE: Strictly regional - species must occur in the specified biome/state");const ce=K.length>0?`
TAXONOMIC & GEOGRAPHIC FILTERS (MANDATORY):
${K.map((Ee,Fe)=>`${Fe+1}. ${Ee}`).join(`
`)}
`:"",pe=C.keepExisting,De=C.expandRequiredSpecies.split(`
`).map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),Pe=De.length>0?`
MANDATORY SPECIES TO ADD: ${De.join(", ")}`:"";Ge("expand"),V=`
EXPAND IDENTIFICATION KEY

FEATURES (use these IDs):
${JSON.stringify(_,null,2)}

EXISTING ENTITIES (${h.entities.length} - ${pe?"PRESERVE ALL":"may replace"}):
${JSON.stringify(N,null,2)}

TASK: Add ${C.expandCount} NEW entities.${Pe}
${ce}
RULES:
1. ${pe?"PRESERVE all existing entities with their IDs":"Replace existing entities"}
2. For NEW entities, generate new unique IDs
3. Return traitsMap as JSON string: {"featureId": ["stateId1", "stateId2"]}
4. Use ONLY existing feature and state IDs from the FEATURES list above
5. Language: ${n==="pt"?"Portuguese":"English"}

OUTPUT: Return JSON with "entities" array. Each entity needs: id, name, scientificName, family, description, traitsMap
`}else if(ae==="REFINE"){const K=C.refineRequiredFeatures.length>0?`
REQUIRED FEATURES (MANDATORY - must be added if not present):
${C.refineRequiredFeatures.map((Ee,Fe)=>`${Fe+1}. "${Ee}"`).join(`
`)}

For each required feature above:
- If it already exists in the key, ensure it has appropriate states and all entities are assigned.
- If it does NOT exist, ADD it as a new feature with relevant states and assign all entities accordingly.
`:"",ce=C.fillGaps&&!C.improveDescriptions&&!C.addFeatures&&C.refineRequiredFeatures.length===0,pe=Ee=>new Set(Ee.states.map(Fe=>Fe.id)),Pe={...h,entities:h.entities.map(Ee=>{const Fe={};for(const[be,Je]of Object.entries(Ee.traits)){const Ue=h.features.find(It=>It.id===be);if(Ue){const It=pe(Ue),Ye=Je.filter(ft=>It.has(ft));Ye.length>0&&(Fe[be]=Ye)}}return{...Ee,traits:Fe}})};if(ce){const Ee=[];if(Pe.entities.forEach(Fe=>{const be=[];Pe.features.forEach(Je=>{const Ue=Fe.traits[Je.id]||[],It=Je.states.map(ft=>ft.id);Ue.length>0&&Ue.some(ft=>It.includes(ft))||be.push(Je.id)}),be.length>0&&Ee.push({id:Fe.id,name:Fe.name,missingFeatureIds:be})}),Ee.length===0)Ge(null),V=`No missing trait data found. All ${Pe.entities.length} entities have assignments for all ${Pe.features.length} features.`;else{Ge("fillGaps");const Fe=Ee.length>20?`Entities with gaps: ${Ee.length} (see attached project data for full list)`:`ENTITIES NEEDING DATA:
${Ee.map(be=>`- ${be.id}: "${be.name}" needs: ${be.missingFeatureIds.map(Je=>{const Ue=Pe.features.find(It=>It.id===Je);return Ue?Ue.name:Je}).join(", ")}`).join(`
`)}`;V=`
FILL MISSING TRAITS

FEATURES (use these IDs for traits):
${JSON.stringify(_,null,2)}

${Fe}

TASK: For each entity with missing data, determine the correct trait values.

OUTPUT FORMAT (use fillGapsSchema):
Return "filledEntities" array with:
- entityId: the entity ID
- filledTraits: Array like [{"featureId": "fid", "stateIds": ["sid"]}] - ONLY the new traits being added

RULES:
1. Use ONLY the state IDs from FEATURES list above
2. Return ONLY entities that have gaps
3. Do NOT include existing traits - only NEW ones
4. Language: ${n==="pt"?"Portuguese":"English"}
`}}else{Ge("refine");let Ee="";y.category==="FAUNA"?Ee=C.featureType==="vegetative"?`
FEATURE TYPE RESTRICTION: Focus ONLY on MORPHOLOGICAL characters (body shape, size, color, appendages, skin/fur/feathers, etc.). Do NOT add behavioral characters.`:C.featureType==="reproductive"?`
FEATURE TYPE RESTRICTION: Focus ONLY on BEHAVIORAL characters (diet, activity, social, locomotion, vocalization, etc.). Do NOT add morphological characters.`:"":y.category==="OTHER"?Ee=C.featureType==="vegetative"?`
FEATURE TYPE RESTRICTION: Focus ONLY on VISUAL/PHYSICAL characters (color, shape, material, size, texture, etc.). Do NOT add conceptual characters.`:C.featureType==="reproductive"?`
FEATURE TYPE RESTRICTION: Focus ONLY on CONCEPTUAL characters (genre, theme, era, origin, creator, etc.). Do NOT add visual characters.`:"":Ee=C.featureType==="vegetative"?`
FEATURE TYPE RESTRICTION: Focus ONLY on VEGETATIVE characters (leaves, stems, bark, branching, stipules, etc.). Do NOT add reproductive characters (flowers, fruits, seeds).`:C.featureType==="reproductive"?`
FEATURE TYPE RESTRICTION: Focus ONLY on REPRODUCTIVE characters (flowers, inflorescences, fruits, seeds, pods, etc.). Do NOT add vegetative characters.`:"",V=`
REFINE IDENTIFICATION KEY

FEATURES (use these IDs):
${JSON.stringify(_,null,2)}

ENTITIES (${h.entities.length} - PRESERVE ALL):
${JSON.stringify(N,null,2)}

TASK: Improve this key.
${K}${Ee}
IMPROVEMENTS:
${C.improveDescriptions?"- Improve and lengthen descriptions for all entities":""}
${C.fillGaps?"- Fill ALL missing traits for existing features (currently some entities have gaps)":""}
${C.addFeatures?`- ADD EXACTLY ${C.refineFeatureCount} NEW DISCRIMINATING FEATURES. These features MUST effectively separate the species in the list. You MUST assign these new features to EVERY SINGLE one of the ${h.entities.length} entities.`:""}

CRITICAL RULES:
1. PRESERVE all ${h.entities.length} entity IDs from input. Do NOT omit any species.
2. For NEW features: provide a unique "id" (9 chars) and a "name", and at least 2 "states" (each with "id" and "label").
3. For EVERY entity in the "entities" array:
   - "traitsMap" MUST be a JSON string representing an object: {"featureId": ["stateId1", ...]}
   - The traitsMap MUST include assignments for BOTH existing features AND the new features you add.
   - NO GAPS: Ensure every feature has at least one state assigned for every entity.
4. Scientific Accuracy: Use real taxonomic data for the species provided.
5. Language: ${n==="pt"?"Portuguese (Brazil)":"English"}

OUTPUT FORMAT: 
Return a JSON object with:
- "features": [array of ONLY the ${C.addFeatures?C.refineFeatureCount:0} NEW features you created]
- "entities": [array of ALL ${h.entities.length} entities with updated description and traitsMap]
`}}else Ge("clean"),V=`
CLEAN IDENTIFICATION KEY

FEATURES:
${JSON.stringify(_,null,2)}

ENTITIES (${h.entities.length}):
${JSON.stringify(N.map(K=>({id:K.id,name:K.name})),null,2)}

TASK: Optimize this key.
${C.removeRedundant?"- Remove redundant features (all entities have same state)":""}
${C.fixInconsistencies?"- Fix trait inconsistencies":""}

RULES:
1. PRESERVE all ${h.entities.length} entity IDs
2. Return traitsMap as JSON string
3. Language: ${n==="pt"?"Portuguese":"English"}

OUTPUT: Return JSON with "entities" array with: id, name, traitsMap
`;return V},ZE=()=>{if(!Ve||!lt)return"";const _=JSON.stringify({name:Ve.name,description:Ve.description,features:Ve.features.map(z=>({name:z.name,states:z.states.map(Q=>Q.label)})),entities:Ve.entities.map(z=>({name:z.name,description:z.description,traits:Object.entries(z.traits).map(([Q,se])=>{const K=Ve.features.find(ce=>ce.id===Q);return se.map(ce=>{const pe=K==null?void 0:K.states.find(De=>De.id===ce);return{featureName:(K==null?void 0:K.name)||"",stateValue:(pe==null?void 0:pe.label)||""}})}).flat()}))},null,2),N=JSON.stringify({name:lt.name,description:lt.description,features:lt.features.map(z=>({name:z.name,states:z.states.map(Q=>Q.label)})),entities:lt.entities.map(z=>({name:z.name,description:z.description,traits:Object.entries(z.traits).map(([Q,se])=>{const K=lt.features.find(ce=>ce.id===Q);return se.map(ce=>{const pe=K==null?void 0:K.states.find(De=>De.id===ce);return{featureName:(K==null?void 0:K.name)||"",stateValue:(pe==null?void 0:pe.label)||""}})}).flat()}))},null,2);let V="";return Ke==="union"?V=`
MERGE STRATEGY: UNION (All-inclusive)
- Include ALL features from BOTH keys
- Include ALL entities from BOTH keys
- Merge similar features where possible, keeping all unique states
- For duplicate entities, combine traits from both sources`:Ke==="intersection"?V=`
MERGE STRATEGY: INTERSECTION (Common elements)
- Keep only features that are present in BOTH keys (or semantically equivalent)
- Include ALL entities from both keys, but focus on shared characteristics
- Prioritize traits that appear in both keys for duplicate entities`:V=`
MERGE STRATEGY: PRIMARY (Key 1 priority)
- Use KEY 1 as the primary structure base
- Add entities from KEY 2 that don't exist in KEY 1
- For duplicate entities, prefer KEY 1's trait assignments
- Add features from KEY 2 only if they add discrimination value`,`
You are an expert taxonomist specializing in identification key design and optimization.

TASK: Merge two identification keys into ONE comprehensive, optimized key.

KEY 1 (${Ve.entities.length} entities, ${Ve.features.length} features):
${_}

KEY 2 (${lt.entities.length} entities, ${lt.features.length} features):
${N}

${V}

CRITICAL REQUIREMENTS:
1. PRESERVE ALL ENTITIES from BOTH keys. The merged key must include every single species/entity.
2. Create a unified feature set that can describe ALL entities
3. Assign appropriate traits to every entity for every feature in the merged key
4. Merge semantically similar features (e.g., "Leaf Shape" and "Leaf Form")
5. Maintain language: ${n==="pt"?"Portuguese":"English"}

PROCESS:
1. First, identify all unique entities from both keys
2. Analyze features from both keys for similarities
3. Create unified feature set based on merge strategy
4. Map all entities to the new feature set
5. Ensure every entity has trait assignments for every feature

OUTPUT: Return a single merged JSON identification key with:
- Combined name and description
- Unified feature set
- ALL entities from both keys with complete trait mappings
`},Np=_=>{const N=document.createElement("input");N.type="file",N.accept=".json",N.onchange=async V=>{var Q;const z=(Q=V.target.files)==null?void 0:Q[0];if(z)try{const se=await z.text(),K=JSON.parse(se);if(!K.features||!K.entities){alert(n==="pt"?"JSON invlido. Deve conter features e entities.":"Invalid JSON. Must contain features and entities.");return}_===1?dt(K):rn(K)}catch{alert(n==="pt"?"Erro ao ler arquivo JSON.":"Error reading JSON file.")}},N.click()},eT=async()=>{if(!s){alert(l.missingKey);return}if(!Ve||!lt){alert(n==="pt"?"Carregue ambas as chaves JSON primeiro.":"Load both JSON keys first.");return}try{const _=ZE();fi(_),S(!1),Zt(!0)}catch(_){console.error(_),alert(n==="pt"?"Erro ao gerar prompt.":"Error generating prompt.")}},tT=async()=>{if(ae!=="PHOTOS"&&!s){alert(l.missingKey);return}if(h.entities.length===0){alert(n==="pt"?"Carregue um projeto primeiro.":"Load a project first.");return}if(ae==="VALIDATE"&&!C.validateFixNames&&!C.validateMergeSynonyms&&!C.validateCheckGeography&&!C.validateCheckTaxonomy){alert(n==="pt"?"Selecione pelo menos uma opo de validao.":"Select at least one validation option.");return}T(!0),b(""),S(!1),Zt(!0),it(""),Hr(!1);try{if(ae==="PHOTOS"){const N=C.photoTarget==="entities"||C.photoTarget==="both",V=C.photoTarget==="features"||C.photoTarget==="both",z=C.photoMode==="replace";let Q={...h};if(it(n==="pt"?` Iniciando busca de imagens...

 Fontes: Biodiversity4All, iNaturalist, Wikipedia, Wikimedia Commons, PlantNet, POWO (Kew)

`:` Starting image search...

 Sources: Biodiversity4All, iNaturalist, Wikipedia, Wikimedia Commons, PlantNet, POWO (Kew)

`),N){const De=h.entities.filter(Pe=>z||!Pe.imageUrl||Pe.imageUrl.includes("picsum.photos")||Pe.imageUrl.includes("placehold.co")).map(Pe=>({name:Pe.name,scientificName:Pe.name}));if(De.length>0){const Pe=await b0(De,n,(Ee,Fe,be)=>{const Je=n==="pt"?` Buscando imagens: ${Ee}/${Fe} - ${be}`:` Fetching images: ${Ee}/${Fe} - ${be}`;b(Je),it(Ue=>Ue+` ${be}...
`)},y.category);Q.entities=h.entities.map(Ee=>{const Fe=Pe.get(Ee.name);return Fe?{...Ee,imageUrl:Fe}:Ee})}}if(V){const De=n==="pt"?`
 Imagens de caractersticas no suportadas via API automtica
`:`
 Feature images not supported via automatic API
`;it(Pe=>Pe+De),await new Promise(Pe=>setTimeout(Pe,1500))}const K=N?Q.entities.filter(De=>De.imageUrl&&!De.imageUrl.includes("picsum.photos")).length:0,ce=N?h.entities.length:0,pe=n==="pt"?`

 BUSCA CONCLUDA!


 Resultado:
    Imagens encontradas: ${K}/${ce}

 Fotos atualizadas com sucesso!`:`

 SEARCH COMPLETE!


 Result:
    Images found: ${K}/${ce}

 Photos updated successfully!`;it(De=>De+pe),Hr(!0),await new Promise(De=>setTimeout(De,2e3)),x(Q),Zt(!1),v("ENTITIES");return}if(ae==="VALIDATE"){ff();const N=h.entities.map((K,ce)=>`${ce+1}. "${K.name}"${K.scientificName?` [Scientific: ${K.scientificName}]`:""} (ID: ${K.id})`).join(`
`),V=C.validateReference==="floradobrasil"?"Flora do Brasil 2020 (https://floradobrasil.jbrj.gov.br)":C.validateReference==="gbif"?"GBIF Backbone Taxonomy":C.validateReference==="powo"?"Plants of the World Online (POWO - Kew)":"current taxonomic literature",z=[],Q=[];if(C.validateFixNames&&z.push(`RULE 1 - NAME VALIDATION:
   - Check each scientific name against ${V}
   - If the name is a SYNONYM  replace with the ACCEPTED name
   - If the name is MISSPELLED  correct the spelling
   - If the name DOES NOT EXIST in any taxonomic database  REMOVE the entity entirely
   - Update the "scientificName" field with the correct binomial (Genus species Author)`),C.validateMergeSynonyms&&z.push(`RULE 2 - SYNONYM MERGING:
   - If TWO OR MORE entities in the list are synonyms of each other  KEEP ONLY ONE (the accepted name)
   - Merge their trait data: combine all trait values from both entities
   - Merge their descriptions: combine relevant information
   - Keep the best available imageUrl`),C.validateCheckTaxonomy&&(C.validateGenus&&(Q.push(`GENUS FILTER: The species MUST belong to genus "${C.validateGenus}"`),z.push(`RULE 3 - GENUS RESTRICTION (STRICT):
   - ONLY species of genus "${C.validateGenus}" are allowed
   - The first word of the scientific name MUST be exactly "${C.validateGenus}"
   - ANY species from a different genus MUST BE REMOVED - NO EXCEPTIONS
   - Example: If genus is "Andira", then "Bowdichia virgilioides" must be REMOVED because "Bowdichia"  "Andira"`)),C.validateFamily&&(Q.push(`FAMILY FILTER: The species MUST belong to family "${C.validateFamily}"`),z.push(`RULE 3B - FAMILY RESTRICTION (STRICT):
   - ONLY species of family "${C.validateFamily}" are allowed
   - Check the taxonomic classification of each species
   - ANY species from a different family MUST BE REMOVED - NO EXCEPTIONS`))),C.validateCheckGeography&&C.validateScope!=="global"){const K=[];C.validateScope==="national"&&K.push("Brazil (native or naturalized species only)"),C.validateBiome&&K.push(`Biome: ${C.validateBiome}`),C.validateStateUF&&K.push(`State: ${C.validateStateUF}, Brazil`);const ce=K.join(", ");Q.push(`GEOGRAPHIC FILTER: The species MUST occur in ${ce}`),z.push(`RULE 4 - GEOGRAPHIC RESTRICTION (STRICT):
   - ONLY species that NATURALLY OCCUR in ${ce} are allowed
   - Check the species distribution according to ${V}
   - Species that DO NOT OCCUR in this geographic area MUST BE REMOVED
   - Be strict: if uncertain about distribution, REMOVE the species`)}const se=`You are a strict taxonomic validation expert. Your task is to validate a species list and REMOVE any species that do not meet ALL criteria.


SPECIES LIST TO VALIDATE (${h.entities.length} total):

${N}


MANDATORY REMOVAL CRITERIA - Species MUST be REMOVED if they fail ANY:

${Q.length>0?Q.map((K,ce)=>`${ce+1}. ${K}`).join(`
`):"None specified"}


VALIDATION RULES (apply in order):

${z.join(`

`)}


REFERENCE: ${V}


CRITICAL INSTRUCTIONS:
1. BE STRICT - When in doubt, REMOVE the species
2. ${C.validateGenus?`GENUS CHECK: Every species MUST have "${C.validateGenus}" as the first word of its scientific name. Remove ALL others.`:""}
3. ${C.validateFamily?`FAMILY CHECK: Every species MUST belong to family "${C.validateFamily}". Remove ALL others.`:""}
4. DO NOT include species that fail ANY of the removal criteria
5. Preserve ALL existing data for species that pass validation (traits, description, links, imageUrl)
6. Return ONLY the entities that PASS ALL validation criteria`;fi(se),S(!1),Zt(!0),T(!1);return}const _=Cp();fi(_),S(!1),Zt(!0),T(!1);return}catch(_){console.error(_),aa(),it(N=>N+(n==="pt"?`

 ERRO: No foi possvel refinar a chave.`:`

 ERROR: Could not refine the key.`)),await new Promise(N=>setTimeout(N,2e3)),alert(l.errGen),Zt(!1)}finally{T(!1),b("")}},rT=async()=>{try{if(H==="REFINE"){if(h.entities.length===0){alert(n==="pt"?"Carregue um projeto primeiro.":"Load a project first.");return}const Q=Cp();fi(Q),Zt(!0),S(!1);return}let _={...y};if(H==="IMPORT"&&q){const Q=await kp(q);_.importedFile={data:Q,mimeType:q.type},_.topic=`Imported: ${q.name}`}else if(H==="TOPIC"){if(!_.topic.trim()){alert("Please enter a topic first.");return}_.importedFile=void 0}const{systemInstruction:N,prompt:V}=OE(_),z=`SYSTEM:
${N}

USER PROMPT:
${V}`;fi(z),Zt(!0),S(!1)}catch(_){console.error("Failed to build prompt",_)}},nT=async()=>{if(!s){alert(l.missingKey);return}T(!0),Zt(!0),ff();try{let _;if(ye&&h.entities.length>0){if(_=await D1(vs,h,s,y.model,n,ye),ye==="expand"){const V=new Set(h.entities.map(Q=>Q.name.toLowerCase())),z=_.entities.filter(Q=>!V.has(Q.name.toLowerCase()));if(z.length>0){const Q=n==="pt"?`

 Detectadas ${z.length} novas entidades. Buscando imagens automaticamente...`:`

 Detected ${z.length} new entities. Automatically fetching images...`;it(K=>K+Q);const se=z.map(K=>({name:K.name,scientificName:K.name}));try{const K=await b0(se,n,(De,Pe,Ee)=>{it(Fe=>Fe+`
 ${Ee}...`)},y.category);_.entities=_.entities.map(De=>{if(!V.has(De.name.toLowerCase())){const Pe=K.get(De.name);if(Pe)return{...De,imageUrl:Pe}}return De});const ce=Array.from(K.values()).filter(De=>De).length,pe=n==="pt"?`
 Imagens encontradas: ${ce}/${z.length}`:`
 Images found: ${ce}/${z.length}`;it(De=>De+pe)}catch(K){console.error("Error auto-fetching images:",K),it(ce=>ce+(n==="pt"?`
 Erro na busca de imagens.`:`
 Error fetching images.`))}}}const N=n==="pt"?`

 Operao concluda! ${_.entities.length} entidades processadas.`:`

 Operation complete! ${_.entities.length} entities processed.`;it(V=>V+N),Ge(null)}else if(ae==="VALIDATE"&&h.entities.length>0){_=await ZU(vs,h,s,y.model,n);const N=n==="pt"?`

 Validao concluda! ${_.entities.length} entidades mantidas.`:`

 Validation complete! ${_.entities.length} entities kept.`;it(V=>V+N)}else{const N=await QU(vs,s,y.model,n);if(!(N&&N.entities&&N.entities.length>0&&N.features&&N.features.length>0)){console.error("[handleSendManualPrompt] AI returned invalid/empty response:",N),aa();const z=n==="pt"?`

 ERRO: A IA retornou uma resposta vazia ou invlida. Os dados originais foram preservados. Tente novamente.`:`

 ERROR: AI returned empty or invalid response. Original data preserved. Please try again.`;it(Q=>Q+z),await new Promise(Q=>setTimeout(Q,3e3)),Zt(!1);return}if(h.entities.length>0){const z=h.entities.reduce((se,K)=>se+Object.values(K.traits).reduce((ce,pe)=>ce+pe.length,0),0),Q=N.entities.reduce((se,K)=>se+Object.values(K.traits).reduce((ce,pe)=>ce+pe.length,0),0);if(z>10&&Q<z*.3){console.warn(`[handleSendManualPrompt] WARNING: Significant trait loss detected! Existing: ${z}, New: ${Q}`);const se=n==="pt"?`

 AVISO: Detectada possvel perda de dados (${z}  ${Q} traits). Preservando dados originais.`:`

 WARNING: Possible data loss detected (${z}  ${Q} traits). Preserving original data.`;it(K=>K+se)}}if(_=h.entities.length>0?n7(N,h):N,_===h){const z=n==="pt"?`

 Dados originais foram preservados devido a resposta incompleta da IA.`:`

 Original data was preserved due to incomplete AI response.`;it(Q=>Q+z)}}aa(_),await new Promise(N=>setTimeout(N,2e3)),x(_),v("MATRIX"),Zt(!1)}catch(_){console.error(_),aa(),Ge(null);const N=(_==null?void 0:_.message)||String(_);let V;N.includes("503")||N.includes("overloaded")||N.includes("UNAVAILABLE")?V=n==="pt"?`

 ERRO: O servio de IA est sobrecarregado no momento. Por favor, aguarde alguns minutos e tente novamente.`:`

 ERROR: AI service is currently overloaded. Please wait a few minutes and try again.`:N.includes("429")||N.includes("quota")||N.includes("rate")?V=n==="pt"?`

 ERRO: Limite de requisies atingido. Por favor, aguarde um momento e tente novamente.`:`

 ERROR: Rate limit reached. Please wait a moment and try again.`:N.includes("401")||N.includes("API key")||N.includes("authentication")?V=n==="pt"?`

 ERRO: Chave de API invlida ou expirada. Por favor, verifique sua chave nas configuraes.`:`

 ERROR: Invalid or expired API key. Please check your key in settings.`:N.includes("network")||N.includes("fetch")||N.includes("connection")?V=n==="pt"?`

 ERRO: Falha na conexo. Verifique sua internet e tente novamente.`:`

 ERROR: Connection failed. Check your internet and try again.`:V=n==="pt"?`

 ERRO: No foi possvel gerar a chave. Por favor, tente novamente.`:`

 ERROR: Could not generate the key. Please try again.`,it(z=>z+V),await new Promise(z=>setTimeout(z,3e3))}finally{T(!1)}},Ap=()=>{wr.current&&(clearInterval(wr.current),wr.current=null),T(!1),b(""),it(""),Hr(!1),Zt(!1),O(null),G(null),S(!0)},iT=()=>{const _={id:Math.random().toString(36).substr(2,9),name:n==="pt"?"Nova Caracterstica":"New Feature",imageUrl:"",states:[{id:Math.random().toString(36).substr(2,9),label:n==="pt"?"Estado 1":"State 1"}]};x(N=>({...N,features:[_,...N.features]}))},sT=()=>{const _={id:Math.random().toString(36).substr(2,9),name:n==="pt"?"Nova Entidade":"New Entity",description:"...",links:[],traits:{}};x(N=>({...N,entities:[_,...N.entities]}))},bp=(_,N,V)=>{x(z=>{const Q=z.entities.map(se=>{if(se.id!==_)return se;const K=se.traits[N]||[],ce=K.includes(V);let pe;return ce?pe=K.filter(De=>De!==V):pe=[...K,V],{...se,traits:{...se.traits,[N]:pe}}});return{...z,entities:Q}})},aT=_=>_===1?l.detailSimple:_===3?l.detailExpert:H==="IMPORT"?l.detailOriginal:l.detailBalanced;return f.jsxs("div",{className:"flex flex-col h-full bg-white font-sans absolute inset-0",children:[f.jsxs("div",{className:"border-b px-4 py-3 flex justify-between items-center bg-slate-900 text-white shadow-md z-30 shrink-0",children:[f.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[f.jsx("button",{onClick:()=>Z(!de),className:"md:hidden text-slate-300 hover:text-white",children:f.jsx(XS,{size:24})}),f.jsxs("h2",{className:"text-base md:text-xl font-bold flex items-center gap-2 truncate",children:[f.jsx("span",{className:"bg-emerald-500 text-[10px] md:text-xs text-white px-2 py-1 rounded uppercase tracking-wider shadow-sm hidden sm:inline-block",children:l.builder}),f.jsx("span",{className:"truncate max-w-[150px] md:max-w-[300px]",children:h.name})]}),f.jsx("div",{className:"h-6 w-px bg-slate-700 mx-2 hidden md:block"}),f.jsxs("div",{className:"hidden md:flex items-center gap-1 text-sm",children:[f.jsxs("button",{onClick:Et,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:l.save,children:[f.jsx(pu,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.save})]}),f.jsxs("button",{onClick:()=>J(!0),className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:l.open,children:[f.jsx(Ma,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.open})]}),f.jsxs("button",{onClick:Di,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:l.export,children:[f.jsx(r0,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.export})]}),f.jsxs("button",{onClick:Li,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:l.exportXLSX,children:[f.jsx(n0,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.exportXLSX})]}),f.jsxs("button",{onClick:Oi,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:l.exportHTML,children:[f.jsx(Wo,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.exportHTML})]}),f.jsxs("label",{className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white cursor-pointer",title:l.import,children:[f.jsx($i,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.import}),f.jsx("input",{type:"file",accept:".json,.xlsx,.xls,.csv",onChange:_p,className:"hidden"})]})]})]}),f.jsxs("div",{className:"flex gap-2 md:gap-3",children:[f.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-2 px-3 py-1.5 md:px-4 md:py-2 bg-gradient-to-r from-amber-500 to-yellow-500 hover:from-amber-400 hover:to-yellow-400 text-white rounded-lg transition-all shadow-lg shadow-amber-900/30 text-xs md:text-sm font-bold border border-amber-400/20 group",children:[f.jsx(As,{size:16,className:"text-white fill-white/20 group-hover:scale-110 transition-transform"})," ",f.jsx("span",{className:"hidden sm:inline",children:l.aiWizard}),f.jsx("span",{className:"sm:hidden",children:"IA"})]}),f.jsxs("button",{onClick:()=>t(h),className:"flex items-center gap-2 px-3 py-1.5 md:px-5 md:py-2 bg-emerald-600 hover:bg-emerald-500 rounded-lg transition-all text-xs md:text-sm font-semibold shadow-lg shadow-emerald-900/30 text-white",children:[f.jsx(o0,{size:16})," ",f.jsx("span",{className:"hidden sm:inline",children:l.savePlay})]}),f.jsxs("button",{onClick:r,className:"px-2 py-1.5 md:px-4 md:py-2 text-slate-400 hover:text-white transition-colors text-xs md:text-sm font-medium",children:[f.jsx(er,{size:20,className:"md:hidden"})," ",f.jsx("span",{className:"hidden md:inline",children:l.exit})]})]})]}),de&&f.jsxs("div",{className:"md:hidden bg-slate-800 text-slate-200 border-b border-slate-700 p-2 grid grid-cols-5 gap-2 text-xs font-medium z-20",children:[f.jsxs("button",{onClick:()=>{Et(),Z(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[f.jsx(pu,{size:18})," ",l.save]}),f.jsxs("button",{onClick:()=>{J(!0),Z(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[f.jsx(Ma,{size:18})," ",l.open]}),f.jsxs("button",{onClick:()=>{Di(),Z(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[f.jsx(r0,{size:18})," JSON"]}),f.jsxs("button",{onClick:()=>{Li(),Z(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[f.jsx(n0,{size:18})," XLSX"]}),f.jsxs("button",{onClick:()=>{Oi(),Z(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[f.jsx(Wo,{size:18})," HTML"]}),f.jsxs("label",{className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded cursor-pointer col-span-5",children:[f.jsx($i,{size:18})," ",l.import,f.jsx("input",{type:"file",accept:".json,.xlsx,.xls,.csv",onChange:_p,className:"hidden"})]})]}),f.jsx("div",{className:"flex border-b bg-white overflow-x-auto whitespace-nowrap shrink-0",children:[{id:"GENERAL",label:l.general,icon:BS},{id:"FEATURES",label:l.features,icon:KS},{id:"ENTITIES",label:l.entities,icon:Xy},{id:"MATRIX",label:l.matrix,icon:Vf}].map(_=>f.jsxs("button",{onClick:()=>v(_.id),className:`flex items-center gap-2 px-4 py-3 md:py-4 text-xs md:text-sm font-medium transition-all border-b-2 relative top-[2px] min-w-fit ${g===_.id?"border-emerald-600 text-emerald-600 bg-emerald-50/50 rounded-t-lg":"border-transparent text-slate-500 hover:text-slate-800 hover:bg-slate-50/50"}`,children:[f.jsx(_.icon,{size:16})," ",_.label]},_.id))}),f.jsx("div",{className:"flex-1 overflow-auto bg-slate-50 p-4 md:p-6 pb-20 md:pb-6",children:f.jsxs("div",{className:`mx-auto bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden ${g==="MATRIX"?"max-w-none":"max-w-6xl"}`,children:[g==="GENERAL"&&f.jsx("div",{className:"p-6 md:p-8 space-y-8 max-w-2xl",children:f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 border-b pb-2",children:l.general}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1",children:l.projectName}),f.jsx("input",{value:h.name,onChange:_=>Me({name:_.target.value}),className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all font-medium text-slate-800"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1",children:l.description}),f.jsx("textarea",{value:h.description,onChange:_=>Me({description:_.target.value}),className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all h-32 text-slate-700"})]})]})]})}),g==="FEATURES"&&f.jsxs("div",{className:"p-4 md:p-8",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:l.definedFeatures}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 text-xs font-bold rounded-full",children:[h.features.length," ",n==="pt"?"car.":"feat."]}),f.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-xs font-bold rounded-full",children:[h.features.reduce((_,N)=>_+N.states.length,0)," ",n==="pt"?"estados":"states"]})]})]}),f.jsx("p",{className:"text-xs md:text-sm text-slate-500",children:l.definedFeaturesDesc})]}),f.jsxs("button",{onClick:iT,className:"flex items-center gap-2 text-sm bg-slate-900 text-white px-4 py-2 rounded-lg hover:bg-slate-700 shadow-md transition-all",children:[f.jsx(ko,{size:16})," ",f.jsx("span",{className:"hidden sm:inline",children:l.addFeature})]})]}),f.jsx("div",{className:"grid gap-6 md:grid-cols-2 xl:grid-cols-3",children:h.features.map((_,N)=>f.jsxs("div",{className:"border border-slate-200 rounded-xl p-5 bg-white relative group hover:border-emerald-300 hover:shadow-md transition-all",children:[f.jsx("button",{className:"absolute top-3 right-3 text-slate-300 hover:text-red-500 md:opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-red-50 rounded",onClick:()=>{const V=h.features.filter(z=>z.id!==_.id);x(z=>({...z,features:V}))},children:f.jsx(_s,{size:16})}),f.jsxs("div",{className:"mb-4 space-y-2",children:[f.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:l.featureName}),f.jsx("input",{value:_.name,onChange:V=>{const z=[...h.features];z[N].name=V.target.value,x(Q=>({...Q,features:z}))},className:"font-bold text-lg text-slate-800 bg-transparent border-b border-transparent hover:border-slate-300 focus:border-emerald-500 outline-none w-full pb-1"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(ka,{size:14,className:"text-slate-400"}),f.jsx("input",{value:_.imageUrl||"",onChange:V=>{const z=[...h.features];z[N].imageUrl=V.target.value,x(Q=>({...Q,features:z}))},className:"text-xs flex-1 bg-slate-50 border border-slate-200 rounded px-2 py-1 outline-none focus:border-emerald-400",placeholder:l.imageURL})]})]}),f.jsxs("div",{className:"space-y-2 pl-3 border-l-2 border-slate-100",children:[f.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider block mb-1",children:l.states}),_.states.map((V,z)=>{const Q=(L==null?void 0:L.featureId)===_.id&&(L==null?void 0:L.stateId)===V.id;return f.jsxs("div",{className:"group/state",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[V.imageUrl?f.jsx("button",{onClick:()=>he({url:V.imageUrl,label:V.label,featureName:_.name}),className:"w-6 h-6 rounded overflow-hidden border border-slate-200 hover:border-emerald-400 transition-colors shrink-0",title:l.viewImage,children:f.jsx("img",{src:V.imageUrl,alt:V.label,className:"w-full h-full object-cover"})}):f.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-300 group-focus-within/state:bg-emerald-400 shrink-0"}),f.jsx("input",{value:V.label,onChange:se=>{const K=[...h.features];K[N].states[z].label=se.target.value,x(ce=>({...ce,features:K}))},className:"text-sm bg-transparent outline-none flex-1 text-slate-600 focus:text-slate-900 focus:font-medium"}),!Q&&f.jsx("button",{onClick:()=>P({featureId:_.id,stateId:V.id}),className:`${V.imageUrl?"text-emerald-500":"text-slate-300 hover:text-slate-500"} md:opacity-0 group-hover/state:opacity-100 transition-opacity`,title:V.imageUrl?l.stateImage:l.addStateImage,children:f.jsx(ka,{size:12})}),f.jsx("button",{onClick:()=>{const se=[...h.features];se[N].states=se[N].states.filter(K=>K.id!==V.id),x(K=>({...K,features:se}))},className:"text-slate-300 hover:text-red-400 md:opacity-0 group-hover/state:opacity-100 transition-opacity",children:f.jsx(er,{size:12})})]}),Q&&f.jsxs("div",{className:"ml-8 mt-1 flex items-center gap-2",children:[f.jsx("input",{value:V.imageUrl||"",onChange:se=>{const K=[...h.features];K[N].states[z].imageUrl=se.target.value||void 0,x(ce=>({...ce,features:K}))},onBlur:()=>P(null),className:"text-[10px] w-full text-slate-400 bg-slate-50 rounded px-2 py-0.5 outline-none focus:bg-white focus:text-slate-600 border border-transparent focus:border-slate-200",placeholder:"URL...",autoFocus:!0}),f.jsx("button",{onClick:()=>{const se=[...h.features];se[N].states[z].imageUrl=void 0,x(K=>({...K,features:se})),P(null)},className:"text-slate-400 hover:text-red-400",title:l.clearImage,children:f.jsx(_s,{size:12})}),f.jsx("button",{onClick:()=>P(null),className:"text-slate-400 hover:text-slate-500",title:l.closeImage,children:f.jsx(er,{size:12})})]}),!Q&&V.imageUrl&&f.jsx("div",{className:"ml-8 mt-1",children:f.jsx("span",{className:"text-[10px] w-full text-slate-400 truncate block",children:V.imageUrl})})]},V.id)}),f.jsxs("button",{onClick:()=>{const V=[...h.features];V[N].states.push({id:Math.random().toString(36).substr(2,9),label:"..."}),x(z=>({...z,features:V}))},className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium mt-3 flex items-center gap-1 bg-emerald-50 w-fit px-2 py-1 rounded",children:[f.jsx(ko,{size:10})," ",l.addState]})]})]},_.id))})]}),g==="ENTITIES"&&f.jsxs("div",{className:"p-4 md:p-8",children:[f.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:l.manageEntities}),f.jsx("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 text-xs font-bold rounded-full",children:Se?`${Ae.length} ${l.ofEntities} ${h.entities.length}`:`${h.entities.length} ${n==="pt"?"entidades":"entities"}`})]}),f.jsx("p",{className:"text-xs md:text-sm text-slate-500",children:l.manageEntitiesDesc})]}),f.jsxs("button",{onClick:sT,className:"flex items-center gap-2 text-sm bg-slate-900 text-white px-4 py-2 rounded-lg hover:bg-slate-700 shadow-md transition-all",children:[f.jsx(ko,{size:16})," ",f.jsx("span",{className:"hidden sm:inline",children:l.addEntity})]})]}),f.jsx("div",{className:"mb-6 p-4 bg-slate-50 rounded-xl border border-slate-200",children:f.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[f.jsx("div",{className:"flex-1 min-w-[200px]",children:f.jsxs("div",{className:"relative",children:[f.jsx(Km,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),f.jsx("input",{type:"text",value:nt.searchText,onChange:_=>ht(N=>({...N,searchText:_.target.value})),placeholder:l.searchPlaceholder,className:"w-full pl-9 pr-3 py-2 text-sm border border-slate-200 rounded-lg focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 outline-none"})]})}),ie.length>0&&f.jsxs("select",{value:nt.family,onChange:_=>ht(N=>({...N,family:_.target.value})),className:"px-3 py-2 text-sm border border-slate-200 rounded-lg bg-white focus:border-emerald-500 outline-none min-w-[150px]",children:[f.jsx("option",{value:"",children:l.allFamilies}),ie.map(_=>f.jsx("option",{value:_,children:_},_))]}),we.length>0&&f.jsxs("select",{value:nt.genus,onChange:_=>ht(N=>({...N,genus:_.target.value})),className:"px-3 py-2 text-sm border border-slate-200 rounded-lg bg-white focus:border-emerald-500 outline-none min-w-[150px]",children:[f.jsx("option",{value:"",children:l.allGenera}),we.map(_=>f.jsx("option",{value:_,children:_},_))]}),h.features.length>0&&f.jsxs("label",{className:`flex items-center gap-2 px-3 py-2 text-sm border rounded-lg cursor-pointer transition-colors ${nt.onlyWithGaps?"bg-amber-50 border-amber-300 text-amber-700":"bg-white border-slate-200 text-slate-600 hover:bg-slate-50"}`,title:l.onlyWithGapsDesc,children:[f.jsx("input",{type:"checkbox",checked:nt.onlyWithGaps,onChange:_=>ht(N=>({...N,onlyWithGaps:_.target.checked})),className:"w-4 h-4 text-amber-500 border-slate-300 rounded focus:ring-amber-500"}),f.jsx("span",{className:"whitespace-nowrap",children:l.onlyWithGaps})]}),Se&&f.jsxs("button",{onClick:Oe,className:"flex items-center gap-1 px-3 py-2 text-sm text-slate-600 hover:text-slate-800 hover:bg-slate-200 rounded-lg transition-colors",children:[f.jsx(er,{size:14}),l.clearFilters]})]})}),f.jsx("div",{className:"space-y-4",children:Ae.map(_=>{const N=h.entities.findIndex(V=>V.id===_.id);return f.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 items-start border border-slate-200 p-4 md:p-6 rounded-xl bg-white hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"w-full sm:w-48 space-y-2 flex-shrink-0",children:[f.jsx("div",{className:"aspect-[4/3] bg-slate-100 rounded-lg overflow-hidden border border-slate-200",children:_.imageUrl?f.jsx("img",{src:_.imageUrl,className:"w-full h-full object-cover",alt:"preview"}):f.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-300",children:f.jsx(ka,{size:32})})}),f.jsx("input",{value:_.imageUrl||"",onChange:V=>{const z=[...h.entities];z[N].imageUrl=V.target.value,x(Q=>({...Q,entities:z}))},className:"text-xs w-full px-2 py-1.5 bg-slate-50 border border-slate-200 rounded outline-none focus:border-emerald-500 text-slate-600",placeholder:l.imageURL}),f.jsxs("button",{onClick:()=>A(_.id),className:"w-full flex items-center justify-center gap-2 text-xs bg-slate-100 hover:bg-slate-200 text-slate-700 py-3 md:py-2 rounded-lg font-medium transition-colors border border-slate-200",children:[f.jsx(mc,{size:12})," ",l.editTraits]})]}),f.jsxs("div",{className:"flex-1 space-y-4 w-full",children:[f.jsxs("div",{className:"flex justify-between items-start gap-2",children:[f.jsx("input",{value:_.name,onChange:V=>{const z=[...h.entities];z[N].name=V.target.value,x(Q=>({...Q,entities:z}))},className:"text-xl font-bold bg-transparent border-b border-transparent hover:border-slate-300 focus:border-emerald-500 outline-none w-full pb-1 text-slate-800"}),f.jsx("button",{onClick:()=>{const V=h.entities.filter(z=>z.id!==_.id);x(z=>({...z,entities:V}))},className:"text-slate-300 hover:text-red-500 p-2 hover:bg-red-50 rounded transition-colors",children:f.jsx(_s,{size:18})})]}),f.jsxs("div",{className:"flex gap-3 flex-wrap md:flex-nowrap",children:[f.jsxs("div",{className:"flex-1 min-w-[140px]",children:[f.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:n==="pt"?"Nome Cientfico":"Scientific Name"}),f.jsx("input",{value:_.scientificName||"",onChange:V=>{const z=[...h.entities];z[N].scientificName=V.target.value,x(Q=>({...Q,entities:z}))},placeholder:n==="pt"?"Ex: Panthera leo":"e.g., Panthera leo",className:"text-sm italic text-slate-600 bg-slate-50 border border-slate-200 focus:bg-white focus:border-emerald-500 w-full outline-none rounded-lg px-3 py-2 transition-colors"})]}),f.jsxs("div",{className:"flex-1 min-w-[120px]",children:[f.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:n==="pt"?"Famlia":"Family"}),f.jsx("input",{value:_.family||"",onChange:V=>{const z=[...h.entities];z[N].family=V.target.value,x(Q=>({...Q,entities:z}))},placeholder:n==="pt"?"Ex: Felidae":"e.g., Felidae",className:"text-sm text-slate-600 bg-slate-50 border border-slate-200 focus:bg-white focus:border-emerald-500 w-full outline-none rounded-lg px-3 py-2 transition-colors"})]})]}),f.jsx("textarea",{value:_.description,onChange:V=>{const z=[...h.entities];z[N].description=V.target.value,x(Q=>({...Q,entities:z}))},className:"text-sm text-slate-600 bg-slate-50 border border-transparent focus:bg-white focus:border-emerald-500 w-full h-24 outline-none resize-none rounded-lg p-3 transition-colors"}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100",children:[f.jsxs("h5",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 flex items-center gap-2",children:[f.jsx(a0,{size:12})," ",l.links]}),f.jsxs("div",{className:"space-y-2",children:[(_.links||[]).map((V,z)=>f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{placeholder:"Label",value:V.label,onChange:Q=>{const se=[...h.entities];se[N].links||(se[N].links=[]),se[N].links[z].label=Q.target.value,x(K=>({...K,entities:se}))},className:"text-xs flex-1 px-2 py-1 border border-slate-200 rounded outline-none focus:border-emerald-400"}),f.jsx("input",{placeholder:"URL",value:V.url,onChange:Q=>{const se=[...h.entities];se[N].links||(se[N].links=[]),se[N].links[z].url=Q.target.value,x(K=>({...K,entities:se}))},className:"text-xs flex-[2] px-2 py-1 border border-slate-200 rounded outline-none focus:border-emerald-400"}),f.jsx("button",{onClick:()=>{const Q=[...h.entities];Q[N].links||(Q[N].links=[]),Q[N].links=Q[N].links.filter((se,K)=>K!==z),x(se=>({...se,entities:Q}))},className:"text-slate-400 hover:text-red-500",children:f.jsx(er,{size:14})})]},V.id||z)),f.jsxs("button",{onClick:()=>{const V=[...h.entities];V[N].links||(V[N].links=[]),V[N].links.push({id:Math.random().toString(36).substr(2,9),label:"",url:""}),x(z=>({...z,entities:V}))},className:"text-xs flex items-center gap-1 text-emerald-600 hover:text-emerald-700 font-medium",children:[f.jsx(ko,{size:12})," ",l.addLink]})]})]})]})]},_.id)})})]}),g==="MATRIX"&&f.jsxs("div",{className:"flex flex-col h-full bg-slate-50 min-h-[500px]",children:[f.jsxs("div",{className:"p-4 border-b bg-white",children:[f.jsxs("div",{className:"flex justify-between items-center mb-3",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("h3",{className:"font-semibold text-slate-700",children:l.scoringMatrix}),Se&&f.jsxs("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 text-xs font-bold rounded-full",children:[Ae.length," ",l.ofEntities," ",h.entities.length]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-xs text-slate-400 hidden sm:inline",children:l.scoringMatrixDesc}),h.features.length>1&&f.jsxs("div",{className:"flex gap-1 border-l pl-2 ml-2",children:[f.jsx("button",{onClick:()=>ne("prev"),className:"p-1.5 hover:bg-slate-100 rounded transition-colors text-slate-600",title:"Caracterstica Anterior",children:f.jsx(GS,{size:16})}),f.jsx("button",{onClick:()=>ne("next"),className:"p-1.5 hover:bg-slate-100 rounded transition-colors text-slate-600",title:"Prxima Caracterstica",children:f.jsx(VS,{size:16})})]})]})]}),f.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3 pb-3 border-b border-slate-100",children:[f.jsxs("div",{className:"relative flex-1 min-w-[150px] max-w-[250px]",children:[f.jsx(Km,{size:14,className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-slate-400"}),f.jsx("input",{type:"text",value:nt.searchText,onChange:_=>ht(N=>({...N,searchText:_.target.value})),placeholder:l.searchPlaceholder,className:"w-full pl-8 pr-2 py-1.5 text-xs border border-slate-200 rounded-lg focus:border-emerald-500 outline-none"})]}),ie.length>0&&f.jsxs("select",{value:nt.family,onChange:_=>ht(N=>({...N,family:_.target.value})),className:"px-2 py-1.5 text-xs border border-slate-200 rounded-lg bg-white focus:border-emerald-500 outline-none",children:[f.jsx("option",{value:"",children:l.allFamilies}),ie.map(_=>f.jsx("option",{value:_,children:_},_))]}),we.length>0&&f.jsxs("select",{value:nt.genus,onChange:_=>ht(N=>({...N,genus:_.target.value})),className:"px-2 py-1.5 text-xs border border-slate-200 rounded-lg bg-white focus:border-emerald-500 outline-none",children:[f.jsx("option",{value:"",children:l.allGenera}),we.map(_=>f.jsx("option",{value:_,children:_},_))]}),h.features.length>0&&f.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 text-xs border rounded-lg cursor-pointer transition-colors ${nt.onlyWithGaps?"bg-amber-50 border-amber-300 text-amber-700":"bg-white border-slate-200 text-slate-500 hover:bg-slate-50"}`,title:l.onlyWithGapsDesc,children:[f.jsx("input",{type:"checkbox",checked:nt.onlyWithGaps,onChange:_=>ht(N=>({...N,onlyWithGaps:_.target.checked})),className:"w-3.5 h-3.5 text-amber-500 border-slate-300 rounded focus:ring-amber-500"}),f.jsx("span",{className:"whitespace-nowrap",children:l.onlyWithGaps})]}),Se&&f.jsxs("button",{onClick:Oe,className:"flex items-center gap-1 px-2 py-1.5 text-xs text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:[f.jsx(er,{size:12}),l.clearFilters]})]}),f.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 custom-scrollbar",children:h.features.map((_,N)=>f.jsx("button",{onClick:()=>ee(_.id),className:`shrink-0 px-3 py-1.5 rounded-full text-xs font-medium transition-all ${M===_.id?"bg-emerald-600 text-white shadow-md":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:_.name},_.id))})]}),f.jsx("div",{className:"flex-1 overflow-hidden bg-gradient-to-br from-slate-100 to-slate-200 relative",children:f.jsx("div",{ref:j,className:"absolute inset-0 overflow-auto custom-scrollbar",children:f.jsxs("table",{className:"border-collapse w-max",children:[f.jsxs("thead",{className:"sticky top-0 z-40",children:[f.jsxs("tr",{className:"bg-gradient-to-r from-slate-800 to-slate-900",children:[f.jsx("th",{rowSpan:2,className:"sticky left-0 z-50 bg-gradient-to-br from-slate-800 to-slate-900 text-white px-3 py-2 font-bold border-r border-b border-slate-600 text-left align-bottom",style:{minWidth:"180px",maxWidth:"180px"},children:f.jsx("span",{className:"text-xs font-semibold tracking-wide",children:l.taxaFeatures})}),h.features.map(_=>{const N=M===_.id,V=N?_.states.length:1;return f.jsx("th",{colSpan:V,className:`px-1 py-1.5 font-semibold border-r border-b text-center align-middle cursor-pointer transition-all duration-200 ${N?"bg-gradient-to-br from-emerald-500 to-emerald-700 border-emerald-400 text-white shadow-lg":"bg-gradient-to-b from-slate-600 to-slate-700 border-slate-500 text-slate-100 hover:from-slate-500 hover:to-slate-600"}`,style:{minWidth:N?`${V*80}px`:"60px"},onClick:()=>ee(_.id),title:_.name,children:f.jsxs("div",{className:"flex items-center justify-center gap-1",children:[N&&f.jsx("button",{onClick:z=>{z.stopPropagation(),U(null)},className:"p-0.5 hover:bg-emerald-400/50 rounded transition-colors flex-shrink-0",children:f.jsx(er,{size:12})}),f.jsx("span",{className:`font-semibold leading-tight ${N?"text-[10px]":"text-[9px]"}`,children:_.name})]})},`header-${_.id}`)})]}),f.jsx("tr",{children:h.features.map(_=>M===_.id?_.states.map(V=>f.jsx("th",{className:"bg-gradient-to-b from-emerald-600 to-emerald-700 text-white px-1 py-1.5 border-r border-b border-emerald-500 text-center align-top",style:{minWidth:"80px",maxWidth:"100px"},title:V.label,children:f.jsx("div",{className:"text-[8px] font-medium leading-snug px-0.5 break-words",style:{wordBreak:"break-word",hyphens:"auto"},children:V.label})},`state-${V.id}`)):f.jsx("th",{className:"bg-gradient-to-b from-slate-500 to-slate-600 text-slate-200 px-1 py-1.5 border-r border-b border-slate-400 text-center cursor-pointer hover:from-slate-400 hover:to-slate-500 transition-all",style:{minWidth:"60px",maxWidth:"60px"},onClick:()=>ee(_.id),children:f.jsxs("div",{className:"flex flex-col items-center gap-0",children:[f.jsx("span",{className:"text-[8px] opacity-80",children:"expandir"}),f.jsxs("span",{className:"text-[10px] font-bold",children:["(",_.states.length,")"]})]})},`expand-${_.id}`))})]}),f.jsx("tbody",{children:Ae.map((_,N)=>f.jsxs("tr",{className:N%2===0?"bg-white":"bg-slate-50/80",children:[f.jsx("td",{className:`sticky left-0 z-20 px-2 py-1.5 border-r-2 border-b border-slate-200 ${N%2===0?"bg-white":"bg-slate-50"}`,style:{minWidth:"180px",maxWidth:"180px",boxShadow:"2px 0 6px rgba(0,0,0,0.08)"},children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-6 h-6 rounded bg-slate-200 overflow-hidden flex-shrink-0",children:_.imageUrl&&f.jsx("img",{src:_.imageUrl,className:"w-full h-full object-cover",alt:""})}),f.jsx("span",{className:"text-[11px] font-medium text-slate-700 line-clamp-2 leading-tight",title:_.name,children:_.name})]})}),h.features.map(V=>{const z=M===V.id,Q=_.traits[V.id]||[],se=Q.length;return z?V.states.map(K=>{const ce=Q.includes(K.id);return f.jsx("td",{className:`border-b border-r border-slate-200 text-center hover:bg-emerald-50 transition-colors p-1 ${N%2===0?"bg-white":"bg-slate-50/80"}`,style:{minWidth:"80px",maxWidth:"100px"},children:f.jsx("button",{onClick:()=>bp(_.id,V.id,K.id),className:`w-7 h-7 rounded-md flex items-center justify-center transition-all mx-auto ${ce?"bg-gradient-to-br from-emerald-400 to-emerald-600 text-white shadow-sm":"bg-slate-100 text-slate-300 hover:bg-slate-200"}`,children:ce&&f.jsx(Vf,{size:14,strokeWidth:2.5})})},`${_.id}-${K.id}`)}):f.jsx("td",{className:`border-b border-r border-slate-200 text-center cursor-pointer hover:bg-slate-100 transition-colors p-1 ${N%2===0?"bg-white":"bg-slate-50/80"}`,style:{minWidth:"60px",maxWidth:"60px"},onClick:()=>ee(V.id),title:`${se} de ${V.states.length}`,children:f.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-bold mx-auto ${se>0?"bg-gradient-to-br from-emerald-100 to-emerald-200 text-emerald-700":"bg-slate-100 text-slate-400"}`,children:se})},`${_.id}-${V.id}-collapsed`)})]},_.id))})]})})})]})]})}),ia&&f.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col max-h-[90vh] animate-in fade-in zoom-in-95 overflow-hidden",children:[f.jsxs("div",{className:"bg-slate-50 p-4 border-b flex justify-between items-center",children:[f.jsxs("h3",{className:"font-bold text-slate-800 text-lg flex items-center gap-2 truncate",children:[f.jsx(mc,{size:18,className:"text-emerald-600"}),f.jsxs("span",{className:"truncate",children:[l.traitEditor,": ",f.jsx("span",{className:"text-emerald-600",children:(Ip=h.entities.find(_=>_.id===ia))==null?void 0:Ip.name})]})]}),f.jsx("button",{onClick:()=>A(null),className:"text-slate-400 hover:text-slate-600 p-1",children:f.jsx(er,{size:20})})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 space-y-6 custom-scrollbar",children:[h.features.map(_=>f.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4",children:[f.jsxs("h4",{className:"font-bold text-slate-700 mb-3 flex items-center gap-2",children:[_.name,_.imageUrl&&f.jsx("a",{href:_.imageUrl,target:"_blank",rel:"noopener noreferrer",className:"text-slate-400 hover:text-emerald-500",children:f.jsx(Sa,{size:12})})]}),f.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:_.states.map(N=>{var z,Q;const V=(Q=(z=h.entities.find(se=>se.id===ia))==null?void 0:z.traits[_.id])==null?void 0:Q.includes(N.id);return f.jsxs("button",{onClick:()=>bp(ia,_.id,N.id),className:`text-sm px-3 py-3 md:py-2 rounded-lg border text-left flex items-center justify-between transition-all touch-manipulation active:scale-[0.98] ${V?"bg-emerald-600 text-white border-emerald-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-emerald-300 hover:text-emerald-600"}`,children:[f.jsx("span",{className:"truncate mr-2 text-xs md:text-sm",children:N.label}),V&&f.jsx(Vf,{size:14})]},N.id)})})]},_.id)),h.features.length===0&&f.jsx("div",{className:"text-center text-slate-400 py-10",children:"Nenhuma caracterstica definida no projeto."})]}),f.jsx("div",{className:"p-4 border-t bg-slate-50 shrink-0",children:f.jsx("button",{onClick:()=>A(null),className:"w-full py-3 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-500 shadow-lg shadow-emerald-900/10",children:l.close})})]})}),I&&f.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:B==="CATEGORY"?f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full overflow-hidden animate-in fade-in zoom-in-95 duration-200 border border-slate-200 p-8 flex flex-col items-center relative",children:[f.jsx("button",{onClick:()=>S(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600 p-2 rounded-full hover:bg-slate-100 transition-colors",children:f.jsx(er,{size:24})}),f.jsx("img",{src:"./assets/icon.png",className:"w-24 h-24 mb-6 drop-shadow-md",alt:"Nozes Logo"}),f.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Nozes IA"}),f.jsx("p",{className:"text-slate-500 text-center mb-8",children:n==="pt"?"O que voc deseja identificar hoje?":"What do you want to identify today?"}),f.jsxs("div",{className:"grid grid-cols-1 gap-4 w-full",children:[f.jsxs("button",{onClick:()=>{E(_=>({..._,category:"FLORA"})),D("WIZARD")},className:"flex items-center gap-4 p-4 rounded-xl border-2 border-slate-100 hover:border-emerald-500 hover:bg-emerald-50 transition-all group bg-white shadow-sm hover:shadow-md",children:[f.jsx("div",{className:"w-12 h-12 rounded-full bg-emerald-100 flex items-center justify-center text-2xl group-hover:scale-110 transition-transform",children:""}),f.jsxs("div",{className:"text-left",children:[f.jsx("h3",{className:"font-bold text-slate-800 group-hover:text-emerald-700",children:"Flora"}),f.jsx("p",{className:"text-xs text-slate-500",children:n==="pt"?"Plantas, rvores, flores":"Plants, trees, flowers"})]})]}),f.jsxs("button",{onClick:()=>{E(_=>({..._,category:"FAUNA"})),D("WIZARD")},className:"flex items-center gap-4 p-4 rounded-xl border-2 border-slate-100 hover:border-amber-500 hover:bg-amber-50 transition-all group bg-white shadow-sm hover:shadow-md",children:[f.jsx("div",{className:"w-12 h-12 rounded-full bg-amber-100 flex items-center justify-center text-2xl group-hover:scale-110 transition-transform",children:""}),f.jsxs("div",{className:"text-left",children:[f.jsx("h3",{className:"font-bold text-slate-800 group-hover:text-amber-700",children:"Fauna"}),f.jsx("p",{className:"text-xs text-slate-500",children:n==="pt"?"Animais, insetos, aves":"Animals, insects, birds"})]})]}),f.jsxs("button",{onClick:()=>{E(_=>({..._,category:"OTHER"})),D("WIZARD")},className:"flex items-center gap-4 p-4 rounded-xl border-2 border-slate-100 hover:border-purple-500 hover:bg-purple-50 transition-all group bg-white shadow-sm hover:shadow-md",children:[f.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center text-2xl group-hover:scale-110 transition-transform",children:""}),f.jsxs("div",{className:"text-left",children:[f.jsx("h3",{className:"font-bold text-slate-800 group-hover:text-purple-700",children:n==="pt"?"Outros":"Others"}),f.jsx("p",{className:"text-xs text-slate-500",children:n==="pt"?"Filmes, livros, objetos, etc.":"Movies, books, objects, etc."})]})]})]})]}):f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full overflow-hidden animate-in fade-in zoom-in-95 duration-200 border border-slate-200 max-h-[90vh] flex flex-col",children:[f.jsxs("div",{className:`p-4 md:p-6 text-white shrink-0 bg-gradient-to-r ${y.category==="FAUNA"?"from-amber-600 to-orange-500":y.category==="OTHER"?"from-purple-600 to-indigo-500":"from-emerald-600 to-teal-500"}`,children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:f.jsx(As,{size:24,className:"text-white"})}),f.jsx("h3",{className:"text-xl md:text-2xl font-bold flex-1",children:l.aiTitle}),f.jsx("img",{src:"./assets/icon.png",className:"w-12 h-12 drop-shadow-sm opacity-90",alt:"Nozes"}),a&&f.jsx("button",{onClick:()=>{S(!1),a(!0)},className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",title:n==="pt"?"Configurar Chave de API":"Configure API Key",children:f.jsx(s0,{size:18,className:"text-white"})})]}),f.jsx("p",{className:"text-white/90 text-xs md:text-sm font-medium drop-shadow-sm",children:l.aiDesc}),!s&&a&&f.jsxs("div",{className:"mt-3 flex items-center gap-2 bg-red-500/30 backdrop-blur-sm px-3 py-2 rounded-lg border border-red-300/50 animate-pulse",children:[f.jsx(s0,{size:16,className:"text-yellow-200"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-yellow-100 text-xs font-bold",children:l.apiKeyWarning}),f.jsx("p",{className:"text-yellow-200/80 text-[10px]",children:l.clickGear})]})]})]}),f.jsxs("div",{className:"flex border-b border-slate-200 bg-slate-50 shrink-0",children:[f.jsx("button",{onClick:()=>Y("TOPIC"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${H==="TOPIC"?(y.category==="FAUNA"?"border-amber-500 text-amber-600":y.category==="OTHER"?"border-purple-500 text-purple-600":"border-emerald-500 text-emerald-600")+" bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:f.jsxs("span",{className:"flex items-center justify-center gap-1",children:[f.jsx(Hf,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.modeTopic}),f.jsx("span",{className:"sm:hidden",children:"Gerar"})]})}),f.jsx("button",{onClick:()=>Y("IMPORT"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${H==="IMPORT"?(y.category==="FAUNA"?"border-amber-500 text-amber-600":y.category==="OTHER"?"border-purple-500 text-purple-600":"border-emerald-500 text-emerald-600")+" bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:f.jsxs("span",{className:"flex items-center justify-center gap-1",children:[f.jsx(zm,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.modeImport}),f.jsx("span",{className:"sm:hidden",children:"Importar"})]})}),f.jsx("button",{onClick:()=>Y("REFINE"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${H==="REFINE"?(y.category==="FAUNA"?"border-amber-500 text-amber-600":y.category==="OTHER"?"border-purple-500 text-purple-600":"border-emerald-500 text-emerald-600")+" bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:f.jsxs("span",{className:"flex items-center justify-center gap-1",children:[f.jsx(xc,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.modeRefine}),f.jsx("span",{className:"sm:hidden",children:"Refinar"})]})}),f.jsx("button",{onClick:()=>Y("MERGE"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${H==="MERGE"?(y.category==="FAUNA"?"border-amber-500 text-amber-600":y.category==="OTHER"?"border-purple-500 text-purple-600":"border-emerald-500 text-emerald-600")+" bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:f.jsxs("span",{className:"flex items-center justify-center gap-1",children:[f.jsx(Hm,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.modeMerge}),f.jsx("span",{className:"sm:hidden",children:"Combinar"})]})})]}),f.jsxs("div",{className:"p-4 md:p-6 space-y-5 overflow-y-auto custom-scrollbar flex-1 bg-white",children:[H==="TOPIC"?f.jsxs(f.Fragment,{children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:l.topic}),f.jsx("input",{value:y.topic,onChange:_=>E(N=>({...N,topic:_.target.value})),placeholder:y.category==="FAUNA"?n==="pt"?"ex: Felinos da frica, Aves do Pantanal":"e.g. African Cats, Birds of Pantanal":y.category==="OTHER"?n==="pt"?"ex: Filmes de Terror dos anos 80, Personagens de Harry Potter":"e.g. 80s Horror Movies, Harry Potter Characters":l.topicPlace,className:`w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 outline-none text-base md:text-lg ${y.category==="FAUNA"?"focus:ring-amber-500 focus:border-amber-500":y.category==="OTHER"?"focus:ring-purple-500 focus:border-purple-500":"focus:ring-emerald-500 focus:border-emerald-500"}`,disabled:w})]}),(y.category==="FLORA"||y.category==="FAUNA")&&f.jsxs("div",{className:`p-3 rounded-xl border ${y.category==="FAUNA"?"bg-amber-50/50 border-amber-100":"bg-emerald-50/50 border-emerald-100"}`,children:[f.jsxs("label",{className:`block text-xs font-bold uppercase mb-2 flex items-center gap-1 ${y.category==="FAUNA"?"text-amber-700":"text-emerald-700"}`,children:[f.jsx(hu,{size:12})," ",l.taxonomyFilters]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:l.taxonomyFamily}),f.jsx("input",{value:y.taxonomyFamily,onChange:_=>E(N=>({...N,taxonomyFamily:_.target.value})),placeholder:y.category==="FAUNA"?n==="pt"?"ex: Felidae":"e.g. Felidae":n==="pt"?"ex: Fabaceae":"e.g. Fabaceae",className:`w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 outline-none text-sm bg-white ${y.category==="FAUNA"?"focus:ring-amber-500":"focus:ring-emerald-500"}`,disabled:w})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:l.taxonomyGenus}),f.jsx("input",{value:y.taxonomyGenus,onChange:_=>E(N=>({...N,taxonomyGenus:_.target.value})),placeholder:y.category==="FAUNA"?n==="pt"?"ex: Panthera":"e.g. Panthera":n==="pt"?"ex: Inga":"e.g. Inga",className:`w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 outline-none text-sm bg-white ${y.category==="FAUNA"?"focus:ring-amber-500":"focus:ring-emerald-500"}`,disabled:w})]})]})]}),(y.category==="FLORA"||y.category==="FAUNA")&&f.jsxs("div",{className:"bg-blue-50/50 p-3 rounded-xl border border-blue-100",children:[f.jsxs("label",{className:"block text-xs font-bold text-blue-700 uppercase mb-2 flex items-center gap-1",children:[f.jsx(Wm,{size:12})," ",l.geographyFilters]}),f.jsx("div",{className:"flex gap-2 mb-3",children:["global","national","regional"].map(_=>f.jsx("button",{onClick:()=>E(N=>({...N,scope:_})),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-lg transition-colors ${y.scope===_?"bg-blue-600 text-white":"bg-white text-slate-600 hover:bg-blue-100 border border-slate-200"}`,disabled:w,children:_==="global"?l.scopeGlobal:_==="national"?l.scopeNational:l.scopeRegional},_))}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:l.biome}),f.jsxs("select",{value:y.biome,onChange:_=>E(N=>({...N,biome:_.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm bg-white",disabled:w,children:[f.jsx("option",{value:"",children:n==="pt"?"Todos os biomas":"All biomes"}),f.jsx("option",{value:"Amaznia",children:"Amaznia"}),f.jsx("option",{value:"Mata Atlntica",children:"Mata Atlntica"}),f.jsx("option",{value:"Cerrado",children:"Cerrado"}),f.jsx("option",{value:"Caatinga",children:"Caatinga"}),f.jsx("option",{value:"Pampa",children:"Pampa"}),f.jsx("option",{value:"Pantanal",children:"Pantanal"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:l.stateUF}),f.jsxs("select",{value:y.stateUF,onChange:_=>E(N=>({...N,stateUF:_.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm bg-white",disabled:w,children:[f.jsx("option",{value:"",children:n==="pt"?"Todos os estados":"All states"}),f.jsx("option",{value:"AC",children:"Acre (AC)"}),f.jsx("option",{value:"AL",children:"Alagoas (AL)"}),f.jsx("option",{value:"AP",children:"Amap (AP)"}),f.jsx("option",{value:"AM",children:"Amazonas (AM)"}),f.jsx("option",{value:"BA",children:"Bahia (BA)"}),f.jsx("option",{value:"CE",children:"Cear (CE)"}),f.jsx("option",{value:"DF",children:"Distrito Federal (DF)"}),f.jsx("option",{value:"ES",children:"Esprito Santo (ES)"}),f.jsx("option",{value:"GO",children:"Gois (GO)"}),f.jsx("option",{value:"MA",children:"Maranho (MA)"}),f.jsx("option",{value:"MT",children:"Mato Grosso (MT)"}),f.jsx("option",{value:"MS",children:"Mato Grosso do Sul (MS)"}),f.jsx("option",{value:"MG",children:"Minas Gerais (MG)"}),f.jsx("option",{value:"PA",children:"Par (PA)"}),f.jsx("option",{value:"PB",children:"Paraba (PB)"}),f.jsx("option",{value:"PR",children:"Paran (PR)"}),f.jsx("option",{value:"PE",children:"Pernambuco (PE)"}),f.jsx("option",{value:"PI",children:"Piau (PI)"}),f.jsx("option",{value:"RJ",children:"Rio de Janeiro (RJ)"}),f.jsx("option",{value:"RN",children:"Rio Grande do Norte (RN)"}),f.jsx("option",{value:"RS",children:"Rio Grande do Sul (RS)"}),f.jsx("option",{value:"RO",children:"Rondnia (RO)"}),f.jsx("option",{value:"RR",children:"Roraima (RR)"}),f.jsx("option",{value:"SC",children:"Santa Catarina (SC)"}),f.jsx("option",{value:"SP",children:"So Paulo (SP)"}),f.jsx("option",{value:"SE",children:"Sergipe (SE)"}),f.jsx("option",{value:"TO",children:"Tocantins (TO)"})]})]})]}),f.jsxs("div",{className:"mt-3",children:[f.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:n==="pt"?"Regio especfica (opcional)":"Specific region (optional)"}),f.jsx("input",{value:y.geography,onChange:_=>E(N=>({...N,geography:_.target.value})),placeholder:n==="pt"?"ex: Serra do Mar, Bacia do Rio Doce":"e.g. Amazon Basin, Andes",className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm bg-white",disabled:w})]})]}),f.jsxs("div",{className:`p-3 rounded-xl border ${y.category==="FAUNA"?"bg-amber-50/50 border-amber-100":y.category==="OTHER"?"bg-purple-50/50 border-purple-100":"bg-emerald-50/50 border-emerald-100"}`,children:[f.jsxs("label",{className:`block text-xs font-bold uppercase mb-2 flex items-center gap-1 ${y.category==="FAUNA"?"text-amber-700":y.category==="OTHER"?"text-purple-700":"text-emerald-700"}`,children:[y.category==="OTHER"?"":""," ",l.featureTypeLabel]}),f.jsx("p",{className:`text-xs mb-2 ${y.category==="FAUNA"?"text-amber-600/80":y.category==="OTHER"?"text-purple-600/80":"text-emerald-600/80"}`,children:y.category==="FAUNA"?n==="pt"?"Focar em caractersticas morfolgicas (corpo) ou comportamentais":"Focus on morphological (body) or behavioral features":y.category==="OTHER"?n==="pt"?"Focar em caractersticas visuais ou conceituais":"Focus on visual or conceptual features":l.featureTypeDesc}),f.jsx("div",{className:"flex flex-wrap gap-2",children:y.category==="FLORA"?f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:()=>E(_=>({..._,featureFocus:"vegetative"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${y.featureFocus==="vegetative"?"bg-emerald-500 text-white border-emerald-500":"bg-white text-slate-600 border-slate-200 hover:border-emerald-300"}`,disabled:w,children:[" ",l.featureTypeVegetative]}),f.jsxs("button",{onClick:()=>E(_=>({..._,featureFocus:"reproductive"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${y.featureFocus==="reproductive"?"bg-pink-500 text-white border-pink-500":"bg-white text-slate-600 border-slate-200 hover:border-pink-300"}`,disabled:w,children:[" ",l.featureTypeReproductive]}),f.jsxs("button",{onClick:()=>E(_=>({..._,featureFocus:"general"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${y.featureFocus==="general"?"bg-emerald-600 text-white border-emerald-600":"bg-white text-slate-600 border-slate-200 hover:border-emerald-300"}`,disabled:w,children:[" ",l.featureTypeBoth]})]}):y.category==="FAUNA"?f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:()=>E(_=>({..._,featureFocus:"vegetative"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${y.featureFocus==="vegetative"?"bg-amber-500 text-white border-amber-500":"bg-white text-slate-600 border-slate-200 hover:border-amber-300"}`,disabled:w,children:[" ",n==="pt"?"Morfolgicas":"Morphological"]}),f.jsxs("button",{onClick:()=>E(_=>({..._,featureFocus:"reproductive"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${y.featureFocus==="reproductive"?"bg-orange-500 text-white border-orange-500":"bg-white text-slate-600 border-slate-200 hover:border-orange-300"}`,disabled:w,children:[" ",n==="pt"?"Comportamentais":"Behavioral"]}),f.jsxs("button",{onClick:()=>E(_=>({..._,featureFocus:"general"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${y.featureFocus==="general"?"bg-amber-600 text-white border-amber-600":"bg-white text-slate-600 border-slate-200 hover:border-amber-300"}`,disabled:w,children:[" ",n==="pt"?"Geral + Habitat":"General + Habitat"]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:()=>E(_=>({..._,featureFocus:"vegetative"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${y.featureFocus==="vegetative"?"bg-purple-500 text-white border-purple-500":"bg-white text-slate-600 border-slate-200 hover:border-purple-300"}`,disabled:w,children:[" ",n==="pt"?"Visuais/Fsicas":"Visual/Physical"]}),f.jsxs("button",{onClick:()=>E(_=>({..._,featureFocus:"reproductive"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${y.featureFocus==="reproductive"?"bg-indigo-500 text-white border-indigo-500":"bg-white text-slate-600 border-slate-200 hover:border-indigo-300"}`,disabled:w,children:[" ",n==="pt"?"Conceituais/Abstratas":"Conceptual/Abstract"]}),f.jsxs("button",{onClick:()=>E(_=>({..._,featureFocus:"general"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${y.featureFocus==="general"?"bg-purple-600 text-white border-purple-600":"bg-white text-slate-600 border-slate-200 hover:border-purple-300"}`,disabled:w,children:[" ",n==="pt"?"Misto":"Mixed"]})]})})]}),f.jsxs("div",{className:`p-3 rounded-xl border ${y.category==="FAUNA"?"bg-amber-50/50 border-amber-100":y.category==="OTHER"?"bg-purple-50/50 border-purple-100":"bg-emerald-50/50 border-emerald-100"}`,children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("label",{className:`block text-xs font-bold uppercase flex items-center gap-1 ${y.category==="FAUNA"?"text-amber-700":y.category==="OTHER"?"text-purple-700":"text-emerald-700"}`,children:[f.jsx(Jm,{size:12}),y.category==="FAUNA"?n==="pt"?"Lista de Espcies (Opcional)":"Required Species List":y.category==="OTHER"?n==="pt"?"Lista de Itens (Opcional)":"Required Items List":l.requiredSpecies]}),Yn.trim()&&f.jsxs("span",{className:`text-xs font-bold px-2 py-0.5 rounded ${y.category==="FAUNA"?"text-amber-600 bg-amber-100":y.category==="OTHER"?"text-purple-600 bg-purple-100":"text-emerald-600 bg-emerald-100"}`,children:[Yn.split(`
`).filter(_=>_.trim()).length," ",l.speciesCount]})]}),f.jsx("p",{className:`text-xs mb-2 ${y.category==="FAUNA"?"text-amber-600/80":y.category==="OTHER"?"text-purple-600/80":"text-emerald-600/80"}`,children:l.requiredSpeciesDesc}),f.jsx("textarea",{value:Yn,onChange:_=>na(_.target.value),placeholder:y.category==="FAUNA"?n==="pt"?`ex: Panthera onca
Panthera leo
Puma concolor`:`e.g. Panthera onca
Panthera leo`:y.category==="OTHER"?n==="pt"?`ex: O Iluminado
Alien - O 8 Passageiro
Halloween`:`e.g. The Shining
Alien
Halloween`:l.requiredSpeciesPlaceholder,className:`w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 outline-none text-sm bg-white resize-none h-24 font-mono ${y.category==="FAUNA"?"focus:ring-amber-500":y.category==="OTHER"?"focus:ring-purple-500":"focus:ring-emerald-500"}`,disabled:w}),f.jsxs("div",{className:"flex items-center justify-between mt-2 gap-2",children:[f.jsxs("label",{className:"cursor-pointer flex items-center gap-2 text-xs text-purple-600 hover:text-purple-800 transition-colors",children:[f.jsx($i,{size:14}),f.jsx("span",{className:"font-medium",children:l.importSpeciesList}),f.jsx("input",{ref:co,type:"file",className:"hidden",accept:".txt,.csv,.json,.doc,.docx",onChange:KE,disabled:w})]}),Yn.trim()&&f.jsxs("button",{onClick:()=>na(""),className:"text-xs text-red-500 hover:text-red-700 font-medium flex items-center gap-1",disabled:w,children:[f.jsx(_s,{size:12})," ",l.clearList]})]}),f.jsx("p",{className:"text-[10px] text-purple-400 mt-1",children:l.importSpeciesFormats})]})]}):H==="IMPORT"?f.jsxs("div",{className:"flex flex-col gap-4",children:[f.jsxs("div",{className:"text-center space-y-2 mb-2",children:[f.jsx("h4",{className:"font-bold text-slate-800 text-lg",children:l.uploadLabel}),f.jsx("p",{className:"text-slate-500 text-sm",children:l.uploadDesc})]}),f.jsx("div",{className:`border-2 border-dashed rounded-xl p-6 flex flex-col items-center justify-center transition-all ${Te?"border-amber-500 bg-amber-100 scale-[1.02]":q?"border-amber-500 bg-amber-50/30":"border-slate-300 hover:border-amber-400 bg-slate-50"}`,onDragOver:Sp,onDragEnter:Sp,onDragLeave:qE,onDrop:JE,children:q?f.jsxs("div",{className:"flex flex-col items-center gap-3",children:[f.jsx($f,{size:48,className:"text-amber-600"}),f.jsx("span",{className:"font-bold text-slate-800 text-sm text-center break-all",children:q.name}),f.jsxs("span",{className:"text-xs text-slate-400",children:[(q.size/1024).toFixed(1)," KB"]}),f.jsxs("button",{onClick:()=>ue(null),className:"mt-2 text-red-500 text-xs font-bold hover:underline flex items-center gap-1 p-2",children:[f.jsx(_s,{size:12})," ",l.removeFile]})]}):f.jsxs("label",{className:"cursor-pointer flex flex-col items-center gap-3 w-full h-full",children:[f.jsx("div",{className:`p-4 bg-white rounded-full shadow-sm transition-transform ${Te?"scale-110":""}`,children:f.jsx($i,{size:24,className:`${Te?"text-amber-600":"text-amber-500"}`})}),f.jsx("span",{className:"font-bold text-slate-600",children:Te?n==="pt"?"Solte o arquivo aqui!":"Drop file here!":l.dropFile}),f.jsx("span",{className:"text-xs text-slate-400",children:l.supportedFormats}),f.jsx("input",{type:"file",className:"hidden",accept:".pdf,.txt,.jpg,.jpeg,.png",onChange:WE})]})}),f.jsxs("div",{className:"mt-2 pt-4 border-t border-slate-200",children:[f.jsxs("label",{className:"w-full flex items-center justify-center gap-2 p-3 rounded-xl cursor-pointer transition-colors border bg-gradient-to-r from-emerald-50 to-teal-50 hover:from-emerald-100 hover:to-teal-100 text-emerald-700 border-emerald-200 hover:border-emerald-300",children:[f.jsx("img",{src:"./assets/nervura.png",alt:"Nervura",className:"w-5 h-5 object-contain"}),f.jsx("span",{className:"font-bold text-sm",children:n==="pt"?"Ficha Morfolgica NervuraColetora":"NervuraColetora Morphological Sheet"}),f.jsx("input",{type:"file",className:"hidden",accept:".json",onChange:$E,disabled:w})]}),f.jsx("p",{className:"text-[10px] text-center text-slate-400 mt-2",children:n==="pt"?"Selecione um arquivo JSON exportado do NervuraColetora.":"Select a JSON file exported from NervuraColetora."})]})]}):H==="REFINE"?f.jsxs("div",{className:"flex flex-col gap-4",children:[f.jsxs("div",{className:"bg-gradient-to-r from-emerald-50 to-teal-50 p-4 rounded-xl border border-emerald-200",children:[f.jsx("h5",{className:"text-xs font-bold text-emerald-700 uppercase mb-2",children:l.currentProject}),h.entities.length>0||h.features.length>0?f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-bold text-slate-800 truncate",children:h.name}),f.jsxs("p",{className:"text-xs text-slate-500",children:[h.entities.length," ",l.entitiesCount,"  ",h.features.length," ",l.featuresCount]})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("span",{className:"bg-emerald-100 text-emerald-700 text-xs font-bold px-2 py-1 rounded",children:h.entities.length}),f.jsx("span",{className:"bg-teal-100 text-teal-700 text-xs font-bold px-2 py-1 rounded",children:h.features.length})]})]}):f.jsx("p",{className:"text-sm text-amber-600 italic",children:l.noProjectLoaded})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("button",{onClick:()=>ve("EXPAND"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${ae==="EXPAND"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-lg ${ae==="EXPAND"?"bg-amber-500 text-white":"bg-slate-100 text-slate-500"}`,children:f.jsx(YS,{size:20})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-bold text-slate-800",children:l.actionExpand}),f.jsx("p",{className:"text-xs text-slate-500",children:l.actionExpandDesc})]})]})}),f.jsx("button",{onClick:()=>ve("REFINE"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${ae==="REFINE"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-lg ${ae==="REFINE"?"bg-amber-500 text-white":"bg-slate-100 text-slate-500"}`,children:f.jsx(nk,{size:20})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-bold text-slate-800",children:l.actionRefine}),f.jsx("p",{className:"text-xs text-slate-500",children:l.actionRefineDesc})]})]})}),f.jsx("button",{onClick:()=>ve("CLEAN"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${ae==="CLEAN"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-lg ${ae==="CLEAN"?"bg-amber-500 text-white":"bg-slate-100 text-slate-500"}`,children:f.jsx(WS,{size:20})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-bold text-slate-800",children:l.actionClean}),f.jsx("p",{className:"text-xs text-slate-500",children:l.actionCleanDesc})]})]})}),f.jsx("button",{onClick:()=>ve("PHOTOS"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${ae==="PHOTOS"?"border-blue-500 bg-blue-50":"border-slate-200 hover:border-blue-300"}`,children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-lg ${ae==="PHOTOS"?"bg-blue-500 text-white":"bg-slate-100 text-slate-500"}`,children:f.jsx(jS,{size:20})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-bold text-slate-800",children:l.actionPhotos}),f.jsx("p",{className:"text-xs text-slate-500",children:l.actionPhotosDesc})]})]})}),f.jsx("button",{onClick:()=>ve("VALIDATE"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${ae==="VALIDATE"?"border-emerald-500 bg-emerald-50":"border-slate-200 hover:border-emerald-300"}`,children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-lg ${ae==="VALIDATE"?"bg-emerald-500 text-white":"bg-slate-100 text-slate-500"}`,children:f.jsx(Qm,{size:20})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-bold text-slate-800",children:l.actionValidate}),f.jsx("p",{className:"text-xs text-slate-500",children:l.actionValidateDesc})]})]})})]}),ae==="EXPAND"&&f.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-4",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:l.expandCount}),f.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:C.expandCount})]}),f.jsx("input",{type:"range",min:"5",max:"100",step:"5",value:C.expandCount,onChange:_=>Re(N=>({...N,expandCount:parseInt(_.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500",disabled:w})]}),f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:C.keepExisting,onChange:_=>Re(N=>({...N,keepExisting:_.target.checked})),className:"w-4 h-4 accent-amber-500"}),f.jsx("span",{className:"text-sm text-slate-700",children:l.keepExisting})]}),f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:C.addFeatures,onChange:_=>Re(N=>({...N,addFeatures:_.target.checked})),className:"w-4 h-4 accent-amber-500"}),f.jsx("span",{className:"text-sm text-slate-700",children:l.addFeatures})]}),(y.category==="FLORA"||y.category==="FAUNA")&&f.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[f.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase mb-3",children:l.expandFilters}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:l.expandFamily}),f.jsx("input",{type:"text",value:C.expandFamily,onChange:_=>Re(N=>({...N,expandFamily:_.target.value})),placeholder:y.category==="FAUNA"?"Felidae":"Fabaceae",className:"w-full px-2 py-1.5 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-400 focus:outline-none"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:l.expandGenus}),f.jsx("input",{type:"text",value:C.expandGenus,onChange:_=>Re(N=>({...N,expandGenus:_.target.value})),placeholder:y.category==="FAUNA"?"Panthera":"Inga",className:"w-full px-2 py-1.5 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-400 focus:outline-none"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:l.expandBiome}),f.jsxs("select",{value:C.expandBiome,onChange:_=>Re(N=>({...N,expandBiome:_.target.value})),className:"w-full px-2 py-1.5 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-400 focus:outline-none bg-white",children:[f.jsx("option",{value:"",children:"--"}),f.jsx("option",{value:"Amaznia",children:"Amaznia"}),f.jsx("option",{value:"Mata Atlntica",children:"Mata Atlntica"}),f.jsx("option",{value:"Cerrado",children:"Cerrado"}),f.jsx("option",{value:"Caatinga",children:"Caatinga"}),f.jsx("option",{value:"Pantanal",children:"Pantanal"}),f.jsx("option",{value:"Pampa",children:"Pampa"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:l.expandStateUF}),f.jsxs("select",{value:C.expandStateUF,onChange:_=>Re(N=>({...N,expandStateUF:_.target.value})),className:"w-full px-2 py-1.5 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-400 focus:outline-none bg-white",children:[f.jsx("option",{value:"",children:"--"}),f.jsx("option",{value:"AC",children:"AC"}),f.jsx("option",{value:"AL",children:"AL"}),f.jsx("option",{value:"AP",children:"AP"}),f.jsx("option",{value:"AM",children:"AM"}),f.jsx("option",{value:"BA",children:"BA"}),f.jsx("option",{value:"CE",children:"CE"}),f.jsx("option",{value:"DF",children:"DF"}),f.jsx("option",{value:"ES",children:"ES"}),f.jsx("option",{value:"GO",children:"GO"}),f.jsx("option",{value:"MA",children:"MA"}),f.jsx("option",{value:"MT",children:"MT"}),f.jsx("option",{value:"MS",children:"MS"}),f.jsx("option",{value:"MG",children:"MG"}),f.jsx("option",{value:"PA",children:"PA"}),f.jsx("option",{value:"PB",children:"PB"}),f.jsx("option",{value:"PR",children:"PR"}),f.jsx("option",{value:"PE",children:"PE"}),f.jsx("option",{value:"PI",children:"PI"}),f.jsx("option",{value:"RJ",children:"RJ"}),f.jsx("option",{value:"RN",children:"RN"}),f.jsx("option",{value:"RS",children:"RS"}),f.jsx("option",{value:"RO",children:"RO"}),f.jsx("option",{value:"RR",children:"RR"}),f.jsx("option",{value:"SC",children:"SC"}),f.jsx("option",{value:"SP",children:"SP"}),f.jsx("option",{value:"SE",children:"SE"}),f.jsx("option",{value:"TO",children:"TO"})]})]})]}),f.jsxs("div",{className:"mt-3",children:[f.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:l.expandScope}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>Re(_=>({..._,expandScope:"global"})),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-lg transition-all ${C.expandScope==="global"?"bg-amber-500 text-white shadow-sm":"bg-white text-amber-700 border border-amber-200 hover:bg-amber-50"}`,children:l.scopeGlobal}),f.jsx("button",{onClick:()=>Re(_=>({..._,expandScope:"national"})),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-lg transition-all ${C.expandScope==="national"?"bg-amber-500 text-white shadow-sm":"bg-white text-amber-700 border border-amber-200 hover:bg-amber-50"}`,children:l.scopeNational}),f.jsx("button",{onClick:()=>Re(_=>({..._,expandScope:"regional"})),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-lg transition-all ${C.expandScope==="regional"?"bg-amber-500 text-white shadow-sm":"bg-white text-amber-700 border border-amber-200 hover:bg-amber-50"}`,children:l.scopeRegional})]})]})]}),f.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("label",{className:"block text-xs font-semibold text-amber-700 uppercase flex items-center gap-1",children:[f.jsx(Jm,{size:12})," ",y.category==="OTHER"?n==="pt"?"Itens Obrigatrios":"Required Items":l.expandRequiredSpecies]}),C.expandRequiredSpecies.trim()&&f.jsxs("span",{className:"text-xs font-bold text-amber-600 bg-amber-100 px-2 py-0.5 rounded",children:[C.expandRequiredSpecies.split(`
`).filter(_=>_.trim()).length," ",l.speciesCount]})]}),f.jsx("p",{className:"text-xs text-amber-600/80 mb-2",children:l.expandRequiredSpeciesDesc}),f.jsx("textarea",{value:C.expandRequiredSpecies,onChange:_=>Re(N=>({...N,expandRequiredSpecies:_.target.value})),placeholder:y.category==="FAUNA"?n==="pt"?`ex: Panthera onca
Panthera leo`:`e.g. Panthera onca
Panthera leo`:y.category==="OTHER"?n==="pt"?`ex: O Iluminado
Alien`:`e.g. The Shining
Alien`:l.expandRequiredSpeciesPlaceholder,className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-500 outline-none text-sm bg-white resize-none h-20 font-mono",disabled:w}),C.expandRequiredSpecies.trim()&&f.jsxs("button",{onClick:()=>Re(_=>({..._,expandRequiredSpecies:""})),className:"mt-2 text-xs text-red-500 hover:text-red-700 font-medium flex items-center gap-1",disabled:w,children:[f.jsx(_s,{size:12})," ",l.clearList]})]})]}),ae==="REFINE"&&f.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-3",children:[f.jsxs("div",{className:"pb-3 border-b border-slate-200",children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-2",children:l.featureTypeLabel}),f.jsx("p",{className:"text-xs text-slate-400 mb-2",children:y.category==="FAUNA"?n==="pt"?"Focar em caractersticas morfolgicas ou comportamentais":"Focus on morphological or behavioral features":y.category==="OTHER"?n==="pt"?"Focar em caractersticas visuais ou conceituais":"Focus on visual or conceptual features":l.featureTypeDesc}),f.jsx("div",{className:"flex flex-wrap gap-2",children:y.category==="FLORA"?f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:()=>Re(_=>({..._,featureType:"vegetative"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${C.featureType==="vegetative"?"bg-emerald-500 text-white border-emerald-500":"bg-white text-slate-600 border-slate-200 hover:border-emerald-300"}`,children:[" ",l.featureTypeVegetative]}),f.jsxs("button",{onClick:()=>Re(_=>({..._,featureType:"reproductive"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${C.featureType==="reproductive"?"bg-pink-500 text-white border-pink-500":"bg-white text-slate-600 border-slate-200 hover:border-pink-300"}`,children:[" ",l.featureTypeReproductive]}),f.jsxs("button",{onClick:()=>Re(_=>({..._,featureType:"both"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${C.featureType==="both"?"bg-amber-500 text-white border-amber-500":"bg-white text-slate-600 border-slate-200 hover:border-amber-300"}`,children:[" ",l.featureTypeBoth]})]}):y.category==="FAUNA"?f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:()=>Re(_=>({..._,featureType:"vegetative"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${C.featureType==="vegetative"?"bg-amber-500 text-white border-amber-500":"bg-white text-slate-600 border-slate-200 hover:border-amber-300"}`,children:[" ",n==="pt"?"Morfolgicas":"Morphological"]}),f.jsxs("button",{onClick:()=>Re(_=>({..._,featureType:"reproductive"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${C.featureType==="reproductive"?"bg-orange-500 text-white border-orange-500":"bg-white text-slate-600 border-slate-200 hover:border-orange-300"}`,children:[" ",n==="pt"?"Comportamentais":"Behavioral"]}),f.jsxs("button",{onClick:()=>Re(_=>({..._,featureType:"both"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${C.featureType==="both"?"bg-amber-600 text-white border-amber-600":"bg-white text-slate-600 border-slate-200 hover:border-amber-300"}`,children:[" ",n==="pt"?"Geral + Habitat":"General + Habitat"]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:()=>Re(_=>({..._,featureType:"vegetative"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${C.featureType==="vegetative"?"bg-purple-500 text-white border-purple-500":"bg-white text-slate-600 border-slate-200 hover:border-purple-300"}`,children:[" ",n==="pt"?"Visuais/Fsicas":"Visual/Physical"]}),f.jsxs("button",{onClick:()=>Re(_=>({..._,featureType:"reproductive"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${C.featureType==="reproductive"?"bg-indigo-500 text-white border-indigo-500":"bg-white text-slate-600 border-slate-200 hover:border-indigo-300"}`,children:[" ",n==="pt"?"Conceituais/Abstratas":"Conceptual/Abstract"]}),f.jsxs("button",{onClick:()=>Re(_=>({..._,featureType:"both"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${C.featureType==="both"?"bg-purple-600 text-white border-purple-600":"bg-white text-slate-600 border-slate-200 hover:border-purple-300"}`,children:[" ",n==="pt"?"Misto":"Mixed"]})]})})]}),f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:C.improveDescriptions,onChange:_=>Re(N=>({...N,improveDescriptions:_.target.checked})),className:"w-4 h-4 accent-amber-500"}),f.jsx("span",{className:"text-sm text-slate-700",children:l.improveDescriptions})]}),f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:C.fillGaps,onChange:_=>Re(N=>({...N,fillGaps:_.target.checked})),className:"w-4 h-4 accent-amber-500"}),f.jsx("span",{className:"text-sm text-slate-700",children:l.fillGaps})]}),f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:C.addFeatures,onChange:_=>Re(N=>({...N,addFeatures:_.target.checked})),className:"w-4 h-4 accent-amber-500"}),f.jsx("span",{className:"text-sm text-slate-700",children:l.addFeatures})]}),C.addFeatures&&f.jsxs("div",{className:"ml-6 space-y-2",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-xs text-slate-500 font-medium",children:n==="pt"?"N de caractersticas a adicionar":"Number of features to add"}),f.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:C.refineFeatureCount})]}),f.jsx("input",{type:"range",min:"1",max:"10",step:"1",value:C.refineFeatureCount,onChange:_=>Re(N=>({...N,refineFeatureCount:parseInt(_.target.value)})),className:"w-full h-1.5 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500"})]}),C.addFeatures&&f.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[f.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase mb-2",children:l.refineRequiredFeaturesTitle}),f.jsx("p",{className:"text-xs text-slate-400 mb-3",children:l.refineRequiredFeaturesDesc}),C.refineRequiredFeatures.length>0&&f.jsx("div",{className:"flex flex-wrap gap-1.5 mb-3",children:C.refineRequiredFeatures.map((_,N)=>f.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-amber-100 text-amber-800 text-xs rounded-full",children:[_,f.jsx("button",{onClick:()=>Re(V=>({...V,refineRequiredFeatures:V.refineRequiredFeatures.filter((z,Q)=>Q!==N)})),className:"hover:text-amber-600",children:f.jsx(er,{size:12})})]},N))}),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{onClick:()=>xs(!Mi),className:"w-full px-3 py-2 text-sm text-left border border-slate-200 rounded-lg bg-white hover:border-amber-400 focus:ring-2 focus:ring-amber-400 focus:outline-none flex justify-between items-center",children:[f.jsx("span",{className:"text-slate-500",children:l.addRequiredFeature}),f.jsx(du,{size:16,className:`text-slate-400 transition-transform ${Mi?"rotate-180":""}`})]}),Mi&&f.jsxs("div",{className:"absolute z-20 mt-1 w-full bg-white border border-slate-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[gs.map((_,N)=>f.jsxs("div",{children:[f.jsx("div",{className:"px-3 py-1.5 bg-slate-50 text-xs font-semibold text-slate-500 uppercase sticky top-0",children:_.category}),_.items.map((V,z)=>f.jsx("button",{onClick:()=>{C.refineRequiredFeatures.includes(V)||Re(Q=>({...Q,refineRequiredFeatures:[...Q.refineRequiredFeatures,V]})),xs(!1)},disabled:C.refineRequiredFeatures.includes(V),className:`w-full px-3 py-2 text-sm text-left hover:bg-amber-50 ${C.refineRequiredFeatures.includes(V)?"text-slate-300":"text-slate-700"}`,children:V},z))]},N)),f.jsx("div",{className:"p-2 border-t border-slate-100",children:f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",value:qt,onChange:_=>xn(_.target.value),placeholder:l.customFeature,className:"flex-1 px-2 py-1.5 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-400 focus:outline-none",onKeyDown:_=>{_.key==="Enter"&&qt.trim()&&(Re(N=>({...N,refineRequiredFeatures:[...N.refineRequiredFeatures,qt.trim()]})),xn(""),xs(!1))}}),f.jsx("button",{onClick:()=>{qt.trim()&&(Re(_=>({..._,refineRequiredFeatures:[..._.refineRequiredFeatures,qt.trim()]})),xn(""),xs(!1))},className:"px-3 py-1.5 bg-amber-500 text-white text-sm rounded-lg hover:bg-amber-600",children:"+"})]})})]})]}),f.jsxs("div",{className:"mt-3",children:[f.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:n==="pt"?"Ou digite caractersticas manualmente (Enter para adicionar)":"Or type features manually (Enter to add)"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",value:qt,onChange:_=>xn(_.target.value),placeholder:n==="pt"?"ex: Tipo de tricoma, Forma do ovrio...":"e.g. Trichome type, Ovary shape...",className:"flex-1 px-3 py-2 text-sm border border-slate-200 rounded-lg bg-white focus:ring-2 focus:ring-amber-400 focus:outline-none",onKeyDown:_=>{if(_.key==="Enter"&&qt.trim()){const N=qt.split(",").map(V=>V.trim()).filter(V=>V.length>0);Re(V=>({...V,refineRequiredFeatures:[...V.refineRequiredFeatures,...N.filter(z=>!V.refineRequiredFeatures.includes(z))]})),xn("")}}}),f.jsx("button",{onClick:()=>{if(qt.trim()){const _=qt.split(",").map(N=>N.trim()).filter(N=>N.length>0);Re(N=>({...N,refineRequiredFeatures:[...N.refineRequiredFeatures,..._.filter(V=>!N.refineRequiredFeatures.includes(V))]})),xn("")}},className:"px-3 py-2 bg-amber-500 text-white text-sm rounded-lg hover:bg-amber-600 font-bold",children:"+"})]}),f.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:n==="pt"?"Dica: separe mltiplas caractersticas com vrgula":"Tip: separate multiple features with comma"})]})]})]}),ae==="CLEAN"&&f.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-3",children:[f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:C.removeRedundant,onChange:_=>Re(N=>({...N,removeRedundant:_.target.checked})),className:"w-4 h-4 accent-amber-500"}),f.jsx("span",{className:"text-sm text-slate-700",children:l.removeRedundant})]}),f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:C.fixInconsistencies,onChange:_=>Re(N=>({...N,fixInconsistencies:_.target.checked})),className:"w-4 h-4 accent-amber-500"}),f.jsx("span",{className:"text-sm text-slate-700",children:l.fixInconsistencies})]})]}),ae==="PHOTOS"&&f.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-xl border border-blue-200 space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"text-sm font-medium text-blue-800",children:l.photosActionDesc}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>Re(_=>({..._,photoTarget:"entities"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${C.photoTarget==="entities"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:l.photoTargetEntities}),f.jsx("button",{onClick:()=>Re(_=>({..._,photoTarget:"features"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${C.photoTarget==="features"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:l.photoTargetFeatures}),f.jsx("button",{onClick:()=>Re(_=>({..._,photoTarget:"both"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${C.photoTarget==="both"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:l.photoTargetBoth})]})]}),f.jsx("div",{className:"space-y-2",children:f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:()=>Re(_=>({..._,photoMode:"expand"})),className:`flex-1 py-2 px-3 rounded-lg transition-all ${C.photoMode==="expand"?"bg-emerald-500 text-white shadow-sm":"bg-white text-emerald-700 border border-emerald-200 hover:bg-emerald-50"}`,children:[f.jsx("div",{className:"text-xs font-medium",children:l.photoModeExpand}),f.jsx("div",{className:"text-[10px] opacity-80",children:l.photoModeExpandDesc})]}),f.jsxs("button",{onClick:()=>Re(_=>({..._,photoMode:"replace"})),className:`flex-1 py-2 px-3 rounded-lg transition-all ${C.photoMode==="replace"?"bg-orange-500 text-white shadow-sm":"bg-white text-orange-700 border border-orange-200 hover:bg-orange-50"}`,children:[f.jsx("div",{className:"text-xs font-medium",children:l.photoModeReplace}),f.jsx("div",{className:"text-[10px] opacity-80",children:l.photoModeReplaceDesc})]})]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-xs font-medium text-blue-700",children:l.photoCustomSources}),f.jsx("textarea",{value:C.photoCustomSources||"",onChange:_=>Re(N=>({...N,photoCustomSources:_.target.value})),placeholder:l.photoCustomSourcesPlaceholder,className:"w-full h-20 text-xs p-2 border border-blue-200 rounded-lg bg-white/50 focus:ring-2 focus:ring-blue-400 focus:outline-none resize-none"})]})]}),ae==="VALIDATE"&&f.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 p-4 rounded-xl border border-emerald-200 space-y-4",children:[f.jsx("p",{className:"text-sm font-medium text-emerald-800",children:l.validateOptions}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-xs font-bold text-emerald-700 uppercase",children:l.validateReference}),f.jsx("div",{className:"grid grid-cols-2 gap-2",children:["floradobrasil","gbif","powo","custom"].map(_=>f.jsx("button",{onClick:()=>Re(N=>({...N,validateReference:_})),className:`py-2 px-3 text-xs font-medium rounded-lg transition-all ${C.validateReference===_?"bg-emerald-600 text-white shadow-sm":"bg-white text-emerald-700 border border-emerald-200 hover:bg-emerald-50"}`,children:_==="floradobrasil"?l.validateFloradobrasil:_==="gbif"?l.validateGbif:_==="powo"?l.validatePowo:l.validateCustom},_))})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"flex items-start gap-2 cursor-pointer p-2 rounded-lg hover:bg-white/50 transition-colors",children:[f.jsx("input",{type:"checkbox",checked:C.validateFixNames,onChange:_=>Re(N=>({...N,validateFixNames:_.target.checked})),className:"w-4 h-4 accent-emerald-500 mt-0.5"}),f.jsxs("div",{children:[f.jsx("span",{className:"text-sm font-medium text-slate-800",children:l.validateFixNames}),f.jsx("p",{className:"text-xs text-slate-500",children:l.validateFixNamesDesc})]})]}),f.jsxs("label",{className:"flex items-start gap-2 cursor-pointer p-2 rounded-lg hover:bg-white/50 transition-colors",children:[f.jsx("input",{type:"checkbox",checked:C.validateMergeSynonyms,onChange:_=>Re(N=>({...N,validateMergeSynonyms:_.target.checked})),className:"w-4 h-4 accent-emerald-500 mt-0.5"}),f.jsxs("div",{children:[f.jsx("span",{className:"text-sm font-medium text-slate-800",children:l.validateMergeSynonyms}),f.jsx("p",{className:"text-xs text-slate-500",children:l.validateMergeSynonymsDesc})]})]}),f.jsxs("label",{className:"flex items-start gap-2 cursor-pointer p-2 rounded-lg hover:bg-white/50 transition-colors",children:[f.jsx("input",{type:"checkbox",checked:C.validateCheckGeography,onChange:_=>Re(N=>({...N,validateCheckGeography:_.target.checked})),className:"w-4 h-4 accent-emerald-500 mt-0.5"}),f.jsxs("div",{children:[f.jsx("span",{className:"text-sm font-medium text-slate-800",children:l.validateCheckGeography}),f.jsx("p",{className:"text-xs text-slate-500",children:l.validateCheckGeographyDesc})]})]}),f.jsxs("label",{className:"flex items-start gap-2 cursor-pointer p-2 rounded-lg hover:bg-white/50 transition-colors",children:[f.jsx("input",{type:"checkbox",checked:C.validateCheckTaxonomy,onChange:_=>Re(N=>({...N,validateCheckTaxonomy:_.target.checked})),className:"w-4 h-4 accent-emerald-500 mt-0.5"}),f.jsxs("div",{children:[f.jsx("span",{className:"text-sm font-medium text-slate-800",children:l.validateCheckTaxonomy}),f.jsx("p",{className:"text-xs text-slate-500",children:l.validateCheckTaxonomyDesc})]})]})]}),C.validateCheckTaxonomy&&f.jsxs("div",{className:"bg-white/50 p-3 rounded-lg border border-emerald-200 space-y-3",children:[f.jsxs("label",{className:"text-xs font-bold text-emerald-700 uppercase flex items-center gap-1",children:[f.jsx(hu,{size:12})," ",l.taxonomyFilters]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx("input",{value:C.validateFamily,onChange:_=>Re(N=>({...N,validateFamily:_.target.value})),placeholder:l.taxonomyFamily,className:"px-3 py-2 border border-emerald-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 outline-none"}),f.jsx("input",{value:C.validateGenus,onChange:_=>Re(N=>({...N,validateGenus:_.target.value})),placeholder:l.taxonomyGenus,className:"px-3 py-2 border border-emerald-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 outline-none"})]})]}),C.validateCheckGeography&&f.jsxs("div",{className:"bg-white/50 p-3 rounded-lg border border-emerald-200 space-y-3",children:[f.jsxs("label",{className:"text-xs font-bold text-emerald-700 uppercase flex items-center gap-1",children:[f.jsx(Wm,{size:12})," ",l.geographyFilters]}),f.jsx("div",{className:"flex gap-2",children:["global","national","regional"].map(_=>f.jsx("button",{onClick:()=>Re(N=>({...N,validateScope:_})),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-lg transition-colors ${C.validateScope===_?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-100 border border-slate-200"}`,children:_==="global"?l.scopeGlobal:_==="national"?l.scopeNational:l.scopeRegional},_))}),C.validateScope!=="global"&&f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("select",{value:C.validateBiome,onChange:_=>Re(N=>({...N,validateBiome:_.target.value})),className:"px-3 py-2 border border-emerald-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 outline-none bg-white",children:[f.jsx("option",{value:"",children:l.biome}),f.jsx("option",{value:"Amaznia",children:"Amaznia"}),f.jsx("option",{value:"Mata Atlntica",children:"Mata Atlntica"}),f.jsx("option",{value:"Cerrado",children:"Cerrado"}),f.jsx("option",{value:"Caatinga",children:"Caatinga"}),f.jsx("option",{value:"Pampa",children:"Pampa"}),f.jsx("option",{value:"Pantanal",children:"Pantanal"})]}),f.jsxs("select",{value:C.validateStateUF,onChange:_=>Re(N=>({...N,validateStateUF:_.target.value})),className:"px-3 py-2 border border-emerald-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 outline-none bg-white",children:[f.jsx("option",{value:"",children:l.stateUF}),f.jsx("option",{value:"AC",children:"Acre (AC)"}),f.jsx("option",{value:"AL",children:"Alagoas (AL)"}),f.jsx("option",{value:"AP",children:"Amap (AP)"}),f.jsx("option",{value:"AM",children:"Amazonas (AM)"}),f.jsx("option",{value:"BA",children:"Bahia (BA)"}),f.jsx("option",{value:"CE",children:"Cear (CE)"}),f.jsx("option",{value:"DF",children:"Distrito Federal (DF)"}),f.jsx("option",{value:"ES",children:"Esprito Santo (ES)"}),f.jsx("option",{value:"GO",children:"Gois (GO)"}),f.jsx("option",{value:"MA",children:"Maranho (MA)"}),f.jsx("option",{value:"MT",children:"Mato Grosso (MT)"}),f.jsx("option",{value:"MS",children:"Mato Grosso do Sul (MS)"}),f.jsx("option",{value:"MG",children:"Minas Gerais (MG)"}),f.jsx("option",{value:"PA",children:"Par (PA)"}),f.jsx("option",{value:"PB",children:"Paraba (PB)"}),f.jsx("option",{value:"PR",children:"Paran (PR)"}),f.jsx("option",{value:"PE",children:"Pernambuco (PE)"}),f.jsx("option",{value:"PI",children:"Piau (PI)"}),f.jsx("option",{value:"RJ",children:"Rio de Janeiro (RJ)"}),f.jsx("option",{value:"RN",children:"Rio Grande do Norte (RN)"}),f.jsx("option",{value:"RS",children:"Rio Grande do Sul (RS)"}),f.jsx("option",{value:"RO",children:"Rondnia (RO)"}),f.jsx("option",{value:"RR",children:"Roraima (RR)"}),f.jsx("option",{value:"SC",children:"Santa Catarina (SC)"}),f.jsx("option",{value:"SP",children:"So Paulo (SP)"}),f.jsx("option",{value:"SE",children:"Sergipe (SE)"}),f.jsx("option",{value:"TO",children:"Tocantins (TO)"})]})]})]})]})]}):null,H==="MERGE"&&f.jsxs("div",{className:"flex flex-col gap-4",children:[f.jsxs("div",{className:"text-center space-y-2 mb-2",children:[f.jsx("h4",{className:"font-bold text-slate-800 text-lg",children:l.mergeTitle}),f.jsx("p",{className:"text-slate-500 text-sm",children:l.mergeDesc})]}),f.jsx("div",{className:`border-2 border-dashed rounded-xl p-4 flex flex-col items-center justify-center transition-all ${Ve?"border-amber-500 bg-amber-50/30":"border-slate-300 hover:border-amber-400 bg-slate-50"}`,children:Ve?f.jsxs("div",{className:"flex flex-col items-center gap-2 w-full",children:[f.jsx($f,{size:32,className:"text-amber-600"}),f.jsx("span",{className:"font-bold text-slate-800 text-sm text-center",children:Ve.name||"Key 1"}),f.jsxs("span",{className:"text-xs text-slate-500",children:[((Fp=Ve.entities)==null?void 0:Fp.length)||0," ",l.entities,"  ",((Rp=Ve.features)==null?void 0:Rp.length)||0," ",l.features]}),f.jsx("button",{onClick:()=>dt(null),className:"text-xs text-red-500 hover:text-red-700 underline",children:l.remove})]}):f.jsxs("button",{onClick:()=>Np(1),className:"flex flex-col items-center gap-2 p-2 w-full",children:[f.jsx($i,{size:32,className:"text-slate-400"}),f.jsx("span",{className:"text-sm font-medium text-slate-600",children:l.uploadKey1})]})}),f.jsx("div",{className:`border-2 border-dashed rounded-xl p-4 flex flex-col items-center justify-center transition-all ${lt?"border-amber-500 bg-amber-50/30":"border-slate-300 hover:border-amber-400 bg-slate-50"}`,children:lt?f.jsxs("div",{className:"flex flex-col items-center gap-2 w-full",children:[f.jsx($f,{size:32,className:"text-amber-600"}),f.jsx("span",{className:"font-bold text-slate-800 text-sm text-center",children:lt.name||"Key 2"}),f.jsxs("span",{className:"text-xs text-slate-500",children:[((Pp=lt.entities)==null?void 0:Pp.length)||0," ",l.entities,"  ",((Mp=lt.features)==null?void 0:Mp.length)||0," ",l.features]}),f.jsx("button",{onClick:()=>rn(null),className:"text-xs text-red-500 hover:text-red-700 underline",children:l.remove})]}):f.jsxs("button",{onClick:()=>Np(2),className:"flex flex-col items-center gap-2 p-2 w-full",children:[f.jsx($i,{size:32,className:"text-slate-400"}),f.jsx("span",{className:"text-sm font-medium text-slate-600",children:l.uploadKey2})]})}),f.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-3",children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-2",children:l.mergeStrategy}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("button",{onClick:()=>_t("union"),className:`w-full p-3 rounded-lg border-2 text-left transition-all ${Ke==="union"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:[f.jsx("p",{className:"font-bold text-slate-800 text-sm",children:l.strategyUnion}),f.jsx("p",{className:"text-xs text-slate-500",children:l.strategyUnionDesc})]}),f.jsxs("button",{onClick:()=>_t("intersection"),className:`w-full p-3 rounded-lg border-2 text-left transition-all ${Ke==="intersection"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:[f.jsx("p",{className:"font-bold text-slate-800 text-sm",children:l.strategyIntersection}),f.jsx("p",{className:"text-xs text-slate-500",children:l.strategyIntersectionDesc})]}),f.jsxs("button",{onClick:()=>_t("primary"),className:`w-full p-3 rounded-lg border-2 text-left transition-all ${Ke==="primary"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:[f.jsx("p",{className:"font-bold text-slate-800 text-sm",children:l.strategyPrimary}),f.jsx("p",{className:"text-xs text-slate-500",children:l.strategyPrimaryDesc})]})]})]})]}),(H==="TOPIC"||H==="IMPORT")&&f.jsxs("div",{className:"pt-4 border-t border-slate-100 space-y-5",children:[f.jsxs("h5",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[f.jsx(Ym,{size:12})," ",l.configSettings]}),f.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase flex items-center gap-1",children:[f.jsx(QS,{size:14})," ",l.detailLevel]}),f.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-100 px-2 py-1 rounded",children:aT(y.detailLevel)})]}),f.jsx("input",{type:"range",min:"1",max:"3",step:"1",value:y.detailLevel,onChange:_=>E(N=>({...N,detailLevel:parseInt(_.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500 mb-2",disabled:w}),f.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 font-medium uppercase tracking-wide",children:[f.jsxs("span",{className:`flex flex-col items-center gap-1 ${y.detailLevel===1?"text-amber-600":""}`,children:[f.jsx(OS,{size:16})," Simple"]}),f.jsxs("span",{className:`flex flex-col items-center gap-1 ${y.detailLevel===2?"text-amber-600":""}`,children:[f.jsx(As,{size:16})," Bal."]}),f.jsxs("span",{className:`flex flex-col items-center gap-1 ${y.detailLevel===3?"text-amber-600":""}`,children:[f.jsx(JS,{size:16})," Expert"]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-2",children:l.featureFocus}),f.jsx("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:["general","reproductive","vegetative"].map(_=>f.jsx("button",{onClick:()=>E(N=>({...N,featureFocus:_})),className:`flex-1 py-2 rounded-md text-[10px] md:text-xs font-medium transition-all ${y.featureFocus===_?"bg-white text-amber-600 shadow-sm":"text-slate-500 hover:text-slate-800"}`,disabled:w,children:_==="general"?l.focusGeneral:_==="reproductive"?l.focusRepro:l.focusVeg},_))})]}),H==="TOPIC"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:l.numEntities}),f.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:y.count})]}),f.jsx("input",{type:"range",min:"3",max:"100",step:"1",value:y.count,onChange:_=>E(N=>({...N,count:parseInt(_.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500",disabled:w})]}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:l.numFeatures}),f.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:y.featureCount})]}),f.jsx("input",{type:"range",min:"2",max:"20",step:"1",value:y.featureCount,onChange:_=>E(N=>({...N,featureCount:parseInt(_.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500",disabled:w})]}),f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:l.requiredFeatures}),Gt.length>0&&f.jsxs("span",{className:"text-xs font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded",children:[Gt.length," ",l.selectedFeatures]})]}),f.jsxs("button",{type:"button",onClick:()=>xs(!Mi),className:"w-full px-3 py-2 text-left text-sm bg-white border border-slate-200 rounded-lg hover:border-amber-400 focus:outline-none focus:ring-2 focus:ring-amber-500/20 transition-colors flex items-center justify-between",disabled:w,children:[f.jsx("span",{className:Gt.length>0?"text-slate-700":"text-slate-400",children:Gt.length>0?Gt.slice(0,2).join(", ")+(Gt.length>2?` +${Gt.length-2}`:""):l.requiredFeaturesDesc}),f.jsx(du,{size:16,className:`text-slate-400 transition-transform ${Mi?"rotate-180":""}`})]}),Mi&&f.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-slate-200 rounded-lg shadow-xl max-h-64 overflow-y-auto custom-scrollbar",children:[f.jsx("div",{className:"sticky top-0 bg-white border-b p-2",children:f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",value:qt,onChange:_=>xn(_.target.value),placeholder:l.addCustomFeature,className:"flex-1 px-2 py-1.5 text-sm border border-slate-200 rounded focus:outline-none focus:border-amber-400",onKeyDown:_=>{_.key==="Enter"&&qt.trim()&&(Gt.includes(qt.trim())||Pi(N=>[...N,qt.trim()]),xn(""))}}),f.jsx("button",{type:"button",onClick:()=>{qt.trim()&&!Gt.includes(qt.trim())&&(Pi(_=>[..._,qt.trim()]),xn(""))},className:"px-2 py-1 bg-amber-500 text-white rounded text-xs font-medium hover:bg-amber-600",children:f.jsx(ko,{size:14})})]})}),Gt.length>0&&f.jsxs("div",{className:"p-2 border-b bg-emerald-50/50",children:[f.jsx("div",{className:"text-xs font-semibold text-emerald-700 mb-1.5 uppercase",children:n==="pt"?"Selecionadas":"Selected"}),f.jsx("div",{className:"flex flex-wrap gap-1",children:Gt.map((_,N)=>f.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-emerald-100 text-emerald-700 text-xs rounded-full",children:[_,f.jsx("button",{type:"button",onClick:()=>Pi(V=>V.filter(z=>z!==_)),className:"hover:text-red-500",children:f.jsx(er,{size:12})})]},N))})]}),gs.map((_,N)=>f.jsxs("div",{children:[f.jsx("div",{className:"px-3 py-1.5 bg-slate-50 text-xs font-semibold text-slate-500 uppercase sticky top-[52px]",children:_.category}),_.items.map((V,z)=>{const Q=Gt.includes(V);return f.jsxs("button",{type:"button",onClick:()=>{Pi(Q?se=>se.filter(K=>K!==V):se=>[...se,V])},className:`w-full px-3 py-2 text-left text-sm hover:bg-amber-50 flex items-center justify-between transition-colors ${Q?"bg-emerald-50 text-emerald-700":"text-slate-600"}`,children:[f.jsx("span",{children:V}),Q&&f.jsx(t0,{size:14,className:"text-emerald-500"})]},z)})]},N))]})]})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(ka,{size:16,className:"text-slate-400 group-hover:text-amber-500 transition-colors"}),f.jsx("span",{className:"text-sm font-medium text-slate-700",children:l.fetchSpeciesImg})]}),f.jsx("div",{className:`w-11 h-6 flex items-center rounded-full p-1 transition-colors ${y.includeSpeciesImages?"bg-amber-500":"bg-slate-300"}`,children:f.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${y.includeSpeciesImages?"translate-x-5":""}`})}),f.jsx("input",{type:"checkbox",className:"hidden",checked:y.includeSpeciesImages,onChange:_=>E(N=>({...N,includeSpeciesImages:_.target.checked})),disabled:w})]}),f.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Ym,{size:16,className:"text-slate-400 group-hover:text-amber-500 transition-colors"}),f.jsx("span",{className:"text-sm font-medium text-slate-700",children:l.fetchFeatureImg})]}),f.jsx("div",{className:`w-11 h-6 flex items-center rounded-full p-1 transition-colors ${y.includeFeatureImages?"bg-amber-500":"bg-slate-300"}`,children:f.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${y.includeFeatureImages?"translate-x-5":""}`})}),f.jsx("input",{type:"checkbox",className:"hidden",checked:y.includeFeatureImages,onChange:_=>E(N=>({...N,includeFeatureImages:_.target.checked})),disabled:w})]}),f.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(a0,{size:16,className:"text-slate-400 group-hover:text-amber-500 transition-colors"}),f.jsx("span",{className:"text-sm font-medium text-slate-700",children:l.fetchLinks})]}),f.jsx("div",{className:`w-11 h-6 flex items-center rounded-full p-1 transition-colors ${y.includeLinks?"bg-amber-500":"bg-slate-300"}`,children:f.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${y.includeLinks?"translate-x-5":""}`})}),f.jsx("input",{type:"checkbox",className:"hidden",checked:y.includeLinks,onChange:_=>E(N=>({...N,includeLinks:_.target.checked})),disabled:w})]})]})]}),w&&f.jsxs("div",{className:"bg-amber-50 text-amber-700 p-3 rounded-lg text-sm flex items-center justify-center gap-2",children:[f.jsx(Gf,{className:"animate-spin",size:16})," ",k||(H==="IMPORT"?l.analyzing:l.generating)]})]}),f.jsxs("div",{className:"p-4 bg-slate-50 border-t flex gap-3 shrink-0 safe-area-bottom",children:[f.jsx("button",{onClick:XE,className:"flex-none w-16 md:w-20 py-2.5 text-slate-600 font-medium hover:bg-slate-200 rounded-xl transition-colors text-center text-xs md:text-sm",children:l.cancel}),f.jsxs("button",{onClick:rT,className:"w-auto px-3 py-2 text-xs bg-white border border-slate-300 text-slate-700 font-bold rounded-xl hover:bg-slate-50 hover:border-amber-400 hover:text-amber-600 shadow-sm transition-all flex items-center justify-center gap-2",disabled:w||H==="TOPIC"&&!y.topic||H==="IMPORT"&&!q||H==="REFINE"&&h.entities.length===0||H==="MERGE"&&(!Ve||!lt),title:"View and edit the prompt before sending",children:[f.jsx(mc,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:"View/Edit Prompt"})]}),H==="REFINE"?f.jsxs("button",{onClick:tT,className:`flex-1 py-2.5 ${ae==="VALIDATE"?"bg-emerald-500 hover:bg-emerald-600 shadow-emerald-900/20":"bg-amber-500 hover:bg-amber-600 shadow-amber-900/20"} text-white font-bold rounded-xl shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 text-sm`,disabled:w||h.entities.length===0,children:[ae==="EXPAND"?l.actionExpand:ae==="REFINE"?l.actionRefine:ae==="CLEAN"?l.actionClean:ae==="VALIDATE"?l.actionValidate:l.actionPhotos," ",ae==="VALIDATE"?f.jsx(Qm,{size:16,className:"opacity-70"}):f.jsx(xc,{size:16,className:"opacity-70"})]}):H==="MERGE"?f.jsxs("button",{onClick:eT,className:"flex-1 py-2.5 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 text-sm",disabled:w||!Ve||!lt,children:[l.mergeAction," ",f.jsx(Hm,{size:16,className:"opacity-70"})]}):f.jsxs("button",{onClick:QE,className:"flex-1 py-2.5 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 text-sm",disabled:w||H==="TOPIC"&&!y.topic||H==="IMPORT"&&!q,children:[l.generate," ",f.jsx(Hf,{size:16,className:"opacity-70"})]})]})]})}),uf&&f.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-[60] flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col h-[80vh] max-h-[90vh] animate-in fade-in zoom-in-95 overflow-hidden",children:[f.jsxs("div",{className:"bg-slate-800 p-4 border-b border-slate-700 flex justify-between items-center text-white shrink-0",children:[f.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[f.jsx(mc,{size:18,className:"text-amber-400"}),"Prompt Editor"]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(vs),alert(l.promptCopied)},className:"flex items-center gap-1.5 px-3 py-1.5 text-xs hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",disabled:w,children:[f.jsx(zS,{size:12})," ",l.copyPrompt]}),f.jsx("button",{onClick:Ap,className:"text-slate-400 hover:text-white p-1",children:f.jsx(er,{size:20})})]})]}),f.jsxs("div",{className:"flex-1 p-2 bg-slate-100 min-h-0 flex flex-col gap-2",children:[F&&!w&&!R&&f.jsxs("div",{className:"bg-white rounded-xl p-4 border border-slate-200 shadow-sm",children:[f.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase mb-3 text-center",children:n==="pt"?"Modo de Importao":"Import Mode"}),f.jsxs("div",{className:"flex rounded-xl overflow-hidden border-2 border-slate-200",children:[f.jsxs("button",{onClick:()=>sa(!1),className:`flex-1 py-3 px-4 flex items-center justify-center gap-2 transition-all ${fr?"bg-white text-slate-500 hover:bg-slate-50":"bg-slate-800 text-white"}`,children:[f.jsx(Wo,{size:18}),f.jsxs("div",{className:"text-left",children:[f.jsx("div",{className:"font-bold text-sm",children:n==="pt"?"Fiel":"Faithful"}),f.jsx("div",{className:"text-[10px] opacity-70",children:n==="pt"?"Sem alteraes":"No changes"})]})]}),f.jsxs("button",{onClick:()=>sa(!0),className:`flex-1 py-3 px-4 flex items-center justify-center gap-2 transition-all ${fr?"bg-gradient-to-r from-amber-500 to-orange-500 text-white":"bg-white text-slate-500 hover:bg-slate-50"}`,children:[f.jsx(xc,{size:18}),f.jsxs("div",{className:"text-left",children:[f.jsx("div",{className:"font-bold text-sm",children:n==="pt"?"Otimizar":"Optimize"}),f.jsx("div",{className:"text-[10px] opacity-70",children:n==="pt"?"IA padroniza":"AI cleans"})]})]})]})]}),w||F||R||uo?f.jsx(e7,{ref:fo,language:n,isGenerating:w}):f.jsx("textarea",{value:vs,onChange:_=>fi(_.target.value),className:"w-full flex-1 p-4 bg-slate-900 text-slate-200 font-mono text-sm rounded-lg resize-none outline-none border-2 border-transparent focus:border-amber-500",spellCheck:"false"})]}),f.jsxs("div",{className:"p-4 border-t bg-slate-50 shrink-0 flex items-center justify-between gap-4",children:[w&&f.jsxs("div",{className:"flex items-center gap-2 text-amber-600",children:[f.jsxs("div",{className:"flex gap-1",children:[f.jsx("span",{className:"w-2 h-2 bg-amber-500 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),f.jsx("span",{className:"w-2 h-2 bg-amber-500 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),f.jsx("span",{className:"w-2 h-2 bg-amber-500 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),f.jsx("span",{className:"text-sm font-medium",children:n==="pt"?"IA processando...":"AI processing..."})]}),f.jsxs("div",{className:"flex items-center gap-4 ml-auto",children:[f.jsx("button",{onClick:Ap,className:"px-6 py-2 text-slate-600 font-medium hover:bg-slate-200 rounded-xl transition-colors",children:l.cancel}),R?f.jsxs("button",{onClick:()=>{x(R),G(null),O(null),Zt(!1),S(!1);const _=localStorage.getItem("nozesia_projects");let N=[];if(_)try{N=JSON.parse(_)}catch{}const V=[R,...N.filter(z=>z.id!==R.id)];localStorage.setItem("nozesia_projects",JSON.stringify(V)),o&&o(R),alert(n==="pt"?"Chave importada com sucesso!":"Key imported successfully!")},className:"px-6 py-2 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 flex items-center gap-2",children:[n==="pt"?"Confirmar Importao":"Confirm Import"," ",f.jsx(t0,{size:16})]}):F?f.jsx("button",{onClick:jE,className:"px-6 py-2 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 flex items-center gap-2",disabled:w,children:w?f.jsxs(f.Fragment,{children:[f.jsx(Gf,{className:"animate-spin",size:16})," ",n==="pt"?"Processando...":"Processing..."]}):f.jsxs(f.Fragment,{children:[fr?n==="pt"?"Otimizar e Importar":"Optimize & Import":n==="pt"?"Importar Chave":"Import Key"," ",f.jsx(Hf,{size:16})]})}):f.jsx("button",{onClick:nT,className:"px-6 py-2 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 flex items-center gap-2",disabled:w,children:w?f.jsxs(f.Fragment,{children:[f.jsx(Gf,{className:"animate-spin",size:16})," ",k||l.generating]}):f.jsx(f.Fragment,{children:l.generate})})]})]})]})}),X&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>he(null),children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full overflow-hidden animate-in fade-in zoom-in-95",onClick:_=>_.stopPropagation(),children:[f.jsxs("div",{className:"relative",children:[f.jsx("img",{src:X.url,alt:X.label,className:"w-full max-h-[60vh] object-contain bg-slate-100"}),f.jsx("button",{onClick:()=>he(null),className:"absolute top-3 right-3 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full transition-colors",children:f.jsx(er,{size:18})})]}),f.jsxs("div",{className:"p-4 bg-white",children:[f.jsx("h4",{className:"font-semibold text-slate-800",children:X.label}),f.jsx("p",{className:"text-sm text-slate-500",children:X.featureName})]})]})}),Ze&&wt&&Gr&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-6 animate-in fade-in zoom-in-95",children:[f.jsxs("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[f.jsx(zm,{className:"text-emerald-600",size:20}),n==="pt"?"Formato Detectado":"Format Detected"]}),f.jsx("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-4 mb-4",children:f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("span",{className:"text-2xl",children:""}),f.jsxs("div",{children:[f.jsx("p",{className:"font-semibold text-emerald-900",children:wt.description}),f.jsxs("p",{className:"text-sm text-emerald-700",children:[n==="pt"?"Confiana":"Confidence",": ",Math.round(wt.confidence*100),"%"]})]})]})}),wt.format==="linked_hub"&&f.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4",children:[f.jsx("p",{className:"text-sm text-amber-900 mb-2",children:f.jsxs("strong",{children:[" ",n==="pt"?"Chave com Mltiplas Referncias Detectada!":"Linked Key System Detected!"]})}),f.jsx("p",{className:"text-sm text-amber-800 mb-3",children:n==="pt"?"Esta chave referencia outras chaves (ex: Chave A, Chave B, etc). Para melhor experincia, recomendamos importar TODOS os arquivos relacionados.":"This key references other keys (e.g., Key A, Key B, etc). For best experience, we recommend importing ALL related files."}),f.jsxs("label",{className:"block",children:[f.jsxs("div",{className:"border-2 border-dashed border-amber-300 rounded-lg p-4 text-center hover:border-amber-400 hover:bg-amber-100 transition-colors cursor-pointer",children:[f.jsx($i,{className:"mx-auto mb-2 text-amber-600",size:32}),f.jsx("p",{className:"text-sm font-medium text-amber-900",children:n==="pt"?"Selecionar Mltiplos Arquivos":"Select Multiple Files"}),f.jsx("p",{className:"text-xs text-amber-700 mt-1",children:n==="pt"?"Use Ctrl/Cmd para selecionar vrios":"Use Ctrl/Cmd to select multiple"})]}),f.jsx("input",{type:"file",multiple:!0,accept:".xlsx,.xls,.csv",onChange:HE,className:"hidden"})]})]}),f.jsxs("div",{className:"space-y-2 mb-4",children:[f.jsxs("button",{onClick:async()=>{if(!y.model){alert(n==="pt"?"Configure a API Key primeiro":"Configure API Key first");return}Ie(!1),tn(!0);try{const _=await L1(y.model,Gr.data,Gr.fileName,n);x(_);const N=localStorage.getItem("nozesia_projects");let V=N?JSON.parse(N):[];V=[_,...V.filter(z=>z.id!==_.id)],localStorage.setItem("nozesia_projects",JSON.stringify(V)),o&&o(_)}catch{alert(n==="pt"?"Erro na converso":"Conversion error")}finally{tn(!1),Vr(null)}},className:"w-full py-3 bg-gradient-to-r from-amber-500 to-orange-500 text-white rounded-xl font-bold hover:from-amber-400 hover:to-orange-400 transition-all flex items-center justify-center gap-2",children:[f.jsx(As,{size:18}),n==="pt"?"Converter com IA (Somente este arquivo)":"Convert with AI (This file only)"]}),f.jsx("button",{onClick:()=>{Ie(!1),Vr(null)},className:"w-full py-3 bg-slate-100 text-slate-600 rounded-xl font-medium hover:bg-slate-200 transition-colors",children:n==="pt"?"Cancelar":"Cancel"})]})]})}),Kn&&Qt.length>0&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-3xl w-full p-6 animate-in fade-in zoom-in-95",children:[f.jsxs("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[f.jsx(Sh,{className:"text-emerald-600",size:20}),n==="pt"?"Importar Chaves Interligadas":"Import Linked Keys"]}),f.jsx("p",{className:"text-sm text-slate-600 mb-4",children:n==="pt"?`${Qt.length} arquivos selecionados. Escolha qual  a chave principal (hub):`:`${Qt.length} files selected. Choose which is the main key (hub):`}),f.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto mb-4 custom-scrollbar",children:Qt.map((_,N)=>f.jsxs("div",{className:"flex items-center gap-3 p-3 border border-slate-200 rounded-lg hover:border-emerald-300 hover:bg-emerald-50 transition-colors",children:[f.jsx("input",{type:"radio",name:"mainKey",id:`file-${N}`,defaultChecked:N===0,className:"w-4 h-4 text-emerald-600"}),f.jsxs("label",{htmlFor:`file-${N}`,className:"flex-1 cursor-pointer",children:[f.jsx("div",{className:"font-medium text-slate-800 text-sm",children:_.name}),f.jsxs("div",{className:"text-xs text-slate-500",children:[(_.size/1024).toFixed(1)," KB"]})]}),_.name.toLowerCase().includes("geral")&&f.jsx("span",{className:"text-xs bg-amber-100 text-amber-700 px-2 py-1 rounded-full font-medium",children:n==="pt"?"Sugerido":"Suggested"})]},N))}),f.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:f.jsxs("p",{className:"text-xs text-blue-900",children:[f.jsxs("strong",{children:[" ",n==="pt"?"Como funciona:":"How it works:"]}),f.jsx("br",{}),n==="pt"?"A IA ir processar cada chave e criar links automticos entre elas. A chave principal ser carregada no editor e as sub-chaves ficaro acessveis via navegao.":"AI will process each key and create automatic links between them. The main key will be loaded in the editor and sub-keys will be accessible via navigation."]})}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:()=>{const _=Array.from(document.querySelectorAll('input[name="mainKey"]')).findIndex(N=>N.checked);zE(Qt,_)},className:"flex-1 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-bold hover:from-emerald-400 hover:to-teal-400 transition-all flex items-center justify-center gap-2",children:[f.jsx(xc,{size:18}),n==="pt"?"Processar com IA":"Process with AI"]}),f.jsx("button",{onClick:()=>{ui(!1),mn([])},className:"px-6 py-3 bg-slate-100 text-slate-600 rounded-xl font-medium hover:bg-slate-200 transition-colors",children:n==="pt"?"Cancelar":"Cancel"})]})]})}),oe&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",children:[f.jsxs("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[f.jsx(Ma,{className:"text-emerald-600",size:20}),l.open]}),f.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto mb-4 custom-scrollbar",children:te.length===0?f.jsx("p",{className:"text-slate-500 text-sm text-center py-8 border-2 border-dashed border-slate-200 rounded-lg",children:l.noSaved}):te.map(_=>f.jsxs("button",{onClick:()=>sr(_),className:"w-full text-left p-3 hover:bg-emerald-50 rounded-lg border border-slate-100 hover:border-emerald-200 group transition-all",children:[f.jsx("div",{className:"font-medium text-slate-800 group-hover:text-emerald-700",children:_.name}),f.jsx("div",{className:"text-xs text-slate-400 truncate",children:_.description||"No description"})]},_.id))}),f.jsx("button",{onClick:()=>J(!1),className:"w-full py-2.5 bg-slate-100 text-slate-600 rounded-xl font-medium hover:bg-slate-200 transition-colors",children:l.close})]})})]})},O1=""+new URL("arvoretaPNG-DqiVvtoh.png",import.meta.url).href,s7=()=>{const[e,t]=ke.useState("HOME"),[r,n]=ke.useState(null),[i,s]=ke.useState("pt"),[a,o]=ke.useState([]),[c,l]=ke.useState(!1),[u,h]=ke.useState(!1),[m,x]=ke.useState(!1),[g,v]=ke.useState(!1),[y,E]=ke.useState("ABOUT"),[w,T]=ke.useState("gemini-1.5-flash-002"),[k,b]=ke.useState(""),[I,S]=ke.useState("gemini"),[B,D]=ke.useState({gemini:"",openai:"",claude:"",huggingface:""}),[H,Y]=ke.useState(!1);ke.useEffect(()=>{const F=localStorage.getItem("nozesia_settings");if(F)try{const O=JSON.parse(F);if(O.model){T(O.model);const X=A0(O.model);S(X)}if(O.apiKey&&!O.providerKeys&&(b(O.apiKey),D(X=>({...X,gemini:O.apiKey}))),O.providerKeys){D(O.providerKeys);const X=A0(O.model||"gemini-1.5-flash-002");b(O.providerKeys[X]||"")}O.selectedProvider&&S(O.selectedProvider)}catch{console.error("Failed to load settings")}},[]),ke.useEffect(()=>{if(e==="HOME"||e==="PLAYER"){const F=localStorage.getItem("nozesia_projects");if(F)try{o(JSON.parse(F))}catch{console.error("Failed to load local projects")}}},[e]);const q=()=>{const F=w.trim(),O={...B,[I]:k.trim()};D(O),localStorage.setItem("nozesia_settings",JSON.stringify({model:F,apiKey:k.trim(),providerKeys:O,selectedProvider:I})),h(!1)},ue=F=>{S(F),b(B[F]||"");const O=P1(F),X=O.find(he=>he.isRecommended);X?T(X.id):O.length>0&&T(O[0].id)},Te={id:"demo-1",name:"Exemplo: Grandes Felinos",description:"Identifique espcies comuns de grandes felinos.",features:[{id:"f1",name:"Padro da Pelagem",states:[{id:"s1",label:"Listras"},{id:"s2",label:"Manchas"},{id:"s3",label:"Liso"}]},{id:"f2",name:"Habitat",states:[{id:"s4",label:"Selva"},{id:"s5",label:"Savana"}]}],entities:[{id:"e1",name:"Tigre",description:"O maior dos felinos.",imageUrl:"https://picsum.photos/id/237/400/300",links:[],traits:{f1:["s1"],f2:["s4"]}},{id:"e2",name:"Leo",description:"O rei da selva.",imageUrl:"https://picsum.photos/id/1003/400/300",links:[],traits:{f1:["s3"],f2:["s5"]}},{id:"e3",name:"Leopardo",description:"Escalador especialista.",imageUrl:"https://picsum.photos/id/1074/400/300",links:[],traits:{f1:["s2"],f2:["s4","s5"]}}]},W={en:{subtitle:"v2.1 Tropical",tagline:"Biological Identification AI",desc:"Create and share professional matrix identification keys. Powered by Gemini AI for instant taxonomy generation.",createNew:"Create / Edit Key",openSaved:"Open Saved",importJson:"Import Project",demo:"Try Demo",savedProj:"Saved Projects",close:"Close",noSaved:"No saved projects found.",invalid:"Invalid project file.",settings:"Settings",aiModel:"AI Model",apiKey:"Gemini API Key",getKey:"Get Key",save:"Save",apiKeyNotice:"Your API Key is stored locally in your browser and used only to communicate with Google.",help:"About & Help",helpContent:{intro:"NOZES is an intelligent platform for creating and using matrix identification keys, designed for biologists, students, and nature enthusiasts.",step1Title:"1. NUTS AI Wizard",step1Desc:"Use the 'Nuts AI' button in the builder to automatically generate a key. You can describe a topic (e.g., 'Brazilian Cerrado Trees') OR upload a PDF/Image reference. The AI will study the material and create species, features, and the scoring matrix for you.",step2Title:"2. The Builder",step2Desc:"Refine your key manually. You can add new features, upload images for species, and adjust the matrix relationships between taxa and traits. Use the 'Export Project' button to save your work as a JSON file, which is essential for backups.",step3Title:"3. The Player",step3Desc:"This is the end-user view. Select observed features to filter down the list of species until you identify your specimen.",importExportTitle:"4. Import & Export",importExportDesc:"Always save your work by clicking 'Export Project'. This downloads a .json file. To resume work later or on another device, use 'Import Project' and select that file. You can also export to Excel (XLSX) for spreadsheets.",htmlExportTitle:"5. HTML Export",htmlExportDesc:"Export your key as a standalone HTML file that works offline! Click 'HTML' in the builder to generate a complete, self-contained webpage with all images embedded. Perfect for sharing with colleagues, publishing on websites, or using in field work without internet. The exported file includes the full Player interface with all filtering functionality.",aiToolsTitle:"6. Expand, Refine & Combine",aiToolsDesc:"Use the 'Expand/Refine' tab in the AI modal to enhance your keys: EXPAND adds new species to an existing list; REFINE improves descriptions and fills gaps; PHOTOS automatically searches for images; VALIDATE checks names against taxonomic catalogs. You can also MERGE keys by importing a new JSON, combining species from multiple projects into one.",warningTitle:" Important Warning",warningDesc:"AI-generated data may contain inaccuracies, outdated names, or incorrect trait assignments. ALWAYS review and verify all information before using or distributing identification keys. Cross-check scientific names with official catalogs (Flora do Brasil, GBIF, POWO) and validate geographic distributions. The user assumes full responsibility for the accuracy of the final content."}},pt:{subtitle:"v2.1 Tropical",tagline:"Inteligncia para Identificao Biolgica",desc:"Crie e compartilhe chaves de identificao matriciais profissionais. Poder da Gemini AI para gerao instantnea de taxonomia.",createNew:"Criar / Editar Chave",openSaved:"Abrir Chave",importJson:"Importar Projeto",demo:"Ver Demo",savedProj:"Projetos Salvos",close:"Fechar",noSaved:"Nenhum projeto salvo.",invalid:"Arquivo invlido.",settings:"Configuraes",aiModel:"Modelo IA",apiKey:"Chave API Gemini",getKey:"Obter Chave",save:"Salvar",apiKeyNotice:"Sua API Key  salva localmente no navegador e usada apenas para comunicar com o Google.",help:"Sobre e Ajuda",helpContent:{intro:"O NOZES  uma plataforma inteligente para criao e uso de chaves de identificao matriciais, projetada para bilogos, estudantes e entusiastas da natureza.",step1Title:"1. Assistente Nozes IA",step1Desc:"Use o boto 'Nozes IA' no construtor para gerar uma chave automaticamente. Voc pode descrever um tpico (ex: 'rvores do Cerrado') OU fazer upload de um PDF/Imagem de referncia. A IA estudar o material e criar espcies, caractersticas e a matriz para voc.",step2Title:"2. O Construtor",step2Desc:"Refine sua chave manualmente. Adicione novas caractersticas, insira imagens e ajuste a matriz. Use o boto 'Exportar Projeto' para salvar seu trabalho em arquivo JSON (backup essencial).",step3Title:"3. O Player",step3Desc:"Esta  a viso do usurio final. Selecione as caractersticas observadas para filtrar a lista de espcies at identificar seu espcime.",importExportTitle:"4. Importar & Exportar",importExportDesc:"Sempre salve seu trabalho clicando em 'Exportar Projeto'. Isso baixa um arquivo .json. Para continuar depois ou em outro dispositivo, use 'Importar Projeto' e selecione esse arquivo. Voc tambm pode exportar para Excel (XLSX).",htmlExportTitle:"5. Exportao HTML",htmlExportDesc:"Exporte sua chave como um arquivo HTML autnomo que funciona offline! Clique em 'HTML' no construtor para gerar uma pgina web completa e independente com todas as imagens embutidas. Perfeito para compartilhar com colegas, publicar em sites ou usar em trabalho de campo sem internet. O arquivo exportado inclui a interface completa do Player com toda a funcionalidade de filtragem.",aiToolsTitle:"6. Expandir, Refinar & Combinar",aiToolsDesc:"Use a aba 'Expandir/Refinar' no modal de IA para aprimorar suas chaves: EXPANDIR adiciona novas espcies a uma lista existente; REFINAR melhora descries e preenche lacunas; FOTOS busca imagens automaticamente; VALIDAR confere nomes com catlogos taxonmicos. Voc tambm pode COMBINAR chaves importando um novo JSON, mesclando espcies de mltiplos projetos em um s.",warningTitle:" Aviso Importante",warningDesc:"Dados gerados por IA podem conter imprecises, nomes desatualizados ou atribuies incorretas de caractersticas. SEMPRE revise e verifique todas as informaes antes de usar ou distribuir chaves de identificao. Confira nomes cientficos em catlogos oficiais (Flora do Brasil, GBIF, POWO) e valide distribuies geogrficas. O usurio assume total responsabilidade pela preciso do contedo final."}}}[i],te=()=>{Y(!1),n(null),t("BUILDER")},ge=()=>{Y(!0),n(null),t("BUILDER")},oe=()=>{n(Te),t("PLAYER")},J=F=>{const O=localStorage.getItem("nozesia_projects");let X=[];if(O)try{X=JSON.parse(O)}catch(ae){console.error("Failed to parse projects",ae)}const he=[F,...X.filter(ae=>ae.id!==F.id)];localStorage.setItem("nozesia_projects",JSON.stringify(he)),o(he),n(F),t("PLAYER")},de=F=>{n(F),t("PLAYER"),l(!1)},Z=F=>{const O=new FileReader;F.target.files&&F.target.files[0]&&(O.readAsText(F.target.files[0],"UTF-8"),O.onload=X=>{var he;try{const ae=JSON.parse((he=X.target)==null?void 0:he.result);ae.name&&ae.features&&ae.entities?(n(ae),t("PLAYER")):alert(W.invalid)}catch{alert(W.invalid)}})},R=()=>u&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full overflow-hidden animate-in fade-in zoom-in-95 max-h-[90vh] flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-center p-6 border-b bg-gradient-to-r from-emerald-600 to-teal-600 text-white",children:[f.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[f.jsx(Xm,{size:20}),W.settings]}),f.jsx("button",{onClick:()=>h(!1),className:"text-white/80 hover:text-white p-2 rounded-lg hover:bg-white/10 transition-colors",children:f.jsx(er,{size:24})})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-5",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-3",children:i==="pt"?"Provedor de IA":"AI Provider"}),f.jsx("div",{className:"grid grid-cols-4 gap-2",children:["gemini","openai","claude","huggingface"].map(F=>f.jsxs("button",{onClick:()=>ue(F),className:`flex flex-col items-center gap-1 p-3 rounded-xl text-sm font-medium transition-all border-2 ${I===F?"border-emerald-500 bg-emerald-50 text-emerald-700 shadow-md":"border-slate-200 bg-white text-slate-600 hover:border-slate-300 hover:bg-slate-50"}`,title:F==="huggingface"?i==="pt"?"Requer servidor proxy (limitao CORS)":"Requires proxy server (CORS limitation)":"",children:[f.jsx("span",{className:"text-xl",children:Ao[F].icon}),f.jsx("span",{className:"text-xs truncate w-full text-center",children:F==="huggingface"?"HuggingFace":Ao[F].name.split(" ")[0]}),B[F]&&f.jsx("span",{className:"text-[10px] text-emerald-600 font-bold",children:" API Key"}),F==="huggingface"&&f.jsx("span",{className:"text-[9px] text-amber-600 font-bold",children:" Proxy"})]},F))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:W.aiModel}),f.jsxs("div",{className:"relative",children:[f.jsx("select",{value:w,onChange:F=>T(F.target.value),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none appearance-none bg-white text-sm font-medium pr-10",children:P1(I).map(F=>f.jsxs("option",{value:F.id,children:[F.isRecommended?" ":"",F.name,F.contextWindow?` (${LU(F.contextWindow)})`:""]},F.id))}),f.jsx(du,{className:"absolute right-3 top-3.5 text-slate-400 pointer-events-none",size:18})]}),(()=>{const F=wp.find(O=>O.id===w);return(F==null?void 0:F.description)&&f.jsxs("p",{className:"text-xs text-slate-500 mt-2 px-1 flex items-center gap-1",children:[f.jsx(i0,{size:12,className:"shrink-0"}),F.description]})})()]}),f.jsxs("div",{children:[f.jsx("div",{className:"flex justify-between items-center mb-2",children:f.jsxs("label",{className:"block text-sm font-semibold text-slate-700",children:[W.apiKey," (",Ao[I].name,")"]})}),f.jsxs("div",{className:"relative",children:[f.jsx(s0,{className:"absolute left-3 top-3 text-slate-400",size:16}),f.jsx("input",{type:"password",value:k,onChange:F=>b(F.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none text-sm",placeholder:I==="gemini"?"AIzaSy...":I==="openai"?"sk-...":I==="claude"?"sk-ant-...":"hf_..."})]}),f.jsxs("a",{href:Ao[I].apiKeyUrl,target:"_blank",rel:"noopener noreferrer",className:"mt-3 flex items-center justify-center gap-2 w-full py-2.5 bg-gradient-to-r from-slate-700 to-slate-800 text-white rounded-lg font-bold text-sm hover:from-slate-800 hover:to-slate-900 transition-all shadow-md hover:shadow-lg",children:[f.jsx(Sa,{size:14}),W.getKey," - ",Ao[I].name]})]}),f.jsx("div",{className:"bg-amber-50 p-3 rounded-lg border border-amber-100",children:f.jsx("p",{className:"text-xs text-amber-700",children:W.apiKeyNotice})})]}),f.jsx("div",{className:"p-6 border-t bg-slate-50",children:f.jsxs("button",{onClick:q,className:"w-full py-3 bg-emerald-600 text-white rounded-xl font-bold hover:bg-emerald-500 transition-colors flex items-center justify-center gap-2 shadow-lg shadow-emerald-900/20",children:[f.jsx(pu,{size:16})," ",W.save]})})]})}),G=()=>c&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[f.jsx(Ma,{className:"text-emerald-600",size:20}),W.openSaved]}),f.jsx("button",{onClick:()=>l(!1),className:"text-slate-400 hover:text-slate-600 p-1",children:f.jsx(er,{size:20})})]}),f.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto mb-4 custom-scrollbar",children:a.length===0?f.jsx("p",{className:"text-slate-500 text-sm text-center py-8 border-2 border-dashed border-slate-200 rounded-lg",children:W.noSaved}):a.map(F=>f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:O=>{if(O.stopPropagation(),confirm(i==="pt"?`Excluir "${F.name}"?`:`Delete "${F.name}"?`)){const X=a.filter(he=>he.id!==F.id);o(X),localStorage.setItem("nozesia_projects",JSON.stringify(X))}},className:"p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors shrink-0",title:i==="pt"?"Excluir":"Delete",children:f.jsx(_s,{size:16})}),f.jsxs("button",{onClick:()=>de(F),className:"flex-1 text-left p-3 hover:bg-emerald-50 rounded-lg border border-slate-100 hover:border-emerald-200 group transition-all min-w-0",children:[f.jsx("div",{className:"font-medium text-slate-800 group-hover:text-emerald-700 truncate",children:F.name}),f.jsx("div",{className:"text-xs text-slate-400 truncate",children:F.description||(i==="pt"?"Sem descrio":"No description")})]})]},F.id))}),f.jsx("button",{onClick:()=>l(!1),className:"w-full py-3 bg-slate-100 text-slate-600 rounded-xl font-medium hover:bg-slate-200 transition-colors",children:W.close})]})});return e==="PLAYER"&&r?f.jsxs(f.Fragment,{children:[f.jsx(o5,{project:r,onBack:()=>t("HOME"),language:i,onOpenSaved:()=>l(!0),onEditKey:()=>t("BUILDER")}),R(),G()]}):e==="BUILDER"?f.jsxs(f.Fragment,{children:[f.jsx(i7,{initialProject:r,onSave:J,onCancel:()=>t("HOME"),language:i,defaultModel:w,apiKey:k,openAiModalOnMount:H,onOpenSettings:F=>{x(F||!1),h(!0)},onProjectImported:F=>{o(O=>[F,...O.filter(X=>X.id!==F.id)])}}),R()]}):f.jsxs("div",{className:"min-h-screen bg-[#0f2e24] flex items-center justify-center p-4 md:p-6 relative overflow-hidden font-sans",children:[f.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden pointer-events-none",children:[f.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[400px] md:w-[600px] h-[400px] md:h-[600px] bg-emerald-600/20 rounded-full blur-[80px] md:blur-[120px]"}),f.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[300px] md:w-[500px] h-[300px] md:h-[500px] bg-teal-500/20 rounded-full blur-[80px] md:blur-[100px]"}),f.jsx(hu,{className:"absolute top-[10%] right-[15%] text-emerald-800/20 w-20 h-20 md:w-32 md:h-32 rotate-12"}),f.jsx(ek,{className:"absolute bottom-[20%] left-[10%] text-emerald-800/20 w-32 h-32 md:w-48 md:h-48 -rotate-12"})]}),f.jsxs("div",{className:"max-w-6xl w-full grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12 items-center z-10",children:[f.jsxs("div",{className:"text-white space-y-6 md:space-y-8",children:[f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsx("div",{className:"inline-flex items-center gap-2 bg-emerald-900/50 text-emerald-300 px-3 py-1 rounded-full text-[10px] md:text-xs font-semibold tracking-wider uppercase border border-emerald-500/30 backdrop-blur-sm",children:W.subtitle}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("div",{className:"flex bg-emerald-900/50 rounded-lg p-1 border border-emerald-500/30 backdrop-blur-sm",children:[f.jsx("button",{onClick:()=>s("pt"),className:`px-3 py-1 rounded text-xs font-bold transition-colors ${i==="pt"?"bg-emerald-500 text-white":"text-emerald-400 hover:text-white"}`,children:"PT"}),f.jsx("button",{onClick:()=>s("en"),className:`px-3 py-1 rounded text-xs font-bold transition-colors ${i==="en"?"bg-emerald-500 text-white":"text-emerald-400 hover:text-white"}`,children:"EN"})]}),f.jsx("button",{onClick:()=>v(!0),className:"bg-emerald-900/50 rounded-lg p-1.5 border border-emerald-500/30 backdrop-blur-sm text-emerald-400 hover:text-white hover:bg-emerald-800/50 transition-colors",title:W.help,children:f.jsx(HS,{size:20})}),f.jsx("button",{onClick:()=>h(!0),className:`bg-emerald-900/50 rounded-lg p-1.5 border backdrop-blur-sm transition-colors ${k?"border-emerald-500/30 text-emerald-400 hover:text-white hover:bg-emerald-800/50":"border-amber-500 text-amber-500 animate-pulse"}`,title:W.settings,children:f.jsx(Xm,{size:20})})]})]}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-3 md:gap-4 mb-2",children:[f.jsx("div",{className:"bg-amber-800/20 p-2 md:p-3 rounded-2xl border-2 border-amber-600/30 backdrop-blur-md shadow-[0_0_30px_rgba(217,119,6,0.2)]",children:f.jsx(As,{className:"text-amber-500 w-12 h-12 md:w-20 md:h-20",strokeWidth:1.5})}),f.jsx("h1",{className:"text-5xl md:text-7xl font-black tracking-tight leading-none text-transparent bg-clip-text bg-gradient-to-br from-amber-300 via-amber-500 to-orange-400 drop-shadow-sm",children:"NOZES"})]}),f.jsx("h2",{className:"text-lg md:text-2xl text-emerald-100/80 font-light pl-2",children:W.tagline})]}),f.jsx("p",{className:"text-slate-300 text-base md:text-lg leading-relaxed max-w-lg border-l-4 border-amber-500/50 pl-4 md:pl-6",children:W.desc}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 md:gap-4 pt-2",children:[f.jsxs("button",{onClick:ge,className:"col-span-1 sm:col-span-2 flex items-center justify-center gap-3 px-8 py-4 bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-400 hover:to-orange-400 text-white rounded-xl font-bold transition-all shadow-xl shadow-amber-900/50 hover:scale-[1.02] text-lg border-t border-amber-300/30 active:scale-95 animate-pulse hover:animate-none",children:[f.jsx(As,{className:"w-6 h-6"}),i==="pt"?"Nozes IA":"NUTS AI"]}),f.jsxs("button",{onClick:te,className:"col-span-1 sm:col-span-2 flex items-center justify-center gap-3 px-8 py-4 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white rounded-xl font-bold transition-all shadow-xl shadow-emerald-900/50 hover:scale-[1.02] text-lg border-t border-emerald-400/20 active:scale-95",children:[f.jsx(qm,{className:"w-5 h-5"}),W.createNew]}),f.jsxs("button",{onClick:()=>l(!0),className:"flex items-center justify-center gap-2 px-6 py-3 bg-emerald-900/40 hover:bg-emerald-800/40 text-emerald-100 rounded-xl font-medium transition-all border border-emerald-500/20 hover:border-emerald-500/50 backdrop-blur-sm active:scale-95",children:[f.jsx(Ma,{className:"w-4 h-4"}),W.openSaved]}),f.jsxs("label",{className:"flex items-center justify-center gap-2 px-6 py-3 bg-emerald-900/40 hover:bg-emerald-800/40 text-emerald-100 rounded-xl font-medium transition-all border border-emerald-500/20 hover:border-emerald-500/50 backdrop-blur-sm cursor-pointer active:scale-95",children:[f.jsx($i,{className:"w-4 h-4"}),W.importJson,f.jsx("input",{type:"file",accept:".json",onChange:Z,className:"hidden"})]}),f.jsxs("button",{onClick:oe,className:"col-span-1 sm:col-span-2 mt-2 text-sm text-emerald-400 hover:text-emerald-200 flex items-center justify-center gap-2 font-medium py-2",children:[f.jsx(o0,{className:"w-3 h-3"}),W.demo]})]})]}),f.jsxs("div",{className:"relative hidden lg:block space-y-4 transform perspective-1000 hover:rotate-y-2 transition-transform duration-700",children:[f.jsxs("a",{href:"https://arvoreta.web.app",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-white/5 hover:bg-white/10 rounded-xl border border-white/10 transition-all group active:scale-95 backdrop-blur-sm",children:[f.jsx("div",{className:"w-10 h-10 bg-white/10 rounded-lg p-1 group-hover:bg-white/20 transition-colors shrink-0",children:f.jsx("img",{src:O1,alt:"Arvoreta",className:"w-full h-full object-contain"})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"text-[10px] font-bold text-emerald-400 uppercase tracking-tighter mb-0.5",children:"Ecossistema Digital"}),f.jsx("div",{className:"text-[11px] font-bold text-white leading-tight mb-1",children:"Acesse cursos e aplicativos poderosos para Identificao Botnica, Inventrio Florestal e Anlise Ambiental..."}),f.jsx("div",{className:"text-sm font-black text-white truncate",children:"Arvoreta"})]}),f.jsx(Sa,{size:14,className:"text-white/30 group-hover:text-white"})]}),f.jsxs("div",{className:"relative bg-gradient-to-br from-emerald-900/80 to-teal-900/80 backdrop-blur-md border border-emerald-500/20 p-8 rounded-3xl shadow-2xl",children:[f.jsx("div",{className:"absolute -top-10 -right-10 text-emerald-400/10",children:f.jsx(qS,{size:200})}),f.jsxs("div",{className:"flex items-center gap-3 mb-8 border-b border-emerald-500/20 pb-6",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-red-400/80"}),f.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-400/80"}),f.jsx("div",{className:"w-3 h-3 rounded-full bg-green-400/80"}),f.jsx("div",{className:"ml-auto text-xs text-amber-500/80 font-mono tracking-widest font-bold",children:"NOZES.IA-v2"})]}),f.jsx("div",{className:"space-y-6 opacity-90",children:f.jsxs("div",{className:"flex gap-6",children:[f.jsxs("div",{className:"w-1/3 space-y-3",children:[f.jsx("div",{className:"h-2 bg-emerald-700/50 rounded w-1/2 mb-4"}),f.jsxs("div",{className:"h-10 bg-emerald-500/20 border-l-2 border-emerald-400 rounded-r flex items-center px-3 text-emerald-200 text-xs gap-2",children:[f.jsx(hu,{size:12})," Folhas"]}),f.jsx("div",{className:"h-10 bg-emerald-900/30 rounded flex items-center px-3 text-emerald-600/50 text-xs",children:"Flores"}),f.jsx("div",{className:"h-10 bg-emerald-900/30 rounded flex items-center px-3 text-emerald-600/50 text-xs",children:"Caule"})]}),f.jsx("div",{className:"w-2/3 grid grid-cols-2 gap-3",children:[1,2,3,4].map(F=>f.jsxs("div",{className:"bg-emerald-950/50 rounded-lg p-3 border border-emerald-500/10 flex flex-col gap-2",children:[f.jsx("div",{className:"aspect-video bg-emerald-900/50 rounded flex items-center justify-center",children:f.jsx($S,{className:"text-emerald-700/50",size:20})}),f.jsx("div",{className:"h-1.5 bg-emerald-800/50 rounded w-3/4"}),f.jsx("div",{className:"h-1.5 bg-emerald-800/30 rounded w-1/2"})]},F))})]})}),f.jsxs("div",{className:"mt-8 pt-6 border-t border-emerald-500/20 flex justify-between items-center text-emerald-400/40 text-xs",children:[f.jsx("span",{children:"Gemini 2.5 Flash Integrated"}),f.jsx("span",{children:"100% Client-Side"})]})]})]})]}),R(),g&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-0 overflow-hidden animate-in fade-in zoom-in-95 flex flex-col max-h-[85vh]",children:[f.jsxs("div",{className:"p-4 md:p-6 border-b flex justify-between items-center bg-slate-50",children:[f.jsxs("div",{className:"flex gap-4 items-center",children:[f.jsxs("h3",{className:"text-lg md:text-xl font-bold text-slate-800 flex items-center gap-2",children:[f.jsx(i0,{className:"text-emerald-600",size:24}),W.help]}),f.jsxs("div",{className:"flex bg-slate-200/50 p-1 rounded-lg",children:[f.jsx("button",{onClick:()=>E("ABOUT"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${y==="ABOUT"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Sobre"}),f.jsx("button",{onClick:()=>E("HELP"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${y==="HELP"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Ajuda"})]})]}),f.jsx("button",{onClick:()=>v(!1),className:"text-slate-400 hover:text-slate-600 p-2",children:f.jsx(er,{size:24})})]}),f.jsx("div",{className:"p-4 md:p-6 overflow-y-auto custom-scrollbar space-y-6 md:space-y-8",children:y==="ABOUT"?f.jsxs(f.Fragment,{children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:" Sobre o Criador"}),f.jsxs("div",{className:"creator-info space-y-4 text-slate-700",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-xl font-semibold text-emerald-700",children:"Diogo Bueno Kanoute"}),f.jsx("p",{className:"font-medium",children:"Parabotnico e Dendrlogo em Inventrio Florestal"}),f.jsx("p",{className:"text-sm md:text-base mt-2",children:"Desenvolvedor especializado em Tecnologias de Inteligncia Artificial e Banco de Dados para Inventrio Florestal, Ecologia, Botnica, Dendrometria e Dendrologia."})]}),f.jsx("h4",{className:"text-lg font-bold text-slate-800 mt-8 border-t pt-4",children:" Links e Contatos"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"bg-gradient-to-br from-emerald-600 to-teal-700 p-4 rounded-xl border border-emerald-500 shadow-lg hover:shadow-emerald-900/20 transition-all col-span-full group",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-lg p-1 backdrop-blur-md",children:f.jsx("img",{src:O1,alt:"Arvoreta",className:"w-full h-full object-contain"})}),f.jsx("strong",{className:"block text-sm text-emerald-100 font-bold uppercase tracking-wider",children:"Ecossistema Digital"})]}),f.jsx(Sa,{size:16,className:"text-white/50 group-hover:text-white transition-colors"})]}),f.jsx("h3",{className:"text-xl font-black text-white mb-1",children:"Arvoreta"}),f.jsx("p",{className:"text-emerald-100/90 text-xs font-bold leading-relaxed mb-2 italic",children:"Acesse cursos e aplicativos poderosos para Identificao Botnica, Inventrio Florestal e Anlise Ambiental assistida por Inteligncia Artificial"}),f.jsx("p",{className:"text-emerald-50 text-sm leading-relaxed mb-3",children:"Cursos e Apps para Botnica, Inventrio Florestal e Anlise Ambiental."}),f.jsx("a",{href:"https://arvoreta.web.app",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/20 text-white border border-white/20 rounded-lg text-sm font-bold backdrop-blur-sm transition-all",children:"arvoreta.web.app"})]}),f.jsxs("div",{className:"bg-slate-800 p-3 rounded-lg border border-slate-700 hover:border-emerald-400 transition-colors col-span-full",children:[f.jsx("strong",{className:"block text-sm text-emerald-400 mb-1",children:" Projeto no GitHub"}),f.jsxs("a",{href:"https://github.com/DJHanDoom/Nozes",target:"_blank",rel:"noopener noreferrer",className:"text-white hover:text-emerald-300 font-medium flex items-center gap-2",children:["github.com/DJHanDoom/Nozes",f.jsx(Sa,{size:14})]})]}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[f.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:"Identificao Botnica"}),f.jsx("a",{href:"https://go.hotmart.com/G103222293V",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"Curso Online na Hotmart"})]}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[f.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" Fototeca DBK no SPLink"}),f.jsx("a",{href:"https://specieslink.net/col/FDBK",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"specieslink.net/col/FDBK"})]}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[f.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" Instagram Cientfico"}),f.jsx("a",{href:"https://instagram.com/fotografandomato",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"@fotografandomato"})]}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[f.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" Biblioteca Botnica"}),f.jsx("a",{href:"https://drive.google.com/drive/folders/0B4wGMi_KVTvOWm51UzNnNVJjaEk?resourcekey=0-8e69zvcLn2zMXuphNmC56A&usp=drive_link",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"PDFs e Material de Referncia"})]}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[f.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" E-mail"}),f.jsx("a",{href:"mailto:diogokanoute@gmail.com",className:"text-emerald-600 hover:underline font-medium",children:"diogokanoute@gmail.com"})]}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[f.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" WhatsApp Cientfico"}),f.jsx("a",{href:"https://wa.me/5521998501623",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"+55 21 998501623"})]})]}),f.jsx("p",{className:"text-sm text-slate-500 italic mt-6 bg-amber-50 p-4 rounded-lg border border-amber-100",children:"Entre em contato para dvidas sobre o app, cursos de Identificao Botnica, tecnologias de IA aplicadas  Dendrologia ou servios de Inventrio Florestal (Mata Atlntica, Cerrado, Amaznia e Caatinga)."})]})]}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"bg-emerald-50 p-4 rounded-xl border border-emerald-100 text-slate-700 leading-relaxed text-sm md:text-base",children:W.helpContent.intro}),f.jsxs("div",{className:"grid gap-6",children:[f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"bg-amber-100 p-3 rounded-full h-fit text-amber-600 shrink-0",children:f.jsx(As,{size:24})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:W.helpContent.step1Title}),f.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:W.helpContent.step1Desc})]})]}),f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"bg-blue-100 p-3 rounded-full h-fit text-blue-600 shrink-0",children:f.jsx(qm,{size:24})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:W.helpContent.step2Title}),f.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:W.helpContent.step2Desc})]})]}),f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"bg-emerald-100 p-3 rounded-full h-fit text-emerald-600 shrink-0",children:f.jsx(o0,{size:24})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:W.helpContent.step3Title}),f.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:W.helpContent.step3Desc})]})]}),f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"bg-purple-100 p-3 rounded-full h-fit text-purple-600 shrink-0",children:f.jsx(pu,{size:24})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:W.helpContent.importExportTitle}),f.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:W.helpContent.importExportDesc})]})]}),f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"bg-rose-100 p-3 rounded-full h-fit text-rose-600 shrink-0",children:f.jsx(Wo,{size:24})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:W.helpContent.htmlExportTitle}),f.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:W.helpContent.htmlExportDesc})]})]}),f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"bg-indigo-100 p-3 rounded-full h-fit text-indigo-600 shrink-0",children:f.jsx(Sh,{size:24})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:W.helpContent.aiToolsTitle}),f.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:W.helpContent.aiToolsDesc})]})]}),f.jsx("div",{className:"mt-6 bg-amber-50 border-2 border-amber-300 rounded-xl p-4",children:f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"bg-amber-200 p-3 rounded-full h-fit text-amber-700 shrink-0",children:f.jsx(ik,{size:24})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-amber-800 text-base md:text-lg mb-1",children:W.helpContent.warningTitle}),f.jsx("p",{className:"text-amber-700 text-xs md:text-sm leading-relaxed",children:W.helpContent.warningDesc})]})]})})]})]})}),f.jsx("div",{className:"p-4 bg-slate-50 border-t",children:f.jsx("button",{onClick:()=>v(!1),className:"w-full py-3 bg-emerald-600 text-white rounded-xl font-bold hover:bg-emerald-500 transition-colors",children:W.close})})]})}),G()]})},UE=document.getElementById("root");if(!UE)throw new Error("Could not find root element to mount to");const a7=ld.createRoot(UE);a7.render(f.jsx(ws.StrictMode,{children:f.jsx(s7,{})}));

(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Ny(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Wm={exports:{}},uu={},Jm={exports:{}},$e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var po=Symbol.for("react.element"),Ay=Symbol.for("react.portal"),Iy=Symbol.for("react.fragment"),Ry=Symbol.for("react.strict_mode"),ky=Symbol.for("react.profiler"),by=Symbol.for("react.provider"),Fy=Symbol.for("react.context"),Py=Symbol.for("react.forward_ref"),My=Symbol.for("react.suspense"),Dy=Symbol.for("react.memo"),Ly=Symbol.for("react.lazy"),p0=Symbol.iterator;function Oy(e){return e===null||typeof e!="object"?null:(e=p0&&e[p0]||e["@@iterator"],typeof e=="function"?e:null)}var Ym={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Km=Object.assign,Xm={};function Ws(e,t,n){this.props=e,this.context=t,this.refs=Xm,this.updater=n||Ym}Ws.prototype.isReactComponent={};Ws.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ws.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Qm(){}Qm.prototype=Ws.prototype;function Ld(e,t,n){this.props=e,this.context=t,this.refs=Xm,this.updater=n||Ym}var Od=Ld.prototype=new Qm;Od.constructor=Ld;Km(Od,Ws.prototype);Od.isPureReactComponent=!0;var h0=Array.isArray,Zm=Object.prototype.hasOwnProperty,Ud={current:null},eg={key:!0,ref:!0,__self:!0,__source:!0};function tg(e,t,n){var r,i={},s=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)Zm.call(t,r)&&!eg.hasOwnProperty(r)&&(i[r]=t[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var u=Array(o),c=0;c<o;c++)u[c]=arguments[c+2];i.children=u}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:po,type:e,key:s,ref:a,props:i,_owner:Ud.current}}function Uy(e,t){return{$$typeof:po,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Bd(e){return typeof e=="object"&&e!==null&&e.$$typeof===po}function By(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var m0=/\/+/g;function Bu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?By(""+e.key):t.toString(36)}function tl(e,t,n,r,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case po:case Ay:a=!0}}if(a)return a=e,i=i(a),e=r===""?"."+Bu(a,0):r,h0(i)?(n="",e!=null&&(n=e.replace(m0,"$&/")+"/"),tl(i,t,n,"",function(c){return c})):i!=null&&(Bd(i)&&(i=Uy(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(m0,"$&/")+"/")+e)),t.push(i)),1;if(a=0,r=r===""?".":r+":",h0(e))for(var o=0;o<e.length;o++){s=e[o];var u=r+Bu(s,o);a+=tl(s,t,n,u,i)}else if(u=Oy(e),typeof u=="function")for(e=u.call(e),o=0;!(s=e.next()).done;)s=s.value,u=r+Bu(s,o++),a+=tl(s,t,n,u,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Ro(e,t,n){if(e==null)return e;var r=[],i=0;return tl(e,r,"","",function(s){return t.call(n,s,i++)}),r}function Gy(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var cn={current:null},nl={transition:null},$y={ReactCurrentDispatcher:cn,ReactCurrentBatchConfig:nl,ReactCurrentOwner:Ud};function ng(){throw Error("act(...) is not supported in production builds of React.")}$e.Children={map:Ro,forEach:function(e,t,n){Ro(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ro(e,function(){t++}),t},toArray:function(e){return Ro(e,function(t){return t})||[]},only:function(e){if(!Bd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};$e.Component=Ws;$e.Fragment=Iy;$e.Profiler=ky;$e.PureComponent=Ld;$e.StrictMode=Ry;$e.Suspense=My;$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$y;$e.act=ng;$e.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Km({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=Ud.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)Zm.call(t,u)&&!eg.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&o!==void 0?o[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){o=Array(u);for(var c=0;c<u;c++)o[c]=arguments[c+2];r.children=o}return{$$typeof:po,type:e.type,key:i,ref:s,props:r,_owner:a}};$e.createContext=function(e){return e={$$typeof:Fy,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:by,_context:e},e.Consumer=e};$e.createElement=tg;$e.createFactory=function(e){var t=tg.bind(null,e);return t.type=e,t};$e.createRef=function(){return{current:null}};$e.forwardRef=function(e){return{$$typeof:Py,render:e}};$e.isValidElement=Bd;$e.lazy=function(e){return{$$typeof:Ly,_payload:{_status:-1,_result:e},_init:Gy}};$e.memo=function(e,t){return{$$typeof:Dy,type:e,compare:t===void 0?null:t}};$e.startTransition=function(e){var t=nl.transition;nl.transition={};try{e()}finally{nl.transition=t}};$e.unstable_act=ng;$e.useCallback=function(e,t){return cn.current.useCallback(e,t)};$e.useContext=function(e){return cn.current.useContext(e)};$e.useDebugValue=function(){};$e.useDeferredValue=function(e){return cn.current.useDeferredValue(e)};$e.useEffect=function(e,t){return cn.current.useEffect(e,t)};$e.useId=function(){return cn.current.useId()};$e.useImperativeHandle=function(e,t,n){return cn.current.useImperativeHandle(e,t,n)};$e.useInsertionEffect=function(e,t){return cn.current.useInsertionEffect(e,t)};$e.useLayoutEffect=function(e,t){return cn.current.useLayoutEffect(e,t)};$e.useMemo=function(e,t){return cn.current.useMemo(e,t)};$e.useReducer=function(e,t,n){return cn.current.useReducer(e,t,n)};$e.useRef=function(e){return cn.current.useRef(e)};$e.useState=function(e){return cn.current.useState(e)};$e.useSyncExternalStore=function(e,t,n){return cn.current.useSyncExternalStore(e,t,n)};$e.useTransition=function(){return cn.current.useTransition()};$e.version="18.3.1";Jm.exports=$e;var Ie=Jm.exports;const $r=Ny(Ie);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vy=Ie,jy=Symbol.for("react.element"),Hy=Symbol.for("react.fragment"),zy=Object.prototype.hasOwnProperty,qy=Vy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Wy={key:!0,ref:!0,__self:!0,__source:!0};function rg(e,t,n){var r,i={},s=null,a=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)zy.call(t,r)&&!Wy.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:jy,type:e,key:s,ref:a,props:i,_owner:qy.current}}uu.Fragment=Hy;uu.jsx=rg;uu.jsxs=rg;Wm.exports=uu;var f=Wm.exports,wc={},ig={exports:{}},kn={},sg={exports:{}},ag={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(se,ae){var ce=se.length;se.push(ae);e:for(;0<ce;){var Ce=ce-1>>>1,D=se[Ce];if(0<i(D,ae))se[Ce]=ae,se[ce]=D,ce=Ce;else break e}}function n(se){return se.length===0?null:se[0]}function r(se){if(se.length===0)return null;var ae=se[0],ce=se.pop();if(ce!==ae){se[0]=ce;e:for(var Ce=0,D=se.length,U=D>>>1;Ce<U;){var G=2*(Ce+1)-1,V=se[G],re=G+1,H=se[re];if(0>i(V,ce))re<D&&0>i(H,V)?(se[Ce]=H,se[re]=ce,Ce=re):(se[Ce]=V,se[G]=ce,Ce=G);else if(re<D&&0>i(H,ce))se[Ce]=H,se[re]=ce,Ce=re;else break e}}return ae}function i(se,ae){var ce=se.sortIndex-ae.sortIndex;return ce!==0?ce:se.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var u=[],c=[],l=1,m=null,h=3,g=!1,x=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(se){for(var ae=n(c);ae!==null;){if(ae.callback===null)r(c);else if(ae.startTime<=se)r(c),ae.sortIndex=ae.expirationTime,t(u,ae);else break;ae=n(c)}}function C(se){if(v=!1,T(se),!x)if(n(u)!==null)x=!0,ue(L);else{var ae=n(c);ae!==null&&ke(C,ae.startTime-se)}}function L(se,ae){x=!1,v&&(v=!1,E(O),O=-1),g=!0;var ce=h;try{for(T(ae),m=n(u);m!==null&&(!(m.expirationTime>ae)||se&&!z());){var Ce=m.callback;if(typeof Ce=="function"){m.callback=null,h=m.priorityLevel;var D=Ce(m.expirationTime<=ae);ae=e.unstable_now(),typeof D=="function"?m.callback=D:m===n(u)&&r(u),T(ae)}else r(u);m=n(u)}if(m!==null)var U=!0;else{var G=n(c);G!==null&&ke(C,G.startTime-ae),U=!1}return U}finally{m=null,h=ce,g=!1}}var B=!1,R=null,O=-1,M=5,k=-1;function z(){return!(e.unstable_now()-k<M)}function X(){if(R!==null){var se=e.unstable_now();k=se;var ae=!0;try{ae=R(!0,se)}finally{ae?ne():(B=!1,R=null)}}else B=!1}var ne;if(typeof y=="function")ne=function(){y(X)};else if(typeof MessageChannel<"u"){var Fe=new MessageChannel,q=Fe.port2;Fe.port1.onmessage=X,ne=function(){q.postMessage(null)}}else ne=function(){w(X,0)};function ue(se){R=se,B||(B=!0,ne())}function ke(se,ae){O=w(function(){se(e.unstable_now())},ae)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(se){se.callback=null},e.unstable_continueExecution=function(){x||g||(x=!0,ue(L))},e.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<se?Math.floor(1e3/se):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(se){switch(h){case 1:case 2:case 3:var ae=3;break;default:ae=h}var ce=h;h=ae;try{return se()}finally{h=ce}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(se,ae){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var ce=h;h=se;try{return ae()}finally{h=ce}},e.unstable_scheduleCallback=function(se,ae,ce){var Ce=e.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?Ce+ce:Ce):ce=Ce,se){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=ce+D,se={id:l++,callback:ae,priorityLevel:se,startTime:ce,expirationTime:D,sortIndex:-1},ce>Ce?(se.sortIndex=ce,t(c,se),n(u)===null&&se===n(c)&&(v?(E(O),O=-1):v=!0,ke(C,ce-Ce))):(se.sortIndex=D,t(u,se),x||g||(x=!0,ue(L))),se},e.unstable_shouldYield=z,e.unstable_wrapCallback=function(se){var ae=h;return function(){var ce=h;h=ae;try{return se.apply(this,arguments)}finally{h=ce}}}})(ag);sg.exports=ag;var Jy=sg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yy=Ie,In=Jy;function pe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var og=new Set,$a={};function Li(e,t){Bs(e,t),Bs(e+"Capture",t)}function Bs(e,t){for($a[e]=t,e=0;e<t.length;e++)og.add(t[e])}var Nr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_c=Object.prototype.hasOwnProperty,Ky=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g0={},x0={};function Xy(e){return _c.call(x0,e)?!0:_c.call(g0,e)?!1:Ky.test(e)?x0[e]=!0:(g0[e]=!0,!1)}function Qy(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Zy(e,t,n,r){if(t===null||typeof t>"u"||Qy(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function dn(e,t,n,r,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var qt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){qt[e]=new dn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];qt[t]=new dn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){qt[e]=new dn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){qt[e]=new dn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){qt[e]=new dn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){qt[e]=new dn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){qt[e]=new dn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){qt[e]=new dn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){qt[e]=new dn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Gd=/[\-:]([a-z])/g;function $d(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Gd,$d);qt[t]=new dn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Gd,$d);qt[t]=new dn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Gd,$d);qt[t]=new dn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){qt[e]=new dn(e,1,!1,e.toLowerCase(),null,!1,!1)});qt.xlinkHref=new dn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){qt[e]=new dn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Vd(e,t,n,r){var i=qt.hasOwnProperty(t)?qt[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Zy(t,n,i,r)&&(n=null),r||i===null?Xy(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Pr=Yy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ko=Symbol.for("react.element"),us=Symbol.for("react.portal"),cs=Symbol.for("react.fragment"),jd=Symbol.for("react.strict_mode"),Cc=Symbol.for("react.profiler"),lg=Symbol.for("react.provider"),ug=Symbol.for("react.context"),Hd=Symbol.for("react.forward_ref"),Nc=Symbol.for("react.suspense"),Ac=Symbol.for("react.suspense_list"),zd=Symbol.for("react.memo"),Vr=Symbol.for("react.lazy"),cg=Symbol.for("react.offscreen"),v0=Symbol.iterator;function la(e){return e===null||typeof e!="object"?null:(e=v0&&e[v0]||e["@@iterator"],typeof e=="function"?e:null)}var mt=Object.assign,Gu;function ya(e){if(Gu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Gu=t&&t[1]||""}return`
`+Gu+e}var $u=!1;function Vu(e,t){if(!e||$u)return"";$u=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var u=`
`+i[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=a&&0<=o);break}}}finally{$u=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ya(e):""}function e2(e){switch(e.tag){case 5:return ya(e.type);case 16:return ya("Lazy");case 13:return ya("Suspense");case 19:return ya("SuspenseList");case 0:case 2:case 15:return e=Vu(e.type,!1),e;case 11:return e=Vu(e.type.render,!1),e;case 1:return e=Vu(e.type,!0),e;default:return""}}function Ic(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case cs:return"Fragment";case us:return"Portal";case Cc:return"Profiler";case jd:return"StrictMode";case Nc:return"Suspense";case Ac:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ug:return(e.displayName||"Context")+".Consumer";case lg:return(e._context.displayName||"Context")+".Provider";case Hd:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case zd:return t=e.displayName||null,t!==null?t:Ic(e.type)||"Memo";case Vr:t=e._payload,e=e._init;try{return Ic(e(t))}catch{}}return null}function t2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ic(t);case 8:return t===jd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ii(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function dg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function n2(e){var t=dg(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function bo(e){e._valueTracker||(e._valueTracker=n2(e))}function fg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=dg(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function gl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Rc(e,t){var n=t.checked;return mt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function y0(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=ii(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function pg(e,t){t=t.checked,t!=null&&Vd(e,"checked",t,!1)}function kc(e,t){pg(e,t);var n=ii(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?bc(e,t.type,n):t.hasOwnProperty("defaultValue")&&bc(e,t.type,ii(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function E0(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function bc(e,t,n){(t!=="number"||gl(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ea=Array.isArray;function _s(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ii(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Fc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(pe(91));return mt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function T0(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(pe(92));if(Ea(n)){if(1<n.length)throw Error(pe(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ii(n)}}function hg(e,t){var n=ii(t.value),r=ii(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function S0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function mg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?mg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Fo,gg=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Fo=Fo||document.createElement("div"),Fo.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Fo.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Va(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var _a={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},r2=["Webkit","ms","Moz","O"];Object.keys(_a).forEach(function(e){r2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_a[t]=_a[e]})});function xg(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||_a.hasOwnProperty(e)&&_a[e]?(""+t).trim():t+"px"}function vg(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=xg(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var i2=mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Mc(e,t){if(t){if(i2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(pe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(pe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(pe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(pe(62))}}function Dc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lc=null;function qd(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Oc=null,Cs=null,Ns=null;function w0(e){if(e=go(e)){if(typeof Oc!="function")throw Error(pe(280));var t=e.stateNode;t&&(t=hu(t),Oc(e.stateNode,e.type,t))}}function yg(e){Cs?Ns?Ns.push(e):Ns=[e]:Cs=e}function Eg(){if(Cs){var e=Cs,t=Ns;if(Ns=Cs=null,w0(e),t)for(e=0;e<t.length;e++)w0(t[e])}}function Tg(e,t){return e(t)}function Sg(){}var ju=!1;function wg(e,t,n){if(ju)return e(t,n);ju=!0;try{return Tg(e,t,n)}finally{ju=!1,(Cs!==null||Ns!==null)&&(Sg(),Eg())}}function ja(e,t){var n=e.stateNode;if(n===null)return null;var r=hu(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(pe(231,t,typeof n));return n}var Uc=!1;if(Nr)try{var ua={};Object.defineProperty(ua,"passive",{get:function(){Uc=!0}}),window.addEventListener("test",ua,ua),window.removeEventListener("test",ua,ua)}catch{Uc=!1}function s2(e,t,n,r,i,s,a,o,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Ca=!1,xl=null,vl=!1,Bc=null,a2={onError:function(e){Ca=!0,xl=e}};function o2(e,t,n,r,i,s,a,o,u){Ca=!1,xl=null,s2.apply(a2,arguments)}function l2(e,t,n,r,i,s,a,o,u){if(o2.apply(this,arguments),Ca){if(Ca){var c=xl;Ca=!1,xl=null}else throw Error(pe(198));vl||(vl=!0,Bc=c)}}function Oi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function _g(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function _0(e){if(Oi(e)!==e)throw Error(pe(188))}function u2(e){var t=e.alternate;if(!t){if(t=Oi(e),t===null)throw Error(pe(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return _0(i),e;if(s===r)return _0(i),t;s=s.sibling}throw Error(pe(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,o=i.child;o;){if(o===n){a=!0,n=i,r=s;break}if(o===r){a=!0,r=i,n=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===n){a=!0,n=s,r=i;break}if(o===r){a=!0,r=s,n=i;break}o=o.sibling}if(!a)throw Error(pe(189))}}if(n.alternate!==r)throw Error(pe(190))}if(n.tag!==3)throw Error(pe(188));return n.stateNode.current===n?e:t}function Cg(e){return e=u2(e),e!==null?Ng(e):null}function Ng(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ng(e);if(t!==null)return t;e=e.sibling}return null}var Ag=In.unstable_scheduleCallback,C0=In.unstable_cancelCallback,c2=In.unstable_shouldYield,d2=In.unstable_requestPaint,Et=In.unstable_now,f2=In.unstable_getCurrentPriorityLevel,Wd=In.unstable_ImmediatePriority,Ig=In.unstable_UserBlockingPriority,yl=In.unstable_NormalPriority,p2=In.unstable_LowPriority,Rg=In.unstable_IdlePriority,cu=null,fr=null;function h2(e){if(fr&&typeof fr.onCommitFiberRoot=="function")try{fr.onCommitFiberRoot(cu,e,void 0,(e.current.flags&128)===128)}catch{}}var er=Math.clz32?Math.clz32:x2,m2=Math.log,g2=Math.LN2;function x2(e){return e>>>=0,e===0?32:31-(m2(e)/g2|0)|0}var Po=64,Mo=4194304;function Ta(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function El(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,a=n&268435455;if(a!==0){var o=a&~i;o!==0?r=Ta(o):(s&=a,s!==0&&(r=Ta(s)))}else a=n&~i,a!==0?r=Ta(a):s!==0&&(r=Ta(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-er(t),i=1<<n,r|=e[n],t&=~i;return r}function v2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function y2(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-er(s),o=1<<a,u=i[a];u===-1?(!(o&n)||o&r)&&(i[a]=v2(o,t)):u<=t&&(e.expiredLanes|=o),s&=~o}}function Gc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function kg(){var e=Po;return Po<<=1,!(Po&4194240)&&(Po=64),e}function Hu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ho(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-er(t),e[t]=n}function E2(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-er(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}function Jd(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-er(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Ze=0;function bg(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Fg,Yd,Pg,Mg,Dg,$c=!1,Do=[],Kr=null,Xr=null,Qr=null,Ha=new Map,za=new Map,Hr=[],T2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function N0(e,t){switch(e){case"focusin":case"focusout":Kr=null;break;case"dragenter":case"dragleave":Xr=null;break;case"mouseover":case"mouseout":Qr=null;break;case"pointerover":case"pointerout":Ha.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":za.delete(t.pointerId)}}function ca(e,t,n,r,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},t!==null&&(t=go(t),t!==null&&Yd(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function S2(e,t,n,r,i){switch(t){case"focusin":return Kr=ca(Kr,e,t,n,r,i),!0;case"dragenter":return Xr=ca(Xr,e,t,n,r,i),!0;case"mouseover":return Qr=ca(Qr,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Ha.set(s,ca(Ha.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,za.set(s,ca(za.get(s)||null,e,t,n,r,i)),!0}return!1}function Lg(e){var t=Si(e.target);if(t!==null){var n=Oi(t);if(n!==null){if(t=n.tag,t===13){if(t=_g(n),t!==null){e.blockedOn=t,Dg(e.priority,function(){Pg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function rl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Vc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Lc=r,n.target.dispatchEvent(r),Lc=null}else return t=go(n),t!==null&&Yd(t),e.blockedOn=n,!1;t.shift()}return!0}function A0(e,t,n){rl(e)&&n.delete(t)}function w2(){$c=!1,Kr!==null&&rl(Kr)&&(Kr=null),Xr!==null&&rl(Xr)&&(Xr=null),Qr!==null&&rl(Qr)&&(Qr=null),Ha.forEach(A0),za.forEach(A0)}function da(e,t){e.blockedOn===t&&(e.blockedOn=null,$c||($c=!0,In.unstable_scheduleCallback(In.unstable_NormalPriority,w2)))}function qa(e){function t(i){return da(i,e)}if(0<Do.length){da(Do[0],e);for(var n=1;n<Do.length;n++){var r=Do[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Kr!==null&&da(Kr,e),Xr!==null&&da(Xr,e),Qr!==null&&da(Qr,e),Ha.forEach(t),za.forEach(t),n=0;n<Hr.length;n++)r=Hr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Hr.length&&(n=Hr[0],n.blockedOn===null);)Lg(n),n.blockedOn===null&&Hr.shift()}var As=Pr.ReactCurrentBatchConfig,Tl=!0;function _2(e,t,n,r){var i=Ze,s=As.transition;As.transition=null;try{Ze=1,Kd(e,t,n,r)}finally{Ze=i,As.transition=s}}function C2(e,t,n,r){var i=Ze,s=As.transition;As.transition=null;try{Ze=4,Kd(e,t,n,r)}finally{Ze=i,As.transition=s}}function Kd(e,t,n,r){if(Tl){var i=Vc(e,t,n,r);if(i===null)ec(e,t,r,Sl,n),N0(e,r);else if(S2(i,e,t,n,r))r.stopPropagation();else if(N0(e,r),t&4&&-1<T2.indexOf(e)){for(;i!==null;){var s=go(i);if(s!==null&&Fg(s),s=Vc(e,t,n,r),s===null&&ec(e,t,r,Sl,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else ec(e,t,r,null,n)}}var Sl=null;function Vc(e,t,n,r){if(Sl=null,e=qd(r),e=Si(e),e!==null)if(t=Oi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=_g(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Sl=e,null}function Og(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(f2()){case Wd:return 1;case Ig:return 4;case yl:case p2:return 16;case Rg:return 536870912;default:return 16}default:return 16}}var qr=null,Xd=null,il=null;function Ug(){if(il)return il;var e,t=Xd,n=t.length,r,i="value"in qr?qr.value:qr.textContent,s=i.length;for(e=0;e<n&&t[e]===i[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===i[s-r];r++);return il=i.slice(e,1<r?1-r:void 0)}function sl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Lo(){return!0}function I0(){return!1}function bn(e){function t(n,r,i,s,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Lo:I0,this.isPropagationStopped=I0,this}return mt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Lo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Lo)},persist:function(){},isPersistent:Lo}),t}var Js={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qd=bn(Js),mo=mt({},Js,{view:0,detail:0}),N2=bn(mo),zu,qu,fa,du=mt({},mo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==fa&&(fa&&e.type==="mousemove"?(zu=e.screenX-fa.screenX,qu=e.screenY-fa.screenY):qu=zu=0,fa=e),zu)},movementY:function(e){return"movementY"in e?e.movementY:qu}}),R0=bn(du),A2=mt({},du,{dataTransfer:0}),I2=bn(A2),R2=mt({},mo,{relatedTarget:0}),Wu=bn(R2),k2=mt({},Js,{animationName:0,elapsedTime:0,pseudoElement:0}),b2=bn(k2),F2=mt({},Js,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),P2=bn(F2),M2=mt({},Js,{data:0}),k0=bn(M2),D2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},L2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},O2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function U2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=O2[e])?!!t[e]:!1}function Zd(){return U2}var B2=mt({},mo,{key:function(e){if(e.key){var t=D2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=sl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?L2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zd,charCode:function(e){return e.type==="keypress"?sl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?sl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),G2=bn(B2),$2=mt({},du,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),b0=bn($2),V2=mt({},mo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zd}),j2=bn(V2),H2=mt({},Js,{propertyName:0,elapsedTime:0,pseudoElement:0}),z2=bn(H2),q2=mt({},du,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),W2=bn(q2),J2=[9,13,27,32],ef=Nr&&"CompositionEvent"in window,Na=null;Nr&&"documentMode"in document&&(Na=document.documentMode);var Y2=Nr&&"TextEvent"in window&&!Na,Bg=Nr&&(!ef||Na&&8<Na&&11>=Na),F0=" ",P0=!1;function Gg(e,t){switch(e){case"keyup":return J2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $g(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ds=!1;function K2(e,t){switch(e){case"compositionend":return $g(t);case"keypress":return t.which!==32?null:(P0=!0,F0);case"textInput":return e=t.data,e===F0&&P0?null:e;default:return null}}function X2(e,t){if(ds)return e==="compositionend"||!ef&&Gg(e,t)?(e=Ug(),il=Xd=qr=null,ds=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bg&&t.locale!=="ko"?null:t.data;default:return null}}var Q2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function M0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Q2[e.type]:t==="textarea"}function Vg(e,t,n,r){yg(r),t=wl(t,"onChange"),0<t.length&&(n=new Qd("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Aa=null,Wa=null;function Z2(e){Zg(e,0)}function fu(e){var t=hs(e);if(fg(t))return e}function eE(e,t){if(e==="change")return t}var jg=!1;if(Nr){var Ju;if(Nr){var Yu="oninput"in document;if(!Yu){var D0=document.createElement("div");D0.setAttribute("oninput","return;"),Yu=typeof D0.oninput=="function"}Ju=Yu}else Ju=!1;jg=Ju&&(!document.documentMode||9<document.documentMode)}function L0(){Aa&&(Aa.detachEvent("onpropertychange",Hg),Wa=Aa=null)}function Hg(e){if(e.propertyName==="value"&&fu(Wa)){var t=[];Vg(t,Wa,e,qd(e)),wg(Z2,t)}}function tE(e,t,n){e==="focusin"?(L0(),Aa=t,Wa=n,Aa.attachEvent("onpropertychange",Hg)):e==="focusout"&&L0()}function nE(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return fu(Wa)}function rE(e,t){if(e==="click")return fu(t)}function iE(e,t){if(e==="input"||e==="change")return fu(t)}function sE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ir=typeof Object.is=="function"?Object.is:sE;function Ja(e,t){if(ir(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!_c.call(t,i)||!ir(e[i],t[i]))return!1}return!0}function O0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function U0(e,t){var n=O0(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=O0(n)}}function zg(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?zg(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function qg(){for(var e=window,t=gl();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=gl(e.document)}return t}function tf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function aE(e){var t=qg(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&zg(n.ownerDocument.documentElement,n)){if(r!==null&&tf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=U0(n,s);var a=U0(n,r);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var oE=Nr&&"documentMode"in document&&11>=document.documentMode,fs=null,jc=null,Ia=null,Hc=!1;function B0(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Hc||fs==null||fs!==gl(r)||(r=fs,"selectionStart"in r&&tf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ia&&Ja(Ia,r)||(Ia=r,r=wl(jc,"onSelect"),0<r.length&&(t=new Qd("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=fs)))}function Oo(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ps={animationend:Oo("Animation","AnimationEnd"),animationiteration:Oo("Animation","AnimationIteration"),animationstart:Oo("Animation","AnimationStart"),transitionend:Oo("Transition","TransitionEnd")},Ku={},Wg={};Nr&&(Wg=document.createElement("div").style,"AnimationEvent"in window||(delete ps.animationend.animation,delete ps.animationiteration.animation,delete ps.animationstart.animation),"TransitionEvent"in window||delete ps.transitionend.transition);function pu(e){if(Ku[e])return Ku[e];if(!ps[e])return e;var t=ps[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Wg)return Ku[e]=t[n];return e}var Jg=pu("animationend"),Yg=pu("animationiteration"),Kg=pu("animationstart"),Xg=pu("transitionend"),Qg=new Map,G0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ui(e,t){Qg.set(e,t),Li(t,[e])}for(var Xu=0;Xu<G0.length;Xu++){var Qu=G0[Xu],lE=Qu.toLowerCase(),uE=Qu[0].toUpperCase()+Qu.slice(1);ui(lE,"on"+uE)}ui(Jg,"onAnimationEnd");ui(Yg,"onAnimationIteration");ui(Kg,"onAnimationStart");ui("dblclick","onDoubleClick");ui("focusin","onFocus");ui("focusout","onBlur");ui(Xg,"onTransitionEnd");Bs("onMouseEnter",["mouseout","mouseover"]);Bs("onMouseLeave",["mouseout","mouseover"]);Bs("onPointerEnter",["pointerout","pointerover"]);Bs("onPointerLeave",["pointerout","pointerover"]);Li("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Li("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Li("onBeforeInput",["compositionend","keypress","textInput","paste"]);Li("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Li("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Li("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sa));function $0(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,l2(r,t,void 0,e),e.currentTarget=null}function Zg(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],u=o.instance,c=o.currentTarget;if(o=o.listener,u!==s&&i.isPropagationStopped())break e;$0(i,o,c),s=u}else for(a=0;a<r.length;a++){if(o=r[a],u=o.instance,c=o.currentTarget,o=o.listener,u!==s&&i.isPropagationStopped())break e;$0(i,o,c),s=u}}}if(vl)throw e=Bc,vl=!1,Bc=null,e}function at(e,t){var n=t[Yc];n===void 0&&(n=t[Yc]=new Set);var r=e+"__bubble";n.has(r)||(ex(t,e,2,!1),n.add(r))}function Zu(e,t,n){var r=0;t&&(r|=4),ex(n,e,r,t)}var Uo="_reactListening"+Math.random().toString(36).slice(2);function Ya(e){if(!e[Uo]){e[Uo]=!0,og.forEach(function(n){n!=="selectionchange"&&(cE.has(n)||Zu(n,!1,e),Zu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Uo]||(t[Uo]=!0,Zu("selectionchange",!1,t))}}function ex(e,t,n,r){switch(Og(t)){case 1:var i=_2;break;case 4:i=C2;break;default:i=Kd}n=i.bind(null,t,n,e),i=void 0,!Uc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function ec(e,t,n,r,i){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Si(o),a===null)return;if(u=a.tag,u===5||u===6){r=s=a;continue e}o=o.parentNode}}r=r.return}wg(function(){var c=s,l=qd(n),m=[];e:{var h=Qg.get(e);if(h!==void 0){var g=Qd,x=e;switch(e){case"keypress":if(sl(n)===0)break e;case"keydown":case"keyup":g=G2;break;case"focusin":x="focus",g=Wu;break;case"focusout":x="blur",g=Wu;break;case"beforeblur":case"afterblur":g=Wu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=R0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=I2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=j2;break;case Jg:case Yg:case Kg:g=b2;break;case Xg:g=z2;break;case"scroll":g=N2;break;case"wheel":g=W2;break;case"copy":case"cut":case"paste":g=P2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=b0}var v=(t&4)!==0,w=!v&&e==="scroll",E=v?h!==null?h+"Capture":null:h;v=[];for(var y=c,T;y!==null;){T=y;var C=T.stateNode;if(T.tag===5&&C!==null&&(T=C,E!==null&&(C=ja(y,E),C!=null&&v.push(Ka(y,C,T)))),w)break;y=y.return}0<v.length&&(h=new g(h,x,null,n,l),m.push({event:h,listeners:v}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",h&&n!==Lc&&(x=n.relatedTarget||n.fromElement)&&(Si(x)||x[Ar]))break e;if((g||h)&&(h=l.window===l?l:(h=l.ownerDocument)?h.defaultView||h.parentWindow:window,g?(x=n.relatedTarget||n.toElement,g=c,x=x?Si(x):null,x!==null&&(w=Oi(x),x!==w||x.tag!==5&&x.tag!==6)&&(x=null)):(g=null,x=c),g!==x)){if(v=R0,C="onMouseLeave",E="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(v=b0,C="onPointerLeave",E="onPointerEnter",y="pointer"),w=g==null?h:hs(g),T=x==null?h:hs(x),h=new v(C,y+"leave",g,n,l),h.target=w,h.relatedTarget=T,C=null,Si(l)===c&&(v=new v(E,y+"enter",x,n,l),v.target=T,v.relatedTarget=w,C=v),w=C,g&&x)t:{for(v=g,E=x,y=0,T=v;T;T=rs(T))y++;for(T=0,C=E;C;C=rs(C))T++;for(;0<y-T;)v=rs(v),y--;for(;0<T-y;)E=rs(E),T--;for(;y--;){if(v===E||E!==null&&v===E.alternate)break t;v=rs(v),E=rs(E)}v=null}else v=null;g!==null&&V0(m,h,g,v,!1),x!==null&&w!==null&&V0(m,w,x,v,!0)}}e:{if(h=c?hs(c):window,g=h.nodeName&&h.nodeName.toLowerCase(),g==="select"||g==="input"&&h.type==="file")var L=eE;else if(M0(h))if(jg)L=iE;else{L=nE;var B=tE}else(g=h.nodeName)&&g.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(L=rE);if(L&&(L=L(e,c))){Vg(m,L,n,l);break e}B&&B(e,h,c),e==="focusout"&&(B=h._wrapperState)&&B.controlled&&h.type==="number"&&bc(h,"number",h.value)}switch(B=c?hs(c):window,e){case"focusin":(M0(B)||B.contentEditable==="true")&&(fs=B,jc=c,Ia=null);break;case"focusout":Ia=jc=fs=null;break;case"mousedown":Hc=!0;break;case"contextmenu":case"mouseup":case"dragend":Hc=!1,B0(m,n,l);break;case"selectionchange":if(oE)break;case"keydown":case"keyup":B0(m,n,l)}var R;if(ef)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else ds?Gg(e,n)&&(O="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(O="onCompositionStart");O&&(Bg&&n.locale!=="ko"&&(ds||O!=="onCompositionStart"?O==="onCompositionEnd"&&ds&&(R=Ug()):(qr=l,Xd="value"in qr?qr.value:qr.textContent,ds=!0)),B=wl(c,O),0<B.length&&(O=new k0(O,e,null,n,l),m.push({event:O,listeners:B}),R?O.data=R:(R=$g(n),R!==null&&(O.data=R)))),(R=Y2?K2(e,n):X2(e,n))&&(c=wl(c,"onBeforeInput"),0<c.length&&(l=new k0("onBeforeInput","beforeinput",null,n,l),m.push({event:l,listeners:c}),l.data=R))}Zg(m,t)})}function Ka(e,t,n){return{instance:e,listener:t,currentTarget:n}}function wl(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ja(e,n),s!=null&&r.unshift(Ka(e,s,i)),s=ja(e,t),s!=null&&r.push(Ka(e,s,i))),e=e.return}return r}function rs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function V0(e,t,n,r,i){for(var s=t._reactName,a=[];n!==null&&n!==r;){var o=n,u=o.alternate,c=o.stateNode;if(u!==null&&u===r)break;o.tag===5&&c!==null&&(o=c,i?(u=ja(n,s),u!=null&&a.unshift(Ka(n,u,o))):i||(u=ja(n,s),u!=null&&a.push(Ka(n,u,o)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var dE=/\r\n?/g,fE=/\u0000|\uFFFD/g;function j0(e){return(typeof e=="string"?e:""+e).replace(dE,`
`).replace(fE,"")}function Bo(e,t,n){if(t=j0(t),j0(e)!==t&&n)throw Error(pe(425))}function _l(){}var zc=null,qc=null;function Wc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Jc=typeof setTimeout=="function"?setTimeout:void 0,pE=typeof clearTimeout=="function"?clearTimeout:void 0,H0=typeof Promise=="function"?Promise:void 0,hE=typeof queueMicrotask=="function"?queueMicrotask:typeof H0<"u"?function(e){return H0.resolve(null).then(e).catch(mE)}:Jc;function mE(e){setTimeout(function(){throw e})}function tc(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),qa(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);qa(t)}function Zr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function z0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Ys=Math.random().toString(36).slice(2),dr="__reactFiber$"+Ys,Xa="__reactProps$"+Ys,Ar="__reactContainer$"+Ys,Yc="__reactEvents$"+Ys,gE="__reactListeners$"+Ys,xE="__reactHandles$"+Ys;function Si(e){var t=e[dr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ar]||n[dr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=z0(e);e!==null;){if(n=e[dr])return n;e=z0(e)}return t}e=n,n=e.parentNode}return null}function go(e){return e=e[dr]||e[Ar],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function hs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(pe(33))}function hu(e){return e[Xa]||null}var Kc=[],ms=-1;function ci(e){return{current:e}}function lt(e){0>ms||(e.current=Kc[ms],Kc[ms]=null,ms--)}function rt(e,t){ms++,Kc[ms]=e.current,e.current=t}var si={},tn=ci(si),hn=ci(!1),Ii=si;function Gs(e,t){var n=e.type.contextTypes;if(!n)return si;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function mn(e){return e=e.childContextTypes,e!=null}function Cl(){lt(hn),lt(tn)}function q0(e,t,n){if(tn.current!==si)throw Error(pe(168));rt(tn,t),rt(hn,n)}function tx(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(pe(108,t2(e)||"Unknown",i));return mt({},n,r)}function Nl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||si,Ii=tn.current,rt(tn,e),rt(hn,hn.current),!0}function W0(e,t,n){var r=e.stateNode;if(!r)throw Error(pe(169));n?(e=tx(e,t,Ii),r.__reactInternalMemoizedMergedChildContext=e,lt(hn),lt(tn),rt(tn,e)):lt(hn),rt(hn,n)}var yr=null,mu=!1,nc=!1;function nx(e){yr===null?yr=[e]:yr.push(e)}function vE(e){mu=!0,nx(e)}function di(){if(!nc&&yr!==null){nc=!0;var e=0,t=Ze;try{var n=yr;for(Ze=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}yr=null,mu=!1}catch(i){throw yr!==null&&(yr=yr.slice(e+1)),Ag(Wd,di),i}finally{Ze=t,nc=!1}}return null}var gs=[],xs=0,Al=null,Il=0,On=[],Un=0,Ri=null,Er=1,Tr="";function vi(e,t){gs[xs++]=Il,gs[xs++]=Al,Al=e,Il=t}function rx(e,t,n){On[Un++]=Er,On[Un++]=Tr,On[Un++]=Ri,Ri=e;var r=Er;e=Tr;var i=32-er(r)-1;r&=~(1<<i),n+=1;var s=32-er(t)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Er=1<<32-er(t)+i|n<<i|r,Tr=s+e}else Er=1<<s|n<<i|r,Tr=e}function nf(e){e.return!==null&&(vi(e,1),rx(e,1,0))}function rf(e){for(;e===Al;)Al=gs[--xs],gs[xs]=null,Il=gs[--xs],gs[xs]=null;for(;e===Ri;)Ri=On[--Un],On[Un]=null,Tr=On[--Un],On[Un]=null,Er=On[--Un],On[Un]=null}var An=null,Nn=null,dt=!1,Xn=null;function ix(e,t){var n=Bn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function J0(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,An=e,Nn=Zr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,An=e,Nn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ri!==null?{id:Er,overflow:Tr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Bn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,An=e,Nn=null,!0):!1;default:return!1}}function Xc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Qc(e){if(dt){var t=Nn;if(t){var n=t;if(!J0(e,t)){if(Xc(e))throw Error(pe(418));t=Zr(n.nextSibling);var r=An;t&&J0(e,t)?ix(r,n):(e.flags=e.flags&-4097|2,dt=!1,An=e)}}else{if(Xc(e))throw Error(pe(418));e.flags=e.flags&-4097|2,dt=!1,An=e}}}function Y0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;An=e}function Go(e){if(e!==An)return!1;if(!dt)return Y0(e),dt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Wc(e.type,e.memoizedProps)),t&&(t=Nn)){if(Xc(e))throw sx(),Error(pe(418));for(;t;)ix(e,t),t=Zr(t.nextSibling)}if(Y0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(pe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Nn=Zr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Nn=null}}else Nn=An?Zr(e.stateNode.nextSibling):null;return!0}function sx(){for(var e=Nn;e;)e=Zr(e.nextSibling)}function $s(){Nn=An=null,dt=!1}function sf(e){Xn===null?Xn=[e]:Xn.push(e)}var yE=Pr.ReactCurrentBatchConfig;function pa(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(pe(309));var r=n.stateNode}if(!r)throw Error(pe(147,e));var i=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(pe(284));if(!n._owner)throw Error(pe(290,e))}return e}function $o(e,t){throw e=Object.prototype.toString.call(t),Error(pe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function K0(e){var t=e._init;return t(e._payload)}function ax(e){function t(E,y){if(e){var T=E.deletions;T===null?(E.deletions=[y],E.flags|=16):T.push(y)}}function n(E,y){if(!e)return null;for(;y!==null;)t(E,y),y=y.sibling;return null}function r(E,y){for(E=new Map;y!==null;)y.key!==null?E.set(y.key,y):E.set(y.index,y),y=y.sibling;return E}function i(E,y){return E=ri(E,y),E.index=0,E.sibling=null,E}function s(E,y,T){return E.index=T,e?(T=E.alternate,T!==null?(T=T.index,T<y?(E.flags|=2,y):T):(E.flags|=2,y)):(E.flags|=1048576,y)}function a(E){return e&&E.alternate===null&&(E.flags|=2),E}function o(E,y,T,C){return y===null||y.tag!==6?(y=uc(T,E.mode,C),y.return=E,y):(y=i(y,T),y.return=E,y)}function u(E,y,T,C){var L=T.type;return L===cs?l(E,y,T.props.children,C,T.key):y!==null&&(y.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Vr&&K0(L)===y.type)?(C=i(y,T.props),C.ref=pa(E,y,T),C.return=E,C):(C=fl(T.type,T.key,T.props,null,E.mode,C),C.ref=pa(E,y,T),C.return=E,C)}function c(E,y,T,C){return y===null||y.tag!==4||y.stateNode.containerInfo!==T.containerInfo||y.stateNode.implementation!==T.implementation?(y=cc(T,E.mode,C),y.return=E,y):(y=i(y,T.children||[]),y.return=E,y)}function l(E,y,T,C,L){return y===null||y.tag!==7?(y=Ni(T,E.mode,C,L),y.return=E,y):(y=i(y,T),y.return=E,y)}function m(E,y,T){if(typeof y=="string"&&y!==""||typeof y=="number")return y=uc(""+y,E.mode,T),y.return=E,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ko:return T=fl(y.type,y.key,y.props,null,E.mode,T),T.ref=pa(E,null,y),T.return=E,T;case us:return y=cc(y,E.mode,T),y.return=E,y;case Vr:var C=y._init;return m(E,C(y._payload),T)}if(Ea(y)||la(y))return y=Ni(y,E.mode,T,null),y.return=E,y;$o(E,y)}return null}function h(E,y,T,C){var L=y!==null?y.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return L!==null?null:o(E,y,""+T,C);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case ko:return T.key===L?u(E,y,T,C):null;case us:return T.key===L?c(E,y,T,C):null;case Vr:return L=T._init,h(E,y,L(T._payload),C)}if(Ea(T)||la(T))return L!==null?null:l(E,y,T,C,null);$o(E,T)}return null}function g(E,y,T,C,L){if(typeof C=="string"&&C!==""||typeof C=="number")return E=E.get(T)||null,o(y,E,""+C,L);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case ko:return E=E.get(C.key===null?T:C.key)||null,u(y,E,C,L);case us:return E=E.get(C.key===null?T:C.key)||null,c(y,E,C,L);case Vr:var B=C._init;return g(E,y,T,B(C._payload),L)}if(Ea(C)||la(C))return E=E.get(T)||null,l(y,E,C,L,null);$o(y,C)}return null}function x(E,y,T,C){for(var L=null,B=null,R=y,O=y=0,M=null;R!==null&&O<T.length;O++){R.index>O?(M=R,R=null):M=R.sibling;var k=h(E,R,T[O],C);if(k===null){R===null&&(R=M);break}e&&R&&k.alternate===null&&t(E,R),y=s(k,y,O),B===null?L=k:B.sibling=k,B=k,R=M}if(O===T.length)return n(E,R),dt&&vi(E,O),L;if(R===null){for(;O<T.length;O++)R=m(E,T[O],C),R!==null&&(y=s(R,y,O),B===null?L=R:B.sibling=R,B=R);return dt&&vi(E,O),L}for(R=r(E,R);O<T.length;O++)M=g(R,E,O,T[O],C),M!==null&&(e&&M.alternate!==null&&R.delete(M.key===null?O:M.key),y=s(M,y,O),B===null?L=M:B.sibling=M,B=M);return e&&R.forEach(function(z){return t(E,z)}),dt&&vi(E,O),L}function v(E,y,T,C){var L=la(T);if(typeof L!="function")throw Error(pe(150));if(T=L.call(T),T==null)throw Error(pe(151));for(var B=L=null,R=y,O=y=0,M=null,k=T.next();R!==null&&!k.done;O++,k=T.next()){R.index>O?(M=R,R=null):M=R.sibling;var z=h(E,R,k.value,C);if(z===null){R===null&&(R=M);break}e&&R&&z.alternate===null&&t(E,R),y=s(z,y,O),B===null?L=z:B.sibling=z,B=z,R=M}if(k.done)return n(E,R),dt&&vi(E,O),L;if(R===null){for(;!k.done;O++,k=T.next())k=m(E,k.value,C),k!==null&&(y=s(k,y,O),B===null?L=k:B.sibling=k,B=k);return dt&&vi(E,O),L}for(R=r(E,R);!k.done;O++,k=T.next())k=g(R,E,O,k.value,C),k!==null&&(e&&k.alternate!==null&&R.delete(k.key===null?O:k.key),y=s(k,y,O),B===null?L=k:B.sibling=k,B=k);return e&&R.forEach(function(X){return t(E,X)}),dt&&vi(E,O),L}function w(E,y,T,C){if(typeof T=="object"&&T!==null&&T.type===cs&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case ko:e:{for(var L=T.key,B=y;B!==null;){if(B.key===L){if(L=T.type,L===cs){if(B.tag===7){n(E,B.sibling),y=i(B,T.props.children),y.return=E,E=y;break e}}else if(B.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Vr&&K0(L)===B.type){n(E,B.sibling),y=i(B,T.props),y.ref=pa(E,B,T),y.return=E,E=y;break e}n(E,B);break}else t(E,B);B=B.sibling}T.type===cs?(y=Ni(T.props.children,E.mode,C,T.key),y.return=E,E=y):(C=fl(T.type,T.key,T.props,null,E.mode,C),C.ref=pa(E,y,T),C.return=E,E=C)}return a(E);case us:e:{for(B=T.key;y!==null;){if(y.key===B)if(y.tag===4&&y.stateNode.containerInfo===T.containerInfo&&y.stateNode.implementation===T.implementation){n(E,y.sibling),y=i(y,T.children||[]),y.return=E,E=y;break e}else{n(E,y);break}else t(E,y);y=y.sibling}y=cc(T,E.mode,C),y.return=E,E=y}return a(E);case Vr:return B=T._init,w(E,y,B(T._payload),C)}if(Ea(T))return x(E,y,T,C);if(la(T))return v(E,y,T,C);$o(E,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,y!==null&&y.tag===6?(n(E,y.sibling),y=i(y,T),y.return=E,E=y):(n(E,y),y=uc(T,E.mode,C),y.return=E,E=y),a(E)):n(E,y)}return w}var Vs=ax(!0),ox=ax(!1),Rl=ci(null),kl=null,vs=null,af=null;function of(){af=vs=kl=null}function lf(e){var t=Rl.current;lt(Rl),e._currentValue=t}function Zc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Is(e,t){kl=e,af=vs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(pn=!0),e.firstContext=null)}function Vn(e){var t=e._currentValue;if(af!==e)if(e={context:e,memoizedValue:t,next:null},vs===null){if(kl===null)throw Error(pe(308));vs=e,kl.dependencies={lanes:0,firstContext:e}}else vs=vs.next=e;return t}var wi=null;function uf(e){wi===null?wi=[e]:wi.push(e)}function lx(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,uf(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ir(e,r)}function Ir(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var jr=!1;function cf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ux(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Sr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ei(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,He&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ir(e,n)}return i=r.interleaved,i===null?(t.next=t,uf(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ir(e,n)}function al(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Jd(e,n)}}function X0(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?i=s=t:s=s.next=t}else i=s=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function bl(e,t,n,r){var i=e.updateQueue;jr=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var u=o,c=u.next;u.next=null,a===null?s=c:a.next=c,a=u;var l=e.alternate;l!==null&&(l=l.updateQueue,o=l.lastBaseUpdate,o!==a&&(o===null?l.firstBaseUpdate=c:o.next=c,l.lastBaseUpdate=u))}if(s!==null){var m=i.baseState;a=0,l=c=u=null,o=s;do{var h=o.lane,g=o.eventTime;if((r&h)===h){l!==null&&(l=l.next={eventTime:g,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,v=o;switch(h=t,g=n,v.tag){case 1:if(x=v.payload,typeof x=="function"){m=x.call(g,m,h);break e}m=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=v.payload,h=typeof x=="function"?x.call(g,m,h):x,h==null)break e;m=mt({},m,h);break e;case 2:jr=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else g={eventTime:g,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},l===null?(c=l=g,u=m):l=l.next=g,a|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(l===null&&(u=m),i.baseState=u,i.firstBaseUpdate=c,i.lastBaseUpdate=l,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);bi|=a,e.lanes=a,e.memoizedState=m}}function Q0(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(pe(191,i));i.call(r)}}}var xo={},pr=ci(xo),Qa=ci(xo),Za=ci(xo);function _i(e){if(e===xo)throw Error(pe(174));return e}function df(e,t){switch(rt(Za,t),rt(Qa,e),rt(pr,xo),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Pc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Pc(t,e)}lt(pr),rt(pr,t)}function js(){lt(pr),lt(Qa),lt(Za)}function cx(e){_i(Za.current);var t=_i(pr.current),n=Pc(t,e.type);t!==n&&(rt(Qa,e),rt(pr,n))}function ff(e){Qa.current===e&&(lt(pr),lt(Qa))}var pt=ci(0);function Fl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var rc=[];function pf(){for(var e=0;e<rc.length;e++)rc[e]._workInProgressVersionPrimary=null;rc.length=0}var ol=Pr.ReactCurrentDispatcher,ic=Pr.ReactCurrentBatchConfig,ki=0,ht=null,Nt=null,Ft=null,Pl=!1,Ra=!1,eo=0,EE=0;function Yt(){throw Error(pe(321))}function hf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ir(e[n],t[n]))return!1;return!0}function mf(e,t,n,r,i,s){if(ki=s,ht=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ol.current=e===null||e.memoizedState===null?_E:CE,e=n(r,i),Ra){s=0;do{if(Ra=!1,eo=0,25<=s)throw Error(pe(301));s+=1,Ft=Nt=null,t.updateQueue=null,ol.current=NE,e=n(r,i)}while(Ra)}if(ol.current=Ml,t=Nt!==null&&Nt.next!==null,ki=0,Ft=Nt=ht=null,Pl=!1,t)throw Error(pe(300));return e}function gf(){var e=eo!==0;return eo=0,e}function cr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ft===null?ht.memoizedState=Ft=e:Ft=Ft.next=e,Ft}function jn(){if(Nt===null){var e=ht.alternate;e=e!==null?e.memoizedState:null}else e=Nt.next;var t=Ft===null?ht.memoizedState:Ft.next;if(t!==null)Ft=t,Nt=e;else{if(e===null)throw Error(pe(310));Nt=e,e={memoizedState:Nt.memoizedState,baseState:Nt.baseState,baseQueue:Nt.baseQueue,queue:Nt.queue,next:null},Ft===null?ht.memoizedState=Ft=e:Ft=Ft.next=e}return Ft}function to(e,t){return typeof t=="function"?t(e):t}function sc(e){var t=jn(),n=t.queue;if(n===null)throw Error(pe(311));n.lastRenderedReducer=e;var r=Nt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=a=null,u=null,c=s;do{var l=c.lane;if((ki&l)===l)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var m={lane:l,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(o=u=m,a=r):u=u.next=m,ht.lanes|=l,bi|=l}c=c.next}while(c!==null&&c!==s);u===null?a=r:u.next=o,ir(r,t.memoizedState)||(pn=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do s=i.lane,ht.lanes|=s,bi|=s,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ac(e){var t=jn(),n=t.queue;if(n===null)throw Error(pe(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);ir(s,t.memoizedState)||(pn=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function dx(){}function fx(e,t){var n=ht,r=jn(),i=t(),s=!ir(r.memoizedState,i);if(s&&(r.memoizedState=i,pn=!0),r=r.queue,xf(mx.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||Ft!==null&&Ft.memoizedState.tag&1){if(n.flags|=2048,no(9,hx.bind(null,n,r,i,t),void 0,null),Lt===null)throw Error(pe(349));ki&30||px(n,t,i)}return i}function px(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ht.updateQueue,t===null?(t={lastEffect:null,stores:null},ht.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function hx(e,t,n,r){t.value=n,t.getSnapshot=r,gx(t)&&xx(e)}function mx(e,t,n){return n(function(){gx(t)&&xx(e)})}function gx(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ir(e,n)}catch{return!0}}function xx(e){var t=Ir(e,1);t!==null&&tr(t,e,1,-1)}function Z0(e){var t=cr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:to,lastRenderedState:e},t.queue=e,e=e.dispatch=wE.bind(null,ht,e),[t.memoizedState,e]}function no(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=ht.updateQueue,t===null?(t={lastEffect:null,stores:null},ht.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function vx(){return jn().memoizedState}function ll(e,t,n,r){var i=cr();ht.flags|=e,i.memoizedState=no(1|t,n,void 0,r===void 0?null:r)}function gu(e,t,n,r){var i=jn();r=r===void 0?null:r;var s=void 0;if(Nt!==null){var a=Nt.memoizedState;if(s=a.destroy,r!==null&&hf(r,a.deps)){i.memoizedState=no(t,n,s,r);return}}ht.flags|=e,i.memoizedState=no(1|t,n,s,r)}function ep(e,t){return ll(8390656,8,e,t)}function xf(e,t){return gu(2048,8,e,t)}function yx(e,t){return gu(4,2,e,t)}function Ex(e,t){return gu(4,4,e,t)}function Tx(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Sx(e,t,n){return n=n!=null?n.concat([e]):null,gu(4,4,Tx.bind(null,t,e),n)}function vf(){}function wx(e,t){var n=jn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&hf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function _x(e,t){var n=jn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&hf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Cx(e,t,n){return ki&21?(ir(n,t)||(n=kg(),ht.lanes|=n,bi|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,pn=!0),e.memoizedState=n)}function TE(e,t){var n=Ze;Ze=n!==0&&4>n?n:4,e(!0);var r=ic.transition;ic.transition={};try{e(!1),t()}finally{Ze=n,ic.transition=r}}function Nx(){return jn().memoizedState}function SE(e,t,n){var r=ni(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ax(e))Ix(t,n);else if(n=lx(e,t,n,r),n!==null){var i=ln();tr(n,e,r,i),Rx(n,t,r)}}function wE(e,t,n){var r=ni(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ax(e))Ix(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,n);if(i.hasEagerState=!0,i.eagerState=o,ir(o,a)){var u=t.interleaved;u===null?(i.next=i,uf(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}n=lx(e,t,i,r),n!==null&&(i=ln(),tr(n,e,r,i),Rx(n,t,r))}}function Ax(e){var t=e.alternate;return e===ht||t!==null&&t===ht}function Ix(e,t){Ra=Pl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Rx(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Jd(e,n)}}var Ml={readContext:Vn,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},_E={readContext:Vn,useCallback:function(e,t){return cr().memoizedState=[e,t===void 0?null:t],e},useContext:Vn,useEffect:ep,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ll(4194308,4,Tx.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ll(4194308,4,e,t)},useInsertionEffect:function(e,t){return ll(4,2,e,t)},useMemo:function(e,t){var n=cr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=cr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=SE.bind(null,ht,e),[r.memoizedState,e]},useRef:function(e){var t=cr();return e={current:e},t.memoizedState=e},useState:Z0,useDebugValue:vf,useDeferredValue:function(e){return cr().memoizedState=e},useTransition:function(){var e=Z0(!1),t=e[0];return e=TE.bind(null,e[1]),cr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ht,i=cr();if(dt){if(n===void 0)throw Error(pe(407));n=n()}else{if(n=t(),Lt===null)throw Error(pe(349));ki&30||px(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,ep(mx.bind(null,r,s,e),[e]),r.flags|=2048,no(9,hx.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=cr(),t=Lt.identifierPrefix;if(dt){var n=Tr,r=Er;n=(r&~(1<<32-er(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=eo++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=EE++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},CE={readContext:Vn,useCallback:wx,useContext:Vn,useEffect:xf,useImperativeHandle:Sx,useInsertionEffect:yx,useLayoutEffect:Ex,useMemo:_x,useReducer:sc,useRef:vx,useState:function(){return sc(to)},useDebugValue:vf,useDeferredValue:function(e){var t=jn();return Cx(t,Nt.memoizedState,e)},useTransition:function(){var e=sc(to)[0],t=jn().memoizedState;return[e,t]},useMutableSource:dx,useSyncExternalStore:fx,useId:Nx,unstable_isNewReconciler:!1},NE={readContext:Vn,useCallback:wx,useContext:Vn,useEffect:xf,useImperativeHandle:Sx,useInsertionEffect:yx,useLayoutEffect:Ex,useMemo:_x,useReducer:ac,useRef:vx,useState:function(){return ac(to)},useDebugValue:vf,useDeferredValue:function(e){var t=jn();return Nt===null?t.memoizedState=e:Cx(t,Nt.memoizedState,e)},useTransition:function(){var e=ac(to)[0],t=jn().memoizedState;return[e,t]},useMutableSource:dx,useSyncExternalStore:fx,useId:Nx,unstable_isNewReconciler:!1};function Yn(e,t){if(e&&e.defaultProps){t=mt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ed(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:mt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var xu={isMounted:function(e){return(e=e._reactInternals)?Oi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ln(),i=ni(e),s=Sr(r,i);s.payload=t,n!=null&&(s.callback=n),t=ei(e,s,i),t!==null&&(tr(t,e,i,r),al(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ln(),i=ni(e),s=Sr(r,i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=ei(e,s,i),t!==null&&(tr(t,e,i,r),al(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ln(),r=ni(e),i=Sr(n,r);i.tag=2,t!=null&&(i.callback=t),t=ei(e,i,r),t!==null&&(tr(t,e,r,n),al(t,e,r))}};function tp(e,t,n,r,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,a):t.prototype&&t.prototype.isPureReactComponent?!Ja(n,r)||!Ja(i,s):!0}function kx(e,t,n){var r=!1,i=si,s=t.contextType;return typeof s=="object"&&s!==null?s=Vn(s):(i=mn(t)?Ii:tn.current,r=t.contextTypes,s=(r=r!=null)?Gs(e,i):si),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=xu,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function np(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&xu.enqueueReplaceState(t,t.state,null)}function td(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},cf(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Vn(s):(s=mn(t)?Ii:tn.current,i.context=Gs(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(ed(e,t,s,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&xu.enqueueReplaceState(i,i.state,null),bl(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Hs(e,t){try{var n="",r=t;do n+=e2(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function oc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function nd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var AE=typeof WeakMap=="function"?WeakMap:Map;function bx(e,t,n){n=Sr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ll||(Ll=!0,fd=r),nd(e,t)},n}function Fx(e,t,n){n=Sr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){nd(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){nd(e,t),typeof r!="function"&&(ti===null?ti=new Set([this]):ti.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function rp(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new AE;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=$E.bind(null,e,t,n),t.then(e,e))}function ip(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function sp(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Sr(-1,1),t.tag=2,ei(n,t,1))),n.lanes|=1),e)}var IE=Pr.ReactCurrentOwner,pn=!1;function sn(e,t,n,r){t.child=e===null?ox(t,null,n,r):Vs(t,e.child,n,r)}function ap(e,t,n,r,i){n=n.render;var s=t.ref;return Is(t,i),r=mf(e,t,n,r,s,i),n=gf(),e!==null&&!pn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Rr(e,t,i)):(dt&&n&&nf(t),t.flags|=1,sn(e,t,r,i),t.child)}function op(e,t,n,r,i){if(e===null){var s=n.type;return typeof s=="function"&&!Nf(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,Px(e,t,s,r,i)):(e=fl(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:Ja,n(a,r)&&e.ref===t.ref)return Rr(e,t,i)}return t.flags|=1,e=ri(s,r),e.ref=t.ref,e.return=t,t.child=e}function Px(e,t,n,r,i){if(e!==null){var s=e.memoizedProps;if(Ja(s,r)&&e.ref===t.ref)if(pn=!1,t.pendingProps=r=s,(e.lanes&i)!==0)e.flags&131072&&(pn=!0);else return t.lanes=e.lanes,Rr(e,t,i)}return rd(e,t,n,r,i)}function Mx(e,t,n){var r=t.pendingProps,i=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},rt(Es,Sn),Sn|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,rt(Es,Sn),Sn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,rt(Es,Sn),Sn|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,rt(Es,Sn),Sn|=r;return sn(e,t,i,n),t.child}function Dx(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function rd(e,t,n,r,i){var s=mn(n)?Ii:tn.current;return s=Gs(t,s),Is(t,i),n=mf(e,t,n,r,s,i),r=gf(),e!==null&&!pn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Rr(e,t,i)):(dt&&r&&nf(t),t.flags|=1,sn(e,t,n,i),t.child)}function lp(e,t,n,r,i){if(mn(n)){var s=!0;Nl(t)}else s=!1;if(Is(t,i),t.stateNode===null)ul(e,t),kx(t,n,r),td(t,n,r,i),r=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var u=a.context,c=n.contextType;typeof c=="object"&&c!==null?c=Vn(c):(c=mn(n)?Ii:tn.current,c=Gs(t,c));var l=n.getDerivedStateFromProps,m=typeof l=="function"||typeof a.getSnapshotBeforeUpdate=="function";m||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||u!==c)&&np(t,a,r,c),jr=!1;var h=t.memoizedState;a.state=h,bl(t,r,a,i),u=t.memoizedState,o!==r||h!==u||hn.current||jr?(typeof l=="function"&&(ed(t,n,l,r),u=t.memoizedState),(o=jr||tp(t,n,o,r,h,u,c))?(m||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=c,r=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,ux(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Yn(t.type,o),a.props=c,m=t.pendingProps,h=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=Vn(u):(u=mn(n)?Ii:tn.current,u=Gs(t,u));var g=n.getDerivedStateFromProps;(l=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==m||h!==u)&&np(t,a,r,u),jr=!1,h=t.memoizedState,a.state=h,bl(t,r,a,i);var x=t.memoizedState;o!==m||h!==x||hn.current||jr?(typeof g=="function"&&(ed(t,n,g,r),x=t.memoizedState),(c=jr||tp(t,n,c,r,h,x,u)||!1)?(l||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,x,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,x,u)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=x),a.props=r,a.state=x,a.context=u,r=c):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return id(e,t,n,r,s,i)}function id(e,t,n,r,i,s){Dx(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return i&&W0(t,n,!1),Rr(e,t,s);r=t.stateNode,IE.current=t;var o=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=Vs(t,e.child,null,s),t.child=Vs(t,null,o,s)):sn(e,t,o,s),t.memoizedState=r.state,i&&W0(t,n,!0),t.child}function Lx(e){var t=e.stateNode;t.pendingContext?q0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&q0(e,t.context,!1),df(e,t.containerInfo)}function up(e,t,n,r,i){return $s(),sf(i),t.flags|=256,sn(e,t,n,r),t.child}var sd={dehydrated:null,treeContext:null,retryLane:0};function ad(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ox(e,t,n){var r=t.pendingProps,i=pt.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),rt(pt,i&1),e===null)return Qc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,s?(r=t.mode,s=t.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Eu(a,r,0,null),e=Ni(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=ad(n),t.memoizedState=sd,e):yf(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return RE(e,t,a,r,o,i,n);if(s){s=r.fallback,a=t.mode,i=e.child,o=i.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=ri(i,u),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=ri(o,s):(s=Ni(s,a,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,a=e.child.memoizedState,a=a===null?ad(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~n,t.memoizedState=sd,r}return s=e.child,e=s.sibling,r=ri(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function yf(e,t){return t=Eu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Vo(e,t,n,r){return r!==null&&sf(r),Vs(t,e.child,null,n),e=yf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function RE(e,t,n,r,i,s,a){if(n)return t.flags&256?(t.flags&=-257,r=oc(Error(pe(422))),Vo(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Eu({mode:"visible",children:r.children},i,0,null),s=Ni(s,i,a,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&Vs(t,e.child,null,a),t.child.memoizedState=ad(a),t.memoizedState=sd,s);if(!(t.mode&1))return Vo(e,t,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(pe(419)),r=oc(s,r,void 0),Vo(e,t,a,r)}if(o=(a&e.childLanes)!==0,pn||o){if(r=Lt,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ir(e,i),tr(r,e,i,-1))}return Cf(),r=oc(Error(pe(421))),Vo(e,t,a,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=VE.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Nn=Zr(i.nextSibling),An=t,dt=!0,Xn=null,e!==null&&(On[Un++]=Er,On[Un++]=Tr,On[Un++]=Ri,Er=e.id,Tr=e.overflow,Ri=t),t=yf(t,r.children),t.flags|=4096,t)}function cp(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Zc(e.return,t,n)}function lc(e,t,n,r,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Ux(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(sn(e,t,r.children,n),r=pt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&cp(e,n,t);else if(e.tag===19)cp(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(rt(pt,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Fl(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),lc(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Fl(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}lc(t,!0,n,null,s);break;case"together":lc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ul(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Rr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),bi|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(pe(153));if(t.child!==null){for(e=t.child,n=ri(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ri(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function kE(e,t,n){switch(t.tag){case 3:Lx(t),$s();break;case 5:cx(t);break;case 1:mn(t.type)&&Nl(t);break;case 4:df(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;rt(Rl,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(rt(pt,pt.current&1),t.flags|=128,null):n&t.child.childLanes?Ox(e,t,n):(rt(pt,pt.current&1),e=Rr(e,t,n),e!==null?e.sibling:null);rt(pt,pt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Ux(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),rt(pt,pt.current),r)break;return null;case 22:case 23:return t.lanes=0,Mx(e,t,n)}return Rr(e,t,n)}var Bx,od,Gx,$x;Bx=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};od=function(){};Gx=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,_i(pr.current);var s=null;switch(n){case"input":i=Rc(e,i),r=Rc(e,r),s=[];break;case"select":i=mt({},i,{value:void 0}),r=mt({},r,{value:void 0}),s=[];break;case"textarea":i=Fc(e,i),r=Fc(e,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=_l)}Mc(n,r);var a;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&($a.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var u=r[c];if(o=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&u!==o&&(u!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&o[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(s||(s=[]),s.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(s=s||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&($a.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&at("scroll",e),s||o===u||(s=[])):(s=s||[]).push(c,u))}n&&(s=s||[]).push("style",n);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};$x=function(e,t,n,r){n!==r&&(t.flags|=4)};function ha(e,t){if(!dt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Kt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function bE(e,t,n){var r=t.pendingProps;switch(rf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(t),null;case 1:return mn(t.type)&&Cl(),Kt(t),null;case 3:return r=t.stateNode,js(),lt(hn),lt(tn),pf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Go(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Xn!==null&&(md(Xn),Xn=null))),od(e,t),Kt(t),null;case 5:ff(t);var i=_i(Za.current);if(n=t.type,e!==null&&t.stateNode!=null)Gx(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(pe(166));return Kt(t),null}if(e=_i(pr.current),Go(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[dr]=t,r[Xa]=s,e=(t.mode&1)!==0,n){case"dialog":at("cancel",r),at("close",r);break;case"iframe":case"object":case"embed":at("load",r);break;case"video":case"audio":for(i=0;i<Sa.length;i++)at(Sa[i],r);break;case"source":at("error",r);break;case"img":case"image":case"link":at("error",r),at("load",r);break;case"details":at("toggle",r);break;case"input":y0(r,s),at("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},at("invalid",r);break;case"textarea":T0(r,s),at("invalid",r)}Mc(n,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&Bo(r.textContent,o,e),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Bo(r.textContent,o,e),i=["children",""+o]):$a.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&at("scroll",r)}switch(n){case"input":bo(r),E0(r,s,!0);break;case"textarea":bo(r),S0(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=_l)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=mg(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[dr]=t,e[Xa]=r,Bx(e,t,!1,!1),t.stateNode=e;e:{switch(a=Dc(n,r),n){case"dialog":at("cancel",e),at("close",e),i=r;break;case"iframe":case"object":case"embed":at("load",e),i=r;break;case"video":case"audio":for(i=0;i<Sa.length;i++)at(Sa[i],e);i=r;break;case"source":at("error",e),i=r;break;case"img":case"image":case"link":at("error",e),at("load",e),i=r;break;case"details":at("toggle",e),i=r;break;case"input":y0(e,r),i=Rc(e,r),at("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=mt({},r,{value:void 0}),at("invalid",e);break;case"textarea":T0(e,r),i=Fc(e,r),at("invalid",e);break;default:i=r}Mc(n,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var u=o[s];s==="style"?vg(e,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&gg(e,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Va(e,u):typeof u=="number"&&Va(e,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&($a.hasOwnProperty(s)?u!=null&&s==="onScroll"&&at("scroll",e):u!=null&&Vd(e,s,u,a))}switch(n){case"input":bo(e),E0(e,r,!1);break;case"textarea":bo(e),S0(e);break;case"option":r.value!=null&&e.setAttribute("value",""+ii(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?_s(e,!!r.multiple,s,!1):r.defaultValue!=null&&_s(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=_l)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Kt(t),null;case 6:if(e&&t.stateNode!=null)$x(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(pe(166));if(n=_i(Za.current),_i(pr.current),Go(t)){if(r=t.stateNode,n=t.memoizedProps,r[dr]=t,(s=r.nodeValue!==n)&&(e=An,e!==null))switch(e.tag){case 3:Bo(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Bo(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[dr]=t,t.stateNode=r}return Kt(t),null;case 13:if(lt(pt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(dt&&Nn!==null&&t.mode&1&&!(t.flags&128))sx(),$s(),t.flags|=98560,s=!1;else if(s=Go(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(pe(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(pe(317));s[dr]=t}else $s(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Kt(t),s=!1}else Xn!==null&&(md(Xn),Xn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||pt.current&1?At===0&&(At=3):Cf())),t.updateQueue!==null&&(t.flags|=4),Kt(t),null);case 4:return js(),od(e,t),e===null&&Ya(t.stateNode.containerInfo),Kt(t),null;case 10:return lf(t.type._context),Kt(t),null;case 17:return mn(t.type)&&Cl(),Kt(t),null;case 19:if(lt(pt),s=t.memoizedState,s===null)return Kt(t),null;if(r=(t.flags&128)!==0,a=s.rendering,a===null)if(r)ha(s,!1);else{if(At!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Fl(e),a!==null){for(t.flags|=128,ha(s,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return rt(pt,pt.current&1|2),t.child}e=e.sibling}s.tail!==null&&Et()>zs&&(t.flags|=128,r=!0,ha(s,!1),t.lanes=4194304)}else{if(!r)if(e=Fl(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ha(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!dt)return Kt(t),null}else 2*Et()-s.renderingStartTime>zs&&n!==1073741824&&(t.flags|=128,r=!0,ha(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(n=s.last,n!==null?n.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Et(),t.sibling=null,n=pt.current,rt(pt,r?n&1|2:n&1),t):(Kt(t),null);case 22:case 23:return _f(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Sn&1073741824&&(Kt(t),t.subtreeFlags&6&&(t.flags|=8192)):Kt(t),null;case 24:return null;case 25:return null}throw Error(pe(156,t.tag))}function FE(e,t){switch(rf(t),t.tag){case 1:return mn(t.type)&&Cl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return js(),lt(hn),lt(tn),pf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return ff(t),null;case 13:if(lt(pt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(pe(340));$s()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return lt(pt),null;case 4:return js(),null;case 10:return lf(t.type._context),null;case 22:case 23:return _f(),null;case 24:return null;default:return null}}var jo=!1,Xt=!1,PE=typeof WeakSet=="function"?WeakSet:Set,Re=null;function ys(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){gt(e,t,r)}else n.current=null}function ld(e,t,n){try{n()}catch(r){gt(e,t,r)}}var dp=!1;function ME(e,t){if(zc=Tl,e=qg(),tf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,o=-1,u=-1,c=0,l=0,m=e,h=null;t:for(;;){for(var g;m!==n||i!==0&&m.nodeType!==3||(o=a+i),m!==s||r!==0&&m.nodeType!==3||(u=a+r),m.nodeType===3&&(a+=m.nodeValue.length),(g=m.firstChild)!==null;)h=m,m=g;for(;;){if(m===e)break t;if(h===n&&++c===i&&(o=a),h===s&&++l===r&&(u=a),(g=m.nextSibling)!==null)break;m=h,h=m.parentNode}m=g}n=o===-1||u===-1?null:{start:o,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(qc={focusedElem:e,selectionRange:n},Tl=!1,Re=t;Re!==null;)if(t=Re,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Re=e;else for(;Re!==null;){t=Re;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var v=x.memoizedProps,w=x.memoizedState,E=t.stateNode,y=E.getSnapshotBeforeUpdate(t.elementType===t.type?v:Yn(t.type,v),w);E.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var T=t.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pe(163))}}catch(C){gt(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,Re=e;break}Re=t.return}return x=dp,dp=!1,x}function ka(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&ld(t,n,s)}i=i.next}while(i!==r)}}function vu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ud(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Vx(e){var t=e.alternate;t!==null&&(e.alternate=null,Vx(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[dr],delete t[Xa],delete t[Yc],delete t[gE],delete t[xE])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function jx(e){return e.tag===5||e.tag===3||e.tag===4}function fp(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||jx(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function cd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=_l));else if(r!==4&&(e=e.child,e!==null))for(cd(e,t,n),e=e.sibling;e!==null;)cd(e,t,n),e=e.sibling}function dd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(dd(e,t,n),e=e.sibling;e!==null;)dd(e,t,n),e=e.sibling}var Ut=null,Kn=!1;function Br(e,t,n){for(n=n.child;n!==null;)Hx(e,t,n),n=n.sibling}function Hx(e,t,n){if(fr&&typeof fr.onCommitFiberUnmount=="function")try{fr.onCommitFiberUnmount(cu,n)}catch{}switch(n.tag){case 5:Xt||ys(n,t);case 6:var r=Ut,i=Kn;Ut=null,Br(e,t,n),Ut=r,Kn=i,Ut!==null&&(Kn?(e=Ut,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ut.removeChild(n.stateNode));break;case 18:Ut!==null&&(Kn?(e=Ut,n=n.stateNode,e.nodeType===8?tc(e.parentNode,n):e.nodeType===1&&tc(e,n),qa(e)):tc(Ut,n.stateNode));break;case 4:r=Ut,i=Kn,Ut=n.stateNode.containerInfo,Kn=!0,Br(e,t,n),Ut=r,Kn=i;break;case 0:case 11:case 14:case 15:if(!Xt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&ld(n,t,a),i=i.next}while(i!==r)}Br(e,t,n);break;case 1:if(!Xt&&(ys(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){gt(n,t,o)}Br(e,t,n);break;case 21:Br(e,t,n);break;case 22:n.mode&1?(Xt=(r=Xt)||n.memoizedState!==null,Br(e,t,n),Xt=r):Br(e,t,n);break;default:Br(e,t,n)}}function pp(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new PE),t.forEach(function(r){var i=jE.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function qn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:Ut=o.stateNode,Kn=!1;break e;case 3:Ut=o.stateNode.containerInfo,Kn=!0;break e;case 4:Ut=o.stateNode.containerInfo,Kn=!0;break e}o=o.return}if(Ut===null)throw Error(pe(160));Hx(s,a,i),Ut=null,Kn=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(c){gt(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)zx(t,e),t=t.sibling}function zx(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(qn(t,e),or(e),r&4){try{ka(3,e,e.return),vu(3,e)}catch(v){gt(e,e.return,v)}try{ka(5,e,e.return)}catch(v){gt(e,e.return,v)}}break;case 1:qn(t,e),or(e),r&512&&n!==null&&ys(n,n.return);break;case 5:if(qn(t,e),or(e),r&512&&n!==null&&ys(n,n.return),e.flags&32){var i=e.stateNode;try{Va(i,"")}catch(v){gt(e,e.return,v)}}if(r&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=n!==null?n.memoizedProps:s,o=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&pg(i,s),Dc(o,a);var c=Dc(o,s);for(a=0;a<u.length;a+=2){var l=u[a],m=u[a+1];l==="style"?vg(i,m):l==="dangerouslySetInnerHTML"?gg(i,m):l==="children"?Va(i,m):Vd(i,l,m,c)}switch(o){case"input":kc(i,s);break;case"textarea":hg(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?_s(i,!!s.multiple,g,!1):h!==!!s.multiple&&(s.defaultValue!=null?_s(i,!!s.multiple,s.defaultValue,!0):_s(i,!!s.multiple,s.multiple?[]:"",!1))}i[Xa]=s}catch(v){gt(e,e.return,v)}}break;case 6:if(qn(t,e),or(e),r&4){if(e.stateNode===null)throw Error(pe(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(v){gt(e,e.return,v)}}break;case 3:if(qn(t,e),or(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{qa(t.containerInfo)}catch(v){gt(e,e.return,v)}break;case 4:qn(t,e),or(e);break;case 13:qn(t,e),or(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Sf=Et())),r&4&&pp(e);break;case 22:if(l=n!==null&&n.memoizedState!==null,e.mode&1?(Xt=(c=Xt)||l,qn(t,e),Xt=c):qn(t,e),or(e),r&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!l&&e.mode&1)for(Re=e,l=e.child;l!==null;){for(m=Re=l;Re!==null;){switch(h=Re,g=h.child,h.tag){case 0:case 11:case 14:case 15:ka(4,h,h.return);break;case 1:ys(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(v){gt(r,n,v)}}break;case 5:ys(h,h.return);break;case 22:if(h.memoizedState!==null){mp(m);continue}}g!==null?(g.return=h,Re=g):mp(m)}l=l.sibling}e:for(l=null,m=e;;){if(m.tag===5){if(l===null){l=m;try{i=m.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=m.stateNode,u=m.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=xg("display",a))}catch(v){gt(e,e.return,v)}}}else if(m.tag===6){if(l===null)try{m.stateNode.nodeValue=c?"":m.memoizedProps}catch(v){gt(e,e.return,v)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;l===m&&(l=null),m=m.return}l===m&&(l=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:qn(t,e),or(e),r&4&&pp(e);break;case 21:break;default:qn(t,e),or(e)}}function or(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(jx(n)){var r=n;break e}n=n.return}throw Error(pe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Va(i,""),r.flags&=-33);var s=fp(e);dd(e,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,o=fp(e);cd(e,o,a);break;default:throw Error(pe(161))}}catch(u){gt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function DE(e,t,n){Re=e,qx(e)}function qx(e,t,n){for(var r=(e.mode&1)!==0;Re!==null;){var i=Re,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||jo;if(!a){var o=i.alternate,u=o!==null&&o.memoizedState!==null||Xt;o=jo;var c=Xt;if(jo=a,(Xt=u)&&!c)for(Re=i;Re!==null;)a=Re,u=a.child,a.tag===22&&a.memoizedState!==null?gp(i):u!==null?(u.return=a,Re=u):gp(i);for(;s!==null;)Re=s,qx(s),s=s.sibling;Re=i,jo=o,Xt=c}hp(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Re=s):hp(e)}}function hp(e){for(;Re!==null;){var t=Re;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Xt||vu(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Xt)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:Yn(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Q0(t,s,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Q0(t,a,n)}break;case 5:var o=t.stateNode;if(n===null&&t.flags&4){n=o;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var l=c.memoizedState;if(l!==null){var m=l.dehydrated;m!==null&&qa(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pe(163))}Xt||t.flags&512&&ud(t)}catch(h){gt(t,t.return,h)}}if(t===e){Re=null;break}if(n=t.sibling,n!==null){n.return=t.return,Re=n;break}Re=t.return}}function mp(e){for(;Re!==null;){var t=Re;if(t===e){Re=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Re=n;break}Re=t.return}}function gp(e){for(;Re!==null;){var t=Re;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{vu(4,t)}catch(u){gt(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(u){gt(t,i,u)}}var s=t.return;try{ud(t)}catch(u){gt(t,s,u)}break;case 5:var a=t.return;try{ud(t)}catch(u){gt(t,a,u)}}}catch(u){gt(t,t.return,u)}if(t===e){Re=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Re=o;break}Re=t.return}}var LE=Math.ceil,Dl=Pr.ReactCurrentDispatcher,Ef=Pr.ReactCurrentOwner,Gn=Pr.ReactCurrentBatchConfig,He=0,Lt=null,St=null,Ht=0,Sn=0,Es=ci(0),At=0,ro=null,bi=0,yu=0,Tf=0,ba=null,fn=null,Sf=0,zs=1/0,vr=null,Ll=!1,fd=null,ti=null,Ho=!1,Wr=null,Ol=0,Fa=0,pd=null,cl=-1,dl=0;function ln(){return He&6?Et():cl!==-1?cl:cl=Et()}function ni(e){return e.mode&1?He&2&&Ht!==0?Ht&-Ht:yE.transition!==null?(dl===0&&(dl=kg()),dl):(e=Ze,e!==0||(e=window.event,e=e===void 0?16:Og(e.type)),e):1}function tr(e,t,n,r){if(50<Fa)throw Fa=0,pd=null,Error(pe(185));ho(e,n,r),(!(He&2)||e!==Lt)&&(e===Lt&&(!(He&2)&&(yu|=n),At===4&&zr(e,Ht)),gn(e,r),n===1&&He===0&&!(t.mode&1)&&(zs=Et()+500,mu&&di()))}function gn(e,t){var n=e.callbackNode;y2(e,t);var r=El(e,e===Lt?Ht:0);if(r===0)n!==null&&C0(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&C0(n),t===1)e.tag===0?vE(xp.bind(null,e)):nx(xp.bind(null,e)),hE(function(){!(He&6)&&di()}),n=null;else{switch(bg(r)){case 1:n=Wd;break;case 4:n=Ig;break;case 16:n=yl;break;case 536870912:n=Rg;break;default:n=yl}n=e1(n,Wx.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Wx(e,t){if(cl=-1,dl=0,He&6)throw Error(pe(327));var n=e.callbackNode;if(Rs()&&e.callbackNode!==n)return null;var r=El(e,e===Lt?Ht:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Ul(e,r);else{t=r;var i=He;He|=2;var s=Yx();(Lt!==e||Ht!==t)&&(vr=null,zs=Et()+500,Ci(e,t));do try{BE();break}catch(o){Jx(e,o)}while(!0);of(),Dl.current=s,He=i,St!==null?t=0:(Lt=null,Ht=0,t=At)}if(t!==0){if(t===2&&(i=Gc(e),i!==0&&(r=i,t=hd(e,i))),t===1)throw n=ro,Ci(e,0),zr(e,r),gn(e,Et()),n;if(t===6)zr(e,r);else{if(i=e.current.alternate,!(r&30)&&!OE(i)&&(t=Ul(e,r),t===2&&(s=Gc(e),s!==0&&(r=s,t=hd(e,s))),t===1))throw n=ro,Ci(e,0),zr(e,r),gn(e,Et()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(pe(345));case 2:yi(e,fn,vr);break;case 3:if(zr(e,r),(r&130023424)===r&&(t=Sf+500-Et(),10<t)){if(El(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){ln(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Jc(yi.bind(null,e,fn,vr),t);break}yi(e,fn,vr);break;case 4:if(zr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-er(r);s=1<<a,a=t[a],a>i&&(i=a),r&=~s}if(r=i,r=Et()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*LE(r/1960))-r,10<r){e.timeoutHandle=Jc(yi.bind(null,e,fn,vr),r);break}yi(e,fn,vr);break;case 5:yi(e,fn,vr);break;default:throw Error(pe(329))}}}return gn(e,Et()),e.callbackNode===n?Wx.bind(null,e):null}function hd(e,t){var n=ba;return e.current.memoizedState.isDehydrated&&(Ci(e,t).flags|=256),e=Ul(e,t),e!==2&&(t=fn,fn=n,t!==null&&md(t)),e}function md(e){fn===null?fn=e:fn.push.apply(fn,e)}function OE(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ir(s(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function zr(e,t){for(t&=~Tf,t&=~yu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-er(t),r=1<<n;e[n]=-1,t&=~r}}function xp(e){if(He&6)throw Error(pe(327));Rs();var t=El(e,0);if(!(t&1))return gn(e,Et()),null;var n=Ul(e,t);if(e.tag!==0&&n===2){var r=Gc(e);r!==0&&(t=r,n=hd(e,r))}if(n===1)throw n=ro,Ci(e,0),zr(e,t),gn(e,Et()),n;if(n===6)throw Error(pe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,yi(e,fn,vr),gn(e,Et()),null}function wf(e,t){var n=He;He|=1;try{return e(t)}finally{He=n,He===0&&(zs=Et()+500,mu&&di())}}function Fi(e){Wr!==null&&Wr.tag===0&&!(He&6)&&Rs();var t=He;He|=1;var n=Gn.transition,r=Ze;try{if(Gn.transition=null,Ze=1,e)return e()}finally{Ze=r,Gn.transition=n,He=t,!(He&6)&&di()}}function _f(){Sn=Es.current,lt(Es)}function Ci(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,pE(n)),St!==null)for(n=St.return;n!==null;){var r=n;switch(rf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Cl();break;case 3:js(),lt(hn),lt(tn),pf();break;case 5:ff(r);break;case 4:js();break;case 13:lt(pt);break;case 19:lt(pt);break;case 10:lf(r.type._context);break;case 22:case 23:_f()}n=n.return}if(Lt=e,St=e=ri(e.current,null),Ht=Sn=t,At=0,ro=null,Tf=yu=bi=0,fn=ba=null,wi!==null){for(t=0;t<wi.length;t++)if(n=wi[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}n.pending=r}wi=null}return e}function Jx(e,t){do{var n=St;try{if(of(),ol.current=Ml,Pl){for(var r=ht.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Pl=!1}if(ki=0,Ft=Nt=ht=null,Ra=!1,eo=0,Ef.current=null,n===null||n.return===null){At=1,ro=t,St=null;break}e:{var s=e,a=n.return,o=n,u=t;if(t=Ht,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,l=o,m=l.tag;if(!(l.mode&1)&&(m===0||m===11||m===15)){var h=l.alternate;h?(l.updateQueue=h.updateQueue,l.memoizedState=h.memoizedState,l.lanes=h.lanes):(l.updateQueue=null,l.memoizedState=null)}var g=ip(a);if(g!==null){g.flags&=-257,sp(g,a,o,s,t),g.mode&1&&rp(s,c,t),t=g,u=c;var x=t.updateQueue;if(x===null){var v=new Set;v.add(u),t.updateQueue=v}else x.add(u);break e}else{if(!(t&1)){rp(s,c,t),Cf();break e}u=Error(pe(426))}}else if(dt&&o.mode&1){var w=ip(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),sp(w,a,o,s,t),sf(Hs(u,o));break e}}s=u=Hs(u,o),At!==4&&(At=2),ba===null?ba=[s]:ba.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var E=bx(s,u,t);X0(s,E);break e;case 1:o=u;var y=s.type,T=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(ti===null||!ti.has(T)))){s.flags|=65536,t&=-t,s.lanes|=t;var C=Fx(s,o,t);X0(s,C);break e}}s=s.return}while(s!==null)}Xx(n)}catch(L){t=L,St===n&&n!==null&&(St=n=n.return);continue}break}while(!0)}function Yx(){var e=Dl.current;return Dl.current=Ml,e===null?Ml:e}function Cf(){(At===0||At===3||At===2)&&(At=4),Lt===null||!(bi&268435455)&&!(yu&268435455)||zr(Lt,Ht)}function Ul(e,t){var n=He;He|=2;var r=Yx();(Lt!==e||Ht!==t)&&(vr=null,Ci(e,t));do try{UE();break}catch(i){Jx(e,i)}while(!0);if(of(),He=n,Dl.current=r,St!==null)throw Error(pe(261));return Lt=null,Ht=0,At}function UE(){for(;St!==null;)Kx(St)}function BE(){for(;St!==null&&!c2();)Kx(St)}function Kx(e){var t=Zx(e.alternate,e,Sn);e.memoizedProps=e.pendingProps,t===null?Xx(e):St=t,Ef.current=null}function Xx(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=FE(n,t),n!==null){n.flags&=32767,St=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{At=6,St=null;return}}else if(n=bE(n,t,Sn),n!==null){St=n;return}if(t=t.sibling,t!==null){St=t;return}St=t=e}while(t!==null);At===0&&(At=5)}function yi(e,t,n){var r=Ze,i=Gn.transition;try{Gn.transition=null,Ze=1,GE(e,t,n,r)}finally{Gn.transition=i,Ze=r}return null}function GE(e,t,n,r){do Rs();while(Wr!==null);if(He&6)throw Error(pe(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(pe(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(E2(e,s),e===Lt&&(St=Lt=null,Ht=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ho||(Ho=!0,e1(yl,function(){return Rs(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Gn.transition,Gn.transition=null;var a=Ze;Ze=1;var o=He;He|=4,Ef.current=null,ME(e,n),zx(n,e),aE(qc),Tl=!!zc,qc=zc=null,e.current=n,DE(n),d2(),He=o,Ze=a,Gn.transition=s}else e.current=n;if(Ho&&(Ho=!1,Wr=e,Ol=i),s=e.pendingLanes,s===0&&(ti=null),h2(n.stateNode),gn(e,Et()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ll)throw Ll=!1,e=fd,fd=null,e;return Ol&1&&e.tag!==0&&Rs(),s=e.pendingLanes,s&1?e===pd?Fa++:(Fa=0,pd=e):Fa=0,di(),null}function Rs(){if(Wr!==null){var e=bg(Ol),t=Gn.transition,n=Ze;try{if(Gn.transition=null,Ze=16>e?16:e,Wr===null)var r=!1;else{if(e=Wr,Wr=null,Ol=0,He&6)throw Error(pe(331));var i=He;for(He|=4,Re=e.current;Re!==null;){var s=Re,a=s.child;if(Re.flags&16){var o=s.deletions;if(o!==null){for(var u=0;u<o.length;u++){var c=o[u];for(Re=c;Re!==null;){var l=Re;switch(l.tag){case 0:case 11:case 15:ka(8,l,s)}var m=l.child;if(m!==null)m.return=l,Re=m;else for(;Re!==null;){l=Re;var h=l.sibling,g=l.return;if(Vx(l),l===c){Re=null;break}if(h!==null){h.return=g,Re=h;break}Re=g}}}var x=s.alternate;if(x!==null){var v=x.child;if(v!==null){x.child=null;do{var w=v.sibling;v.sibling=null,v=w}while(v!==null)}}Re=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Re=a;else e:for(;Re!==null;){if(s=Re,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ka(9,s,s.return)}var E=s.sibling;if(E!==null){E.return=s.return,Re=E;break e}Re=s.return}}var y=e.current;for(Re=y;Re!==null;){a=Re;var T=a.child;if(a.subtreeFlags&2064&&T!==null)T.return=a,Re=T;else e:for(a=y;Re!==null;){if(o=Re,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:vu(9,o)}}catch(L){gt(o,o.return,L)}if(o===a){Re=null;break e}var C=o.sibling;if(C!==null){C.return=o.return,Re=C;break e}Re=o.return}}if(He=i,di(),fr&&typeof fr.onPostCommitFiberRoot=="function")try{fr.onPostCommitFiberRoot(cu,e)}catch{}r=!0}return r}finally{Ze=n,Gn.transition=t}}return!1}function vp(e,t,n){t=Hs(n,t),t=bx(e,t,1),e=ei(e,t,1),t=ln(),e!==null&&(ho(e,1,t),gn(e,t))}function gt(e,t,n){if(e.tag===3)vp(e,e,n);else for(;t!==null;){if(t.tag===3){vp(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ti===null||!ti.has(r))){e=Hs(n,e),e=Fx(t,e,1),t=ei(t,e,1),e=ln(),t!==null&&(ho(t,1,e),gn(t,e));break}}t=t.return}}function $E(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=ln(),e.pingedLanes|=e.suspendedLanes&n,Lt===e&&(Ht&n)===n&&(At===4||At===3&&(Ht&130023424)===Ht&&500>Et()-Sf?Ci(e,0):Tf|=n),gn(e,t)}function Qx(e,t){t===0&&(e.mode&1?(t=Mo,Mo<<=1,!(Mo&130023424)&&(Mo=4194304)):t=1);var n=ln();e=Ir(e,t),e!==null&&(ho(e,t,n),gn(e,n))}function VE(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Qx(e,n)}function jE(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(pe(314))}r!==null&&r.delete(t),Qx(e,n)}var Zx;Zx=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||hn.current)pn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return pn=!1,kE(e,t,n);pn=!!(e.flags&131072)}else pn=!1,dt&&t.flags&1048576&&rx(t,Il,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;ul(e,t),e=t.pendingProps;var i=Gs(t,tn.current);Is(t,n),i=mf(null,t,r,e,i,n);var s=gf();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,mn(r)?(s=!0,Nl(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,cf(t),i.updater=xu,t.stateNode=i,i._reactInternals=t,td(t,r,e,n),t=id(null,t,r,!0,s,n)):(t.tag=0,dt&&s&&nf(t),sn(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(ul(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=zE(r),e=Yn(r,e),i){case 0:t=rd(null,t,r,e,n);break e;case 1:t=lp(null,t,r,e,n);break e;case 11:t=ap(null,t,r,e,n);break e;case 14:t=op(null,t,r,Yn(r.type,e),n);break e}throw Error(pe(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Yn(r,i),rd(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Yn(r,i),lp(e,t,r,i,n);case 3:e:{if(Lx(t),e===null)throw Error(pe(387));r=t.pendingProps,s=t.memoizedState,i=s.element,ux(e,t),bl(t,r,null,n);var a=t.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Hs(Error(pe(423)),t),t=up(e,t,r,n,i);break e}else if(r!==i){i=Hs(Error(pe(424)),t),t=up(e,t,r,n,i);break e}else for(Nn=Zr(t.stateNode.containerInfo.firstChild),An=t,dt=!0,Xn=null,n=ox(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if($s(),r===i){t=Rr(e,t,n);break e}sn(e,t,r,n)}t=t.child}return t;case 5:return cx(t),e===null&&Qc(t),r=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,Wc(r,i)?a=null:s!==null&&Wc(r,s)&&(t.flags|=32),Dx(e,t),sn(e,t,a,n),t.child;case 6:return e===null&&Qc(t),null;case 13:return Ox(e,t,n);case 4:return df(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Vs(t,null,r,n):sn(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Yn(r,i),ap(e,t,r,i,n);case 7:return sn(e,t,t.pendingProps,n),t.child;case 8:return sn(e,t,t.pendingProps.children,n),t.child;case 12:return sn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,rt(Rl,r._currentValue),r._currentValue=a,s!==null)if(ir(s.value,a)){if(s.children===i.children&&!hn.current){t=Rr(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var u=o.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=Sr(-1,n&-n),u.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var l=c.pending;l===null?u.next=u:(u.next=l.next,l.next=u),c.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),Zc(s.return,n,t),o.lanes|=n;break}u=u.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(pe(341));a.lanes|=n,o=a.alternate,o!==null&&(o.lanes|=n),Zc(a,n,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}sn(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Is(t,n),i=Vn(i),r=r(i),t.flags|=1,sn(e,t,r,n),t.child;case 14:return r=t.type,i=Yn(r,t.pendingProps),i=Yn(r.type,i),op(e,t,r,i,n);case 15:return Px(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Yn(r,i),ul(e,t),t.tag=1,mn(r)?(e=!0,Nl(t)):e=!1,Is(t,n),kx(t,r,i),td(t,r,i,n),id(null,t,r,!0,e,n);case 19:return Ux(e,t,n);case 22:return Mx(e,t,n)}throw Error(pe(156,t.tag))};function e1(e,t){return Ag(e,t)}function HE(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bn(e,t,n,r){return new HE(e,t,n,r)}function Nf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function zE(e){if(typeof e=="function")return Nf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Hd)return 11;if(e===zd)return 14}return 2}function ri(e,t){var n=e.alternate;return n===null?(n=Bn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function fl(e,t,n,r,i,s){var a=2;if(r=e,typeof e=="function")Nf(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case cs:return Ni(n.children,i,s,t);case jd:a=8,i|=8;break;case Cc:return e=Bn(12,n,t,i|2),e.elementType=Cc,e.lanes=s,e;case Nc:return e=Bn(13,n,t,i),e.elementType=Nc,e.lanes=s,e;case Ac:return e=Bn(19,n,t,i),e.elementType=Ac,e.lanes=s,e;case cg:return Eu(n,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case lg:a=10;break e;case ug:a=9;break e;case Hd:a=11;break e;case zd:a=14;break e;case Vr:a=16,r=null;break e}throw Error(pe(130,e==null?e:typeof e,""))}return t=Bn(a,n,t,i),t.elementType=e,t.type=r,t.lanes=s,t}function Ni(e,t,n,r){return e=Bn(7,e,r,t),e.lanes=n,e}function Eu(e,t,n,r){return e=Bn(22,e,r,t),e.elementType=cg,e.lanes=n,e.stateNode={isHidden:!1},e}function uc(e,t,n){return e=Bn(6,e,null,t),e.lanes=n,e}function cc(e,t,n){return t=Bn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qE(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hu(0),this.expirationTimes=Hu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hu(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Af(e,t,n,r,i,s,a,o,u){return e=new qE(e,t,n,o,u),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Bn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},cf(s),e}function WE(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:us,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function t1(e){if(!e)return si;e=e._reactInternals;e:{if(Oi(e)!==e||e.tag!==1)throw Error(pe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(mn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(pe(171))}if(e.tag===1){var n=e.type;if(mn(n))return tx(e,n,t)}return t}function n1(e,t,n,r,i,s,a,o,u){return e=Af(n,r,!0,e,i,s,a,o,u),e.context=t1(null),n=e.current,r=ln(),i=ni(n),s=Sr(r,i),s.callback=t??null,ei(n,s,i),e.current.lanes=i,ho(e,i,r),gn(e,r),e}function Tu(e,t,n,r){var i=t.current,s=ln(),a=ni(i);return n=t1(n),t.context===null?t.context=n:t.pendingContext=n,t=Sr(s,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ei(i,t,a),e!==null&&(tr(e,i,a,s),al(e,i,a)),a}function Bl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function yp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function If(e,t){yp(e,t),(e=e.alternate)&&yp(e,t)}function JE(){return null}var r1=typeof reportError=="function"?reportError:function(e){console.error(e)};function Rf(e){this._internalRoot=e}Su.prototype.render=Rf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(pe(409));Tu(e,t,null,null)};Su.prototype.unmount=Rf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Fi(function(){Tu(null,e,null,null)}),t[Ar]=null}};function Su(e){this._internalRoot=e}Su.prototype.unstable_scheduleHydration=function(e){if(e){var t=Mg();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Hr.length&&t!==0&&t<Hr[n].priority;n++);Hr.splice(n,0,e),n===0&&Lg(e)}};function kf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function wu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ep(){}function YE(e,t,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=Bl(a);s.call(c)}}var a=n1(t,r,e,0,null,!1,!1,"",Ep);return e._reactRootContainer=a,e[Ar]=a.current,Ya(e.nodeType===8?e.parentNode:e),Fi(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var c=Bl(u);o.call(c)}}var u=Af(e,0,!1,null,null,!1,!1,"",Ep);return e._reactRootContainer=u,e[Ar]=u.current,Ya(e.nodeType===8?e.parentNode:e),Fi(function(){Tu(t,u,n,r)}),u}function _u(e,t,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var u=Bl(a);o.call(u)}}Tu(t,a,e,i)}else a=YE(n,t,e,i,r);return Bl(a)}Fg=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Ta(t.pendingLanes);n!==0&&(Jd(t,n|1),gn(t,Et()),!(He&6)&&(zs=Et()+500,di()))}break;case 13:Fi(function(){var r=Ir(e,1);if(r!==null){var i=ln();tr(r,e,1,i)}}),If(e,1)}};Yd=function(e){if(e.tag===13){var t=Ir(e,134217728);if(t!==null){var n=ln();tr(t,e,134217728,n)}If(e,134217728)}};Pg=function(e){if(e.tag===13){var t=ni(e),n=Ir(e,t);if(n!==null){var r=ln();tr(n,e,t,r)}If(e,t)}};Mg=function(){return Ze};Dg=function(e,t){var n=Ze;try{return Ze=e,t()}finally{Ze=n}};Oc=function(e,t,n){switch(t){case"input":if(kc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=hu(r);if(!i)throw Error(pe(90));fg(r),kc(r,i)}}}break;case"textarea":hg(e,n);break;case"select":t=n.value,t!=null&&_s(e,!!n.multiple,t,!1)}};Tg=wf;Sg=Fi;var KE={usingClientEntryPoint:!1,Events:[go,hs,hu,yg,Eg,wf]},ma={findFiberByHostInstance:Si,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},XE={bundleType:ma.bundleType,version:ma.version,rendererPackageName:ma.rendererPackageName,rendererConfig:ma.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Pr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Cg(e),e===null?null:e.stateNode},findFiberByHostInstance:ma.findFiberByHostInstance||JE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zo.isDisabled&&zo.supportsFiber)try{cu=zo.inject(XE),fr=zo}catch{}}kn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KE;kn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kf(t))throw Error(pe(200));return WE(e,t,null,n)};kn.createRoot=function(e,t){if(!kf(e))throw Error(pe(299));var n=!1,r="",i=r1;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Af(e,1,!1,null,null,n,!1,r,i),e[Ar]=t.current,Ya(e.nodeType===8?e.parentNode:e),new Rf(t)};kn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(pe(188)):(e=Object.keys(e).join(","),Error(pe(268,e)));return e=Cg(t),e=e===null?null:e.stateNode,e};kn.flushSync=function(e){return Fi(e)};kn.hydrate=function(e,t,n){if(!wu(t))throw Error(pe(200));return _u(null,e,t,!0,n)};kn.hydrateRoot=function(e,t,n){if(!kf(e))throw Error(pe(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",a=r1;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=n1(t,null,e,1,n??null,i,!1,s,a),e[Ar]=t.current,Ya(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Su(t)};kn.render=function(e,t,n){if(!wu(t))throw Error(pe(200));return _u(null,e,t,!1,n)};kn.unmountComponentAtNode=function(e){if(!wu(e))throw Error(pe(40));return e._reactRootContainer?(Fi(function(){_u(null,null,e,!1,function(){e._reactRootContainer=null,e[Ar]=null})}),!0):!1};kn.unstable_batchedUpdates=wf;kn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!wu(n))throw Error(pe(200));if(e==null||e._reactInternals===void 0)throw Error(pe(38));return _u(e,t,n,!1,r)};kn.version="18.3.1-next-f1338f8080-20240426";function i1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i1)}catch(e){console.error(e)}}i1(),ig.exports=kn;var QE=ig.exports,Tp=QE;wc.createRoot=Tp.createRoot,wc.hydrateRoot=Tp.hydrateRoot;/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZE=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s1=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var eT={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tT=Ie.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...o},u)=>Ie.createElement("svg",{ref:u,...eT,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:s1("lucide",i),...o},[...a.map(([c,l])=>Ie.createElement(c,l)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=(e,t)=>{const n=Ie.forwardRef(({className:r,...i},s)=>Ie.createElement(tT,{ref:s,iconNode:t,className:s1(`lucide-${ZE(e)}`,r),...i}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sp=be("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nT=be("Baby",[["path",{d:"M9 12h.01",key:"157uk2"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"5yv0yz"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rT=be("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iT=be("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=be("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sT=be("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aT=be("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a1=be("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wp=be("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oT=be("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lT=be("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uT=be("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _p=be("Combine",[["path",{d:"M10 18H5a3 3 0 0 1-3-3v-1",key:"ru65g8"}],["path",{d:"M14 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"e30een"}],["path",{d:"M20 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"2ahx8o"}],["path",{d:"m7 21 3-3-3-3",key:"127cv2"}],["rect",{x:"14",y:"14",width:"8",height:"8",rx:"2",key:"1b0bso"}],["rect",{x:"2",y:"2",width:"8",height:"8",rx:"2",key:"1x09vl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cT=be("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gd=be("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dT=be("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gl=be("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cp=be("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $l=be("FileCode",[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fT=be("FileSearch",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xd=be("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dc=be("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fc=be("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pT=be("Flower2",[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=be("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Np=be("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hT=be("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o1=be("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ap=be("Hammer",[["path",{d:"m15 12-8.373 8.373a1 1 0 1 1-3-3L12 9",key:"eefl8a"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172V7l-2.26-2.26a6 6 0 0 0-4.202-1.756L9 2.96l.92.82A6.18 6.18 0 0 1 12 8.4V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"b7pghm"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=be("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l1=be("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=be("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mT=be("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gT=be("LayoutList",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vl=be("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=be("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xT=be("ListPlus",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ip=be("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rp=be("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vT=be("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yT=be("Microscope",[["path",{d:"M6 18h8",key:"1borvv"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M14 22a7 7 0 1 0 0-14h-1",key:"1jwaiy"}],["path",{d:"M9 14h2",key:"197e7h"}],["path",{d:"M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z",key:"1bmzmy"}],["path",{d:"M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3",key:"1drr47"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qo=be("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=be("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=be("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ET=be("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jl=be("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kp=be("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bp=be("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fp=be("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pp=be("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mp=be("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TT=be("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pc=be("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ST=be("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wT=be("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _T=be("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=be("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CT=be("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ei=be("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dp=be("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=be("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Hl={};Hl.version="0.18.5";var u1=1252,NT=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],c1=function(e){NT.indexOf(e)!=-1&&(u1=e)};function AT(){c1(1252)}var io=function(e){c1(e)};function IT(){io(1200),AT()}var Wo=function(t){return String.fromCharCode(t)},Lp=function(t){return String.fromCharCode(t)},zl,Jr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function so(e){for(var t="",n=0,r=0,i=0,s=0,a=0,o=0,u=0,c=0;c<e.length;)n=e.charCodeAt(c++),s=n>>2,r=e.charCodeAt(c++),a=(n&3)<<4|r>>4,i=e.charCodeAt(c++),o=(r&15)<<2|i>>6,u=i&63,isNaN(r)?o=u=64:isNaN(i)&&(u=64),t+=Jr.charAt(s)+Jr.charAt(a)+Jr.charAt(o)+Jr.charAt(u);return t}function kr(e){var t="",n=0,r=0,i=0,s=0,a=0,o=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Jr.indexOf(e.charAt(c++)),a=Jr.indexOf(e.charAt(c++)),n=s<<2|a>>4,t+=String.fromCharCode(n),o=Jr.indexOf(e.charAt(c++)),r=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(r)),u=Jr.indexOf(e.charAt(c++)),i=(o&3)<<6|u,u!==64&&(t+=String.fromCharCode(i));return t}var Ye=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Mr=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Pi(e){return Ye?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Op(e){return Ye?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Qn=function(t){return Ye?Mr(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function Cu(e){if(typeof ArrayBuffer>"u")return Qn(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=e.charCodeAt(r)&255;return t}function vo(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function RT(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Vt=Ye?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Mr(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),i=0;for(t=0,n=0;t<e.length;n+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function kT(e){for(var t=[],n=0,r=e.length+250,i=Pi(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[n++]=a;else if(a<2048)i[n++]=192|a>>6&31,i[n++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[n++]=240|a>>8&7,i[n++]=128|a>>2&63,i[n++]=128|o>>6&15|(a&3)<<4,i[n++]=128|o&63}else i[n++]=224|a>>12&15,i[n++]=128|a>>6&63,i[n++]=128|a&63;n>r&&(t.push(i.slice(0,n)),n=0,i=Pi(65535),r=65530)}return t.push(i.slice(0,n)),Vt(t)}var Pa=/\u0000/g,Jo=/[\u0001-\u0006]/g;function Fs(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Zn(e,t){var n=""+e;return n.length>=t?n:xt("0",t-n.length)+n}function bf(e,t){var n=""+e;return n.length>=t?n:xt(" ",t-n.length)+n}function ql(e,t){var n=""+e;return n.length>=t?n:n+xt(" ",t-n.length)}function bT(e,t){var n=""+Math.round(e);return n.length>=t?n:xt("0",t-n.length)+n}function FT(e,t){var n=""+e;return n.length>=t?n:xt("0",t-n.length)+n}var Up=Math.pow(2,32);function is(e,t){if(e>Up||e<-Up)return bT(e,t);var n=Math.round(e);return FT(n,t)}function Wl(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Bp=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],hc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function PT(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var vt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Gp={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},MT={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Jl(e,t,n){for(var r=e<0?-1:1,i=e*r,s=0,a=1,o=0,u=1,c=0,l=0,m=Math.floor(i);c<t&&(m=Math.floor(i),o=m*a+s,l=m*c+u,!(i-m<5e-8));)i=1/(i-m),s=a,a=o,u=c,c=l;if(l>t&&(c>t?(l=u,o=s):(l=c,o=a)),!n)return[0,r*o,l];var h=Math.floor(r*o/l);return[h,r*o-h*l,l]}function Yo(e,t,n){if(e>2958465||e<0)return null;var r=e|0,i=Math.floor(86400*(e-r)),s=0,a=[],o={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++r,++o.D)),r===60)a=n?[1317,10,29]:[1900,2,29],s=3;else if(r===0)a=n?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var u=new Date(1900,0,1);u.setDate(u.getDate()+r-1),a=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),r<60&&(s=(s+6)%7),n&&(s=$T(u,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var d1=new Date(1899,11,31,0,0,0),DT=d1.getTime(),LT=new Date(1900,2,1,0,0,0);function f1(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=LT&&(n+=24*60*60*1e3),(n-(DT+(e.getTimezoneOffset()-d1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ff(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function OT(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function UT(e){var t=e<0?12:11,n=Ff(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function BT(e){var t=Ff(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function GT(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=UT(e):t===10?n=e.toFixed(10).substr(0,12):n=BT(e),Ff(OT(n.toUpperCase()))}function Td(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):GT(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ai(14,f1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function $T(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function VT(e,t,n,r){var i="",s=0,a=0,o=n.y,u,c=0;switch(e){case 98:o=n.y+543;case 121:switch(t.length){case 1:case 2:u=o%100,c=2;break;default:u=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:u=n.m,c=t.length;break;case 3:return hc[n.m-1][1];case 5:return hc[n.m-1][0];default:return hc[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=n.d,c=t.length;break;case 3:return Bp[n.q][0];default:return Bp[n.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(n.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=n.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=n.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?Zn(n.S,t.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,s=Math.round(a*(n.S+n.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=Zn(s,2+r),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=n.D*24+n.H;break;case"[m]":case"[mm]":u=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":u=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:u=o,c=1;break}var l=c>0?Zn(u,c):"";return l}function Yr(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,r=e.substr(0,n);n!=e.length;n+=t)r+=(r.length>0?",":"")+e.substr(n,t);return r}var p1=/%/g;function jT(e,t,n){var r=t.replace(p1,""),i=t.length-r.length;return wr(e,r,n*Math.pow(10,2*i))+xt("%",i)}function HT(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return wr(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function h1(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+h1(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),n.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(a-n.length+s):n+="E+"+(a-s);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,c,l){return u+c+l.substr(0,(i+s)%i)+"."+l.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var m1=/# (\?+)( ?)\/( ?)(\d+)/;function zT(e,t,n){var r=parseInt(e[4],10),i=Math.round(t*r),s=Math.floor(i/r),a=i-s*r,o=r;return n+(s===0?"":""+s)+" "+(a===0?xt(" ",e[1].length+1+e[4].length):bf(a,e[1].length)+e[2]+"/"+e[3]+Zn(o,e[4].length))}function qT(e,t,n){return n+(t===0?"":""+t)+xt(" ",e[1].length+2+e[4].length)}var g1=/^#*0*\.([0#]+)/,x1=/\).*[0#]/,v1=/\(###\) ###\\?-####/;function an(e){for(var t="",n,r=0;r!=e.length;++r)switch(n=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function $p(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function Vp(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function WT(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function JT(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Mn(e,t,n){if(e.charCodeAt(0)===40&&!t.match(x1)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Mn("n",r,n):"("+Mn("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return HT(e,t,n);if(t.indexOf("%")!==-1)return jT(e,t,n);if(t.indexOf("E")!==-1)return h1(t,n);if(t.charCodeAt(0)===36)return"$"+Mn(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,a,o,u=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+is(u,t.length);if(t.match(/^[#?]+$/))return i=is(n,0),i==="0"&&(i=""),i.length>t.length?i:an(t.substr(0,t.length-i.length))+i;if(s=t.match(m1))return zT(s,u,c);if(t.match(/^#+0+$/))return c+is(u,t.length-t.indexOf("0"));if(s=t.match(g1))return i=$p(n,s[1].length).replace(/^([^\.]+)$/,"$1."+an(s[1])).replace(/\.$/,"."+an(s[1])).replace(/\.(\d*)$/,function(x,v){return"."+v+xt("0",an(s[1]).length-v.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+$p(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Yr(is(u,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Mn(e,t,-n):Yr(""+(Math.floor(n)+WT(n,s[1].length)))+"."+Zn(Vp(n,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Mn(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Fs(Mn(e,t.replace(/[\\-]/g,""),n)),a=0,Fs(Fs(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<i.length?i.charAt(a++):x==="0"?"0":""}));if(t.match(v1))return i=Mn(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var l="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Jl(u,Math.pow(10,a)-1,!1),i=""+c,l=wr("n",s[1],o[1]),l.charAt(l.length-1)==" "&&(l=l.substr(0,l.length-1)+"0"),i+=l+s[2]+"/"+s[3],l=ql(o[2],a),l.length<s[4].length&&(l=an(s[4].substr(s[4].length-l.length))+l),i+=l,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Jl(u,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?bf(o[1],a)+s[2]+"/"+s[3]+ql(o[2],a):xt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=is(n,0),t.length<=i.length?i:an(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var m=t.indexOf(".")-a,h=t.length-i.length-m;return an(t.substr(0,m)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=Vp(n,s[1].length),n<0?"-"+Mn(e,t,-n):Yr(JT(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Zn(0,3-x.length):"")+x})+"."+Zn(a,s[1].length);switch(t){case"###,##0.00":return Mn(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var g=Yr(is(u,0));return g!=="0"?c+g:"";case"###,###.00":return Mn(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Mn(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function YT(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return wr(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function KT(e,t,n){var r=t.replace(p1,""),i=t.length-r.length;return wr(e,r,n*Math.pow(10,2*i))+xt("%",i)}function y1(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+y1(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!n.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(a-n.length+s):n+="E+"+(a-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,c,l){return u+c+l.substr(0,(i+s)%i)+"."+l.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function lr(e,t,n){if(e.charCodeAt(0)===40&&!t.match(x1)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?lr("n",r,n):"("+lr("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return YT(e,t,n);if(t.indexOf("%")!==-1)return KT(e,t,n);if(t.indexOf("E")!==-1)return y1(t,n);if(t.charCodeAt(0)===36)return"$"+lr(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,a,o,u=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+Zn(u,t.length);if(t.match(/^[#?]+$/))return i=""+n,n===0&&(i=""),i.length>t.length?i:an(t.substr(0,t.length-i.length))+i;if(s=t.match(m1))return qT(s,u,c);if(t.match(/^#+0+$/))return c+Zn(u,t.length-t.indexOf("0"));if(s=t.match(g1))return i=(""+n).replace(/^([^\.]+)$/,"$1."+an(s[1])).replace(/\.$/,"."+an(s[1])),i=i.replace(/\.(\d*)$/,function(x,v){return"."+v+xt("0",an(s[1]).length-v.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Yr(""+u);if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+lr(e,t,-n):Yr(""+n)+"."+xt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return lr(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Fs(lr(e,t.replace(/[\\-]/g,""),n)),a=0,Fs(Fs(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<i.length?i.charAt(a++):x==="0"?"0":""}));if(t.match(v1))return i=lr(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var l="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Jl(u,Math.pow(10,a)-1,!1),i=""+c,l=wr("n",s[1],o[1]),l.charAt(l.length-1)==" "&&(l=l.substr(0,l.length-1)+"0"),i+=l+s[2]+"/"+s[3],l=ql(o[2],a),l.length<s[4].length&&(l=an(s[4].substr(s[4].length-l.length))+l),i+=l,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Jl(u,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?bf(o[1],a)+s[2]+"/"+s[3]+ql(o[2],a):xt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+n,t.length<=i.length?i:an(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var m=t.indexOf(".")-a,h=t.length-i.length-m;return an(t.substr(0,m)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+lr(e,t,-n):Yr(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Zn(0,3-x.length):"")+x})+"."+Zn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=Yr(""+u);return g!=="0"?c+g:"";default:if(t.match(/\.[0#?]*$/))return lr(e,t.slice(0,t.lastIndexOf(".")),n)+an(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function wr(e,t,n){return(n|0)===n?lr(e,t,n):Mn(e,t,n)}function XT(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var E1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function T1(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":Wl(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=n;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(E1))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function QT(e,t,n,r){for(var i=[],s="",a=0,o="",u="t",c,l,m,h="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!Wl(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(m=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(m);i[i.length]={t:"t",v:s},++a;break;case"\\":var g=e.charAt(++a),x=g==="("||g===")"?g:"t";i[i.length]={t:x,v:g},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(c==null&&(c=Yo(t,n,e.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},u=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Yo(t,n),c==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&u.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:s},u=o;break;case"A":case"a":case"":var v={t:o,v:o};if(c==null&&(c=Yo(t,n)),e.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(v.v=c.H>=12?"P":"A"),v.t="T",h="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(v.v=c.H>=12?"PM":"AM"),v.t="T",a+=5,h="h"):e.substr(a,5).toUpperCase()==="/"?(c!=null&&(v.v=c.H>=12?"":""),v.t="T",a+=5,h="h"):(v.t="t",++a),c==null&&v.t==="T")return"";i[i.length]=v,u=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(E1)){if(c==null&&(c=Yo(t,n),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",T1(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},u=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:r===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var w=0,E=0,y;for(a=i.length-1,u="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=h,u="h",w<1&&(w=1);break;case"s":(y=i[a].v.match(/\.0+$/))&&(E=Math.max(E,y[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":u=i[a].t;break;case"m":u==="s"&&(i[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[a].v.match(/[Hh]/)&&(w=1),w<2&&i[a].v.match(/[Mm]/)&&(w=2),w<3&&i[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var T="",C;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=VT(i[a].t.charCodeAt(0),i[a].v,c,E),i[a].t="t";break;case"n":case"?":for(C=a+1;i[C]!=null&&((o=i[C].t)==="?"||o==="D"||(o===" "||o==="t")&&i[C+1]!=null&&(i[C+1].t==="?"||i[C+1].t==="t"&&i[C+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[C].v==="/"||i[C].v===" "&&i[C+1]!=null&&i[C+1].t=="?"));)i[a].v+=i[C].v,i[C]={v:"",t:";"},++C;T+=i[a].v,a=C-1;break;case"G":i[a].t="t",i[a].v=Td(t,n);break}var L="",B,R;if(T.length>0){T.charCodeAt(0)==40?(B=t<0&&T.charCodeAt(0)===45?-t:t,R=wr("n",T,B)):(B=t<0&&r>1?-t:t,R=wr("n",T,B),B<0&&i[0]&&i[0].t=="t"&&(R=R.substr(1),i[0].v="-"+i[0].v)),C=R.length-1;var O=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){O=a;break}var M=i.length;if(O===i.length&&R.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(C>=i[a].v.length-1?(C-=i[a].v.length,i[a].v=R.substr(C+1,i[a].v.length)):C<0?i[a].v="":(i[a].v=R.substr(0,C+1),C=-1),i[a].t="t",M=a);C>=0&&M<i.length&&(i[M].v=R.substr(0,C+1)+i[M].v)}else if(O!==i.length&&R.indexOf("E")===-1){for(C=R.indexOf(".")-1,a=O;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(l=i[a].v.indexOf(".")>-1&&a===O?i[a].v.indexOf(".")-1:i[a].v.length-1,L=i[a].v.substr(l+1);l>=0;--l)C>=0&&(i[a].v.charAt(l)==="0"||i[a].v.charAt(l)==="#")&&(L=R.charAt(C--)+L);i[a].v=L,i[a].t="t",M=a}for(C>=0&&M<i.length&&(i[M].v=R.substr(0,C+1)+i[M].v),C=R.indexOf(".")+1,a=O;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==O)){for(l=i[a].v.indexOf(".")>-1&&a===O?i[a].v.indexOf(".")+1:0,L=i[a].v.substr(0,l);l<i[a].v.length;++l)C<R.length&&(L+=R.charAt(C++));i[a].v=L,i[a].t="t",M=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(B=r>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=wr(i[a].t,i[a].v,B),i[a].t="t");var k="";for(a=0;a!==i.length;++a)i[a]!=null&&(k+=i[a].v);return k}var jp=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Hp(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function ZT(e,t){var n=XT(e),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var s=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,s];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var a=n[0].match(jp),o=n[1].match(jp);return Hp(t,a)?[r,n[0]]:Hp(t,o)?[r,n[1]]:[r,n[a!=null&&o!=null?2:1]]}return[r,s]}function ai(e,t,n){n==null&&(n={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?r=n.dateNF:r=e;break;case"number":e==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:vt)[e],r==null&&(r=n.table&&n.table[Gp[e]]||vt[Gp[e]]),r==null&&(r=MT[e]||"General");break}if(Wl(r,0))return Td(t,n);t instanceof Date&&(t=f1(t,n.date1904));var i=ZT(r,t);if(Wl(i[1]))return Td(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return QT(i[1],t,n,i[0])}function S1(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(vt[n]==null){t<0&&(t=n);continue}if(vt[n]==e){t=n;break}}t<0&&(t=391)}return vt[t]=e,t}function Nu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&S1(e[t],t)}function Au(){vt=PT()}var w1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function eS(e){var t=typeof e=="number"?vt[e]:e;return t=t.replace(w1,"(\\d+)"),new RegExp("^"+t+"$")}function tS(e,t,n){var r=-1,i=-1,s=-1,a=-1,o=-1,u=-1;(t.match(w1)||[]).forEach(function(m,h){var g=parseInt(n[h+1],10);switch(m.toLowerCase().charAt(0)){case"y":r=g;break;case"d":s=g;break;case"h":a=g;break;case"s":u=g;break;case"m":a>=0?o=g:i=g;break}}),u>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var l=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return a==-1&&o==-1&&u==-1?c:r==-1&&i==-1&&s==-1?l:c+"T"+l}var nS=function(){var e={};e.version="1.2.0";function t(){for(var R=0,O=new Array(256),M=0;M!=256;++M)R=M,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,O[M]=R;return typeof Int32Array<"u"?new Int32Array(O):O}var n=t();function r(R){var O=0,M=0,k=0,z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(k=0;k!=256;++k)z[k]=R[k];for(k=0;k!=256;++k)for(M=R[k],O=256+k;O<4096;O+=256)M=z[O]=M>>>8^R[M&255];var X=[];for(k=1;k!=16;++k)X[k-1]=typeof Int32Array<"u"?z.subarray(k*256,k*256+256):z.slice(k*256,k*256+256);return X}var i=r(n),s=i[0],a=i[1],o=i[2],u=i[3],c=i[4],l=i[5],m=i[6],h=i[7],g=i[8],x=i[9],v=i[10],w=i[11],E=i[12],y=i[13],T=i[14];function C(R,O){for(var M=O^-1,k=0,z=R.length;k<z;)M=M>>>8^n[(M^R.charCodeAt(k++))&255];return~M}function L(R,O){for(var M=O^-1,k=R.length-15,z=0;z<k;)M=T[R[z++]^M&255]^y[R[z++]^M>>8&255]^E[R[z++]^M>>16&255]^w[R[z++]^M>>>24]^v[R[z++]]^x[R[z++]]^g[R[z++]]^h[R[z++]]^m[R[z++]]^l[R[z++]]^c[R[z++]]^u[R[z++]]^o[R[z++]]^a[R[z++]]^s[R[z++]]^n[R[z++]];for(k+=15;z<k;)M=M>>>8^n[(M^R[z++])&255];return~M}function B(R,O){for(var M=O^-1,k=0,z=R.length,X=0,ne=0;k<z;)X=R.charCodeAt(k++),X<128?M=M>>>8^n[(M^X)&255]:X<2048?(M=M>>>8^n[(M^(192|X>>6&31))&255],M=M>>>8^n[(M^(128|X&63))&255]):X>=55296&&X<57344?(X=(X&1023)+64,ne=R.charCodeAt(k++)&1023,M=M>>>8^n[(M^(240|X>>8&7))&255],M=M>>>8^n[(M^(128|X>>2&63))&255],M=M>>>8^n[(M^(128|ne>>6&15|(X&3)<<4))&255],M=M>>>8^n[(M^(128|ne&63))&255]):(M=M>>>8^n[(M^(224|X>>12&15))&255],M=M>>>8^n[(M^(128|X>>6&63))&255],M=M>>>8^n[(M^(128|X&63))&255]);return~M}return e.table=n,e.bstr=C,e.buf=L,e.str=B,e}(),tt=function(){var t={};t.version="1.2.1";function n(_,b){for(var N=_.split("/"),I=b.split("/"),F=0,P=0,Y=Math.min(N.length,I.length);F<Y;++F){if(P=N[F].length-I[F].length)return P;if(N[F]!=I[F])return N[F]<I[F]?-1:1}return N.length-I.length}function r(_){if(_.charAt(_.length-1)=="/")return _.slice(0,-1).indexOf("/")===-1?_:r(_.slice(0,-1));var b=_.lastIndexOf("/");return b===-1?_:_.slice(0,b+1)}function i(_){if(_.charAt(_.length-1)=="/")return i(_.slice(0,-1));var b=_.lastIndexOf("/");return b===-1?_:_.slice(b+1)}function s(_,b){typeof b=="string"&&(b=new Date(b));var N=b.getHours();N=N<<6|b.getMinutes(),N=N<<5|b.getSeconds()>>>1,_.write_shift(2,N);var I=b.getFullYear()-1980;I=I<<4|b.getMonth()+1,I=I<<5|b.getDate(),_.write_shift(2,I)}function a(_){var b=_.read_shift(2)&65535,N=_.read_shift(2)&65535,I=new Date,F=N&31;N>>>=5;var P=N&15;N>>>=4,I.setMilliseconds(0),I.setFullYear(N+1980),I.setMonth(P-1),I.setDate(F);var Y=b&31;b>>>=5;var ie=b&63;return b>>>=6,I.setHours(b),I.setMinutes(ie),I.setSeconds(Y<<1),I}function o(_){wn(_,0);for(var b={},N=0;_.l<=_.length-4;){var I=_.read_shift(2),F=_.read_shift(2),P=_.l+F,Y={};switch(I){case 21589:N=_.read_shift(1),N&1&&(Y.mtime=_.read_shift(4)),F>5&&(N&2&&(Y.atime=_.read_shift(4)),N&4&&(Y.ctime=_.read_shift(4))),Y.mtime&&(Y.mt=new Date(Y.mtime*1e3));break}_.l=P,b[I]=Y}return b}var u;function c(){return u||(u={})}function l(_,b){if(_[0]==80&&_[1]==75)return ia(_,b);if((_[0]|32)==109&&(_[1]|32)==105)return No(_,b);if(_.length<512)throw new Error("CFB file size "+_.length+" < 512");var N=3,I=512,F=0,P=0,Y=0,ie=0,J=0,K=[],Q=_.slice(0,512);wn(Q,0);var fe=m(Q);switch(N=fe[0],N){case 3:I=512;break;case 4:I=4096;break;case 0:if(fe[1]==0)return ia(_,b);default:throw new Error("Major Version: Expected 3 or 4 saw "+N)}I!==512&&(Q=_.slice(0,I),wn(Q,28));var me=_.slice(0,I);h(Q,N);var Ne=Q.read_shift(4,"i");if(N===3&&Ne!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ne);Q.l+=4,Y=Q.read_shift(4,"i"),Q.l+=4,Q.chk("00100000","Mini Stream Cutoff Size: "),ie=Q.read_shift(4,"i"),F=Q.read_shift(4,"i"),J=Q.read_shift(4,"i"),P=Q.read_shift(4,"i");for(var he=-1,we=0;we<109&&(he=Q.read_shift(4,"i"),!(he<0));++we)K[we]=he;var Me=g(_,I);w(J,P,Me,I,K);var nt=y(Me,Y,K,I);nt[Y].name="!Directory",F>0&&ie!==ne&&(nt[ie].name="!MiniFAT"),nt[K[0]].name="!FAT",nt.fat_addrs=K,nt.ssz=I;var st={},Rt=[],gi=[],xi=[];T(Y,nt,Me,Rt,F,st,gi,ie),x(gi,xi,Rt),Rt.shift();var Ur={FileIndex:gi,FullPaths:xi};return b&&b.raw&&(Ur.raw={header:me,sectors:Me}),Ur}function m(_){if(_[_.l]==80&&_[_.l+1]==75)return[0,0];_.chk(Fe,"Header Signature: "),_.l+=16;var b=_.read_shift(2,"u");return[_.read_shift(2,"u"),b]}function h(_,b){var N=9;switch(_.l+=2,N=_.read_shift(2)){case 9:if(b!=3)throw new Error("Sector Shift: Expected 9 saw "+N);break;case 12:if(b!=4)throw new Error("Sector Shift: Expected 12 saw "+N);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+N)}_.chk("0600","Mini Sector Shift: "),_.chk("000000000000","Reserved: ")}function g(_,b){for(var N=Math.ceil(_.length/b)-1,I=[],F=1;F<N;++F)I[F-1]=_.slice(F*b,(F+1)*b);return I[N-1]=_.slice(N*b),I}function x(_,b,N){for(var I=0,F=0,P=0,Y=0,ie=0,J=N.length,K=[],Q=[];I<J;++I)K[I]=Q[I]=I,b[I]=N[I];for(;ie<Q.length;++ie)I=Q[ie],F=_[I].L,P=_[I].R,Y=_[I].C,K[I]===I&&(F!==-1&&K[F]!==F&&(K[I]=K[F]),P!==-1&&K[P]!==P&&(K[I]=K[P])),Y!==-1&&(K[Y]=I),F!==-1&&I!=K[I]&&(K[F]=K[I],Q.lastIndexOf(F)<ie&&Q.push(F)),P!==-1&&I!=K[I]&&(K[P]=K[I],Q.lastIndexOf(P)<ie&&Q.push(P));for(I=1;I<J;++I)K[I]===I&&(P!==-1&&K[P]!==P?K[I]=K[P]:F!==-1&&K[F]!==F&&(K[I]=K[F]));for(I=1;I<J;++I)if(_[I].type!==0){if(ie=I,ie!=K[ie])do ie=K[ie],b[I]=b[ie]+"/"+b[I];while(ie!==0&&K[ie]!==-1&&ie!=K[ie]);K[I]=-1}for(b[0]+="/",I=1;I<J;++I)_[I].type!==2&&(b[I]+="/")}function v(_,b,N){for(var I=_.start,F=_.size,P=[],Y=I;N&&F>0&&Y>=0;)P.push(b.slice(Y*X,Y*X+X)),F-=X,Y=Ti(N,Y*4);return P.length===0?te(0):Vt(P).slice(0,_.size)}function w(_,b,N,I,F){var P=ne;if(_===ne){if(b!==0)throw new Error("DIFAT chain shorter than expected")}else if(_!==-1){var Y=N[_],ie=(I>>>2)-1;if(!Y)return;for(var J=0;J<ie&&(P=Ti(Y,J*4))!==ne;++J)F.push(P);w(Ti(Y,I-4),b-1,N,I,F)}}function E(_,b,N,I,F){var P=[],Y=[];F||(F=[]);var ie=I-1,J=0,K=0;for(J=b;J>=0;){F[J]=!0,P[P.length]=J,Y.push(_[J]);var Q=N[Math.floor(J*4/I)];if(K=J*4&ie,I<4+K)throw new Error("FAT boundary crossed: "+J+" 4 "+I);if(!_[Q])break;J=Ti(_[Q],K)}return{nodes:P,data:Qp([Y])}}function y(_,b,N,I){var F=_.length,P=[],Y=[],ie=[],J=[],K=I-1,Q=0,fe=0,me=0,Ne=0;for(Q=0;Q<F;++Q)if(ie=[],me=Q+b,me>=F&&(me-=F),!Y[me]){J=[];var he=[];for(fe=me;fe>=0;){he[fe]=!0,Y[fe]=!0,ie[ie.length]=fe,J.push(_[fe]);var we=N[Math.floor(fe*4/I)];if(Ne=fe*4&K,I<4+Ne)throw new Error("FAT boundary crossed: "+fe+" 4 "+I);if(!_[we]||(fe=Ti(_[we],Ne),he[fe]))break}P[me]={nodes:ie,data:Qp([J])}}return P}function T(_,b,N,I,F,P,Y,ie){for(var J=0,K=I.length?2:0,Q=b[_].data,fe=0,me=0,Ne;fe<Q.length;fe+=128){var he=Q.slice(fe,fe+128);wn(he,64),me=he.read_shift(2),Ne=Of(he,0,me-K),I.push(Ne);var we={name:Ne,type:he.read_shift(1),color:he.read_shift(1),L:he.read_shift(4,"i"),R:he.read_shift(4,"i"),C:he.read_shift(4,"i"),clsid:he.read_shift(16),state:he.read_shift(4,"i"),start:0,size:0},Me=he.read_shift(2)+he.read_shift(2)+he.read_shift(2)+he.read_shift(2);Me!==0&&(we.ct=C(he,he.l-8));var nt=he.read_shift(2)+he.read_shift(2)+he.read_shift(2)+he.read_shift(2);nt!==0&&(we.mt=C(he,he.l-8)),we.start=he.read_shift(4,"i"),we.size=he.read_shift(4,"i"),we.size<0&&we.start<0&&(we.size=we.type=0,we.start=ne,we.name=""),we.type===5?(J=we.start,F>0&&J!==ne&&(b[J].name="!StreamData")):we.size>=4096?(we.storage="fat",b[we.start]===void 0&&(b[we.start]=E(N,we.start,b.fat_addrs,b.ssz)),b[we.start].name=we.name,we.content=b[we.start].data.slice(0,we.size)):(we.storage="minifat",we.size<0?we.size=0:J!==ne&&we.start!==ne&&b[J]&&(we.content=v(we,b[J].data,(b[ie]||{}).data))),we.content&&wn(we.content,0),P[Ne]=we,Y.push(we)}}function C(_,b){return new Date((Cn(_,b+4)/1e7*Math.pow(2,32)+Cn(_,b)/1e7-11644473600)*1e3)}function L(_,b){return c(),l(u.readFileSync(_),b)}function B(_,b){var N=b&&b.type;switch(N||Ye&&Buffer.isBuffer(_)&&(N="buffer"),N||"base64"){case"file":return L(_,b);case"base64":return l(Qn(kr(_)),b);case"binary":return l(Qn(_),b)}return l(_,b)}function R(_,b){var N=b||{},I=N.root||"Root Entry";if(_.FullPaths||(_.FullPaths=[]),_.FileIndex||(_.FileIndex=[]),_.FullPaths.length!==_.FileIndex.length)throw new Error("inconsistent CFB structure");_.FullPaths.length===0&&(_.FullPaths[0]=I+"/",_.FileIndex[0]={name:I,type:5}),N.CLSID&&(_.FileIndex[0].clsid=N.CLSID),O(_)}function O(_){var b="Sh33tJ5";if(!tt.find(_,"/"+b)){var N=te(4);N[0]=55,N[1]=N[3]=50,N[2]=54,_.FileIndex.push({name:b,type:2,content:N,size:4,L:69,R:69,C:69}),_.FullPaths.push(_.FullPaths[0]+b),M(_)}}function M(_,b){R(_);for(var N=!1,I=!1,F=_.FullPaths.length-1;F>=0;--F){var P=_.FileIndex[F];switch(P.type){case 0:I?N=!0:(_.FileIndex.pop(),_.FullPaths.pop());break;case 1:case 2:case 5:I=!0,isNaN(P.R*P.L*P.C)&&(N=!0),P.R>-1&&P.L>-1&&P.R==P.L&&(N=!0);break;default:N=!0;break}}if(!(!N&&!b)){var Y=new Date(1987,1,19),ie=0,J=Object.create?Object.create(null):{},K=[];for(F=0;F<_.FullPaths.length;++F)J[_.FullPaths[F]]=!0,_.FileIndex[F].type!==0&&K.push([_.FullPaths[F],_.FileIndex[F]]);for(F=0;F<K.length;++F){var Q=r(K[F][0]);I=J[Q],I||(K.push([Q,{name:i(Q).replace("/",""),type:1,clsid:ue,ct:Y,mt:Y,content:null}]),J[Q]=!0)}for(K.sort(function(Ne,he){return n(Ne[0],he[0])}),_.FullPaths=[],_.FileIndex=[],F=0;F<K.length;++F)_.FullPaths[F]=K[F][0],_.FileIndex[F]=K[F][1];for(F=0;F<K.length;++F){var fe=_.FileIndex[F],me=_.FullPaths[F];if(fe.name=i(me).replace("/",""),fe.L=fe.R=fe.C=-(fe.color=1),fe.size=fe.content?fe.content.length:0,fe.start=0,fe.clsid=fe.clsid||ue,F===0)fe.C=K.length>1?1:-1,fe.size=0,fe.type=5;else if(me.slice(-1)=="/"){for(ie=F+1;ie<K.length&&r(_.FullPaths[ie])!=me;++ie);for(fe.C=ie>=K.length?-1:ie,ie=F+1;ie<K.length&&r(_.FullPaths[ie])!=r(me);++ie);fe.R=ie>=K.length?-1:ie,fe.type=1}else r(_.FullPaths[F+1]||"")==r(me)&&(fe.R=F+1),fe.type=2}}}function k(_,b){var N=b||{};if(N.fileType=="mad")return ts(_,N);switch(M(_),N.fileType){case"zip":return o0(_,N)}var I=function(Ne){for(var he=0,we=0,Me=0;Me<Ne.FileIndex.length;++Me){var nt=Ne.FileIndex[Me];if(nt.content){var st=nt.content.length;st>0&&(st<4096?he+=st+63>>6:we+=st+511>>9)}}for(var Rt=Ne.FullPaths.length+3>>2,gi=he+7>>3,xi=he+127>>7,Ur=gi+we+Rt+xi,xr=Ur+127>>7,sa=xr<=109?0:Math.ceil((xr-109)/127);Ur+xr+sa+127>>7>xr;)sa=++xr<=109?0:Math.ceil((xr-109)/127);var Pn=[1,sa,xr,xi,Rt,we,he,0];return Ne.FileIndex[0].size=he<<6,Pn[7]=(Ne.FileIndex[0].start=Pn[0]+Pn[1]+Pn[2]+Pn[3]+Pn[4]+Pn[5])+(Pn[6]+7>>3),Pn}(_),F=te(I[7]<<9),P=0,Y=0;{for(P=0;P<8;++P)F.write_shift(1,q[P]);for(P=0;P<8;++P)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),P=0;P<3;++P)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,I[2]),F.write_shift(4,I[0]+I[1]+I[2]+I[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,I[3]?I[0]+I[1]+I[2]-1:ne),F.write_shift(4,I[3]),F.write_shift(-4,I[1]?I[0]-1:ne),F.write_shift(4,I[1]),P=0;P<109;++P)F.write_shift(-4,P<I[2]?I[1]+P:-1)}if(I[1])for(Y=0;Y<I[1];++Y){for(;P<236+Y*127;++P)F.write_shift(-4,P<I[2]?I[1]+P:-1);F.write_shift(-4,Y===I[1]-1?ne:Y+1)}var ie=function(Ne){for(Y+=Ne;P<Y-1;++P)F.write_shift(-4,P+1);Ne&&(++P,F.write_shift(-4,ne))};for(Y=P=0,Y+=I[1];P<Y;++P)F.write_shift(-4,ke.DIFSECT);for(Y+=I[2];P<Y;++P)F.write_shift(-4,ke.FATSECT);ie(I[3]),ie(I[4]);for(var J=0,K=0,Q=_.FileIndex[0];J<_.FileIndex.length;++J)Q=_.FileIndex[J],Q.content&&(K=Q.content.length,!(K<4096)&&(Q.start=Y,ie(K+511>>9)));for(ie(I[6]+7>>3);F.l&511;)F.write_shift(-4,ke.ENDOFCHAIN);for(Y=P=0,J=0;J<_.FileIndex.length;++J)Q=_.FileIndex[J],Q.content&&(K=Q.content.length,!(!K||K>=4096)&&(Q.start=Y,ie(K+63>>6)));for(;F.l&511;)F.write_shift(-4,ke.ENDOFCHAIN);for(P=0;P<I[4]<<2;++P){var fe=_.FullPaths[P];if(!fe||fe.length===0){for(J=0;J<17;++J)F.write_shift(4,0);for(J=0;J<3;++J)F.write_shift(4,-1);for(J=0;J<12;++J)F.write_shift(4,0);continue}Q=_.FileIndex[P],P===0&&(Q.start=Q.size?Q.start-1:ne);var me=P===0&&N.root||Q.name;if(K=2*(me.length+1),F.write_shift(64,me,"utf16le"),F.write_shift(2,K),F.write_shift(1,Q.type),F.write_shift(1,Q.color),F.write_shift(-4,Q.L),F.write_shift(-4,Q.R),F.write_shift(-4,Q.C),Q.clsid)F.write_shift(16,Q.clsid,"hex");else for(J=0;J<4;++J)F.write_shift(4,0);F.write_shift(4,Q.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,Q.start),F.write_shift(4,Q.size),F.write_shift(4,0)}for(P=1;P<_.FileIndex.length;++P)if(Q=_.FileIndex[P],Q.size>=4096)if(F.l=Q.start+1<<9,Ye&&Buffer.isBuffer(Q.content))Q.content.copy(F,F.l,0,Q.size),F.l+=Q.size+511&-512;else{for(J=0;J<Q.size;++J)F.write_shift(1,Q.content[J]);for(;J&511;++J)F.write_shift(1,0)}for(P=1;P<_.FileIndex.length;++P)if(Q=_.FileIndex[P],Q.size>0&&Q.size<4096)if(Ye&&Buffer.isBuffer(Q.content))Q.content.copy(F,F.l,0,Q.size),F.l+=Q.size+63&-64;else{for(J=0;J<Q.size;++J)F.write_shift(1,Q.content[J]);for(;J&63;++J)F.write_shift(1,0)}if(Ye)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function z(_,b){var N=_.FullPaths.map(function(J){return J.toUpperCase()}),I=N.map(function(J){var K=J.split("/");return K[K.length-(J.slice(-1)=="/"?2:1)]}),F=!1;b.charCodeAt(0)===47?(F=!0,b=N[0].slice(0,-1)+b):F=b.indexOf("/")!==-1;var P=b.toUpperCase(),Y=F===!0?N.indexOf(P):I.indexOf(P);if(Y!==-1)return _.FileIndex[Y];var ie=!P.match(Jo);for(P=P.replace(Pa,""),ie&&(P=P.replace(Jo,"!")),Y=0;Y<N.length;++Y)if((ie?N[Y].replace(Jo,"!"):N[Y]).replace(Pa,"")==P||(ie?I[Y].replace(Jo,"!"):I[Y]).replace(Pa,"")==P)return _.FileIndex[Y];return null}var X=64,ne=-2,Fe="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],ue="00000000000000000000000000000000",ke={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ne,FREESECT:-1,HEADER_SIGNATURE:Fe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ue,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(_,b,N){c();var I=k(_,N);u.writeFileSync(b,I)}function ae(_){for(var b=new Array(_.length),N=0;N<_.length;++N)b[N]=String.fromCharCode(_[N]);return b.join("")}function ce(_,b){var N=k(_,b);switch(b&&b.type||"buffer"){case"file":return c(),u.writeFileSync(b.filename,N),N;case"binary":return typeof N=="string"?N:ae(N);case"base64":return so(typeof N=="string"?N:ae(N));case"buffer":if(Ye)return Buffer.isBuffer(N)?N:Mr(N);case"array":return typeof N=="string"?Qn(N):N}return N}var Ce;function D(_){try{var b=_.InflateRaw,N=new b;if(N._processChunk(new Uint8Array([3,0]),N._finishFlushFlag),N.bytesRead)Ce=_;else throw new Error("zlib does not expose bytesRead")}catch(I){console.error("cannot use native zlib: "+(I.message||I))}}function U(_,b){if(!Ce)return Yi(_,b);var N=Ce.InflateRaw,I=new N,F=I._processChunk(_.slice(_.l),I._finishFlushFlag);return _.l+=I.bytesRead,F}function G(_){return Ce?Ce.deflateRawSync(_):ar(_)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],H=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function de(_){var b=(_<<1|_<<11)&139536|(_<<5|_<<15)&558144;return(b>>16|b>>8|b)&255}for(var Ee=typeof Uint8Array<"u",Se=Ee?new Uint8Array(256):[],Le=0;Le<256;++Le)Se[Le]=de(Le);function Ve(_,b){var N=Se[_&255];return b<=8?N>>>8-b:(N=N<<8|Se[_>>8&255],b<=16?N>>>16-b:(N=N<<8|Se[_>>16&255],N>>>24-b))}function yt(_,b){var N=b&7,I=b>>>3;return(_[I]|(N<=6?0:_[I+1]<<8))>>>N&3}function je(_,b){var N=b&7,I=b>>>3;return(_[I]|(N<=5?0:_[I+1]<<8))>>>N&7}function ze(_,b){var N=b&7,I=b>>>3;return(_[I]|(N<=4?0:_[I+1]<<8))>>>N&15}function qe(_,b){var N=b&7,I=b>>>3;return(_[I]|(N<=3?0:_[I+1]<<8))>>>N&31}function Te(_,b){var N=b&7,I=b>>>3;return(_[I]|(N<=1?0:_[I+1]<<8))>>>N&127}function It(_,b,N){var I=b&7,F=b>>>3,P=(1<<N)-1,Y=_[F]>>>I;return N<8-I||(Y|=_[F+1]<<8-I,N<16-I)||(Y|=_[F+2]<<16-I,N<24-I)||(Y|=_[F+3]<<24-I),Y&P}function Jt(_,b,N){var I=b&7,F=b>>>3;return I<=5?_[F]|=(N&7)<<I:(_[F]|=N<<I&255,_[F+1]=(N&7)>>8-I),b+3}function En(_,b,N){var I=b&7,F=b>>>3;return N=(N&1)<<I,_[F]|=N,b+1}function ct(_,b,N){var I=b&7,F=b>>>3;return N<<=I,_[F]|=N&255,N>>>=8,_[F+1]=N,b+8}function Fn(_,b,N){var I=b&7,F=b>>>3;return N<<=I,_[F]|=N&255,N>>>=8,_[F+1]=N&255,_[F+2]=N>>>8,b+16}function zn(_,b){var N=_.length,I=2*N>b?2*N:b+5,F=0;if(N>=b)return _;if(Ye){var P=Op(I);if(_.copy)_.copy(P);else for(;F<_.length;++F)P[F]=_[F];return P}else if(Ee){var Y=new Uint8Array(I);if(Y.set)Y.set(_);else for(;F<N;++F)Y[F]=_[F];return Y}return _.length=I,_}function nn(_){for(var b=new Array(_),N=0;N<_;++N)b[N]=0;return b}function Or(_,b,N){var I=1,F=0,P=0,Y=0,ie=0,J=_.length,K=Ee?new Uint16Array(32):nn(32);for(P=0;P<32;++P)K[P]=0;for(P=J;P<N;++P)_[P]=0;J=_.length;var Q=Ee?new Uint16Array(J):nn(J);for(P=0;P<J;++P)K[F=_[P]]++,I<F&&(I=F),Q[P]=0;for(K[0]=0,P=1;P<=I;++P)K[P+16]=ie=ie+K[P-1]<<1;for(P=0;P<J;++P)ie=_[P],ie!=0&&(Q[P]=K[ie+16]++);var fe=0;for(P=0;P<J;++P)if(fe=_[P],fe!=0)for(ie=Ve(Q[P],I)>>I-fe,Y=(1<<I+4-fe)-1;Y>=0;--Y)b[ie|Y<<fe]=fe&15|P<<4;return I}var Hi=Ee?new Uint16Array(512):nn(512),ra=Ee?new Uint16Array(32):nn(32);if(!Ee){for(var ft=0;ft<512;++ft)Hi[ft]=0;for(ft=0;ft<32;++ft)ra[ft]=0}(function(){for(var _=[],b=0;b<32;b++)_.push(5);Or(_,ra,32);var N=[];for(b=0;b<=143;b++)N.push(8);for(;b<=255;b++)N.push(9);for(;b<=279;b++)N.push(7);for(;b<=287;b++)N.push(8);Or(N,Hi,288)})();var zi=function(){for(var b=Ee?new Uint8Array(32768):[],N=0,I=0;N<H.length-1;++N)for(;I<H[N+1];++I)b[I]=N;for(;I<32768;++I)b[I]=29;var F=Ee?new Uint8Array(259):[];for(N=0,I=0;N<re.length-1;++N)for(;I<re[N+1];++I)F[I]=N;function P(ie,J){for(var K=0;K<ie.length;){var Q=Math.min(65535,ie.length-K),fe=K+Q==ie.length;for(J.write_shift(1,+fe),J.write_shift(2,Q),J.write_shift(2,~Q&65535);Q-- >0;)J[J.l++]=ie[K++]}return J.l}function Y(ie,J){for(var K=0,Q=0,fe=Ee?new Uint16Array(32768):[];Q<ie.length;){var me=Math.min(65535,ie.length-Q);if(me<10){for(K=Jt(J,K,+(Q+me==ie.length)),K&7&&(K+=8-(K&7)),J.l=K/8|0,J.write_shift(2,me),J.write_shift(2,~me&65535);me-- >0;)J[J.l++]=ie[Q++];K=J.l*8;continue}K=Jt(J,K,+(Q+me==ie.length)+2);for(var Ne=0;me-- >0;){var he=ie[Q];Ne=(Ne<<5^he)&32767;var we=-1,Me=0;if((we=fe[Ne])&&(we|=Q&-32768,we>Q&&(we-=32768),we<Q))for(;ie[we+Me]==ie[Q+Me]&&Me<250;)++Me;if(Me>2){he=F[Me],he<=22?K=ct(J,K,Se[he+1]>>1)-1:(ct(J,K,3),K+=5,ct(J,K,Se[he-23]>>5),K+=3);var nt=he<8?0:he-4>>2;nt>0&&(Fn(J,K,Me-re[he]),K+=nt),he=b[Q-we],K=ct(J,K,Se[he]>>3),K-=3;var st=he<4?0:he-2>>1;st>0&&(Fn(J,K,Q-we-H[he]),K+=st);for(var Rt=0;Rt<Me;++Rt)fe[Ne]=Q&32767,Ne=(Ne<<5^ie[Q])&32767,++Q;me-=Me-1}else he<=143?he=he+48:K=En(J,K,1),K=ct(J,K,Se[he]),fe[Ne]=Q&32767,++Q}K=ct(J,K,0)-1}return J.l=(K+7)/8|0,J.l}return function(J,K){return J.length<8?P(J,K):Y(J,K)}}();function ar(_){var b=te(50+Math.floor(_.length*1.1)),N=zi(_,b);return b.slice(0,N)}var qi=Ee?new Uint16Array(32768):nn(32768),it=Ee?new Uint16Array(32768):nn(32768),_o=Ee?new Uint16Array(128):nn(128),mr=1,rn=1;function Wi(_,b){var N=qe(_,b)+257;b+=5;var I=qe(_,b)+1;b+=5;var F=ze(_,b)+4;b+=4;for(var P=0,Y=Ee?new Uint8Array(19):nn(19),ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],J=1,K=Ee?new Uint8Array(8):nn(8),Q=Ee?new Uint8Array(8):nn(8),fe=Y.length,me=0;me<F;++me)Y[V[me]]=P=je(_,b),J<P&&(J=P),K[P]++,b+=3;var Ne=0;for(K[0]=0,me=1;me<=J;++me)Q[me]=Ne=Ne+K[me-1]<<1;for(me=0;me<fe;++me)(Ne=Y[me])!=0&&(ie[me]=Q[Ne]++);var he=0;for(me=0;me<fe;++me)if(he=Y[me],he!=0){Ne=Se[ie[me]]>>8-he;for(var we=(1<<7-he)-1;we>=0;--we)_o[Ne|we<<he]=he&7|me<<3}var Me=[];for(J=1;Me.length<N+I;)switch(Ne=_o[Te(_,b)],b+=Ne&7,Ne>>>=3){case 16:for(P=3+yt(_,b),b+=2,Ne=Me[Me.length-1];P-- >0;)Me.push(Ne);break;case 17:for(P=3+je(_,b),b+=3;P-- >0;)Me.push(0);break;case 18:for(P=11+Te(_,b),b+=7;P-- >0;)Me.push(0);break;default:Me.push(Ne),J<Ne&&(J=Ne);break}var nt=Me.slice(0,N),st=Me.slice(N);for(me=N;me<286;++me)nt[me]=0;for(me=I;me<30;++me)st[me]=0;return mr=Or(nt,qi,286),rn=Or(st,it,30),b}function Ji(_,b){if(_[0]==3&&!(_[1]&3))return[Pi(b),2];for(var N=0,I=0,F=Op(b||1<<18),P=0,Y=F.length>>>0,ie=0,J=0;!(I&1);){if(I=je(_,N),N+=3,I>>>1)I>>1==1?(ie=9,J=5):(N=Wi(_,N),ie=mr,J=rn);else{N&7&&(N+=8-(N&7));var K=_[N>>>3]|_[(N>>>3)+1]<<8;if(N+=32,K>0)for(!b&&Y<P+K&&(F=zn(F,P+K),Y=F.length);K-- >0;)F[P++]=_[N>>>3],N+=8;continue}for(;;){!b&&Y<P+32767&&(F=zn(F,P+32767),Y=F.length);var Q=It(_,N,ie),fe=I>>>1==1?Hi[Q]:qi[Q];if(N+=fe&15,fe>>>=4,!(fe>>>8&255))F[P++]=fe;else{if(fe==256)break;fe-=257;var me=fe<8?0:fe-4>>2;me>5&&(me=0);var Ne=P+re[fe];me>0&&(Ne+=It(_,N,me),N+=me),Q=It(_,N,J),fe=I>>>1==1?ra[Q]:it[Q],N+=fe&15,fe>>>=4;var he=fe<4?0:fe-2>>1,we=H[fe];for(he>0&&(we+=It(_,N,he),N+=he),!b&&Y<Ne&&(F=zn(F,Ne+100),Y=F.length);P<Ne;)F[P]=F[P-we],++P}}}return b?[F,N+7>>>3]:[F.slice(0,P),N+7>>>3]}function Yi(_,b){var N=_.slice(_.l||0),I=Ji(N,b);return _.l+=I[1],I[0]}function gr(_,b){if(_)typeof console<"u"&&console.error(b);else throw new Error(b)}function ia(_,b){var N=_;wn(N,0);var I=[],F=[],P={FileIndex:I,FullPaths:F};R(P,{root:b.root});for(var Y=N.length-4;(N[Y]!=80||N[Y+1]!=75||N[Y+2]!=5||N[Y+3]!=6)&&Y>=0;)--Y;N.l=Y+4,N.l+=4;var ie=N.read_shift(2);N.l+=6;var J=N.read_shift(4);for(N.l=J,Y=0;Y<ie;++Y){N.l+=20;var K=N.read_shift(4),Q=N.read_shift(4),fe=N.read_shift(2),me=N.read_shift(2),Ne=N.read_shift(2);N.l+=8;var he=N.read_shift(4),we=o(N.slice(N.l+fe,N.l+fe+me));N.l+=fe+me+Ne;var Me=N.l;N.l=he+4,Ki(N,K,Q,P,we),N.l=Me}return P}function Ki(_,b,N,I,F){_.l+=2;var P=_.read_shift(2),Y=_.read_shift(2),ie=a(_);if(P&8257)throw new Error("Unsupported ZIP encryption");for(var J=_.read_shift(4),K=_.read_shift(4),Q=_.read_shift(4),fe=_.read_shift(2),me=_.read_shift(2),Ne="",he=0;he<fe;++he)Ne+=String.fromCharCode(_[_.l++]);if(me){var we=o(_.slice(_.l,_.l+me));(we[21589]||{}).mt&&(ie=we[21589].mt),((F||{})[21589]||{}).mt&&(ie=F[21589].mt)}_.l+=me;var Me=_.slice(_.l,_.l+K);switch(Y){case 8:Me=U(_,Q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Y)}var nt=!1;P&8&&(J=_.read_shift(4),J==134695760&&(J=_.read_shift(4),nt=!0),K=_.read_shift(4),Q=_.read_shift(4)),K!=b&&gr(nt,"Bad compressed size: "+b+" != "+K),Q!=N&&gr(nt,"Bad uncompressed size: "+N+" != "+Q),mi(I,Ne,Me,{unsafe:!0,mt:ie})}function o0(_,b){var N=b||{},I=[],F=[],P=te(1),Y=N.compression?8:0,ie=0,J=0,K=0,Q=0,fe=0,me=_.FullPaths[0],Ne=me,he=_.FileIndex[0],we=[],Me=0;for(J=1;J<_.FullPaths.length;++J)if(Ne=_.FullPaths[J].slice(me.length),he=_.FileIndex[J],!(!he.size||!he.content||Ne=="Sh33tJ5")){var nt=Q,st=te(Ne.length);for(K=0;K<Ne.length;++K)st.write_shift(1,Ne.charCodeAt(K)&127);st=st.slice(0,st.l),we[fe]=nS.buf(he.content,0);var Rt=he.content;Y==8&&(Rt=G(Rt)),P=te(30),P.write_shift(4,67324752),P.write_shift(2,20),P.write_shift(2,ie),P.write_shift(2,Y),he.mt?s(P,he.mt):P.write_shift(4,0),P.write_shift(-4,we[fe]),P.write_shift(4,Rt.length),P.write_shift(4,he.content.length),P.write_shift(2,st.length),P.write_shift(2,0),Q+=P.length,I.push(P),Q+=st.length,I.push(st),Q+=Rt.length,I.push(Rt),P=te(46),P.write_shift(4,33639248),P.write_shift(2,0),P.write_shift(2,20),P.write_shift(2,ie),P.write_shift(2,Y),P.write_shift(4,0),P.write_shift(-4,we[fe]),P.write_shift(4,Rt.length),P.write_shift(4,he.content.length),P.write_shift(2,st.length),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(4,0),P.write_shift(4,nt),Me+=P.l,F.push(P),Me+=st.length,F.push(st),++fe}return P=te(22),P.write_shift(4,101010256),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,fe),P.write_shift(2,fe),P.write_shift(4,Me),P.write_shift(4,Q),P.write_shift(2,0),Vt([Vt(I),Vt(F),P])}var Xi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function hi(_,b){if(_.ctype)return _.ctype;var N=_.name||"",I=N.match(/\.([^\.]+)$/);return I&&Xi[I[1]]||b&&(I=(N=b).match(/[\.\\]([^\.\\])+$/),I&&Xi[I[1]])?Xi[I[1]]:"application/octet-stream"}function Co(_){for(var b=so(_),N=[],I=0;I<b.length;I+=76)N.push(b.slice(I,I+76));return N.join(`\r
`)+`\r
`}function Qi(_){var b=_.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(K){var Q=K.charCodeAt(0).toString(16).toUpperCase();return"="+(Q.length==1?"0"+Q:Q)});b=b.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),b.charAt(0)==`
`&&(b="=0D"+b.slice(1)),b=b.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var N=[],I=b.split(`\r
`),F=0;F<I.length;++F){var P=I[F];if(P.length==0){N.push("");continue}for(var Y=0;Y<P.length;){var ie=76,J=P.slice(Y,Y+ie);J.charAt(ie-1)=="="?ie--:J.charAt(ie-2)=="="?ie-=2:J.charAt(ie-3)=="="&&(ie-=3),J=P.slice(Y,Y+ie),Y+=ie,Y<P.length&&(J+="="),N.push(J)}}return N.join(`\r
`)}function Zi(_){for(var b=[],N=0;N<_.length;++N){for(var I=_[N];N<=_.length&&I.charAt(I.length-1)=="=";)I=I.slice(0,I.length-1)+_[++N];b.push(I)}for(var F=0;F<b.length;++F)b[F]=b[F].replace(/[=][0-9A-Fa-f]{2}/g,function(P){return String.fromCharCode(parseInt(P.slice(1),16))});return Qn(b.join(`\r
`))}function es(_,b,N){for(var I="",F="",P="",Y,ie=0;ie<10;++ie){var J=b[ie];if(!J||J.match(/^\s*$/))break;var K=J.match(/^(.*?):\s*([^\s].*)$/);if(K)switch(K[1].toLowerCase()){case"content-location":I=K[2].trim();break;case"content-type":P=K[2].trim();break;case"content-transfer-encoding":F=K[2].trim();break}}switch(++ie,F.toLowerCase()){case"base64":Y=Qn(kr(b.slice(ie).join("")));break;case"quoted-printable":Y=Zi(b.slice(ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var Q=mi(_,I.slice(N.length),Y,{unsafe:!0});P&&(Q.ctype=P)}function No(_,b){if(ae(_.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var N=b&&b.root||"",I=(Ye&&Buffer.isBuffer(_)?_.toString("binary"):ae(_)).split(`\r
`),F=0,P="";for(F=0;F<I.length;++F)if(P=I[F],!!/^Content-Location:/i.test(P)&&(P=P.slice(P.indexOf("file")),N||(N=P.slice(0,P.lastIndexOf("/")+1)),P.slice(0,N.length)!=N))for(;N.length>0&&(N=N.slice(0,N.length-1),N=N.slice(0,N.lastIndexOf("/")+1),P.slice(0,N.length)!=N););var Y=(I[1]||"").match(/boundary="(.*?)"/);if(!Y)throw new Error("MAD cannot find boundary");var ie="--"+(Y[1]||""),J=[],K=[],Q={FileIndex:J,FullPaths:K};R(Q);var fe,me=0;for(F=0;F<I.length;++F){var Ne=I[F];Ne!==ie&&Ne!==ie+"--"||(me++&&es(Q,I.slice(fe,F),N),fe=F)}return Q}function ts(_,b){var N=b||{},I=N.boundary||"SheetJS";I="------="+I;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+I.slice(2)+'"',"","",""],P=_.FullPaths[0],Y=P,ie=_.FileIndex[0],J=1;J<_.FullPaths.length;++J)if(Y=_.FullPaths[J].slice(P.length),ie=_.FileIndex[J],!(!ie.size||!ie.content||Y=="Sh33tJ5")){Y=Y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Me){return"_x"+Me.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Me){return"_u"+Me.charCodeAt(0).toString(16)+"_"});for(var K=ie.content,Q=Ye&&Buffer.isBuffer(K)?K.toString("binary"):ae(K),fe=0,me=Math.min(1024,Q.length),Ne=0,he=0;he<=me;++he)(Ne=Q.charCodeAt(he))>=32&&Ne<128&&++fe;var we=fe>=me*4/5;F.push(I),F.push("Content-Location: "+(N.root||"file:///C:/SheetJS/")+Y),F.push("Content-Transfer-Encoding: "+(we?"quoted-printable":"base64")),F.push("Content-Type: "+hi(ie,Y)),F.push(""),F.push(we?Qi(Q):Co(Q))}return F.push(I+`--\r
`),F.join(`\r
`)}function Ao(_){var b={};return R(b,_),b}function mi(_,b,N,I){var F=I&&I.unsafe;F||R(_);var P=!F&&tt.find(_,b);if(!P){var Y=_.FullPaths[0];b.slice(0,Y.length)==Y?Y=b:(Y.slice(-1)!="/"&&(Y+="/"),Y=(Y+b).replace("//","/")),P={name:i(b),type:2},_.FileIndex.push(P),_.FullPaths.push(Y),F||tt.utils.cfb_gc(_)}return P.content=N,P.size=N?N.length:0,I&&(I.CLSID&&(P.clsid=I.CLSID),I.mt&&(P.mt=I.mt),I.ct&&(P.ct=I.ct)),P}function ns(_,b){R(_);var N=tt.find(_,b);if(N){for(var I=0;I<_.FileIndex.length;++I)if(_.FileIndex[I]==N)return _.FileIndex.splice(I,1),_.FullPaths.splice(I,1),!0}return!1}function Io(_,b,N){R(_);var I=tt.find(_,b);if(I){for(var F=0;F<_.FileIndex.length;++F)if(_.FileIndex[F]==I)return _.FileIndex[F].name=i(N),_.FullPaths[F]=N,!0}return!1}function Ou(_){M(_,!0)}return t.find=z,t.read=B,t.parse=l,t.write=ce,t.writeFile=se,t.utils={cfb_new:Ao,cfb_add:mi,cfb_del:ns,cfb_mov:Io,cfb_gc:Ou,ReadShift:Da,CheckField:$1,prep_blob:wn,bconcat:Vt,use_zlib:D,_deflateRaw:ar,_inflateRaw:Yi,consts:ke},t}();function rS(e){return typeof e=="string"?Cu(e):Array.isArray(e)?RT(e):e}function yo(e,t,n){if(typeof Deno<"u"){if(n&&typeof t=="string")switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=Cu(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r=n=="utf8"?oo(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var i=new Blob([rS(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=vo(t)),o.write(t),o.close(),t}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function Wt(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function zp(e,t){for(var n=[],r=Wt(e),i=0;i!==r.length;++i)n[e[r[i]][t]]==null&&(n[e[r[i]][t]]=r[i]);return n}function Pf(e){for(var t=[],n=Wt(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function Iu(e){for(var t=[],n=Wt(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}function iS(e){for(var t=[],n=Wt(e),r=0;r!==n.length;++r)t[e[n[r]]]==null&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}var Yl=new Date(1899,11,30,0,0,0);function vn(e,t){var n=e.getTime(),r=Yl.getTime()+(e.getTimezoneOffset()-Yl.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var _1=new Date,sS=Yl.getTime()+(_1.getTimezoneOffset()-Yl.getTimezoneOffset())*6e4,qp=_1.getTimezoneOffset();function C1(e){var t=new Date;return t.setTime(e*24*60*60*1e3+sS),t.getTimezoneOffset()!==qp&&t.setTime(t.getTime()+(t.getTimezoneOffset()-qp)*6e4),t}var Wp=new Date("2017-02-19T19:06:09.000Z"),N1=isNaN(Wp.getFullYear())?new Date("2/19/17"):Wp,aS=N1.getFullYear()==2017;function un(e,t){var n=new Date(e);if(aS)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(N1.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ru(e,t){if(Ye&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return n[s]||s})}catch{}for(var r=[],i=0;i!=e.length;++i)r.push(String.fromCharCode(e[i]));return r.join("")}function yn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=yn(e[n]));return t}function xt(e,t){for(var n="";n.length<t;)n+=e;return n}function _r(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return n=-n,s}),!isNaN(t=Number(r)))?t/n:t}var oS=["january","february","march","april","may","june","july","august","september","october","november","december"];function ao(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return n;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&oS.indexOf(a)==-1)return n}else if(a.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||s>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}function Be(e,t,n){if(e.FullPaths){if(typeof n=="string"){var r;return Ye?r=Mr(n):r=kT(n),tt.utils.cfb_add(e,t,r)}tt.utils.cfb_add(e,t,n)}else e.file(t,n)}function Mf(){return tt.utils.cfb_new()}var _t=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,lS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Df=Pf(lS),Lf=/[&<>'"]/g,uS=/[\u0000-\u0008\u000b-\u001f]/g;function Qe(e){var t=e+"";return t.replace(Lf,function(n){return Df[n]}).replace(uS,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Jp(e){return Qe(e).replace(/ /g,"_x0020_")}var A1=/[\u0000-\u001f]/g;function cS(e){var t=e+"";return t.replace(Lf,function(n){return Df[n]}).replace(/\n/g,"<br/>").replace(A1,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function dS(e){var t=e+"";return t.replace(Lf,function(n){return Df[n]}).replace(A1,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}function fS(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function pS(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function mc(e){for(var t="",n=0,r=0,i=0,s=0,a=0,o=0;n<e.length;){if(r=e.charCodeAt(n++),r<128){t+=String.fromCharCode(r);continue}if(i=e.charCodeAt(n++),r>191&&r<224){a=(r&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(n++),r<240){t+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(n++),o=((r&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Yp(e){var t=Pi(2*e.length),n,r,i=1,s=0,a=0,o;for(r=0;r<e.length;r+=i)i=1,(o=e.charCodeAt(r))<128?n=o:o<224?(n=(o&31)*64+(e.charCodeAt(r+1)&63),i=2):o<240?(n=(o&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),i=3):(i=4,n=(o&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),n-=65536,a=55296+(n>>>10&1023),n=56320+(n&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=n%256,t[s++]=n>>>8;return t.slice(0,s).toString("ucs2")}function Kp(e){return Mr(e,"binary").toString("utf8")}var Ko="foo bar baz",Ma=Ye&&(Kp(Ko)==mc(Ko)&&Kp||Yp(Ko)==mc(Ko)&&Yp)||mc,oo=Ye?function(e){return Mr(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,i=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},hS=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)r=r.replace(e[i][0],e[i][1]);return r}}(),I1=/(^\s|\s$|\n)/;function jt(e,t){return"<"+e+(t.match(I1)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function lo(e){return Wt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ge(e,t,n){return"<"+e+(n!=null?lo(n):"")+(t!=null?(t.match(I1)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Sd(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function mS(e,t){switch(typeof e){case"string":var n=ge("vt:lpwstr",Qe(e));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return ge((e|0)==e?"vt:i4":"vt:r8",Qe(String(e)));case"boolean":return ge("vt:bool",e?"true":"false")}if(e instanceof Date)return ge("vt:filetime",Sd(e));throw new Error("Unable to serialize "+e)}var Pt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ks=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],_n={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function gS(e,t){for(var n=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return r==2047?i==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}function xS(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=r?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[n+o]=s&255;e[n+6]=(i&15)<<4|s&15,e[n+7]=i>>4|r}var Xp=function(e){for(var t=[],n=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var i=0,s=e[0][r].length;i<s;i+=n)t.push.apply(t,e[0][r].slice(i,i+n));return t},Qp=Ye?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Mr(t)})):Xp(e)}:Xp,Zp=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(wa(e,i)));return r.join("").replace(Pa,"")},Of=Ye?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(Pa,""):Zp(e,t,n)}:Zp,eh=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},R1=Ye?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):eh(e,t,n)}:eh,th=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(ls(e,i)));return r.join("")},Eo=Ye?function(t,n,r){return Buffer.isBuffer(t)?t.toString("utf8",n,r):th(t,n,r)}:th,k1=function(e,t){var n=Cn(e,t);return n>0?Eo(e,t+4,t+4+n-1):""},b1=k1,F1=function(e,t){var n=Cn(e,t);return n>0?Eo(e,t+4,t+4+n-1):""},P1=F1,M1=function(e,t){var n=2*Cn(e,t);return n>0?Eo(e,t+4,t+4+n-1):""},D1=M1,L1=function(t,n){var r=Cn(t,n);return r>0?Of(t,n+4,n+4+r):""},O1=L1,U1=function(e,t){var n=Cn(e,t);return n>0?Eo(e,t+4,t+4+n):""},B1=U1,G1=function(e,t){return gS(e,t)},Kl=G1,Uf=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ye&&(b1=function(t,n){if(!Buffer.isBuffer(t))return k1(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},P1=function(t,n){if(!Buffer.isBuffer(t))return F1(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},D1=function(t,n){if(!Buffer.isBuffer(t))return M1(t,n);var r=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r-1)},O1=function(t,n){if(!Buffer.isBuffer(t))return L1(t,n);var r=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r)},B1=function(t,n){if(!Buffer.isBuffer(t))return U1(t,n);var r=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+r)},Kl=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):G1(t,n)},Uf=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ls=function(e,t){return e[t]},wa=function(e,t){return e[t+1]*256+e[t]},vS=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},Cn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ti=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},yS=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Da(e,t){var n="",r,i,s=[],a,o,u,c;switch(t){case"dbcs":if(c=this.l,Ye&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)n+=String.fromCharCode(wa(this,c)),c+=2;e*=2;break;case"utf8":n=Eo(this,this.l,this.l+e);break;case"utf16le":e*=2,n=Of(this,this.l,this.l+e);break;case"wstr":return Da.call(this,e,"dbcs");case"lpstr-ansi":n=b1(this,this.l),e=4+Cn(this,this.l);break;case"lpstr-cp":n=P1(this,this.l),e=4+Cn(this,this.l);break;case"lpwstr":n=D1(this,this.l),e=4+2*Cn(this,this.l);break;case"lpp4":e=4+Cn(this,this.l),n=O1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Cn(this,this.l),n=B1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(a=ls(this,this.l+e++))!==0;)s.push(Wo(a));n=s.join("");break;case"_wstr":for(e=0,n="";(a=wa(this,this.l+e))!==0;)s.push(Wo(a)),e+=2;e+=2,n=s.join("");break;case"dbcs-cont":for(n="",c=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(c)!==-1)return a=ls(this,c),this.l=c+1,o=Da.call(this,e-u,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Wo(wa(this,c))),c+=2}n=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",c=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(c)!==-1)return a=ls(this,c),this.l=c+1,o=Da.call(this,e-u,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Wo(ls(this,c))),c+=1}n=s.join("");break;default:switch(e){case 1:return r=ls(this,this.l),this.l++,r;case 2:return r=(t==="i"?vS:wa)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(r=(e>0?Ti:yS)(this,this.l),this.l+=4,r):(i=Cn(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Kl(this,this.l):i=Kl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:n=R1(this,this.l,e);break}}return this.l+=e,n}var ES=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},TS=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},SS=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function wS(e,t,n){var r=0,i=0;if(n==="dbcs"){for(i=0;i!=t.length;++i)SS(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;r=t.length}else if(n==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(n==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,ES(this,t,this.l);break;case 8:if(r=8,n==="f"){xS(this,t,this.l);break}case 16:break;case-4:r=4,TS(this,t,this.l);break}return this.l+=r,this}function $1(e,t){var n=R1(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function wn(e,t){e.l=t,e.read_shift=Da,e.chk=$1,e.write_shift=wS}function hr(e,t){e.l+=t}function te(e){var t=Pi(e);return wn(t,0),t}function xn(){var e=[],t=Ye?256:2048,n=function(c){var l=te(c);return wn(l,0),l},r=n(t),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},s=function(c){return r&&c<r.length-r.l?r:(i(),r=n(Math.max(c+1,t)))},a=function(){return i(),Vt(e)},o=function(c){i(),r=c,r.l==null&&(r.l=r.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function le(e,t,n,r){var i=+t,s;if(!isNaN(i)){r||(r=gI[i].p||(n||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var a=e.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(r>=128)a.write_shift(1,(r&127)+128),r>>=7;else{a.write_shift(1,r);break}r>0&&Uf(n)&&e.push(n)}}function La(e,t,n){var r=yn(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function nh(e,t,n){var r=yn(e);return r.s=La(r.s,t.s,n),r.e=La(r.e,t.s,n),r}function Oa(e,t){if(e.cRel&&e.c<0)for(e=yn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=yn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=et(e);return!e.cRel&&e.cRel!=null&&(n=NS(n)),!e.rRel&&e.rRel!=null&&(n=_S(n)),n}function gc(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Zt(e.s.c)+":"+(e.e.cRel?"":"$")+Zt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+zt(e.s.r)+":"+(e.e.rRel?"":"$")+zt(e.e.r):Oa(e.s,t.biff)+":"+Oa(e.e,t.biff)}function Bf(e){return parseInt(CS(e),10)-1}function zt(e){return""+(e+1)}function _S(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function CS(e){return e.replace(/\$(\d+)$/,"$1")}function Gf(e){for(var t=AS(e),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function Zt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function NS(e){return e.replace(/^([A-Z])/,"$$$1")}function AS(e){return e.replace(/^\$([A-Z])/,"$1")}function IS(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Mt(e){for(var t=0,n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function et(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function Rn(e){var t=e.indexOf(":");return t==-1?{s:Mt(e),e:Mt(e)}:{s:Mt(e.slice(0,t)),e:Mt(e.slice(t+1))}}function wt(e,t){return typeof t>"u"||typeof t=="number"?wt(e.s,e.e):(typeof e!="string"&&(e=et(e)),typeof t!="string"&&(t=et(t)),e==t?e:e+":"+t)}function ut(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,s=e.length;for(n=0;r<s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.s.c=--n,n=0;r<s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(t.s.r=--n,r===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return t.e.r=--n,t}function rh(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ai(e.z,n?vn(t):t)}catch{}try{return e.w=ai((e.XF||{}).numFmtId||(n?14:0),n?vn(t):t)}catch{return""+t}}function br(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?To[e.v]||e.v:t==null?rh(e,e.v):rh(e,t))}function Ui(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function V1(e,t,n){var r=n||{},i=e?Array.isArray(e):r.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&r.origin!=null){if(typeof r.origin=="number")a=r.origin;else{var u=typeof r.origin=="string"?Mt(r.origin):r.origin;a=u.r,o=u.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var l=ut(s["!ref"]);c.s.c=l.s.c,c.s.r=l.s.r,c.e.c=Math.max(c.e.c,l.e.c),c.e.r=Math.max(c.e.r,l.e.r),a==-1&&(c.e.r=a=l.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[m].length;++h)if(!(typeof t[m][h]>"u")){var g={v:t[m][h]},x=a+m,v=o+h;if(c.s.r>x&&(c.s.r=x),c.s.c>v&&(c.s.c=v),c.e.r<x&&(c.e.r=x),c.e.c<v&&(c.e.c=v),t[m][h]&&typeof t[m][h]=="object"&&!Array.isArray(t[m][h])&&!(t[m][h]instanceof Date))g=t[m][h];else if(Array.isArray(g.v)&&(g.f=t[m][h][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(r.nullError)g.t="e",g.v=0;else if(r.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=r.dateNF||vt[14],r.cellDates?(g.t="d",g.w=ai(g.z,vn(g.v))):(g.t="n",g.v=vn(g.v),g.w=ai(g.z,g.v))):g.t="s";if(i)s[x]||(s[x]=[]),s[x][v]&&s[x][v].z&&(g.z=s[x][v].z),s[x][v]=g;else{var w=et({c:v,r:x});s[w]&&s[w].z&&(g.z=s[w].z),s[w]=g}}}return c.s.c<1e7&&(s["!ref"]=wt(c)),s}function Xs(e,t){return V1(null,e,t)}function RS(e){return e.read_shift(4,"i")}function nr(e,t){return t||(t=te(4)),t.write_shift(4,e),t}function en(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Dt(e,t){var n=!1;return t==null&&(n=!0,t=te(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function kS(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function bS(e,t){return t||(t=te(4)),t.write_shift(2,0),t.write_shift(2,0),t}function $f(e,t){var n=e.l,r=e.read_shift(1),i=en(e),s=[],a={t:i,h:i};if(r&1){for(var o=e.read_shift(4),u=0;u!=o;++u)s.push(kS(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=n+t,a}function FS(e,t){var n=!1;return t==null&&(n=!0,t=te(15+4*e.t.length)),t.write_shift(1,0),Dt(e.t,t),n?t.slice(0,t.l):t}var PS=$f;function MS(e,t){var n=!1;return t==null&&(n=!0,t=te(23+4*e.t.length)),t.write_shift(1,1),Dt(e.t,t),t.write_shift(4,1),bS({},t),n?t.slice(0,t.l):t}function Hn(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function Bi(e,t){return t==null&&(t=te(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Gi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function $i(e,t){return t==null&&(t=te(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var DS=en,j1=Dt;function Vf(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Xl(e,t){var n=!1;return t==null&&(n=!0,t=te(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var LS=en,wd=Vf,jf=Xl;function H1(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,r=t[0]&2;e.l+=4;var i=r===0?Kl([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ti(t,0)>>2;return n?i/100:i}function z1(e,t){t==null&&(t=te(4));var n=0,r=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,n=1),r)t.write_shift(-4,((n?i:e)<<2)+(n+2));else throw new Error("unsupported RkNumber "+e)}function q1(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function OS(e,t){return t||(t=te(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Vi=q1,Qs=OS;function Zs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Mi(e,t){return(t||te(8)).write_shift(8,e,"f")}function US(e){var t={},n=e.read_shift(1),r=n>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=i;var c=WS[i];c&&(t.rgb=hh(c));break;case 2:t.rgb=hh([a,o,u]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Ql(e,t){if(t||(t=te(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}return t}function BS(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function GS(e,t){t||(t=te(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,n),t.write_shift(1,0),t}var W1=2,Tn=3,Xo=11,Zl=19,Qo=64,$S=65,VS=71,jS=4108,HS=4126,Gt=80,ih={1:{n:"CodePage",t:W1},2:{n:"Category",t:Gt},3:{n:"PresentationFormat",t:Gt},4:{n:"ByteCount",t:Tn},5:{n:"LineCount",t:Tn},6:{n:"ParagraphCount",t:Tn},7:{n:"SlideCount",t:Tn},8:{n:"NoteCount",t:Tn},9:{n:"HiddenCount",t:Tn},10:{n:"MultimediaClipCount",t:Tn},11:{n:"ScaleCrop",t:Xo},12:{n:"HeadingPairs",t:jS},13:{n:"TitlesOfParts",t:HS},14:{n:"Manager",t:Gt},15:{n:"Company",t:Gt},16:{n:"LinksUpToDate",t:Xo},17:{n:"CharacterCount",t:Tn},19:{n:"SharedDoc",t:Xo},22:{n:"HyperlinksChanged",t:Xo},23:{n:"AppVersion",t:Tn,p:"version"},24:{n:"DigSig",t:$S},26:{n:"ContentType",t:Gt},27:{n:"ContentStatus",t:Gt},28:{n:"Language",t:Gt},29:{n:"Version",t:Gt},255:{},2147483648:{n:"Locale",t:Zl},2147483651:{n:"Behavior",t:Zl},1919054434:{}},sh={1:{n:"CodePage",t:W1},2:{n:"Title",t:Gt},3:{n:"Subject",t:Gt},4:{n:"Author",t:Gt},5:{n:"Keywords",t:Gt},6:{n:"Comments",t:Gt},7:{n:"Template",t:Gt},8:{n:"LastAuthor",t:Gt},9:{n:"RevNumber",t:Gt},10:{n:"EditTime",t:Qo},11:{n:"LastPrinted",t:Qo},12:{n:"CreatedDate",t:Qo},13:{n:"ModifiedDate",t:Qo},14:{n:"PageCount",t:Tn},15:{n:"WordCount",t:Tn},16:{n:"CharCount",t:Tn},17:{n:"Thumbnail",t:VS},18:{n:"Application",t:Gt},19:{n:"DocSecurity",t:Tn},255:{},2147483648:{n:"Locale",t:Zl},2147483651:{n:"Behavior",t:Zl},1919054434:{}};function zS(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var qS=zS([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),WS=yn(qS),To={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},JS={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Zo={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function J1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Y1(e,t){var n=iS(JS),r=[],i;r[r.length]=_t,r[r.length]=ge("Types",null,{xmlns:Pt.CT,"xmlns:xsd":Pt.xsd,"xmlns:xsi":Pt.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return ge("Default",null,{Extension:u[0],ContentType:u[1]})}));var s=function(u){e[u]&&e[u].length>0&&(i=e[u][0],r[r.length]=ge("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Zo[u][t.bookType]||Zo[u].xlsx}))},a=function(u){(e[u]||[]).forEach(function(c){r[r.length]=ge("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Zo[u][t.bookType]||Zo[u].xlsx})})},o=function(u){(e[u]||[]).forEach(function(c){r[r.length]=ge("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:n[u][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var We={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function K1(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ps(e){var t=[_t,ge("Relationships",null,{xmlns:Pt.RELS})];return Wt(e["!id"]).forEach(function(n){t[t.length]=ge("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Xe(e,t,n,r,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=n,[We.HLINK,We.XPATH,We.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function YS(e){var t=[_t];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function ah(e,t,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function KS(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function XS(e){var t=[_t];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=e.length;++n)t.push(ah(e[n][0],e[n][1])),t.push(KS("",e[n][0]));return t.push(ah("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function X1(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Hl.version+"</meta:generator></office:meta></office:document-meta>"}var Ai=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function xc(e,t,n,r,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Qe(t),r[r.length]=n?ge(e,t,n):jt(e,t))}function Q1(e,t){var n=t||{},r=[_t,ge("cp:coreProperties",null,{"xmlns:cp":Pt.CORE_PROPS,"xmlns:dc":Pt.dc,"xmlns:dcterms":Pt.dcterms,"xmlns:dcmitype":Pt.dcmitype,"xmlns:xsi":Pt.xsi})],i={};if(!e&&!n.Props)return r.join("");e&&(e.CreatedDate!=null&&xc("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Sd(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),e.ModifiedDate!=null&&xc("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Sd(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=Ai.length;++s){var a=Ai[s],o=n.Props&&n.Props[a[1]]!=null?n.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&xc(a[0],o,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Ms=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Z1=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ev(e){var t=[],n=ge;return e||(e={}),e.Application="SheetJS",t[t.length]=_t,t[t.length]=ge("Properties",null,{xmlns:Pt.EXT_PROPS,"xmlns:vt":Pt.vt}),Ms.forEach(function(r){if(e[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Qe(String(e[r[1]]));break;case"bool":i=e[r[1]]?"true":"false";break}i!==void 0&&(t[t.length]=n(r[0],i))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+Qe(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function tv(e){var t=[_t,ge("Properties",null,{xmlns:Pt.CUST_PROPS,"xmlns:vt":Pt.vt})];if(!e)return t.join("");var n=1;return Wt(e).forEach(function(i){++n,t[t.length]=ge("property",mS(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Qe(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var oh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function QS(e,t){var n=[];return Wt(oh).map(function(r){for(var i=0;i<Ai.length;++i)if(Ai[i][1]==r)return Ai[i];for(i=0;i<Ms.length;++i)if(Ms[i][1]==r)return Ms[i];throw r}).forEach(function(r){if(e[r[1]]!=null){var i=t&&t.Props&&t.Props[r[1]]!=null?t.Props[r[1]]:e[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(jt(oh[r[1]]||r[1],i))}}),ge("DocumentProperties",n.join(""),{xmlns:_n.o})}function ZS(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return e&&Wt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var a=0;a<Ai.length;++a)if(s==Ai[a][1])return;for(a=0;a<Ms.length;++a)if(s==Ms[a][1])return;for(a=0;a<n.length;++a)if(s==n[a])return;var o=e[s],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o=String(o),i.push(ge(Jp(s),o,{"dt:dt":u}))}}),t&&Wt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(ge(Jp(s),a,{"dt:dt":o}))}}),"<"+r+' xmlns="'+_n.o+'">'+i.join("")+"</"+r+">"}function ew(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,n=t.getTime()/1e3+11644473600,r=n%Math.pow(2,32),i=(n-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var a=te(8);return a.write_shift(4,r),a.write_shift(4,i),a}function lh(e,t){var n=te(4),r=te(4);switch(n.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,t);break;case 5:r=te(8),r.write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=ew(t);break;case 31:case 80:for(r=te(4+2*(t.length+1)+(t.length%2?0:2)),r.write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Vt([n,r])}var nv=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function tw(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function uh(e,t,n){var r=te(8),i=[],s=[],a=8,o=0,u=te(8),c=te(8);if(u.write_shift(4,2),u.write_shift(4,1200),c.write_shift(4,1),s.push(u),i.push(c),a+=8+u.length,!t){c=te(8),c.write_shift(4,0),i.unshift(c);var l=[te(4)];for(l[0].write_shift(4,e.length),o=0;o<e.length;++o){var m=e[o][0];for(u=te(8+2*(m.length+1)+(m.length%2?0:2)),u.write_shift(4,o+2),u.write_shift(4,m.length+1),u.write_shift(0,m,"dbcs");u.l!=u.length;)u.write_shift(1,0);l.push(u)}u=Vt(l),s.unshift(u),a+=8+u.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(nv.indexOf(e[o][0])>-1||Z1.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],g=0;if(t){g=+t[e[o][0]];var x=n[g];if(x.p=="version"&&typeof h=="string"){var v=h.split(".");h=(+v[0]<<16)+(+v[1]||0)}u=lh(x.t,h)}else{var w=tw(h);w==-1&&(w=31,h=String(h)),u=lh(w,h)}s.push(u),c=te(8),c.write_shift(4,t?g:2+o),i.push(c),a+=8+u.length}var E=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,E),E+=s[o].length;return r.write_shift(4,a),r.write_shift(4,s.length),Vt([r].concat(i).concat(s))}function ch(e,t,n,r,i,s){var a=te(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,tt.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var u=uh(e,n,r);if(o.push(u),i){var c=uh(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+u.length),o.push(c)}return Vt(o)}function nw(e,t){t||(t=te(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}function rw(e,t){return e.read_shift(t)===1}function on(e,t){return t||(t=te(2)),t.write_shift(2,+!!e),t}function rv(e){return e.read_shift(2,"u")}function Ln(e,t){return t||(t=te(2)),t.write_shift(2,e),t}function iv(e,t,n){return n||(n=te(2)),n.write_shift(1,t=="e"?+e:+!!e),n.write_shift(1,t=="e"?1:0),n}function sv(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else n.biff==12&&(i="wstr");n.biff>=2&&n.biff<=5&&(i="cpstr");var a=r?e.read_shift(r,i):"";return a}function iw(e){var t=e.t||"",n=te(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=te(2*t.length);r.write_shift(2*t.length,t,"utf16le");var i=[n,r];return Vt(i)}function sw(e,t,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function aw(e,t,n){var r=e.read_shift(n&&n.biff==2?1:2);return r===0?(e.l++,""):sw(e,r,n)}function ow(e,t,n){if(n.biff>5)return aw(e,t,n);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function av(e,t,n){return n||(n=te(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function dh(e,t){t||(t=te(6+e.length*2)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function lw(e){var t=te(512),n=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(n=0;n<a.length;++n)t.write_shift(4,a[n]);if(s==28)r=r.slice(1),dh(r,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<a.length;++n)t.write_shift(1,parseInt(a[n],16));var o=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(o.length+1)),n=0;n<o.length;++n)t.write_shift(2,o.charCodeAt(n));t.write_shift(2,0),s&8&&dh(i>-1?r.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<a.length;++n)t.write_shift(1,parseInt(a[n],16));for(var u=0;r.slice(u*3,u*3+3)=="../"||r.slice(u*3,u*3+3)=="..\\";)++u;for(t.write_shift(2,u),t.write_shift(4,r.length-3*u+1),n=0;n<r.length-3*u;++n)t.write_shift(1,r.charCodeAt(n+3*u)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function Di(e,t,n,r){return r||(r=te(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function uw(e,t,n){var r=n.biff>8?4:2,i=e.read_shift(r),s=e.read_shift(r,"i"),a=e.read_shift(r,"i");return[i,s,a]}function cw(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2);return{s:{c:r,r:t},e:{c:i,r:n}}}function ov(e,t){return t||(t=te(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Hf(e,t,n){var r=1536,i=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=te(i);return s.write_shift(2,r),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function dw(e,t){var n=!t||t.biff==8,r=te(n?112:54);for(r.write_shift(t.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function fw(e,t){var n=!t||t.biff>=8?2:1,r=te(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function pw(e,t){var n=te(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var r=[],i=0;i<e.length;++i)r[i]=iw(e[i]);var s=Vt([n].concat(r));return s.parts=[n.length].concat(r.map(function(a){return a.length})),s}function hw(){var e=te(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function mw(e){var t=te(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function gw(e,t){var n=e.name||"Arial",r=t&&t.biff==5,i=r?15+n.length:16+2*n.length,s=te(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,n.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),s}function xw(e,t,n,r){var i=te(10);return Di(e,t,r,i),i.write_shift(4,n),i}function vw(e,t,n,r,i){var s=!i||i.biff==8,a=te(8+ +s+(1+s)*n.length);return Di(e,t,r,a),a.write_shift(2,n.length),s&&a.write_shift(1,1),a.write_shift((1+s)*n.length,n,s?"utf16le":"sbcs"),a}function yw(e,t,n,r){var i=n&&n.biff==5;r||(r=te(i?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function Ew(e,t){var n=t.biff==8||!t.biff?4:2,r=te(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function fh(e,t,n,r){var i=n&&n.biff==5;r||(r=te(i?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function Tw(e){var t=te(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Sw(e,t,n,r,i,s){var a=te(8);return Di(e,t,r,a),iv(n,s,a),a}function ww(e,t,n,r){var i=te(14);return Di(e,t,r,i),Mi(n,i),i}function _w(e,t,n){if(n.biff<8)return Cw(e,t,n);for(var r=[],i=e.l+t,s=e.read_shift(n.biff>8?4:2);s--!==0;)r.push(uw(e,n.biff>8?12:6,n));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function Cw(e,t,n){e[e.l+1]==3&&e[e.l]++;var r=sv(e,t,n);return r.charCodeAt(0)==3?r.slice(1):r}function Nw(e){var t=te(2+e.length*8);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)ov(e[n],t);return t}function Aw(e){var t=te(24),n=Mt(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return Vt([t,lw(e[1])])}function Iw(e){var t=e[1].Tooltip,n=te(10+2*(t.length+1));n.write_shift(2,2048);var r=Mt(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<t.length;++i)n.write_shift(2,t.charCodeAt(i));return n.write_shift(2,0),n}function Rw(e){return e||(e=te(4)),e.write_shift(2,1),e.write_shift(2,1),e}function kw(e,t,n){if(!n.cellStyles)return hr(e,t);var r=n&&n.biff>=12?4:2,i=e.read_shift(r),s=e.read_shift(r),a=e.read_shift(r),o=e.read_shift(r),u=e.read_shift(2);r==2&&(e.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:u};return(n.biff>=5||!n.biff)&&(c.level=u>>8&7),c}function bw(e,t){var n=te(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,e.width*256),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function Fw(e){for(var t=te(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}function Pw(e,t,n){var r=te(15);return wo(r,e,t),r.write_shift(8,n,"f"),r}function Mw(e,t,n){var r=te(9);return wo(r,e,t),r.write_shift(2,n),r}var Dw=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Pf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(o,u){var c=[],l=Pi(1);switch(u.type){case"base64":l=Qn(kr(o));break;case"binary":l=Qn(o);break;case"buffer":case"array":l=o;break}wn(l,0);var m=l.read_shift(1),h=!!(m&136),g=!1,x=!1;switch(m){case 2:break;case 3:break;case 48:g=!0,h=!0;break;case 49:g=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var v=0,w=521;m==2&&(v=l.read_shift(2)),l.l+=3,m!=2&&(v=l.read_shift(4)),v>1048576&&(v=1e6),m!=2&&(w=l.read_shift(2));var E=l.read_shift(2),y=u.codepage||1252;m!=2&&(l.l+=16,l.read_shift(1),l[l.l]!==0&&(y=e[l[l.l]]),l.l+=1,l.l+=2),x&&(l.l+=36);for(var T=[],C={},L=Math.min(l.length,m==2?521:w-10-(g?264:0)),B=x?32:11;l.l<L&&l[l.l]!=13;)switch(C={},C.name=zl.utils.decode(y,l.slice(l.l,l.l+B)).replace(/[\u0000\r\n].*$/g,""),l.l+=B,C.type=String.fromCharCode(l.read_shift(1)),m!=2&&!x&&(C.offset=l.read_shift(4)),C.len=l.read_shift(1),m==2&&(C.offset=l.read_shift(2)),C.dec=l.read_shift(1),C.name.length&&T.push(C),m!=2&&(l.l+=x?13:14),C.type){case"B":(!g||C.len!=8)&&u.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(l[l.l]!==13&&(l.l=w-1),l.read_shift(1)!==13)throw new Error("DBF Terminator not found "+l.l+" "+l[l.l]);l.l=w;var R=0,O=0;for(c[0]=[],O=0;O!=T.length;++O)c[0][O]=T[O].name;for(;v-- >0;){if(l[l.l]===42){l.l+=E;continue}for(++l.l,c[++R]=[],O=0,O=0;O!=T.length;++O){var M=l.slice(l.l,l.l+T[O].len);l.l+=T[O].len,wn(M,0);var k=zl.utils.decode(y,M);switch(T[O].type){case"C":k.trim().length&&(c[R][O]=k.replace(/\s+$/,""));break;case"D":k.length===8?c[R][O]=new Date(+k.slice(0,4),+k.slice(4,6)-1,+k.slice(6,8)):c[R][O]=k;break;case"F":c[R][O]=parseFloat(k.trim());break;case"+":case"I":c[R][O]=x?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(k.trim().toUpperCase()){case"Y":case"T":c[R][O]=!0;break;case"N":case"F":c[R][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+k+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));c[R][O]="##MEMO##"+(x?parseInt(k.trim(),10):M.read_shift(4));break;case"N":k=k.replace(/\u0000/g,"").trim(),k&&k!="."&&(c[R][O]=+k||0);break;case"@":c[R][O]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":c[R][O]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":c[R][O]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[R][O]=-M.read_shift(-8,"f");break;case"B":if(g&&T[O].len==8){c[R][O]=M.read_shift(8,"f");break}case"G":case"P":M.l+=T[O].len;break;case"0":if(T[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[O].type)}}}if(m!=2&&l.l<l.length&&l[l.l++]!=26)throw new Error("DBF EOF Marker missing "+(l.l-1)+" of "+l.length+" "+l[l.l-1].toString(16));return u&&u.sheetRows&&(c=c.slice(0,u.sheetRows)),u.DBF=T,c}function r(o,u){var c=u||{};c.dateNF||(c.dateNF="yyyymmdd");var l=Xs(n(o,c),c);return l["!cols"]=c.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete c.DBF,l}function i(o,u){try{return Ui(r(o,u),u)}catch(c){if(u&&u.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,u){var c=u||{};if(+c.codepage>=0&&io(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var l=xn(),m=iu(o,{header:1,raw:!0,cellDates:!0}),h=m[0],g=m.slice(1),x=o["!cols"]||[],v=0,w=0,E=0,y=1;for(v=0;v<h.length;++v){if(((x[v]||{}).DBF||{}).name){h[v]=x[v].DBF.name,++E;continue}if(h[v]!=null){if(++E,typeof h[v]=="number"&&(h[v]=h[v].toString(10)),typeof h[v]!="string")throw new Error("DBF Invalid column name "+h[v]+" |"+typeof h[v]+"|");if(h.indexOf(h[v])!==v){for(w=0;w<1024;++w)if(h.indexOf(h[v]+"_"+w)==-1){h[v]+="_"+w;break}}}}var T=ut(o["!ref"]),C=[],L=[],B=[];for(v=0;v<=T.e.c-T.s.c;++v){var R="",O="",M=0,k=[];for(w=0;w<g.length;++w)g[w][v]!=null&&k.push(g[w][v]);if(k.length==0||h[v]==null){C[v]="?";continue}for(w=0;w<k.length;++w){switch(typeof k[w]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=k[w]instanceof Date?"D":"C";break;default:O="C"}M=Math.max(M,String(k[w]).length),R=R&&R!=O?"C":O}M>250&&(M=250),O=((x[v]||{}).DBF||{}).type,O=="C"&&x[v].DBF.len>M&&(M=x[v].DBF.len),R=="B"&&O=="N"&&(R="N",B[v]=x[v].DBF.dec,M=x[v].DBF.len),L[v]=R=="C"||O=="N"?M:s[R]||0,y+=L[v],C[v]=R}var z=l.next(32);for(z.write_shift(4,318902576),z.write_shift(4,g.length),z.write_shift(2,296+32*E),z.write_shift(2,y),v=0;v<4;++v)z.write_shift(4,0);for(z.write_shift(4,0|(+t[u1]||3)<<8),v=0,w=0;v<h.length;++v)if(h[v]!=null){var X=l.next(32),ne=(h[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);X.write_shift(1,ne,"sbcs"),X.write_shift(1,C[v]=="?"?"C":C[v],"sbcs"),X.write_shift(4,w),X.write_shift(1,L[v]||s[C[v]]||0),X.write_shift(1,B[v]||0),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(4,0),w+=L[v]||s[C[v]]||0}var Fe=l.next(264);for(Fe.write_shift(4,13),v=0;v<65;++v)Fe.write_shift(4,0);for(v=0;v<g.length;++v){var q=l.next(y);for(q.write_shift(1,0),w=0;w<h.length;++w)if(h[w]!=null)switch(C[w]){case"L":q.write_shift(1,g[v][w]==null?63:g[v][w]?84:70);break;case"B":q.write_shift(8,g[v][w]||0,"f");break;case"N":var ue="0";for(typeof g[v][w]=="number"&&(ue=g[v][w].toFixed(B[w]||0)),E=0;E<L[w]-ue.length;++E)q.write_shift(1,32);q.write_shift(1,ue,"sbcs");break;case"D":g[v][w]?(q.write_shift(4,("0000"+g[v][w].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(g[v][w].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+g[v][w].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var ke=String(g[v][w]!=null?g[v][w]:"").slice(0,L[w]);for(q.write_shift(1,ke,"sbcs"),E=0;E<L[w]-ke.length;++E)q.write_shift(1,32);break}}return l.next(1).write_shift(1,26),l.end()}return{to_workbook:i,to_sheet:r,from_sheet:a}}(),Lw=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Wt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(h,g){var x=e[g];return typeof x=="number"?Lp(x):x},r=function(h,g,x){var v=g.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return v==59?h:Lp(v)};e["|"]=254;function i(h,g){switch(g.type){case"base64":return s(kr(h),g);case"binary":return s(h,g);case"buffer":return s(Ye&&Buffer.isBuffer(h)?h.toString("binary"):vo(h),g);case"array":return s(Ru(h),g)}throw new Error("Unrecognized type "+g.type)}function s(h,g){var x=h.split(/[\n\r]+/),v=-1,w=-1,E=0,y=0,T=[],C=[],L=null,B={},R=[],O=[],M=[],k=0,z;for(+g.codepage>=0&&io(+g.codepage);E!==x.length;++E){k=0;var X=x[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),ne=X.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),Fe=ne[0],q;if(X.length>0)switch(Fe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ne[1].charAt(0)=="P"&&C.push(X.slice(3).replace(/;;/g,";"));break;case"C":var ue=!1,ke=!1,se=!1,ae=!1,ce=-1,Ce=-1;for(y=1;y<ne.length;++y)switch(ne[y].charAt(0)){case"A":break;case"X":w=parseInt(ne[y].slice(1))-1,ke=!0;break;case"Y":for(v=parseInt(ne[y].slice(1))-1,ke||(w=0),z=T.length;z<=v;++z)T[z]=[];break;case"K":q=ne[y].slice(1),q.charAt(0)==='"'?q=q.slice(1,q.length-1):q==="TRUE"?q=!0:q==="FALSE"?q=!1:isNaN(_r(q))?isNaN(ao(q).getDate())||(q=un(q)):(q=_r(q),L!==null&&T1(L)&&(q=C1(q))),ue=!0;break;case"E":ae=!0;var D=M_(ne[y].slice(1),{r:v,c:w});T[v][w]=[T[v][w],D];break;case"S":se=!0,T[v][w]=[T[v][w],"S5S"];break;case"G":break;case"R":ce=parseInt(ne[y].slice(1))-1;break;case"C":Ce=parseInt(ne[y].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+X)}if(ue&&(T[v][w]&&T[v][w].length==2?T[v][w][0]=q:T[v][w]=q,L=null),se){if(ae)throw new Error("SYLK shared formula cannot have own formula");var U=ce>-1&&T[ce][Ce];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");T[v][w][1]=D_(U[1],{r:v-ce,c:w-Ce})}break;case"F":var G=0;for(y=1;y<ne.length;++y)switch(ne[y].charAt(0)){case"X":w=parseInt(ne[y].slice(1))-1,++G;break;case"Y":for(v=parseInt(ne[y].slice(1))-1,z=T.length;z<=v;++z)T[z]=[];break;case"M":k=parseInt(ne[y].slice(1))/20;break;case"F":break;case"G":break;case"P":L=C[parseInt(ne[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=ne[y].slice(1).split(" "),z=parseInt(M[0],10);z<=parseInt(M[1],10);++z)k=parseInt(M[2],10),O[z-1]=k===0?{hidden:!0}:{wch:k},zf(O[z-1]);break;case"C":w=parseInt(ne[y].slice(1))-1,O[w]||(O[w]={});break;case"R":v=parseInt(ne[y].slice(1))-1,R[v]||(R[v]={}),k>0?(R[v].hpt=k,R[v].hpx=fv(k)):k===0&&(R[v].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+X)}G<1&&(L=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+X)}}return R.length>0&&(B["!rows"]=R),O.length>0&&(B["!cols"]=O),g&&g.sheetRows&&(T=T.slice(0,g.sheetRows)),[T,B]}function a(h,g){var x=i(h,g),v=x[0],w=x[1],E=Xs(v,g);return Wt(w).forEach(function(y){E[y]=w[y]}),E}function o(h,g){return Ui(a(h,g),g)}function u(h,g,x,v){var w="C;Y"+(x+1)+";X"+(v+1)+";K";switch(h.t){case"n":w+=h.v||0,h.f&&!h.F&&(w+=";E"+Wf(h.f,{r:x,c:v}));break;case"b":w+=h.v?"TRUE":"FALSE";break;case"e":w+=h.w||h.v;break;case"d":w+='"'+(h.w||h.v)+'"';break;case"s":w+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(h,g){g.forEach(function(x,v){var w="F;W"+(v+1)+" "+(v+1)+" ";x.hidden?w+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=eu(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=tu(x.wpx)),typeof x.wch=="number"&&(w+=Math.round(x.wch))),w.charAt(w.length-1)!=" "&&h.push(w)})}function l(h,g){g.forEach(function(x,v){var w="F;";x.hidden?w+="M0;":x.hpt?w+="M"+20*x.hpt+";":x.hpx&&(w+="M"+20*nu(x.hpx)+";"),w.length>2&&h.push(w+"R"+(v+1))})}function m(h,g){var x=["ID;PWXL;N;E"],v=[],w=ut(h["!ref"]),E,y=Array.isArray(h),T=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&c(x,h["!cols"]),h["!rows"]&&l(x,h["!rows"]),x.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var C=w.s.r;C<=w.e.r;++C)for(var L=w.s.c;L<=w.e.c;++L){var B=et({r:C,c:L});E=y?(h[C]||[])[L]:h[B],!(!E||E.v==null&&(!E.f||E.F))&&v.push(u(E,h,C,L))}return x.join(T)+T+v.join(T)+T+"E"+T}return{to_workbook:o,to_sheet:a,from_sheet:m}}(),Ow=function(){function e(s,a){switch(a.type){case"base64":return t(kr(s),a);case"binary":return t(s,a);case"buffer":return t(Ye&&Buffer.isBuffer(s)?s.toString("binary"):vo(s),a);case"array":return t(Ru(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),u=-1,c=-1,l=0,m=[];l!==o.length;++l){if(o[l].trim()==="BOT"){m[++u]=[],c=0;continue}if(!(u<0)){var h=o[l].trim().split(","),g=h[0],x=h[1];++l;for(var v=o[l]||"";(v.match(/["]/g)||[]).length&1&&l<o.length-1;)v+=`
`+o[++l];switch(v=v.trim(),+g){case-1:if(v==="BOT"){m[++u]=[],c=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?m[u][c]=!0:v==="FALSE"?m[u][c]=!1:isNaN(_r(x))?isNaN(ao(x).getDate())?m[u][c]=x:m[u][c]=un(x):m[u][c]=_r(x),++c;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),m[u][c++]=v!==""?v:null;break}if(v==="EOD")break}}return a&&a.sheetRows&&(m=m.slice(0,a.sheetRows)),m}function n(s,a){return Xs(e(s,a),a)}function r(s,a){return Ui(n(s,a),a)}var i=function(){var s=function(u,c,l,m,h){u.push(c),u.push(l+","+m),u.push('"'+h.replace(/"/g,'""')+'"')},a=function(u,c,l,m){u.push(c+","+l),u.push(c==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(u){var c=[],l=ut(u["!ref"]),m,h=Array.isArray(u);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,l.e.r-l.s.r+1,""),s(c,"TUPLES",0,l.e.c-l.s.c+1,""),s(c,"DATA",0,0,"");for(var g=l.s.r;g<=l.e.r;++g){a(c,-1,0,"BOT");for(var x=l.s.c;x<=l.e.c;++x){var v=et({r:g,c:x});if(m=h?(u[g]||[])[x]:u[v],!m){a(c,1,0,"");continue}switch(m.t){case"n":var w=m.w;!w&&m.v!=null&&(w=m.v),w==null?m.f&&!m.F?a(c,1,0,"="+m.f):a(c,1,0,""):a(c,0,w,"V");break;case"b":a(c,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=ai(m.z||vt[14],vn(un(m.v)))),a(c,0,m.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var E=`\r
`,y=c.join(E);return y}}();return{to_workbook:r,to_sheet:n,from_sheet:i}}(),lv=function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(m,h){for(var g=m.split(`
`),x=-1,v=-1,w=0,E=[];w!==g.length;++w){var y=g[w].trim().split(":");if(y[0]==="cell"){var T=Mt(y[1]);if(E.length<=T.r)for(x=E.length;x<=T.r;++x)E[x]||(E[x]=[]);switch(x=T.r,v=T.c,y[2]){case"t":E[x][v]=e(y[3]);break;case"v":E[x][v]=+y[3];break;case"vtf":var C=y[y.length-1];case"vtc":switch(y[3]){case"nl":E[x][v]=!!+y[4];break;default:E[x][v]=+y[4];break}y[2]=="vtf"&&(E[x][v]=[E[x][v],C])}}}return h&&h.sheetRows&&(E=E.slice(0,h.sheetRows)),E}function r(m,h){return Xs(n(m,h),h)}function i(m,h){return Ui(r(m,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function c(m){if(!m||!m["!ref"])return"";for(var h=[],g=[],x,v="",w=Rn(m["!ref"]),E=Array.isArray(m),y=w.s.r;y<=w.e.r;++y)for(var T=w.s.c;T<=w.e.c;++T)if(v=et({r:y,c:T}),x=E?(m[y]||[])[T]:m[v],!(!x||x.v==null||x.t==="z")){switch(g=["cell",v,"t"],x.t){case"s":case"str":g.push(t(x.v));break;case"n":x.f?(g[2]="vtf",g[3]="n",g[4]=x.v,g[5]=t(x.f)):(g[2]="v",g[3]=x.v);break;case"b":g[2]="vt"+(x.f?"f":"c"),g[3]="nl",g[4]=x.v?"1":"0",g[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var C=vn(un(x.v));g[2]="vtc",g[3]="nd",g[4]=""+C,g[5]=x.w||ai(x.z||vt[14],C);break;case"e":continue}h.push(g.join(":"))}return h.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function l(m){return[s,a,o,a,c(m),u].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:l}}(),Uw=function(){function e(l,m,h,g,x){x.raw?m[h][g]=l:l===""||(l==="TRUE"?m[h][g]=!0:l==="FALSE"?m[h][g]=!1:isNaN(_r(l))?isNaN(ao(l).getDate())?m[h][g]=l:m[h][g]=un(l):m[h][g]=_r(l))}function t(l,m){var h=m||{},g=[];if(!l||l.length===0)return g;for(var x=l.split(/[\r\n]/),v=x.length-1;v>=0&&x[v].length===0;)--v;for(var w=10,E=0,y=0;y<=v;++y)E=x[y].indexOf(" "),E==-1?E=x[y].length:E++,w=Math.max(w,E);for(y=0;y<=v;++y){g[y]=[];var T=0;for(e(x[y].slice(0,w).trim(),g,y,T,h),T=1;T<=(x[y].length-w)/10+1;++T)e(x[y].slice(w+(T-1)*10,w+T*10).trim(),g,y,T,h)}return h.sheetRows&&(g=g.slice(0,h.sheetRows)),g}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(l){for(var m={},h=!1,g=0,x=0;g<l.length;++g)(x=l.charCodeAt(g))==34?h=!h:!h&&x in n&&(m[x]=(m[x]||0)+1);x=[];for(g in m)Object.prototype.hasOwnProperty.call(m,g)&&x.push([m[g],g]);if(!x.length){m=r;for(g in m)Object.prototype.hasOwnProperty.call(m,g)&&x.push([m[g],g])}return x.sort(function(v,w){return v[0]-w[0]||r[v[1]]-r[w[1]]}),n[x.pop()[1]]||44}function s(l,m){var h=m||{},g="",x=h.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};l.slice(0,4)=="sep="?l.charCodeAt(5)==13&&l.charCodeAt(6)==10?(g=l.charAt(4),l=l.slice(7)):l.charCodeAt(5)==13||l.charCodeAt(5)==10?(g=l.charAt(4),l=l.slice(6)):g=i(l.slice(0,1024)):h&&h.FS?g=h.FS:g=i(l.slice(0,1024));var w=0,E=0,y=0,T=0,C=0,L=g.charCodeAt(0),B=!1,R=0,O=l.charCodeAt(0);l=l.replace(/\r\n/mg,`
`);var M=h.dateNF!=null?eS(h.dateNF):null;function k(){var z=l.slice(T,C),X={};if(z.charAt(0)=='"'&&z.charAt(z.length-1)=='"'&&(z=z.slice(1,-1).replace(/""/g,'"')),z.length===0)X.t="z";else if(h.raw)X.t="s",X.v=z;else if(z.trim().length===0)X.t="s",X.v=z;else if(z.charCodeAt(0)==61)z.charCodeAt(1)==34&&z.charCodeAt(z.length-1)==34?(X.t="s",X.v=z.slice(2,-1).replace(/""/g,'"')):L_(z)?(X.t="n",X.f=z.slice(1)):(X.t="s",X.v=z);else if(z=="TRUE")X.t="b",X.v=!0;else if(z=="FALSE")X.t="b",X.v=!1;else if(!isNaN(y=_r(z)))X.t="n",h.cellText!==!1&&(X.w=z),X.v=y;else if(!isNaN(ao(z).getDate())||M&&z.match(M)){X.z=h.dateNF||vt[14];var ne=0;M&&z.match(M)&&(z=tS(z,h.dateNF,z.match(M)||[]),ne=1),h.cellDates?(X.t="d",X.v=un(z,ne)):(X.t="n",X.v=vn(un(z,ne))),h.cellText!==!1&&(X.w=ai(X.z,X.v instanceof Date?vn(X.v):X.v)),h.cellNF||delete X.z}else X.t="s",X.v=z;if(X.t=="z"||(h.dense?(x[w]||(x[w]=[]),x[w][E]=X):x[et({c:E,r:w})]=X),T=C+1,O=l.charCodeAt(T),v.e.c<E&&(v.e.c=E),v.e.r<w&&(v.e.r=w),R==L)++E;else if(E=0,++w,h.sheetRows&&h.sheetRows<=w)return!0}e:for(;C<l.length;++C)switch(R=l.charCodeAt(C)){case 34:O===34&&(B=!B);break;case L:case 10:case 13:if(!B&&k())break e;break}return C-T>0&&k(),x["!ref"]=wt(v),x}function a(l,m){return!(m&&m.PRN)||m.FS||l.slice(0,4)=="sep="||l.indexOf("	")>=0||l.indexOf(",")>=0||l.indexOf(";")>=0?s(l,m):Xs(t(l,m),m)}function o(l,m){var h="",g=m.type=="string"?[0,0,0,0]:KI(l,m);switch(m.type){case"base64":h=kr(l);break;case"binary":h=l;break;case"buffer":m.codepage==65001?h=l.toString("utf8"):m.codepage&&typeof zl<"u"||(h=Ye&&Buffer.isBuffer(l)?l.toString("binary"):vo(l));break;case"array":h=Ru(l);break;case"string":h=l;break;default:throw new Error("Unrecognized type "+m.type)}return g[0]==239&&g[1]==187&&g[2]==191?h=Ma(h.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?h=Ma(h):m.type=="binary"&&typeof zl<"u",h.slice(0,19)=="socialcalc:version:"?lv.to_sheet(m.type=="string"?h:Ma(h),m):a(h,m)}function u(l,m){return Ui(o(l,m),m)}function c(l){for(var m=[],h=ut(l["!ref"]),g,x=Array.isArray(l),v=h.s.r;v<=h.e.r;++v){for(var w=[],E=h.s.c;E<=h.e.c;++E){var y=et({r:v,c:E});if(g=x?(l[v]||[])[E]:l[y],!g||g.v==null){w.push("          ");continue}for(var T=(g.w||(br(g),g.w)||"").slice(0,10);T.length<10;)T+=" ";w.push(T+(E===0?" ":""))}m.push(w.join(""))}return m.join(`
`)}return{to_workbook:u,to_sheet:o,from_sheet:c}}(),ph=function(){function e(D,U,G){if(D){wn(D,D.l||0);for(var V=G.Enum||ce;D.l<D.length;){var re=D.read_shift(2),H=V[re]||V[65535],de=D.read_shift(2),Ee=D.l+de,Se=H.f&&H.f(D,de,G);if(D.l=Ee,U(Se,H,re))return}}}function t(D,U){switch(U.type){case"base64":return n(Qn(kr(D)),U);case"binary":return n(Qn(D),U);case"buffer":case"array":return n(D,U)}throw"Unsupported type "+U.type}function n(D,U){if(!D)return D;var G=U||{},V=G.dense?[]:{},re="Sheet1",H="",de=0,Ee={},Se=[],Le=[],Ve={s:{r:0,c:0},e:{r:0,c:0}},yt=G.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)G.Enum=ce,e(D,function(Te,It,Jt){switch(Jt){case 0:G.vers=Te,Te>=4096&&(G.qpro=!0);break;case 6:Ve=Te;break;case 204:Te&&(H=Te);break;case 222:H=Te;break;case 15:case 51:G.qpro||(Te[1].v=Te[1].v.slice(1));case 13:case 14:case 16:Jt==14&&(Te[2]&112)==112&&(Te[2]&15)>1&&(Te[2]&15)<15&&(Te[1].z=G.dateNF||vt[14],G.cellDates&&(Te[1].t="d",Te[1].v=C1(Te[1].v))),G.qpro&&Te[3]>de&&(V["!ref"]=wt(Ve),Ee[re]=V,Se.push(re),V=G.dense?[]:{},Ve={s:{r:0,c:0},e:{r:0,c:0}},de=Te[3],re=H||"Sheet"+(de+1),H="");var En=G.dense?(V[Te[0].r]||[])[Te[0].c]:V[et(Te[0])];if(En){En.t=Te[1].t,En.v=Te[1].v,Te[1].z!=null&&(En.z=Te[1].z),Te[1].f!=null&&(En.f=Te[1].f);break}G.dense?(V[Te[0].r]||(V[Te[0].r]=[]),V[Te[0].r][Te[0].c]=Te[1]):V[et(Te[0])]=Te[1];break}},G);else if(D[2]==26||D[2]==14)G.Enum=Ce,D[2]==14&&(G.qpro=!0,D.l=0),e(D,function(Te,It,Jt){switch(Jt){case 204:re=Te;break;case 22:Te[1].v=Te[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Te[3]>de&&(V["!ref"]=wt(Ve),Ee[re]=V,Se.push(re),V=G.dense?[]:{},Ve={s:{r:0,c:0},e:{r:0,c:0}},de=Te[3],re="Sheet"+(de+1)),yt>0&&Te[0].r>=yt)break;G.dense?(V[Te[0].r]||(V[Te[0].r]=[]),V[Te[0].r][Te[0].c]=Te[1]):V[et(Te[0])]=Te[1],Ve.e.c<Te[0].c&&(Ve.e.c=Te[0].c),Ve.e.r<Te[0].r&&(Ve.e.r=Te[0].r);break;case 27:Te[14e3]&&(Le[Te[14e3][0]]=Te[14e3][1]);break;case 1537:Le[Te[0]]=Te[1],Te[0]==de&&(re=Te[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(V["!ref"]=wt(Ve),Ee[H||re]=V,Se.push(H||re),!Le.length)return{SheetNames:Se,Sheets:Ee};for(var je={},ze=[],qe=0;qe<Le.length;++qe)Ee[Se[qe]]?(ze.push(Le[qe]||Se[qe]),je[Le[qe]]=Ee[Le[qe]]||Ee[Se[qe]]):(ze.push(Le[qe]),je[Le[qe]]={"!ref":"A1"});return{SheetNames:ze,Sheets:je}}function r(D,U){var G=U||{};if(+G.codepage>=0&&io(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var V=xn(),re=ut(D["!ref"]),H=Array.isArray(D),de=[];xe(V,0,s(1030)),xe(V,6,u(re));for(var Ee=Math.min(re.e.r,8191),Se=re.s.r;Se<=Ee;++Se)for(var Le=zt(Se),Ve=re.s.c;Ve<=re.e.c;++Ve){Se===re.s.r&&(de[Ve]=Zt(Ve));var yt=de[Ve]+Le,je=H?(D[Se]||[])[Ve]:D[yt];if(!(!je||je.t=="z"))if(je.t=="n")(je.v|0)==je.v&&je.v>=-32768&&je.v<=32767?xe(V,13,g(Se,Ve,je.v)):xe(V,14,v(Se,Ve,je.v));else{var ze=br(je);xe(V,15,m(Se,Ve,ze.slice(0,239)))}}return xe(V,1),V.end()}function i(D,U){var G=U||{};if(+G.codepage>=0&&io(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var V=xn();xe(V,0,a(D));for(var re=0,H=0;re<D.SheetNames.length;++re)(D.Sheets[D.SheetNames[re]]||{})["!ref"]&&xe(V,27,ae(D.SheetNames[re],H++));var de=0;for(re=0;re<D.SheetNames.length;++re){var Ee=D.Sheets[D.SheetNames[re]];if(!(!Ee||!Ee["!ref"])){for(var Se=ut(Ee["!ref"]),Le=Array.isArray(Ee),Ve=[],yt=Math.min(Se.e.r,8191),je=Se.s.r;je<=yt;++je)for(var ze=zt(je),qe=Se.s.c;qe<=Se.e.c;++qe){je===Se.s.r&&(Ve[qe]=Zt(qe));var Te=Ve[qe]+ze,It=Le?(Ee[je]||[])[qe]:Ee[Te];if(!(!It||It.t=="z"))if(It.t=="n")xe(V,23,k(je,qe,de,It.v));else{var Jt=br(It);xe(V,22,R(je,qe,de,Jt.slice(0,239)))}}++de}}return xe(V,1),V.end()}function s(D){var U=te(2);return U.write_shift(2,D),U}function a(D){var U=te(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var G=0,V=0,re=0,H=0;H<D.SheetNames.length;++H){var de=D.SheetNames[H],Ee=D.Sheets[de];if(!(!Ee||!Ee["!ref"])){++re;var Se=Rn(Ee["!ref"]);G<Se.e.r&&(G=Se.e.r),V<Se.e.c&&(V=Se.e.c)}}return G>8191&&(G=8191),U.write_shift(2,G),U.write_shift(1,re),U.write_shift(1,V),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function o(D,U,G){var V={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&G.qpro?(V.s.c=D.read_shift(1),D.l++,V.s.r=D.read_shift(2),V.e.c=D.read_shift(1),D.l++,V.e.r=D.read_shift(2),V):(V.s.c=D.read_shift(2),V.s.r=D.read_shift(2),U==12&&G.qpro&&(D.l+=2),V.e.c=D.read_shift(2),V.e.r=D.read_shift(2),U==12&&G.qpro&&(D.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function u(D){var U=te(8);return U.write_shift(2,D.s.c),U.write_shift(2,D.s.r),U.write_shift(2,D.e.c),U.write_shift(2,D.e.r),U}function c(D,U,G){var V=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(V[0].c=D.read_shift(1),V[3]=D.read_shift(1),V[0].r=D.read_shift(2),D.l+=2):(V[2]=D.read_shift(1),V[0].c=D.read_shift(2),V[0].r=D.read_shift(2)),V}function l(D,U,G){var V=D.l+U,re=c(D,U,G);if(re[1].t="s",G.vers==20768){D.l++;var H=D.read_shift(1);return re[1].v=D.read_shift(H,"utf8"),re}return G.qpro&&D.l++,re[1].v=D.read_shift(V-D.l,"cstr"),re}function m(D,U,G){var V=te(7+G.length);V.write_shift(1,255),V.write_shift(2,U),V.write_shift(2,D),V.write_shift(1,39);for(var re=0;re<V.length;++re){var H=G.charCodeAt(re);V.write_shift(1,H>=128?95:H)}return V.write_shift(1,0),V}function h(D,U,G){var V=c(D,U,G);return V[1].v=D.read_shift(2,"i"),V}function g(D,U,G){var V=te(7);return V.write_shift(1,255),V.write_shift(2,U),V.write_shift(2,D),V.write_shift(2,G,"i"),V}function x(D,U,G){var V=c(D,U,G);return V[1].v=D.read_shift(8,"f"),V}function v(D,U,G){var V=te(13);return V.write_shift(1,255),V.write_shift(2,U),V.write_shift(2,D),V.write_shift(8,G,"f"),V}function w(D,U,G){var V=D.l+U,re=c(D,U,G);if(re[1].v=D.read_shift(8,"f"),G.qpro)D.l=V;else{var H=D.read_shift(2);C(D.slice(D.l,D.l+H),re),D.l+=H}return re}function E(D,U,G){var V=U&32768;return U&=-32769,U=(V?D:0)+(U>=8192?U-16384:U),(V?"":"$")+(G?Zt(U):zt(U))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(D,U){wn(D,0);for(var G=[],V=0,re="",H="",de="",Ee="";D.l<D.length;){var Se=D[D.l++];switch(Se){case 0:G.push(D.read_shift(8,"f"));break;case 1:H=E(U[0].c,D.read_shift(2),!0),re=E(U[0].r,D.read_shift(2),!1),G.push(H+re);break;case 2:{var Le=E(U[0].c,D.read_shift(2),!0),Ve=E(U[0].r,D.read_shift(2),!1);H=E(U[0].c,D.read_shift(2),!0),re=E(U[0].r,D.read_shift(2),!1),G.push(Le+Ve+":"+H+re)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(D.read_shift(2));break;case 6:{for(var yt="";Se=D[D.l++];)yt+=String.fromCharCode(Se);G.push('"'+yt.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:Ee=G.pop(),de=G.pop(),G.push(["AND","OR"][Se-20]+"("+de+","+Ee+")");break;default:if(Se<32&&T[Se])Ee=G.pop(),de=G.pop(),G.push(de+T[Se]+Ee);else if(y[Se]){if(V=y[Se][1],V==69&&(V=D[D.l++]),V>G.length){console.error("WK1 bad formula parse 0x"+Se.toString(16)+":|"+G.join("|")+"|");return}var je=G.slice(-V);G.length-=V,G.push(y[Se][0]+"("+je.join(",")+")")}else return Se<=7?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=24?console.error("WK1 unsupported op "+Se.toString(16)):Se<=30?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=115?console.error("WK1 unsupported function opcode "+Se.toString(16)):console.error("WK1 unrecognized opcode "+Se.toString(16))}}G.length==1?U[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function L(D){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=D.read_shift(2),U[3]=D[D.l++],U[0].c=D[D.l++],U}function B(D,U){var G=L(D);return G[1].t="s",G[1].v=D.read_shift(U-4,"cstr"),G}function R(D,U,G,V){var re=te(6+V.length);re.write_shift(2,D),re.write_shift(1,G),re.write_shift(1,U),re.write_shift(1,39);for(var H=0;H<V.length;++H){var de=V.charCodeAt(H);re.write_shift(1,de>=128?95:de)}return re.write_shift(1,0),re}function O(D,U){var G=L(D);G[1].v=D.read_shift(2);var V=G[1].v>>1;if(G[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return G[1].v=V,G}function M(D,U){var G=L(D),V=D.read_shift(4),re=D.read_shift(4),H=D.read_shift(2);if(H==65535)return V===0&&re===3221225472?(G[1].t="e",G[1].v=15):V===0&&re===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var de=H&32768;return H=(H&32767)-16446,G[1].v=(1-de*2)*(re*Math.pow(2,H+32)+V*Math.pow(2,H)),G}function k(D,U,G,V){var re=te(14);if(re.write_shift(2,D),re.write_shift(1,G),re.write_shift(1,U),V==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var H=0,de=0,Ee=0,Se=0;return V<0&&(H=1,V=-V),de=Math.log2(V)|0,V/=Math.pow(2,de-31),Se=V>>>0,Se&2147483648||(V/=2,++de,Se=V>>>0),V-=Se,Se|=2147483648,Se>>>=0,V*=Math.pow(2,32),Ee=V>>>0,re.write_shift(4,Ee),re.write_shift(4,Se),de+=16383+(H?32768:0),re.write_shift(2,de),re}function z(D,U){var G=M(D);return D.l+=U-14,G}function X(D,U){var G=L(D),V=D.read_shift(4);return G[1].v=V>>6,G}function ne(D,U){var G=L(D),V=D.read_shift(8,"f");return G[1].v=V,G}function Fe(D,U){var G=ne(D);return D.l+=U-10,G}function q(D,U){return D[D.l+U-1]==0?D.read_shift(U,"cstr"):""}function ue(D,U){var G=D[D.l++];G>U-1&&(G=U-1);for(var V="";V.length<G;)V+=String.fromCharCode(D[D.l++]);return V}function ke(D,U,G){if(!(!G.qpro||U<21)){var V=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var re=D.read_shift(U-21,"cstr");return[V,re]}}function se(D,U){for(var G={},V=D.l+U;D.l<V;){var re=D.read_shift(2);if(re==14e3){for(G[re]=[0,""],G[re][0]=D.read_shift(2);D[D.l];)G[re][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return G}function ae(D,U){var G=te(5+D.length);G.write_shift(2,14e3),G.write_shift(2,U);for(var V=0;V<D.length;++V){var re=D.charCodeAt(V);G[G.l++]=re>127?95:re}return G[G.l++]=0,G}var ce={0:{n:"BOF",f:rv},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:l},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:l},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:ue},65535:{n:""}},Ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:z},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:X},38:{n:"??"},39:{n:"NUMBER27",f:ne},40:{n:"FORMULA28",f:Fe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ke},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:t}}(),Bw=/^\s|\s$|[\t\n\r]/;function uv(e,t){if(!t.bookSST)return"";var n=[_t];n[n.length]=ge("sst",null,{xmlns:Ks[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var i=e[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(Bw)&&(s+=' xml:space="preserve"'),s+=">"+Qe(i.t)+"</t>"),s+="</si>",n[n.length]=s}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function Gw(e){return[e.read_shift(4),e.read_shift(4)]}function $w(e,t){return t||(t=te(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Vw=FS;function jw(e){var t=xn();le(t,159,$w(e));for(var n=0;n<e.length;++n)le(t,19,Vw(e[n]));return le(t,160),t.end()}function Hw(e){for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function cv(e){var t=0,n,r=Hw(e),i=r.length+1,s,a,o,u,c;for(n=Pi(i),n[0]=r.length,s=1;s!=i;++s)n[s]=r[s-1];for(s=i-1;s>=0;--s)a=n[s],o=t&16384?1:0,u=t<<1&32767,c=o|u,t=c^a;return t^52811}var zw=function(){function e(i,s){switch(s.type){case"base64":return t(kr(i),s);case"binary":return t(i,s);case"buffer":return t(Ye&&Buffer.isBuffer(i)?i.toString("binary"):vo(i),s);case"array":return t(Ru(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(l,m){Array.isArray(o)&&(o[m]=[]);for(var h=/\\\w+\b/g,g=0,x,v=-1;x=h.exec(l);){switch(x[0]){case"\\cell":var w=l.slice(g,h.lastIndex-x[0].length);if(w[0]==" "&&(w=w.slice(1)),++v,w.length){var E={v:w,t:"s"};Array.isArray(o)?o[m][v]=E:o[et({r:m,c:v})]=E}break}g=h.lastIndex}v>c.e.c&&(c.e.c=v)}),o["!ref"]=wt(c),o}function n(i,s){return Ui(e(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],a=ut(i["!ref"]),o,u=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var l=a.s.c;l<=a.e.c;++l)s.push("\\cellx"+(l+1));for(s.push("\\pard\\intbl"),l=a.s.c;l<=a.e.c;++l){var m=et({r:c,c:l});o=u?(i[c]||[])[l]:i[m],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(br(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:r}}();function hh(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}var qw=6,Cr=qw;function eu(e){return Math.floor((e+Math.round(128/Cr)/256)*Cr)}function tu(e){return Math.floor((e-5)/Cr*100+.5)/100}function _d(e){return Math.round((e*Cr+5)/Cr*256)/256}function zf(e){e.width?(e.wpx=eu(e.width),e.wch=tu(e.wpx),e.MDW=Cr):e.wpx?(e.wch=tu(e.wpx),e.width=_d(e.wch),e.MDW=Cr):typeof e.wch=="number"&&(e.width=_d(e.wch),e.wpx=eu(e.width),e.MDW=Cr),e.customWidth&&delete e.customWidth}var Ww=96,dv=Ww;function nu(e){return e*96/dv}function fv(e){return e*dv/96}function Jw(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)e[r]!=null&&(t[t.length]=ge("numFmt",null,{numFmtId:r,formatCode:Qe(e[r])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ge("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Yw(e){var t=[];return t[t.length]=ge("cellXfs",null),e.forEach(function(n){t[t.length]=ge("xf",null,n)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ge("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function pv(e,t){var n=[_t,ge("styleSheet",null,{xmlns:Ks[0],"xmlns:vt":Pt.vt})],r;return e.SSF&&(r=Jw(e.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=Yw(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Kw(e,t){var n=e.read_shift(2),r=en(e);return[n,r]}function Xw(e,t,n){n||(n=te(6+4*t.length)),n.write_shift(2,e),Dt(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function Qw(e,t,n){var r={};r.sz=e.read_shift(2)/20;var i=BS(e);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=e.read_shift(2);switch(s===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(r.underline=a);var o=e.read_shift(1);o>0&&(r.family=o);var u=e.read_shift(1);switch(u>0&&(r.charset=u),e.l++,r.color=US(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=en(e),r}function Zw(e,t){t||(t=te(25+4*32)),t.write_shift(2,e.sz*20),GS(e,t),t.write_shift(2,e.bold?700:400);var n=0;e.vertAlign=="superscript"?n=1:e.vertAlign=="subscript"&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Ql(e.color,t);var r=0;return r=2,t.write_shift(1,r),Dt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var e_=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],vc,t_=hr;function mh(e,t){t||(t=te(4*3+8*7+16*1)),vc||(vc=Pf(e_));var n=vc[e.patternType];n==null&&(n=40),t.write_shift(4,n);var r=0;if(n!=40)for(Ql({auto:1},t),Ql({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function n_(e,t){var n=e.l+t,r=e.read_shift(2),i=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:i}}function hv(e,t,n){n||(n=te(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function xa(e,t){return t||(t=te(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var r_=hr;function i_(e,t){return t||(t=te(51)),t.write_shift(1,0),xa(null,t),xa(null,t),xa(null,t),xa(null,t),xa(null,t),t.length>t.l?t.slice(0,t.l):t}function s_(e,t){return t||(t=te(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Xl(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function a_(e,t,n){var r=te(2052);return r.write_shift(4,e),Xl(t,r),Xl(n,r),r.length>r.l?r.slice(0,r.l):r}function o_(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&++n}),n!=0&&(le(e,615,nr(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&le(e,44,Xw(i,t[i]))}),le(e,616))}}function l_(e){var t=1;le(e,611,nr(t)),le(e,43,Zw({sz:12,color:{theme:1},name:"Calibri",family:2})),le(e,612)}function u_(e){var t=2;le(e,603,nr(t)),le(e,45,mh({patternType:"none"})),le(e,45,mh({patternType:"gray125"})),le(e,604)}function c_(e){var t=1;le(e,613,nr(t)),le(e,46,i_()),le(e,614)}function d_(e){var t=1;le(e,626,nr(t)),le(e,47,hv({numFmtId:0},65535)),le(e,627)}function f_(e,t){le(e,617,nr(t.length)),t.forEach(function(n){le(e,47,hv(n,0))}),le(e,618)}function p_(e){var t=1;le(e,619,nr(t)),le(e,48,s_({xfId:0,name:"Normal"})),le(e,620)}function h_(e){var t=0;le(e,505,nr(t)),le(e,506)}function m_(e){var t=0;le(e,508,a_(t,"TableStyleMedium9","PivotStyleMedium4")),le(e,509)}function g_(e,t){var n=xn();return le(n,278),o_(n,e.SSF),l_(n),u_(n),c_(n),d_(n),f_(n,t.cellXfs),p_(n),h_(n),m_(n),le(n,279),n.end()}function mv(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var n=[_t];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function x_(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:en(e)}}function v_(e){var t=te(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Dt(e.name,t),t.slice(0,t.l)}function y_(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function E_(e){var t=te(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}function T_(e,t){var n=te(8+2*t.length);return n.write_shift(4,e),Dt(t,n),n.slice(0,n.l)}function S_(e){return e.l+=4,e.read_shift(4)!=0}function w_(e,t){var n=te(8);return n.write_shift(4,e),n.write_shift(4,1),n}function __(){var e=xn();return le(e,332),le(e,334,nr(1)),le(e,335,v_({name:"XLDAPR",version:12e4,flags:3496657072})),le(e,336),le(e,339,T_(1,"XLDAPR")),le(e,52),le(e,35,nr(514)),le(e,4096,nr(0)),le(e,4097,Ln(1)),le(e,36),le(e,53),le(e,340),le(e,337,w_(1)),le(e,51,E_([[1,0]])),le(e,338),le(e,333),e.end()}function gv(){var e=[_t];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function C_(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=et(n);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}var Ss=1024;function xv(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[ge("xml",null,{"xmlns:v":_n.v,"xmlns:o":_n.o,"xmlns:x":_n.x,"xmlns:mv":_n.mv}).replace(/\/>/,">"),ge("o:shapelayout",ge("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ge("v:shapetype",[ge("v:stroke",null,{joinstyle:"miter"}),ge("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Ss<e*1e3;)Ss+=1e3;return t.forEach(function(s){var a=Mt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var u=o.type=="gradient"?ge("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=ge("v:fill",u,o),l={on:"t",obscured:"t"};++Ss,i=i.concat(["<v:shape"+lo({id:"_x0000_s"+Ss,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,ge("v:shadow",null,l),ge("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",jt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),jt("x:AutoFill","False"),jt("x:Row",String(a.r)),jt("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function vv(e){var t=[_t,ge("comments",null,{xmlns:Ks[0]})],n=[];return t.push("<authors>"),e.forEach(function(r){r[1].forEach(function(i){var s=Qe(i.a);n.indexOf(s)==-1&&(n.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&n.indexOf("tc="+i.ID)==-1&&(n.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(u){u.a&&(i=n.indexOf(Qe(u.a))),s.push(u.t||"")}),t.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(jt("t",Qe(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(jt("t",Qe(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function N_(e,t,n){var r=[_t,ge("ThreadedComments",null,{xmlns:Pt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var u={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};o==0?s=u.id:u.parentId=s,a.ID=u.id,a.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),r.push(ge("threadedComment",jt("text",a.t||""),u))})}),r.push("</ThreadedComments>"),r.join("")}function A_(e){var t=[_t,ge("personList",null,{xmlns:Pt.TCMNT,"xmlns:x":Ks[0]}).replace(/[\/]>/,">")];return e.forEach(function(n,r){t.push(ge("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),t.push("</personList>"),t.join("")}function I_(e){var t={};t.iauthor=e.read_shift(4);var n=Vi(e);return t.rfx=n.s,t.ref=et(n.s),e.l+=16,t}function R_(e,t){return t==null&&(t=te(36)),t.write_shift(4,e[1].iauthor),Qs(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var k_=en;function b_(e){return Dt(e.slice(0,54))}function F_(e){var t=xn(),n=[];return le(t,628),le(t,630),e.forEach(function(r){r[1].forEach(function(i){n.indexOf(i.a)>-1||(n.push(i.a.slice(0,54)),le(t,632,b_(i.a)))})}),le(t,631),le(t,633),e.forEach(function(r){r[1].forEach(function(i){i.iauthor=n.indexOf(i.a);var s={s:Mt(r[0]),e:Mt(r[0])};le(t,635,R_([s,i])),i.t&&i.t.length>0&&le(t,637,MS(i)),le(t,636),delete i.iauthor})}),le(t,634),le(t,629),t.end()}function P_(e,t){t.FullPaths.forEach(function(n,r){if(r!=0){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&tt.utils.cfb_add(e,i,t.FileIndex[r].content)}})}var yv=["xlsb","xlsm","xlam","biff8","xla"],M_=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(r,i,s,a){var o=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,l=a.length>0?parseInt(a,10)|0:0;return o?l+=t.c:--l,u?c+=t.r:--c,i+(o?"":"$")+Zt(l)+(u?"":"$")+zt(c)}return function(i,s){return t=s,i.replace(e,n)}}(),qf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Wf=function(){return function(t,n){return t.replace(qf,function(r,i,s,a,o,u){var c=Gf(a)-(s?0:n.c),l=Bf(u)-(o?0:n.r),m=l==0?"":o?l+1:"["+l+"]",h=c==0?"":s?c+1:"["+c+"]";return i+"R"+m+"C"+h})}}();function D_(e,t){return e.replace(qf,function(n,r,i,s,a,o){return r+(i=="$"?i+s:Zt(Gf(s)+t.c))+(a=="$"?a+o:zt(Bf(o)+t.r))})}function L_(e){return e.length!=1}function Tt(e){e.l+=1}function oi(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function Ev(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return Tv(e);n.biff==12&&(r=4)}var i=e.read_shift(r),s=e.read_shift(r),a=oi(e),o=oi(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Tv(e){var t=oi(e),n=oi(e),r=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function O_(e,t,n){if(n.biff<8)return Tv(e);var r=e.read_shift(n.biff==12?4:2),i=e.read_shift(n.biff==12?4:2),s=oi(e),a=oi(e);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function Sv(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return U_(e);var r=e.read_shift(n&&n.biff==12?4:2),i=oi(e);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function U_(e){var t=oi(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function B_(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function G_(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return $_(e);var i=e.read_shift(r>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function $_(e){var t=e.read_shift(2),n=e.read_shift(1),r=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),i==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:i,rRel:r}}function V_(e,t,n){var r=(e[e.l++]&96)>>5,i=Ev(e,n.biff>=2&&n.biff<=5?6:8,n);return[r,i]}function j_(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=Ev(e,s,n);return[r,i,a]}function H_(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function z_(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[r,i]}function q_(e,t,n){var r=(e[e.l++]&96)>>5,i=O_(e,t-1,n);return[r,i]}function W_(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[r]}function gh(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function J_(e,t,n){e.l+=2;for(var r=e.read_shift(n&&n.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(e.read_shift(n&&n.biff==2?1:2));return i}function Y_(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function K_(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function X_(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Q_(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[r]}function wv(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function Z_(e){return e.read_shift(2),wv(e)}function eC(e){return e.read_shift(2),wv(e)}function tC(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=Sv(e,0,n);return[r,i]}function nC(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=G_(e,0,n);return[r,i]}function rC(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var s=Sv(e,0,n);return[r,i,s]}function iC(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(n&&n.biff<=3?1:2);return[iN[i],Nv[i],r]}function sC(e,t,n){var r=e[e.l++],i=e.read_shift(1),s=n&&n.biff<=3?[r==88?-1:0,e.read_shift(1)]:aC(e);return[i,(s[0]===0?Nv:rN)[s[1]]]}function aC(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function oC(e,t,n){e.l+=n&&n.biff==2?3:4}function lC(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function uC(e){return e.l++,To[e.read_shift(1)]}function cC(e){return e.l++,e.read_shift(2)}function dC(e){return e.l++,e.read_shift(1)!==0}function fC(e){return e.l++,Zs(e)}function pC(e,t,n){return e.l++,sv(e,t-1,n)}function hC(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=rw(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=To[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=Zs(e);break;case 2:n[1]=ow(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function mC(e,t,n){for(var r=e.read_shift(n.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((n.biff==12?Vi:cw)(e));return i}function gC(e,t,n){var r=0,i=0;n.biff==12?(r=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--i==0&&(i=256));for(var s=0,a=[];s!=r&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=hC(e,n.biff);return a}function xC(e,t,n){var r=e.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,s=e.read_shift(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,s]}function vC(e,t,n){if(n.biff==5)return yC(e);var r=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[r,i,s]}function yC(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}function EC(e,t,n){var r=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function TC(e,t,n){var r=e.read_shift(1)>>>5&3,i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function SC(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[r]}function wC(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[r,i]}var _C=hr,CC=hr,NC=hr;function So(e,t,n){return e.l+=2,[B_(e)]}function Jf(e){return e.l+=6,[]}var AC=So,IC=Jf,RC=Jf,kC=So;function _v(e){return e.l+=2,[rv(e),e.read_shift(2)&1]}var bC=So,FC=_v,PC=Jf,MC=So,DC=So,LC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function OC(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=LC[n>>2&31];return{ixti:t,coltype:n&3,rt:a,idx:r,c:i,C:s}}function UC(e){return e.l+=2,[e.read_shift(4)]}function BC(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function GC(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function $C(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function VC(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function jC(e){return e.l+=4,[0,0]}var xh={1:{n:"PtgExp",f:lC},2:{n:"PtgTbl",f:NC},3:{n:"PtgAdd",f:Tt},4:{n:"PtgSub",f:Tt},5:{n:"PtgMul",f:Tt},6:{n:"PtgDiv",f:Tt},7:{n:"PtgPower",f:Tt},8:{n:"PtgConcat",f:Tt},9:{n:"PtgLt",f:Tt},10:{n:"PtgLe",f:Tt},11:{n:"PtgEq",f:Tt},12:{n:"PtgGe",f:Tt},13:{n:"PtgGt",f:Tt},14:{n:"PtgNe",f:Tt},15:{n:"PtgIsect",f:Tt},16:{n:"PtgUnion",f:Tt},17:{n:"PtgRange",f:Tt},18:{n:"PtgUplus",f:Tt},19:{n:"PtgUminus",f:Tt},20:{n:"PtgPercent",f:Tt},21:{n:"PtgParen",f:Tt},22:{n:"PtgMissArg",f:Tt},23:{n:"PtgStr",f:pC},26:{n:"PtgSheet",f:BC},27:{n:"PtgEndSheet",f:GC},28:{n:"PtgErr",f:uC},29:{n:"PtgBool",f:dC},30:{n:"PtgInt",f:cC},31:{n:"PtgNum",f:fC},32:{n:"PtgArray",f:W_},33:{n:"PtgFunc",f:iC},34:{n:"PtgFuncVar",f:sC},35:{n:"PtgName",f:xC},36:{n:"PtgRef",f:tC},37:{n:"PtgArea",f:V_},38:{n:"PtgMemArea",f:EC},39:{n:"PtgMemErr",f:_C},40:{n:"PtgMemNoMem",f:CC},41:{n:"PtgMemFunc",f:TC},42:{n:"PtgRefErr",f:SC},43:{n:"PtgAreaErr",f:H_},44:{n:"PtgRefN",f:nC},45:{n:"PtgAreaN",f:q_},46:{n:"PtgMemAreaN",f:$C},47:{n:"PtgMemNoMemN",f:VC},57:{n:"PtgNameX",f:vC},58:{n:"PtgRef3d",f:rC},59:{n:"PtgArea3d",f:j_},60:{n:"PtgRefErr3d",f:wC},61:{n:"PtgAreaErr3d",f:z_},255:{}},HC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},zC={1:{n:"PtgElfLel",f:_v},2:{n:"PtgElfRw",f:MC},3:{n:"PtgElfCol",f:AC},6:{n:"PtgElfRwV",f:DC},7:{n:"PtgElfColV",f:kC},10:{n:"PtgElfRadical",f:bC},11:{n:"PtgElfRadicalS",f:PC},13:{n:"PtgElfColS",f:IC},15:{n:"PtgElfColSV",f:RC},16:{n:"PtgElfRadicalLel",f:FC},25:{n:"PtgList",f:OC},29:{n:"PtgSxName",f:UC},255:{}},qC={0:{n:"PtgAttrNoop",f:jC},1:{n:"PtgAttrSemi",f:Q_},2:{n:"PtgAttrIf",f:K_},4:{n:"PtgAttrChoose",f:J_},8:{n:"PtgAttrGoto",f:Y_},16:{n:"PtgAttrSum",f:oC},32:{n:"PtgAttrBaxcel",f:gh},33:{n:"PtgAttrBaxcel",f:gh},64:{n:"PtgAttrSpace",f:Z_},65:{n:"PtgAttrSpaceSemi",f:eC},128:{n:"PtgAttrIfError",f:X_},255:{}};function WC(e,t,n,r){if(r.biff<8)return hr(e,t);for(var i=e.l+t,s=[],a=0;a!==n.length;++a)switch(n[a][0]){case"PtgArray":n[a][1]=gC(e,0,r),s.push(n[a][1]);break;case"PtgMemArea":n[a][2]=mC(e,n[a][1],r),s.push(n[a][2]);break;case"PtgExp":r&&r.biff==12&&(n[a][1][1]=e.read_shift(4),s.push(n[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[a][0]}return t=i-e.l,t!==0&&s.push(hr(e,t)),s}function JC(e,t,n){for(var r=e.l+t,i,s,a=[];r!=e.l;)t=r-e.l,s=e[e.l],i=xh[s]||xh[HC[s]],(s===24||s===25)&&(i=(s===24?zC:qC)[e[e.l+1]]),!i||!i.f?hr(e,t):a.push([i.n,i.f(e,t,n)]);return a}function YC(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],i=[],s=0;s<r.length;++s){var a=r[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var KC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function XC(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Cv(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(e[r[0]][0]){case 357:return i=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[r[0]][0][3]?(i=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function vh(e,t,n){var r=Cv(e,t,n);return r=="#REF"?r:XC(r,n)}function qs(e,t,n,r,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],u,c,l,m=0,h=0,g,x="";if(!e[0]||!e[0][0])return"";for(var v=-1,w="",E=0,y=e[0].length;E<y;++E){var T=e[0][E];switch(T[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=o.pop(),c=o.pop(),v>=0){switch(e[0][v][1][0]){case 0:w=xt(" ",e[0][v][1][1]);break;case 1:w=xt("\r",e[0][v][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}c=c+w,v=-1}o.push(c+KC[T[0]]+u);break;case"PtgIsect":u=o.pop(),c=o.pop(),o.push(c+" "+u);break;case"PtgUnion":u=o.pop(),c=o.pop(),o.push(c+","+u);break;case"PtgRange":u=o.pop(),c=o.pop(),o.push(c+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":l=La(T[1][1],a,i),o.push(Oa(l,s));break;case"PtgRefN":l=n?La(T[1][1],n,i):T[1][1],o.push(Oa(l,s));break;case"PtgRef3d":m=T[1][1],l=La(T[1][2],a,i),x=vh(r,m,i),o.push(x+"!"+Oa(l,s));break;case"PtgFunc":case"PtgFuncVar":var C=T[1][0],L=T[1][1];C||(C=0),C&=127;var B=C==0?[]:o.slice(-C);o.length-=C,L==="User"&&(L=B.shift()),o.push(L+"("+B.join(",")+")");break;case"PtgBool":o.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(T[1]);break;case"PtgNum":o.push(String(T[1]));break;case"PtgStr":o.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(T[1]);break;case"PtgAreaN":g=nh(T[1][1],n?{s:n}:a,i),o.push(gc(g,i));break;case"PtgArea":g=nh(T[1][1],a,i),o.push(gc(g,i));break;case"PtgArea3d":m=T[1][1],g=T[1][2],x=vh(r,m,i),o.push(x+"!"+gc(g,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=T[1][2];var R=(r.names||[])[h-1]||(r[0]||[])[h],O=R?R.Name:"SH33TJSNAME"+String(h);O&&O.slice(0,6)=="_xlfn."&&!i.xlfn&&(O=O.slice(6)),o.push(O);break;case"PtgNameX":var M=T[1][1];h=T[1][2];var k;if(i.biff<=5)M<0&&(M=-M),r[M]&&(k=r[M][h]);else{var z="";if(((r[M]||[])[0]||[])[0]==14849||(((r[M]||[])[0]||[])[0]==1025?r[M][h]&&r[M][h].itab>0&&(z=r.SheetNames[r[M][h].itab-1]+"!"):z=r.SheetNames[h-1]+"!"),r[M]&&r[M][h])z+=r[M][h].Name;else if(r[0]&&r[0][h])z+=r[0][h].Name;else{var X=(Cv(r,M,i)||"").split(";;");X[h-1]?z=X[h-1]:z+="SH33TJSERRX"}o.push(z);break}k||(k={Name:"SH33TJSERRY"}),o.push(k.Name);break;case"PtgParen":var ne="(",Fe=")";if(v>=0){switch(w="",e[0][v][1][0]){case 2:ne=xt(" ",e[0][v][1][1])+ne;break;case 3:ne=xt("\r",e[0][v][1][1])+ne;break;case 4:Fe=xt(" ",e[0][v][1][1])+Fe;break;case 5:Fe=xt("\r",e[0][v][1][1])+Fe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}o.push(ne+o.pop()+Fe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":l={c:T[1][1],r:T[1][0]};var q={c:n.c,r:n.r};if(r.sharedf[et(l)]){var ue=r.sharedf[et(l)];o.push(qs(ue,a,q,r,i))}else{var ke=!1;for(u=0;u!=r.arrayf.length;++u)if(c=r.arrayf[u],!(l.c<c[0].s.c||l.c>c[0].e.c)&&!(l.r<c[0].s.r||l.r>c[0].e.r)){o.push(qs(c[1],a,q,r,i)),ke=!0;break}ke||o.push(T[1])}break;case"PtgArray":o.push("{"+YC(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&v>=0&&se.indexOf(e[0][E][0])==-1){T=e[0][v];var ae=!0;switch(T[1][0]){case 4:ae=!1;case 0:w=xt(" ",T[1][1]);break;case 5:ae=!1;case 1:w=xt("\r",T[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}o.push((ae?w:"")+o.pop()+(ae?"":w)),v=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function QC(e){if(e==null){var t=te(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Mi(e);return Mi(0)}function ZC(e,t,n,r,i){var s=Di(t,n,i),a=QC(e.v),o=te(6),u=33;o.write_shift(2,u),o.write_shift(4,0);for(var c=te(e.bf.length),l=0;l<e.bf.length;++l)c[l]=e.bf[l];var m=Vt([s,a,o,c]);return m}function ku(e,t,n){var r=e.read_shift(4),i=JC(e,r,n),s=e.read_shift(4),a=s>0?WC(e,s,i,n):null;return[i,a]}var eN=ku,bu=ku,tN=ku,nN=ku,rN={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Nv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},iN={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function sN(e){var t="of:="+e.replace(qf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function aN(e){return e.replace(/\./,"!")}var Ua=typeof Map<"u";function Yf(e,t,n){var r=0,i=e.length;if(n){if(Ua?n.has(t):Object.prototype.hasOwnProperty.call(n,t)){for(var s=Ua?n.get(t):n[t];r<s.length;++r)if(e[s[r]].t===t)return e.Count++,s[r]}}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t},e.Count++,e.Unique++,n&&(Ua?(n.has(t)||n.set(t,[]),n.get(t).push(i)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(i))),i}function Fu(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(Cr=t.MDW),t.width!=null?n.customWidth=1:t.wpx!=null?r=tu(t.wpx):t.wch!=null&&(r=t.wch),r>-1?(n.width=_d(r),n.customWidth=1):t.width!=null&&(n.width=t.width),t.hidden&&(n.hidden=!0),t.level!=null&&(n.outlineLevel=n.level=t.level),n}function Av(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function fi(e,t,n){var r=n.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(r==null&&n.ssf){for(;i<392;++i)if(n.ssf[i]==null){S1(t.z,i),n.ssf[i]=t.z,n.revssf[t.z]=r=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===r)return i;return e[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function oN(e,t,n){if(e&&e["!ref"]){var r=ut(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}function lN(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+wt(e[n])+'"/>';return t+"</mergeCells>"}function uN(e,t,n,r,i){var s=!1,a={},o=null;if(r.bookType!=="xlsx"&&t.vbaraw){var u=t.SheetNames[n];try{t.Workbook&&(u=t.Workbook.Sheets[n].CodeName||u)}catch{}s=!0,a.codeName=oo(Qe(u))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+ge("outlinePr",null,c)}!s&&!o||(i[i.length]=ge("sheetPr",o,a))}var cN=["objects","scenarios","selectLockedCells","selectUnlockedCells"],dN=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function fN(e){var t={sheet:1};return cN.forEach(function(n){e[n]!=null&&e[n]&&(t[n]="1")}),dN.forEach(function(n){e[n]!=null&&!e[n]&&(t[n]="0")}),e.password&&(t.password=cv(e.password).toString(16).toUpperCase()),ge("sheetProtection",null,t)}function pN(e){return Av(e),ge("pageMargins",null,e)}function hN(e,t){for(var n=["<cols>"],r,i=0;i!=t.length;++i)(r=t[i])&&(n[n.length]=ge("col",null,Fu(i,r)));return n[n.length]="</cols>",n.join("")}function mN(e,t,n,r){var i=typeof e.ref=="string"?e.ref:wt(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,a=Rn(i);a.s.r==a.e.r&&(a.e.r=Rn(t["!ref"]).e.r,i=wt(a));for(var o=0;o<s.length;++o){var u=s[o];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),ge("autoFilter",null,{ref:i})}function gN(e,t,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),ge("sheetViews",ge("sheetView",null,i),{})}function xN(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=To[e.v];break;case"d":r&&r.cellDates?i=un(e.v,-1).toISOString():(e=yn(e),e.t="n",i=""+(e.v=vn(un(e.v)))),typeof e.z>"u"&&(e.z=vt[14]);break;default:i=e.v;break}var o=jt("v",Qe(i)),u={r:t},c=fi(r.cellXfs,e,r);switch(c!==0&&(u.s=c),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=jt("v",""+Yf(r.Strings,e.v,r.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=s&&(e.t=s,e.v=a),typeof e.f=="string"&&e.f){var l=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=ge("f",Qe(e.f),l)+(e.v!=null?o:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(u.cm=1),ge("c",o,u)}function vN(e,t,n,r){var i=[],s=[],a=ut(e["!ref"]),o="",u,c="",l=[],m=0,h=0,g=e["!rows"],x=Array.isArray(e),v={r:c},w,E=-1;for(h=a.s.c;h<=a.e.c;++h)l[h]=Zt(h);for(m=a.s.r;m<=a.e.r;++m){for(s=[],c=zt(m),h=a.s.c;h<=a.e.c;++h){u=l[h]+c;var y=x?(e[m]||[])[h]:e[u];y!==void 0&&(o=xN(y,u,e,t))!=null&&s.push(o)}(s.length>0||g&&g[m])&&(v={r:c},g&&g[m]&&(w=g[m],w.hidden&&(v.hidden=1),E=-1,w.hpx?E=nu(w.hpx):w.hpt&&(E=w.hpt),E>-1&&(v.ht=E,v.customHeight=1),w.level&&(v.outlineLevel=w.level)),i[i.length]=ge("row",s.join(""),v))}if(g)for(;m<g.length;++m)g&&g[m]&&(v={r:m+1},w=g[m],w.hidden&&(v.hidden=1),E=-1,w.hpx?E=nu(w.hpx):w.hpt&&(E=w.hpt),E>-1&&(v.ht=E,v.customHeight=1),w.level&&(v.outlineLevel=w.level),i[i.length]=ge("row","",v));return i.join("")}function Iv(e,t,n,r){var i=[_t,ge("worksheet",null,{xmlns:Ks[0],"xmlns:r":Pt.r})],s=n.SheetNames[e],a=0,o="",u=n.Sheets[s];u==null&&(u={});var c=u["!ref"]||"A1",l=ut(c);if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575),c=wt(l)}r||(r={}),u["!comments"]=[];var m=[];uN(u,n,e,t,i),i[i.length]=ge("dimension",null,{ref:c}),i[i.length]=gN(u,t,e,n),t.sheetFormat&&(i[i.length]=ge("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(i[i.length]=hN(u,u["!cols"])),i[a=i.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(o=vN(u,t),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),u["!protect"]&&(i[i.length]=fN(u["!protect"])),u["!autofilter"]!=null&&(i[i.length]=mN(u["!autofilter"],u,n,e)),u["!merges"]!=null&&u["!merges"].length>0&&(i[i.length]=lN(u["!merges"]));var h=-1,g,x=-1;return u["!links"].length>0&&(i[i.length]="<hyperlinks>",u["!links"].forEach(function(v){v[1].Target&&(g={ref:v[0]},v[1].Target.charAt(0)!="#"&&(x=Xe(r,-1,Qe(v[1].Target).replace(/#.*$/,""),We.HLINK),g["r:id"]="rId"+x),(h=v[1].Target.indexOf("#"))>-1&&(g.location=Qe(v[1].Target.slice(h+1))),v[1].Tooltip&&(g.tooltip=Qe(v[1].Tooltip)),i[i.length]=ge("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(i[i.length]=pN(u["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=jt("ignoredErrors",ge("ignoredError",null,{numberStoredAsText:1,sqref:c}))),m.length>0&&(x=Xe(r,-1,"../drawings/drawing"+(e+1)+".xml",We.DRAW),i[i.length]=ge("drawing",null,{"r:id":"rId"+x}),u["!drawing"]=m),u["!comments"].length>0&&(x=Xe(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",We.VML),i[i.length]=ge("legacyDrawing",null,{"r:id":"rId"+x}),u["!legacy"]=x),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function yN(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=r,s&7&&(n.level=s&7),s&16&&(n.hidden=!0),s&32&&(n.hpt=i/20),n}function EN(e,t,n){var r=te(145),i=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var s=320;i.hpx?s=nu(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var o=0,u=r.l;r.l+=4;for(var c={r:e,c:0},l=0;l<16;++l)if(!(t.s.c>l+1<<10||t.e.c<l<<10)){for(var m=-1,h=-1,g=l<<10;g<l+1<<10;++g){c.c=g;var x=Array.isArray(n)?(n[c.r]||[])[c.c]:n[et(c)];x&&(m<0&&(m=g),h=g)}m<0||(++o,r.write_shift(4,m),r.write_shift(4,h))}var v=r.l;return r.l=u,r.write_shift(4,o),r.l=v,r.length>r.l?r.slice(0,r.l):r}function TN(e,t,n,r){var i=EN(r,n,t);(i.length>17||(t["!rows"]||[])[r])&&le(e,0,i)}var SN=Vi,wN=Qs;function _N(){}function CN(e,t){var n={},r=e[e.l];return++e.l,n.above=!(r&64),n.left=!(r&128),e.l+=18,n.name=DS(e),n}function NN(e,t,n){n==null&&(n=te(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return Ql({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),j1(e,n),n.slice(0,n.l)}function AN(e){var t=Hn(e);return[t]}function IN(e,t,n){return n==null&&(n=te(8)),Bi(t,n)}function RN(e){var t=Gi(e);return[t]}function kN(e,t,n){return n==null&&(n=te(4)),$i(t,n)}function bN(e){var t=Hn(e),n=e.read_shift(1);return[t,n,"b"]}function FN(e,t,n){return n==null&&(n=te(9)),Bi(t,n),n.write_shift(1,e.v?1:0),n}function PN(e){var t=Gi(e),n=e.read_shift(1);return[t,n,"b"]}function MN(e,t,n){return n==null&&(n=te(5)),$i(t,n),n.write_shift(1,e.v?1:0),n}function DN(e){var t=Hn(e),n=e.read_shift(1);return[t,n,"e"]}function LN(e,t,n){return n==null&&(n=te(9)),Bi(t,n),n.write_shift(1,e.v),n}function ON(e){var t=Gi(e),n=e.read_shift(1);return[t,n,"e"]}function UN(e,t,n){return n==null&&(n=te(8)),$i(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}function BN(e){var t=Hn(e),n=e.read_shift(4);return[t,n,"s"]}function GN(e,t,n){return n==null&&(n=te(12)),Bi(t,n),n.write_shift(4,t.v),n}function $N(e){var t=Gi(e),n=e.read_shift(4);return[t,n,"s"]}function VN(e,t,n){return n==null&&(n=te(8)),$i(t,n),n.write_shift(4,t.v),n}function jN(e){var t=Hn(e),n=Zs(e);return[t,n,"n"]}function HN(e,t,n){return n==null&&(n=te(16)),Bi(t,n),Mi(e.v,n),n}function zN(e){var t=Gi(e),n=Zs(e);return[t,n,"n"]}function qN(e,t,n){return n==null&&(n=te(12)),$i(t,n),Mi(e.v,n),n}function WN(e){var t=Hn(e),n=H1(e);return[t,n,"n"]}function JN(e,t,n){return n==null&&(n=te(12)),Bi(t,n),z1(e.v,n),n}function YN(e){var t=Gi(e),n=H1(e);return[t,n,"n"]}function KN(e,t,n){return n==null&&(n=te(8)),$i(t,n),z1(e.v,n),n}function XN(e){var t=Hn(e),n=$f(e);return[t,n,"is"]}function QN(e){var t=Hn(e),n=en(e);return[t,n,"str"]}function ZN(e,t,n){return n==null&&(n=te(12+4*e.v.length)),Bi(t,n),Dt(e.v,n),n.length>n.l?n.slice(0,n.l):n}function eA(e){var t=Gi(e),n=en(e);return[t,n,"str"]}function tA(e,t,n){return n==null&&(n=te(8+4*e.v.length)),$i(t,n),Dt(e.v,n),n.length>n.l?n.slice(0,n.l):n}function nA(e,t,n){var r=e.l+t,i=Hn(e);i.r=n["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(n.cellFormula){e.l+=2;var o=bu(e,r-e.l,n);a[3]=qs(o,null,i,n.supbooks,n)}else e.l=r;return a}function rA(e,t,n){var r=e.l+t,i=Hn(e);i.r=n["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(n.cellFormula){e.l+=2;var o=bu(e,r-e.l,n);a[3]=qs(o,null,i,n.supbooks,n)}else e.l=r;return a}function iA(e,t,n){var r=e.l+t,i=Hn(e);i.r=n["!row"];var s=Zs(e),a=[i,s,"n"];if(n.cellFormula){e.l+=2;var o=bu(e,r-e.l,n);a[3]=qs(o,null,i,n.supbooks,n)}else e.l=r;return a}function sA(e,t,n){var r=e.l+t,i=Hn(e);i.r=n["!row"];var s=en(e),a=[i,s,"str"];if(n.cellFormula){e.l+=2;var o=bu(e,r-e.l,n);a[3]=qs(o,null,i,n.supbooks,n)}else e.l=r;return a}var aA=Vi,oA=Qs;function lA(e,t){return t==null&&(t=te(4)),t.write_shift(4,e),t}function uA(e,t){var n=e.l+t,r=Vi(e),i=Vf(e),s=en(e),a=en(e),o=en(e);e.l=n;var u={rfx:r,relId:i,loc:s,display:o};return a&&(u.Tooltip=a),u}function cA(e,t){var n=te(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Qs({s:Mt(e[0]),e:Mt(e[0])},n),jf("rId"+t,n);var r=e[1].Target.indexOf("#"),i=r==-1?"":e[1].Target.slice(r+1);return Dt(i||"",n),Dt(e[1].Tooltip||"",n),Dt("",n),n.slice(0,n.l)}function dA(){}function fA(e,t,n){var r=e.l+t,i=q1(e),s=e.read_shift(1),a=[i];if(a[2]=s,n.cellFormula){var o=eN(e,r-e.l,n);a[1]=o}else e.l=r;return a}function pA(e,t,n){var r=e.l+t,i=Vi(e),s=[i];if(n.cellFormula){var a=nN(e,r-e.l,n);s[1]=a,e.l=r}else e.l=r;return s}function hA(e,t,n){n==null&&(n=te(18));var r=Fu(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),n.write_shift(2,i),n}var Rv=["left","right","top","bottom","header","footer"];function mA(e){var t={};return Rv.forEach(function(n){t[n]=Zs(e)}),t}function gA(e,t){return t==null&&(t=te(6*8)),Av(e),Rv.forEach(function(n){Mi(e[n],t)}),t}function xA(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function vA(e,t,n){n==null&&(n=te(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function yA(e){var t=te(24);return t.write_shift(4,4),t.write_shift(4,1),Qs(e,t),t}function EA(e,t){return t==null&&(t=te(16*4+2)),t.write_shift(2,e.password?cv(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?t.write_shift(4,e[n[0]]!=null&&!e[n[0]]?1:0):t.write_shift(4,e[n[0]]!=null&&e[n[0]]?0:1)}),t}function TA(){}function SA(){}function wA(e,t,n,r,i,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=yn(t),t.z=t.z||vt[14],t.v=vn(un(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var u={r:n,c:r};switch(u.s=fi(i.cellXfs,t,i),t.l&&s["!links"].push([et(u),t.l]),t.c&&s["!comments"].push([et(u),t.c]),t.t){case"s":case"str":return i.bookSST?(o=Yf(i.Strings,t.v,i.revStrings),u.t="s",u.v=o,a?le(e,18,VN(t,u)):le(e,7,GN(t,u))):(u.t="str",a?le(e,17,tA(t,u)):le(e,6,ZN(t,u))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?le(e,13,KN(t,u)):le(e,2,JN(t,u)):a?le(e,16,qN(t,u)):le(e,5,HN(t,u)),!0;case"b":return u.t="b",a?le(e,15,MN(t,u)):le(e,4,FN(t,u)),!0;case"e":return u.t="e",a?le(e,14,UN(t,u)):le(e,3,LN(t,u)),!0}return a?le(e,12,kN(t,u)):le(e,1,IN(t,u)),!0}function _A(e,t,n,r){var i=ut(t["!ref"]||"A1"),s,a="",o=[];le(e,145);var u=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var l=i.s.r;l<=c;++l){a=zt(l),TN(e,t,i,l);var m=!1;if(l<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){l===i.s.r&&(o[h]=Zt(h)),s=o[h]+a;var g=u?(t[l]||[])[h]:t[s];if(!g){m=!1;continue}m=wA(e,g,l,h,r,t,m)}}le(e,146)}function CA(e,t){!t||!t["!merges"]||(le(e,177,lA(t["!merges"].length)),t["!merges"].forEach(function(n){le(e,176,oA(n))}),le(e,178))}function NA(e,t){!t||!t["!cols"]||(le(e,390),t["!cols"].forEach(function(n,r){n&&le(e,60,hA(r,n))}),le(e,391))}function AA(e,t){!t||!t["!ref"]||(le(e,648),le(e,649,yA(ut(t["!ref"]))),le(e,650))}function IA(e,t,n){t["!links"].forEach(function(r){if(r[1].Target){var i=Xe(n,-1,r[1].Target.replace(/#.*$/,""),We.HLINK);le(e,494,cA(r,i))}}),delete t["!links"]}function RA(e,t,n,r){if(t["!comments"].length>0){var i=Xe(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",We.VML);le(e,551,jf("rId"+i)),t["!legacy"]=i}}function kA(e,t,n,r){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:wt(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var a=n.Workbook.Names,o=Rn(s);o.s.r==o.e.r&&(o.e.r=Rn(t["!ref"]).e.r,s=wt(o));for(var u=0;u<a.length;++u){var c=a[u];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+s;break}}u==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+s}),le(e,161,Qs(ut(s))),le(e,162)}}function bA(e,t,n){le(e,133),le(e,137,vA(t,n)),le(e,138),le(e,134)}function FA(e,t){t["!protect"]&&le(e,535,EA(t["!protect"]))}function PA(e,t,n,r){var i=xn(),s=n.SheetNames[e],a=n.Sheets[s]||{},o=s;try{n&&n.Workbook&&(o=n.Workbook.Sheets[e].CodeName||o)}catch{}var u=ut(a["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],le(i,129),(n.vbaraw||a["!outline"])&&le(i,147,NN(o,a["!outline"])),le(i,148,wN(u)),bA(i,a,n.Workbook),NA(i,a),_A(i,a,e,t),FA(i,a),kA(i,a,n,e),CA(i,a),IA(i,a,r),a["!margins"]&&le(i,476,gA(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&AA(i,a),RA(i,a,e,r),le(i,130),i.end()}function MA(e,t){e.l+=10;var n=en(e);return{name:n}}var DA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function LA(e){return!e.Workbook||!e.Workbook.WBProps?"false":pS(e.Workbook.WBProps.date1904)?"true":"false"}var OA="][*?/\\".split("");function kv(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return OA.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function UA(e,t,n){e.forEach(function(r,i){kv(r);for(var s=0;s<i;++s)if(r==e[s])throw new Error("Duplicate Sheet Name: "+r);if(n){var a=t&&t[i]&&t[i].CodeName||r;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function BA(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];UA(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)oN(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}function bv(e){var t=[_t];t[t.length]=ge("workbook",null,{xmlns:Ks[0],"xmlns:r":Pt.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(DA.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(r[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=ge("workbookPr",null,r);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var a={name:Qe(e.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=ge("sheet",null,a)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var u={name:o.Name};o.Comment&&(u.comment=o.Comment),o.Sheet!=null&&(u.localSheetId=""+o.Sheet),o.Hidden&&(u.hidden="1"),o.Ref&&(t[t.length]=ge("definedName",Qe(o.Ref),u))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function GA(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=wd(e),n.name=en(e),n}function $A(e,t){return t||(t=te(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),jf(e.strRelID,t),Dt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function VA(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var i=t>8?en(e):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function jA(e,t){t||(t=te(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),j1(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function HA(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=LS(e),a=tN(e,0,n),o=Vf(e);e.l=r;var u={Name:s,Ptg:a};return i<268435455&&(u.Sheet=i),o&&(u.Comment=o),u}function zA(e,t){le(e,143);for(var n=0;n!=t.SheetNames.length;++n){var r=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,i={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]};le(e,156,$A(i))}le(e,144)}function qA(e,t){t||(t=te(127));for(var n=0;n!=4;++n)t.write_shift(4,0);return Dt("SheetJS",t),Dt(Hl.version,t),Dt(Hl.version,t),Dt("7262",t),t.length>t.l?t.slice(0,t.l):t}function WA(e,t){t||(t=te(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var n=120;return t.write_shift(1,n),t.length>t.l?t.slice(0,t.l):t}function JA(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var n=t.Workbook.Sheets,r=0,i=-1,s=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&i==-1?i=r:n[r].Hidden==1&&s==-1&&(s=r);s>i||(le(e,135),le(e,158,WA(i)),le(e,136))}}function YA(e,t){var n=xn();return le(n,131),le(n,128,qA()),le(n,153,jA(e.Workbook&&e.Workbook.WBProps||null)),JA(n,e),zA(n,e),le(n,132),n.end()}function KA(e,t,n){return(t.slice(-4)===".bin"?YA:bv)(e)}function XA(e,t,n,r,i){return(t.slice(-4)===".bin"?PA:Iv)(e,n,r,i)}function QA(e,t,n){return(t.slice(-4)===".bin"?g_:pv)(e,n)}function ZA(e,t,n){return(t.slice(-4)===".bin"?jw:uv)(e,n)}function eI(e,t,n){return(t.slice(-4)===".bin"?F_:vv)(e)}function tI(e){return(e.slice(-4)===".bin"?__:gv)()}function nI(e,t){var n=[];return e.Props&&n.push(QS(e.Props,t)),e.Custprops&&n.push(ZS(e.Props,e.Custprops)),n.join("")}function rI(){return""}function iI(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(r,i){var s=[];s.push(ge("NumberFormat",null,{"ss:Format":Qe(vt[r.numFmtId])}));var a={"ss:ID":"s"+(21+i)};n.push(ge("Style",s.join(""),a))}),ge("Styles",n.join(""))}function Fv(e){return ge("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Wf(e.Ref,{r:0,c:0})})}function sI(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var i=t[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||n.push(Fv(i)))}return ge("Names",n.join(""))}function aI(e,t,n,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==n&&(o.Name.match(/^_xlfn\./)||s.push(Fv(o)))}return s.join("")}function oI(e,t,n,r){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(ge("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(ge("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(ge("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(ge("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<n&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(jt("ProtectContents","True")),e["!protect"].objects&&i.push(jt("ProtectObjects","True")),e["!protect"].scenarios&&i.push(jt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(jt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(jt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":ge("WorksheetOptions",i.join(""),{xmlns:_n.x})}function lI(e){return e.map(function(t){var n=fS(t.t||""),r=ge("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return ge("Comment",r,{"ss:Author":t.a})}).join("")}function uI(e,t,n,r,i,s,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Qe(Wf(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var u=Mt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(u.r==a.r?"":"["+(u.r-a.r)+"]")+"C"+(u.c==a.c?"":"["+(u.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Qe(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Qe(e.l.Tooltip))),n["!merges"])for(var c=n["!merges"],l=0;l!=c.length;++l)c[l].s.c!=a.c||c[l].s.r!=a.r||(c[l].e.c>c[l].s.c&&(o["ss:MergeAcross"]=c[l].e.c-c[l].s.c),c[l].e.r>c[l].s.r&&(o["ss:MergeDown"]=c[l].e.r-c[l].s.r));var m="",h="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":m="Number",h=String(e.v);break;case"b":m="Boolean",h=e.v?"1":"0";break;case"e":m="Error",h=To[e.v];break;case"d":m="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||vt[14]);break;case"s":m="String",h=dS(e.v||"");break}var g=fi(r.cellXfs,e,r);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=a.c+1;var x=e.v!=null?h:"",v=e.t=="z"?"":'<Data ss:Type="'+m+'">'+x+"</Data>";return(e.c||[]).length>0&&(v+=lI(e.c)),ge("Cell",v,o)}function cI(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=fv(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function dI(e,t,n,r){if(!e["!ref"])return"";var i=ut(e["!ref"]),s=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(w,E){zf(w);var y=!!w.width,T=Fu(E,w),C={"ss:Index":E+1};y&&(C["ss:Width"]=eu(T.width)),w.hidden&&(C["ss:Hidden"]="1"),o.push(ge("Column",null,C))});for(var u=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var l=[cI(c,(e["!rows"]||[])[c])],m=i.s.c;m<=i.e.c;++m){var h=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>m)&&!(s[a].s.r>c)&&!(s[a].e.c<m)&&!(s[a].e.r<c)){(s[a].s.c!=m||s[a].s.r!=c)&&(h=!0);break}if(!h){var g={r:c,c:m},x=et(g),v=u?(e[c]||[])[m]:e[x];l.push(uI(v,x,e,t,n,r,g))}}l.push("</Row>"),l.length>2&&o.push(l.join(""))}return o.join("")}function fI(e,t,n){var r=[],i=n.SheetNames[e],s=n.Sheets[i],a=s?aI(s,t,e,n):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=s?dI(s,t,e,n):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(oI(s,t,e,n)),r.join("")}function pI(e,t){t||(t={}),e.SSF||(e.SSF=yn(vt)),e.SSF&&(Au(),Nu(e.SSF),t.revssf=Iu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],fi(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(nI(e,t)),n.push(rI()),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(ge("Worksheet",fI(r,t,e),{"ss:Name":Qe(e.SheetNames[r])}));return n[2]=iI(e,t),n[3]=sI(e),_t+ge("Workbook",n.join(""),{xmlns:_n.ss,"xmlns:o":_n.o,"xmlns:x":_n.x,"xmlns:ss":_n.ss,"xmlns:dt":_n.dt,"xmlns:html":_n.html})}var yc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function hI(e,t){var n=[],r=[],i=[],s=0,a,o=zp(ih,"n"),u=zp(sh,"n");if(e.Props)for(a=Wt(e.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?n:Object.prototype.hasOwnProperty.call(u,a[s])?r:i).push([a[s],e.Props[a[s]]]);if(e.Custprops)for(a=Wt(e.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?n:Object.prototype.hasOwnProperty.call(u,a[s])?r:i).push([a[s],e.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)nv.indexOf(i[s][0])>-1||Z1.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);r.length&&tt.utils.cfb_add(t,"/SummaryInformation",ch(r,yc.SI,u,sh)),(n.length||c.length)&&tt.utils.cfb_add(t,"/DocumentSummaryInformation",ch(n,yc.DSI,o,ih,c.length?c:null,yc.UDI))}function mI(e,t){var n=t||{},r=tt.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return tt.utils.cfb_add(r,i,Pv(e,n)),n.biff==8&&(e.Props||e.Custprops)&&hI(e,r),n.biff==8&&e.vbaraw&&P_(r,tt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var gI={0:{f:yN},1:{f:AN},2:{f:WN},3:{f:DN},4:{f:bN},5:{f:jN},6:{f:QN},7:{f:BN},8:{f:sA},9:{f:iA},10:{f:nA},11:{f:rA},12:{f:RN},13:{f:YN},14:{f:ON},15:{f:PN},16:{f:zN},17:{f:eA},18:{f:$N},19:{f:$f},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:HA},40:{},42:{},43:{f:Qw},44:{f:Kw},45:{f:t_},46:{f:r_},47:{f:n_},48:{},49:{f:RS},50:{},51:{f:y_},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:kw},62:{f:XN},63:{f:C_},64:{f:TA},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:hr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:xA},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:CN},148:{f:SN,p:16},151:{f:dA},152:{},153:{f:VA},154:{},155:{},156:{f:GA},157:{},158:{},159:{T:1,f:Gw},160:{T:-1},161:{T:1,f:Vi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:aA},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:x_},336:{T:-1},337:{f:S_,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:wd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:_w},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:fA},427:{f:pA},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:mA},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:_N},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:uA},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:wd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:k_},633:{T:1},634:{T:-1},635:{T:1,f:I_},636:{T:-1},637:{f:PS},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:MA},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:SA},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function xe(e,t,n,r){var i=t;if(!isNaN(i)){var s=r||(n||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Uf(n)&&e.push(n)}}function xI(e,t,n,r){var i=(n||[]).length||0;if(i<=8224)return xe(e,t,n,i);var s=t;if(!isNaN(s)){for(var a=n.parts||[],o=0,u=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var l=e.next(4);for(l.write_shift(2,s),l.write_shift(2,c),e.push(n.slice(u,u+c)),u+=c;u<i;){for(l=e.next(4),l.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;l.write_shift(2,c),e.push(n.slice(u,u+c)),u+=c}}}function wo(e,t,n){return e||(e=te(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function vI(e,t,n,r){var i=te(9);return wo(i,e,t),iv(n,r||"b",i),i}function yI(e,t,n){var r=te(8+2*n.length);return wo(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function EI(e,t,n,r){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?vn(un(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?xe(e,2,Mw(n,r,i)):xe(e,3,Pw(n,r,i));return;case"b":case"e":xe(e,5,vI(n,r,t.v,t.t));return;case"s":case"str":xe(e,4,yI(n,r,(t.v||"").slice(0,255)));return}xe(e,1,wo(null,n,r))}function TI(e,t,n,r){var i=Array.isArray(t),s=ut(t["!ref"]||"A1"),a,o="",u=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=wt(s)}for(var c=s.s.r;c<=s.e.r;++c){o=zt(c);for(var l=s.s.c;l<=s.e.c;++l){c===s.s.r&&(u[l]=Zt(l)),a=u[l]+o;var m=i?(t[c]||[])[l]:t[a];m&&EI(e,m,c,l)}}}function SI(e,t){for(var n=t||{},r=xn(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==n.sheet&&(i=s);if(i==0&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return xe(r,n.biff==4?1033:n.biff==3?521:9,Hf(e,16,n)),TI(r,e.Sheets[e.SheetNames[i]],i,n),xe(r,10),r.end()}function wI(e,t,n){xe(e,49,gw({sz:12,name:"Arial"},n))}function _I(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&xe(e,1054,yw(i,t[i],n))})}function CI(e,t){var n=te(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),xe(e,2151,n),n=te(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),ov(ut(t["!ref"]||"A1"),n),n.write_shift(4,4),xe(e,2152,n)}function NI(e,t){for(var n=0;n<16;++n)xe(e,224,fh({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){xe(e,224,fh(r,0,t))})}function AI(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];xe(e,440,Aw(r)),r[1].Tooltip&&xe(e,2048,Iw(r))}delete t["!links"]}function II(e,t){if(t){var n=0;t.forEach(function(r,i){++n<=256&&r&&xe(e,125,bw(Fu(i,r),i))})}}function RI(e,t,n,r,i){var s=16+fi(i.cellXfs,t,i);if(t.v==null&&!t.bf){xe(e,513,Di(n,r,s));return}if(t.bf)xe(e,6,ZC(t,n,r,i,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?vn(un(t.v)):t.v;xe(e,515,ww(n,r,a,s));break;case"b":case"e":xe(e,517,Sw(n,r,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=Yf(i.Strings,t.v,i.revStrings);xe(e,253,xw(n,r,o,s))}else xe(e,516,vw(n,r,(t.v||"").slice(0,255),s,i));break;default:xe(e,513,Di(n,r,s))}}function kI(e,t,n){var r=xn(),i=n.SheetNames[e],s=n.Sheets[i]||{},a=(n||{}).Workbook||{},o=(a.Sheets||[])[e]||{},u=Array.isArray(s),c=t.biff==8,l,m="",h=[],g=ut(s["!ref"]||"A1"),x=c?65536:16384;if(g.e.c>255||g.e.r>=x){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,x-1)}xe(r,2057,Hf(n,16,t)),xe(r,13,Ln(1)),xe(r,12,Ln(100)),xe(r,15,on(!0)),xe(r,17,on(!1)),xe(r,16,Mi(.001)),xe(r,95,on(!0)),xe(r,42,on(!1)),xe(r,43,on(!1)),xe(r,130,Ln(1)),xe(r,128,Tw()),xe(r,131,on(!1)),xe(r,132,on(!1)),c&&II(r,s["!cols"]),xe(r,512,Ew(g,t)),c&&(s["!links"]=[]);for(var v=g.s.r;v<=g.e.r;++v){m=zt(v);for(var w=g.s.c;w<=g.e.c;++w){v===g.s.r&&(h[w]=Zt(w)),l=h[w]+m;var E=u?(s[v]||[])[w]:s[l];E&&(RI(r,E,v,w,t),c&&E.l&&s["!links"].push([l,E.l]))}}var y=o.CodeName||o.name||i;return c&&xe(r,574,mw((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&xe(r,229,Nw(s["!merges"])),c&&AI(r,s),xe(r,442,av(y)),c&&CI(r,s),xe(r,10),r.end()}function bI(e,t,n){var r=xn(),i=(e||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=n.biff==8,u=n.biff==5;if(xe(r,2057,Hf(e,5,n)),n.bookType=="xla"&&xe(r,135),xe(r,225,o?Ln(1200):null),xe(r,193,nw(2)),u&&xe(r,191),u&&xe(r,192),xe(r,226),xe(r,92,dw("SheetJS",n)),xe(r,66,Ln(o?1200:1252)),o&&xe(r,353,Ln(0)),o&&xe(r,448),xe(r,317,Fw(e.SheetNames.length)),o&&e.vbaraw&&xe(r,211),o&&e.vbaraw){var c=a.CodeName||"ThisWorkbook";xe(r,442,av(c))}xe(r,156,Ln(17)),xe(r,25,on(!1)),xe(r,18,on(!1)),xe(r,19,Ln(0)),o&&xe(r,431,on(!1)),o&&xe(r,444,Ln(0)),xe(r,61,hw()),xe(r,64,on(!1)),xe(r,141,Ln(0)),xe(r,34,on(LA(e)=="true")),xe(r,14,on(!0)),o&&xe(r,439,on(!1)),xe(r,218,Ln(0)),wI(r,e,n),_I(r,e.SSF,n),NI(r,n),o&&xe(r,352,on(!1));var l=r.end(),m=xn();o&&xe(m,140,Rw()),o&&n.Strings&&xI(m,252,pw(n.Strings)),xe(m,10);var h=m.end(),g=xn(),x=0,v=0;for(v=0;v<e.SheetNames.length;++v)x+=(o?12:11)+(o?2:1)*e.SheetNames[v].length;var w=l.length+x+h.length;for(v=0;v<e.SheetNames.length;++v){var E=s[v]||{};xe(g,133,fw({pos:w,hs:E.Hidden||0,dt:0,name:e.SheetNames[v]},n)),w+=t[v].length}var y=g.end();if(x!=y.length)throw new Error("BS8 "+x+" != "+y.length);var T=[];return l.length&&T.push(l),y.length&&T.push(y),h.length&&T.push(h),Vt(T)}function FI(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=yn(vt)),e&&e.SSF&&(Au(),Nu(e.SSF),n.revssf=Iu(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Kf(n),n.cellXfs=[],fi(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)r[r.length]=kI(i,n,e);return r.unshift(bI(e,r,n)),Vt(r)}function Pv(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(!(!r||!r["!ref"])){var i=Rn(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return FI(e,t);case 4:case 3:case 2:return SI(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function PI(e,t,n,r){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,u=0,c=0;c<i.length;++c)if(!(i[c].s.r>n||i[c].s.c>a)&&!(i[c].e.r<n||i[c].e.c<a)){if(i[c].s.r<n||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,u=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var l=et({r:n,c:a}),m=r.dense?(e[n]||[])[a]:e[l],h=m&&m.v!=null&&(m.h||cS(m.w||(br(m),m.w)||""))||"",g={};o>1&&(g.rowspan=o),u>1&&(g.colspan=u),r.editable?h='<span contenteditable="true">'+h+"</span>":m&&(g["data-t"]=m&&m.t||"z",m.v!=null&&(g["data-v"]=m.v),m.z!=null&&(g["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+m.l.Target+'">'+h+"</a>")),g.id=(r.id||"sjs")+"-"+l,s.push(ge("td",h,g))}}var x="<tr>";return x+s.join("")+"</tr>"}var MI='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',DI="</body></html>";function LI(e,t,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function Mv(e,t){var n=t||{},r=n.header!=null?n.header:MI,i=n.footer!=null?n.footer:DI,s=[r],a=Rn(e["!ref"]);n.dense=Array.isArray(e),s.push(LI(e,a,n));for(var o=a.s.r;o<=a.e.r;++o)s.push(PI(e,a,o,n));return s.push("</table>"+i),s.join("")}function Dv(e,t,n){var r=n||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var a=typeof r.origin=="string"?Mt(r.origin):r.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),u=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var l=Rn(e["!ref"]);c.s.r=Math.min(c.s.r,l.s.r),c.s.c=Math.min(c.s.c,l.s.c),c.e.r=Math.max(c.e.r,l.e.r),c.e.c=Math.max(c.e.c,l.e.c),i==-1&&(c.e.r=i=l.e.r+1)}var m=[],h=0,g=e["!rows"]||(e["!rows"]=[]),x=0,v=0,w=0,E=0,y=0,T=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&v<u;++x){var C=o[x];if(yh(C)){if(r.display)continue;g[v]={hidden:!0}}var L=C.children;for(w=E=0;w<L.length;++w){var B=L[w];if(!(r.display&&yh(B))){var R=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):hS(B.innerHTML),O=B.getAttribute("data-z")||B.getAttribute("z");for(h=0;h<m.length;++h){var M=m[h];M.s.c==E+s&&M.s.r<v+i&&v+i<=M.e.r&&(E=M.e.c+1-s,h=-1)}T=+B.getAttribute("colspan")||1,((y=+B.getAttribute("rowspan")||1)>1||T>1)&&m.push({s:{r:v+i,c:E+s},e:{r:v+i+(y||1)-1,c:E+s+(T||1)-1}});var k={t:"s",v:R},z=B.getAttribute("data-t")||B.getAttribute("t")||"";R!=null&&(R.length==0?k.t=z||"z":r.raw||R.trim().length==0||z=="s"||(R==="TRUE"?k={t:"b",v:!0}:R==="FALSE"?k={t:"b",v:!1}:isNaN(_r(R))?isNaN(ao(R).getDate())||(k={t:"d",v:un(R)},r.cellDates||(k={t:"n",v:vn(k.v)}),k.z=r.dateNF||vt[14]):k={t:"n",v:_r(R)})),k.z===void 0&&O!=null&&(k.z=O);var X="",ne=B.getElementsByTagName("A");if(ne&&ne.length)for(var Fe=0;Fe<ne.length&&!(ne[Fe].hasAttribute("href")&&(X=ne[Fe].getAttribute("href"),X.charAt(0)!="#"));++Fe);X&&X.charAt(0)!="#"&&(k.l={Target:X}),r.dense?(e[v+i]||(e[v+i]=[]),e[v+i][E+s]=k):e[et({c:E+s,r:v+i})]=k,c.e.c<E+s&&(c.e.c=E+s),E+=T}}++v}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),c.e.r=Math.max(c.e.r,v-1+i),e["!ref"]=wt(c),v>=u&&(e["!fullref"]=wt((c.e.r=o.length-x+v-1+i,c))),e}function Lv(e,t){var n=t||{},r=n.dense?[]:{};return Dv(r,e,t)}function OI(e,t){return Ui(Lv(e,t),t)}function yh(e){var t="",n=UI(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function UI(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var BI=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+lo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return _t+t}}(),Eh=function(){var e=function(s){return Qe(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(s,a,o){var u=[];u.push('      <table:table table:name="'+Qe(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,l=0,m=Rn(s["!ref"]||"A1"),h=s["!merges"]||[],g=0,x=Array.isArray(s);if(s["!cols"])for(l=0;l<=m.e.c;++l)u.push("        <table:table-column"+(s["!cols"][l]?' table:style-name="co'+s["!cols"][l].ods+'"':"")+`></table:table-column>
`);var v="",w=s["!rows"]||[];for(c=0;c<m.s.r;++c)v=w[c]?' table:style-name="ro'+w[c].ods+'"':"",u.push("        <table:table-row"+v+`></table:table-row>
`);for(;c<=m.e.r;++c){for(v=w[c]?' table:style-name="ro'+w[c].ods+'"':"",u.push("        <table:table-row"+v+`>
`),l=0;l<m.s.c;++l)u.push(t);for(;l<=m.e.c;++l){var E=!1,y={},T="";for(g=0;g!=h.length;++g)if(!(h[g].s.c>l)&&!(h[g].s.r>c)&&!(h[g].e.c<l)&&!(h[g].e.r<c)){(h[g].s.c!=l||h[g].s.r!=c)&&(E=!0),y["table:number-columns-spanned"]=h[g].e.c-h[g].s.c+1,y["table:number-rows-spanned"]=h[g].e.r-h[g].s.r+1;break}if(E){u.push(n);continue}var C=et({r:c,c:l}),L=x?(s[c]||[])[l]:s[C];if(L&&L.f&&(y["table:formula"]=Qe(sN(L.f)),L.F&&L.F.slice(0,C.length)==C)){var B=Rn(L.F);y["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,y["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!L){u.push(t);continue}switch(L.t){case"b":T=L.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=L.v?"true":"false";break;case"n":T=L.w||String(L.v||0),y["office:value-type"]="float",y["office:value"]=L.v||0;break;case"s":case"str":T=L.v==null?"":L.v,y["office:value-type"]="string";break;case"d":T=L.w||un(L.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=un(L.v).toISOString(),y["table:style-name"]="ce1";break;default:u.push(t);continue}var R=e(T);if(L.l&&L.l.Target){var O=L.l.Target;O=O.charAt(0)=="#"?"#"+aN(O.slice(1)):O,O.charAt(0)!="#"&&!O.match(/^\w+:/)&&(O="../"+O),R=ge("text:a",R,{"xlink:href":O.replace(/&/g,"&amp;")})}u.push("          "+ge("table:table-cell",ge("text:p",R,{}),y)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var l=0;l<c["!cols"].length;++l)if(c["!cols"][l]){var m=c["!cols"][l];if(m.width==null&&m.wpx==null&&m.wch==null)continue;zf(m),m.ods=o;var h=c["!cols"][l].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var u=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var l=0;l<c["!rows"].length;++l)if(c["!rows"][l]){c["!rows"][l].ods=u;var m=c["!rows"][l].hpx+"px";s.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),s.push(`  </style:style>
`),++u}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var u=[_t],c=lo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),l=lo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(u.push("<office:document"+c+l+`>
`),u.push(X1().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+c+`>
`),i(u,a),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var m=0;m!=a.SheetNames.length;++m)u.push(r(a.Sheets[a.SheetNames[m]],a,m));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),o.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}}();function Ov(e,t){if(t.bookType=="fods")return Eh(e,t);var n=Mf(),r="",i=[],s=[];return r="mimetype",Be(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",Be(n,r,Eh(e,t)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",Be(n,r,BI(e,t)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",Be(n,r,_t+X1()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",Be(n,r,XS(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",Be(n,r,YS(i)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ru(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function GI(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Qn(oo(e))}function $I(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}function li(e){var t=e.reduce(function(i,s){return i+s.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(i){n.set(i,r),r+=i.length}),n}function VI(e,t,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=n>=0?0:128}function uo(e,t){var n=t?t[0]:0,r=e[n]&127;e:if(e[n++]>=128&&(r|=(e[n]&127)<<7,e[n++]<128||(r|=(e[n]&127)<<14,e[n++]<128)||(r|=(e[n]&127)<<21,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),r}function Ke(e){var t=new Uint8Array(7);t[0]=e&127;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383||(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)||(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)||(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)||(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103))break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function Ds(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function Ct(e){for(var t=[],n=[0];n[0]<e.length;){var r=n[0],i=uo(e,n),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var u=n[0];e[n[0]++]>=128;);o=e.slice(u,n[0])}break;case 5:a=4,o=e.slice(n[0],n[0]+a),n[0]+=a;break;case 1:a=8,o=e.slice(n[0],n[0]+a),n[0]+=a;break;case 2:a=uo(e,n),o=e.slice(n[0],n[0]+a),n[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function Ot(e){var t=[];return e.forEach(function(n,r){n.forEach(function(i){i.data&&(t.push(Ke(r*8+i.type)),i.type==2&&t.push(Ke(i.data.length)),t.push(i.data))})}),li(t)}function Wn(e){for(var t,n=[],r=[0];r[0]<e.length;){var i=uo(e,r),s=Ct(e.slice(r[0],r[0]+i));r[0]+=i;var a={id:Ds(s[1][0].data),messages:[]};s[2].forEach(function(o){var u=Ct(o.data),c=Ds(u[3][0].data);a.messages.push({meta:u,data:e.slice(r[0],r[0]+c)}),r[0]+=c}),(t=s[3])!=null&&t[0]&&(a.merge=Ds(s[3][0].data)>>>0>0),n.push(a)}return n}function ss(e){var t=[];return e.forEach(function(n){var r=[];r[1]=[{data:Ke(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:Ke(+!!n.merge),type:0}]);var i=[];n.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Ke(a.data.length)}],r[2].push({data:Ot(a.meta),type:2})});var s=Ot(r);t.push(Ke(s.length)),t.push(s),i.forEach(function(a){return t.push(a)})}),li(t)}function jI(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=uo(t,n),i=[];n[0]<t.length;){var s=t[n[0]]&3;if(s==0){var a=t[n[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[n[0]],o>1&&(a|=t[n[0]+1]<<8),o>2&&(a|=t[n[0]+2]<<16),o>3&&(a|=t[n[0]+3]<<24),a>>>=0,a++,n[0]+=o}i.push(t.slice(n[0],n[0]+a)),n[0]+=a;continue}else{var u=0,c=0;if(s==1?(c=(t[n[0]]>>2&7)+4,u=(t[n[0]++]&224)<<3,u|=t[n[0]++]):(c=(t[n[0]++]>>2)+1,s==2?(u=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(u=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),i=[li(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(c>=u)for(i.push(i[0].slice(-u)),c-=u;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-u,-u+c))}}var l=li(i);if(l.length!=r)throw new Error("Unexpected length: ".concat(l.length," != ").concat(r));return l}function Jn(e){for(var t=[],n=0;n<e.length;){var r=e[n++],i=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(jI(r,e.slice(n,n+i))),n+=i}if(n!==e.length)throw new Error("data is not a valid framed stream!");return li(t)}function as(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),i=new Uint8Array(4);t.push(i);var s=Ke(r),a=s.length;t.push(s),r<=60?(a++,t.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),a+=r,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,n+=r}return li(t)}function Ec(e,t){var n=new Uint8Array(32),r=ru(n),i=12,s=0;switch(n[0]=5,e.t){case"n":n[1]=2,VI(n,i,e.v),s|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,s,!0),n.slice(0,i)}function Tc(e,t){var n=new Uint8Array(32),r=ru(n),i=12,s=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,s,!0),n.slice(0,i)}function Gr(e){var t=Ct(e);return uo(t[1][0].data)}function HI(e,t,n){var r,i,s,a;if(!((r=e[6])!=null&&r[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=e[8])==null?void 0:s[0])==null?void 0:a.data)&&Ds(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var u=0,c=ru(e[7][0].data),l=0,m=[],h=ru(e[4][0].data),g=0,x=[],v=0;v<t.length;++v){if(t[v]==null){c.setUint16(v*2,65535,!0),h.setUint16(v*2,65535);continue}c.setUint16(v*2,l,!0),h.setUint16(v*2,g,!0);var w,E;switch(typeof t[v]){case"string":w=Ec({t:"s",v:t[v]},n),E=Tc({t:"s",v:t[v]},n);break;case"number":w=Ec({t:"n",v:t[v]},n),E=Tc({t:"n",v:t[v]},n);break;case"boolean":w=Ec({t:"b",v:t[v]},n),E=Tc({t:"b",v:t[v]},n);break;default:throw new Error("Unsupported value "+t[v])}m.push(w),l+=w.length,x.push(E),g+=E.length,++u}for(e[2][0].data=Ke(u);v<e[7][0].data.length/2;++v)c.setUint16(v*2,65535,!0),h.setUint16(v*2,65535,!0);return e[6][0].data=li(m),e[3][0].data=li(x),u}function zI(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Rn(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(wt(r)));var s=iu(n,{range:r,header:1}),a=["~Sh33tJ5~"];s.forEach(function(U){return U.forEach(function(G){typeof G=="string"&&a.push(G)})});var o={},u=[],c=tt.read(t.numbers,{type:"base64"});c.FileIndex.map(function(U,G){return[U,c.FullPaths[G]]}).forEach(function(U){var G=U[0],V=U[1];if(G.type==2&&G.name.match(/\.iwa/)){var re=G.content,H=Jn(re),de=Wn(H);de.forEach(function(Ee){u.push(Ee.id),o[Ee.id]={deps:[],location:V,type:Ds(Ee.messages[0].meta[1][0].data)}})}}),u.sort(function(U,G){return U-G});var l=u.filter(function(U){return U>1}).map(function(U){return[U,Ke(U)]});c.FileIndex.map(function(U,G){return[U,c.FullPaths[G]]}).forEach(function(U){var G=U[0];if(U[1],!!G.name.match(/\.iwa/)){var V=Wn(Jn(G.content));V.forEach(function(re){re.messages.forEach(function(H){l.forEach(function(de){re.messages.some(function(Ee){return Ds(Ee.meta[1][0].data)!=11006&&$I(Ee.data,de[1])})&&o[de[0]].deps.push(re.id)})})})}});for(var m=tt.find(c,o[1].location),h=Wn(Jn(m.content)),g,x=0;x<h.length;++x){var v=h[x];v.id==1&&(g=v)}var w=Gr(Ct(g.messages[0].data)[1][0].data);for(m=tt.find(c,o[w].location),h=Wn(Jn(m.content)),x=0;x<h.length;++x)v=h[x],v.id==w&&(g=v);for(w=Gr(Ct(g.messages[0].data)[2][0].data),m=tt.find(c,o[w].location),h=Wn(Jn(m.content)),x=0;x<h.length;++x)v=h[x],v.id==w&&(g=v);for(w=Gr(Ct(g.messages[0].data)[2][0].data),m=tt.find(c,o[w].location),h=Wn(Jn(m.content)),x=0;x<h.length;++x)v=h[x],v.id==w&&(g=v);var E=Ct(g.messages[0].data);{E[6][0].data=Ke(r.e.r+1),E[7][0].data=Ke(r.e.c+1);var y=Gr(E[46][0].data),T=tt.find(c,o[y].location),C=Wn(Jn(T.content));{for(var L=0;L<C.length&&C[L].id!=y;++L);if(C[L].id!=y)throw"Bad ColumnRowUIDMapArchive";var B=Ct(C[L].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var R=0;R<=r.e.c;++R){var O=[];O[1]=O[2]=[{type:0,data:Ke(R+420690)}],B[1].push({type:2,data:Ot(O)}),B[2].push({type:0,data:Ke(R)}),B[3].push({type:0,data:Ke(R)})}B[4]=[],B[5]=[],B[6]=[];for(var M=0;M<=r.e.r;++M)O=[],O[1]=O[2]=[{type:0,data:Ke(M+726270)}],B[4].push({type:2,data:Ot(O)}),B[5].push({type:0,data:Ke(M)}),B[6].push({type:0,data:Ke(M)});C[L].messages[0].data=Ot(B)}T.content=as(ss(C)),T.size=T.content.length,delete E[46];var k=Ct(E[4][0].data);{k[7][0].data=Ke(r.e.r+1);var z=Ct(k[1][0].data),X=Gr(z[2][0].data);T=tt.find(c,o[X].location),C=Wn(Jn(T.content));{if(C[0].id!=X)throw"Bad HeaderStorageBucket";var ne=Ct(C[0].messages[0].data);for(M=0;M<s.length;++M){var Fe=Ct(ne[2][0].data);Fe[1][0].data=Ke(M),Fe[4][0].data=Ke(s[M].length),ne[2][M]={type:ne[2][0].type,data:Ot(Fe)}}C[0].messages[0].data=Ot(ne)}T.content=as(ss(C)),T.size=T.content.length;var q=Gr(k[2][0].data);T=tt.find(c,o[q].location),C=Wn(Jn(T.content));{if(C[0].id!=q)throw"Bad HeaderStorageBucket";for(ne=Ct(C[0].messages[0].data),R=0;R<=r.e.c;++R)Fe=Ct(ne[2][0].data),Fe[1][0].data=Ke(R),Fe[4][0].data=Ke(r.e.r+1),ne[2][R]={type:ne[2][0].type,data:Ot(Fe)};C[0].messages[0].data=Ot(ne)}T.content=as(ss(C)),T.size=T.content.length;var ue=Gr(k[4][0].data);(function(){for(var U=tt.find(c,o[ue].location),G=Wn(Jn(U.content)),V,re=0;re<G.length;++re){var H=G[re];H.id==ue&&(V=H)}var de=Ct(V.messages[0].data);{de[3]=[];var Ee=[];a.forEach(function(Ve,yt){Ee[1]=[{type:0,data:Ke(yt)}],Ee[2]=[{type:0,data:Ke(1)}],Ee[3]=[{type:2,data:GI(Ve)}],de[3].push({type:2,data:Ot(Ee)})})}V.messages[0].data=Ot(de);var Se=ss(G),Le=as(Se);U.content=Le,U.size=U.content.length})();var ke=Ct(k[3][0].data);{var se=ke[1][0];delete ke[2];var ae=Ct(se.data);{var ce=Gr(ae[2][0].data);(function(){for(var U=tt.find(c,o[ce].location),G=Wn(Jn(U.content)),V,re=0;re<G.length;++re){var H=G[re];H.id==ce&&(V=H)}var de=Ct(V.messages[0].data);{delete de[6],delete ke[7];var Ee=new Uint8Array(de[5][0].data);de[5]=[];for(var Se=0,Le=0;Le<=r.e.r;++Le){var Ve=Ct(Ee);Se+=HI(Ve,s[Le],a),Ve[1][0].data=Ke(Le),de[5].push({data:Ot(Ve),type:2})}de[1]=[{type:0,data:Ke(r.e.c+1)}],de[2]=[{type:0,data:Ke(r.e.r+1)}],de[3]=[{type:0,data:Ke(Se)}],de[4]=[{type:0,data:Ke(r.e.r+1)}]}V.messages[0].data=Ot(de);var yt=ss(G),je=as(yt);U.content=je,U.size=U.content.length})()}se.data=Ot(ae)}k[3][0].data=Ot(ke)}E[4][0].data=Ot(k)}g.messages[0].data=Ot(E);var Ce=ss(h),D=as(Ce);return m.content=D,m.size=m.content.length,c}function qI(e){return function(n){for(var r=0;r!=e.length;++r){var i=e[r];n[i[0]]===void 0&&(n[i[0]]=i[1]),i[2]==="n"&&(n[i[0]]=Number(n[i[0]]))}}}function Kf(e){qI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function WI(e,t){return t.bookType=="ods"?Ov(e,t):t.bookType=="numbers"?zI(e,t):t.bookType=="xlsb"?JI(e,t):YI(e,t)}function JI(e,t){Ss=1024,e&&!e.SSF&&(e.SSF=yn(vt)),e&&e.SSF&&(Au(),Nu(e.SSF),t.revssf=Iu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ua?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n=t.bookType=="xlsb"?"bin":"xml",r=yv.indexOf(t.bookType)>-1,i=J1();Kf(t=t||{});var s=Mf(),a="",o=0;if(t.cellXfs=[],fi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Be(s,a,Q1(e.Props,t)),i.coreprops.push(a),Xe(t.rels,2,a,We.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&u.push(e.SheetNames[c]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,Be(s,a,ev(e.Props)),i.extprops.push(a),Xe(t.rels,3,a,We.EXT_PROPS),e.Custprops!==e.Props&&Wt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Be(s,a,tv(e.Custprops)),i.custprops.push(a),Xe(t.rels,4,a,We.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var l={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],h=(m||{})["!type"]||"sheet";switch(h){case"chart":default:a="xl/worksheets/sheet"+o+"."+n,Be(s,a,XA(o-1,a,t,e,l)),i.sheets.push(a),Xe(t.wbrels,-1,"worksheets/sheet"+o+"."+n,We.WS[0])}if(m){var g=m["!comments"],x=!1,v="";g&&g.length>0&&(v="xl/comments"+o+"."+n,Be(s,v,eI(g,v)),i.comments.push(v),Xe(l,-1,"../comments"+o+"."+n,We.CMNT),x=!0),m["!legacy"]&&x&&Be(s,"xl/drawings/vmlDrawing"+o+".vml",xv(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}l["!id"].rId1&&Be(s,K1(a),Ps(l))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+n,Be(s,a,ZA(t.Strings,a,t)),i.strs.push(a),Xe(t.wbrels,-1,"sharedStrings."+n,We.SST)),a="xl/workbook."+n,Be(s,a,KA(e,a)),i.workbooks.push(a),Xe(t.rels,1,a,We.WB),a="xl/theme/theme1.xml",Be(s,a,mv(e.Themes,t)),i.themes.push(a),Xe(t.wbrels,-1,"theme/theme1.xml",We.THEME),a="xl/styles."+n,Be(s,a,QA(e,a,t)),i.styles.push(a),Xe(t.wbrels,-1,"styles."+n,We.STY),e.vbaraw&&r&&(a="xl/vbaProject.bin",Be(s,a,e.vbaraw),i.vba.push(a),Xe(t.wbrels,-1,"vbaProject.bin",We.VBA)),a="xl/metadata."+n,Be(s,a,tI(a)),i.metadata.push(a),Xe(t.wbrels,-1,"metadata."+n,We.XLMETA),Be(s,"[Content_Types].xml",Y1(i,t)),Be(s,"_rels/.rels",Ps(t.rels)),Be(s,"xl/_rels/workbook."+n+".rels",Ps(t.wbrels)),delete t.revssf,delete t.ssf,s}function YI(e,t){Ss=1024,e&&!e.SSF&&(e.SSF=yn(vt)),e&&e.SSF&&(Au(),Nu(e.SSF),t.revssf=Iu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ua?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=yv.indexOf(t.bookType)>-1,i=J1();Kf(t=t||{});var s=Mf(),a="",o=0;if(t.cellXfs=[],fi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Be(s,a,Q1(e.Props,t)),i.coreprops.push(a),Xe(t.rels,2,a,We.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&u.push(e.SheetNames[c]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,Be(s,a,ev(e.Props)),i.extprops.push(a),Xe(t.rels,3,a,We.EXT_PROPS),e.Custprops!==e.Props&&Wt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Be(s,a,tv(e.Custprops)),i.custprops.push(a),Xe(t.rels,4,a,We.CUST_PROPS));var l=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var m={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],g=(h||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+n,Be(s,a,Iv(o-1,t,e,m)),i.sheets.push(a),Xe(t.wbrels,-1,"worksheets/sheet"+o+"."+n,We.WS[0])}if(h){var x=h["!comments"],v=!1,w="";if(x&&x.length>0){var E=!1;x.forEach(function(y){y[1].forEach(function(T){T.T==!0&&(E=!0)})}),E&&(w="xl/threadedComments/threadedComment"+o+"."+n,Be(s,w,N_(x,l,t)),i.threadedcomments.push(w),Xe(m,-1,"../threadedComments/threadedComment"+o+"."+n,We.TCMNT)),w="xl/comments"+o+"."+n,Be(s,w,vv(x)),i.comments.push(w),Xe(m,-1,"../comments"+o+"."+n,We.CMNT),v=!0}h["!legacy"]&&v&&Be(s,"xl/drawings/vmlDrawing"+o+".vml",xv(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}m["!id"].rId1&&Be(s,K1(a),Ps(m))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+n,Be(s,a,uv(t.Strings,t)),i.strs.push(a),Xe(t.wbrels,-1,"sharedStrings."+n,We.SST)),a="xl/workbook."+n,Be(s,a,bv(e)),i.workbooks.push(a),Xe(t.rels,1,a,We.WB),a="xl/theme/theme1.xml",Be(s,a,mv(e.Themes,t)),i.themes.push(a),Xe(t.wbrels,-1,"theme/theme1.xml",We.THEME),a="xl/styles."+n,Be(s,a,pv(e,t)),i.styles.push(a),Xe(t.wbrels,-1,"styles."+n,We.STY),e.vbaraw&&r&&(a="xl/vbaProject.bin",Be(s,a,e.vbaraw),i.vba.push(a),Xe(t.wbrels,-1,"vbaProject.bin",We.VBA)),a="xl/metadata."+n,Be(s,a,gv()),i.metadata.push(a),Xe(t.wbrels,-1,"metadata."+n,We.XLMETA),l.length>1&&(a="xl/persons/person.xml",Be(s,a,A_(l)),i.people.push(a),Xe(t.wbrels,-1,"persons/person.xml",We.PEOPLE)),Be(s,"[Content_Types].xml",Y1(i,t)),Be(s,"_rels/.rels",Ps(t.rels)),Be(s,"xl/_rels/workbook."+n+".rels",Ps(t.wbrels)),delete t.revssf,delete t.ssf,s}function KI(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=kr(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function Uv(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return yo(t.file,tt.write(e,{type:Ye?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return tt.write(e,t)}function XI(e,t){var n=yn(t||{}),r=WI(e,n);return QI(r,n)}function QI(e,t){var n={},r=Ye?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?tt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Cu(i))}return t.password&&typeof encrypt_agile<"u"?Uv(encrypt_agile(i,t.password),t):t.type==="file"?yo(t.file,i):t.type=="string"?Ma(i):i}function ZI(e,t){var n=t||{},r=mI(e,n);return Uv(r,n)}function ur(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return so(oo(r));case"binary":return oo(r);case"string":return e;case"file":return yo(t.file,r,"utf8");case"buffer":return Ye?Mr(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):ur(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function eR(e,t){switch(t.type){case"base64":return so(e);case"binary":return e;case"string":return e;case"file":return yo(t.file,e,"binary");case"buffer":return Ye?Mr(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function el(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return t.type=="base64"?so(n):t.type=="string"?Ma(n):n;case"file":return yo(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Bv(e,t){IT(),BA(e);var n=yn(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=Bv(e,n);return n.type="array",Cu(r)}var i=0;if(n.sheet&&(typeof n.sheet=="number"?i=n.sheet:i=e.SheetNames.indexOf(n.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return ur(pI(e,n),n);case"slk":case"sylk":return ur(Lw.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"htm":case"html":return ur(Mv(e.Sheets[e.SheetNames[i]],n),n);case"txt":return eR($v(e.Sheets[e.SheetNames[i]],n),n);case"csv":return ur(Xf(e.Sheets[e.SheetNames[i]],n),n,"\uFEFF");case"dif":return ur(Ow.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"dbf":return el(Dw.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"prn":return ur(Uw.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"rtf":return ur(zw.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"eth":return ur(lv.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"fods":return ur(Ov(e,n),n);case"wk1":return el(ph.sheet_to_wk1(e.Sheets[e.SheetNames[i]],n),n);case"wk3":return el(ph.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),el(Pv(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),ZI(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return XI(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function tR(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(e.bookType=n.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Gv(e,t,n){var r={};return r.type="file",r.file=t,tR(r),Bv(e,r)}function nR(e,t,n,r,i,s,a,o){var u=zt(n),c=o.defval,l=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),m=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:n,enumerable:!1})}catch{h.__rowNum__=n}else h.__rowNum__=n;if(!a||e[n])for(var g=t.s.c;g<=t.e.c;++g){var x=a?e[n][g]:e[r[g]+u];if(x===void 0||x.t===void 0){if(c===void 0)continue;s[g]!=null&&(h[s[g]]=c);continue}var v=x.v;switch(x.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[g]!=null){if(v==null)if(x.t=="e"&&v===null)h[s[g]]=null;else if(c!==void 0)h[s[g]]=c;else if(l&&v===null)h[s[g]]=null;else continue;else h[s[g]]=l&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?v:br(x,v,o);v!=null&&(m=!1)}}return{row:h,isempty:m}}function iu(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},r=0,i=1,s=[],a=0,o="",u={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},l=c.range!=null?c.range:e["!ref"];switch(c.header===1?r=1:c.header==="A"?r=2:Array.isArray(c.header)?r=3:c.header==null&&(r=0),typeof l){case"string":u=ut(l);break;case"number":u=ut(e["!ref"]),u.s.r=l;break;default:u=l}r>0&&(i=0);var m=zt(u.s.r),h=[],g=[],x=0,v=0,w=Array.isArray(e),E=u.s.r,y=0,T={};w&&!e[E]&&(e[E]=[]);var C=c.skipHidden&&e["!cols"]||[],L=c.skipHidden&&e["!rows"]||[];for(y=u.s.c;y<=u.e.c;++y)if(!(C[y]||{}).hidden)switch(h[y]=Zt(y),n=w?e[E][y]:e[h[y]+m],r){case 1:s[y]=y-u.s.c;break;case 2:s[y]=h[y];break;case 3:s[y]=c.header[y-u.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),o=a=br(n,null,c),v=T[a]||0,!v)T[a]=1;else{do o=a+"_"+v++;while(T[o]);T[a]=v,T[o]=1}s[y]=o}for(E=u.s.r+i;E<=u.e.r;++E)if(!(L[E]||{}).hidden){var B=nR(e,u,E,h,r,s,w,c);(B.isempty===!1||(r===1?c.blankrows!==!1:c.blankrows))&&(g[x++]=B.row)}return g.length=x,g}var Th=/"/g;function rR(e,t,n,r,i,s,a,o){for(var u=!0,c=[],l="",m=zt(n),h=t.s.c;h<=t.e.c;++h)if(r[h]){var g=o.dense?(e[n]||[])[h]:e[r[h]+m];if(g==null)l="";else if(g.v!=null){u=!1,l=""+(o.rawNumbers&&g.t=="n"?g.v:br(g,null,o));for(var x=0,v=0;x!==l.length;++x)if((v=l.charCodeAt(x))===i||v===s||v===34||o.forceQuotes){l='"'+l.replace(Th,'""')+'"';break}l=="ID"&&(l='"ID"')}else g.f!=null&&!g.F?(u=!1,l="="+g.f,l.indexOf(",")>=0&&(l='"'+l.replace(Th,'""')+'"')):l="";c.push(l)}return o.blankrows===!1&&u?null:c.join(a)}function Xf(e,t){var n=[],r=t??{};if(e==null||e["!ref"]==null)return"";var i=ut(e["!ref"]),s=r.FS!==void 0?r.FS:",",a=s.charCodeAt(0),o=r.RS!==void 0?r.RS:`
`,u=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),l="",m=[];r.dense=Array.isArray(e);for(var h=r.skipHidden&&e["!cols"]||[],g=r.skipHidden&&e["!rows"]||[],x=i.s.c;x<=i.e.c;++x)(h[x]||{}).hidden||(m[x]=Zt(x));for(var v=0,w=i.s.r;w<=i.e.r;++w)(g[w]||{}).hidden||(l=rR(e,i,w,m,a,u,s,r),l!=null&&(r.strip&&(l=l.replace(c,"")),(l||r.blankrows!==!1)&&n.push((v++?o:"")+l)));return delete r.dense,n.join("")}function $v(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=Xf(e,t);return n}function iR(e){var t="",n,r="";if(e==null||e["!ref"]==null)return[];var i=ut(e["!ref"]),s="",a=[],o,u=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=Zt(o);for(var l=i.s.r;l<=i.e.r;++l)for(s=zt(l),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,n=c?(e[l]||[])[o]:e[t],r="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;r=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}u[u.length]=t+"="+r}return u}function Vv(e,t,n){var r=n||{},i=+!r.skipHeader,s=e||{},a=0,o=0;if(s&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var u=typeof r.origin=="string"?Mt(r.origin):r.origin;a=u.r,o=u.c}var c,l={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var m=ut(s["!ref"]);l.e.c=Math.max(l.e.c,m.e.c),l.e.r=Math.max(l.e.r,m.e.r),a==-1&&(a=m.e.r+1,l.e.r=a+t.length-1+i)}else a==-1&&(a=0,l.e.r=t.length-1+i);var h=r.header||[],g=0;t.forEach(function(v,w){Wt(v).forEach(function(E){(g=h.indexOf(E))==-1&&(h[g=h.length]=E);var y=v[E],T="z",C="",L=et({c:o+g,r:a+w+i});c=co(s,L),y&&typeof y=="object"&&!(y instanceof Date)?s[L]=y:(typeof y=="number"?T="n":typeof y=="boolean"?T="b":typeof y=="string"?T="s":y instanceof Date?(T="d",r.cellDates||(T="n",y=vn(y)),C=r.dateNF||vt[14]):y===null&&r.nullError&&(T="e",y=0),c?(c.t=T,c.v=y,delete c.w,delete c.R,C&&(c.z=C)):s[L]=c={t:T,v:y},C&&(c.z=C))})}),l.e.c=Math.max(l.e.c,o+h.length-1);var x=zt(a);if(i)for(g=0;g<h.length;++g)s[Zt(g+o)+x]={t:"s",v:h[g]};return s["!ref"]=wt(l),s}function sR(e,t){return Vv(null,e,t)}function co(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var r=Mt(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?co(e,et(t)):co(e,et({r:t,c:n||0}))}function aR(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function oR(){return{SheetNames:[],Sheets:{}}}function lR(e,t,n,r){var i=1;if(!n)for(;i<=65535&&e.SheetNames.indexOf(n="Sheet"+i)!=-1;++i,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||n;for(++i;i<=65535&&e.SheetNames.indexOf(n=a+i)!=-1;++i);}if(kv(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function uR(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=aR(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n}function cR(e,t){return e.z=t,e}function jv(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function dR(e,t,n){return jv(e,"#"+t,n)}function fR(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function pR(e,t,n,r){for(var i=typeof t!="string"?t:ut(t),s=typeof t=="string"?t:wt(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var u=co(e,a,o);u.t="n",u.F=s,delete u.v,a==i.s.r&&o==i.s.c&&(u.f=n,r&&(u.D=!0))}return e}var Dn={encode_col:Zt,encode_row:zt,encode_cell:et,encode_range:wt,decode_col:Gf,decode_row:Bf,split_cell:IS,decode_cell:Mt,decode_range:Rn,format_cell:br,sheet_add_aoa:V1,sheet_add_json:Vv,sheet_add_dom:Dv,aoa_to_sheet:Xs,json_to_sheet:sR,table_to_sheet:Lv,table_to_book:OI,sheet_to_csv:Xf,sheet_to_txt:$v,sheet_to_json:iu,sheet_to_html:Mv,sheet_to_formulae:iR,sheet_to_row_object_array:iu,sheet_get_cell:co,book_new:oR,book_append_sheet:lR,book_set_sheet_visibility:uR,cell_set_number_format:cR,cell_set_hyperlink:jv,cell_set_internal_link:dR,cell_add_comment:fR,sheet_set_array_formula:pR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const hR=(e,t)=>{const n=JSON.stringify(e);return`<!DOCTYPE html>
<html lang="${t}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${e.name} - NOZESia Key</title>
  <script src="https://cdn.tailwindcss.com"><\/script>
  <style>
    .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
  </style>
</head>
<body class="bg-slate-100 font-sans">
  <div id="app"></div>
  <script>
    const project = ${n};
    const lang = "${t}";
    const t = {
      en: {
        features: "Features", selected: "selected", matches: "Matches", discarded: "Discarded",
        restart: "Restart", noMatches: "No matches found.", tryUnselecting: "Try unselecting some features.",
        potential: "potential matches", identified: "1 Entity identified", close: "Close",
        speciesDetails: "Species Details", morphology: "Morphology & Traits", resources: "Resources",
        createdWith: "Created with NOZESia", viewResults: "View Results", excluded: "Excluded by selection",
        scientificName: "Scientific Name", family: "Family", taxonomy: "Taxonomy"
      },
      pt: {
        features: "Caractersticas", selected: "selecionado(s)", matches: "Compatveis", discarded: "Descartados",
        restart: "Reiniciar", noMatches: "Nenhum resultado.", tryUnselecting: "Tente remover selees.",
        potential: "matches potenciais", identified: "1 Entidade identificada", close: "Fechar",
        speciesDetails: "Detalhes da Espcie", morphology: "Morfologia & Caractersticas", resources: "Recursos Adicionais",
        createdWith: "Criado com NOZESia", viewResults: "Ver Resultados", excluded: "Excludo pela seleo",
        scientificName: "Nome Cientfico", family: "Famlia", taxonomy: "Taxonomia"
      }
    };
    const strings = t[lang];
    
    let selections = {};
    let showDiscarded = false;
    let viewingEntity = null;
    let viewingStateImage = null;
    let mobileTab = 'FILTERS';
    
    function toggleSelection(featureId, stateId) {
      if (!selections[featureId]) selections[featureId] = [];
      const idx = selections[featureId].indexOf(stateId);
      if (idx >= 0) {
        selections[featureId].splice(idx, 1);
        if (selections[featureId].length === 0) delete selections[featureId];
      } else {
        selections[featureId].push(stateId);
      }
      render();
    }
    
    function resetKey() { selections = {}; render(); }
    function setMobileTab(tab) { mobileTab = tab; render(); }
    function toggleDiscarded() { showDiscarded = !showDiscarded; render(); }
    function viewEntity(entity) { viewingEntity = entity; render(); }
    function closeEntity() { viewingEntity = null; render(); }
    function viewStateImage(url, label, featureName) { viewingStateImage = {url, label, featureName}; render(); }
    function closeStateImage() { viewingStateImage = null; render(); }
    
    function getFilteredEntities() {
      const remaining = [], discarded = [];
      project.entities.forEach(entity => {
        let isMatch = true;
        for (const [fid, sids] of Object.entries(selections)) {
          const entityStates = entity.traits[fid] || [];
          if (!sids.some(id => entityStates.includes(id))) { isMatch = false; break; }
        }
        if (isMatch) remaining.push(entity); else discarded.push(entity);
      });
      return { remaining, discarded };
    }
    
    function getTotalSelections() {
      return Object.values(selections).reduce((a, c) => a + c.length, 0);
    }
    
    function render() {
      const { remaining, discarded } = getFilteredEntities();
      const totalSel = getTotalSelections();
      
      let entityModalHTML = '';
      if (viewingEntity) {
        const e = viewingEntity;
        const traitsHTML = project.features.map(f => {
          const stateIds = e.traits[f.id] || [];
          const stateLabels = stateIds.map(sid => f.states.find(s => s.id === sid)?.label).filter(Boolean).join(', ');
          return stateLabels ? \`<div class="flex justify-between py-2 border-b border-slate-100"><span class="text-slate-500">\${f.name}</span><span class="font-medium text-slate-800">\${stateLabels}</span></div>\` : '';
        }).join('');
        const linksHTML = e.links && e.links.length > 0 ? \`<div class="mt-6"><h4 class="font-semibold text-slate-700 mb-3">\${strings.resources}</h4><div class="space-y-2">\${e.links.map(l => \`<a href="\${l.url}" target="_blank" class="flex items-center gap-2 text-emerald-600 hover:underline text-sm"><span></span>\${l.label}</a>\`).join('')}</div></div>\` : '';
        const taxonomyHTML = (e.scientificName || e.family) ? \`
          <div class="mt-4 p-3 bg-emerald-50 rounded-lg border border-emerald-100">
            <h4 class="font-semibold text-emerald-800 mb-2 text-sm flex items-center gap-1"> \${strings.taxonomy}</h4>
            \${e.scientificName ? \`<div class="flex justify-between py-1"><span class="text-emerald-600 text-sm">\${strings.scientificName}</span><span class="font-medium text-emerald-800 italic">\${e.scientificName}</span></div>\` : ''}
            \${e.family ? \`<div class="flex justify-between py-1"><span class="text-emerald-600 text-sm">\${strings.family}</span><span class="font-medium text-emerald-800">\${e.family}</span></div>\` : ''}
          </div>
        \` : '';
        entityModalHTML = \`
          <div class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4" onclick="if(event.target===this)closeEntity()">
            <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col">
              <div class="relative h-48 sm:h-64 bg-slate-200 shrink-0">
                \${e.imageUrl ? \`<img src="\${e.imageUrl}" class="w-full h-full object-cover" onerror="this.style.display='none'">\` : '<div class="w-full h-full flex items-center justify-center text-slate-400 text-6xl"></div>'}
                <button onclick="closeEntity()" class="absolute top-3 right-3 bg-black/40 hover:bg-black/60 text-white rounded-full p-2"></button>
              </div>
              <div class="p-6 overflow-y-auto custom-scrollbar">
                <h2 class="text-2xl font-bold text-slate-800 mb-1">\${e.name}</h2>
                \${e.scientificName && e.scientificName !== e.name ? \`<p class="text-slate-500 italic mb-2">\${e.scientificName}</p>\` : ''}
                \${e.family ? \`<span class="inline-block bg-emerald-100 text-emerald-700 text-xs px-2 py-1 rounded-full mb-3">\${e.family}</span>\` : ''}
                \${e.description ? \`<p class="text-slate-600 mb-4">\${e.description}</p>\` : ''}
                \${taxonomyHTML}
                <div class="mt-4"><h4 class="font-semibold text-slate-700 mb-2">\${strings.morphology}</h4><div class="text-sm">\${traitsHTML}</div></div>
                \${linksHTML}
              </div>
            </div>
          </div>
        \`;
      }
      
      // State Image Modal
      let stateImageModalHTML = '';
      if (viewingStateImage) {
        stateImageModalHTML = \`
          <div class="fixed inset-0 bg-black/80 z-[60] flex items-center justify-center p-4" onclick="if(event.target===this)closeStateImage()">
            <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full overflow-hidden" onclick="event.stopPropagation()">
              <div class="relative">
                <img src="\${viewingStateImage.url}" alt="\${viewingStateImage.label}" class="w-full max-h-[60vh] object-contain bg-slate-100">
                <button onclick="closeStateImage()" class="absolute top-3 right-3 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full transition-colors"></button>
              </div>
              <div class="p-4 bg-white">
                <h4 class="font-semibold text-slate-800">\${viewingStateImage.label}</h4>
                <p class="text-sm text-slate-500">\${viewingStateImage.featureName}</p>
              </div>
            </div>
          </div>
        \`;
      }
      
      const featuresHTML = project.features.map(f => {
        const selStates = selections[f.id] || [];
        return \`
          <div class="bg-slate-50 rounded-xl p-4">
            <h4 class="font-semibold text-slate-700 mb-3 flex items-center gap-2">
              \${f.imageUrl ? \`<img src="\${f.imageUrl}" class="w-6 h-6 rounded object-cover">\` : ''}
              \${f.name}
              \${selStates.length > 0 ? \`<span class="ml-auto text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full">\${selStates.length}</span>\` : ''}
            </h4>
            <div class="flex flex-wrap gap-2">
              \${f.states.map(s => {
                const isSel = selStates.includes(s.id);
                const hasImg = s.imageUrl ? true : false;
                return \`<div class="flex items-center gap-1">
                  \${hasImg ? \`<button onclick="viewStateImage('\${s.imageUrl}', '\${s.label.replace(/'/g, "\\\\'")}', '\${f.name.replace(/'/g, "\\\\'")}')" class="w-6 h-6 rounded overflow-hidden border border-slate-200 hover:border-emerald-400 transition-colors shrink-0" title="Ver imagem"><img src="\${s.imageUrl}" class="w-full h-full object-cover"></button>\` : ''}
                  <button onclick="toggleSelection('\${f.id}','\${s.id}')" class="px-3 py-1.5 rounded-lg text-sm font-medium transition-all \${isSel ? 'bg-emerald-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-100 border border-slate-200'}">\${s.label}</button>
                </div>\`;
              }).join('')}
            </div>
          </div>
        \`;
      }).join('');
      
      const entityCard = (e, isDiscarded = false) => \`
        <div onclick="viewEntity(project.entities.find(x=>x.id==='\${e.id}'))" class="bg-white rounded-xl shadow-sm hover:shadow-lg transition-all cursor-pointer overflow-hidden border \${isDiscarded ? 'border-red-200 opacity-60' : 'border-slate-200 hover:border-emerald-300'}">
          <div class="h-32 bg-slate-100 relative">
            \${e.imageUrl ? \`<img src="\${e.imageUrl}" class="w-full h-full object-cover" onerror="this.parentElement.innerHTML='<div class=\\\\'w-full h-full flex items-center justify-center text-slate-300 text-4xl\\\\'></div>'">\` : '<div class="w-full h-full flex items-center justify-center text-slate-300 text-4xl"></div>'}
            \${isDiscarded ? '<div class="absolute inset-0 bg-red-500/20 flex items-center justify-center"><span class="bg-red-500 text-white text-xs px-2 py-1 rounded"></span></div>' : ''}
            \${e.family ? \`<span class="absolute top-2 left-2 bg-emerald-600/90 text-white text-[10px] px-1.5 py-0.5 rounded">\${e.family}</span>\` : ''}
          </div>
          <div class="p-3">
            <h4 class="font-semibold text-slate-800 text-sm truncate">\${e.name}</h4>
            \${e.scientificName && e.scientificName !== e.name ? \`<p class="text-xs text-slate-400 italic truncate">\${e.scientificName}</p>\` : ''}
            \${e.description ? \`<p class="text-xs text-slate-500 mt-1 line-clamp-2">\${e.description}</p>\` : ''}
          </div>
        </div>
      \`;
      
      const remainingHTML = remaining.length > 0 
        ? remaining.map(e => entityCard(e)).join('')
        : \`<div class="col-span-full text-center py-12 text-slate-500"><div class="text-4xl mb-3"></div><p class="font-medium">\${strings.noMatches}</p><p class="text-sm">\${strings.tryUnselecting}</p></div>\`;
      
      const discardedHTML = discarded.length > 0 && showDiscarded
        ? \`<div class="mt-6 pt-6 border-t"><h4 class="font-semibold text-slate-500 mb-4 flex items-center gap-2"> \${strings.discarded} (\${discarded.length})</h4><div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">\${discarded.map(e => entityCard(e, true)).join('')}</div></div>\`
        : '';
      
      document.getElementById('app').innerHTML = \`
        <div class="min-h-screen flex flex-col">
          <header class="bg-white border-b px-4 py-3 flex justify-between items-center shadow-sm">
            <div class="flex items-center gap-3">
              <span class="bg-emerald-600 text-white text-xs px-2 py-1 rounded font-bold">KEY</span>
              <h1 class="text-lg font-bold text-slate-800 truncate">\${project.name}</h1>
            </div>
            <button onclick="resetKey()" class="flex items-center gap-2 px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg"> \${strings.restart}</button>
          </header>
          
          <div class="md:hidden flex border-b bg-white">
            <button onclick="setMobileTab('FILTERS')" class="flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 \${mobileTab==='FILTERS'?'text-emerald-600 border-b-2 border-emerald-600':'text-slate-500 bg-slate-50'}">
               \${strings.features} \${totalSel>0?\`<span class="bg-emerald-600 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center">\${totalSel}</span>\`:''}
            </button>
            <button onclick="setMobileTab('RESULTS')" class="flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 \${mobileTab==='RESULTS'?'text-emerald-600 border-b-2 border-emerald-600':'text-slate-500 bg-slate-50'}">
               \${strings.matches} <span class="bg-slate-200 text-slate-700 text-xs px-1.5 py-0.5 rounded-full">\${remaining.length}</span>
            </button>
          </div>
          
          <div class="flex-1 flex flex-col md:flex-row overflow-hidden">
            <div class="w-full md:w-1/3 lg:w-1/4 bg-white md:border-r flex-col h-full \${mobileTab==='FILTERS'?'flex':'hidden md:flex'}">
              <div class="hidden md:block p-4 border-b bg-slate-50">
                <h3 class="font-semibold text-slate-700 flex items-center gap-2"> \${strings.features}</h3>
              </div>
              <div class="flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar">\${featuresHTML}</div>
            </div>
            
            <div class="flex-1 flex flex-col h-full \${mobileTab==='RESULTS'?'flex':'hidden md:flex'}">
              <div class="p-4 border-b bg-slate-50 flex justify-between items-center">
                <div>
                  <span class="font-semibold text-slate-700">\${remaining.length === 1 ? strings.identified : remaining.length + ' ' + strings.potential}</span>
                </div>
                \${discarded.length > 0 ? \`<button onclick="toggleDiscarded()" class="text-sm text-slate-500 hover:text-slate-700 flex items-center gap-1">\${showDiscarded?'':''} \${strings.discarded} (\${discarded.length})</button>\` : ''}
              </div>
              <div class="flex-1 overflow-y-auto p-4 custom-scrollbar">
                <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">\${remainingHTML}</div>
                \${discardedHTML}
              </div>
            </div>
          </div>
          
          <footer class="bg-white border-t px-4 py-2 text-center text-xs text-slate-400">
            \${strings.createdWith}  <a href="https://djhandoom.github.io/nozes/" target="_blank" class="text-emerald-600 hover:underline">djhandoom.github.io/nozes</a>
          </footer>
        </div>
        \${entityModalHTML}
        \${stateImageModalHTML}
      \`;
    }
    
    render();
  <\/script>
</body>
</html>`},mR={en:{player:"PLAYER",restart:"Restart",exit:"Exit",features:"Features",selected:"selected",matches:"Matches",discarded:"Discarded",identified:"1 Entity identified",potential:"potential matches",excluded:"Excluded by selection",noMatches:"No matches found.",tryUnselecting:"Try unselecting some features.",speciesDetails:"Species Details",morphology:"Morphology & Traits",close:"Close",resources:"Resources",viewResults:"View Results",openSaved:"Open",editKey:"Edit",exportJson:"JSON",exportXlsx:"XLSX",exportHtml:"HTML"},pt:{player:"PLAYER",restart:"Reiniciar",exit:"Sair",features:"Caractersticas",selected:"selecionado(s)",matches:"Compatveis",discarded:"Descartados",identified:"1 Entidade identificada",potential:"matches potenciais",excluded:"Excludo pela seleo",noMatches:"Nenhum resultado.",tryUnselecting:"Tente remover selees.",speciesDetails:"Detalhes da Espcie",morphology:"Morfologia & Caractersticas",close:"Fechar",resources:"Recursos Adicionais",viewResults:"Ver Resultados",openSaved:"Abrir",editKey:"Editar",exportJson:"JSON",exportXlsx:"XLSX",exportHtml:"HTML"}},gR=({project:e,onBack:t,language:n,onOpenSaved:r,onEditKey:i})=>{const s=mR[n],[a,o]=Ie.useState({}),[u,c]=Ie.useState(!1),[l,m]=Ie.useState(null),[h,g]=Ie.useState(null),[x,v]=Ie.useState(null),[w,E]=Ie.useState("FILTERS"),y=(k,z)=>{o(X=>{const ne=X[k]||[],Fe=ne.includes(z);let q;if(Fe?q=ne.filter(ue=>ue!==z):q=[...ne,z],q.length===0){const{[k]:ue,...ke}=X;return ke}return{...X,[k]:q}})},T=()=>o({}),{remaining:C,discarded:L}=Ie.useMemo(()=>{const k=[],z=[];return e.entities.forEach(X=>{let ne=!0;for(const[Fe,q]of Object.entries(a)){const ue=X.traits[Fe]||[];if(!q.some(se=>ue.includes(se))){ne=!1;break}}ne?k.push(X):z.push(X)}),{remaining:k,discarded:z}},[e.entities,a]),B=Object.values(a).reduce((k,z)=>k+z.length,0),R=()=>{const k=JSON.stringify(e,null,2),z=new Blob([k],{type:"application/json"}),X=URL.createObjectURL(z),ne=document.createElement("a");ne.href=X,ne.download=`${e.name.replace(/\s+/g,"_")}.json`,ne.click(),URL.revokeObjectURL(X)},O=()=>{new Map(e.features.map(q=>[q.id,q]));const k=["Entity",...e.features.map(q=>q.name)],z=e.entities.map(q=>{const ue=[q.name];return e.features.forEach(ke=>{const ae=(q.traits[ke.id]||[]).map(ce=>{var Ce;return((Ce=ke.states.find(D=>D.id===ce))==null?void 0:Ce.label)||""}).filter(Boolean).join(", ");ue.push(ae)}),ue}),X=[k,...z],ne=Dn.aoa_to_sheet(X),Fe=Dn.book_new();Dn.book_append_sheet(Fe,ne,"Matrix"),Gv(Fe,`${e.name.replace(/\s+/g,"_")}.xlsx`)},M=()=>{const k=hR(e,n),z=new Blob([k],{type:"text/html;charset=utf-8"}),X=URL.createObjectURL(z),ne=document.createElement("a");ne.href=X,ne.download=`${e.name.replace(/\s+/g,"_")}.html`,ne.click(),URL.revokeObjectURL(X)};return f.jsxs("div",{className:"flex flex-col h-full bg-slate-100 font-sans absolute inset-0",children:[f.jsxs("header",{className:"bg-white border-b px-4 py-3 flex justify-between items-center shadow-sm z-30 shrink-0",children:[f.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[f.jsx("button",{onClick:t,className:"md:hidden p-2 -ml-2 text-slate-500 hover:bg-slate-100 rounded-full",children:f.jsx(Sp,{size:20})}),f.jsx("div",{className:"overflow-hidden",children:f.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2 truncate",children:[f.jsx("span",{className:"hidden sm:inline-block bg-emerald-600 text-white text-xs px-2 py-1 rounded",children:s.player}),f.jsx("span",{className:"truncate",children:e.name})]})})]}),f.jsxs("div",{className:"flex gap-1 sm:gap-2 shrink-0",children:[r&&f.jsxs("button",{onClick:r,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",title:s.openSaved,children:[f.jsx(bs,{size:18})," ",f.jsx("span",{className:"hidden lg:inline",children:s.openSaved})]}),i&&f.jsxs("button",{onClick:i,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",title:s.editKey,children:[f.jsx(ST,{size:18})," ",f.jsx("span",{className:"hidden lg:inline",children:s.editKey})]}),f.jsxs("button",{onClick:R,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",title:s.exportJson,children:[f.jsx(gd,{size:18})," ",f.jsx("span",{className:"hidden lg:inline",children:s.exportJson})]}),f.jsxs("button",{onClick:O,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",title:s.exportXlsx,children:[f.jsx(xd,{size:18})," ",f.jsx("span",{className:"hidden lg:inline",children:s.exportXlsx})]}),f.jsxs("button",{onClick:M,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-purple-600 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",title:s.exportHtml,children:[f.jsx($l,{size:18})," ",f.jsx("span",{className:"hidden lg:inline",children:s.exportHtml})]}),f.jsxs("button",{onClick:T,className:"flex items-center gap-1 px-2 sm:px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",title:s.restart,children:[f.jsx(ET,{size:18})," ",f.jsx("span",{className:"hidden lg:inline",children:s.restart})]}),f.jsxs("button",{onClick:t,className:"hidden md:flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-600 hover:text-slate-900 transition-colors",children:[f.jsx(Sp,{size:16})," ",s.exit]})]})]}),f.jsxs("div",{className:"md:hidden flex border-b bg-white z-20 shrink-0",children:[f.jsxs("button",{onClick:()=>E("FILTERS"),className:`flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 transition-colors relative ${w==="FILTERS"?"text-emerald-600":"text-slate-500 bg-slate-50"}`,children:[f.jsx(fc,{size:16}),s.features,B>0&&f.jsx("span",{className:"bg-emerald-600 text-white text-[10px] w-5 h-5 flex items-center justify-center rounded-full",children:B}),w==="FILTERS"&&f.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-600"})]}),f.jsxs("button",{onClick:()=>E("RESULTS"),className:`flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 transition-colors relative ${w==="RESULTS"?"text-emerald-600":"text-slate-500 bg-slate-50"}`,children:[f.jsx(o1,{size:16}),s.matches,f.jsx("span",{className:"bg-slate-200 text-slate-700 text-[10px] px-1.5 py-0.5 rounded-full font-bold",children:C.length}),w==="RESULTS"&&f.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-600"})]})]}),f.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row relative",children:[f.jsxs("div",{className:`w-full md:w-1/3 lg:w-1/4 bg-white md:border-r flex flex-col h-full relative z-20 ${w==="FILTERS"?"flex":"hidden md:flex"}`,children:[f.jsx("div",{className:"hidden md:block p-4 border-b bg-slate-50",children:f.jsxs("h3",{className:"font-semibold text-slate-700 flex items-center gap-2",children:[f.jsx(fc,{size:18})," ",s.features]})}),f.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 pb-24 md:pb-4 custom-scrollbar",children:e.features.map(k=>{const z=a[k.id]||[],X=z.length>0;return f.jsxs("div",{className:"space-y-2 relative",children:[f.jsxs("div",{className:"flex justify-between items-center sticky top-0 bg-white/95 backdrop-blur-sm py-1 z-10",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("h4",{className:`font-medium ${X?"text-emerald-600":"text-slate-700"}`,children:k.name}),k.imageUrl&&f.jsx(f.Fragment,{children:f.jsx("button",{className:"text-slate-400 hover:text-emerald-500 transition-colors p-1",onClick:ne=>{ne.stopPropagation(),m(l===k.id?null:k.id)},children:f.jsx(Ts,{size:14})})})]}),X&&f.jsx("span",{className:"text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full",children:z.length})]}),l===k.id&&k.imageUrl&&f.jsxs("div",{className:"mb-2 rounded-lg overflow-hidden border border-slate-200 shadow-sm animate-in fade-in zoom-in-95",children:[f.jsx("img",{src:k.imageUrl,alt:k.name,className:"w-full h-32 object-cover"}),f.jsx("div",{className:"bg-slate-50 p-1 text-center",children:f.jsx("button",{onClick:()=>m(null),className:"text-xs text-slate-500 underline",children:"Fechar"})})]}),f.jsx("div",{className:"grid grid-cols-1 gap-1",children:k.states.map(ne=>{const Fe=z.includes(ne.id);return f.jsxs("div",{className:"flex items-center gap-1",children:[ne.imageUrl&&f.jsx("button",{onClick:q=>{q.stopPropagation(),v({url:ne.imageUrl,label:ne.label,featureName:k.name})},className:"w-8 h-8 rounded overflow-hidden border border-slate-200 hover:border-emerald-400 transition-colors shrink-0",title:n==="pt"?"Ver imagem":"View image",children:f.jsx("img",{src:ne.imageUrl,alt:ne.label,className:"w-full h-full object-cover"})}),f.jsxs("button",{onClick:()=>y(k.id,ne.id),className:`flex-1 text-left px-3 py-3 md:py-2 text-sm rounded-lg transition-all flex items-center justify-between group active:scale-[0.98] touch-manipulation ${Fe?"bg-emerald-600 text-white shadow-md":"bg-slate-50 text-slate-600 border border-transparent hover:bg-slate-100 hover:border-slate-200"}`,children:[f.jsx("span",{className:"leading-tight",children:ne.label}),Fe&&f.jsx(a1,{size:16,className:"shrink-0"})]})]},ne.id)})})]},k.id)})}),f.jsx("div",{className:"md:hidden absolute bottom-4 left-4 right-4 z-30",children:f.jsxs("button",{onClick:()=>E("RESULTS"),className:"w-full bg-slate-900 text-white font-bold py-3 rounded-xl shadow-lg shadow-slate-900/20 flex items-center justify-center gap-2 animate-in slide-in-from-bottom-5",children:[s.viewResults," (",C.length,")"]})})]}),f.jsxs("div",{className:`flex-1 bg-slate-100 flex-col h-full overflow-hidden ${w==="RESULTS"?"flex":"hidden md:flex"}`,children:[f.jsxs("div",{className:"p-3 md:p-4 bg-white border-b flex justify-between items-center shadow-sm shrink-0",children:[f.jsxs("div",{className:"flex gap-2 md:gap-4 w-full md:w-auto bg-slate-100 p-1 rounded-lg",children:[f.jsxs("button",{className:`flex-1 md:flex-none text-xs md:text-sm font-medium px-3 py-1.5 rounded-md transition-all ${u?"text-slate-500":"bg-white text-slate-800 shadow-sm"}`,onClick:()=>c(!1),children:[s.matches," (",C.length,")"]}),f.jsxs("button",{className:`flex-1 md:flex-none text-xs md:text-sm font-medium px-3 py-1.5 rounded-md transition-all ${u?"bg-white text-slate-800 shadow-sm":"text-slate-500"}`,onClick:()=>c(!0),children:[s.discarded," (",L.length,")"]})]}),f.jsx("div",{className:"text-xs text-slate-400 hidden sm:block",children:C.length===1?s.identified:`${C.length} ${s.potential}`})]}),f.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 custom-scrollbar",onClick:()=>m(null),children:f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 pb-20 md:pb-0",children:[(u?L:C).map(k=>f.jsxs("div",{onClick:()=>g(k),className:`bg-white rounded-xl overflow-hidden shadow-sm hover:shadow-lg transition-all border cursor-pointer active:scale-[0.98] touch-manipulation ${u?"opacity-60 grayscale":""}`,children:[f.jsxs("div",{className:"h-48 md:h-40 bg-slate-200 relative group",children:[f.jsx("img",{src:k.imageUrl||"https://picsum.photos/400/300",alt:k.name,className:"w-full h-full object-cover",loading:"lazy"}),f.jsxs("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2 text-white font-medium",children:[f.jsx(Cp,{size:20})," ",f.jsx("span",{className:"hidden md:inline",children:"Ver Detalhes"})]}),f.jsx("div",{className:"md:hidden absolute bottom-2 right-2 bg-black/50 text-white p-1.5 rounded-full backdrop-blur-sm",children:f.jsx(Cp,{size:16})})]}),f.jsxs("div",{className:"p-4",children:[f.jsxs("h3",{className:"font-bold text-slate-800 text-lg mb-1 flex justify-between items-center",children:[k.name,f.jsx(l1,{size:16,className:"text-slate-300"})]}),(k.scientificName||k.family)&&f.jsxs("p",{className:"text-xs text-slate-400 italic mb-1",children:[k.scientificName,k.scientificName&&k.family?"  ":"",k.family]}),f.jsx("p",{className:"text-slate-500 text-xs line-clamp-3",children:k.description}),u&&f.jsxs("div",{className:"mt-3 pt-2 border-t border-slate-100 text-xs text-red-500 flex items-center gap-1",children:[f.jsx(Bt,{size:12})," ",s.excluded]})]})]},k.id)),!u&&C.length===0&&f.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-20 text-slate-400 px-4 text-center",children:[f.jsx(fc,{size:48,className:"mb-4 opacity-50"}),f.jsx("p",{className:"text-lg font-medium text-slate-600",children:s.noMatches}),f.jsx("p",{className:"text-sm",children:s.tryUnselecting}),f.jsx("button",{onClick:T,className:"mt-6 px-6 py-2 bg-slate-200 text-slate-700 rounded-lg font-medium hover:bg-slate-300",children:s.restart})]})]})})]})]}),h&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-0 md:p-4 animate-in fade-in duration-200",children:f.jsxs("div",{className:"bg-white md:rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col h-full md:h-auto md:max-h-[90vh] overflow-hidden",children:[f.jsxs("div",{className:"relative h-64 md:h-64 shrink-0 bg-slate-900",children:[h.imageUrl?f.jsx("img",{src:h.imageUrl,className:"w-full h-full object-cover opacity-90",alt:h.name}):f.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-600 bg-slate-200",children:f.jsx(Ts,{size:48})}),f.jsx("button",{onClick:()=>g(null),className:"absolute top-4 right-4 bg-black/40 hover:bg-black/60 text-white p-2 rounded-full transition-colors z-10 backdrop-blur-sm",children:f.jsx(Bt,{size:24})}),f.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 via-black/50 to-transparent p-6 pt-12",children:[f.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white shadow-sm leading-tight",children:h.name}),(h.scientificName||h.family)&&f.jsxs("p",{className:"text-white/80 italic text-sm md:text-base mt-1",children:[h.scientificName,h.scientificName&&h.family?"  ":"",h.family]})]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8 custom-scrollbar bg-white",children:[f.jsxs("div",{children:[f.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-3",children:[f.jsx(rT,{size:14})," ",s.speciesDetails]}),f.jsx("p",{className:"text-slate-800 leading-relaxed text-base md:text-lg font-serif",children:h.description})]}),h.links&&h.links.length>0&&f.jsxs("div",{children:[f.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-3",children:[f.jsx(yd,{size:14})," ",s.resources]}),f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:h.links.map((k,z)=>f.jsxs("a",{href:k.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 rounded-lg border border-slate-200 bg-slate-50 hover:bg-slate-100 hover:border-emerald-300 transition-all group active:scale-[0.98]",children:[f.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm text-slate-400 group-hover:text-emerald-600",children:f.jsx(Gl,{size:16})}),f.jsx("span",{className:"text-sm font-medium text-slate-700 group-hover:text-emerald-700 truncate flex-1",children:k.label||k.url})]},z))})]}),f.jsx("div",{className:"border-t border-slate-100"}),f.jsxs("div",{children:[f.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-4",children:[f.jsx(wT,{size:14})," ",s.morphology]}),f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4",children:e.features.map(k=>{const z=h.traits[k.id];if(!z||z.length===0)return null;const X=z.map(ne=>{const Fe=k.states.find(q=>q.id===ne);return Fe?Fe.label:"?"}).join(", ");return f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 flex flex-col",children:[f.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:k.name}),f.jsx("span",{className:"text-sm font-semibold text-slate-800",children:X})]},k.id)})}),Object.keys(h.traits).length===0&&f.jsx("p",{className:"text-slate-400 text-sm italic",children:"Nenhuma caracterstica registrada."})]})]}),f.jsx("div",{className:"p-4 border-t bg-slate-50 shrink-0 safe-area-bottom",children:f.jsx("button",{onClick:()=>g(null),className:"w-full py-3 bg-slate-900 text-white font-bold rounded-xl hover:bg-slate-800 transition-colors shadow-lg",children:s.close})})]})}),x&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[60] flex items-center justify-center p-4",onClick:()=>v(null),children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full overflow-hidden animate-in fade-in zoom-in-95",onClick:k=>k.stopPropagation(),children:[f.jsxs("div",{className:"relative",children:[f.jsx("img",{src:x.url,alt:x.label,className:"w-full max-h-[60vh] object-contain bg-slate-100"}),f.jsx("button",{onClick:()=>v(null),className:"absolute top-3 right-3 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full transition-colors",children:f.jsx(Bt,{size:18})})]}),f.jsxs("div",{className:"p-4 bg-white",children:[f.jsx("h4",{className:"font-semibold text-slate-800",children:x.label}),f.jsx("p",{className:"text-sm text-slate-500",children:x.featureName})]})]})})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let xR,vR;function yR(){return{geminiUrl:xR,vertexUrl:vR}}function ER(e,t,n,r){var i,s;if(!(e!=null&&e.baseUrl)){const a=yR();return t?(i=a.vertexUrl)!==null&&i!==void 0?i:n:(s=a.geminiUrl)!==null&&s!==void 0?s:r}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Dr{}function _e(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(t,i)){const s=t[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function p(e,t,n){for(let s=0;s<t.length-1;s++){const a=t[s];if(a.endsWith("[]")){const o=a.slice(0,-2);if(!(o in e))if(Array.isArray(n))e[o]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(e[o])){const u=e[o];if(Array.isArray(n))for(let c=0;c<u.length;c++){const l=u[c];p(l,t.slice(s+1),n[c])}else for(const c of u)p(c,t.slice(s+1),n)}return}else if(a.endsWith("[0]")){const o=a.slice(0,-3);o in e||(e[o]=[{}]);const u=e[o];p(u[0],t.slice(s+1),n);return}(!e[a]||typeof e[a]!="object")&&(e[a]={}),e=e[a]}const r=t[t.length-1],i=e[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(e,n):e[r]=n}function d(e,t,n=void 0){try{if(t.length===1&&t[0]==="_self")return e;for(let r=0;r<t.length;r++){if(typeof e!="object"||e===null)return n;const i=t[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in e){const a=e[s];return Array.isArray(a)?a.map(o=>d(o,t.slice(r+1),n)):n}else return n}else e=e[i]}return e}catch(r){if(r instanceof TypeError)return n;throw r}}function TR(e,t){for(const[n,r]of Object.entries(t)){const i=n.split("."),s=r.split("."),a=new Set;let o=-1;for(let u=0;u<i.length;u++)if(i[u]==="*"){o=u;break}if(o!==-1&&s.length>o)for(let u=o;u<s.length;u++){const c=s[u];c!=="*"&&!c.endsWith("[]")&&!c.endsWith("[0]")&&a.add(c)}Cd(e,i,s,0,a)}}function Cd(e,t,n,r,i){if(r>=t.length||typeof e!="object"||e===null)return;const s=t[r];if(s.endsWith("[]")){const a=s.slice(0,-2),o=e;if(a in o&&Array.isArray(o[a]))for(const u of o[a])Cd(u,t,n,r+1,i)}else if(s==="*"){if(typeof e=="object"&&e!==null&&!Array.isArray(e)){const a=e,o=Object.keys(a).filter(c=>!c.startsWith("_")&&!i.has(c)),u={};for(const c of o)u[c]=a[c];for(const[c,l]of Object.entries(u)){const m=[];for(const h of n.slice(r))h==="*"?m.push(c):m.push(h);p(a,m,l)}for(const c of o)delete a[c]}}else{const a=e;s in a&&Cd(a[s],t,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qf(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SR(e){const t={},n=d(e,["operationName"]);n!=null&&p(t,["operationName"],n);const r=d(e,["resourceName"]);return r!=null&&p(t,["_url","resourceName"],r),t}function wR(e){const t={},n=d(e,["name"]);n!=null&&p(t,["name"],n);const r=d(e,["metadata"]);r!=null&&p(t,["metadata"],r);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["response","generateVideoResponse"]);return a!=null&&p(t,["response"],CR(a)),t}function _R(e){const t={},n=d(e,["name"]);n!=null&&p(t,["name"],n);const r=d(e,["metadata"]);r!=null&&p(t,["metadata"],r);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["response"]);return a!=null&&p(t,["response"],NR(a)),t}function CR(e){const t={},n=d(e,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>AR(a))),p(t,["generatedVideos"],s)}const r=d(e,["raiMediaFilteredCount"]);r!=null&&p(t,["raiMediaFilteredCount"],r);const i=d(e,["raiMediaFilteredReasons"]);return i!=null&&p(t,["raiMediaFilteredReasons"],i),t}function NR(e){const t={},n=d(e,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>IR(a))),p(t,["generatedVideos"],s)}const r=d(e,["raiMediaFilteredCount"]);r!=null&&p(t,["raiMediaFilteredCount"],r);const i=d(e,["raiMediaFilteredReasons"]);return i!=null&&p(t,["raiMediaFilteredReasons"],i),t}function AR(e){const t={},n=d(e,["video"]);return n!=null&&p(t,["video"],MR(n)),t}function IR(e){const t={},n=d(e,["_self"]);return n!=null&&p(t,["video"],DR(n)),t}function RR(e){const t={},n=d(e,["operationName"]);return n!=null&&p(t,["_url","operationName"],n),t}function kR(e){const t={},n=d(e,["operationName"]);return n!=null&&p(t,["_url","operationName"],n),t}function bR(e){const t={},n=d(e,["name"]);n!=null&&p(t,["name"],n);const r=d(e,["metadata"]);r!=null&&p(t,["metadata"],r);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["response"]);return a!=null&&p(t,["response"],FR(a)),t}function FR(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["parent"]);r!=null&&p(t,["parent"],r);const i=d(e,["documentName"]);return i!=null&&p(t,["documentName"],i),t}function Hv(e){const t={},n=d(e,["name"]);n!=null&&p(t,["name"],n);const r=d(e,["metadata"]);r!=null&&p(t,["metadata"],r);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["response"]);return a!=null&&p(t,["response"],PR(a)),t}function PR(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["parent"]);r!=null&&p(t,["parent"],r);const i=d(e,["documentName"]);return i!=null&&p(t,["documentName"],i),t}function MR(e){const t={},n=d(e,["uri"]);n!=null&&p(t,["uri"],n);const r=d(e,["encodedVideo"]);r!=null&&p(t,["videoBytes"],Qf(r));const i=d(e,["encoding"]);return i!=null&&p(t,["mimeType"],i),t}function DR(e){const t={},n=d(e,["gcsUri"]);n!=null&&p(t,["uri"],n);const r=d(e,["bytesBase64Encoded"]);r!=null&&p(t,["videoBytes"],Qf(r));const i=d(e,["mimeType"]);return i!=null&&p(t,["mimeType"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Sh;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Sh||(Sh={}));var wh;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(wh||(wh={}));var _h;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(_h||(_h={}));var Ae;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(Ae||(Ae={}));var Ch;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(Ch||(Ch={}));var Nh;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Nh||(Nh={}));var Ah;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(Ah||(Ah={}));var Ih;(function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Ih||(Ih={}));var Rh;(function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Rh||(Rh={}));var kh;(function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.HIGH="HIGH"})(kh||(kh={}));var bh;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(bh||(bh={}));var Fh;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(Fh||(Fh={}));var Ph;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(Ph||(Ph={}));var Mh;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE"})(Mh||(Mh={}));var Dh;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(Dh||(Dh={}));var Lh;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Lh||(Lh={}));var Oh;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Oh||(Oh={}));var Uh;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"})(Uh||(Uh={}));var Bh;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Bh||(Bh={}));var su;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(su||(su={}));var Gh;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Gh||(Gh={}));var $h;(function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})($h||($h={}));var Vh;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Vh||(Vh={}));var Nd;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Nd||(Nd={}));var jh;(function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"})(jh||(jh={}));var Hh;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Hh||(Hh={}));var zh;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(zh||(zh={}));var qh;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(qh||(qh={}));var Wh;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(Wh||(Wh={}));var Jh;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Jh||(Jh={}));var Yh;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"})(Yh||(Yh={}));var Kh;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(Kh||(Kh={}));var Xh;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(Xh||(Xh={}));var Qh;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(Qh||(Qh={}));var Zh;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Zh||(Zh={}));var em;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(em||(em={}));var tm;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(tm||(tm={}));var nm;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(nm||(nm={}));var rm;(function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"})(rm||(rm={}));var im;(function(e){e.ASSET="ASSET",e.STYLE="STYLE"})(im||(im={}));var sm;(function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"})(sm||(sm={}));var am;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(am||(am={}));var om;(function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING"})(om||(om={}));var lm;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"})(lm||(lm={}));var um;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(um||(um={}));var cm;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(cm||(cm={}));var dm;(function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"})(dm||(dm={}));var fm;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(fm||(fm={}));var pm;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(pm||(pm={}));var hm;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(hm||(hm={}));var mm;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(mm||(mm={}));var gm;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(gm||(gm={}));var xm;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(xm||(xm={}));var vm;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})(vm||(vm={}));var ws;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(ws||(ws={}));class Ad{constructor(t){const n={};for(const r of t.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class va{get text(){var t,n,r,i,s,a,o,u;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",l=!1;const m=[];for(const h of(u=(o=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)!==null&&u!==void 0?u:[]){for(const[g,x]of Object.entries(h))g!=="text"&&g!=="thought"&&g!=="thoughtSignature"&&(x!==null||x!==void 0)&&m.push(g);if(typeof h.text=="string"){if(typeof h.thought=="boolean"&&h.thought)continue;l=!0,c+=h.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?c:void 0}get data(){var t,n,r,i,s,a,o,u;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const l=[];for(const m of(u=(o=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)!==null&&u!==void 0?u:[]){for(const[h,g]of Object.entries(m))h!=="inlineData"&&(g!==null||g!==void 0)&&l.push(h);m.inlineData&&typeof m.inlineData.data=="string"&&(c+=atob(m.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var t,n,r,i,s,a,o,u;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(u=(o=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||u===void 0?void 0:u.filter(l=>l.functionCall).map(l=>l.functionCall).filter(l=>l!==void 0);if((c==null?void 0:c.length)!==0)return c}get executableCode(){var t,n,r,i,s,a,o,u,c;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const l=(u=(o=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||u===void 0?void 0:u.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((l==null?void 0:l.length)!==0)return(c=l==null?void 0:l[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var t,n,r,i,s,a,o,u,c;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const l=(u=(o=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||u===void 0?void 0:u.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((l==null?void 0:l.length)!==0)return(c=l==null?void 0:l[0])===null||c===void 0?void 0:c.output}}class ym{}class Em{}class LR{}class OR{}class UR{}class BR{}class Tm{}class Sm{}class wm{}class GR{}class au{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new au;let i;const s=t;return n?i=_R(s):i=wR(s),Object.assign(r,i),r}}class _m{}class Cm{}class Nm{}class $R{}class VR{}class jR{}class Zf{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new Zf,s=bR(t);return Object.assign(r,s),r}}class HR{}class zR{}class qR{}class Am{}class WR{get text(){var t,n,r;let i="",s=!1;const a=[];for(const o of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[u,c]of Object.entries(o))u!=="text"&&u!=="thought"&&c!==null&&a.push(u);if(typeof o.text=="string"){if(typeof o.thought=="boolean"&&o.thought)continue;s=!0,i+=o.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var t,n,r;let i="";const s=[];for(const a of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[o,u]of Object.entries(a))o!=="inlineData"&&u!==null&&s.push(o);a.inlineData&&typeof a.inlineData.data=="string"&&(i+=atob(a.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class JR{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class e0{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new e0,s=Hv(t);return Object.assign(r,s),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Je(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function zv(e,t){const n=Je(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function qv(e){return Array.isArray(e)?e.map(t=>ou(t)):[ou(e)]}function ou(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function Wv(e){const t=ou(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Jv(e){const t=ou(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Im(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function Yv(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>Im(t)):[Im(e)]}function Id(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function Rm(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function km(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Qt(e){if(e==null)throw new Error("ContentUnion is required");return Id(e)?e:{role:"user",parts:Yv(e)}}function t0(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const r=Qt(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const n=Qt(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>Qt(n)):[Qt(t)]}function $n(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(Rm(e)||km(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Qt(e)]}const t=[],n=[],r=Id(e[0]);for(const i of e){const s=Id(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)t.push(i);else{if(Rm(i)||km(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||t.push({role:"user",parts:Yv(n)}),t}function YR(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(r=>r!=="null");if(n.length===1)t.type=Object.values(Ae).includes(n[0].toUpperCase())?n[0].toUpperCase():Ae.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const r of n)t.anyOf.push({type:Object.values(Ae).includes(r.toUpperCase())?r.toUpperCase():Ae.TYPE_UNSPECIFIED})}}function Ls(e){const t={},n=["items"],r=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=e.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(t.nullable=!0,e=s[1]):s[1].type==="null"&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&YR(e.type,t);for(const[a,o]of Object.entries(e))if(o!=null)if(a=="type"){if(o==="null")throw new Error("type: null can not be the only possible type for the field.");if(o instanceof Array)continue;t.type=Object.values(Ae).includes(o.toUpperCase())?o.toUpperCase():Ae.TYPE_UNSPECIFIED}else if(n.includes(a))t[a]=Ls(o);else if(r.includes(a)){const u=[];for(const c of o){if(c.type=="null"){t.nullable=!0;continue}u.push(Ls(c))}t[a]=u}else if(i.includes(a)){const u={};for(const[c,l]of Object.entries(o))u[c]=Ls(l);t[a]=u}else{if(a==="additionalProperties")continue;t[a]=o}return t}function n0(e){return Ls(e)}function r0(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function i0(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function ea(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=Ls(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=Ls(t.response));return e}function ta(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function KR(e,t,n,r=1){const i=!t.startsWith(`${n}/`)&&t.split("/").length===r;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:i?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:i?`${n}/${t}`:t}function Lr(e,t){if(typeof t!="string")throw new Error("name must be a string");return KR(e,t,"cachedContents")}function Kv(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function pi(e){return Qf(e)}function XR(e){return e!=null&&typeof e=="object"&&"name"in e}function QR(e){return e!=null&&typeof e=="object"&&"video"in e}function ZR(e){return e!=null&&typeof e=="object"&&"uri"in e}function Xv(e){var t;let n;if(XR(e)&&(n=e.name),!(ZR(e)&&(n=e.uri,n===void 0))&&!(QR(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Qv(e,t){let n;return e.isVertexAI()?n=t?"publishers/google/models":"models":n=t?"models":"tunedModels",n}function Zv(e){for(const t of["models","tunedModels","publisherModels"])if(ek(e,t))return e[t];return[]}function ek(e,t){return e!==null&&typeof e=="object"&&t in e}function tk(e,t={}){const n=e,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),t.behavior&&(r.behavior=t.behavior),{functionDeclarations:[r]}}function nk(e,t={}){const n=[],r=new Set;for(const i of e){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const a=tk(i,t);a.functionDeclarations&&n.push(...a.functionDeclarations)}return{functionDeclarations:n}}function ey(e,t){let n;if(typeof t=="string")if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))n={format:"bigquery",bigqueryUri:t};else throw new Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))n={fileName:t};else throw new Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function rk(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function ty(e){if(typeof e!="object"||e===null)return{};const t=e,n=t.inlinedResponses;if(typeof n!="object"||n===null)return e;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return e;let s=!1;for(const a of i){if(typeof a!="object"||a===null)continue;const u=a.response;if(typeof u!="object"||u===null)continue;if(u.embedding!==void 0){s=!0;break}}return s&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function na(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function ny(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ik(e){const t={},n=d(e,["responsesFile"]);n!=null&&p(t,["fileName"],n);const r=d(e,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>Uk(a))),p(t,["inlinedResponses"],s)}const i=d(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["inlinedEmbedContentResponses"],s)}return t}function sk(e){const t={},n=d(e,["predictionsFormat"]);n!=null&&p(t,["format"],n);const r=d(e,["gcsDestination","outputUriPrefix"]);r!=null&&p(t,["gcsUri"],r);const i=d(e,["bigqueryDestination","outputUri"]);return i!=null&&p(t,["bigqueryUri"],i),t}function ak(e){const t={},n=d(e,["format"]);n!=null&&p(t,["predictionsFormat"],n);const r=d(e,["gcsUri"]);r!=null&&p(t,["gcsDestination","outputUriPrefix"],r);const i=d(e,["bigqueryUri"]);if(i!=null&&p(t,["bigqueryDestination","outputUri"],i),d(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(d(e,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}function pl(e){const t={},n=d(e,["name"]);n!=null&&p(t,["name"],n);const r=d(e,["metadata","displayName"]);r!=null&&p(t,["displayName"],r);const i=d(e,["metadata","state"]);i!=null&&p(t,["state"],ny(i));const s=d(e,["metadata","createTime"]);s!=null&&p(t,["createTime"],s);const a=d(e,["metadata","endTime"]);a!=null&&p(t,["endTime"],a);const o=d(e,["metadata","updateTime"]);o!=null&&p(t,["updateTime"],o);const u=d(e,["metadata","model"]);u!=null&&p(t,["model"],u);const c=d(e,["metadata","output"]);return c!=null&&p(t,["dest"],ik(ty(c))),t}function Rd(e){const t={},n=d(e,["name"]);n!=null&&p(t,["name"],n);const r=d(e,["displayName"]);r!=null&&p(t,["displayName"],r);const i=d(e,["state"]);i!=null&&p(t,["state"],ny(i));const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["createTime"]);a!=null&&p(t,["createTime"],a);const o=d(e,["startTime"]);o!=null&&p(t,["startTime"],o);const u=d(e,["endTime"]);u!=null&&p(t,["endTime"],u);const c=d(e,["updateTime"]);c!=null&&p(t,["updateTime"],c);const l=d(e,["model"]);l!=null&&p(t,["model"],l);const m=d(e,["inputConfig"]);m!=null&&p(t,["src"],ok(m));const h=d(e,["outputConfig"]);h!=null&&p(t,["dest"],sk(ty(h)));const g=d(e,["completionStats"]);return g!=null&&p(t,["completionStats"],g),t}function ok(e){const t={},n=d(e,["instancesFormat"]);n!=null&&p(t,["format"],n);const r=d(e,["gcsSource","uris"]);r!=null&&p(t,["gcsUri"],r);const i=d(e,["bigquerySource","inputUri"]);return i!=null&&p(t,["bigqueryUri"],i),t}function lk(e,t){const n={};if(d(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=d(t,["fileName"]);r!=null&&p(n,["fileName"],r);const i=d(t,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>Ok(e,a))),p(n,["requests","requests"],s)}return n}function uk(e){const t={},n=d(e,["format"]);n!=null&&p(t,["instancesFormat"],n);const r=d(e,["gcsUri"]);r!=null&&p(t,["gcsSource","uris"],r);const i=d(e,["bigqueryUri"]);if(i!=null&&p(t,["bigquerySource","inputUri"],i),d(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function ck(e){const t={},n=d(e,["data"]);if(n!=null&&p(t,["data"],n),d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(e,["mimeType"]);return r!=null&&p(t,["mimeType"],r),t}function dk(e,t){const n={},r=d(t,["name"]);return r!=null&&p(n,["_url","name"],na(e,r)),n}function fk(e,t){const n={},r=d(t,["name"]);return r!=null&&p(n,["_url","name"],na(e,r)),n}function pk(e){const t={},n=d(e,["content"]);n!=null&&p(t,["content"],n);const r=d(e,["citationMetadata"]);r!=null&&p(t,["citationMetadata"],hk(r));const i=d(e,["tokenCount"]);i!=null&&p(t,["tokenCount"],i);const s=d(e,["finishReason"]);s!=null&&p(t,["finishReason"],s);const a=d(e,["avgLogprobs"]);a!=null&&p(t,["avgLogprobs"],a);const o=d(e,["groundingMetadata"]);o!=null&&p(t,["groundingMetadata"],o);const u=d(e,["index"]);u!=null&&p(t,["index"],u);const c=d(e,["logprobsResult"]);c!=null&&p(t,["logprobsResult"],c);const l=d(e,["safetyRatings"]);if(l!=null){let h=l;Array.isArray(h)&&(h=h.map(g=>g)),p(t,["safetyRatings"],h)}const m=d(e,["urlContextMetadata"]);return m!=null&&p(t,["urlContextMetadata"],m),t}function hk(e){const t={},n=d(e,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),p(t,["citations"],r)}return t}function ry(e){const t={},n=d(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>zk(s))),p(t,["parts"],i)}const r=d(e,["role"]);return r!=null&&p(t,["role"],r),t}function mk(e,t){const n={},r=d(e,["displayName"]);if(t!==void 0&&r!=null&&p(t,["batch","displayName"],r),d(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function gk(e,t){const n={},r=d(e,["displayName"]);t!==void 0&&r!=null&&p(t,["displayName"],r);const i=d(e,["dest"]);return t!==void 0&&i!=null&&p(t,["outputConfig"],ak(rk(i))),n}function bm(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["src"]);i!=null&&p(n,["batch","inputConfig"],lk(e,ey(e,i)));const s=d(t,["config"]);return s!=null&&mk(s,n),n}function xk(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["model"],Je(e,r));const i=d(t,["src"]);i!=null&&p(n,["inputConfig"],uk(ey(e,i)));const s=d(t,["config"]);return s!=null&&gk(s,n),n}function vk(e,t){const n={},r=d(e,["displayName"]);return t!==void 0&&r!=null&&p(t,["batch","displayName"],r),n}function yk(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["src"]);i!=null&&p(n,["batch","inputConfig"],Nk(e,i));const s=d(t,["config"]);return s!=null&&vk(s,n),n}function Ek(e,t){const n={},r=d(t,["name"]);return r!=null&&p(n,["_url","name"],na(e,r)),n}function Tk(e,t){const n={},r=d(t,["name"]);return r!=null&&p(n,["_url","name"],na(e,r)),n}function Sk(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["name"]);r!=null&&p(t,["name"],r);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);return s!=null&&p(t,["error"],s),t}function wk(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["name"]);r!=null&&p(t,["name"],r);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);return s!=null&&p(t,["error"],s),t}function _k(e,t){const n={},r=d(t,["contents"]);if(r!=null){let s=t0(e,r);Array.isArray(s)&&(s=s.map(a=>a)),p(n,["requests[]","request","content"],s)}const i=d(t,["config"]);return i!=null&&(p(n,["_self"],Ck(i,n)),TR(n,{"requests[].*":"requests[].request.*"})),n}function Ck(e,t){const n={},r=d(e,["taskType"]);t!==void 0&&r!=null&&p(t,["requests[]","taskType"],r);const i=d(e,["title"]);t!==void 0&&i!=null&&p(t,["requests[]","title"],i);const s=d(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&p(t,["requests[]","outputDimensionality"],s),d(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function Nk(e,t){const n={},r=d(t,["fileName"]);r!=null&&p(n,["file_name"],r);const i=d(t,["inlinedRequests"]);return i!=null&&p(n,["requests"],_k(e,i)),n}function Ak(e){const t={};if(d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["fileUri"]);n!=null&&p(t,["fileUri"],n);const r=d(e,["mimeType"]);return r!=null&&p(t,["mimeType"],r),t}function Ik(e){const t={},n=d(e,["id"]);n!=null&&p(t,["id"],n);const r=d(e,["args"]);r!=null&&p(t,["args"],r);const i=d(e,["name"]);if(i!=null&&p(t,["name"],i),d(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function Rk(e){const t={},n=d(e,["mode"]);n!=null&&p(t,["mode"],n);const r=d(e,["allowedFunctionNames"]);if(r!=null&&p(t,["allowedFunctionNames"],r),d(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function kk(e,t,n){const r={},i=d(t,["systemInstruction"]);n!==void 0&&i!=null&&p(n,["systemInstruction"],ry(Qt(i)));const s=d(t,["temperature"]);s!=null&&p(r,["temperature"],s);const a=d(t,["topP"]);a!=null&&p(r,["topP"],a);const o=d(t,["topK"]);o!=null&&p(r,["topK"],o);const u=d(t,["candidateCount"]);u!=null&&p(r,["candidateCount"],u);const c=d(t,["maxOutputTokens"]);c!=null&&p(r,["maxOutputTokens"],c);const l=d(t,["stopSequences"]);l!=null&&p(r,["stopSequences"],l);const m=d(t,["responseLogprobs"]);m!=null&&p(r,["responseLogprobs"],m);const h=d(t,["logprobs"]);h!=null&&p(r,["logprobs"],h);const g=d(t,["presencePenalty"]);g!=null&&p(r,["presencePenalty"],g);const x=d(t,["frequencyPenalty"]);x!=null&&p(r,["frequencyPenalty"],x);const v=d(t,["seed"]);v!=null&&p(r,["seed"],v);const w=d(t,["responseMimeType"]);w!=null&&p(r,["responseMimeType"],w);const E=d(t,["responseSchema"]);E!=null&&p(r,["responseSchema"],n0(E));const y=d(t,["responseJsonSchema"]);if(y!=null&&p(r,["responseJsonSchema"],y),d(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const T=d(t,["safetySettings"]);if(n!==void 0&&T!=null){let X=T;Array.isArray(X)&&(X=X.map(ne=>qk(ne))),p(n,["safetySettings"],X)}const C=d(t,["tools"]);if(n!==void 0&&C!=null){let X=ta(C);Array.isArray(X)&&(X=X.map(ne=>Jk(ea(ne)))),p(n,["tools"],X)}const L=d(t,["toolConfig"]);if(n!==void 0&&L!=null&&p(n,["toolConfig"],Wk(L)),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const B=d(t,["cachedContent"]);n!==void 0&&B!=null&&p(n,["cachedContent"],Lr(e,B));const R=d(t,["responseModalities"]);R!=null&&p(r,["responseModalities"],R);const O=d(t,["mediaResolution"]);O!=null&&p(r,["mediaResolution"],O);const M=d(t,["speechConfig"]);if(M!=null&&p(r,["speechConfig"],r0(M)),d(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=d(t,["thinkingConfig"]);k!=null&&p(r,["thinkingConfig"],k);const z=d(t,["imageConfig"]);return z!=null&&p(r,["imageConfig"],Lk(z)),r}function bk(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>pk(c))),p(t,["candidates"],u)}const i=d(e,["modelVersion"]);i!=null&&p(t,["modelVersion"],i);const s=d(e,["promptFeedback"]);s!=null&&p(t,["promptFeedback"],s);const a=d(e,["responseId"]);a!=null&&p(t,["responseId"],a);const o=d(e,["usageMetadata"]);return o!=null&&p(t,["usageMetadata"],o),t}function Fk(e,t){const n={},r=d(t,["name"]);return r!=null&&p(n,["_url","name"],na(e,r)),n}function Pk(e,t){const n={},r=d(t,["name"]);return r!=null&&p(n,["_url","name"],na(e,r)),n}function Mk(e){const t={};if(d(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(e,["enableWidget"]);return n!=null&&p(t,["enableWidget"],n),t}function Dk(e){const t={};if(d(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(e,["timeRangeFilter"]);return n!=null&&p(t,["timeRangeFilter"],n),t}function Lk(e){const t={},n=d(e,["aspectRatio"]);n!=null&&p(t,["aspectRatio"],n);const r=d(e,["imageSize"]);if(r!=null&&p(t,["imageSize"],r),d(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(d(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function Ok(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["request","model"],Je(e,r));const i=d(t,["contents"]);if(i!=null){let o=$n(i);Array.isArray(o)&&(o=o.map(u=>ry(u))),p(n,["request","contents"],o)}const s=d(t,["metadata"]);s!=null&&p(n,["metadata"],s);const a=d(t,["config"]);return a!=null&&p(n,["request","generationConfig"],kk(e,a,d(n,["request"],{}))),n}function Uk(e){const t={},n=d(e,["response"]);n!=null&&p(t,["response"],bk(n));const r=d(e,["error"]);return r!=null&&p(t,["error"],r),t}function Bk(e,t){const n={},r=d(e,["pageSize"]);t!==void 0&&r!=null&&p(t,["_query","pageSize"],r);const i=d(e,["pageToken"]);if(t!==void 0&&i!=null&&p(t,["_query","pageToken"],i),d(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function Gk(e,t){const n={},r=d(e,["pageSize"]);t!==void 0&&r!=null&&p(t,["_query","pageSize"],r);const i=d(e,["pageToken"]);t!==void 0&&i!=null&&p(t,["_query","pageToken"],i);const s=d(e,["filter"]);return t!==void 0&&s!=null&&p(t,["_query","filter"],s),n}function $k(e){const t={},n=d(e,["config"]);return n!=null&&Bk(n,t),t}function Vk(e){const t={},n=d(e,["config"]);return n!=null&&Gk(n,t),t}function jk(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["nextPageToken"]);r!=null&&p(t,["nextPageToken"],r);const i=d(e,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>pl(a))),p(t,["batchJobs"],s)}return t}function Hk(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["nextPageToken"]);r!=null&&p(t,["nextPageToken"],r);const i=d(e,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>Rd(a))),p(t,["batchJobs"],s)}return t}function zk(e){const t={},n=d(e,["mediaResolution"]);n!=null&&p(t,["mediaResolution"],n);const r=d(e,["codeExecutionResult"]);r!=null&&p(t,["codeExecutionResult"],r);const i=d(e,["executableCode"]);i!=null&&p(t,["executableCode"],i);const s=d(e,["fileData"]);s!=null&&p(t,["fileData"],Ak(s));const a=d(e,["functionCall"]);a!=null&&p(t,["functionCall"],Ik(a));const o=d(e,["functionResponse"]);o!=null&&p(t,["functionResponse"],o);const u=d(e,["inlineData"]);u!=null&&p(t,["inlineData"],ck(u));const c=d(e,["text"]);c!=null&&p(t,["text"],c);const l=d(e,["thought"]);l!=null&&p(t,["thought"],l);const m=d(e,["thoughtSignature"]);m!=null&&p(t,["thoughtSignature"],m);const h=d(e,["videoMetadata"]);return h!=null&&p(t,["videoMetadata"],h),t}function qk(e){const t={},n=d(e,["category"]);if(n!=null&&p(t,["category"],n),d(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=d(e,["threshold"]);return r!=null&&p(t,["threshold"],r),t}function Wk(e){const t={},n=d(e,["functionCallingConfig"]);n!=null&&p(t,["functionCallingConfig"],Rk(n));const r=d(e,["retrievalConfig"]);return r!=null&&p(t,["retrievalConfig"],r),t}function Jk(e){const t={},n=d(e,["functionDeclarations"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(m=>m)),p(t,["functionDeclarations"],l)}if(d(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(e,["googleSearchRetrieval"]);r!=null&&p(t,["googleSearchRetrieval"],r);const i=d(e,["computerUse"]);i!=null&&p(t,["computerUse"],i);const s=d(e,["fileSearch"]);s!=null&&p(t,["fileSearch"],s);const a=d(e,["codeExecution"]);if(a!=null&&p(t,["codeExecution"],a),d(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=d(e,["googleMaps"]);o!=null&&p(t,["googleMaps"],Mk(o));const u=d(e,["googleSearch"]);u!=null&&p(t,["googleSearch"],Dk(u));const c=d(e,["urlContext"]);return c!=null&&p(t,["urlContext"],c),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Fr;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"})(Fr||(Fr={}));class ji{constructor(t,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,r,i)}init(t,n,r){var i,s;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let a={config:{}};!r||Object.keys(r).length===0?a={config:{}}:typeof r=="object"?a=Object.assign({},r):a=r,a.config&&(a.config.pageToken=n.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(s=(i=a.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Yk extends Dr{constructor(t){super(),this.apiClient=t,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new ji(Fr.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(t){const n=bm(this.apiClient,t),r=n._url,i=_e("{model}:batchGenerateContent",r),o=n.batch.inputConfig.requests,u=o.requests,c=[];for(const l of u){const m=Object.assign({},l);if(m.systemInstruction){const h=m.systemInstruction;delete m.systemInstruction;const g=m.request;g.systemInstruction=h,m.request=g}c.push(m)}return o.requests=c,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(t){if(typeof t=="string")return t.startsWith("gs://")?t:void 0;if(!Array.isArray(t)&&t.gcsUri&&t.gcsUri.length>0)return t.gcsUri[0]}getBigqueryUri(t){if(typeof t=="string")return t.startsWith("bq://")?t:void 0;if(!Array.isArray(t))return t.bigqueryUri}formatDestination(t,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(t),a=this.getBigqueryUri(t);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(a)r.dest=`${a}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=xk(this.apiClient,t);return o=_e("batchPredictionJobs",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>Rd(l))}else{const c=bm(this.apiClient,t);return o=_e("{model}:batchGenerateContent",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),a.then(l=>pl(l))}}async createEmbeddingsInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=yk(this.apiClient,t);return s=_e("{model}:asyncBatchEmbedContent",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>pl(u))}}async get(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=Pk(this.apiClient,t);return o=_e("batchPredictionJobs/{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>Rd(l))}else{const c=Fk(this.apiClient,t);return o=_e("batches/{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),a.then(l=>pl(l))}}async cancel(t){var n,r,i,s;let a="",o={};if(this.apiClient.isVertexAI()){const u=fk(this.apiClient,t);a=_e("batchPredictionJobs/{name}:cancel",u._url),o=u._query,delete u._url,delete u._query,await this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const u=dk(this.apiClient,t);a=_e("batches/{name}:cancel",u._url),o=u._query,delete u._url,delete u._query,await this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=Vk(t);return o=_e("batchPredictionJobs",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=Hk(l),h=new Am;return Object.assign(h,m),h})}else{const c=$k(t);return o=_e("batches",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=jk(l),h=new Am;return Object.assign(h,m),h})}}async delete(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=Tk(this.apiClient,t);return o=_e("batchPredictionJobs/{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>wk(l))}else{const c=Ek(this.apiClient,t);return o=_e("batches/{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>Sk(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Kk(e){const t={},n=d(e,["data"]);if(n!=null&&p(t,["data"],n),d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(e,["mimeType"]);return r!=null&&p(t,["mimeType"],r),t}function Fm(e){const t={},n=d(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>y4(s))),p(t,["parts"],i)}const r=d(e,["role"]);return r!=null&&p(t,["role"],r),t}function Xk(e,t){const n={},r=d(e,["ttl"]);t!==void 0&&r!=null&&p(t,["ttl"],r);const i=d(e,["expireTime"]);t!==void 0&&i!=null&&p(t,["expireTime"],i);const s=d(e,["displayName"]);t!==void 0&&s!=null&&p(t,["displayName"],s);const a=d(e,["contents"]);if(t!==void 0&&a!=null){let l=$n(a);Array.isArray(l)&&(l=l.map(m=>Fm(m))),p(t,["contents"],l)}const o=d(e,["systemInstruction"]);t!==void 0&&o!=null&&p(t,["systemInstruction"],Fm(Qt(o)));const u=d(e,["tools"]);if(t!==void 0&&u!=null){let l=u;Array.isArray(l)&&(l=l.map(m=>T4(m))),p(t,["tools"],l)}const c=d(e,["toolConfig"]);if(t!==void 0&&c!=null&&p(t,["toolConfig"],E4(c)),d(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function Qk(e,t){const n={},r=d(e,["ttl"]);t!==void 0&&r!=null&&p(t,["ttl"],r);const i=d(e,["expireTime"]);t!==void 0&&i!=null&&p(t,["expireTime"],i);const s=d(e,["displayName"]);t!==void 0&&s!=null&&p(t,["displayName"],s);const a=d(e,["contents"]);if(t!==void 0&&a!=null){let m=$n(a);Array.isArray(m)&&(m=m.map(h=>h)),p(t,["contents"],m)}const o=d(e,["systemInstruction"]);t!==void 0&&o!=null&&p(t,["systemInstruction"],Qt(o));const u=d(e,["tools"]);if(t!==void 0&&u!=null){let m=u;Array.isArray(m)&&(m=m.map(h=>S4(h))),p(t,["tools"],m)}const c=d(e,["toolConfig"]);t!==void 0&&c!=null&&p(t,["toolConfig"],c);const l=d(e,["kmsKeyName"]);return t!==void 0&&l!=null&&p(t,["encryption_spec","kmsKeyName"],l),n}function Zk(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["model"],zv(e,r));const i=d(t,["config"]);return i!=null&&Xk(i,n),n}function e4(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["model"],zv(e,r));const i=d(t,["config"]);return i!=null&&Qk(i,n),n}function t4(e,t){const n={},r=d(t,["name"]);return r!=null&&p(n,["_url","name"],Lr(e,r)),n}function n4(e,t){const n={},r=d(t,["name"]);return r!=null&&p(n,["_url","name"],Lr(e,r)),n}function r4(e){const t={},n=d(e,["sdkHttpResponse"]);return n!=null&&p(t,["sdkHttpResponse"],n),t}function i4(e){const t={},n=d(e,["sdkHttpResponse"]);return n!=null&&p(t,["sdkHttpResponse"],n),t}function s4(e){const t={};if(d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["fileUri"]);n!=null&&p(t,["fileUri"],n);const r=d(e,["mimeType"]);return r!=null&&p(t,["mimeType"],r),t}function a4(e){const t={},n=d(e,["id"]);n!=null&&p(t,["id"],n);const r=d(e,["args"]);r!=null&&p(t,["args"],r);const i=d(e,["name"]);if(i!=null&&p(t,["name"],i),d(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function o4(e){const t={},n=d(e,["mode"]);n!=null&&p(t,["mode"],n);const r=d(e,["allowedFunctionNames"]);if(r!=null&&p(t,["allowedFunctionNames"],r),d(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function l4(e){const t={};if(d(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(e,["description"]);n!=null&&p(t,["description"],n);const r=d(e,["name"]);r!=null&&p(t,["name"],r);const i=d(e,["parameters"]);i!=null&&p(t,["parameters"],i);const s=d(e,["parametersJsonSchema"]);s!=null&&p(t,["parametersJsonSchema"],s);const a=d(e,["response"]);a!=null&&p(t,["response"],a);const o=d(e,["responseJsonSchema"]);return o!=null&&p(t,["responseJsonSchema"],o),t}function u4(e,t){const n={},r=d(t,["name"]);return r!=null&&p(n,["_url","name"],Lr(e,r)),n}function c4(e,t){const n={},r=d(t,["name"]);return r!=null&&p(n,["_url","name"],Lr(e,r)),n}function d4(e){const t={};if(d(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(e,["enableWidget"]);return n!=null&&p(t,["enableWidget"],n),t}function f4(e){const t={};if(d(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(e,["timeRangeFilter"]);return n!=null&&p(t,["timeRangeFilter"],n),t}function p4(e,t){const n={},r=d(e,["pageSize"]);t!==void 0&&r!=null&&p(t,["_query","pageSize"],r);const i=d(e,["pageToken"]);return t!==void 0&&i!=null&&p(t,["_query","pageToken"],i),n}function h4(e,t){const n={},r=d(e,["pageSize"]);t!==void 0&&r!=null&&p(t,["_query","pageSize"],r);const i=d(e,["pageToken"]);return t!==void 0&&i!=null&&p(t,["_query","pageToken"],i),n}function m4(e){const t={},n=d(e,["config"]);return n!=null&&p4(n,t),t}function g4(e){const t={},n=d(e,["config"]);return n!=null&&h4(n,t),t}function x4(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["nextPageToken"]);r!=null&&p(t,["nextPageToken"],r);const i=d(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["cachedContents"],s)}return t}function v4(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["nextPageToken"]);r!=null&&p(t,["nextPageToken"],r);const i=d(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["cachedContents"],s)}return t}function y4(e){const t={},n=d(e,["mediaResolution"]);n!=null&&p(t,["mediaResolution"],n);const r=d(e,["codeExecutionResult"]);r!=null&&p(t,["codeExecutionResult"],r);const i=d(e,["executableCode"]);i!=null&&p(t,["executableCode"],i);const s=d(e,["fileData"]);s!=null&&p(t,["fileData"],s4(s));const a=d(e,["functionCall"]);a!=null&&p(t,["functionCall"],a4(a));const o=d(e,["functionResponse"]);o!=null&&p(t,["functionResponse"],o);const u=d(e,["inlineData"]);u!=null&&p(t,["inlineData"],Kk(u));const c=d(e,["text"]);c!=null&&p(t,["text"],c);const l=d(e,["thought"]);l!=null&&p(t,["thought"],l);const m=d(e,["thoughtSignature"]);m!=null&&p(t,["thoughtSignature"],m);const h=d(e,["videoMetadata"]);return h!=null&&p(t,["videoMetadata"],h),t}function E4(e){const t={},n=d(e,["functionCallingConfig"]);n!=null&&p(t,["functionCallingConfig"],o4(n));const r=d(e,["retrievalConfig"]);return r!=null&&p(t,["retrievalConfig"],r),t}function T4(e){const t={},n=d(e,["functionDeclarations"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(m=>m)),p(t,["functionDeclarations"],l)}if(d(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(e,["googleSearchRetrieval"]);r!=null&&p(t,["googleSearchRetrieval"],r);const i=d(e,["computerUse"]);i!=null&&p(t,["computerUse"],i);const s=d(e,["fileSearch"]);s!=null&&p(t,["fileSearch"],s);const a=d(e,["codeExecution"]);if(a!=null&&p(t,["codeExecution"],a),d(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=d(e,["googleMaps"]);o!=null&&p(t,["googleMaps"],d4(o));const u=d(e,["googleSearch"]);u!=null&&p(t,["googleSearch"],f4(u));const c=d(e,["urlContext"]);return c!=null&&p(t,["urlContext"],c),t}function S4(e){const t={},n=d(e,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(h=>l4(h))),p(t,["functionDeclarations"],m)}const r=d(e,["retrieval"]);r!=null&&p(t,["retrieval"],r);const i=d(e,["googleSearchRetrieval"]);i!=null&&p(t,["googleSearchRetrieval"],i);const s=d(e,["computerUse"]);if(s!=null&&p(t,["computerUse"],s),d(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=d(e,["codeExecution"]);a!=null&&p(t,["codeExecution"],a);const o=d(e,["enterpriseWebSearch"]);o!=null&&p(t,["enterpriseWebSearch"],o);const u=d(e,["googleMaps"]);u!=null&&p(t,["googleMaps"],u);const c=d(e,["googleSearch"]);c!=null&&p(t,["googleSearch"],c);const l=d(e,["urlContext"]);return l!=null&&p(t,["urlContext"],l),t}function w4(e,t){const n={},r=d(e,["ttl"]);t!==void 0&&r!=null&&p(t,["ttl"],r);const i=d(e,["expireTime"]);return t!==void 0&&i!=null&&p(t,["expireTime"],i),n}function _4(e,t){const n={},r=d(e,["ttl"]);t!==void 0&&r!=null&&p(t,["ttl"],r);const i=d(e,["expireTime"]);return t!==void 0&&i!=null&&p(t,["expireTime"],i),n}function C4(e,t){const n={},r=d(t,["name"]);r!=null&&p(n,["_url","name"],Lr(e,r));const i=d(t,["config"]);return i!=null&&w4(i,n),n}function N4(e,t){const n={},r=d(t,["name"]);r!=null&&p(n,["_url","name"],Lr(e,r));const i=d(t,["config"]);return i!=null&&_4(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class A4 extends Dr{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new ji(Fr.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=e4(this.apiClient,t);return o=_e("cachedContents",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>l)}else{const c=Zk(this.apiClient,t);return o=_e("cachedContents",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),a.then(l=>l)}}async get(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=c4(this.apiClient,t);return o=_e("{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>l)}else{const c=u4(this.apiClient,t);return o=_e("{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),a.then(l=>l)}}async delete(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=n4(this.apiClient,t);return o=_e("{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=i4(l),h=new Cm;return Object.assign(h,m),h})}else{const c=t4(this.apiClient,t);return o=_e("{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=r4(l),h=new Cm;return Object.assign(h,m),h})}}async update(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=N4(this.apiClient,t);return o=_e("{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>l)}else{const c=C4(this.apiClient,t);return o=_e("{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),a.then(l=>l)}}async listInternal(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=g4(t);return o=_e("cachedContents",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=v4(l),h=new Nm;return Object.assign(h,m),h})}else{const c=m4(t);return o=_e("cachedContents",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=x4(l),h=new Nm;return Object.assign(h,m),h})}}}function Pm(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ot(e){return this instanceof ot?(this.v=e,this):new ot(e)}function Os(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(g){return function(x){return Promise.resolve(x).then(g,m)}}function o(g,x){r[g]&&(i[g]=function(v){return new Promise(function(w,E){s.push([g,v,w,E])>1||u(g,v)})},x&&(i[g]=x(i[g])))}function u(g,x){try{c(r[g](x))}catch(v){h(s[0][3],v)}}function c(g){g.value instanceof ot?Promise.resolve(g.value.v).then(l,m):h(s[0][2],g)}function l(g){u("next",g)}function m(g){u("throw",g)}function h(g,x){g(x),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Ba(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Pm=="function"?Pm(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(a){return new Promise(function(o,u){a=e[s](a),i(o,u,a.done,a.value)})}}function i(s,a,o,u){Promise.resolve(u).then(function(c){s({value:c,done:o})},a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function I4(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:iy(n)}function iy(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0)return!1;return!0}function R4(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function Mm(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let r=0;for(;r<n;)if(e[r].role==="user")t.push(e[r]),r++;else{const i=[];let s=!0;for(;r<n&&e[r].role==="model";)i.push(e[r]),s&&!iy(e[r])&&(s=!1),r++;s?t.push(...i):t.pop()}return t}class k4{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new b4(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class b4{constructor(t,n,r,i={},s=[]){this.apiClient=t,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),R4(s)}async sendMessage(t){var n;await this.sendPromise;const r=Qt(t.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,a,o;const u=await i,c=(a=(s=u.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content,l=u.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let h=[];l!=null&&(h=(o=l.slice(m))!==null&&o!==void 0?o:[]);const g=c?[c]:[];this.recordHistory(r,g,h)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(t){var n;await this.sendPromise;const r=Qt(t.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(t=!1){const n=t?Mm(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){var r,i;return Os(this,arguments,function*(){var a,o,u,c;const l=[];try{for(var m=!0,h=Ba(t),g;g=yield ot(h.next()),a=g.done,!a;m=!0){c=g.value,m=!1;const x=c;if(I4(x)){const v=(i=(r=x.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;v!==void 0&&l.push(v)}yield yield ot(x)}}catch(x){o={error:x}}finally{try{!m&&!a&&(u=h.return)&&(yield ot(u.call(h)))}finally{if(o)throw o.error}}this.recordHistory(n,l)})}recordHistory(t,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...Mm(r)):this.history.push(t),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Pu extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,Pu.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function F4(e){const t={},n=d(e,["file"]);return n!=null&&p(t,["file"],n),t}function P4(e){const t={},n=d(e,["sdkHttpResponse"]);return n!=null&&p(t,["sdkHttpResponse"],n),t}function M4(e){const t={},n=d(e,["name"]);return n!=null&&p(t,["_url","file"],Xv(n)),t}function D4(e){const t={},n=d(e,["sdkHttpResponse"]);return n!=null&&p(t,["sdkHttpResponse"],n),t}function L4(e){const t={},n=d(e,["name"]);return n!=null&&p(t,["_url","file"],Xv(n)),t}function O4(e,t){const n={},r=d(e,["pageSize"]);t!==void 0&&r!=null&&p(t,["_query","pageSize"],r);const i=d(e,["pageToken"]);return t!==void 0&&i!=null&&p(t,["_query","pageToken"],i),n}function U4(e){const t={},n=d(e,["config"]);return n!=null&&O4(n,t),t}function B4(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["nextPageToken"]);r!=null&&p(t,["nextPageToken"],r);const i=d(e,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["files"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class G4 extends Dr{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new ji(Fr.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>n)}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=U4(t);return s=_e("files",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(c=>{const l=c;return l.sdkHttpResponse={headers:u.headers},l})),i.then(u=>{const c=B4(u),l=new HR;return Object.assign(l,c),l})}}async createInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=F4(t);return s=_e("upload/v1beta/files",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const c=P4(u),l=new zR;return Object.assign(l,c),l})}}async get(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=L4(t);return s=_e("files/{file}",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}async delete(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=M4(t);return s=_e("files/{file}",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(c=>{const l=c;return l.sdkHttpResponse={headers:u.headers},l})),i.then(u=>{const c=D4(u),l=new qR;return Object.assign(l,c),l})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hl(e){const t={},n=d(e,["data"]);if(n!=null&&p(t,["data"],n),d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(e,["mimeType"]);return r!=null&&p(t,["mimeType"],r),t}function $4(e){const t={},n=d(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>rb(s))),p(t,["parts"],i)}const r=d(e,["role"]);return r!=null&&p(t,["role"],r),t}function V4(e){const t={};if(d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["fileUri"]);n!=null&&p(t,["fileUri"],n);const r=d(e,["mimeType"]);return r!=null&&p(t,["mimeType"],r),t}function j4(e){const t={},n=d(e,["id"]);n!=null&&p(t,["id"],n);const r=d(e,["args"]);r!=null&&p(t,["args"],r);const i=d(e,["name"]);if(i!=null&&p(t,["name"],i),d(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function H4(e){const t={};if(d(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(e,["description"]);n!=null&&p(t,["description"],n);const r=d(e,["name"]);r!=null&&p(t,["name"],r);const i=d(e,["parameters"]);i!=null&&p(t,["parameters"],i);const s=d(e,["parametersJsonSchema"]);s!=null&&p(t,["parametersJsonSchema"],s);const a=d(e,["response"]);a!=null&&p(t,["response"],a);const o=d(e,["responseJsonSchema"]);return o!=null&&p(t,["responseJsonSchema"],o),t}function z4(e){const t={},n=d(e,["modelSelectionConfig"]);n!=null&&p(t,["modelConfig"],n);const r=d(e,["responseJsonSchema"]);r!=null&&p(t,["responseJsonSchema"],r);const i=d(e,["audioTimestamp"]);i!=null&&p(t,["audioTimestamp"],i);const s=d(e,["candidateCount"]);s!=null&&p(t,["candidateCount"],s);const a=d(e,["enableAffectiveDialog"]);a!=null&&p(t,["enableAffectiveDialog"],a);const o=d(e,["frequencyPenalty"]);o!=null&&p(t,["frequencyPenalty"],o);const u=d(e,["logprobs"]);u!=null&&p(t,["logprobs"],u);const c=d(e,["maxOutputTokens"]);c!=null&&p(t,["maxOutputTokens"],c);const l=d(e,["mediaResolution"]);l!=null&&p(t,["mediaResolution"],l);const m=d(e,["presencePenalty"]);m!=null&&p(t,["presencePenalty"],m);const h=d(e,["responseLogprobs"]);h!=null&&p(t,["responseLogprobs"],h);const g=d(e,["responseMimeType"]);g!=null&&p(t,["responseMimeType"],g);const x=d(e,["responseModalities"]);x!=null&&p(t,["responseModalities"],x);const v=d(e,["responseSchema"]);v!=null&&p(t,["responseSchema"],v);const w=d(e,["routingConfig"]);w!=null&&p(t,["routingConfig"],w);const E=d(e,["seed"]);E!=null&&p(t,["seed"],E);const y=d(e,["speechConfig"]);y!=null&&p(t,["speechConfig"],sy(y));const T=d(e,["stopSequences"]);T!=null&&p(t,["stopSequences"],T);const C=d(e,["temperature"]);C!=null&&p(t,["temperature"],C);const L=d(e,["thinkingConfig"]);L!=null&&p(t,["thinkingConfig"],L);const B=d(e,["topK"]);B!=null&&p(t,["topK"],B);const R=d(e,["topP"]);if(R!=null&&p(t,["topP"],R),d(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function q4(e){const t={};if(d(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(e,["enableWidget"]);return n!=null&&p(t,["enableWidget"],n),t}function W4(e){const t={};if(d(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(e,["timeRangeFilter"]);return n!=null&&p(t,["timeRangeFilter"],n),t}function J4(e,t){const n={},r=d(e,["generationConfig"]);t!==void 0&&r!=null&&p(t,["setup","generationConfig"],r);const i=d(e,["responseModalities"]);t!==void 0&&i!=null&&p(t,["setup","generationConfig","responseModalities"],i);const s=d(e,["temperature"]);t!==void 0&&s!=null&&p(t,["setup","generationConfig","temperature"],s);const a=d(e,["topP"]);t!==void 0&&a!=null&&p(t,["setup","generationConfig","topP"],a);const o=d(e,["topK"]);t!==void 0&&o!=null&&p(t,["setup","generationConfig","topK"],o);const u=d(e,["maxOutputTokens"]);t!==void 0&&u!=null&&p(t,["setup","generationConfig","maxOutputTokens"],u);const c=d(e,["mediaResolution"]);t!==void 0&&c!=null&&p(t,["setup","generationConfig","mediaResolution"],c);const l=d(e,["seed"]);t!==void 0&&l!=null&&p(t,["setup","generationConfig","seed"],l);const m=d(e,["speechConfig"]);t!==void 0&&m!=null&&p(t,["setup","generationConfig","speechConfig"],i0(m));const h=d(e,["thinkingConfig"]);t!==void 0&&h!=null&&p(t,["setup","generationConfig","thinkingConfig"],h);const g=d(e,["enableAffectiveDialog"]);t!==void 0&&g!=null&&p(t,["setup","generationConfig","enableAffectiveDialog"],g);const x=d(e,["systemInstruction"]);t!==void 0&&x!=null&&p(t,["setup","systemInstruction"],$4(Qt(x)));const v=d(e,["tools"]);if(t!==void 0&&v!=null){let B=ta(v);Array.isArray(B)&&(B=B.map(R=>sb(ea(R)))),p(t,["setup","tools"],B)}const w=d(e,["sessionResumption"]);t!==void 0&&w!=null&&p(t,["setup","sessionResumption"],ib(w));const E=d(e,["inputAudioTranscription"]);t!==void 0&&E!=null&&p(t,["setup","inputAudioTranscription"],E);const y=d(e,["outputAudioTranscription"]);t!==void 0&&y!=null&&p(t,["setup","outputAudioTranscription"],y);const T=d(e,["realtimeInputConfig"]);t!==void 0&&T!=null&&p(t,["setup","realtimeInputConfig"],T);const C=d(e,["contextWindowCompression"]);t!==void 0&&C!=null&&p(t,["setup","contextWindowCompression"],C);const L=d(e,["proactivity"]);return t!==void 0&&L!=null&&p(t,["setup","proactivity"],L),n}function Y4(e,t){const n={},r=d(e,["generationConfig"]);t!==void 0&&r!=null&&p(t,["setup","generationConfig"],z4(r));const i=d(e,["responseModalities"]);t!==void 0&&i!=null&&p(t,["setup","generationConfig","responseModalities"],i);const s=d(e,["temperature"]);t!==void 0&&s!=null&&p(t,["setup","generationConfig","temperature"],s);const a=d(e,["topP"]);t!==void 0&&a!=null&&p(t,["setup","generationConfig","topP"],a);const o=d(e,["topK"]);t!==void 0&&o!=null&&p(t,["setup","generationConfig","topK"],o);const u=d(e,["maxOutputTokens"]);t!==void 0&&u!=null&&p(t,["setup","generationConfig","maxOutputTokens"],u);const c=d(e,["mediaResolution"]);t!==void 0&&c!=null&&p(t,["setup","generationConfig","mediaResolution"],c);const l=d(e,["seed"]);t!==void 0&&l!=null&&p(t,["setup","generationConfig","seed"],l);const m=d(e,["speechConfig"]);t!==void 0&&m!=null&&p(t,["setup","generationConfig","speechConfig"],sy(i0(m)));const h=d(e,["thinkingConfig"]);t!==void 0&&h!=null&&p(t,["setup","generationConfig","thinkingConfig"],h);const g=d(e,["enableAffectiveDialog"]);t!==void 0&&g!=null&&p(t,["setup","generationConfig","enableAffectiveDialog"],g);const x=d(e,["systemInstruction"]);t!==void 0&&x!=null&&p(t,["setup","systemInstruction"],Qt(x));const v=d(e,["tools"]);if(t!==void 0&&v!=null){let B=ta(v);Array.isArray(B)&&(B=B.map(R=>ab(ea(R)))),p(t,["setup","tools"],B)}const w=d(e,["sessionResumption"]);t!==void 0&&w!=null&&p(t,["setup","sessionResumption"],w);const E=d(e,["inputAudioTranscription"]);t!==void 0&&E!=null&&p(t,["setup","inputAudioTranscription"],E);const y=d(e,["outputAudioTranscription"]);t!==void 0&&y!=null&&p(t,["setup","outputAudioTranscription"],y);const T=d(e,["realtimeInputConfig"]);t!==void 0&&T!=null&&p(t,["setup","realtimeInputConfig"],T);const C=d(e,["contextWindowCompression"]);t!==void 0&&C!=null&&p(t,["setup","contextWindowCompression"],C);const L=d(e,["proactivity"]);return t!==void 0&&L!=null&&p(t,["setup","proactivity"],L),n}function K4(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["setup","model"],Je(e,r));const i=d(t,["config"]);return i!=null&&p(n,["config"],J4(i,n)),n}function X4(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["setup","model"],Je(e,r));const i=d(t,["config"]);return i!=null&&p(n,["config"],Y4(i,n)),n}function Q4(e){const t={},n=d(e,["musicGenerationConfig"]);return n!=null&&p(t,["musicGenerationConfig"],n),t}function Z4(e){const t={},n=d(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),p(t,["weightedPrompts"],r)}return t}function eb(e){const t={},n=d(e,["media"]);if(n!=null){let c=qv(n);Array.isArray(c)&&(c=c.map(l=>hl(l))),p(t,["mediaChunks"],c)}const r=d(e,["audio"]);r!=null&&p(t,["audio"],hl(Jv(r)));const i=d(e,["audioStreamEnd"]);i!=null&&p(t,["audioStreamEnd"],i);const s=d(e,["video"]);s!=null&&p(t,["video"],hl(Wv(s)));const a=d(e,["text"]);a!=null&&p(t,["text"],a);const o=d(e,["activityStart"]);o!=null&&p(t,["activityStart"],o);const u=d(e,["activityEnd"]);return u!=null&&p(t,["activityEnd"],u),t}function tb(e){const t={},n=d(e,["media"]);if(n!=null){let c=qv(n);Array.isArray(c)&&(c=c.map(l=>l)),p(t,["mediaChunks"],c)}const r=d(e,["audio"]);r!=null&&p(t,["audio"],Jv(r));const i=d(e,["audioStreamEnd"]);i!=null&&p(t,["audioStreamEnd"],i);const s=d(e,["video"]);s!=null&&p(t,["video"],Wv(s));const a=d(e,["text"]);a!=null&&p(t,["text"],a);const o=d(e,["activityStart"]);o!=null&&p(t,["activityStart"],o);const u=d(e,["activityEnd"]);return u!=null&&p(t,["activityEnd"],u),t}function nb(e){const t={},n=d(e,["setupComplete"]);n!=null&&p(t,["setupComplete"],n);const r=d(e,["serverContent"]);r!=null&&p(t,["serverContent"],r);const i=d(e,["toolCall"]);i!=null&&p(t,["toolCall"],i);const s=d(e,["toolCallCancellation"]);s!=null&&p(t,["toolCallCancellation"],s);const a=d(e,["usageMetadata"]);a!=null&&p(t,["usageMetadata"],ob(a));const o=d(e,["goAway"]);o!=null&&p(t,["goAway"],o);const u=d(e,["sessionResumptionUpdate"]);return u!=null&&p(t,["sessionResumptionUpdate"],u),t}function rb(e){const t={},n=d(e,["mediaResolution"]);n!=null&&p(t,["mediaResolution"],n);const r=d(e,["codeExecutionResult"]);r!=null&&p(t,["codeExecutionResult"],r);const i=d(e,["executableCode"]);i!=null&&p(t,["executableCode"],i);const s=d(e,["fileData"]);s!=null&&p(t,["fileData"],V4(s));const a=d(e,["functionCall"]);a!=null&&p(t,["functionCall"],j4(a));const o=d(e,["functionResponse"]);o!=null&&p(t,["functionResponse"],o);const u=d(e,["inlineData"]);u!=null&&p(t,["inlineData"],hl(u));const c=d(e,["text"]);c!=null&&p(t,["text"],c);const l=d(e,["thought"]);l!=null&&p(t,["thought"],l);const m=d(e,["thoughtSignature"]);m!=null&&p(t,["thoughtSignature"],m);const h=d(e,["videoMetadata"]);return h!=null&&p(t,["videoMetadata"],h),t}function ib(e){const t={},n=d(e,["handle"]);if(n!=null&&p(t,["handle"],n),d(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function sy(e){const t={},n=d(e,["languageCode"]);n!=null&&p(t,["languageCode"],n);const r=d(e,["voiceConfig"]);if(r!=null&&p(t,["voiceConfig"],r),d(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function sb(e){const t={},n=d(e,["functionDeclarations"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(m=>m)),p(t,["functionDeclarations"],l)}if(d(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(e,["googleSearchRetrieval"]);r!=null&&p(t,["googleSearchRetrieval"],r);const i=d(e,["computerUse"]);i!=null&&p(t,["computerUse"],i);const s=d(e,["fileSearch"]);s!=null&&p(t,["fileSearch"],s);const a=d(e,["codeExecution"]);if(a!=null&&p(t,["codeExecution"],a),d(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=d(e,["googleMaps"]);o!=null&&p(t,["googleMaps"],q4(o));const u=d(e,["googleSearch"]);u!=null&&p(t,["googleSearch"],W4(u));const c=d(e,["urlContext"]);return c!=null&&p(t,["urlContext"],c),t}function ab(e){const t={},n=d(e,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(h=>H4(h))),p(t,["functionDeclarations"],m)}const r=d(e,["retrieval"]);r!=null&&p(t,["retrieval"],r);const i=d(e,["googleSearchRetrieval"]);i!=null&&p(t,["googleSearchRetrieval"],i);const s=d(e,["computerUse"]);if(s!=null&&p(t,["computerUse"],s),d(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=d(e,["codeExecution"]);a!=null&&p(t,["codeExecution"],a);const o=d(e,["enterpriseWebSearch"]);o!=null&&p(t,["enterpriseWebSearch"],o);const u=d(e,["googleMaps"]);u!=null&&p(t,["googleMaps"],u);const c=d(e,["googleSearch"]);c!=null&&p(t,["googleSearch"],c);const l=d(e,["urlContext"]);return l!=null&&p(t,["urlContext"],l),t}function ob(e){const t={},n=d(e,["promptTokenCount"]);n!=null&&p(t,["promptTokenCount"],n);const r=d(e,["cachedContentTokenCount"]);r!=null&&p(t,["cachedContentTokenCount"],r);const i=d(e,["candidatesTokenCount"]);i!=null&&p(t,["responseTokenCount"],i);const s=d(e,["toolUsePromptTokenCount"]);s!=null&&p(t,["toolUsePromptTokenCount"],s);const a=d(e,["thoughtsTokenCount"]);a!=null&&p(t,["thoughtsTokenCount"],a);const o=d(e,["totalTokenCount"]);o!=null&&p(t,["totalTokenCount"],o);const u=d(e,["promptTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(x=>x)),p(t,["promptTokensDetails"],g)}const c=d(e,["cacheTokensDetails"]);if(c!=null){let g=c;Array.isArray(g)&&(g=g.map(x=>x)),p(t,["cacheTokensDetails"],g)}const l=d(e,["candidatesTokensDetails"]);if(l!=null){let g=l;Array.isArray(g)&&(g=g.map(x=>x)),p(t,["responseTokensDetails"],g)}const m=d(e,["toolUsePromptTokensDetails"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(x=>x)),p(t,["toolUsePromptTokensDetails"],g)}const h=d(e,["trafficType"]);return h!=null&&p(t,["trafficType"],h),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lb(e){const t={},n=d(e,["data"]);if(n!=null&&p(t,["data"],n),d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(e,["mimeType"]);return r!=null&&p(t,["mimeType"],r),t}function ub(e){const t={},n=d(e,["content"]);n!=null&&p(t,["content"],n);const r=d(e,["citationMetadata"]);r!=null&&p(t,["citationMetadata"],cb(r));const i=d(e,["tokenCount"]);i!=null&&p(t,["tokenCount"],i);const s=d(e,["finishReason"]);s!=null&&p(t,["finishReason"],s);const a=d(e,["avgLogprobs"]);a!=null&&p(t,["avgLogprobs"],a);const o=d(e,["groundingMetadata"]);o!=null&&p(t,["groundingMetadata"],o);const u=d(e,["index"]);u!=null&&p(t,["index"],u);const c=d(e,["logprobsResult"]);c!=null&&p(t,["logprobsResult"],c);const l=d(e,["safetyRatings"]);if(l!=null){let h=l;Array.isArray(h)&&(h=h.map(g=>g)),p(t,["safetyRatings"],h)}const m=d(e,["urlContextMetadata"]);return m!=null&&p(t,["urlContextMetadata"],m),t}function cb(e){const t={},n=d(e,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),p(t,["citations"],r)}return t}function db(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["contents"]);if(i!=null){let s=$n(i);Array.isArray(s)&&(s=s.map(a=>a)),p(n,["contents"],s)}return n}function fb(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),p(t,["tokensInfo"],i)}return t}function pb(e){const t={},n=d(e,["values"]);n!=null&&p(t,["values"],n);const r=d(e,["statistics"]);return r!=null&&p(t,["statistics"],hb(r)),t}function hb(e){const t={},n=d(e,["truncated"]);n!=null&&p(t,["truncated"],n);const r=d(e,["token_count"]);return r!=null&&p(t,["tokenCount"],r),t}function Mu(e){const t={},n=d(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>w3(s))),p(t,["parts"],i)}const r=d(e,["role"]);return r!=null&&p(t,["role"],r),t}function mb(e){const t={},n=d(e,["controlType"]);n!=null&&p(t,["controlType"],n);const r=d(e,["enableControlImageComputation"]);return r!=null&&p(t,["computeControl"],r),t}function gb(e){const t={};if(d(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function xb(e,t){const n={},r=d(e,["systemInstruction"]);t!==void 0&&r!=null&&p(t,["systemInstruction"],Qt(r));const i=d(e,["tools"]);if(t!==void 0&&i!=null){let a=i;Array.isArray(a)&&(a=a.map(o=>cy(o))),p(t,["tools"],a)}const s=d(e,["generationConfig"]);return t!==void 0&&s!=null&&p(t,["generationConfig"],l3(s)),n}function vb(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["contents"]);if(i!=null){let a=$n(i);Array.isArray(a)&&(a=a.map(o=>Mu(o))),p(n,["contents"],a)}const s=d(t,["config"]);return s!=null&&gb(s),n}function yb(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["contents"]);if(i!=null){let a=$n(i);Array.isArray(a)&&(a=a.map(o=>o)),p(n,["contents"],a)}const s=d(t,["config"]);return s!=null&&xb(s,n),n}function Eb(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["totalTokens"]);r!=null&&p(t,["totalTokens"],r);const i=d(e,["cachedContentTokenCount"]);return i!=null&&p(t,["cachedContentTokenCount"],i),t}function Tb(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["totalTokens"]);return r!=null&&p(t,["totalTokens"],r),t}function Sb(e,t){const n={},r=d(t,["model"]);return r!=null&&p(n,["_url","name"],Je(e,r)),n}function wb(e,t){const n={},r=d(t,["model"]);return r!=null&&p(n,["_url","name"],Je(e,r)),n}function _b(e){const t={},n=d(e,["sdkHttpResponse"]);return n!=null&&p(t,["sdkHttpResponse"],n),t}function Cb(e){const t={},n=d(e,["sdkHttpResponse"]);return n!=null&&p(t,["sdkHttpResponse"],n),t}function Nb(e,t){const n={},r=d(e,["outputGcsUri"]);t!==void 0&&r!=null&&p(t,["parameters","storageUri"],r);const i=d(e,["negativePrompt"]);t!==void 0&&i!=null&&p(t,["parameters","negativePrompt"],i);const s=d(e,["numberOfImages"]);t!==void 0&&s!=null&&p(t,["parameters","sampleCount"],s);const a=d(e,["aspectRatio"]);t!==void 0&&a!=null&&p(t,["parameters","aspectRatio"],a);const o=d(e,["guidanceScale"]);t!==void 0&&o!=null&&p(t,["parameters","guidanceScale"],o);const u=d(e,["seed"]);t!==void 0&&u!=null&&p(t,["parameters","seed"],u);const c=d(e,["safetyFilterLevel"]);t!==void 0&&c!=null&&p(t,["parameters","safetySetting"],c);const l=d(e,["personGeneration"]);t!==void 0&&l!=null&&p(t,["parameters","personGeneration"],l);const m=d(e,["includeSafetyAttributes"]);t!==void 0&&m!=null&&p(t,["parameters","includeSafetyAttributes"],m);const h=d(e,["includeRaiReason"]);t!==void 0&&h!=null&&p(t,["parameters","includeRaiReason"],h);const g=d(e,["language"]);t!==void 0&&g!=null&&p(t,["parameters","language"],g);const x=d(e,["outputMimeType"]);t!==void 0&&x!=null&&p(t,["parameters","outputOptions","mimeType"],x);const v=d(e,["outputCompressionQuality"]);t!==void 0&&v!=null&&p(t,["parameters","outputOptions","compressionQuality"],v);const w=d(e,["addWatermark"]);t!==void 0&&w!=null&&p(t,["parameters","addWatermark"],w);const E=d(e,["labels"]);t!==void 0&&E!=null&&p(t,["labels"],E);const y=d(e,["editMode"]);t!==void 0&&y!=null&&p(t,["parameters","editMode"],y);const T=d(e,["baseSteps"]);return t!==void 0&&T!=null&&p(t,["parameters","editConfig","baseSteps"],T),n}function Ab(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["prompt"]);i!=null&&p(n,["instances[0]","prompt"],i);const s=d(t,["referenceImages"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(u=>R3(u))),p(n,["instances[0]","referenceImages"],o)}const a=d(t,["config"]);return a!=null&&Nb(a,n),n}function Ib(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Du(s))),p(t,["generatedImages"],i)}return t}function Rb(e,t){const n={},r=d(e,["taskType"]);t!==void 0&&r!=null&&p(t,["requests[]","taskType"],r);const i=d(e,["title"]);t!==void 0&&i!=null&&p(t,["requests[]","title"],i);const s=d(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&p(t,["requests[]","outputDimensionality"],s),d(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function kb(e,t){const n={},r=d(e,["taskType"]);t!==void 0&&r!=null&&p(t,["instances[]","task_type"],r);const i=d(e,["title"]);t!==void 0&&i!=null&&p(t,["instances[]","title"],i);const s=d(e,["outputDimensionality"]);t!==void 0&&s!=null&&p(t,["parameters","outputDimensionality"],s);const a=d(e,["mimeType"]);t!==void 0&&a!=null&&p(t,["instances[]","mimeType"],a);const o=d(e,["autoTruncate"]);return t!==void 0&&o!=null&&p(t,["parameters","autoTruncate"],o),n}function bb(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["contents"]);if(i!=null){let o=t0(e,i);Array.isArray(o)&&(o=o.map(u=>u)),p(n,["requests[]","content"],o)}const s=d(t,["config"]);s!=null&&Rb(s,n);const a=d(t,["model"]);return a!==void 0&&p(n,["requests[]","model"],Je(e,a)),n}function Fb(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["contents"]);if(i!=null){let a=t0(e,i);Array.isArray(a)&&(a=a.map(o=>o)),p(n,["instances[]","content"],a)}const s=d(t,["config"]);return s!=null&&kb(s,n),n}function Pb(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["embeddings"],s)}const i=d(e,["metadata"]);return i!=null&&p(t,["metadata"],i),t}function Mb(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>pb(a))),p(t,["embeddings"],s)}const i=d(e,["metadata"]);return i!=null&&p(t,["metadata"],i),t}function Db(e){const t={},n=d(e,["endpoint"]);n!=null&&p(t,["name"],n);const r=d(e,["deployedModelId"]);return r!=null&&p(t,["deployedModelId"],r),t}function Lb(e){const t={};if(d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["fileUri"]);n!=null&&p(t,["fileUri"],n);const r=d(e,["mimeType"]);return r!=null&&p(t,["mimeType"],r),t}function Ob(e){const t={},n=d(e,["id"]);n!=null&&p(t,["id"],n);const r=d(e,["args"]);r!=null&&p(t,["args"],r);const i=d(e,["name"]);if(i!=null&&p(t,["name"],i),d(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function Ub(e){const t={},n=d(e,["mode"]);n!=null&&p(t,["mode"],n);const r=d(e,["allowedFunctionNames"]);if(r!=null&&p(t,["allowedFunctionNames"],r),d(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function Bb(e){const t={};if(d(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(e,["description"]);n!=null&&p(t,["description"],n);const r=d(e,["name"]);r!=null&&p(t,["name"],r);const i=d(e,["parameters"]);i!=null&&p(t,["parameters"],i);const s=d(e,["parametersJsonSchema"]);s!=null&&p(t,["parametersJsonSchema"],s);const a=d(e,["response"]);a!=null&&p(t,["response"],a);const o=d(e,["responseJsonSchema"]);return o!=null&&p(t,["responseJsonSchema"],o),t}function Gb(e,t,n){const r={},i=d(t,["systemInstruction"]);n!==void 0&&i!=null&&p(n,["systemInstruction"],Mu(Qt(i)));const s=d(t,["temperature"]);s!=null&&p(r,["temperature"],s);const a=d(t,["topP"]);a!=null&&p(r,["topP"],a);const o=d(t,["topK"]);o!=null&&p(r,["topK"],o);const u=d(t,["candidateCount"]);u!=null&&p(r,["candidateCount"],u);const c=d(t,["maxOutputTokens"]);c!=null&&p(r,["maxOutputTokens"],c);const l=d(t,["stopSequences"]);l!=null&&p(r,["stopSequences"],l);const m=d(t,["responseLogprobs"]);m!=null&&p(r,["responseLogprobs"],m);const h=d(t,["logprobs"]);h!=null&&p(r,["logprobs"],h);const g=d(t,["presencePenalty"]);g!=null&&p(r,["presencePenalty"],g);const x=d(t,["frequencyPenalty"]);x!=null&&p(r,["frequencyPenalty"],x);const v=d(t,["seed"]);v!=null&&p(r,["seed"],v);const w=d(t,["responseMimeType"]);w!=null&&p(r,["responseMimeType"],w);const E=d(t,["responseSchema"]);E!=null&&p(r,["responseSchema"],n0(E));const y=d(t,["responseJsonSchema"]);if(y!=null&&p(r,["responseJsonSchema"],y),d(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const T=d(t,["safetySettings"]);if(n!==void 0&&T!=null){let X=T;Array.isArray(X)&&(X=X.map(ne=>k3(ne))),p(n,["safetySettings"],X)}const C=d(t,["tools"]);if(n!==void 0&&C!=null){let X=ta(C);Array.isArray(X)&&(X=X.map(ne=>O3(ea(ne)))),p(n,["tools"],X)}const L=d(t,["toolConfig"]);if(n!==void 0&&L!=null&&p(n,["toolConfig"],L3(L)),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const B=d(t,["cachedContent"]);n!==void 0&&B!=null&&p(n,["cachedContent"],Lr(e,B));const R=d(t,["responseModalities"]);R!=null&&p(r,["responseModalities"],R);const O=d(t,["mediaResolution"]);O!=null&&p(r,["mediaResolution"],O);const M=d(t,["speechConfig"]);if(M!=null&&p(r,["speechConfig"],r0(M)),d(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=d(t,["thinkingConfig"]);k!=null&&p(r,["thinkingConfig"],k);const z=d(t,["imageConfig"]);return z!=null&&p(r,["imageConfig"],p3(z)),r}function $b(e,t,n){const r={},i=d(t,["systemInstruction"]);n!==void 0&&i!=null&&p(n,["systemInstruction"],Qt(i));const s=d(t,["temperature"]);s!=null&&p(r,["temperature"],s);const a=d(t,["topP"]);a!=null&&p(r,["topP"],a);const o=d(t,["topK"]);o!=null&&p(r,["topK"],o);const u=d(t,["candidateCount"]);u!=null&&p(r,["candidateCount"],u);const c=d(t,["maxOutputTokens"]);c!=null&&p(r,["maxOutputTokens"],c);const l=d(t,["stopSequences"]);l!=null&&p(r,["stopSequences"],l);const m=d(t,["responseLogprobs"]);m!=null&&p(r,["responseLogprobs"],m);const h=d(t,["logprobs"]);h!=null&&p(r,["logprobs"],h);const g=d(t,["presencePenalty"]);g!=null&&p(r,["presencePenalty"],g);const x=d(t,["frequencyPenalty"]);x!=null&&p(r,["frequencyPenalty"],x);const v=d(t,["seed"]);v!=null&&p(r,["seed"],v);const w=d(t,["responseMimeType"]);w!=null&&p(r,["responseMimeType"],w);const E=d(t,["responseSchema"]);E!=null&&p(r,["responseSchema"],n0(E));const y=d(t,["responseJsonSchema"]);y!=null&&p(r,["responseJsonSchema"],y);const T=d(t,["routingConfig"]);T!=null&&p(r,["routingConfig"],T);const C=d(t,["modelSelectionConfig"]);C!=null&&p(r,["modelConfig"],C);const L=d(t,["safetySettings"]);if(n!==void 0&&L!=null){let ue=L;Array.isArray(ue)&&(ue=ue.map(ke=>ke)),p(n,["safetySettings"],ue)}const B=d(t,["tools"]);if(n!==void 0&&B!=null){let ue=ta(B);Array.isArray(ue)&&(ue=ue.map(ke=>cy(ea(ke)))),p(n,["tools"],ue)}const R=d(t,["toolConfig"]);n!==void 0&&R!=null&&p(n,["toolConfig"],R);const O=d(t,["labels"]);n!==void 0&&O!=null&&p(n,["labels"],O);const M=d(t,["cachedContent"]);n!==void 0&&M!=null&&p(n,["cachedContent"],Lr(e,M));const k=d(t,["responseModalities"]);k!=null&&p(r,["responseModalities"],k);const z=d(t,["mediaResolution"]);z!=null&&p(r,["mediaResolution"],z);const X=d(t,["speechConfig"]);X!=null&&p(r,["speechConfig"],uy(r0(X)));const ne=d(t,["audioTimestamp"]);ne!=null&&p(r,["audioTimestamp"],ne);const Fe=d(t,["thinkingConfig"]);Fe!=null&&p(r,["thinkingConfig"],Fe);const q=d(t,["imageConfig"]);return q!=null&&p(r,["imageConfig"],h3(q)),r}function Dm(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["contents"]);if(i!=null){let a=$n(i);Array.isArray(a)&&(a=a.map(o=>Mu(o))),p(n,["contents"],a)}const s=d(t,["config"]);return s!=null&&p(n,["generationConfig"],Gb(e,s,n)),n}function Lm(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["contents"]);if(i!=null){let a=$n(i);Array.isArray(a)&&(a=a.map(o=>o)),p(n,["contents"],a)}const s=d(t,["config"]);return s!=null&&p(n,["generationConfig"],$b(e,s,n)),n}function Om(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>ub(c))),p(t,["candidates"],u)}const i=d(e,["modelVersion"]);i!=null&&p(t,["modelVersion"],i);const s=d(e,["promptFeedback"]);s!=null&&p(t,["promptFeedback"],s);const a=d(e,["responseId"]);a!=null&&p(t,["responseId"],a);const o=d(e,["usageMetadata"]);return o!=null&&p(t,["usageMetadata"],o),t}function Um(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["candidates"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(l=>l)),p(t,["candidates"],c)}const i=d(e,["createTime"]);i!=null&&p(t,["createTime"],i);const s=d(e,["modelVersion"]);s!=null&&p(t,["modelVersion"],s);const a=d(e,["promptFeedback"]);a!=null&&p(t,["promptFeedback"],a);const o=d(e,["responseId"]);o!=null&&p(t,["responseId"],o);const u=d(e,["usageMetadata"]);return u!=null&&p(t,["usageMetadata"],u),t}function Vb(e,t){const n={};if(d(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=d(e,["numberOfImages"]);t!==void 0&&r!=null&&p(t,["parameters","sampleCount"],r);const i=d(e,["aspectRatio"]);t!==void 0&&i!=null&&p(t,["parameters","aspectRatio"],i);const s=d(e,["guidanceScale"]);if(t!==void 0&&s!=null&&p(t,["parameters","guidanceScale"],s),d(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=d(e,["safetyFilterLevel"]);t!==void 0&&a!=null&&p(t,["parameters","safetySetting"],a);const o=d(e,["personGeneration"]);t!==void 0&&o!=null&&p(t,["parameters","personGeneration"],o);const u=d(e,["includeSafetyAttributes"]);t!==void 0&&u!=null&&p(t,["parameters","includeSafetyAttributes"],u);const c=d(e,["includeRaiReason"]);t!==void 0&&c!=null&&p(t,["parameters","includeRaiReason"],c);const l=d(e,["language"]);t!==void 0&&l!=null&&p(t,["parameters","language"],l);const m=d(e,["outputMimeType"]);t!==void 0&&m!=null&&p(t,["parameters","outputOptions","mimeType"],m);const h=d(e,["outputCompressionQuality"]);if(t!==void 0&&h!=null&&p(t,["parameters","outputOptions","compressionQuality"],h),d(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const g=d(e,["imageSize"]);if(t!==void 0&&g!=null&&p(t,["parameters","sampleImageSize"],g),d(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function jb(e,t){const n={},r=d(e,["outputGcsUri"]);t!==void 0&&r!=null&&p(t,["parameters","storageUri"],r);const i=d(e,["negativePrompt"]);t!==void 0&&i!=null&&p(t,["parameters","negativePrompt"],i);const s=d(e,["numberOfImages"]);t!==void 0&&s!=null&&p(t,["parameters","sampleCount"],s);const a=d(e,["aspectRatio"]);t!==void 0&&a!=null&&p(t,["parameters","aspectRatio"],a);const o=d(e,["guidanceScale"]);t!==void 0&&o!=null&&p(t,["parameters","guidanceScale"],o);const u=d(e,["seed"]);t!==void 0&&u!=null&&p(t,["parameters","seed"],u);const c=d(e,["safetyFilterLevel"]);t!==void 0&&c!=null&&p(t,["parameters","safetySetting"],c);const l=d(e,["personGeneration"]);t!==void 0&&l!=null&&p(t,["parameters","personGeneration"],l);const m=d(e,["includeSafetyAttributes"]);t!==void 0&&m!=null&&p(t,["parameters","includeSafetyAttributes"],m);const h=d(e,["includeRaiReason"]);t!==void 0&&h!=null&&p(t,["parameters","includeRaiReason"],h);const g=d(e,["language"]);t!==void 0&&g!=null&&p(t,["parameters","language"],g);const x=d(e,["outputMimeType"]);t!==void 0&&x!=null&&p(t,["parameters","outputOptions","mimeType"],x);const v=d(e,["outputCompressionQuality"]);t!==void 0&&v!=null&&p(t,["parameters","outputOptions","compressionQuality"],v);const w=d(e,["addWatermark"]);t!==void 0&&w!=null&&p(t,["parameters","addWatermark"],w);const E=d(e,["labels"]);t!==void 0&&E!=null&&p(t,["labels"],E);const y=d(e,["imageSize"]);t!==void 0&&y!=null&&p(t,["parameters","sampleImageSize"],y);const T=d(e,["enhancePrompt"]);return t!==void 0&&T!=null&&p(t,["parameters","enhancePrompt"],T),n}function Hb(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["prompt"]);i!=null&&p(n,["instances[0]","prompt"],i);const s=d(t,["config"]);return s!=null&&Vb(s,n),n}function zb(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["prompt"]);i!=null&&p(n,["instances[0]","prompt"],i);const s=d(t,["config"]);return s!=null&&jb(s,n),n}function qb(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>i3(a))),p(t,["generatedImages"],s)}const i=d(e,["positivePromptSafetyAttributes"]);return i!=null&&p(t,["positivePromptSafetyAttributes"],oy(i)),t}function Wb(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>Du(a))),p(t,["generatedImages"],s)}const i=d(e,["positivePromptSafetyAttributes"]);return i!=null&&p(t,["positivePromptSafetyAttributes"],ly(i)),t}function Jb(e,t){const n={},r=d(e,["numberOfVideos"]);if(t!==void 0&&r!=null&&p(t,["parameters","sampleCount"],r),d(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=d(e,["durationSeconds"]);if(t!==void 0&&i!=null&&p(t,["parameters","durationSeconds"],i),d(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=d(e,["aspectRatio"]);t!==void 0&&s!=null&&p(t,["parameters","aspectRatio"],s);const a=d(e,["resolution"]);t!==void 0&&a!=null&&p(t,["parameters","resolution"],a);const o=d(e,["personGeneration"]);if(t!==void 0&&o!=null&&p(t,["parameters","personGeneration"],o),d(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=d(e,["negativePrompt"]);t!==void 0&&u!=null&&p(t,["parameters","negativePrompt"],u);const c=d(e,["enhancePrompt"]);if(t!==void 0&&c!=null&&p(t,["parameters","enhancePrompt"],c),d(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const l=d(e,["lastFrame"]);t!==void 0&&l!=null&&p(t,["instances[0]","lastFrame"],Lu(l));const m=d(e,["referenceImages"]);if(t!==void 0&&m!=null){let h=m;Array.isArray(h)&&(h=h.map(g=>K3(g))),p(t,["instances[0]","referenceImages"],h)}if(d(e,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(d(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function Yb(e,t){const n={},r=d(e,["numberOfVideos"]);t!==void 0&&r!=null&&p(t,["parameters","sampleCount"],r);const i=d(e,["outputGcsUri"]);t!==void 0&&i!=null&&p(t,["parameters","storageUri"],i);const s=d(e,["fps"]);t!==void 0&&s!=null&&p(t,["parameters","fps"],s);const a=d(e,["durationSeconds"]);t!==void 0&&a!=null&&p(t,["parameters","durationSeconds"],a);const o=d(e,["seed"]);t!==void 0&&o!=null&&p(t,["parameters","seed"],o);const u=d(e,["aspectRatio"]);t!==void 0&&u!=null&&p(t,["parameters","aspectRatio"],u);const c=d(e,["resolution"]);t!==void 0&&c!=null&&p(t,["parameters","resolution"],c);const l=d(e,["personGeneration"]);t!==void 0&&l!=null&&p(t,["parameters","personGeneration"],l);const m=d(e,["pubsubTopic"]);t!==void 0&&m!=null&&p(t,["parameters","pubsubTopic"],m);const h=d(e,["negativePrompt"]);t!==void 0&&h!=null&&p(t,["parameters","negativePrompt"],h);const g=d(e,["enhancePrompt"]);t!==void 0&&g!=null&&p(t,["parameters","enhancePrompt"],g);const x=d(e,["generateAudio"]);t!==void 0&&x!=null&&p(t,["parameters","generateAudio"],x);const v=d(e,["lastFrame"]);t!==void 0&&v!=null&&p(t,["instances[0]","lastFrame"],sr(v));const w=d(e,["referenceImages"]);if(t!==void 0&&w!=null){let T=w;Array.isArray(T)&&(T=T.map(C=>X3(C))),p(t,["instances[0]","referenceImages"],T)}const E=d(e,["mask"]);t!==void 0&&E!=null&&p(t,["instances[0]","mask"],Y3(E));const y=d(e,["compressionQuality"]);return t!==void 0&&y!=null&&p(t,["parameters","compressionQuality"],y),n}function Kb(e){const t={},n=d(e,["name"]);n!=null&&p(t,["name"],n);const r=d(e,["metadata"]);r!=null&&p(t,["metadata"],r);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["response","generateVideoResponse"]);return a!=null&&p(t,["response"],e3(a)),t}function Xb(e){const t={},n=d(e,["name"]);n!=null&&p(t,["name"],n);const r=d(e,["metadata"]);r!=null&&p(t,["metadata"],r);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["response"]);return a!=null&&p(t,["response"],t3(a)),t}function Qb(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["prompt"]);i!=null&&p(n,["instances[0]","prompt"],i);const s=d(t,["image"]);s!=null&&p(n,["instances[0]","image"],Lu(s));const a=d(t,["video"]);a!=null&&p(n,["instances[0]","video"],dy(a));const o=d(t,["source"]);o!=null&&n3(o,n);const u=d(t,["config"]);return u!=null&&Jb(u,n),n}function Zb(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["prompt"]);i!=null&&p(n,["instances[0]","prompt"],i);const s=d(t,["image"]);s!=null&&p(n,["instances[0]","image"],sr(s));const a=d(t,["video"]);a!=null&&p(n,["instances[0]","video"],fy(a));const o=d(t,["source"]);o!=null&&r3(o,n);const u=d(t,["config"]);return u!=null&&Yb(u,n),n}function e3(e){const t={},n=d(e,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>a3(a))),p(t,["generatedVideos"],s)}const r=d(e,["raiMediaFilteredCount"]);r!=null&&p(t,["raiMediaFilteredCount"],r);const i=d(e,["raiMediaFilteredReasons"]);return i!=null&&p(t,["raiMediaFilteredReasons"],i),t}function t3(e){const t={},n=d(e,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>o3(a))),p(t,["generatedVideos"],s)}const r=d(e,["raiMediaFilteredCount"]);r!=null&&p(t,["raiMediaFilteredCount"],r);const i=d(e,["raiMediaFilteredReasons"]);return i!=null&&p(t,["raiMediaFilteredReasons"],i),t}function n3(e,t){const n={},r=d(e,["prompt"]);t!==void 0&&r!=null&&p(t,["instances[0]","prompt"],r);const i=d(e,["image"]);t!==void 0&&i!=null&&p(t,["instances[0]","image"],Lu(i));const s=d(e,["video"]);return t!==void 0&&s!=null&&p(t,["instances[0]","video"],dy(s)),n}function r3(e,t){const n={},r=d(e,["prompt"]);t!==void 0&&r!=null&&p(t,["instances[0]","prompt"],r);const i=d(e,["image"]);t!==void 0&&i!=null&&p(t,["instances[0]","image"],sr(i));const s=d(e,["video"]);return t!==void 0&&s!=null&&p(t,["instances[0]","video"],fy(s)),n}function i3(e){const t={},n=d(e,["_self"]);n!=null&&p(t,["image"],m3(n));const r=d(e,["raiFilteredReason"]);r!=null&&p(t,["raiFilteredReason"],r);const i=d(e,["_self"]);return i!=null&&p(t,["safetyAttributes"],oy(i)),t}function Du(e){const t={},n=d(e,["_self"]);n!=null&&p(t,["image"],ay(n));const r=d(e,["raiFilteredReason"]);r!=null&&p(t,["raiFilteredReason"],r);const i=d(e,["_self"]);i!=null&&p(t,["safetyAttributes"],ly(i));const s=d(e,["prompt"]);return s!=null&&p(t,["enhancedPrompt"],s),t}function s3(e){const t={},n=d(e,["_self"]);n!=null&&p(t,["mask"],ay(n));const r=d(e,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),p(t,["labels"],i)}return t}function a3(e){const t={},n=d(e,["video"]);return n!=null&&p(t,["video"],W3(n)),t}function o3(e){const t={},n=d(e,["_self"]);return n!=null&&p(t,["video"],J3(n)),t}function l3(e){const t={},n=d(e,["modelSelectionConfig"]);n!=null&&p(t,["modelConfig"],n);const r=d(e,["responseJsonSchema"]);r!=null&&p(t,["responseJsonSchema"],r);const i=d(e,["audioTimestamp"]);i!=null&&p(t,["audioTimestamp"],i);const s=d(e,["candidateCount"]);s!=null&&p(t,["candidateCount"],s);const a=d(e,["enableAffectiveDialog"]);a!=null&&p(t,["enableAffectiveDialog"],a);const o=d(e,["frequencyPenalty"]);o!=null&&p(t,["frequencyPenalty"],o);const u=d(e,["logprobs"]);u!=null&&p(t,["logprobs"],u);const c=d(e,["maxOutputTokens"]);c!=null&&p(t,["maxOutputTokens"],c);const l=d(e,["mediaResolution"]);l!=null&&p(t,["mediaResolution"],l);const m=d(e,["presencePenalty"]);m!=null&&p(t,["presencePenalty"],m);const h=d(e,["responseLogprobs"]);h!=null&&p(t,["responseLogprobs"],h);const g=d(e,["responseMimeType"]);g!=null&&p(t,["responseMimeType"],g);const x=d(e,["responseModalities"]);x!=null&&p(t,["responseModalities"],x);const v=d(e,["responseSchema"]);v!=null&&p(t,["responseSchema"],v);const w=d(e,["routingConfig"]);w!=null&&p(t,["routingConfig"],w);const E=d(e,["seed"]);E!=null&&p(t,["seed"],E);const y=d(e,["speechConfig"]);y!=null&&p(t,["speechConfig"],uy(y));const T=d(e,["stopSequences"]);T!=null&&p(t,["stopSequences"],T);const C=d(e,["temperature"]);C!=null&&p(t,["temperature"],C);const L=d(e,["thinkingConfig"]);L!=null&&p(t,["thinkingConfig"],L);const B=d(e,["topK"]);B!=null&&p(t,["topK"],B);const R=d(e,["topP"]);if(R!=null&&p(t,["topP"],R),d(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function u3(e,t){const n={},r=d(t,["model"]);return r!=null&&p(n,["_url","name"],Je(e,r)),n}function c3(e,t){const n={},r=d(t,["model"]);return r!=null&&p(n,["_url","name"],Je(e,r)),n}function d3(e){const t={};if(d(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(e,["enableWidget"]);return n!=null&&p(t,["enableWidget"],n),t}function f3(e){const t={};if(d(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(e,["timeRangeFilter"]);return n!=null&&p(t,["timeRangeFilter"],n),t}function p3(e){const t={},n=d(e,["aspectRatio"]);n!=null&&p(t,["aspectRatio"],n);const r=d(e,["imageSize"]);if(r!=null&&p(t,["imageSize"],r),d(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(d(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function h3(e){const t={},n=d(e,["aspectRatio"]);n!=null&&p(t,["aspectRatio"],n);const r=d(e,["imageSize"]);r!=null&&p(t,["imageSize"],r);const i=d(e,["outputMimeType"]);i!=null&&p(t,["imageOutputOptions","mimeType"],i);const s=d(e,["outputCompressionQuality"]);return s!=null&&p(t,["imageOutputOptions","compressionQuality"],s),t}function m3(e){const t={},n=d(e,["bytesBase64Encoded"]);n!=null&&p(t,["imageBytes"],pi(n));const r=d(e,["mimeType"]);return r!=null&&p(t,["mimeType"],r),t}function ay(e){const t={},n=d(e,["gcsUri"]);n!=null&&p(t,["gcsUri"],n);const r=d(e,["bytesBase64Encoded"]);r!=null&&p(t,["imageBytes"],pi(r));const i=d(e,["mimeType"]);return i!=null&&p(t,["mimeType"],i),t}function Lu(e){const t={};if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=d(e,["imageBytes"]);n!=null&&p(t,["bytesBase64Encoded"],pi(n));const r=d(e,["mimeType"]);return r!=null&&p(t,["mimeType"],r),t}function sr(e){const t={},n=d(e,["gcsUri"]);n!=null&&p(t,["gcsUri"],n);const r=d(e,["imageBytes"]);r!=null&&p(t,["bytesBase64Encoded"],pi(r));const i=d(e,["mimeType"]);return i!=null&&p(t,["mimeType"],i),t}function g3(e,t,n){const r={},i=d(t,["pageSize"]);n!==void 0&&i!=null&&p(n,["_query","pageSize"],i);const s=d(t,["pageToken"]);n!==void 0&&s!=null&&p(n,["_query","pageToken"],s);const a=d(t,["filter"]);n!==void 0&&a!=null&&p(n,["_query","filter"],a);const o=d(t,["queryBase"]);return n!==void 0&&o!=null&&p(n,["_url","models_url"],Qv(e,o)),r}function x3(e,t,n){const r={},i=d(t,["pageSize"]);n!==void 0&&i!=null&&p(n,["_query","pageSize"],i);const s=d(t,["pageToken"]);n!==void 0&&s!=null&&p(n,["_query","pageToken"],s);const a=d(t,["filter"]);n!==void 0&&a!=null&&p(n,["_query","filter"],a);const o=d(t,["queryBase"]);return n!==void 0&&o!=null&&p(n,["_url","models_url"],Qv(e,o)),r}function v3(e,t){const n={},r=d(t,["config"]);return r!=null&&g3(e,r,n),n}function y3(e,t){const n={},r=d(t,["config"]);return r!=null&&x3(e,r,n),n}function E3(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["nextPageToken"]);r!=null&&p(t,["nextPageToken"],r);const i=d(e,["_self"]);if(i!=null){let s=Zv(i);Array.isArray(s)&&(s=s.map(a=>kd(a))),p(t,["models"],s)}return t}function T3(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["nextPageToken"]);r!=null&&p(t,["nextPageToken"],r);const i=d(e,["_self"]);if(i!=null){let s=Zv(i);Array.isArray(s)&&(s=s.map(a=>bd(a))),p(t,["models"],s)}return t}function S3(e){const t={},n=d(e,["maskMode"]);n!=null&&p(t,["maskMode"],n);const r=d(e,["segmentationClasses"]);r!=null&&p(t,["maskClasses"],r);const i=d(e,["maskDilation"]);return i!=null&&p(t,["dilation"],i),t}function kd(e){const t={},n=d(e,["name"]);n!=null&&p(t,["name"],n);const r=d(e,["displayName"]);r!=null&&p(t,["displayName"],r);const i=d(e,["description"]);i!=null&&p(t,["description"],i);const s=d(e,["version"]);s!=null&&p(t,["version"],s);const a=d(e,["_self"]);a!=null&&p(t,["tunedModelInfo"],U3(a));const o=d(e,["inputTokenLimit"]);o!=null&&p(t,["inputTokenLimit"],o);const u=d(e,["outputTokenLimit"]);u!=null&&p(t,["outputTokenLimit"],u);const c=d(e,["supportedGenerationMethods"]);c!=null&&p(t,["supportedActions"],c);const l=d(e,["temperature"]);l!=null&&p(t,["temperature"],l);const m=d(e,["maxTemperature"]);m!=null&&p(t,["maxTemperature"],m);const h=d(e,["topP"]);h!=null&&p(t,["topP"],h);const g=d(e,["topK"]);g!=null&&p(t,["topK"],g);const x=d(e,["thinking"]);return x!=null&&p(t,["thinking"],x),t}function bd(e){const t={},n=d(e,["name"]);n!=null&&p(t,["name"],n);const r=d(e,["displayName"]);r!=null&&p(t,["displayName"],r);const i=d(e,["description"]);i!=null&&p(t,["description"],i);const s=d(e,["versionId"]);s!=null&&p(t,["version"],s);const a=d(e,["deployedModels"]);if(a!=null){let m=a;Array.isArray(m)&&(m=m.map(h=>Db(h))),p(t,["endpoints"],m)}const o=d(e,["labels"]);o!=null&&p(t,["labels"],o);const u=d(e,["_self"]);u!=null&&p(t,["tunedModelInfo"],B3(u));const c=d(e,["defaultCheckpointId"]);c!=null&&p(t,["defaultCheckpointId"],c);const l=d(e,["checkpoints"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(h=>h)),p(t,["checkpoints"],m)}return t}function w3(e){const t={},n=d(e,["mediaResolution"]);n!=null&&p(t,["mediaResolution"],n);const r=d(e,["codeExecutionResult"]);r!=null&&p(t,["codeExecutionResult"],r);const i=d(e,["executableCode"]);i!=null&&p(t,["executableCode"],i);const s=d(e,["fileData"]);s!=null&&p(t,["fileData"],Lb(s));const a=d(e,["functionCall"]);a!=null&&p(t,["functionCall"],Ob(a));const o=d(e,["functionResponse"]);o!=null&&p(t,["functionResponse"],o);const u=d(e,["inlineData"]);u!=null&&p(t,["inlineData"],lb(u));const c=d(e,["text"]);c!=null&&p(t,["text"],c);const l=d(e,["thought"]);l!=null&&p(t,["thought"],l);const m=d(e,["thoughtSignature"]);m!=null&&p(t,["thoughtSignature"],m);const h=d(e,["videoMetadata"]);return h!=null&&p(t,["videoMetadata"],h),t}function _3(e){const t={},n=d(e,["productImage"]);return n!=null&&p(t,["image"],sr(n)),t}function C3(e,t){const n={},r=d(e,["numberOfImages"]);t!==void 0&&r!=null&&p(t,["parameters","sampleCount"],r);const i=d(e,["baseSteps"]);t!==void 0&&i!=null&&p(t,["parameters","baseSteps"],i);const s=d(e,["outputGcsUri"]);t!==void 0&&s!=null&&p(t,["parameters","storageUri"],s);const a=d(e,["seed"]);t!==void 0&&a!=null&&p(t,["parameters","seed"],a);const o=d(e,["safetyFilterLevel"]);t!==void 0&&o!=null&&p(t,["parameters","safetySetting"],o);const u=d(e,["personGeneration"]);t!==void 0&&u!=null&&p(t,["parameters","personGeneration"],u);const c=d(e,["addWatermark"]);t!==void 0&&c!=null&&p(t,["parameters","addWatermark"],c);const l=d(e,["outputMimeType"]);t!==void 0&&l!=null&&p(t,["parameters","outputOptions","mimeType"],l);const m=d(e,["outputCompressionQuality"]);t!==void 0&&m!=null&&p(t,["parameters","outputOptions","compressionQuality"],m);const h=d(e,["enhancePrompt"]);t!==void 0&&h!=null&&p(t,["parameters","enhancePrompt"],h);const g=d(e,["labels"]);return t!==void 0&&g!=null&&p(t,["labels"],g),n}function N3(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["source"]);i!=null&&I3(i,n);const s=d(t,["config"]);return s!=null&&C3(s,n),n}function A3(e){const t={},n=d(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Du(i))),p(t,["generatedImages"],r)}return t}function I3(e,t){const n={},r=d(e,["prompt"]);t!==void 0&&r!=null&&p(t,["instances[0]","prompt"],r);const i=d(e,["personImage"]);t!==void 0&&i!=null&&p(t,["instances[0]","personImage","image"],sr(i));const s=d(e,["productImages"]);if(t!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>_3(o))),p(t,["instances[0]","productImages"],a)}return n}function R3(e){const t={},n=d(e,["referenceImage"]);n!=null&&p(t,["referenceImage"],sr(n));const r=d(e,["referenceId"]);r!=null&&p(t,["referenceId"],r);const i=d(e,["referenceType"]);i!=null&&p(t,["referenceType"],i);const s=d(e,["maskImageConfig"]);s!=null&&p(t,["maskImageConfig"],S3(s));const a=d(e,["controlImageConfig"]);a!=null&&p(t,["controlImageConfig"],mb(a));const o=d(e,["styleImageConfig"]);o!=null&&p(t,["styleImageConfig"],o);const u=d(e,["subjectImageConfig"]);return u!=null&&p(t,["subjectImageConfig"],u),t}function oy(e){const t={},n=d(e,["safetyAttributes","categories"]);n!=null&&p(t,["categories"],n);const r=d(e,["safetyAttributes","scores"]);r!=null&&p(t,["scores"],r);const i=d(e,["contentType"]);return i!=null&&p(t,["contentType"],i),t}function ly(e){const t={},n=d(e,["safetyAttributes","categories"]);n!=null&&p(t,["categories"],n);const r=d(e,["safetyAttributes","scores"]);r!=null&&p(t,["scores"],r);const i=d(e,["contentType"]);return i!=null&&p(t,["contentType"],i),t}function k3(e){const t={},n=d(e,["category"]);if(n!=null&&p(t,["category"],n),d(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=d(e,["threshold"]);return r!=null&&p(t,["threshold"],r),t}function b3(e){const t={},n=d(e,["image"]);return n!=null&&p(t,["image"],sr(n)),t}function F3(e,t){const n={},r=d(e,["mode"]);t!==void 0&&r!=null&&p(t,["parameters","mode"],r);const i=d(e,["maxPredictions"]);t!==void 0&&i!=null&&p(t,["parameters","maxPredictions"],i);const s=d(e,["confidenceThreshold"]);t!==void 0&&s!=null&&p(t,["parameters","confidenceThreshold"],s);const a=d(e,["maskDilation"]);t!==void 0&&a!=null&&p(t,["parameters","maskDilation"],a);const o=d(e,["binaryColorThreshold"]);t!==void 0&&o!=null&&p(t,["parameters","binaryColorThreshold"],o);const u=d(e,["labels"]);return t!==void 0&&u!=null&&p(t,["labels"],u),n}function P3(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["source"]);i!=null&&D3(i,n);const s=d(t,["config"]);return s!=null&&F3(s,n),n}function M3(e){const t={},n=d(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>s3(i))),p(t,["generatedMasks"],r)}return t}function D3(e,t){const n={},r=d(e,["prompt"]);t!==void 0&&r!=null&&p(t,["instances[0]","prompt"],r);const i=d(e,["image"]);t!==void 0&&i!=null&&p(t,["instances[0]","image"],sr(i));const s=d(e,["scribbleImage"]);return t!==void 0&&s!=null&&p(t,["instances[0]","scribble"],b3(s)),n}function uy(e){const t={},n=d(e,["languageCode"]);n!=null&&p(t,["languageCode"],n);const r=d(e,["voiceConfig"]);if(r!=null&&p(t,["voiceConfig"],r),d(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function L3(e){const t={},n=d(e,["functionCallingConfig"]);n!=null&&p(t,["functionCallingConfig"],Ub(n));const r=d(e,["retrievalConfig"]);return r!=null&&p(t,["retrievalConfig"],r),t}function O3(e){const t={},n=d(e,["functionDeclarations"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(m=>m)),p(t,["functionDeclarations"],l)}if(d(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(e,["googleSearchRetrieval"]);r!=null&&p(t,["googleSearchRetrieval"],r);const i=d(e,["computerUse"]);i!=null&&p(t,["computerUse"],i);const s=d(e,["fileSearch"]);s!=null&&p(t,["fileSearch"],s);const a=d(e,["codeExecution"]);if(a!=null&&p(t,["codeExecution"],a),d(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=d(e,["googleMaps"]);o!=null&&p(t,["googleMaps"],d3(o));const u=d(e,["googleSearch"]);u!=null&&p(t,["googleSearch"],f3(u));const c=d(e,["urlContext"]);return c!=null&&p(t,["urlContext"],c),t}function cy(e){const t={},n=d(e,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(h=>Bb(h))),p(t,["functionDeclarations"],m)}const r=d(e,["retrieval"]);r!=null&&p(t,["retrieval"],r);const i=d(e,["googleSearchRetrieval"]);i!=null&&p(t,["googleSearchRetrieval"],i);const s=d(e,["computerUse"]);if(s!=null&&p(t,["computerUse"],s),d(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=d(e,["codeExecution"]);a!=null&&p(t,["codeExecution"],a);const o=d(e,["enterpriseWebSearch"]);o!=null&&p(t,["enterpriseWebSearch"],o);const u=d(e,["googleMaps"]);u!=null&&p(t,["googleMaps"],u);const c=d(e,["googleSearch"]);c!=null&&p(t,["googleSearch"],c);const l=d(e,["urlContext"]);return l!=null&&p(t,["urlContext"],l),t}function U3(e){const t={},n=d(e,["baseModel"]);n!=null&&p(t,["baseModel"],n);const r=d(e,["createTime"]);r!=null&&p(t,["createTime"],r);const i=d(e,["updateTime"]);return i!=null&&p(t,["updateTime"],i),t}function B3(e){const t={},n=d(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&p(t,["baseModel"],n);const r=d(e,["createTime"]);r!=null&&p(t,["createTime"],r);const i=d(e,["updateTime"]);return i!=null&&p(t,["updateTime"],i),t}function G3(e,t){const n={},r=d(e,["displayName"]);t!==void 0&&r!=null&&p(t,["displayName"],r);const i=d(e,["description"]);t!==void 0&&i!=null&&p(t,["description"],i);const s=d(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&p(t,["defaultCheckpointId"],s),n}function $3(e,t){const n={},r=d(e,["displayName"]);t!==void 0&&r!=null&&p(t,["displayName"],r);const i=d(e,["description"]);t!==void 0&&i!=null&&p(t,["description"],i);const s=d(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&p(t,["defaultCheckpointId"],s),n}function V3(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","name"],Je(e,r));const i=d(t,["config"]);return i!=null&&G3(i,n),n}function j3(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["config"]);return i!=null&&$3(i,n),n}function H3(e,t){const n={},r=d(e,["outputGcsUri"]);t!==void 0&&r!=null&&p(t,["parameters","storageUri"],r);const i=d(e,["safetyFilterLevel"]);t!==void 0&&i!=null&&p(t,["parameters","safetySetting"],i);const s=d(e,["personGeneration"]);t!==void 0&&s!=null&&p(t,["parameters","personGeneration"],s);const a=d(e,["includeRaiReason"]);t!==void 0&&a!=null&&p(t,["parameters","includeRaiReason"],a);const o=d(e,["outputMimeType"]);t!==void 0&&o!=null&&p(t,["parameters","outputOptions","mimeType"],o);const u=d(e,["outputCompressionQuality"]);t!==void 0&&u!=null&&p(t,["parameters","outputOptions","compressionQuality"],u);const c=d(e,["enhanceInputImage"]);t!==void 0&&c!=null&&p(t,["parameters","upscaleConfig","enhanceInputImage"],c);const l=d(e,["imagePreservationFactor"]);t!==void 0&&l!=null&&p(t,["parameters","upscaleConfig","imagePreservationFactor"],l);const m=d(e,["labels"]);t!==void 0&&m!=null&&p(t,["labels"],m);const h=d(e,["numberOfImages"]);t!==void 0&&h!=null&&p(t,["parameters","sampleCount"],h);const g=d(e,["mode"]);return t!==void 0&&g!=null&&p(t,["parameters","mode"],g),n}function z3(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["_url","model"],Je(e,r));const i=d(t,["image"]);i!=null&&p(n,["instances[0]","image"],sr(i));const s=d(t,["upscaleFactor"]);s!=null&&p(n,["parameters","upscaleConfig","upscaleFactor"],s);const a=d(t,["config"]);return a!=null&&H3(a,n),n}function q3(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Du(s))),p(t,["generatedImages"],i)}return t}function W3(e){const t={},n=d(e,["uri"]);n!=null&&p(t,["uri"],n);const r=d(e,["encodedVideo"]);r!=null&&p(t,["videoBytes"],pi(r));const i=d(e,["encoding"]);return i!=null&&p(t,["mimeType"],i),t}function J3(e){const t={},n=d(e,["gcsUri"]);n!=null&&p(t,["uri"],n);const r=d(e,["bytesBase64Encoded"]);r!=null&&p(t,["videoBytes"],pi(r));const i=d(e,["mimeType"]);return i!=null&&p(t,["mimeType"],i),t}function Y3(e){const t={},n=d(e,["image"]);n!=null&&p(t,["_self"],sr(n));const r=d(e,["maskMode"]);return r!=null&&p(t,["maskMode"],r),t}function K3(e){const t={},n=d(e,["image"]);n!=null&&p(t,["image"],Lu(n));const r=d(e,["referenceType"]);return r!=null&&p(t,["referenceType"],r),t}function X3(e){const t={},n=d(e,["image"]);n!=null&&p(t,["image"],sr(n));const r=d(e,["referenceType"]);return r!=null&&p(t,["referenceType"],r),t}function dy(e){const t={},n=d(e,["uri"]);n!=null&&p(t,["uri"],n);const r=d(e,["videoBytes"]);r!=null&&p(t,["encodedVideo"],pi(r));const i=d(e,["mimeType"]);return i!=null&&p(t,["encoding"],i),t}function fy(e){const t={},n=d(e,["uri"]);n!=null&&p(t,["gcsUri"],n);const r=d(e,["videoBytes"]);r!=null&&p(t,["bytesBase64Encoded"],pi(r));const i=d(e,["mimeType"]);return i!=null&&p(t,["mimeType"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Q3="Content-Type",Z3="X-Server-Timeout",eF="User-Agent",Fd="x-goog-api-client",tF="1.30.0",nF=`google-genai-sdk/${tF}`,rF="v1beta1",iF="v1beta",Bm=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class sF{constructor(t){var n,r;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:rF,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:iF,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&r.push(t.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),t!==""&&i.push(t),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);if(t.queryParams)for(const[a,o]of Object.entries(t.queryParams))i.searchParams.append(a,String(o));let s={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=t.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),t.abortSignal),this.unaryApiCall(i,s,t.httpMethod)}patchHttpOptions(t,n){const r=JSON.parse(JSON.stringify(t));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=t.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),t.abortSignal),this.streamApiCall(i,s,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,r,i){if(n&&n.timeout||i){const s=new AbortController,a=s.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const o=setTimeout(()=>s.abort(),n.timeout);o&&typeof o.unref=="function"&&o.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),t.signal=a}return n&&n.extraBody!==null&&aF(t,n.extraBody),t.headers=await this.getHeadersInternal(n,r),t}async unaryApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await Gm(i),new Ad(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await Gm(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(t){var n;return Os(this,arguments,function*(){const i=(n=t==null?void 0:t.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let a="";for(;;){const{done:o,value:u}=yield ot(i.read());if(o){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const c=s.decode(u,{stream:!0});try{const m=JSON.parse(c);if("error"in m){const h=JSON.parse(JSON.stringify(m.error)),g=h.status,x=h.code,v=`got status: ${g}. ${JSON.stringify(m)}`;if(x>=400&&x<600)throw new Pu({message:v,status:x})}}catch(m){if(m.name==="ApiError")throw m}a+=c;let l=a.match(Bm);for(;l;){const m=l[1];try{const h=new Response(m,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield ot(new Ad(h)),a=a.slice(l[0].length),l=a.match(Bm)}catch(h){throw new Error(`exception parsing stream chunk ${m}. ${h}`)}}}}finally{i.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const t={},n=nF+" "+this.clientOptions.userAgentExtra;return t[eF]=n,t[Fd]=n,t[Q3]="application/json",t}async getHeadersInternal(t,n){const r=new Headers;if(t&&t.headers){for(const[i,s]of Object.entries(t.headers))r.append(i,s);t.timeout&&t.timeout>0&&r.append(Z3,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(t){var n;let r="";return typeof t=="string"&&(r=t.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(t,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,a=await s.stat(t);i.sizeBytes=String(a.size);const o=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:a.type;if(o===void 0||o==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=o;const u={file:i},c=this.getFileName(t),l=_e("upload/v1beta/files",u._url),m=await this.fetchUploadUrl(l,i.sizeBytes,i.mimeType,c,u,n==null?void 0:n.httpOptions);return s.upload(t,m,this)}async uploadFileToFileSearchStore(t,n,r){var i;const s=this.clientOptions.uploader,a=await s.stat(n),o=String(a.size),u=(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:a.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const c=`upload/v1beta/${t}:uploadToFileSearchStore`,l=this.getFileName(n),m={};r!=null&&r.customMetadata&&(m.customMetadata=r.customMetadata),r!=null&&r.chunkingConfig&&(m.chunkingConfig=r.chunkingConfig);const h=await this.fetchUploadUrl(c,o,u,l,m,r==null?void 0:r.httpOptions);return s.uploadToFileSearchStore(n,h,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,n,r,i,s,a){var o;let u={};a?u=a:u={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},i?{"X-Goog-Upload-File-Name":i}:{})};const c=await this.request({path:t,body:JSON.stringify(s),httpMethod:"POST",httpOptions:u});if(!c||!(c!=null&&c.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(o=c==null?void 0:c.headers)===null||o===void 0?void 0:o["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function Gm(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const n=e.status;let r;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?r=await e.json():r={error:{message:await e.text(),code:e.status,status:e.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new Pu({message:i,status:n}):new Error(i)}}function aF(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof e.body=="string"&&e.body.length>0)try{const s=JSON.parse(e.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,a){const o=Object.assign({},s);for(const u in a)if(Object.prototype.hasOwnProperty.call(a,u)){const c=a[u],l=o[u];c&&typeof c=="object"&&!Array.isArray(c)&&l&&typeof l=="object"&&!Array.isArray(l)?o[u]=r(l,c):(l&&c&&typeof l!=typeof c&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${u}". Original type: ${typeof l}, New type: ${typeof c}. Overwriting.`),o[u]=c)}return o}const i=r(n,t);e.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const oF="mcp_used/unknown";let lF=!1;function py(e){for(const t of e)if(uF(t)||typeof t=="object"&&"inputSchema"in t)return!0;return lF}function hy(e){var t;const n=(t=e[Fd])!==null&&t!==void 0?t:"";e[Fd]=(n+` ${oF}`).trimStart()}function uF(e){return e!==null&&typeof e=="object"&&e instanceof s0}function cF(e,t=100){return Os(this,arguments,function*(){let r,i=0;for(;i<t;){const s=yield ot(e.listTools({cursor:r}));for(const a of s.tools)yield yield ot(a),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class s0{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new s0(t,n)}async initialize(){var t,n,r,i;if(this.mcpTools.length>0)return;const s={},a=[];for(const l of this.mcpClients)try{for(var o=!0,u=(n=void 0,Ba(cF(l))),c;c=await u.next(),t=c.done,!t;o=!0){i=c.value,o=!1;const m=i;a.push(m);const h=m.name;if(s[h])throw new Error(`Duplicate function name ${h} found in MCP tools. Please ensure function names are unique.`);s[h]=l}}catch(m){n={error:m}}finally{try{!o&&!t&&(r=u.return)&&await r.call(u)}finally{if(n)throw n.error}}this.mcpTools=a,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),nk(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const r of t)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const a=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:a.isError?{error:a}:a}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function dF(e,t,n){const r=new JR;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),t(r)}class fF{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r}async connect(t){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),a=mF(this.apiClient.getDefaultHeaders()),o=this.apiClient.getApiKey(),u=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${o}`;let c=()=>{};const l=new Promise(T=>{c=T}),m=t.callbacks,h=function(){c({})},g=this.apiClient,x={onopen:h,onmessage:T=>{dF(g,m.onmessage,T)},onerror:(n=m==null?void 0:m.onerror)!==null&&n!==void 0?n:function(T){},onclose:(r=m==null?void 0:m.onclose)!==null&&r!==void 0?r:function(T){}},v=this.webSocketFactory.create(u,hF(a),x);v.connect(),await l;const y={setup:{model:Je(this.apiClient,t.model)}};return v.send(JSON.stringify(y)),new pF(v,this.apiClient)}}class pF{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=Z4(t);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=Q4(t);this.conn.send(JSON.stringify(n))}sendPlaybackControl(t){const n={playbackControl:t};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(ws.PLAY)}pause(){this.sendPlaybackControl(ws.PAUSE)}stop(){this.sendPlaybackControl(ws.STOP)}resetContext(){this.sendPlaybackControl(ws.RESET_CONTEXT)}close(){this.conn.close()}}function hF(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function mF(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gF="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function xF(e,t,n){const r=new WR;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(e.isVertexAI()){const a=nb(s);Object.assign(r,a)}else Object.assign(r,s);t(r)}class vF{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r,this.music=new fF(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,r,i,s,a,o;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const u=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion();let l;const m=this.apiClient.getHeaders();t.config&&t.config.tools&&py(t.config.tools)&&hy(m);const h=SF(m);if(this.apiClient.isVertexAI())l=`${u}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(h,l);else{const M=this.apiClient.getApiKey();let k="BidiGenerateContent",z="key";M!=null&&M.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),c!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),k="BidiGenerateContentConstrained",z="access_token"),l=`${u}/ws/google.ai.generativelanguage.${c}.GenerativeService.${k}?${z}=${M}`}let g=()=>{};const x=new Promise(M=>{g=M}),v=t.callbacks,w=function(){var M;(M=v==null?void 0:v.onopen)===null||M===void 0||M.call(v),g({})},E=this.apiClient,y={onopen:w,onmessage:M=>{xF(E,v.onmessage,M)},onerror:(n=v==null?void 0:v.onerror)!==null&&n!==void 0?n:function(M){},onclose:(r=v==null?void 0:v.onclose)!==null&&r!==void 0?r:function(M){}},T=this.webSocketFactory.create(l,TF(h),y);T.connect(),await x;let C=Je(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&C.startsWith("publishers/")){const M=this.apiClient.getProject(),k=this.apiClient.getLocation();C=`projects/${M}/locations/${k}/`+C}let L={};this.apiClient.isVertexAI()&&((i=t.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[su.AUDIO]}:t.config.responseModalities=[su.AUDIO]),!((s=t.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const B=(o=(a=t.config)===null||a===void 0?void 0:a.tools)!==null&&o!==void 0?o:[],R=[];for(const M of B)if(this.isCallableTool(M)){const k=M;R.push(await k.tool())}else R.push(M);R.length>0&&(t.config.tools=R);const O={model:C,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?L=X4(this.apiClient,O):L=K4(this.apiClient,O),delete L.config,T.send(JSON.stringify(L)),new EF(T,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const yF={turnComplete:!0};class EF{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=$n(n.turns),t.isVertexAI()||(r=r.map(i=>Mu(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!t.isVertexAI()&&!("id"in s))throw new Error(gF)}return{toolResponse:{functionResponses:r}}}sendClientContent(t){t=Object.assign(Object.assign({},yF),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:tb(t)}:n={realtimeInput:eb(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function TF(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function SF(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $m=10;function Vm(e){var t,n,r;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let i=!1;for(const a of(n=e==null?void 0:e.tools)!==null&&n!==void 0?n:[])if(Us(a)){i=!0;break}if(!i)return!0;const s=(r=e==null?void 0:e.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function Us(e){return"callTool"in e&&typeof e.callTool=="function"}function wF(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(i=>Us(i)))!==null&&r!==void 0?r:!1}function jm(e){var t;const n=[];return!((t=e==null?void 0:e.config)===null||t===void 0)&&t.tools&&e.config.tools.forEach((r,i)=>{if(Us(r))return;const s=r;s.functionDeclarations&&s.functionDeclarations.length>0&&n.push(i)}),n}function Hm(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _F extends Dr{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>{var r,i,s,a,o;const u=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!wF(n)||Vm(n.config))return await this.generateContentInternal(u);const c=jm(n);if(c.length>0){const v=c.map(w=>`tools[${w}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${v}.`)}let l,m;const h=$n(u.contents),g=(s=(i=(r=u.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:$m;let x=0;for(;x<g&&(l=await this.generateContentInternal(u),!(!l.functionCalls||l.functionCalls.length===0));){const v=l.candidates[0].content,w=[];for(const E of(o=(a=n.config)===null||a===void 0?void 0:a.tools)!==null&&o!==void 0?o:[])if(Us(E)){const T=await E.callTool(l.functionCalls);w.push(...T)}x++,m={role:"user",parts:w},u.contents=$n(u.contents),u.contents.push(v),u.contents.push(m),Hm(u.config)&&(h.push(v),h.push(m))}return Hm(u.config)&&(l.automaticFunctionCallingHistory=h),l},this.generateContentStream=async n=>{var r,i,s,a,o;if(this.maybeMoveToResponseJsonSchem(n),Vm(n.config)){const m=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(m)}const u=jm(n);if(u.length>0){const m=u.map(h=>`tools[${h}]`).join(", ");throw new Error(`Incompatible tools found at ${m}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const c=(s=(i=(r=n==null?void 0:n.config)===null||r===void 0?void 0:r.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,l=(o=(a=n==null?void 0:n.config)===null||a===void 0?void 0:a.automaticFunctionCalling)===null||o===void 0?void 0:o.disable;if(c&&!l)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const a=[];if(r!=null&&r.generatedImages)for(const u of r.generatedImages)u&&(u!=null&&u.safetyAttributes)&&((i=u==null?void 0:u.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=u==null?void 0:u.safetyAttributes:a.push(u);let o;return s?o={generatedImages:a,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:o={generatedImages:a,sdkHttpResponse:r.sdkHttpResponse},o}),this.list=async n=>{var r;const a={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!a.config.queryBase){if(!((r=a.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");a.config.filter="labels.tune-type:*"}return new ji(Fr.PAGED_ITEM_MODELS,o=>this.listInternal(o),await this.listInternal(a),a)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,s,a,o,u;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((a=(s=n.source)===null||s===void 0?void 0:s.video)===null||a===void 0)&&a.uri&&(!((u=(o=n.source)===null||o===void 0?void 0:o.video)===null||u===void 0)&&u.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var n,r,i;const s=(n=t.config)===null||n===void 0?void 0:n.tools;if(!s)return t;const a=await Promise.all(s.map(async u=>Us(u)?await u.tool():u)),o={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:a})};if(o.config.tools=a,t.config&&t.config.tools&&py(t.config.tools)){const u=(i=(r=t.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let c=Object.assign({},u);Object.keys(c).length===0&&(c=this.apiClient.getDefaultHeaders()),hy(c),o.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:c})}return o}async initAfcToolsMap(t){var n,r,i;const s=new Map;for(const a of(r=(n=t.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Us(a)){const o=a,u=await o.tool();for(const c of(i=u.functionDeclarations)!==null&&i!==void 0?i:[]){if(!c.name)throw new Error("Function declaration name is required.");if(s.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);s.set(c.name,o)}}return s}async processAfcStream(t){var n,r,i;const s=(i=(r=(n=t.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:$m;let a=!1,o=0;const u=await this.initAfcToolsMap(t);return function(c,l,m){var h,g;return Os(this,arguments,function*(){for(var x,v,w,E;o<s;){a&&(o++,a=!1);const L=yield ot(c.processParamsMaybeAddMcpUsage(m)),B=yield ot(c.generateContentStreamInternal(L)),R=[],O=[];try{for(var y=!0,T=(v=void 0,Ba(B)),C;C=yield ot(T.next()),x=C.done,!x;y=!0){E=C.value,y=!1;const M=E;if(yield yield ot(M),M.candidates&&(!((h=M.candidates[0])===null||h===void 0)&&h.content)){O.push(M.candidates[0].content);for(const k of(g=M.candidates[0].content.parts)!==null&&g!==void 0?g:[])if(o<s&&k.functionCall){if(!k.functionCall.name)throw new Error("Function call name was not returned by the model.");if(l.has(k.functionCall.name)){const z=yield ot(l.get(k.functionCall.name).callTool([k.functionCall]));R.push(...z)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${l.keys()}, mising tool: ${k.functionCall.name}`)}}}}catch(M){v={error:M}}finally{try{!y&&!x&&(w=T.return)&&(yield ot(w.call(T)))}finally{if(v)throw v.error}}if(R.length>0){a=!0;const M=new va;M.candidates=[{content:{role:"user",parts:R}}],yield yield ot(M);const k=[];k.push(...O),k.push({role:"user",parts:R});const z=$n(m.contents).concat(k);m.contents=z}else break}})}(this,u,t)}async generateContentInternal(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=Lm(this.apiClient,t);return o=_e("{model}:generateContent",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=Um(l),h=new va;return Object.assign(h,m),h})}else{const c=Dm(this.apiClient,t);return o=_e("{model}:generateContent",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=Om(l),h=new va;return Object.assign(h,m),h})}}async generateContentStreamInternal(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=Lm(this.apiClient,t);return o=_e("{model}:streamGenerateContent?alt=sse",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.requestStream({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}),a.then(function(m){return Os(this,arguments,function*(){var h,g,x,v;try{for(var w=!0,E=Ba(m),y;y=yield ot(E.next()),h=y.done,!h;w=!0){v=y.value,w=!1;const T=v,C=Um(yield ot(T.json()));C.sdkHttpResponse={headers:T.headers};const L=new va;Object.assign(L,C),yield yield ot(L)}}catch(T){g={error:T}}finally{try{!w&&!h&&(x=E.return)&&(yield ot(x.call(E)))}finally{if(g)throw g.error}}})})}else{const c=Dm(this.apiClient,t);return o=_e("{model}:streamGenerateContent?alt=sse",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.requestStream({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}),a.then(function(m){return Os(this,arguments,function*(){var h,g,x,v;try{for(var w=!0,E=Ba(m),y;y=yield ot(E.next()),h=y.done,!h;w=!0){v=y.value,w=!1;const T=v,C=Om(yield ot(T.json()));C.sdkHttpResponse={headers:T.headers};const L=new va;Object.assign(L,C),yield yield ot(L)}}catch(T){g={error:T}}finally{try{!w&&!h&&(x=E.return)&&(yield ot(x.call(E)))}finally{if(g)throw g.error}}})})}}async embedContent(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=Fb(this.apiClient,t);return o=_e("{model}:predict",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=Mb(l),h=new ym;return Object.assign(h,m),h})}else{const c=bb(this.apiClient,t);return o=_e("{model}:batchEmbedContents",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=Pb(l),h=new ym;return Object.assign(h,m),h})}}async generateImagesInternal(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=zb(this.apiClient,t);return o=_e("{model}:predict",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=Wb(l),h=new Em;return Object.assign(h,m),h})}else{const c=Hb(this.apiClient,t);return o=_e("{model}:predict",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=qb(l),h=new Em;return Object.assign(h,m),h})}}async editImageInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=Ab(this.apiClient,t);return s=_e("{model}:predict",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(c=>{const l=c;return l.sdkHttpResponse={headers:u.headers},l})),i.then(u=>{const c=Ib(u),l=new LR;return Object.assign(l,c),l})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=z3(this.apiClient,t);return s=_e("{model}:predict",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(c=>{const l=c;return l.sdkHttpResponse={headers:u.headers},l})),i.then(u=>{const c=q3(u),l=new OR;return Object.assign(l,c),l})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=N3(this.apiClient,t);return s=_e("{model}:predict",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const c=A3(u),l=new UR;return Object.assign(l,c),l})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=P3(this.apiClient,t);return s=_e("{model}:predict",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const c=M3(u),l=new BR;return Object.assign(l,c),l})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=c3(this.apiClient,t);return o=_e("{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>bd(l))}else{const c=u3(this.apiClient,t);return o=_e("{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),a.then(l=>kd(l))}}async listInternal(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=y3(this.apiClient,t);return o=_e("{models_url}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=T3(l),h=new Tm;return Object.assign(h,m),h})}else{const c=v3(this.apiClient,t);return o=_e("{models_url}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=E3(l),h=new Tm;return Object.assign(h,m),h})}}async update(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=j3(this.apiClient,t);return o=_e("{model}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>bd(l))}else{const c=V3(this.apiClient,t);return o=_e("{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),a.then(l=>kd(l))}}async delete(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=wb(this.apiClient,t);return o=_e("{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=Cb(l),h=new Sm;return Object.assign(h,m),h})}else{const c=Sb(this.apiClient,t);return o=_e("{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=_b(l),h=new Sm;return Object.assign(h,m),h})}}async countTokens(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=yb(this.apiClient,t);return o=_e("{model}:countTokens",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=Tb(l),h=new wm;return Object.assign(h,m),h})}else{const c=vb(this.apiClient,t);return o=_e("{model}:countTokens",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=Eb(l),h=new wm;return Object.assign(h,m),h})}}async computeTokens(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=db(this.apiClient,t);return s=_e("{model}:computeTokens",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(c=>{const l=c;return l.sdkHttpResponse={headers:u.headers},l})),i.then(u=>{const c=fb(u),l=new GR;return Object.assign(l,c),l})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=Zb(this.apiClient,t);return o=_e("{model}:predictLongRunning",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a.then(l=>{const m=Xb(l),h=new au;return Object.assign(h,m),h})}else{const c=Qb(this.apiClient,t);return o=_e("{model}:predictLongRunning",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),a.then(l=>{const m=Kb(l),h=new au;return Object.assign(h,m),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class CF extends Dr{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=kR(t);return o=_e("{operationName}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),a}else{const c=RR(t);return o=_e("{operationName}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),a}}async fetchPredictVideosOperationInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=SR(t);return s=_e("{resourceName}:fetchPredictOperation",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function NF(e){const t={},n=d(e,["data"]);if(n!=null&&p(t,["data"],n),d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(e,["mimeType"]);return r!=null&&p(t,["mimeType"],r),t}function AF(e){const t={},n=d(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>LF(s))),p(t,["parts"],i)}const r=d(e,["role"]);return r!=null&&p(t,["role"],r),t}function IF(e,t,n){const r={},i=d(t,["expireTime"]);n!==void 0&&i!=null&&p(n,["expireTime"],i);const s=d(t,["newSessionExpireTime"]);n!==void 0&&s!=null&&p(n,["newSessionExpireTime"],s);const a=d(t,["uses"]);n!==void 0&&a!=null&&p(n,["uses"],a);const o=d(t,["liveConnectConstraints"]);n!==void 0&&o!=null&&p(n,["bidiGenerateContentSetup"],DF(e,o));const u=d(t,["lockAdditionalFields"]);return n!==void 0&&u!=null&&p(n,["fieldMask"],u),r}function RF(e,t){const n={},r=d(t,["config"]);return r!=null&&p(n,["config"],IF(e,r,n)),n}function kF(e){const t={};if(d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["fileUri"]);n!=null&&p(t,["fileUri"],n);const r=d(e,["mimeType"]);return r!=null&&p(t,["mimeType"],r),t}function bF(e){const t={},n=d(e,["id"]);n!=null&&p(t,["id"],n);const r=d(e,["args"]);r!=null&&p(t,["args"],r);const i=d(e,["name"]);if(i!=null&&p(t,["name"],i),d(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function FF(e){const t={};if(d(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=d(e,["enableWidget"]);return n!=null&&p(t,["enableWidget"],n),t}function PF(e){const t={};if(d(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=d(e,["timeRangeFilter"]);return n!=null&&p(t,["timeRangeFilter"],n),t}function MF(e,t){const n={},r=d(e,["generationConfig"]);t!==void 0&&r!=null&&p(t,["setup","generationConfig"],r);const i=d(e,["responseModalities"]);t!==void 0&&i!=null&&p(t,["setup","generationConfig","responseModalities"],i);const s=d(e,["temperature"]);t!==void 0&&s!=null&&p(t,["setup","generationConfig","temperature"],s);const a=d(e,["topP"]);t!==void 0&&a!=null&&p(t,["setup","generationConfig","topP"],a);const o=d(e,["topK"]);t!==void 0&&o!=null&&p(t,["setup","generationConfig","topK"],o);const u=d(e,["maxOutputTokens"]);t!==void 0&&u!=null&&p(t,["setup","generationConfig","maxOutputTokens"],u);const c=d(e,["mediaResolution"]);t!==void 0&&c!=null&&p(t,["setup","generationConfig","mediaResolution"],c);const l=d(e,["seed"]);t!==void 0&&l!=null&&p(t,["setup","generationConfig","seed"],l);const m=d(e,["speechConfig"]);t!==void 0&&m!=null&&p(t,["setup","generationConfig","speechConfig"],i0(m));const h=d(e,["thinkingConfig"]);t!==void 0&&h!=null&&p(t,["setup","generationConfig","thinkingConfig"],h);const g=d(e,["enableAffectiveDialog"]);t!==void 0&&g!=null&&p(t,["setup","generationConfig","enableAffectiveDialog"],g);const x=d(e,["systemInstruction"]);t!==void 0&&x!=null&&p(t,["setup","systemInstruction"],AF(Qt(x)));const v=d(e,["tools"]);if(t!==void 0&&v!=null){let B=ta(v);Array.isArray(B)&&(B=B.map(R=>UF(ea(R)))),p(t,["setup","tools"],B)}const w=d(e,["sessionResumption"]);t!==void 0&&w!=null&&p(t,["setup","sessionResumption"],OF(w));const E=d(e,["inputAudioTranscription"]);t!==void 0&&E!=null&&p(t,["setup","inputAudioTranscription"],E);const y=d(e,["outputAudioTranscription"]);t!==void 0&&y!=null&&p(t,["setup","outputAudioTranscription"],y);const T=d(e,["realtimeInputConfig"]);t!==void 0&&T!=null&&p(t,["setup","realtimeInputConfig"],T);const C=d(e,["contextWindowCompression"]);t!==void 0&&C!=null&&p(t,["setup","contextWindowCompression"],C);const L=d(e,["proactivity"]);return t!==void 0&&L!=null&&p(t,["setup","proactivity"],L),n}function DF(e,t){const n={},r=d(t,["model"]);r!=null&&p(n,["setup","model"],Je(e,r));const i=d(t,["config"]);return i!=null&&p(n,["config"],MF(i,n)),n}function LF(e){const t={},n=d(e,["mediaResolution"]);n!=null&&p(t,["mediaResolution"],n);const r=d(e,["codeExecutionResult"]);r!=null&&p(t,["codeExecutionResult"],r);const i=d(e,["executableCode"]);i!=null&&p(t,["executableCode"],i);const s=d(e,["fileData"]);s!=null&&p(t,["fileData"],kF(s));const a=d(e,["functionCall"]);a!=null&&p(t,["functionCall"],bF(a));const o=d(e,["functionResponse"]);o!=null&&p(t,["functionResponse"],o);const u=d(e,["inlineData"]);u!=null&&p(t,["inlineData"],NF(u));const c=d(e,["text"]);c!=null&&p(t,["text"],c);const l=d(e,["thought"]);l!=null&&p(t,["thought"],l);const m=d(e,["thoughtSignature"]);m!=null&&p(t,["thoughtSignature"],m);const h=d(e,["videoMetadata"]);return h!=null&&p(t,["videoMetadata"],h),t}function OF(e){const t={},n=d(e,["handle"]);if(n!=null&&p(t,["handle"],n),d(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function UF(e){const t={},n=d(e,["functionDeclarations"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(m=>m)),p(t,["functionDeclarations"],l)}if(d(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=d(e,["googleSearchRetrieval"]);r!=null&&p(t,["googleSearchRetrieval"],r);const i=d(e,["computerUse"]);i!=null&&p(t,["computerUse"],i);const s=d(e,["fileSearch"]);s!=null&&p(t,["fileSearch"],s);const a=d(e,["codeExecution"]);if(a!=null&&p(t,["codeExecution"],a),d(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=d(e,["googleMaps"]);o!=null&&p(t,["googleMaps"],FF(o));const u=d(e,["googleSearch"]);u!=null&&p(t,["googleSearch"],PF(u));const c=d(e,["urlContext"]);return c!=null&&p(t,["urlContext"],c),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function BF(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);t.push(...i)}else t.push(n)}return t.join(",")}function GF(e,t){let n=null;const r=e.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(e.bidiGenerateContentSetup=s,n=s):delete e.bidiGenerateContentSetup}else r!==void 0&&delete e.bidiGenerateContentSetup;const i=e.fieldMask;if(n){const s=BF(n);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)s?e.fieldMask=s:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const a=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let o=[];i.length>0&&(o=i.map(c=>a.includes(c)?`generationConfig.${c}`:c));const u=[];s&&u.push(s),o.length>0&&u.push(...o),u.length>0?e.fieldMask=u.join(","):delete e.fieldMask}else delete e.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}class $F extends Dr{constructor(t){super(),this.apiClient=t}async create(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const o=RF(this.apiClient,t);s=_e("auth_tokens",o._url),a=o._query,delete o.config,delete o._url,delete o._query;const u=GF(o,t.config);return i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>c)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function VF(e,t){const n={},r=d(e,["displayName"]);return t!==void 0&&r!=null&&p(t,["displayName"],r),n}function jF(e){const t={},n=d(e,["config"]);return n!=null&&VF(n,t),t}function HF(e,t){const n={},r=d(e,["force"]);return t!==void 0&&r!=null&&p(t,["_query","force"],r),n}function zF(e){const t={},n=d(e,["name"]);n!=null&&p(t,["_url","name"],n);const r=d(e,["config"]);return r!=null&&HF(r,t),t}function qF(e){const t={},n=d(e,["name"]);return n!=null&&p(t,["_url","name"],n),t}function WF(e,t){const n={},r=d(e,["customMetadata"]);if(t!==void 0&&r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["customMetadata"],s)}const i=d(e,["chunkingConfig"]);return t!==void 0&&i!=null&&p(t,["chunkingConfig"],i),n}function JF(e){const t={},n=d(e,["name"]);n!=null&&p(t,["name"],n);const r=d(e,["metadata"]);r!=null&&p(t,["metadata"],r);const i=d(e,["done"]);i!=null&&p(t,["done"],i);const s=d(e,["error"]);s!=null&&p(t,["error"],s);const a=d(e,["response"]);return a!=null&&p(t,["response"],KF(a)),t}function YF(e){const t={},n=d(e,["fileSearchStoreName"]);n!=null&&p(t,["_url","file_search_store_name"],n);const r=d(e,["fileName"]);r!=null&&p(t,["fileName"],r);const i=d(e,["config"]);return i!=null&&WF(i,t),t}function KF(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["parent"]);r!=null&&p(t,["parent"],r);const i=d(e,["documentName"]);return i!=null&&p(t,["documentName"],i),t}function XF(e,t){const n={},r=d(e,["pageSize"]);t!==void 0&&r!=null&&p(t,["_query","pageSize"],r);const i=d(e,["pageToken"]);return t!==void 0&&i!=null&&p(t,["_query","pageToken"],i),n}function QF(e){const t={},n=d(e,["config"]);return n!=null&&XF(n,t),t}function ZF(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["nextPageToken"]);r!=null&&p(t,["nextPageToken"],r);const i=d(e,["fileSearchStores"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["fileSearchStores"],s)}return t}function eP(e,t){const n={},r=d(e,["mimeType"]);t!==void 0&&r!=null&&p(t,["mimeType"],r);const i=d(e,["displayName"]);t!==void 0&&i!=null&&p(t,["displayName"],i);const s=d(e,["customMetadata"]);if(t!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(u=>u)),p(t,["customMetadata"],o)}const a=d(e,["chunkingConfig"]);return t!==void 0&&a!=null&&p(t,["chunkingConfig"],a),n}function tP(e){const t={},n=d(e,["fileSearchStoreName"]);n!=null&&p(t,["_url","file_search_store_name"],n);const r=d(e,["config"]);return r!=null&&eP(r,t),t}function nP(e){const t={},n=d(e,["sdkHttpResponse"]);return n!=null&&p(t,["sdkHttpResponse"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rP(e,t){const n={},r=d(e,["force"]);return t!==void 0&&r!=null&&p(t,["_query","force"],r),n}function iP(e){const t={},n=d(e,["name"]);n!=null&&p(t,["_url","name"],n);const r=d(e,["config"]);return r!=null&&rP(r,t),t}function sP(e){const t={},n=d(e,["name"]);return n!=null&&p(t,["_url","name"],n),t}function aP(e,t){const n={},r=d(e,["pageSize"]);t!==void 0&&r!=null&&p(t,["_query","pageSize"],r);const i=d(e,["pageToken"]);return t!==void 0&&i!=null&&p(t,["_query","pageToken"],i),n}function oP(e){const t={},n=d(e,["parent"]);n!=null&&p(t,["_url","parent"],n);const r=d(e,["config"]);return r!=null&&aP(r,t),t}function lP(e){const t={},n=d(e,["sdkHttpResponse"]);n!=null&&p(t,["sdkHttpResponse"],n);const r=d(e,["nextPageToken"]);r!=null&&p(t,["nextPageToken"],r);const i=d(e,["documents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),p(t,["documents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uP extends Dr{constructor(t){super(),this.apiClient=t,this.list=async n=>new ji(Fr.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=sP(t);return s=_e("{name}",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}async delete(t){var n,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=iP(t);i=_e("{name}",a._url),s=a._query,delete a._url,delete a._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=oP(t);return s=_e("{parent}/documents",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const c=lP(u),l=new $R;return Object.assign(l,c),l})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cP extends Dr{constructor(t,n=new uP(t)){super(),this.apiClient=t,this.documents=n,this.list=async(r={})=>new ji(Fr.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(r),r)}async uploadToFileSearchStore(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(t.fileSearchStoreName,t.file,t.config)}async create(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=jF(t);return s=_e("fileSearchStores",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}async get(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=qF(t);return s=_e("{name}",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}async delete(t){var n,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=zF(t);i=_e("{name}",a._url),s=a._query,delete a._url,delete a._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=QF(t);return s=_e("fileSearchStores",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const c=ZF(u),l=new VR;return Object.assign(l,c),l})}}async uploadToFileSearchStoreInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=tP(t);return s=_e("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const c=nP(u),l=new jR;return Object.assign(l,c),l})}}async importFile(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=YF(t);return s=_e("{file_search_store_name}:importFile",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const c=JF(u),l=new Zf;return Object.assign(l,c),l})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dP(e,t){const n={},r=d(e,["name"]);return r!=null&&p(n,["_url","name"],r),n}function fP(e,t){const n={},r=d(e,["name"]);return r!=null&&p(n,["_url","name"],r),n}function pP(e,t,n){const r={};if(d(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=d(e,["tunedModelDisplayName"]);if(t!==void 0&&i!=null&&p(t,["displayName"],i),d(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=d(e,["epochCount"]);t!==void 0&&s!=null&&p(t,["tuningTask","hyperparameters","epochCount"],s);const a=d(e,["learningRateMultiplier"]);if(a!=null&&p(r,["tuningTask","hyperparameters","learningRateMultiplier"],a),d(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(e,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(d(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const o=d(e,["batchSize"]);t!==void 0&&o!=null&&p(t,["tuningTask","hyperparameters","batchSize"],o);const u=d(e,["learningRate"]);if(t!==void 0&&u!=null&&p(t,["tuningTask","hyperparameters","learningRate"],u),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(d(e,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function hP(e,t,n){const r={};let i=d(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const g=d(e,["validationDataset"]);t!==void 0&&g!=null&&p(t,["supervisedTuningSpec"],zm(g))}else if(i==="PREFERENCE_TUNING"){const g=d(e,["validationDataset"]);t!==void 0&&g!=null&&p(t,["preferenceOptimizationSpec"],zm(g))}const s=d(e,["tunedModelDisplayName"]);t!==void 0&&s!=null&&p(t,["tunedModelDisplayName"],s);const a=d(e,["description"]);t!==void 0&&a!=null&&p(t,["description"],a);let o=d(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const g=d(e,["epochCount"]);t!==void 0&&g!=null&&p(t,["supervisedTuningSpec","hyperParameters","epochCount"],g)}else if(o==="PREFERENCE_TUNING"){const g=d(e,["epochCount"]);t!==void 0&&g!=null&&p(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],g)}let u=d(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const g=d(e,["learningRateMultiplier"]);t!==void 0&&g!=null&&p(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],g)}else if(u==="PREFERENCE_TUNING"){const g=d(e,["learningRateMultiplier"]);t!==void 0&&g!=null&&p(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],g)}let c=d(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const g=d(e,["exportLastCheckpointOnly"]);t!==void 0&&g!=null&&p(t,["supervisedTuningSpec","exportLastCheckpointOnly"],g)}else if(c==="PREFERENCE_TUNING"){const g=d(e,["exportLastCheckpointOnly"]);t!==void 0&&g!=null&&p(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],g)}let l=d(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const g=d(e,["adapterSize"]);t!==void 0&&g!=null&&p(t,["supervisedTuningSpec","hyperParameters","adapterSize"],g)}else if(l==="PREFERENCE_TUNING"){const g=d(e,["adapterSize"]);t!==void 0&&g!=null&&p(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],g)}if(d(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(d(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const m=d(e,["labels"]);t!==void 0&&m!=null&&p(t,["labels"],m);const h=d(e,["beta"]);return t!==void 0&&h!=null&&p(t,["preferenceOptimizationSpec","hyperParameters","beta"],h),r}function mP(e,t){const n={},r=d(e,["baseModel"]);r!=null&&p(n,["baseModel"],r);const i=d(e,["preTunedModel"]);i!=null&&p(n,["preTunedModel"],i);const s=d(e,["trainingDataset"]);s!=null&&NP(s);const a=d(e,["config"]);return a!=null&&pP(a,n),n}function gP(e,t){const n={},r=d(e,["baseModel"]);r!=null&&p(n,["baseModel"],r);const i=d(e,["preTunedModel"]);i!=null&&p(n,["preTunedModel"],i);const s=d(e,["trainingDataset"]);s!=null&&AP(s,n,t);const a=d(e,["config"]);return a!=null&&hP(a,n,t),n}function xP(e,t){const n={},r=d(e,["name"]);return r!=null&&p(n,["_url","name"],r),n}function vP(e,t){const n={},r=d(e,["name"]);return r!=null&&p(n,["_url","name"],r),n}function yP(e,t,n){const r={},i=d(e,["pageSize"]);t!==void 0&&i!=null&&p(t,["_query","pageSize"],i);const s=d(e,["pageToken"]);t!==void 0&&s!=null&&p(t,["_query","pageToken"],s);const a=d(e,["filter"]);return t!==void 0&&a!=null&&p(t,["_query","filter"],a),r}function EP(e,t,n){const r={},i=d(e,["pageSize"]);t!==void 0&&i!=null&&p(t,["_query","pageSize"],i);const s=d(e,["pageToken"]);t!==void 0&&s!=null&&p(t,["_query","pageToken"],s);const a=d(e,["filter"]);return t!==void 0&&a!=null&&p(t,["_query","filter"],a),r}function TP(e,t){const n={},r=d(e,["config"]);return r!=null&&yP(r,n),n}function SP(e,t){const n={},r=d(e,["config"]);return r!=null&&EP(r,n),n}function wP(e,t){const n={},r=d(e,["sdkHttpResponse"]);r!=null&&p(n,["sdkHttpResponse"],r);const i=d(e,["nextPageToken"]);i!=null&&p(n,["nextPageToken"],i);const s=d(e,["tunedModels"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>my(o))),p(n,["tuningJobs"],a)}return n}function _P(e,t){const n={},r=d(e,["sdkHttpResponse"]);r!=null&&p(n,["sdkHttpResponse"],r);const i=d(e,["nextPageToken"]);i!=null&&p(n,["nextPageToken"],i);const s=d(e,["tuningJobs"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>Pd(o))),p(n,["tuningJobs"],a)}return n}function CP(e,t){const n={},r=d(e,["name"]);r!=null&&p(n,["model"],r);const i=d(e,["name"]);return i!=null&&p(n,["endpoint"],i),n}function NP(e,t){const n={};if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=d(e,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),p(n,["examples","examples"],i)}return n}function AP(e,t,n){const r={};let i=d(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const a=d(e,["gcsUri"]);t!==void 0&&a!=null&&p(t,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(i==="PREFERENCE_TUNING"){const a=d(e,["gcsUri"]);t!==void 0&&a!=null&&p(t,["preferenceOptimizationSpec","trainingDatasetUri"],a)}let s=d(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const a=d(e,["vertexDatasetResource"]);t!==void 0&&a!=null&&p(t,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(s==="PREFERENCE_TUNING"){const a=d(e,["vertexDatasetResource"]);t!==void 0&&a!=null&&p(t,["preferenceOptimizationSpec","trainingDatasetUri"],a)}if(d(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function my(e,t){const n={},r=d(e,["sdkHttpResponse"]);r!=null&&p(n,["sdkHttpResponse"],r);const i=d(e,["name"]);i!=null&&p(n,["name"],i);const s=d(e,["state"]);s!=null&&p(n,["state"],Kv(s));const a=d(e,["createTime"]);a!=null&&p(n,["createTime"],a);const o=d(e,["tuningTask","startTime"]);o!=null&&p(n,["startTime"],o);const u=d(e,["tuningTask","completeTime"]);u!=null&&p(n,["endTime"],u);const c=d(e,["updateTime"]);c!=null&&p(n,["updateTime"],c);const l=d(e,["description"]);l!=null&&p(n,["description"],l);const m=d(e,["baseModel"]);m!=null&&p(n,["baseModel"],m);const h=d(e,["_self"]);return h!=null&&p(n,["tunedModel"],CP(h)),n}function Pd(e,t){const n={},r=d(e,["sdkHttpResponse"]);r!=null&&p(n,["sdkHttpResponse"],r);const i=d(e,["name"]);i!=null&&p(n,["name"],i);const s=d(e,["state"]);s!=null&&p(n,["state"],Kv(s));const a=d(e,["createTime"]);a!=null&&p(n,["createTime"],a);const o=d(e,["startTime"]);o!=null&&p(n,["startTime"],o);const u=d(e,["endTime"]);u!=null&&p(n,["endTime"],u);const c=d(e,["updateTime"]);c!=null&&p(n,["updateTime"],c);const l=d(e,["error"]);l!=null&&p(n,["error"],l);const m=d(e,["description"]);m!=null&&p(n,["description"],m);const h=d(e,["baseModel"]);h!=null&&p(n,["baseModel"],h);const g=d(e,["tunedModel"]);g!=null&&p(n,["tunedModel"],g);const x=d(e,["preTunedModel"]);x!=null&&p(n,["preTunedModel"],x);const v=d(e,["supervisedTuningSpec"]);v!=null&&p(n,["supervisedTuningSpec"],v);const w=d(e,["preferenceOptimizationSpec"]);w!=null&&p(n,["preferenceOptimizationSpec"],w);const E=d(e,["tuningDataStats"]);E!=null&&p(n,["tuningDataStats"],E);const y=d(e,["encryptionSpec"]);y!=null&&p(n,["encryptionSpec"],y);const T=d(e,["partnerModelTuningSpec"]);T!=null&&p(n,["partnerModelTuningSpec"],T);const C=d(e,["customBaseModel"]);C!=null&&p(n,["customBaseModel"],C);const L=d(e,["experiment"]);L!=null&&p(n,["experiment"],L);const B=d(e,["labels"]);B!=null&&p(n,["labels"],B);const R=d(e,["outputUri"]);R!=null&&p(n,["outputUri"],R);const O=d(e,["pipelineJob"]);O!=null&&p(n,["pipelineJob"],O);const M=d(e,["serviceAccount"]);M!=null&&p(n,["serviceAccount"],M);const k=d(e,["tunedModelDisplayName"]);k!=null&&p(n,["tunedModelDisplayName"],k);const z=d(e,["veoTuningSpec"]);return z!=null&&p(n,["veoTuningSpec"],z),n}function IP(e,t){const n={},r=d(e,["sdkHttpResponse"]);r!=null&&p(n,["sdkHttpResponse"],r);const i=d(e,["name"]);i!=null&&p(n,["name"],i);const s=d(e,["metadata"]);s!=null&&p(n,["metadata"],s);const a=d(e,["done"]);a!=null&&p(n,["done"],a);const o=d(e,["error"]);return o!=null&&p(n,["error"],o),n}function zm(e,t){const n={},r=d(e,["gcsUri"]);r!=null&&p(n,["validationDatasetUri"],r);const i=d(e,["vertexDatasetResource"]);return i!=null&&p(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class RP extends Dr{constructor(t){super(),this.apiClient=t,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new ji(Fr.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let a="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?a=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(a=s.name.split("/operations/")[0]),{name:a,state:Nd.JOB_STATE_QUEUED}}}}async getInternal(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=vP(t);return o=_e("{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>Pd(l))}else{const c=xP(t);return o=_e("{name}",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>my(l))}}async listInternal(t){var n,r,i,s;let a,o="",u={};if(this.apiClient.isVertexAI()){const c=SP(t);return o=_e("tuningJobs",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=_P(l),h=new _m;return Object.assign(h,m),h})}else{const c=TP(t);return o=_e("tunedModels",c._url),u=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:l.headers},h})),a.then(l=>{const m=wP(l),h=new _m;return Object.assign(h,m),h})}}async cancel(t){var n,r,i,s;let a="",o={};if(this.apiClient.isVertexAI()){const u=fP(t);a=_e("{name}:cancel",u._url),o=u._query,delete u._url,delete u._query,await this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const u=dP(t);a=_e("{name}:cancel",u._url),o=u._query,delete u._url,delete u._query,await this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async tuneInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=gP(t,t);return s=_e("tuningJobs",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(c=>{const l=c;return l.sdkHttpResponse={headers:u.headers},l})),i.then(u=>Pd(u))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=mP(t);return s=_e("tunedModels",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(c=>{const l=c;return l.sdkHttpResponse={headers:u.headers},l})),i.then(u=>IP(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kP{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const bP=1024*1024*8,FP=3,PP=1e3,MP=2,lu="x-goog-upload-status";async function DP(e,t,n){var r;const i=await gy(e,t,n),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[lu])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function LP(e,t,n){var r;const i=await gy(e,t,n),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[lu])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const a=Hv(s),o=new e0;return Object.assign(o,a),o}async function gy(e,t,n){var r,i;let s=0,a=0,o=new Ad(new Response),u="upload";for(s=e.size;a<s;){const c=Math.min(bP,s-a),l=e.slice(a,a+c);a+c>=s&&(u+=", finalize");let m=0,h=PP;for(;m<FP&&(o=await n.request({path:"",body:l,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(c)}}}),!(!((r=o==null?void 0:o.headers)===null||r===void 0)&&r[lu]));)m++,await UP(h),h=h*MP;if(a+=c,((i=o==null?void 0:o.headers)===null||i===void 0?void 0:i[lu])!=="active")break;if(s<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return o}async function OP(e){return{size:e.size,type:e.type}}function UP(e){return new Promise(t=>setTimeout(t,e))}class BP{async upload(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await DP(t,n,r)}async uploadToFileSearchStore(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await LP(t,n,r)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await OP(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GP{create(t,n,r){return new $P(t,n,r)}}class $P{constructor(t,n,r){this.url=t,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qm="x-goog-api-key";class VP{constructor(t){this.apiKey=t}async addAuthHeaders(t,n){if(t.get(qm)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(qm,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jP="gl-node/";class a0{constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const r=ER(t.httpOptions,t.vertexai,void 0,void 0);r&&(t.httpOptions?t.httpOptions.baseUrl=r:t.httpOptions={baseUrl:r}),this.apiVersion=t.apiVersion;const i=new VP(this.apiKey);this.apiClient=new sF({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:jP+"web",uploader:new BP,downloader:new kP}),this.models=new _F(this.apiClient),this.live=new vF(this.apiClient,i,new GP),this.batches=new Yk(this.apiClient),this.chats=new k4(this.models,this.apiClient),this.caches=new A4(this.apiClient),this.files=new G4(this.apiClient),this.operations=new CF(this.apiClient),this.authTokens=new $F(this.apiClient),this.tunings=new RP(this.apiClient),this.fileSearchStores=new cP(this.apiClient)}}const $t=()=>Math.random().toString(36).substr(2,9),rr=async(e,t={},n=5e3)=>{const r=new AbortController,i=setTimeout(()=>r.abort(),n);try{const s=await fetch(e,{...t,signal:r.signal});return clearTimeout(i),s}catch(s){throw clearTimeout(i),s}};async function HP(e){var t,n;try{const r=new URLSearchParams({q:e,per_page:"1",locale:"pt-BR"}),i=await rr(`https://api.inaturalist.org/v1/taxa?${r}`,{},5e3);if(!i.ok)return null;const s=await i.json();if(s.results&&s.results.length>0){const a=s.results[0];if((t=a.default_photo)!=null&&t.medium_url)return a.default_photo.medium_url;if((n=a.default_photo)!=null&&n.square_url)return a.default_photo.square_url.replace("/square.","/medium.")}return null}catch(r){return console.warn(`iNaturalist fetch failed for "${e}":`,r),null}}async function zP(e){return null}async function qP(e){var t,n;try{const r=new URLSearchParams({q:e,per_page:"3",locale:"pt",preferred_place_id:"7122"}),i=await rr(`https://api.inaturalist.org/v1/taxa?${r}`,{},5e3);if(!i.ok)return null;const s=await i.json();if(s.results&&s.results.length>0)for(const a of s.results){if((t=a.default_photo)!=null&&t.medium_url)return a.default_photo.medium_url;if((n=a.default_photo)!=null&&n.square_url)return a.default_photo.square_url.replace("/square.","/medium.")}return null}catch(r){return console.warn(`Biodiversity4All fetch failed for "${e}":`,r),null}}async function WP(e,t="pt"){var n,r;try{const i=t==="pt"?["pt","en"]:["en","pt"];for(const s of i){const a=`https://${s}.wikipedia.org/w/api.php`,o=new URLSearchParams({action:"query",titles:e,prop:"pageimages",pithumbsize:"400",format:"json",origin:"*",redirects:"1"}),u=await rr(`${a}?${o}`,{},5e3);if(!u.ok)continue;const l=(n=(await u.json()).query)==null?void 0:n.pages;if(l){const m=Object.keys(l)[0],h=l[m];if(h&&!h.missing&&((r=h.thumbnail)!=null&&r.source)){let g=h.thumbnail.source;return g=g.replace(/\/\d+px-/,"/400px-"),g}}}return null}catch(i){return console.warn(`Wikipedia fetch failed for "${e}":`,i),null}}async function JP(e){var t;try{const n=`https://plantillustrations.org/api.php?action=opensearch&search=${encodeURIComponent(e)}&limit=5&format=json`,r=`https://www.biodiversitylibrary.org/api3?op=PublicationSearch&searchterm=${encodeURIComponent(e)}&searchtype=F&page=1&apikey=&format=json`,i=`https://www.biodiversitylibrary.org/api3?op=NameSearch&name=${encodeURIComponent(e)}&format=json`,s=await rr(i,{},5e3);if(!s.ok)return null;const a=await s.json();if(a.Result&&a.Result.length>0){const o=a.Result[0];if(o.BHLTITLE){const u=`https://www.biodiversitylibrary.org/api3?op=GetTitleMetadata&id=${o.TitleID}&items=t&format=json`,c=await rr(u,{},5e3);if(c.ok){const l=await c.json();if((t=l.Result)!=null&&t.Items){for(const m of l.Result.Items)if(m.ThumbnailUrl)return m.ThumbnailUrl}}}}return null}catch(n){return console.warn(`Plant Illustrations/BHL fetch failed for "${e}":`,n),null}}async function YP(e){var t,n,r,i,s,a,o,u;try{const c=encodeURIComponent(e),l=await rr(`https://api.plantnet.org/v1/species?q=${c}&limit=1`,{headers:{Accept:"application/json"}},5e3);if(!l.ok){const h=await rr(`https://my-api.plantnet.org/v2/species/search?q=${c}&lang=pt`,{headers:{Accept:"application/json"}},5e3);if(!h.ok)return null;const g=await h.json();if(g.results&&g.results.length>0){const x=g.results[0];if(x.images&&x.images.length>0){const v=x.images[0];if((t=v.url)!=null&&t.m)return v.url.m;if((n=v.url)!=null&&n.s)return v.url.s;if((r=v.url)!=null&&r.o)return v.url.o}}return null}const m=await l.json();if(m.results&&m.results.length>0)for(const h of m.results){if(h.images&&h.images.length>0){const g=h.images[0];if((i=g.url)!=null&&i.m)return g.url.m;if((s=g.url)!=null&&s.s)return g.url.s;if((a=g.url)!=null&&a.o)return g.url.o;if(typeof g.url=="string")return g.url}if(h.defaultImage){if(h.defaultImage.m)return h.defaultImage.m;if(h.defaultImage.s)return h.defaultImage.s}}if(m.species&&m.species.images&&m.species.images.length>0){const h=m.species.images[0];if((o=h.url)!=null&&o.m)return h.url.m;if((u=h.url)!=null&&u.s)return h.url.s}return null}catch(c){return console.warn(`PlantNet fetch failed for "${e}":`,c),null}}async function KP(e){var t,n;try{const r=new URLSearchParams({q:e,f:"accepted_names"}),i=await rr(`https://powo.science.kew.org/api/2/search?${r}`,{headers:{Accept:"application/json"}},5e3);if(!i.ok){const a=new URLSearchParams({q:e,perPage:"1"}),o=await rr(`https://www.ipni.org/api/1/search?${a}`,{headers:{Accept:"application/json"}},5e3);if(!o.ok)return null;const u=await o.json();if(u.results&&u.results.length>0){const c=u.results[0];if(c.fqId){const l=`https://powo.science.kew.org/taxon/${c.fqId}`;return null}}return null}const s=await i.json();if(s.results&&s.results.length>0)for(const a of s.results){if(a.images&&a.images.length>0){const o=a.images[0];if(o.url)return o.url;if(o.thumbnail)return o.thumbnail}if(a.fqId)try{const o=await rr(`https://powo.science.kew.org/api/2/taxon/${a.fqId}`,{headers:{Accept:"application/json"}},5e3);if(o.ok){const u=await o.json();if(u.images&&u.images.length>0){const c=u.images[0];if(c.url)return c.url;if(c.thumbnail)return c.thumbnail}if(((n=(t=u.distribution)==null?void 0:t.images)==null?void 0:n.length)>0){const c=u.distribution.images[0];if(c.url)return c.url}}}catch{}}return null}catch(r){return console.warn(`POWO fetch failed for "${e}":`,r),null}}async function XP(e){var t,n,r;try{const i="https://commons.wikimedia.org/w/api.php",s=new URLSearchParams({action:"query",generator:"search",gsrsearch:`${e}`,gsrnamespace:"6",gsrlimit:"5",prop:"imageinfo",iiprop:"url|mime",iiurlwidth:"400",format:"json",origin:"*"}),a=await rr(`${i}?${s}`,{},5e3);if(!a.ok)return null;const u=(t=(await a.json()).query)==null?void 0:t.pages,c=[/Flora_Brasiliensis/i,/Flora_Fluminensis/i,/Systema_Naturae/i,/Species_Plantarum/i,/Genera_Plantarum/i,/Prodromus_Systematis/i,/Historia_Naturalis/i,/\/page\d+-\d+px-/i,/\.djvu\//i,/Volume_\d+/i,/Part_\d+/i,/Book_cover/i,/Title_page/i,/Frontispiece/i,/Index_page/i,/Table_of_contents/i,/Herbarium_sheet_only/i,/\.svg\//i,/Municip[io_]/i,/Microregion/i,/Mesoregion/i,/Locator_map/i,/_location/i,/_map\./i,/_in_Brazil/i,/_in_South_America/i,/Brazil_location/i,/Estado_de_/i,/Bandeira_de_/i,/Brasao_de_/i,/Coat_of_arms/i,/Flag_of_/i,/Phylogenetic_tree/i,/Cladogram/i,/Distribution_map/i,/Range_map/i,/Logo[_\-]/i,/Icon[_\-]/i,/Stamp_of_/i,/Coin_of_/i,/Infographic/i];if(u)for(const l of Object.values(u)){const m=(n=l==null?void 0:l.imageinfo)==null?void 0:n[0];if(m!=null&&m.thumburl&&((r=m==null?void 0:m.mime)!=null&&r.startsWith("image/"))){const h=m.thumburl;if(c.some(x=>x.test(h))){console.log(`[Wikimedia] Rejected generic image: ${h.substring(0,100)}...`);continue}return h}}return null}catch(i){return console.warn(`Wikimedia Commons fetch failed for "${e}":`,i),null}}function fo(e){if(!e)return"";let t=e.replace(/\s*\([^)]*\)\s*/g," ").trim();if(/^[A-Z][a-z]+(aceae|idae|ales|ineae|oidea|iformes)$/i.test(t))return"";const n=t.split(/\s+/);if(n.length>=2){const r=n[0],i=n[1];if(/^(aceae|idae|ales|ineae|oidea|iformes)$/i.test(i))return r;if(/^[a-z]/.test(i)&&!i.includes("."))return`${r} ${i}`}return n.length===1&&!/aceae|idae|ales$/i.test(n[0])?n[0]:t}async function QP(e,t,n="pt"){const r=t?fo(t):null,i=fo(e),s=[r,i,t!==r?t:null,e!==i?e:null].filter(Boolean),a=[...new Set(s)];for(const o of a){const u=await qP(o);if(u)return u;const c=await HP(o);if(c)return c;const l=await zP();if(l)return l;const m=await WP(o,n);if(m)return m;const h=await JP(o);if(h)return h;const g=await XP(o);if(g)return g;const x=await YP(o);if(x)return x;const v=await KP(o);if(v)return v}return null}async function Md(e,t="pt",n){var s;const r=new Map,i=3;for(let a=0;a<e.length;a+=i){const o=e.slice(a,a+i),u=o.map(async l=>{const m=await QP(l.name,l.scientificName,t);return{name:l.name,url:m}});if((await Promise.all(u)).forEach(l=>{l.url&&r.set(l.name,l.url)}),n){const l=Math.min(a+i,e.length),m=((s=o[o.length-1])==null?void 0:s.name)||"";n(l,e.length,m)}a+i<e.length&&await new Promise(l=>setTimeout(l,150))}return r}function ml(e){return""}function xy(e,t,n){const r=[];if(!e||e.length<3)return r;const i=e.trim(),s=encodeURIComponent(i);i.replace(/\s+/g,"_");const a=n==="pt"?"pt":"en";return r.push({id:$t(),label:"Wikipedia",url:`https://${a}.wikipedia.org/wiki/Special:Search?search=${s}&go=Go`}),r.push({id:$t(),label:"GBIF",url:`https://www.gbif.org/species/search?q=${s}`}),r.push({id:$t(),label:"iNaturalist",url:`https://www.inaturalist.org/search?q=${s}`}),n==="pt"&&r.push({id:$t(),label:"Flora e Funga do Brasil",url:`https://floradobrasil.jbrj.gov.br/consulta/busca.html?q=${s}`}),n==="pt"&&r.push({id:$t(),label:"Biodiversity4All",url:`https://www.biodiversity4all.org/search?q=${s}`}),n==="pt"&&r.push({id:$t(),label:"SIDOL",url:`https://www.sidol.com.br/busca?q=${s}`}),n==="pt"&&r.push({id:$t(),label:"Flora Digital UFSC",url:`https://floradigital.ufsc.br/busca.php?q=${s}`}),r.push({id:$t(),label:"Flickr",url:`https://www.flickr.com/search/?text=${s}`}),r.push({id:$t(),label:"POWO",url:`https://powo.science.kew.org/results?q=${s}`}),r.slice(0,5)}function Dd(e){const t=e.match(/\(([A-Z][a-z]+ [a-z]+[^)]*)\)/);return t?t[1]:/^([A-Z][a-z]+)\s+([a-z]+)(\s+.*)?$/.test(e)?e.split(/\s+-\s+/)[0].trim():null}const vy=e=>{try{return JSON.parse(e)}catch(t){console.warn("JSON truncated. Attempting repair...");let n=e.trim();n.match(/^([\s\S]*"[^"]*")\s*[,\]\}]/);const r=[()=>{let i=n;i=i.replace(/,\s*$/,""),(i.match(/"/g)||[]).length%2!==0&&(i+='"'),i.match(/:\s*$/)&&(i+='""');const a=[];let o=!1,u=!1;for(let c=0;c<i.length;c++){const l=i[c];if(u){u=!1;continue}if(l==="\\"){u=!0;continue}if(l==='"'){o=!o;continue}o||(l==="{"?a.push("}"):l==="["?a.push("]"):(l==="}"||l==="]")&&a.length>0&&a[a.length-1]===l&&a.pop())}return i+=a.reverse().join(""),JSON.parse(i)},()=>{let i=n;const s=i.lastIndexOf("}]");s>0&&(i=i.substring(0,s+2));const a=[];let o=!1,u=!1;for(let c=0;c<i.length;c++){const l=i[c];if(u){u=!1;continue}if(l==="\\"){u=!0;continue}if(l==='"'){o=!o;continue}o||(l==="{"?a.push("}"):l==="["?a.push("]"):(l==="}"||l==="]")&&a.length>0&&a[a.length-1]===l&&a.pop())}return i+=a.reverse().join(""),JSON.parse(i)},()=>{let i=n;const s=[/\}\s*\}\s*\]\s*\}\s*$/,/\}\s*\]\s*\}\s*$/,/\]\s*\}\s*$/];for(const a of s)if(i.match(a))return JSON.parse(i);i.length;for(let a=i.length-1;a>i.length/2;a--){const o=i.substring(0,a);try{let u=o.replace(/,\s*$/,"");(u.match(/"/g)||[]).length%2!==0&&(u+='"');const l=[];let m=!1;for(const g of u)g==='"'&&(m=!m),m||(g==="{"?l.push("}"):g==="["?l.push("]"):(g==="}"||g==="]")&&l.length&&l[l.length-1]===g&&l.pop());u+=l.reverse().join("");const h=JSON.parse(u);if(h.entities&&h.entities.length>0)return h}catch{}}throw new Error("Could not repair JSON")}];for(let i=0;i<r.length;i++)try{const s=r[i]();return console.log(`JSON repair successful with strategy ${i+1}`),s}catch{}throw console.error("All repair strategies failed"),t}},yy={type:Ae.OBJECT,properties:{name:{type:Ae.STRING,description:"Name of the feature (e.g., 'Wing Color')"},imageUrl:{type:Ae.STRING,description:"URL for feature illustration"},states:{type:Ae.ARRAY,items:{type:Ae.STRING,description:"A state description (e.g., 'Blue')"}}},required:["name","states"]},Ey={type:Ae.OBJECT,properties:{label:{type:Ae.STRING,description:"Title of the link (e.g., 'Wikipedia', 'GBIF')"},url:{type:Ae.STRING,description:"Full URL"}},required:["label","url"]},Ty={type:Ae.OBJECT,properties:{projectName:{type:Ae.STRING},projectDescription:{type:Ae.STRING},features:{type:Ae.ARRAY,items:yy},entities:{type:Ae.ARRAY,items:{type:Ae.OBJECT,properties:{name:{type:Ae.STRING,description:"Entity name (can be common name or scientific name)"},scientificName:{type:Ae.STRING,description:"Scientific binomial name (e.g., 'Panthera leo'). REQUIRED for biological species."},family:{type:Ae.STRING,description:"Taxonomic family name (e.g., 'Felidae', 'Fabaceae'). REQUIRED for biological species."},description:{type:Ae.STRING},links:{type:Ae.ARRAY,items:Ey,description:"External resources"},traits:{type:Ae.ARRAY,items:{type:Ae.OBJECT,properties:{featureName:{type:Ae.STRING,description:"Must match one of the feature names exactly"},stateValue:{type:Ae.STRING,description:"Must match one of the state values for that feature exactly"}},required:["featureName","stateValue"]}}},required:["name","description","traits"]}}},required:["projectName","projectDescription","features","entities"]},ZP={type:Ae.OBJECT,properties:{projectName:{type:Ae.STRING},projectDescription:{type:Ae.STRING},features:{type:Ae.ARRAY,items:yy},entities:{type:Ae.ARRAY,items:{type:Ae.OBJECT,properties:{name:{type:Ae.STRING,description:"Entity name as found in document"},scientificName:{type:Ae.STRING,description:"Scientific binomial name if available (e.g., 'Panthera leo')"},family:{type:Ae.STRING,description:"Taxonomic family name if available (e.g., 'Felidae', 'Fabaceae')"},description:{type:Ae.STRING},links:{type:Ae.ARRAY,items:Ey,description:"External resources"},traits:{type:Ae.ARRAY,items:{type:Ae.OBJECT,properties:{featureName:{type:Ae.STRING,description:"Must match one of the feature names exactly"},stateValue:{type:Ae.STRING,description:"Must match one of the state values for that feature exactly"}},required:["featureName","stateValue"]}}},required:["name","description","traits"]}}},required:["projectName","projectDescription","features","entities"]},eM={type:Ae.OBJECT,properties:{entities:{type:Ae.ARRAY,items:{type:Ae.OBJECT,properties:{id:{type:Ae.STRING,description:"REQUIRED: The exact entity ID from the input - MUST preserve original ID exactly"},name:{type:Ae.STRING,description:"Entity name - MUST preserve original name if not explicitly changing"},scientificName:{type:Ae.STRING,description:"Scientific binomial name - MUST preserve original if present"},family:{type:Ae.STRING,description:"Taxonomic family name - MUST preserve original if present"},description:{type:Ae.STRING,description:"Entity description - can be enhanced"},traitsMap:{type:Ae.STRING,description:'JSON string of traits object in format {"featureId": ["stateId", ...]} - MUST use exact IDs from input'}},required:["id","name","traitsMap"]}},stats:{type:Ae.OBJECT,properties:{processedCount:{type:Ae.NUMBER,description:"Number of entities processed"},modifiedCount:{type:Ae.NUMBER,description:"Number of entities with added/changed traits"},skippedCount:{type:Ae.NUMBER,description:"Number of entities skipped (no changes needed)"}}}},required:["entities"]},tM={type:Ae.OBJECT,properties:{filledEntities:{type:Ae.ARRAY,items:{type:Ae.OBJECT,properties:{entityId:{type:Ae.STRING,description:"The exact entity ID from input"},filledTraits:{type:Ae.STRING,description:'JSON string: only the NEW traits being added, format {"featureId": ["stateId"]}'}},required:["entityId","filledTraits"]}},stats:{type:Ae.OBJECT,properties:{entitiesWithGaps:{type:Ae.NUMBER},traitsAdded:{type:Ae.NUMBER}}}},required:["filledEntities"]},Sy=e=>{const t=e.language==="pt"?"All content (Project Name, Description, Features, States, Entities, Descriptions) MUST be in Portuguese (Brazil).":"All content must be in English.",n="For biological entities, ALWAYS provide: 1) the scientific binomial name (e.g., 'Panthera leo', 'Quercus robur'), and 2) the taxonomic family (e.g., 'Felidae', 'Fabaceae'). Both are REQUIRED for accurate classification.";let r=e.includeFeatureImages?"For each feature, provide a valid, DIRECT public URL to an image file illustrating the trait if available.":"Leave `imageUrl` empty for features.";const i="Leave the 'links' array empty (links will be generated automatically from scientific names).";if(e.importedFile){let g="Extract ALL distinctive features found in the text.";e.featureFocus==="vegetative"?g="STRICTLY EXTRACT ONLY VEGETATIVE features (leaves, bark, stem, roots, growth habit). IGNORE reproductive features (flowers, fruits, seeds).":e.featureFocus==="reproductive"&&(g="STRICTLY EXTRACT ONLY REPRODUCTIVE features (flowers, fruits, seeds, inflorescence). IGNORE vegetative features.");let x="Maintain the descriptions as close to the original text as possible (Balanced).";e.detailLevel===1?x="SIMPLIFY the descriptions. Use shorter, easier sentences. Remove excessive jargon.":e.detailLevel===3&&(x="MAXIMIZE DETAIL. Keep all scientific terms, measurements, and nuances found in the text.");const v=e.requiredFeatures&&e.requiredFeatures.length>0?`7. **REQUIRED FEATURES**: Prioritize extracting the following features if present in the document: ${e.requiredFeatures.join(", ")}. If the document doesn't mention them explicitly, still try to infer reasonable states for these features based on context.`:"",w=`
      You are an expert biologist and data analyst.
      Your task is to analyze the provided document (PDF, Text, or Image) and extract a structured Matrix Identification Key.
      
      **Goal**: Extract entities and features to build a matrix.
      
      **CRITICAL INSTRUCTIONS**: 
      1. You must extract **EVERY SINGLE** species/entity found in the text. DO NOT truncate the list.
      2. **FILTER**: ${g}
      3. **DETAIL**: ${x}
      4. **SCIENTIFIC NAMES**: ${n}
      5. **MEDIA**: 
         - Feature Images: ${r}
         - External Links: ${i}
      6. ${t}
      ${v}
      
      **Format**: Return valid JSON.
      **IMPORTANT**: Do not include markdown code fences (\`\`\`json ... \`\`\`). Return raw JSON only. Ensure all keys and string values are properly escaped.
    `,E=`
      Analyze the attached file. Extract a comprehensive biological identification key.
      
      - Project Name: Derive from document title.
      - Description: Summary of content.
      - Entities: Extract ALL entities found. Include scientific names for accurate image lookup.
      - Features: Extract distinctive traits based on the focus setting.
      - Matrix: Map traits to entities.
      
      If analyzing a Dichotomous Key, flatten the logic: assign all traits accumulated along the path to the species.
    `,y=[{inlineData:{mimeType:e.importedFile.mimeType,data:e.importedFile.data}},{text:E}];return{systemInstruction:w,prompt:E,parts:y,schema:ZP}}let s="";e.featureFocus==="reproductive"?s="Focus primarily on reproductive features (e.g., flowers, fruits, seeds, cones, spores, inflorescence).":e.featureFocus==="vegetative"?s="Focus primarily on vegetative features (e.g., leaves, bark, stem, roots, growth habit, phyllo taxis).":s="Use a balanced mix of vegetative and reproductive features.";let a="";e.detailLevel===1?a="AUDIENCE: Children or General Public. Use simple, common language. Short descriptions. Avoid complex jargon.":e.detailLevel===3?a="AUDIENCE: Experts/Scientists. Use precise botanical/zoological terminology. Comprehensive descriptions. High detail.":a="AUDIENCE: Students/Enthusiasts. Balanced use of scientific terms with clear explanations.";const o=`
    You are an expert taxonomist and biologist. 
    Your task is to create an interactive identification key (matrix key) based strictly on the user's constraints.
    
    Constraints:
    1.  **Language**: ${t}
    2.  **Topic**: The general subject.
    3.  **Geography**: Restrict entities to this region/biome.
    4.  **Taxonomy**: Restrict to this Family/Genus/Order if specified.
    5.  **Quantity**: Generate exactly or close to the requested number of entities and features.
    6.  **Focus**: ${s}
    7.  **Detail Level**: ${a}
    8.  **SCIENTIFIC NAMES**: ${n}
    9.  **MEDIA**: 
        - Feature Images: ${r}
        - External Links: ${i}
    ${e.requiredFeatures&&e.requiredFeatures.length>0?`10. **REQUIRED FEATURES**: You MUST include ALL of the following features in the key: ${e.requiredFeatures.join(", ")}. These are mandatory and must be among the features generated.`:""}
    ${e.requiredSpecies&&e.requiredSpecies.length>0?`11. **REQUIRED SPECIES**: You MUST include ALL of the following species in the key: ${e.requiredSpecies.slice(0,10).join(", ")}${e.requiredSpecies.length>10?` (and ${e.requiredSpecies.length-10} more)`:""}. These species are MANDATORY. For species with incomplete data, include them anyway and fill what you can.`:""}

    Output Requirements:
    1.  List of distinctive features. Each feature must have 2+ states.
    2.  List of entities with their scientific binomial names.
    3.  Matrix: Assign correct states.
    4.  **Scientific Accuracy**: Ensure traits are factual.

    The response must be a structured JSON object.
    **IMPORTANT**: Do not include markdown code fences (\`\`\`json ... \`\`\`). Return raw JSON only. Ensure all keys and string values are properly escaped.
  `,u=e.requiredFeatures&&e.requiredFeatures.length>0?`
    MANDATORY FEATURES: The following features MUST be included in the key:
    ${e.requiredFeatures.map((g,x)=>`${x+1}. ${g}`).join(`
    `)}
`:"",c=e.requiredSpecies&&e.requiredSpecies.length>0?`
    MANDATORY SPECIES: The following species MUST be included in the key. Include them even if feature data is incomplete - fill in what you can:
    ${e.requiredSpecies.map((g,x)=>`${x+1}. ${g}`).join(`
    `)}
`:"",l=()=>{const g=[];return e.scope==="global"?g.push("Global scope"):e.scope==="national"?g.push("Brazil (national)"):e.scope==="regional"&&g.push("Regional focus"),e.biome&&g.push(`Biome: ${e.biome}`),e.stateUF&&g.push(`State/UF: ${e.stateUF}`),e.geography&&g.push(`Region: ${e.geography}`),g.length>0?g.join(", "):"Global"},m=()=>{const g=[];return e.taxonomyFamily&&g.push(`Family: ${e.taxonomyFamily}`),e.taxonomyGenus&&g.push(`Genus: ${e.taxonomyGenus}`),e.taxonomy&&g.push(e.taxonomy),g.length>0?g.join(", "):"General"},h=`
    Create an identification key for: "${e.topic}".
    
    Constraints:
    - Language: ${e.language==="pt"?"Portuguese":"English"}
    - Geographic Scope: ${l()}
    - Taxonomic Context: ${m()}
    - Target Number of Entities: ${e.count}${e.requiredSpecies&&e.requiredSpecies.length>0?" (minimum - must include all required species plus additional if needed)":""}
    - Target Number of Features: ${e.featureCount}
    - Feature Focus: ${e.featureFocus}
    - Complexity Level: ${e.detailLevel}/3
    ${u}${c}
    IMPORTANT: For each entity, you MUST provide the scientificName field with the correct binomial nomenclature (e.g., "Panthera leo" for Lion).
    ${e.taxonomyFamily?`All entities MUST belong to the family ${e.taxonomyFamily}.`:""}
    ${e.taxonomyGenus?`All entities MUST belong to the genus ${e.taxonomyGenus}.`:""}
    ${e.biome?`All entities MUST occur in the ${e.biome} biome.`:""}
    ${e.stateUF?`All entities MUST occur in ${e.stateUF}, Brazil.`:""}
    ${e.scope==="national"?"All entities MUST occur in Brazil. Use Flora do Brasil 2020 as reference for valid names.":""}
    ${e.requiredSpecies&&e.requiredSpecies.length>0?`
CRITICAL: You MUST include ALL species from the MANDATORY SPECIES list above. For any species where you lack complete information, still include them and fill in what characteristics you can determine. These species are non-negotiable.`:""}

    Ensure the features allow for effective separation of these entities.
  `;return{systemInstruction:o,prompt:h,schema:Ty,parts:void 0}},nM=async(e,t,n,r)=>{if(!t)throw new Error("API Key is missing");const i=new a0({apiKey:t}),{systemInstruction:s,prompt:a,parts:o,schema:u}=Sy(e);n&&n(`SYSTEM:
${s}

USER PROMPT:
${a}`);const c=o||a,l=await wy(i,e.model,c,s,u,e.language,e.includeLinks);if(e.requiredSpecies&&e.requiredSpecies.length>0){const h=new Set(l.entities.map(x=>x.name.toLowerCase().trim())),g=new Set(l.entities.map(x=>(x.scientificName||Dd(x.name)||"").toLowerCase().trim()));for(const x of e.requiredSpecies){const v=x.toLowerCase().trim(),w=fo(x).toLowerCase().trim();if(!(h.has(v)||h.has(w)||g.has(v)||g.has(w)||Array.from(h).some(y=>y.includes(w)||w.includes(y))||Array.from(g).some(y=>y.includes(w)||w.includes(y)))){const y=fo(x)||x,T={id:$t(),name:y,description:e.language==="pt"?"Espcie includa da lista obrigatria. Dados a serem preenchidos.":"Species included from required list. Data to be filled.",imageUrl:ml(),links:e.includeLinks?xy(y,"",e.language):[],traits:{}};T.scientificName=y,l.entities.push(T),h.add(y.toLowerCase().trim()),g.add(y.toLowerCase().trim())}}}const m=100;if(e.includeSpeciesImages&&l.entities.length>0){const h=l.entities.slice(0,m).map(x=>({name:x.name,scientificName:x.scientificName||Dd(x.name)||x.name})),g=await Md(h,e.language,r);l.entities=l.entities.map((x,v)=>{const{scientificName:w,...E}=x,y=v<m&&g.get(x.name)||ml(x.name);return{...E,imageUrl:y}})}return l},rM=async(e,t,n="gemini-2.5-flash",r="pt")=>{if(!t)throw new Error("API Key is missing");const i=new a0({apiKey:t});return await wy(i,n,e,"You are an expert biologist. Return ONLY valid JSON matching the schema. Do not include markdown code fences.",Ty,r,!0)},iM=async(e,t,n,r="gemini-2.5-flash",i="pt",s="refine")=>{if(!n)throw new Error("API Key is missing");const a=new a0({apiKey:n}),o=new Map(t.features.map(h=>[h.id,h])),u=new Map;t.features.forEach(h=>h.states.forEach(g=>u.set(g.id,h.id)));const c=new Map(t.entities.map(h=>[h.id,h])),l=s==="fillGaps"?tM:eM,m=s==="fillGaps"?`You are an expert taxonomist. Your task is to fill in missing trait data for entities.
CRITICAL: Use ONLY the exact IDs provided in the input. Return ONLY the entityId and the NEW traits being added.
Format for filledTraits: JSON string like {"featureId": ["stateId"]}`:`You are an expert taxonomist. Your task is to improve an identification key while preserving all IDs.
CRITICAL: Every entity MUST have its original "id" field preserved exactly.
Format for traitsMap: JSON string like {"featureId": ["stateId", "stateId2"]}`;try{const h=await sM(a,r,e,m,l);let g={};try{g=vy(h)||{}}catch(x){return console.error("[refineExistingProject] Failed to parse AI response:",x),console.log("[refineExistingProject] Returning original project due to parse failure"),t}if(console.log(`[refineExistingProject] Mode: ${s}, Response type: ${typeof g}, Response keys:`,Object.keys(g||{})),console.log("[refineExistingProject] Raw response preview:",h==null?void 0:h.substring(0,500)),s==="fillGaps"){const x=(g==null?void 0:g.filledEntities)||(g==null?void 0:g.entities)||[];if(console.log(`[refineExistingProject] fillGaps - found ${x.length} filled entities of ${t.entities.length} total`),!Array.isArray(x)||x.length===0)return console.log("[refineExistingProject] No valid filled entities found, returning original project INTACT"),t;const v=new Map;for(const E of x)try{const y=E.entityId||E.id,T=E.filledTraits||E.traitsMap||E.traits,C=typeof T=="string"?JSON.parse(T):T;y&&C&&v.set(y,C)}catch{console.warn(`Failed to parse traits for entity ${E.entityId||E.id}`)}const w=t.entities.map(E=>{const y=v.get(E.id);if(!y)return E;const T={...E.traits};for(const[C,L]of Object.entries(y)){const B=o.get(C);if(!B)continue;const R=B.states.map(M=>M.id),O=L.filter(M=>R.includes(M));if(O.length>0){const M=T[C]||[],k=[...new Set([...M,...O])];T[C]=k}}return{...E,traits:T}});return w.length!==t.entities.length?(console.error(`[refineExistingProject] CRITICAL: Entity count mismatch! Original: ${t.entities.length}, Merged: ${w.length}`),console.log("[refineExistingProject] Returning original project to prevent data loss"),t):(console.log(`[refineExistingProject] fillGaps SUCCESS: ${v.size} entities updated, ${w.length} total entities preserved`),{...t,entities:w})}else{const x=g.entities||[];if(x.length===0)return console.warn("[refineExistingProject] AI returned no entities, preserving original"),t;const v=[],w=new Set;for(const E of x){const y=c.get(E.id);let T={};try{T=typeof E.traitsMap=="string"?JSON.parse(E.traitsMap):E.traitsMap||{}}catch{console.warn(`Failed to parse traitsMap for entity ${E.name}`),T=(y==null?void 0:y.traits)||{}}const C={};for(const[B,R]of Object.entries(T)){const O=o.get(B);if(!O)continue;const M=O.states.map(z=>z.id),k=R.filter(z=>M.includes(z));k.length>0&&(C[B]=k)}const L=E.id||(y==null?void 0:y.id)||$t();w.has(L)||(w.add(L),v.push({id:L,name:E.name||(y==null?void 0:y.name)||"Unknown",scientificName:E.scientificName||(y==null?void 0:y.scientificName),family:E.family||(y==null?void 0:y.family),description:E.description||(y==null?void 0:y.description)||"",imageUrl:(y==null?void 0:y.imageUrl)||"",links:(y==null?void 0:y.links)||[],traits:Object.keys(C).length>0?C:(y==null?void 0:y.traits)||{}}))}if(s==="expand")for(const E of t.entities)w.has(E.id)||(v.push(E),w.add(E.id));if(s==="refine"||s==="clean"){const E=[];for(const y of t.entities)w.has(y.id)||(E.push(y),v.push(y),w.add(y.id));E.length>0&&(console.warn(`[refineExistingProject] AI omitted ${E.length} entities - PRESERVING them to prevent data loss:`),E.forEach(y=>console.warn(`  - ${y.name} (${y.id})`)))}return v.length<t.entities.length*.5?(console.warn(`[refineExistingProject] Too many entities lost (${v.length} vs ${t.entities.length}), preserving original`),t):{...t,entities:v,features:t.features}}}catch(h){throw console.error("[refineExistingProject] Error:",h),h}};async function sM(e,t,n,r,i){const s=u=>new Promise(c=>setTimeout(c,u)),a=["gemini-2.5-flash","gemini-2.0-flash","gemini-1.5-flash"],o=async(u,c=0)=>{try{return(await e.models.generateContent({model:u.trim(),contents:n,config:{systemInstruction:r,responseMimeType:"application/json",responseSchema:i,maxOutputTokens:65536}})).text||"{}"}catch(m){const h=m.message||"",g=m.status||0;if((g===503||g===429||h.includes("overloaded"))&&c<3){const v=Math.pow(2,c)*2e3;return console.warn(`Retrying ${u} in ${v/1e3}s (attempt ${c+1})`),await s(v),o(u,c+1)}const x=a.indexOf(u);if(x<a.length-1)return console.warn(`Falling back from ${u} to ${a[x+1]}`),o(a[x+1],0);throw m}};return o(t||"gemini-2.5-flash")}async function wy(e,t,n,r,i,s="en",a=!0){const o=c=>new Promise(l=>setTimeout(l,c)),u=async(c,l=0)=>{const h=["gemini-2.5-flash","gemini-2.0-flash","gemini-1.5-flash"];try{return await e.models.generateContent({model:c.trim(),contents:n,config:{systemInstruction:r,responseMimeType:"application/json",responseSchema:i,maxOutputTokens:65536}})}catch(g){const x=g.message||"",v=g.status||(x.includes("503")?503:x.includes("429")?429:0);if(x.includes("404")||x.includes("NOT_FOUND")){const w=h.indexOf(c),E=h[w+1]||h[0];if(E!==c)return console.warn(`Model ${c} not found, falling back to ${E}`),await u(E,0)}if((v===503||v===429||x.includes("overloaded")||x.includes("UNAVAILABLE"))&&l<3){const w=Math.pow(2,l)*2e3;return console.warn(`Model ${c} is overloaded (attempt ${l+1}/3). Retrying in ${w/1e3}s...`),await o(w),await u(c,l+1)}if((v===503||v===429||x.includes("overloaded"))&&l>=3){const w=h.indexOf(c),E=h[w+1];if(E)return console.warn(`Model ${c} still overloaded after 3 retries. Trying ${E}...`),await u(E,0)}throw g}};try{const l=await u(t||"gemini-2.5-flash"),m=vy(l.text||"{}");if(!m.projectName)throw new Error("Invalid AI response: missing projectName");if(!m.features||!Array.isArray(m.features))throw console.error("[parseAIResponse] Invalid features:",m.features),new Error("Invalid AI response: features must be an array");if(!m.entities||!Array.isArray(m.entities))throw console.error("[parseAIResponse] Invalid entities:",m.entities),new Error("Invalid AI response: entities must be an array");const h=m.features.map(x=>{if(!x||typeof x!="object")return console.warn("[parseAIResponse] Skipping invalid feature:",x),null;const v=(x.states||[]).map(w=>typeof w=="string"?{id:$t(),label:w}:typeof w=="object"&&w!==null?{id:w.id||$t(),label:w.label||w}:{id:$t(),label:String(w)});return{id:x.id||$t(),name:x.name||"Unnamed Feature",imageUrl:x.imageUrl||"",states:v}}).filter(x=>x!==null),g=m.entities.map(x=>{if(!x||typeof x!="object")return console.warn("[parseAIResponse] Skipping invalid entity:",x),null;const v={};if(x.traits===void 0||x.traits===null)console.log(`[parseAIResponse] Entity "${x.name}" has no traits defined`);else if(Array.isArray(x.traits))x.traits.forEach(C=>{let L="",B="";if(typeof C=="string"){const R=C.indexOf(":");R>-1&&(L=C.substring(0,R).trim(),B=C.substring(R+1).trim())}else typeof C=="object"&&C!==null&&(L=C.featureName,B=C.stateValue);if(L&&B){const R=h.find(O=>O.name.toLowerCase()===L.toLowerCase());if(R){const O=R.states.find(M=>M.label.toLowerCase()===B.toLowerCase());O&&(v[R.id]||(v[R.id]=[]),v[R.id].push(O.id))}}});else if(typeof x.traits=="object"&&x.traits!==null)for(const[C,L]of Object.entries(x.traits))Array.isArray(L)&&(v[C]=L);const w=x.scientificName||Dd(x.name)||x.name,E=x.family||"",y=ml(x.name),T=a?xy(w,E,s):[];return{id:x.id||$t(),name:x.name||"Unnamed Entity",scientificName:w,family:E,description:x.description||"",imageUrl:x.imageUrl||y,links:x.links||T,traits:v}}).filter(x=>x!==null);return{id:m.id||$t(),name:m.projectName||m.name,description:m.projectDescription||m.description,features:h,entities:g}}catch(c){throw console.error("Gemini Generation Error:",c),c}}const aM=(e,t)=>{const n=JSON.stringify(e);return`<!DOCTYPE html>
<html lang="${t}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${e.name} - NOZESia Key</title>
  <script src="https://cdn.tailwindcss.com"><\/script>
  <style>
    .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
  </style>
</head>
<body class="bg-slate-100 font-sans">
  <div id="app"></div>
  <script>
    const project = ${n};
    const lang = "${t}";
    const t = {
      en: {
        features: "Features", selected: "selected", matches: "Matches", discarded: "Discarded",
        restart: "Restart", noMatches: "No matches found.", tryUnselecting: "Try unselecting some features.",
        potential: "potential matches", identified: "1 Entity identified", close: "Close",
        speciesDetails: "Species Details", morphology: "Morphology & Traits", resources: "Resources",
        createdWith: "Created with NOZESia", viewResults: "View Results", excluded: "Excluded by selection",
        scientificName: "Scientific Name", family: "Family", taxonomy: "Taxonomy"
      },
      pt: {
        features: "Caractersticas", selected: "selecionado(s)", matches: "Compatveis", discarded: "Descartados",
        restart: "Reiniciar", noMatches: "Nenhum resultado.", tryUnselecting: "Tente remover selees.",
        potential: "matches potenciais", identified: "1 Entidade identificada", close: "Fechar",
        speciesDetails: "Detalhes da Espcie", morphology: "Morfologia & Caractersticas", resources: "Recursos Adicionais",
        createdWith: "Criado com NOZESia", viewResults: "Ver Resultados", excluded: "Excludo pela seleo",
        scientificName: "Nome Cientfico", family: "Famlia", taxonomy: "Taxonomia"
      }
    };
    const strings = t[lang];
    
    let selections = {};
    let showDiscarded = false;
    let viewingEntity = null;
    let viewingStateImage = null; // {url, label, featureName}
    let mobileTab = 'FILTERS';
    
    function toggleSelection(featureId, stateId) {
      if (!selections[featureId]) selections[featureId] = [];
      const idx = selections[featureId].indexOf(stateId);
      if (idx >= 0) {
        selections[featureId].splice(idx, 1);
        if (selections[featureId].length === 0) delete selections[featureId];
      } else {
        selections[featureId].push(stateId);
      }
      render();
    }
    
    function resetKey() { selections = {}; render(); }
    function setMobileTab(tab) { mobileTab = tab; render(); }
    function toggleDiscarded() { showDiscarded = !showDiscarded; render(); }
    function viewEntity(entity) { viewingEntity = entity; render(); }
    function viewStateImage(url, label, featureName) { viewingStateImage = {url, label, featureName}; render(); }
    function closeStateImage() { viewingStateImage = null; render(); }
    function closeEntity() { viewingEntity = null; render(); }
    
    function getFilteredEntities() {
      const remaining = [], discarded = [];
      project.entities.forEach(entity => {
        let isMatch = true;
        for (const [fid, sids] of Object.entries(selections)) {
          const entityStates = entity.traits[fid] || [];
          if (!sids.some(id => entityStates.includes(id))) { isMatch = false; break; }
        }
        if (isMatch) remaining.push(entity); else discarded.push(entity);
      });
      return { remaining, discarded };
    }
    
    function getTotalSelections() {
      return Object.values(selections).reduce((a, c) => a + c.length, 0);
    }
    
    function render() {
      const { remaining, discarded } = getFilteredEntities();
      const totalSel = getTotalSelections();
      
      let entityModalHTML = '';
      if (viewingEntity) {
        const e = viewingEntity;
        const traitsHTML = project.features.map(f => {
          const stateIds = e.traits[f.id] || [];
          const stateLabels = stateIds.map(sid => f.states.find(s => s.id === sid)?.label).filter(Boolean).join(', ');
          return stateLabels ? \`<div class="flex justify-between py-2 border-b border-slate-100"><span class="text-slate-500">\${f.name}</span><span class="font-medium text-slate-800">\${stateLabels}</span></div>\` : '';
        }).join('');
        const linksHTML = e.links && e.links.length > 0 ? \`<div class="mt-6"><h4 class="font-semibold text-slate-700 mb-3">\${strings.resources}</h4><div class="space-y-2">\${e.links.map(l => \`<a href="\${l.url}" target="_blank" class="flex items-center gap-2 text-emerald-600 hover:underline text-sm"><span></span>\${l.label}</a>\`).join('')}</div></div>\` : '';
        const taxonomyHTML = (e.scientificName || e.family) ? \`
          <div class="mt-4 p-3 bg-emerald-50 rounded-lg border border-emerald-100">
            <h4 class="font-semibold text-emerald-800 mb-2 text-sm flex items-center gap-1"> \${strings.taxonomy}</h4>
            \${e.scientificName ? \`<div class="flex justify-between py-1"><span class="text-emerald-600 text-sm">\${strings.scientificName}</span><span class="font-medium text-emerald-800 italic">\${e.scientificName}</span></div>\` : ''}
            \${e.family ? \`<div class="flex justify-between py-1"><span class="text-emerald-600 text-sm">\${strings.family}</span><span class="font-medium text-emerald-800">\${e.family}</span></div>\` : ''}
          </div>
        \` : '';
        entityModalHTML = \`
          <div class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4" onclick="if(event.target===this)closeEntity()">
            <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col">
              <div class="relative h-48 sm:h-64 bg-slate-200 shrink-0">
                \${e.imageUrl ? \`<img src="\${e.imageUrl}" class="w-full h-full object-cover" onerror="this.style.display='none'">\` : '<div class="w-full h-full flex items-center justify-center text-slate-400 text-6xl"></div>'}
                <button onclick="closeEntity()" class="absolute top-3 right-3 bg-black/40 hover:bg-black/60 text-white rounded-full p-2"></button>
              </div>
              <div class="p-6 overflow-y-auto custom-scrollbar">
                <h2 class="text-2xl font-bold text-slate-800 mb-1">\${e.name}</h2>
                \${e.scientificName && e.scientificName !== e.name ? \`<p class="text-slate-500 italic mb-2">\${e.scientificName}</p>\` : ''}
                \${e.family ? \`<span class="inline-block bg-emerald-100 text-emerald-700 text-xs px-2 py-1 rounded-full mb-3">\${e.family}</span>\` : ''}
                \${e.description ? \`<p class="text-slate-600 mb-4">\${e.description}</p>\` : ''}
                \${taxonomyHTML}
                <div class="mt-4"><h4 class="font-semibold text-slate-700 mb-2">\${strings.morphology}</h4><div class="text-sm">\${traitsHTML}</div></div>
                \${linksHTML}
              </div>
            </div>
          </div>
        \`;
      }
      
      // State Image Modal
      let stateImageModalHTML = '';
      if (viewingStateImage) {
        stateImageModalHTML = \`
          <div class="fixed inset-0 bg-black/80 z-[60] flex items-center justify-center p-4" onclick="if(event.target===this)closeStateImage()">
            <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full overflow-hidden" onclick="event.stopPropagation()">
              <div class="relative">
                <img src="\${viewingStateImage.url}" alt="\${viewingStateImage.label}" class="w-full max-h-[60vh] object-contain bg-slate-100">
                <button onclick="closeStateImage()" class="absolute top-3 right-3 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full transition-colors"></button>
              </div>
              <div class="p-4 bg-white">
                <h4 class="font-semibold text-slate-800">\${viewingStateImage.label}</h4>
                <p class="text-sm text-slate-500">\${viewingStateImage.featureName}</p>
              </div>
            </div>
          </div>
        \`;
      }
      
      const featuresHTML = project.features.map(f => {
        const selStates = selections[f.id] || [];
        return \`
          <div class="bg-slate-50 rounded-xl p-4">
            <h4 class="font-semibold text-slate-700 mb-3 flex items-center gap-2">
              \${f.imageUrl ? \`<img src="\${f.imageUrl}" class="w-6 h-6 rounded object-cover">\` : ''}
              \${f.name}
              \${selStates.length > 0 ? \`<span class="ml-auto text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full">\${selStates.length}</span>\` : ''}
            </h4>
            <div class="flex flex-wrap gap-2">
              \${f.states.map(s => {
                const isSel = selStates.includes(s.id);
                const hasImg = s.imageUrl ? true : false;
                return \`<div class="flex items-center gap-1">
                  \${hasImg ? \`<button onclick="viewStateImage('\${s.imageUrl}', '\${s.label.replace(/'/g, "\\\\'")}', '\${f.name.replace(/'/g, "\\\\'")}')" class="w-6 h-6 rounded overflow-hidden border border-slate-200 hover:border-emerald-400 transition-colors shrink-0" title="Ver imagem"><img src="\${s.imageUrl}" class="w-full h-full object-cover"></button>\` : ''}
                  <button onclick="toggleSelection('\${f.id}','\${s.id}')" class="px-3 py-1.5 rounded-lg text-sm font-medium transition-all \${isSel ? 'bg-emerald-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-100 border border-slate-200'}">\${s.label}</button>
                </div>\`;
              }).join('')}
            </div>
          </div>
        \`;
      }).join('');
      
      const entityCard = (e, isDiscarded = false) => \`
        <div onclick="viewEntity(project.entities.find(x=>x.id==='\${e.id}'))" class="bg-white rounded-xl shadow-sm hover:shadow-lg transition-all cursor-pointer overflow-hidden border \${isDiscarded ? 'border-red-200 opacity-60' : 'border-slate-200 hover:border-emerald-300'}">
          <div class="h-32 bg-slate-100 relative">
            \${e.imageUrl ? \`<img src="\${e.imageUrl}" class="w-full h-full object-cover" onerror="this.parentElement.innerHTML='<div class=\\\\'w-full h-full flex items-center justify-center text-slate-300 text-4xl\\\\'></div>'">\` : '<div class="w-full h-full flex items-center justify-center text-slate-300 text-4xl"></div>'}
            \${isDiscarded ? '<div class="absolute inset-0 bg-red-500/20 flex items-center justify-center"><span class="bg-red-500 text-white text-xs px-2 py-1 rounded"></span></div>' : ''}
            \${e.family ? \`<span class="absolute top-2 left-2 bg-emerald-600/90 text-white text-[10px] px-1.5 py-0.5 rounded">\${e.family}</span>\` : ''}
          </div>
          <div class="p-3">
            <h4 class="font-semibold text-slate-800 text-sm truncate">\${e.name}</h4>
            \${e.scientificName && e.scientificName !== e.name ? \`<p class="text-xs text-slate-400 italic truncate">\${e.scientificName}</p>\` : ''}
            \${e.description ? \`<p class="text-xs text-slate-500 mt-1 line-clamp-2">\${e.description}</p>\` : ''}
          </div>
        </div>
      \`;
      
      const remainingHTML = remaining.length > 0 
        ? remaining.map(e => entityCard(e)).join('')
        : \`<div class="col-span-full text-center py-12 text-slate-500"><div class="text-4xl mb-3"></div><p class="font-medium">\${strings.noMatches}</p><p class="text-sm">\${strings.tryUnselecting}</p></div>\`;
      
      const discardedHTML = discarded.length > 0 && showDiscarded
        ? \`<div class="mt-6 pt-6 border-t"><h4 class="font-semibold text-slate-500 mb-4 flex items-center gap-2"> \${strings.discarded} (\${discarded.length})</h4><div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">\${discarded.map(e => entityCard(e, true)).join('')}</div></div>\`
        : '';
      
      document.getElementById('app').innerHTML = \`
        <div class="min-h-screen flex flex-col">
          <header class="bg-white border-b px-4 py-3 flex justify-between items-center shadow-sm">
            <div class="flex items-center gap-3">
              <span class="bg-emerald-600 text-white text-xs px-2 py-1 rounded font-bold">KEY</span>
              <h1 class="text-lg font-bold text-slate-800 truncate">\${project.name}</h1>
            </div>
            <button onclick="resetKey()" class="flex items-center gap-2 px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg"> \${strings.restart}</button>
          </header>
          
          <div class="md:hidden flex border-b bg-white">
            <button onclick="setMobileTab('FILTERS')" class="flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 \${mobileTab==='FILTERS'?'text-emerald-600 border-b-2 border-emerald-600':'text-slate-500 bg-slate-50'}">
               \${strings.features} \${totalSel>0?\`<span class="bg-emerald-600 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center">\${totalSel}</span>\`:''}
            </button>
            <button onclick="setMobileTab('RESULTS')" class="flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 \${mobileTab==='RESULTS'?'text-emerald-600 border-b-2 border-emerald-600':'text-slate-500 bg-slate-50'}">
               \${strings.matches} <span class="bg-slate-200 text-slate-700 text-xs px-1.5 py-0.5 rounded-full">\${remaining.length}</span>
            </button>
          </div>
          
          <div class="flex-1 flex flex-col md:flex-row overflow-hidden">
            <div class="w-full md:w-1/3 lg:w-1/4 bg-white md:border-r flex-col h-full \${mobileTab==='FILTERS'?'flex':'hidden md:flex'}">
              <div class="hidden md:block p-4 border-b bg-slate-50">
                <h3 class="font-semibold text-slate-700 flex items-center gap-2"> \${strings.features}</h3>
              </div>
              <div class="flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar">\${featuresHTML}</div>
            </div>
            
            <div class="flex-1 flex flex-col h-full \${mobileTab==='RESULTS'?'flex':'hidden md:flex'}">
              <div class="p-4 border-b bg-slate-50 flex justify-between items-center">
                <div>
                  <span class="font-semibold text-slate-700">\${remaining.length === 1 ? strings.identified : remaining.length + ' ' + strings.potential}</span>
                </div>
                \${discarded.length > 0 ? \`<button onclick="toggleDiscarded()" class="text-sm text-slate-500 hover:text-slate-700 flex items-center gap-1">\${showDiscarded?'':''} \${strings.discarded} (\${discarded.length})</button>\` : ''}
              </div>
              <div class="flex-1 overflow-y-auto p-4 custom-scrollbar">
                <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">\${remainingHTML}</div>
                \${discardedHTML}
              </div>
            </div>
          </div>
          
          <footer class="bg-white border-t px-4 py-2 text-center text-xs text-slate-400">
            \${strings.createdWith}  <a href="https://djhandoom.github.io/nozes/" target="_blank" class="text-emerald-600 hover:underline">djhandoom.github.io/nozes</a>
          </footer>
        </div>
        \${entityModalHTML}
        \${stateImageModalHTML}
      \`;
    }
    
    render();
  <\/script>
</body>
</html>`},oM={en:{builder:"Builder",aiWizard:"Nuts AI",savePlay:"Save & Play",exit:"Exit",save:"Save",open:"Open",export:"Export Project",exportXLSX:"Export XLSX",exportHTML:"Export HTML",import:"Import Project",general:"General",features:"Features",entities:"Entities",matrix:"Matrix Scoring",projectName:"Project Name",description:"Description",definedFeatures:"Defined Features",definedFeaturesDesc:"Define traits and their possible states.",addFeature:"Add Feature",featureName:"Feature Name",imageURL:"Image URL (optional)",states:"States",addState:"Add State",manageEntities:"Entities",manageEntitiesDesc:"Manage the taxa included in your key.",addEntity:"Add Entity",scoringMatrix:"Scoring Matrix",scoringMatrixDesc:"Click cells to toggle state association",taxaFeatures:"Taxa / Features",aiTitle:"Nuts AI Wizard",aiDesc:"Generate or Extract keys using Gemini AI.",topic:"Key Topic / Subject",topicPlace:"e.g. Freshwater Fishes, Garden Weeds",geography:"Geographic Scope",taxonomyFamily:"Family",taxonomyGenus:"Genus",biome:"Biome",stateUF:"State/Region",scopeLabel:"Scope",scopeGlobal:"Global",scopeNational:"National (Brazil)",scopeRegional:"Regional",taxonomyFilters:"Taxonomic Filters",geographyFilters:"Geographic Filters",numEntities:"Approx. # of Entities",numFeatures:"Approx. # of Features",requiredFeatures:"Required Features",requiredFeaturesDesc:"Select features the AI must include",addCustomFeature:"Add custom feature...",selectedFeatures:"selected",requiredSpecies:"Required Species List",requiredSpeciesDesc:"Species that MUST be included (one per line)",requiredSpeciesPlaceholder:`Enter species names, one per line:
Inga edulis
Inga marginata
Inga vera`,importSpeciesList:"Import species list",importSpeciesFormats:"Supports: .txt, .csv, .doc, .json",speciesCount:"species listed",clearList:"Clear list",generating:"Nozes IA is thinking... (15-45s)",cancel:"Cancel",generate:"Generate Key",savedMsg:"Project saved to browser storage!",errGen:"Failed to generate key. Check console.",featureFocus:"Feature Focus",focusGeneral:"General (All)",focusRepro:"Reproductive Only",focusVeg:"Vegetative Only",options:"Options",fetchSpeciesImg:"Fetch Species Images",fetchFeatureImg:"Fetch Feature Images",fetchLinks:"Fetch External Links",detailLevel:"Detail Level",detailSimple:"Simplified",detailBalanced:"Balanced",detailExpert:"Expert / High",detailOriginal:"Original Fidelity",noSaved:"No saved projects.",close:"Close",modeTopic:"Generate from Topic",modeImport:"Import from File",uploadLabel:"Upload PDF, Image, or Text",uploadDesc:"The AI will study the document and extract entities and features automatically.",supportedFormats:"Supports: .pdf, .txt, .jpg, .png",dropFile:"Drop file here",removeFile:"Remove file",analyzing:"Analyzing document...",promptCopied:"Prompt copied to clipboard!",configSettings:"Configuration",links:"Additional Links / Resources",addLink:"Add Link",editTraits:"Edit Characteristics",traitEditor:"Trait Editor",copyPrompt:"Copy",missingKey:"Missing API Key. Please configure it in the main menu Settings.",apiKeyWarning:"Configure your API Key to use AI features",clickGear:"Click the key icon above",modeRefine:"Expand/Refine",refineTitle:"Enhance Current Key",refineDesc:"Use AI to expand or refine your existing identification key.",actionExpand:"Expand Entities",actionExpandDesc:"Add new species/entities similar to existing ones",actionRefine:"Refine Features",actionRefineDesc:"Improve feature descriptions and add discriminating traits",actionClean:"Clean & Optimize",actionCleanDesc:"Remove redundant features, fix inconsistencies",expandCount:"# New Entities to Add",keepExisting:"Preserve existing entities",addFeatures:"Add new discriminating features",expandFilters:"Taxonomic & Geographic Filters",expandFamily:"Family (optional)",expandGenus:"Genus (optional)",expandBiome:"Biome (optional)",expandStateUF:"State/UF (optional)",expandScope:"Geographic Scope",expandRequiredSpecies:"Required Species to Add",expandRequiredSpeciesDesc:"Species that MUST be added (one per line)",expandRequiredSpeciesPlaceholder:`Enter species to add:
Inga edulis
Inga marginata`,refineRequiredFeaturesTitle:"Required Features",refineRequiredFeaturesDesc:"Features that MUST be included in the key",addRequiredFeature:"Add feature...",customFeature:"Custom feature",improveDescriptions:"Improve descriptions",fillGaps:"Fill missing trait data",removeRedundant:"Remove redundant features",fixInconsistencies:"Fix inconsistencies",featureTypeLabel:"Feature Type",featureTypeVegetative:"Vegetative only",featureTypeReproductive:"Reproductive only",featureTypeBoth:"Both (vegetative + reproductive)",featureTypeDesc:"Focus on vegetative characters (leaves, stems, bark) or reproductive (flowers, fruits, seeds)",currentProject:"Current Project",noProjectLoaded:"No project loaded. Create or load a project first.",entitiesCount:"entities",featuresCount:"features",filterEntities:"Filter Entities",filterByFamily:"Filter by family",filterByGenus:"Filter by genus",filterByName:"Filter by name",searchPlaceholder:"Search...",allFamilies:"All families",allGenera:"All genera",clearFilters:"Clear filters",onlyWithGaps:"Only with gaps",onlyWithGapsDesc:"Show only entities with missing traits",showingEntities:"Showing",ofEntities:"of",completePhotos:"Complete Photo Collection",completePhotosDesc:"Fill missing images with valid URLs",photoTargetEntities:"Entity Images",photoTargetFeatures:"Feature Images",photoTargetBoth:"Both",actionPhotos:"Complete Photos",actionPhotosDesc:"Fill all missing images with real URLs",photosActionDesc:"Select which images to complete with valid URLs",actionValidate:"Validate Taxonomy",actionValidateDesc:"Check species names, synonyms, and geographic distribution",validateOptions:"Validation Options",validateFixNames:"Correct invalid/outdated names",validateFixNamesDesc:"Update names according to Flora do Brasil 2020 or other catalogs",validateMergeSynonyms:"Merge synonyms",validateMergeSynonymsDesc:"Combine synonymous species, preserving traits from both",validateCheckGeography:"Check geographic distribution",validateCheckGeographyDesc:"Remove species outside the defined geographic scope",validateCheckTaxonomy:"Check taxonomic scope",validateCheckTaxonomyDesc:"Remove species outside the defined family/genus",validateReference:"Reference Catalog",validateFloradobrasil:"Flora do Brasil 2020",validateGbif:"GBIF Backbone",validatePowo:"POWO (Kew)",validateCustom:"Custom/Other",photoModeReplace:"Replace All",photoModeReplaceDesc:"Clear existing and find new photos",photoModeExpand:"Only Fill Missing",photoModeExpandDesc:"Keep existing, fill empty only",photoCustomSources:"Custom Sources (optional)",photoCustomSourcesPlaceholder:`Paste URLs of image databases separated by newlines
e.g., https://inaturalist.org
https://floradobrasil.jbrj.gov.br`,modeMerge:"Merge Keys",mergeTitle:"Combine Two Keys",mergeDesc:"Import two JSON keys and merge them into one optimized key.",mergeKey1:"First Key (JSON)",mergeKey2:"Second Key (JSON)",uploadKey1:"Upload Key 1 (JSON)",uploadKey2:"Upload Key 2 (JSON)",mergeStrategy:"Merge Strategy",strategyUnion:"Union (All-inclusive)",strategyUnionDesc:"Include all features and entities from both keys",strategyIntersection:"Intersection (Common)",strategyIntersectionDesc:"Focus on shared characteristics between keys",strategyPrimary:"Primary (Key 1 base)",strategyPrimaryDesc:"Use Key 1 as base, add unique elements from Key 2",remove:"Remove",mergeAction:"Merge Keys",mergeLoaded:"loaded",stateImage:"State image",addStateImage:"Add image",viewImage:"View image",closeImage:"Close"},pt:{builder:"Construtor",aiWizard:"Nozes IA",savePlay:"Salvar & Testar",exit:"Sair",save:"Salvar",open:"Abrir",export:"Exportar Projeto",exportXLSX:"Exportar XLSX",exportHTML:"Exportar HTML",import:"Importar Projeto",general:"Geral",features:"Caractersticas",entities:"Entidades",matrix:"Matriz",projectName:"Nome do Projeto",description:"Descrio",definedFeatures:"Caractersticas Definidas",definedFeaturesDesc:"Defina caractersticas e seus estados possveis.",addFeature:"Adicionar Caracterstica",featureName:"Nome",imageURL:"URL da Imagem (opcional)",states:"Estados",addState:"Adicionar Estado",manageEntities:"Entidades",manageEntitiesDesc:"Gerencie os txons includos na chave.",addEntity:"Adicionar Entidade",scoringMatrix:"Matriz de Pontuao",scoringMatrixDesc:"Clique nas clulas para associar estados",taxaFeatures:"Txons / Caractersticas",aiTitle:"Assistente Nozes IA",aiDesc:"Gere ou Extraia chaves usando Gemini IA.",topic:"Tpico / Assunto",topicPlace:"ex: Peixes de gua Doce, Ervas Daninhas",geography:"Escopo Geogrfico",taxonomyFamily:"Famlia",taxonomyGenus:"Gnero",biome:"Bioma",stateUF:"Estado/UF",scopeLabel:"Escopo",scopeGlobal:"Global",scopeNational:"Nacional (Brasil)",scopeRegional:"Regional",taxonomyFilters:"Filtros Taxonmicos",geographyFilters:"Filtros Geogrficos",numEntities:"Aprox. # de Entidades",numFeatures:"Aprox. # de Caractersticas",requiredFeatures:"Caractersticas Obrigatrias",requiredFeaturesDesc:"Selecione caractersticas que a IA deve incluir",addCustomFeature:"Adicionar caracterstica...",selectedFeatures:"selecionadas",requiredSpecies:"Lista de Espcies Obrigatrias",requiredSpeciesDesc:"Espcies que DEVEM ser includas (uma por linha)",requiredSpeciesPlaceholder:`Digite nomes de espcies, uma por linha:
Inga edulis
Inga marginata
Inga vera`,importSpeciesList:"Importar lista de espcies",importSpeciesFormats:"Suporta: .txt, .csv, .doc, .json",speciesCount:"espcies listadas",clearList:"Limpar lista",generating:"Nozes IA est pensando... (15-45s)",cancel:"Cancelar",generate:"Gerar Chave",savedMsg:"Projeto salvo no navegador!",errGen:"Falha ao gerar chave. Verifique o console.",featureFocus:"Foco das Caractersticas",focusGeneral:"Geral (Todas)",focusRepro:"Apenas Reprodutivas",focusVeg:"Apenas Vegetativas",options:"Opes",fetchSpeciesImg:"Buscar Imagens de Espcies",fetchFeatureImg:"Buscar Imagens de Caractersticas",fetchLinks:"Buscar Links/Materiais",detailLevel:"Nvel de Detalhe",detailSimple:"Simplificado",detailBalanced:"Equilibrado",detailExpert:"Especialista / Alto",detailOriginal:"Fidelidade Original",noSaved:"Nenhum projeto salvo.",close:"Fechar",modeTopic:"Gerar por Tpico",modeImport:"Importar Arquivo",uploadLabel:"Upload PDF, Imagem ou Texto",uploadDesc:"A IA estudar o documento e extrair entidades e caractersticas automaticamente.",supportedFormats:"Suporta: .pdf, .txt, .jpg, .png",dropFile:"Solte o arquivo aqui",removeFile:"Remover arquivo",analyzing:"Analisando documento...",promptCopied:"Prompt copiado para a rea de transferncia!",configSettings:"Configurao",links:"Links Adicionais / Materiais",addLink:"Adicionar Link",editTraits:"Editar Caractersticas",traitEditor:"Editor de Caractersticas",copyPrompt:"Copiar",missingKey:"Falta a Chave da API. Configure-a nas Configuraes do menu principal.",apiKeyWarning:"Configure sua Chave de API para usar a IA",clickGear:"Clique na chave acima",modeRefine:"Expandir/Refinar",refineTitle:"Aprimorar Chave Atual",refineDesc:"Use IA para expandir ou refinar sua chave de identificao existente.",actionExpand:"Expandir Entidades",actionExpandDesc:"Adicionar novas espcies/entidades similares s existentes",actionRefine:"Refinar Caractersticas",actionRefineDesc:"Melhorar descries e adicionar caractersticas discriminantes",actionClean:"Limpar & Otimizar",actionCleanDesc:"Remover caractersticas redundantes, corrigir inconsistncias",expandCount:"# Novas Entidades a Adicionar",keepExisting:"Preservar entidades existentes",addFeatures:"Adicionar novas caractersticas discriminantes",expandFilters:"Filtros Taxonmicos & Geogrficos",expandFamily:"Famlia (opcional)",expandGenus:"Gnero (opcional)",expandBiome:"Bioma (opcional)",expandStateUF:"Estado/UF (opcional)",expandScope:"Escopo Geogrfico",expandRequiredSpecies:"Espcies Obrigatrias a Adicionar",expandRequiredSpeciesDesc:"Espcies que DEVEM ser adicionadas (uma por linha)",expandRequiredSpeciesPlaceholder:`Digite espcies a adicionar:
Inga edulis
Inga marginata`,refineRequiredFeaturesTitle:"Caractersticas Obrigatrias",refineRequiredFeaturesDesc:"Caractersticas que DEVEM estar na chave",addRequiredFeature:"Adicionar caracterstica...",customFeature:"Caracterstica personalizada",improveDescriptions:"Melhorar descries",fillGaps:"Preencher dados de caractersticas faltantes",removeRedundant:"Remover caractersticas redundantes",fixInconsistencies:"Corrigir inconsistncias",featureTypeLabel:"Tipo de Caracterstica",featureTypeVegetative:"Apenas vegetativas",featureTypeReproductive:"Apenas reprodutivas",featureTypeBoth:"Ambas (vegetativas + reprodutivas)",featureTypeDesc:"Foco em caracteres vegetativos (folhas, caules, cascas) ou reprodutivos (flores, frutos, sementes)",currentProject:"Projeto Atual",noProjectLoaded:"Nenhum projeto carregado. Crie ou carregue um projeto primeiro.",entitiesCount:"entidades",featuresCount:"caractersticas",filterEntities:"Filtrar Entidades",filterByFamily:"Filtrar por famlia",filterByGenus:"Filtrar por gnero",filterByName:"Filtrar por nome",searchPlaceholder:"Buscar...",allFamilies:"Todas as famlias",allGenera:"Todos os gneros",clearFilters:"Limpar filtros",onlyWithGaps:"Apenas com lacunas",onlyWithGapsDesc:"Mostrar apenas entidades com caractersticas faltantes",showingEntities:"Exibindo",ofEntities:"de",completePhotos:"Completar Acervo Fotogrfico",completePhotosDesc:"Preencher imagens faltantes com URLs vlidas",photoTargetEntities:"Imagens de Entidades",photoTargetFeatures:"Imagens de Caractersticas",photoTargetBoth:"Ambos",actionPhotos:"Completar Fotos",actionPhotosDesc:"Preencher todas as imagens faltantes com URLs reais",photosActionDesc:"Selecione quais imagens completar com URLs vlidas",actionValidate:"Validar Taxonomia",actionValidateDesc:"Verificar nomes de espcies, sinonmias e distribuio geogrfica",validateOptions:"Opes de Validao",validateFixNames:"Corrigir nomes invlidos/desatualizados",validateFixNamesDesc:"Atualizar nomes conforme Flora do Brasil 2020 ou outros catlogos",validateMergeSynonyms:"Mesclar sinnimos",validateMergeSynonymsDesc:"Combinar espcies sinnimas, preservando caractersticas de ambas",validateCheckGeography:"Verificar distribuio geogrfica",validateCheckGeographyDesc:"Remover espcies fora do escopo geogrfico definido",validateCheckTaxonomy:"Verificar escopo taxonmico",validateCheckTaxonomyDesc:"Remover espcies fora da famlia/gnero definido",validateReference:"Catlogo de Referncia",validateFloradobrasil:"Flora do Brasil 2020",validateGbif:"GBIF Backbone",validatePowo:"POWO (Kew)",validateCustom:"Personalizado/Outro",photoModeReplace:"Substituir Todas",photoModeReplaceDesc:"Limpar existentes e buscar novas",photoModeExpand:"Apenas Preencher Faltantes",photoModeExpandDesc:"Manter existentes, preencher vazias",photoCustomSources:"Fontes Personalizadas (opcional)",photoCustomSourcesPlaceholder:`Cole URLs de bancos de imagens separados por quebras de linha
ex: https://inaturalist.org
https://floradobrasil.jbrj.gov.br`,modeMerge:"Combinar",mergeTitle:"Combinar Duas Chaves",mergeDesc:"Importe dois JSONs e combine-os em uma chave otimizada.",mergeKey1:"Primeira Chave (JSON)",mergeKey2:"Segunda Chave (JSON)",uploadKey1:"Carregar Chave 1 (JSON)",uploadKey2:"Carregar Chave 2 (JSON)",mergeStrategy:"Estratgia de Combinao",strategyUnion:"Unio (Tudo includo)",strategyUnionDesc:"Incluir todas as caractersticas e entidades de ambas as chaves",strategyIntersection:"Interseo (Comum)",strategyIntersectionDesc:"Focar nas caractersticas compartilhadas entre as chaves",strategyPrimary:"Primria (Base Chave 1)",strategyPrimaryDesc:"Usar Chave 1 como base, adicionar elementos nicos da Chave 2",remove:"Remover",mergeAction:"Combinar Chaves",mergeLoaded:"carregado",stateImage:"Imagem do estado",addStateImage:"Adicionar imagem",viewImage:"Ver imagem",closeImage:"Fechar"}},Ga=e=>e.toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," "),Sc=(e,t)=>{const n=Ga(e),r=Ga(t);if(n===r||n.includes(r)||r.includes(n))return!0;const i=n.split(" ").filter(a=>a.length>2),s=r.split(" ").filter(a=>a.length>2);if(i.length>0&&s.length>0&&i[0]===s[0]){const a=i.filter(o=>s.includes(o));if(a.length>=2||a.length===1&&Math.min(i.length,s.length)===1)return!0}return!1},lM=(e,t,n=!0)=>{if(console.log(`[mergeProjectsPreservingData] Starting merge: new=${e.entities.length} entities, existing=${t.entities.length} entities`),!e.entities||e.entities.length===0)return console.error("[mergeProjectsPreservingData] CRITICAL: AI returned EMPTY project! Preserving original."),t;if(e.entities.length<t.entities.length&&console.warn(`[mergeProjectsPreservingData] PARTIAL RESPONSE: AI returned ${e.entities.length} of ${t.entities.length} entities. Will merge available data and preserve remaining entities.`),!e.features||e.features.length===0)return console.error("[mergeProjectsPreservingData] CRITICAL: AI returned NO features! Preserving original."),t;const i=q=>q.entities.reduce((ue,ke)=>ue+Object.values(ke.traits).reduce((se,ae)=>se+ae.length,0),0),s=i(t),a=i(e);console.log(`[mergeProjectsPreservingData] Trait count - existing: ${s}, new: ${a}`);const o=new Map(t.entities.map(q=>[q.id,q])),u=new Map(t.features.map(q=>[q.id,q])),c=new Set,l=q=>q?["picsum.photos","placehold.co","placeholder.com","via.placeholder","dummyimage.com","fakeimg.pl","lorempixel.com"].some(ke=>q.includes(ke)):!0,m=q=>{if(o.has(q.id))return o.get(q.id);for(const ue of t.entities)if(Sc(q.name,ue.name))return ue},h=q=>{if(u.has(q.id))return u.get(q.id);for(const ue of t.features)if(Sc(q.name,ue.name))return ue},g=new Map;e.features.forEach(q=>{g.set(q.id,q.name)});let x={featureMatches:0,stateMatches:0,stateMisses:0,traitsFilled:0,traitsSkipped:0};const v=q=>{if(u.has(q))return q;const ue=e.features.find(se=>se.id===q);if(ue){const se=h(ue);if(se)return x.featureMatches++,se.id}const ke=g.get(q);if(ke){for(const se of t.features)if(Sc(ke,se.name))return x.featureMatches++,se.id}return null},w=(q,ue,ke)=>{const se=u.get(ue);if(!se)return null;if(se.states.find(U=>U.id===q))return x.stateMatches++,q;let ce=null;const Ce=e.features.find(U=>U.id===ke);if(Ce){const U=Ce.states.find(G=>G.id===q);U&&(ce=U.label)}if(!ce)for(const U of e.features){const G=U.states.find(V=>V.id===q);if(G){ce=G.label;break}}if(!ce&&q.includes("_")){const U=q.split("_").slice(0,-1).join("_").replace(/-/g," ");U.length>2&&(ce=U)}if(ce){const U=Ga(ce),G=se.states.find(re=>Ga(re.label)===U);if(G)return x.stateMatches++,G.id;const V=se.states.find(re=>{const H=Ga(re.label);return H.includes(U)||U.includes(H)});if(V)return x.stateMatches++,V.id}if(Ce){const U=Ce.states.findIndex(G=>G.id===q);if(U>=0&&U<se.states.length)return x.stateMatches++,se.states[U].id}const D=parseInt(q,10);return!isNaN(D)&&D>=0&&D<se.states.length?(x.stateMatches++,se.states[D].id):(x.stateMisses++,null)},E=q=>{const ue=u.get(q);return ue?new Set(ue.states.map(ke=>ke.id)):new Set},y=q=>{const ue={};for(const[ke,se]of Object.entries(q))if(u.has(ke)){const ae=E(ke),ce=se.filter(Ce=>ae.has(Ce));ce.length>0&&(ue[ke]=ce)}return ue},T=(q,ue)=>{const se={...y(ue)},ae=new Set(e.features.map(ce=>ce.id));for(const[ce,Ce]of Object.entries(q)){const D=v(ce);if(D){const U=[];for(const G of Ce){const V=w(G,D,ce);V&&U.push(V)}U.length>0&&(!se[D]||se[D].length===0?(se[D]=U,x.traitsFilled++):x.traitsSkipped++)}else ae.has(ce)&&Ce.length>0&&(se[ce]=[...Ce],x.traitsFilled++)}return se},C=e.entities.map(q=>{const ue=m(q);return ue&&c.add(ue.id),ue?{...q,id:ue.id,imageUrl:!l(ue.imageUrl)&&l(q.imageUrl)?ue.imageUrl:q.imageUrl||ue.imageUrl,links:q.links&&q.links.length>0?q.links:ue.links,description:q.description&&q.description.length>20?q.description:ue.description||q.description,scientificName:q.scientificName||ue.scientificName,family:q.family||ue.family,traits:T(q.traits,ue.traits)}:q});if(n){const q=t.entities.filter(ue=>!c.has(ue.id));q.length>0&&(console.warn("[mergeProjectsPreservingData] "),console.warn("[mergeProjectsPreservingData] PARTIAL MERGE SUMMARY:"),console.warn(`[mergeProjectsPreservingData]    Updated: ${c.size} entities with new AI data`),console.warn(`[mergeProjectsPreservingData]    Preserved: ${q.length} entities (not in AI response)`),console.warn(`[mergeProjectsPreservingData]   Total: ${c.size+q.length} entities`),console.warn("[mergeProjectsPreservingData] "),console.log("[mergeProjectsPreservingData] Preserved entities (user can re-run for these):"),q.slice(0,10).forEach(ue=>console.log(`  - "${ue.name}"`)),q.length>10&&console.log(`  ... and ${q.length-10} more`),C.push(...q))}const L=new Set,B=[],R=e.features.map(q=>{const ue=h(q);return ue&&L.add(ue.id),ue?{...ue,name:q.name||ue.name,imageUrl:!l(ue.imageUrl)&&l(q.imageUrl)?ue.imageUrl:q.imageUrl||ue.imageUrl,states:ue.states}:(B.push(q.name),q)});if(B.length>0&&(console.log(`[mergeProjectsPreservingData]  AI added ${B.length} NEW features:`),B.forEach(q=>console.log(`  + "${q}"`))),n){const q=t.features.filter(ue=>!L.has(ue.id));q.length>0&&(console.warn(`[mergeProjectsPreservingData] AI omitted ${q.length} features. Re-adding them to prevent data loss:`),q.forEach(ue=>console.warn(`  - "${ue.name}" (ID: ${ue.id})`)),R.push(...q))}console.log(`[mergeProjectsPreservingData] Final result: ${C.length} entities, ${R.length} features (${B.length} new, ${L.size} updated, ${R.length-B.length-L.size} preserved)`);const O=new Map;R.forEach(q=>{O.set(q.id,new Set(q.states.map(ue=>ue.id)))});let M={entitiesProcessed:0,invalidTraitsRemoved:0,entitiesWithIssues:0};const k=C.map(q=>{const ue={};let ke=!1;for(const[se,ae]of Object.entries(q.traits)){const ce=O.get(se);if(ce){const Ce=ae.filter(D=>ce.has(D));Ce.length>0&&(ue[se]=Ce),Ce.length!==ae.length&&(ke=!0,M.invalidTraitsRemoved+=ae.length-Ce.length)}else ke=!0,M.invalidTraitsRemoved+=ae.length}return M.entitiesProcessed++,ke&&M.entitiesWithIssues++,{...q,traits:ue}});console.log("[mergeProjectsPreservingData] "),console.log("[mergeProjectsPreservingData] MERGE COMPLETE SUMMARY:"),console.log(`[mergeProjectsPreservingData]    Entities: ${k.length} total (${c.size} matched, ${k.length-c.size} preserved/new)`),console.log(`[mergeProjectsPreservingData]    Features: ${R.length} total`),console.log(`[mergeProjectsPreservingData]    Mapping: ${x.featureMatches} features, ${x.stateMatches} states matched, ${x.stateMisses} state misses`),console.log(`[mergeProjectsPreservingData]    Traits: ${x.traitsFilled} gaps filled, ${x.traitsSkipped} skipped (already had data)`),M.invalidTraitsRemoved>0&&console.warn(`[mergeProjectsPreservingData]    Sanitization: ${M.invalidTraitsRemoved} invalid trait IDs removed from ${M.entitiesWithIssues} entities`),console.log("[mergeProjectsPreservingData] ");const z=new Set,X=k.filter(q=>z.has(q.id)?(console.warn(`[mergeProjectsPreservingData] Removing duplicate entity ID: ${q.id} (${q.name})`),!1):(z.add(q.id),!0)),ne=new Set,Fe=R.filter(q=>ne.has(q.id)?(console.warn(`[mergeProjectsPreservingData] Removing duplicate feature ID: ${q.id} (${q.name})`),!1):(ne.add(q.id),!0));return(X.length!==k.length||Fe.length!==R.length)&&console.warn(`[mergeProjectsPreservingData] Deduplication removed ${k.length-X.length} entity and ${R.length-Fe.length} feature duplicates`),{...e,id:t.id||e.id,entities:X,features:Fe}},uM=({initialProject:e,onSave:t,onCancel:n,language:r,defaultModel:i,apiKey:s,onOpenSettings:a,reopenAiModal:o,onAiModalOpened:u,onProjectImported:c})=>{var l0,u0,c0,d0,f0;const l=oM[r],m=S=>{const A=new Set,j=new Set,W=S.entities.filter(oe=>A.has(oe.id)?!1:(A.add(oe.id),!0)),ee=S.features.filter(oe=>j.has(oe.id)?!1:(j.add(oe.id),!0));return W.length!==S.entities.length||ee.length!==S.features.length?{...S,entities:W,features:ee}:S},[h,g]=Ie.useState(m(e||{id:Math.random().toString(36).substr(2,9),name:r==="pt"?"Nova Chave":"New Key",description:"",features:[],entities:[]})),x=S=>{g(A=>{const j=typeof S=="function"?S(A):S;return m(j)})},[v,w]=Ie.useState("GENERAL"),[E,y]=Ie.useState({topic:"",count:10,featureCount:5,geography:"",taxonomy:"",taxonomyFamily:"",taxonomyGenus:"",biome:"",stateUF:"",scope:"national",language:r,featureFocus:"general",includeSpeciesImages:!0,includeFeatureImages:!0,includeLinks:!0,model:i,detailLevel:2}),[T,C]=Ie.useState(!1),[L,B]=Ie.useState(""),[R,O]=Ie.useState(!1),[M,k]=Ie.useState("TOPIC"),[z,X]=Ie.useState(null),[ne,Fe]=Ie.useState(!1),[q,ue]=Ie.useState([]),[ke,se]=Ie.useState(!1),[ae,ce]=Ie.useState(!1),[Ce,D]=Ie.useState(null),[U,G]=Ie.useState("EXPAND"),[V,re]=Ie.useState(null),[H,de]=Ie.useState({expandCount:10,keepExisting:!0,addFeatures:!0,expandFamily:"",expandGenus:"",expandBiome:"",expandStateUF:"",expandScope:"national",expandRequiredSpecies:"",refineRequiredFeatures:[],featureType:"both",improveDescriptions:!0,fillGaps:!0,removeRedundant:!1,fixInconsistencies:!0,completePhotos:!1,photoTarget:"both",photoMode:"expand",photoCustomSources:"",validateFixNames:!0,validateMergeSynonyms:!0,validateCheckGeography:!0,validateCheckTaxonomy:!0,validateReference:"floradobrasil",validateFamily:"",validateGenus:"",validateBiome:"",validateStateUF:"",validateScope:"national"}),[Ee,Se]=Ie.useState(null),[Le,Ve]=Ie.useState(null),[yt,je]=Ie.useState("union"),[ze,qe]=Ie.useState({searchText:"",family:"",genus:"",scientificName:"",onlyWithGaps:!1}),[Te,It]=Ie.useState([]),[Jt,En]=Ie.useState(!1),[ct,Fn]=Ie.useState(""),[zn,nn]=Ie.useState(""),Or=$r.useRef(null),Hi=r==="pt"?[{category:"Vegetativas",items:["Tipo de folha (simples/composta)","Filotaxia (alterna/oposta/verticilada)","Margem foliar","Forma da folha","Textura da folha","Presena de estpulas","Tipo de nervao","Forma do caule","Tipo de casca","Hbito de crescimento","Presena de espinhos/acleos","Presena de ltex","Tipo de raiz","Presena de tricomas/pelos","Domcias"]},{category:"Reprodutivas",items:["Tipo de inflorescncia","Cor da flor","Nmero de ptalas","Simetria floral","Tipo de fruto","Cor do fruto","Tipo de semente","Deiscncia do fruto"]},{category:"Ecolgicas",items:["Ambiente/habitat","Altitude","Fenologia","Polinizadores","Disperso"]}]:[{category:"Vegetative",items:["Leaf type (simple/compound)","Phyllotaxy (alternate/opposite/whorled)","Leaf margin","Leaf shape","Leaf texture","Stipule presence","Venation type","Stem shape","Bark type","Growth habit","Spine/prickle presence","Latex presence","Root type","Trichome/hair presence","Domatia"]},{category:"Reproductive",items:["Inflorescence type","Flower color","Petal number","Floral symmetry","Fruit type","Fruit color","Seed type","Fruit dehiscence"]},{category:"Ecological",items:["Habitat/environment","Altitude","Phenology","Pollinators","Dispersal"]}],[ra,ft]=Ie.useState(!1),[zi,ar]=Ie.useState(""),[qi,it]=Ie.useState(""),[_o,mr]=Ie.useState(!1),rn=$r.useRef(null),Wi=$r.useRef(null),[Ji,Yi]=Ie.useState(null),[gr,ia]=Ie.useState(h.features.length>0?h.features[0].id:null),Ki=$r.useRef(null),[o0,Xi]=Ie.useState(!1),hi=S=>{const A=gr!==S;ia(j=>j===S?null:S),A&&Ki.current&&setTimeout(()=>{const j=Ki.current;if(!j)return;const W=h.features.findIndex(ye=>ye.id===S);if(W===-1)return;let ee=200;for(let ye=0;ye<W;ye++)ee+=70;const oe=j.clientWidth,Z=h.features[W].states.length*90,ve=ee-oe/2+Z/2;j.scrollTo({left:Math.max(0,ve),behavior:"smooth"})},100)},Co=S=>{const A=h.features.findIndex(W=>W.id===gr);if(A===-1)return;const j=S==="prev"?(A-1+h.features.length)%h.features.length:(A+1)%h.features.length;hi(h.features[j].id)};Ie.useEffect(()=>{y(S=>({...S,language:r}))},[r]);const Qi=$r.useMemo(()=>{const S=new Set;return h.entities.forEach(A=>{A.family&&A.family.trim()&&S.add(A.family.trim())}),Array.from(S).sort()},[h.entities]),Zi=$r.useMemo(()=>{const S=new Set;return h.entities.forEach(A=>{const W=(A.scientificName||A.name||"").split(" ")[0];W&&W.trim()&&/^[A-Z][a-z]+$/.test(W)&&S.add(W.trim())}),Array.from(S).sort()},[h.entities]),es=$r.useMemo(()=>h.entities.filter(S=>{var A,j,W;if(ze.searchText){const ee=ze.searchText.toLowerCase(),oe=(A=S.name)==null?void 0:A.toLowerCase().includes(ee),Z=(j=S.scientificName)==null?void 0:j.toLowerCase().includes(ee);if(!oe&&!Z)return!1}if(ze.family&&((W=S.family)==null?void 0:W.toLowerCase())!==ze.family.toLowerCase())return!1;if(ze.genus){const oe=(S.scientificName||S.name||"").split(" ")[0];if((oe==null?void 0:oe.toLowerCase())!==ze.genus.toLowerCase())return!1}return!(ze.onlyWithGaps&&!h.features.some(oe=>(S.traits[oe.id]||[]).length===0))}),[h.entities,h.features,ze]),No=()=>{qe({searchText:"",family:"",genus:"",scientificName:"",onlyWithGaps:!1})},ts=ze.searchText||ze.family||ze.genus||ze.onlyWithGaps;Ie.useEffect(()=>{o&&(O(!0),u==null||u())},[o,u]),Ie.useEffect(()=>{y(S=>({...S,model:i}))},[i]),Ie.useEffect(()=>{const S=Ki.current;if(!S)return;const A=()=>{Xi(S.scrollTop>0)};return S.addEventListener("scroll",A),()=>S.removeEventListener("scroll",A)},[]),Ie.useEffect(()=>{const S=localStorage.getItem("nozesia_projects");if(S)try{ue(JSON.parse(S))}catch{console.error("Failed to load local projects")}},[]),Ie.useEffect(()=>{Wi.current&&qi&&(Wi.current.scrollTop=Wi.current.scrollHeight)},[qi]);const Ao=S=>x(A=>({...A,...S})),mi=S=>S?["picsum.photos","placehold.co","placeholder.com","via.placeholder","dummyimage.com","fakeimg.pl","lorempixel.com","placekitten.com","loremflickr.com"].some(j=>S.toLowerCase().includes(j)):!0,ns=S=>({...S,entities:S.entities.map(A=>({...A,imageUrl:mi(A.imageUrl)?"":A.imageUrl})),features:S.features.map(A=>({...A,imageUrl:mi(A.imageUrl)?"":A.imageUrl}))}),Io=()=>{const A=[ns(h),...q.filter(j=>j.id!==h.id)];ue(A),localStorage.setItem("nozesia_projects",JSON.stringify(A)),alert(l.savedMsg)},Ou=S=>{x(S),se(!1)},_=()=>{const S=ns(h),A="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(S,null,2)),j=document.createElement("a");j.setAttribute("href",A),j.setAttribute("download",`${h.name.replace(/\s+/g,"_")}.json`),document.body.appendChild(j),j.click(),j.remove()},b=()=>{const S=ns(h),A=Dn.book_new(),j=S.entities.map(Pe=>{var Ue,Ge;return{ID:Pe.id,Name:Pe.name,Description:Pe.description,ImageURL:Pe.imageUrl,LinkLabels:((Ue=Pe.links)==null?void 0:Ue.map(Oe=>Oe.label).join("; "))||"",LinkURLs:((Ge=Pe.links)==null?void 0:Ge.map(Oe=>Oe.url).join("; "))||""}}),W=Dn.json_to_sheet(j);Dn.book_append_sheet(A,W,"Entities");const ee=S.features.map(Pe=>({ID:Pe.id,Name:Pe.name,ImageURL:mi(Pe.imageUrl)?"":Pe.imageUrl,States:Pe.states.map(Ue=>Ue.label).join("; ")})),oe=Dn.json_to_sheet(ee);Dn.book_append_sheet(A,oe,"Features");const Z=S.entities.map(Pe=>{const Ue={Entity:Pe.name};return S.features.forEach(Ge=>{const Oe=Pe.traits[Ge.id]||[],kt=Ge.states.filter(bt=>Oe.includes(bt.id)).map(bt=>bt.label).join(", ");Ue[Ge.name]=kt}),Ue}),ve=Dn.json_to_sheet(Z);Dn.book_append_sheet(A,ve,"Matrix");const ye=[{Name:S.name,Description:S.description,ExportDate:new Date().toISOString().split("T")[0],TotalEntities:S.entities.length,TotalFeatures:S.features.length}],De=Dn.json_to_sheet(ye);Dn.book_append_sheet(A,De,"Project Info"),Gv(A,`${S.name.replace(/\s+/g,"_")}.xlsx`)},N=()=>{const S=ns(h),A=aM(S,r),j=new Blob([A],{type:"text/html;charset=utf-8"}),W=URL.createObjectURL(j),ee=document.createElement("a");ee.href=W,ee.download=`${S.name.replace(/\s+/g,"_")}.html`,ee.click(),URL.revokeObjectURL(W)},I=S=>{const A=new FileReader;S.target.files&&S.target.files[0]&&(A.readAsText(S.target.files[0],"UTF-8"),A.onload=j=>{var W;try{const ee=JSON.parse((W=j.target)==null?void 0:W.result);if(ee.name&&ee.features&&ee.entities){x(ee);const oe=localStorage.getItem("nozesia_projects");let Z=[];if(oe)try{Z=JSON.parse(oe)}catch(ye){console.error("Failed to parse projects",ye)}const ve=[ee,...Z.filter(ye=>ye.id!==ee.id)];localStorage.setItem("nozesia_projects",JSON.stringify(ve)),c&&c(ee)}else alert("Invalid project file format.")}catch{alert("Error parsing JSON file.")}})},F=S=>{S.target.files&&S.target.files[0]&&X(S.target.files[0])},P=S=>{S.preventDefault(),S.stopPropagation(),Fe(!0)},Y=S=>{S.preventDefault(),S.stopPropagation(),Fe(!1)},ie=S=>{S.preventDefault(),S.stopPropagation(),Fe(!1);const A=S.dataTransfer.files;if(A&&A.length>0){const j=A[0],W=["application/pdf","text/plain","image/jpeg","image/png","image/jpg"],ee=[".pdf",".txt",".jpg",".jpeg",".png"],oe=j.name.toLowerCase();W.includes(j.type)||ee.some(ve=>oe.endsWith(ve))?X(j):alert(r==="pt"?"Tipo de arquivo no suportado. Use PDF, TXT, JPG ou PNG.":"Unsupported file type. Use PDF, TXT, JPG or PNG.")}},J=async S=>{if(!S.target.files||!S.target.files[0])return;const A=S.target.files[0],j=A.name.toLowerCase();try{let W="";if(j.endsWith(".txt")||j.endsWith(".csv"))W=(await A.text()).split(/[\n\r,;]+/).map(Z=>Z.trim()).filter(Z=>Z.length>0&&!Z.match(/^(species|especie|nome|name|#)/i)).join(`
`);else if(j.endsWith(".json")){const ee=await A.text(),oe=JSON.parse(ee);let Z=[];Array.isArray(oe)?Z=oe.map(ve=>typeof ve=="string"?ve:ve.name||ve.species||ve.especie||"").filter(Boolean):oe.species?Z=Array.isArray(oe.species)?oe.species:[oe.species]:oe.entities&&(Z=oe.entities.map(ve=>ve.name||"").filter(Boolean)),W=Z.join(`
`)}else if(j.endsWith(".xlsx")||j.endsWith(".xls")){alert(r==="pt"?"Para arquivos Excel, por favor salve como .csv ou .txt primeiro, ou copie e cole a lista diretamente.":"For Excel files, please save as .csv or .txt first, or copy and paste the list directly.");return}else if(j.endsWith(".doc")||j.endsWith(".docx")){alert(r==="pt"?"Para arquivos Word, por favor copie e cole a lista diretamente no campo de texto.":"For Word files, please copy and paste the list directly into the text field.");return}if(zn.trim()){const ee=zn.split(`
`).filter(ve=>ve.trim()),oe=W.split(`
`).filter(ve=>ve.trim()),Z=[...new Set([...ee,...oe])];nn(Z.join(`
`))}else nn(W);Or.current&&(Or.current.value="")}catch(W){console.error("Error importing species list:",W),alert(r==="pt"?"Erro ao importar arquivo. Verifique o formato.":"Error importing file. Check the format.")}},K=S=>new Promise((A,j)=>{const W=new FileReader;W.onload=()=>{const oe=W.result.split(",")[1];A(oe)},W.onerror=ee=>j(ee),W.readAsDataURL(S)}),Q=()=>{const S=[],A=r==="pt"?[" Analisando estrutura do documento..."," Identificando caractersticas taxonmicas..."," Processando matriz de identificao..."," Extraindo informaes das espcies..."]:[" Analyzing document structure..."," Identifying taxonomic features..."," Processing identification matrix..."," Extracting species information..."];if(S.push(...A),q.length>0){const j=r==="pt"?`
 Enquanto isso, voc sabia que...`:`
 Meanwhile, did you know that...`;S.push(j),q.forEach(Z=>{if(Z.entities&&Z.entities.length>0&&[...Z.entities].sort(()=>Math.random()-.5).slice(0,3).forEach(ye=>{if(ye.description&&ye.description.length>20){const De=r==="pt"?`
 "${ye.name}": ${ye.description}`:`
 "${ye.name}": ${ye.description}`;S.push(De)}if(ye.scientificName||ye.family){const De=r==="pt"?`
    ${ye.scientificName?`Nome cientfico: ${ye.scientificName}`:""}${ye.scientificName&&ye.family?" | ":""}${ye.family?`Famlia: ${ye.family}`:""}`:`
    ${ye.scientificName?`Scientific name: ${ye.scientificName}`:""}${ye.scientificName&&ye.family?" | ":""}${ye.family?`Family: ${ye.family}`:""}`;(ye.scientificName||ye.family)&&S.push(De)}}),Z.features&&Z.features.length>0){const ve=Z.features[Math.floor(Math.random()*Z.features.length)];if(ve.states&&ve.states.length>1){const ye=ve.states.map(Pe=>Pe.label).join(", "),De=r==="pt"?`
 A caracterstica "${ve.name}" pode ter os estados: ${ye}`:`
 The feature "${ve.name}" can have states: ${ye}`;S.push(De)}}});const W=q.reduce((Z,ve)=>{var ye;return Z+(((ye=ve.entities)==null?void 0:ye.length)||0)},0),ee=q.reduce((Z,ve)=>{var ye;return Z+(((ye=ve.features)==null?void 0:ye.length)||0)},0),oe=r==="pt"?`

 Voc j catalogou ${W} entidades e ${ee} caractersticas em ${q.length} chave(s)!`:`

 You have cataloged ${W} entities and ${ee} features across ${q.length} key(s)!`;S.push(oe)}return S},fe=()=>{it(""),mr(!1);const A=Q().join(`
`);let j=0;rn.current&&clearInterval(rn.current),rn.current=setInterval(()=>{if(j<A.length){const W=Math.min(3,A.length-j);it(ee=>ee+A.substring(j,j+W)),j+=W}},30)},me=S=>{var A,j,W,ee,oe;if(rn.current&&(clearInterval(rn.current),rn.current=null),S){const Z=((A=S.entities)==null?void 0:A.length)||0,ve=((j=S.features)==null?void 0:j.length)||0,ye=((W=S.features)==null?void 0:W.reduce((Oe,kt)=>{var bt;return Oe+(((bt=kt.states)==null?void 0:bt.length)||0)},0))||0,De=((ee=S.entities)==null?void 0:ee.filter(Oe=>Oe.imageUrl&&!Oe.imageUrl.includes("picsum.photos")&&!Oe.imageUrl.includes("placehold.co")).length)||0,Pe=((oe=S.entities)==null?void 0:oe.filter(Oe=>Oe.links&&Oe.links.length>0).length)||0,Ue=r==="pt"?`

 ATENO: REVISO NECESSRIA!

Os dados gerados por IA podem conter:
 Erros taxonmicos ou nomenclaturais
 Caractersticas incorretas ou incompletas
 Associaes espcie-caracterstica imprecisas
 Fotos que no correspondem  espcie

 REVISE E CORRIJA todos os dados antes
   de utilizar esta chave para identificao.`:`

 WARNING: REVIEW REQUIRED!

AI-generated data may contain:
 Taxonomic or nomenclatural errors
 Incorrect or incomplete features
 Inaccurate species-trait associations
 Photos that don't match the species

 REVIEW AND CORRECT all data before
   using this key for identification.`,Ge=r==="pt"?`


 ANLISE CONCLUDA!


 Resumo da Gerao:

    Entidades: ${Z}
    Caractersticas: ${ve}
    Estados totais: ${ye}
    Com fotos: ${De}/${Z}
    Com links: ${Pe}/${Z}${Ue}`:`


 ANALYSIS COMPLETE!


 Generation Summary:

    Entities: ${Z}
    Features: ${ve}
    Total states: ${ye}
    With photos: ${De}/${Z}
    With links: ${Pe}/${Z}${Ue}`;it(Oe=>Oe+Ge)}mr(!0)},Ne=()=>{rn.current&&(clearInterval(rn.current),rn.current=null),C(!1),B(""),it(""),mr(!1),O(!1)},he=async()=>{if(!s){alert(l.missingKey);return}C(!0),B(l.generating),O(!1),ft(!0),fe();try{const S=zn.split(`
`).map(W=>W.trim()).filter(W=>W.length>0);let A={...E,requiredFeatures:Te,requiredSpecies:S};if(M==="IMPORT"&&z){const W=await K(z);A.importedFile={data:W,mimeType:z.type},A.topic=`Imported: ${z.name}`}else if(M==="TOPIC"){if(!A.topic.trim())return;A.importedFile=void 0}const j=await nM(A,s,W=>{ar(W)},(W,ee,oe)=>{const Z=E.language==="pt"?` Buscando imagens: ${W}/${ee} - ${oe}`:` Fetching images: ${W}/${ee} - ${oe}`;B(Z),it(ve=>{const ye=`
 ${oe}...`;return ve.includes(ye)?ve:ve+ye})});me(j),await new Promise(W=>setTimeout(W,2500)),x(j),ft(!1),w("MATRIX")}catch(S){console.error(S),me(),it(A=>A+(r==="pt"?`

 ERRO: No foi possvel gerar a chave.`:`

 ERROR: Could not generate the key.`)),await new Promise(A=>setTimeout(A,2e3)),alert(l.errGen),ft(!1)}finally{C(!1),B("")}},we=()=>{var W,ee,oe;const S=h.features.map(Z=>({id:Z.id,name:Z.name,states:Z.states.map(ve=>({id:ve.id,label:ve.label}))})),A=h.entities.map(Z=>({id:Z.id,name:Z.name,scientificName:Z.scientificName||"",family:Z.family||"",description:Z.description||"",traitsMap:JSON.stringify(Z.traits)}));let j="";if(U==="PHOTOS"){re(null);const Z=H.photoTarget==="entities"||H.photoTarget==="both",ve=H.photoTarget==="features"||H.photoTarget==="both",ye=H.photoMode==="replace",De=(W=H.photoCustomSources)==null?void 0:W.trim();let Pe={name:h.name};Z&&(Pe.entities=h.entities.map(Oe=>({name:Oe.name,searchName:fo(Oe.scientificName||Oe.name),currentUrl:ye?"":Oe.imageUrl||""})).filter(Oe=>ye||!Oe.currentUrl)),ve&&(Pe.features=h.features.map(Oe=>({name:Oe.name,currentUrl:ye?"":Oe.imageUrl||""})).filter(Oe=>ye||!Oe.currentUrl));const Ue=JSON.stringify(Pe,null,2);let Ge="";De?Ge=`
USER-PREFERRED SOURCES (check these FIRST, in order):
${De.split(`
`).filter(kt=>kt.trim()).map((kt,bt)=>`${bt+1}. ${kt.trim()}`).join(`
`)}

If user sources don't have the image, then check these scientific databases:`:Ge=`
SCIENTIFIC IMAGE SOURCES (check in this order):`,j=`
# PHOTO COLLECTION TASK

You are an expert at finding HIGH-QUALITY, VALID image URLs from scientific databases.

## PROJECT: "${h.name}"
${h.description?`Description: ${h.description}`:""}

## ITEMS NEEDING PHOTOS:
${Ue}

## YOUR TASK:
Find ONE valid, high-quality image URL for each item listed above.
${ye?"REPLACE ALL URLs - ignore any existing URLs and find new ones.":"ONLY FILL EMPTY URLs - skip items that already have a URL."}

## HOW TO FIND GOOD PHOTOS:

 CRITICAL: For image searches, ALWAYS use the "searchName" field (genus + epithet only).
NEVER use author names in image searches (e.g., search "Andira fraxinifolia", NOT "Andira fraxinifolia Benth.").

${Ge}
1. **iNaturalist** - Search: https://www.inaturalist.org/taxa/search?q=[searchName]
   - Navigate to species page  Photos tab  Right-click image  Copy Image Address
   - Valid format: https://inaturalist-open-data.s3.amazonaws.com/photos/[id]/medium.jpg

2. **GBIF** - Search: https://www.gbif.org/species/search?q=[species_name]
   - Go to species page  Gallery  Click image  Copy direct URL
   
3. **Flickr Commons** - Scientific/botanical photos with open licenses
   - Valid format: https://live.staticflickr.com/[path].jpg

4. **Biodiversity Heritage Library** - For historical botanical illustrations
   - Valid format: https://www.biodiversitylibrary.org/pagethumb/[id]

5. **Wikimedia Commons** - ONLY use if you know the EXACT filename exists
   - Valid format: https://upload.wikimedia.org/wikipedia/commons/thumb/X/XX/Exact_Filename.jpg/400px-Exact_Filename.jpg

${r==="pt"?`
6. **Flora e Funga do Brasil** - Para espcies brasileiras
   - https://floradobrasil.jbrj.gov.br

7. **Species Link** - Rede de herbrios brasileiros
   - http://www.splink.org.br
`:""}

## CRITICAL RULES:
1.  URL MUST be a DIRECT image link ending in .jpg, .jpeg, .png, .gif, or .webp
2.  URL MUST work when opened directly in a browser (no login required)
3.  DO NOT use Google Images, Pinterest, or any search result pages
4.  DO NOT guess or make up URLs - only use URLs you are confident exist
5.  DO NOT use Wikimedia URLs unless you know the exact filename
6.  NEVER use placeholder, mockup, picsum, placehold.co, or any fake/generated images

## IF NO REAL PHOTO FOUND:
Leave the imageUrl as empty string "" - DO NOT use any placeholder or fake URLs.
It's better to have no image than a fake/mockup image.

## OUTPUT FORMAT:
Return a JSON array with the results:
\`\`\`json
{
  ${Z?`"entities": [
    { "name": "Species Name", "imageUrl": "https://direct-image-url.jpg" }
  ]${ve?",":""}`:""}
  ${ve?`"features": [
    { "name": "Feature Name", "imageUrl": "https://direct-image-url.jpg" }
  ]`:""}
}
\`\`\`

Language: ${r==="pt"?"Portuguese":"English"}
Total items to process: ${(Z&&((ee=Pe.entities)==null?void 0:ee.length)||0)+(ve&&((oe=Pe.features)==null?void 0:oe.length)||0)}
`}else if(U==="EXPAND"){const Z=[];H.expandFamily&&Z.push(`FAMILY RESTRICTION: Only add species from family "${H.expandFamily}"`),H.expandGenus&&Z.push(`GENUS RESTRICTION: Only add species from genus "${H.expandGenus}"`),H.expandBiome&&Z.push(`BIOME RESTRICTION: Only add species that occur in "${H.expandBiome}" biome`),H.expandStateUF&&Z.push(`STATE/UF RESTRICTION: Only add species that occur in "${H.expandStateUF}" state, Brazil`),H.expandScope==="national"?Z.push("GEOGRAPHIC SCOPE: Only add species native to or occurring in Brazil"):H.expandScope==="regional"&&(H.expandBiome||H.expandStateUF)&&Z.push("GEOGRAPHIC SCOPE: Strictly regional - species must occur in the specified biome/state");const ve=Z.length>0?`
TAXONOMIC & GEOGRAPHIC FILTERS (MANDATORY):
${Z.map((Ue,Ge)=>`${Ge+1}. ${Ue}`).join(`
`)}
`:"",ye=H.keepExisting,De=H.expandRequiredSpecies.split(`
`).map(Ue=>Ue.trim()).filter(Ue=>Ue.length>0),Pe=De.length>0?`
MANDATORY SPECIES TO ADD: ${De.join(", ")}`:"";re("expand"),j=`
EXPAND IDENTIFICATION KEY

FEATURES (use these IDs):
${JSON.stringify(S,null,2)}

EXISTING ENTITIES (${h.entities.length} - ${ye?"PRESERVE ALL":"may replace"}):
${JSON.stringify(A,null,2)}

TASK: Add ${H.expandCount} NEW entities.${Pe}
${ve}
RULES:
1. ${ye?"PRESERVE all existing entities with their IDs":"Replace existing entities"}
2. For NEW entities, generate new unique IDs
3. Return traitsMap as JSON string: {"featureId": ["stateId1", "stateId2"]}
4. Use ONLY existing feature and state IDs from the FEATURES list above
5. Language: ${r==="pt"?"Portuguese":"English"}

OUTPUT: Return JSON with "entities" array. Each entity needs: id, name, scientificName, family, description, traitsMap
`}else if(U==="REFINE"){const Z=H.refineRequiredFeatures.length>0?`
REQUIRED FEATURES (MANDATORY - must be added if not present):
${H.refineRequiredFeatures.map((Ue,Ge)=>`${Ge+1}. "${Ue}"`).join(`
`)}

For each required feature above:
- If it already exists in the key, ensure it has appropriate states and all entities are assigned.
- If it does NOT exist, ADD it as a new feature with relevant states and assign all entities accordingly.
`:"",ve=H.fillGaps&&!H.improveDescriptions&&!H.addFeatures&&H.refineRequiredFeatures.length===0,ye=Ue=>new Set(Ue.states.map(Ge=>Ge.id)),Pe={...h,entities:h.entities.map(Ue=>{const Ge={};for(const[Oe,kt]of Object.entries(Ue.traits)){const bt=h.features.find(aa=>aa.id===Oe);if(bt){const aa=ye(bt),Uu=kt.filter(oa=>aa.has(oa));Uu.length>0&&(Ge[Oe]=Uu)}}return{...Ue,traits:Ge}})};if(ve){const Ue=[];Pe.entities.forEach(Ge=>{const Oe=[];Pe.features.forEach(kt=>{const bt=Ge.traits[kt.id]||[],aa=kt.states.map(oa=>oa.id);bt.length>0&&bt.some(oa=>aa.includes(oa))||Oe.push(kt.id)}),Oe.length>0&&Ue.push({id:Ge.id,name:Ge.name,missingFeatureIds:Oe})}),Ue.length===0?(re(null),j=`No missing trait data found. All ${Pe.entities.length} entities have assignments for all ${Pe.features.length} features.`):(re("fillGaps"),j=`
FILL MISSING TRAITS

FEATURES (use these IDs for traits):
${JSON.stringify(S,null,2)}

ENTITIES NEEDING DATA (${Ue.length} of ${Pe.entities.length}):
${Ue.map(Ge=>`- ${Ge.id}: "${Ge.name}" needs: ${Ge.missingFeatureIds.map(Oe=>{const kt=Pe.features.find(bt=>bt.id===Oe);return kt?kt.name:Oe}).join(", ")}`).join(`
`)}

TASK: For each entity above, determine the correct trait values for the missing features.

OUTPUT FORMAT (use fillGapsSchema):
Return "filledEntities" array with:
- entityId: the entity ID from above
- filledTraits: JSON string like {"featureId": ["stateId"]} - ONLY the new traits being added

RULES:
1. Use ONLY the state IDs from FEATURES list above
2. Return ONLY entities that have gaps (those listed above)
3. Do NOT include existing traits - only NEW ones
4. Language: ${r==="pt"?"Portuguese":"English"}
`)}else{re("refine");const Ue=H.featureType==="vegetative"?`
FEATURE TYPE RESTRICTION: Focus ONLY on VEGETATIVE characters (leaves, stems, bark, branching, stipules, etc.). Do NOT add reproductive characters (flowers, fruits, seeds).`:H.featureType==="reproductive"?`
FEATURE TYPE RESTRICTION: Focus ONLY on REPRODUCTIVE characters (flowers, inflorescences, fruits, seeds, pods, etc.). Do NOT add vegetative characters.`:"";j=`
REFINE IDENTIFICATION KEY

FEATURES (use these IDs):
${JSON.stringify(S,null,2)}

ENTITIES (${h.entities.length} - PRESERVE ALL):
${JSON.stringify(A,null,2)}

TASK: Improve this key.
${Z}${Ue}
IMPROVEMENTS:
${H.improveDescriptions?"- Improve descriptions":""}
${H.fillGaps?"- Fill missing traits":""}
${H.addFeatures?"- Add 2-4 new features (assign traits to ALL entities)":""}

RULES:
1. PRESERVE all ${h.entities.length} entity IDs
2. Return traitsMap as JSON string: {"featureId": ["stateId1"]}
3. Use existing feature/state IDs
4. Language: ${r==="pt"?"Portuguese":"English"}

OUTPUT: Return JSON with "entities" array. Each needs: id, name, scientificName, family, description, traitsMap
`}}else re("clean"),j=`
CLEAN IDENTIFICATION KEY

FEATURES:
${JSON.stringify(S,null,2)}

ENTITIES (${h.entities.length}):
${JSON.stringify(A.map(Z=>({id:Z.id,name:Z.name})),null,2)}

TASK: Optimize this key.
${H.removeRedundant?"- Remove redundant features (all entities have same state)":""}
${H.fixInconsistencies?"- Fix trait inconsistencies":""}

RULES:
1. PRESERVE all ${h.entities.length} entity IDs
2. Return traitsMap as JSON string
3. Language: ${r==="pt"?"Portuguese":"English"}

OUTPUT: Return JSON with "entities" array with: id, name, traitsMap
`;return j},Me=()=>{if(!Ee||!Le)return"";const S=JSON.stringify({name:Ee.name,description:Ee.description,features:Ee.features.map(W=>({name:W.name,states:W.states.map(ee=>ee.label)})),entities:Ee.entities.map(W=>({name:W.name,description:W.description,traits:Object.entries(W.traits).map(([ee,oe])=>{const Z=Ee.features.find(ve=>ve.id===ee);return oe.map(ve=>{const ye=Z==null?void 0:Z.states.find(De=>De.id===ve);return{featureName:(Z==null?void 0:Z.name)||"",stateValue:(ye==null?void 0:ye.label)||""}})}).flat()}))},null,2),A=JSON.stringify({name:Le.name,description:Le.description,features:Le.features.map(W=>({name:W.name,states:W.states.map(ee=>ee.label)})),entities:Le.entities.map(W=>({name:W.name,description:W.description,traits:Object.entries(W.traits).map(([ee,oe])=>{const Z=Le.features.find(ve=>ve.id===ee);return oe.map(ve=>{const ye=Z==null?void 0:Z.states.find(De=>De.id===ve);return{featureName:(Z==null?void 0:Z.name)||"",stateValue:(ye==null?void 0:ye.label)||""}})}).flat()}))},null,2);let j="";return yt==="union"?j=`
MERGE STRATEGY: UNION (All-inclusive)
- Include ALL features from BOTH keys
- Include ALL entities from BOTH keys
- Merge similar features where possible, keeping all unique states
- For duplicate entities, combine traits from both sources`:yt==="intersection"?j=`
MERGE STRATEGY: INTERSECTION (Common elements)
- Keep only features that are present in BOTH keys (or semantically equivalent)
- Include ALL entities from both keys, but focus on shared characteristics
- Prioritize traits that appear in both keys for duplicate entities`:j=`
MERGE STRATEGY: PRIMARY (Key 1 priority)
- Use KEY 1 as the primary structure base
- Add entities from KEY 2 that don't exist in KEY 1
- For duplicate entities, prefer KEY 1's trait assignments
- Add features from KEY 2 only if they add discrimination value`,`
You are an expert taxonomist specializing in identification key design and optimization.

TASK: Merge two identification keys into ONE comprehensive, optimized key.

KEY 1 (${Ee.entities.length} entities, ${Ee.features.length} features):
${S}

KEY 2 (${Le.entities.length} entities, ${Le.features.length} features):
${A}

${j}

CRITICAL REQUIREMENTS:
1. PRESERVE ALL ENTITIES from BOTH keys. The merged key must include every single species/entity.
2. Create a unified feature set that can describe ALL entities
3. Assign appropriate traits to every entity for every feature in the merged key
4. Merge semantically similar features (e.g., "Leaf Shape" and "Leaf Form")
5. Maintain language: ${r==="pt"?"Portuguese":"English"}

PROCESS:
1. First, identify all unique entities from both keys
2. Analyze features from both keys for similarities
3. Create unified feature set based on merge strategy
4. Map all entities to the new feature set
5. Ensure every entity has trait assignments for every feature

OUTPUT: Return a single merged JSON identification key with:
- Combined name and description
- Unified feature set
- ALL entities from both keys with complete trait mappings
`},nt=S=>{const A=document.createElement("input");A.type="file",A.accept=".json",A.onchange=async j=>{var ee;const W=(ee=j.target.files)==null?void 0:ee[0];if(W)try{const oe=await W.text(),Z=JSON.parse(oe);if(!Z.features||!Z.entities){alert(r==="pt"?"JSON invlido. Deve conter features e entities.":"Invalid JSON. Must contain features and entities.");return}S===1?Se(Z):Ve(Z)}catch{alert(r==="pt"?"Erro ao ler arquivo JSON.":"Error reading JSON file.")}},A.click()},st=async()=>{if(!s){alert(l.missingKey);return}if(!Ee||!Le){alert(r==="pt"?"Carregue ambas as chaves JSON primeiro.":"Load both JSON keys first.");return}try{const S=Me();ar(S),O(!1),ft(!0)}catch(S){console.error(S),alert(r==="pt"?"Erro ao gerar prompt.":"Error generating prompt.")}},Rt=async()=>{if(U!=="PHOTOS"&&!s){alert(l.missingKey);return}if(h.entities.length===0){alert(r==="pt"?"Carregue um projeto primeiro.":"Load a project first.");return}if(U==="VALIDATE"&&!H.validateFixNames&&!H.validateMergeSynonyms&&!H.validateCheckGeography&&!H.validateCheckTaxonomy){alert(r==="pt"?"Selecione pelo menos uma opo de validao.":"Select at least one validation option.");return}C(!0),B(""),O(!1),ft(!0),it(""),mr(!1);try{if(U==="PHOTOS"){const A=H.photoTarget==="entities"||H.photoTarget==="both",j=H.photoTarget==="features"||H.photoTarget==="both",W=H.photoMode==="replace";let ee={...h};if(it(r==="pt"?` Iniciando busca de imagens...

 Fontes: Biodiversity4All, iNaturalist, Wikipedia, Wikimedia Commons, PlantNet, POWO (Kew)

`:` Starting image search...

 Sources: Biodiversity4All, iNaturalist, Wikipedia, Wikimedia Commons, PlantNet, POWO (Kew)

`),A){const De=h.entities.filter(Pe=>W||!Pe.imageUrl||Pe.imageUrl.includes("picsum.photos")||Pe.imageUrl.includes("placehold.co")).map(Pe=>({name:Pe.name,scientificName:Pe.name}));if(De.length>0){const Pe=await Md(De,r,(Ue,Ge,Oe)=>{const kt=r==="pt"?` Buscando imagens: ${Ue}/${Ge} - ${Oe}`:` Fetching images: ${Ue}/${Ge} - ${Oe}`;B(kt),it(bt=>bt+` ${Oe}...
`)});ee.entities=h.entities.map(Ue=>{const Ge=Pe.get(Ue.name);return Ge?{...Ue,imageUrl:Ge}:Ue})}}if(j){const De=r==="pt"?`
 Imagens de caractersticas no suportadas via API automtica
`:`
 Feature images not supported via automatic API
`;it(Pe=>Pe+De),await new Promise(Pe=>setTimeout(Pe,1500))}const Z=A?ee.entities.filter(De=>De.imageUrl&&!De.imageUrl.includes("picsum.photos")).length:0,ve=A?h.entities.length:0,ye=r==="pt"?`

 BUSCA CONCLUDA!


 Resultado:
    Imagens encontradas: ${Z}/${ve}

 Fotos atualizadas com sucesso!`:`

 SEARCH COMPLETE!


 Result:
    Images found: ${Z}/${ve}

 Photos updated successfully!`;it(De=>De+ye),mr(!0),await new Promise(De=>setTimeout(De,2e3)),x(ee),ft(!1),w("ENTITIES");return}if(U==="VALIDATE"){fe();const A=h.entities.map((Z,ve)=>`${ve+1}. "${Z.name}"${Z.scientificName?` [Scientific: ${Z.scientificName}]`:""} (ID: ${Z.id})`).join(`
`),j=H.validateReference==="floradobrasil"?"Flora do Brasil 2020 (https://floradobrasil.jbrj.gov.br)":H.validateReference==="gbif"?"GBIF Backbone Taxonomy":H.validateReference==="powo"?"Plants of the World Online (POWO - Kew)":"current taxonomic literature",W=[],ee=[];if(H.validateFixNames&&W.push(`RULE 1 - NAME VALIDATION:
   - Check each scientific name against ${j}
   - If the name is a SYNONYM  replace with the ACCEPTED name
   - If the name is MISSPELLED  correct the spelling
   - If the name DOES NOT EXIST in any taxonomic database  REMOVE the entity entirely
   - Update the "scientificName" field with the correct binomial (Genus species Author)`),H.validateMergeSynonyms&&W.push(`RULE 2 - SYNONYM MERGING:
   - If TWO OR MORE entities in the list are synonyms of each other  KEEP ONLY ONE (the accepted name)
   - Merge their trait data: combine all trait values from both entities
   - Merge their descriptions: combine relevant information
   - Keep the best available imageUrl`),H.validateCheckTaxonomy&&(H.validateGenus&&(ee.push(`GENUS FILTER: The species MUST belong to genus "${H.validateGenus}"`),W.push(`RULE 3 - GENUS RESTRICTION (STRICT):
   - ONLY species of genus "${H.validateGenus}" are allowed
   - The first word of the scientific name MUST be exactly "${H.validateGenus}"
   - ANY species from a different genus MUST BE REMOVED - NO EXCEPTIONS
   - Example: If genus is "Andira", then "Bowdichia virgilioides" must be REMOVED because "Bowdichia"  "Andira"`)),H.validateFamily&&(ee.push(`FAMILY FILTER: The species MUST belong to family "${H.validateFamily}"`),W.push(`RULE 3B - FAMILY RESTRICTION (STRICT):
   - ONLY species of family "${H.validateFamily}" are allowed
   - Check the taxonomic classification of each species
   - ANY species from a different family MUST BE REMOVED - NO EXCEPTIONS`))),H.validateCheckGeography&&H.validateScope!=="global"){const Z=[];H.validateScope==="national"&&Z.push("Brazil (native or naturalized species only)"),H.validateBiome&&Z.push(`Biome: ${H.validateBiome}`),H.validateStateUF&&Z.push(`State: ${H.validateStateUF}, Brazil`);const ve=Z.join(", ");ee.push(`GEOGRAPHIC FILTER: The species MUST occur in ${ve}`),W.push(`RULE 4 - GEOGRAPHIC RESTRICTION (STRICT):
   - ONLY species that NATURALLY OCCUR in ${ve} are allowed
   - Check the species distribution according to ${j}
   - Species that DO NOT OCCUR in this geographic area MUST BE REMOVED
   - Be strict: if uncertain about distribution, REMOVE the species`)}const oe=`You are a strict taxonomic validation expert. Your task is to validate a species list and REMOVE any species that do not meet ALL criteria.


SPECIES LIST TO VALIDATE (${h.entities.length} total):

${A}


MANDATORY REMOVAL CRITERIA - Species MUST be REMOVED if they fail ANY:

${ee.length>0?ee.map((Z,ve)=>`${ve+1}. ${Z}`).join(`
`):"None specified"}


VALIDATION RULES (apply in order):

${W.join(`

`)}


REFERENCE: ${j}


CRITICAL INSTRUCTIONS:
1. BE STRICT - When in doubt, REMOVE the species
2. ${H.validateGenus?`GENUS CHECK: Every species MUST have "${H.validateGenus}" as the first word of its scientific name. Remove ALL others.`:""}
3. ${H.validateFamily?`FAMILY CHECK: Every species MUST belong to family "${H.validateFamily}". Remove ALL others.`:""}
4. DO NOT include species that fail ANY of the removal criteria
5. Preserve ALL existing data for species that pass validation (traits, description, links, imageUrl)
6. Return ONLY the entities that PASS ALL validation criteria

OUTPUT FORMAT:
Return a valid JSON object with this exact structure:
{
  "id": "${h.id}",
  "name": "${h.name}",
  "description": "${h.description}",
  "features": <COPY EXACTLY FROM INPUT>,
  "entities": <ONLY VALIDATED ENTITIES>
}

EXISTING PROJECT DATA:
${JSON.stringify(h,null,2)}

IMPORTANT: Return RAW JSON only. No markdown code fences. No explanations outside the JSON.`;ar(oe),O(!1),ft(!0),C(!1);return}const S=we();ar(S),O(!1),ft(!0),C(!1);return}catch(S){console.error(S),me(),it(A=>A+(r==="pt"?`

 ERRO: No foi possvel refinar a chave.`:`

 ERROR: Could not refine the key.`)),await new Promise(A=>setTimeout(A,2e3)),alert(l.errGen),ft(!1)}finally{C(!1),B("")}},gi=async()=>{try{if(M==="REFINE"){if(h.entities.length===0){alert(r==="pt"?"Carregue um projeto primeiro.":"Load a project first.");return}const ee=we();ar(ee),ft(!0),O(!1);return}let S={...E};if(M==="IMPORT"&&z){const ee=await K(z);S.importedFile={data:ee,mimeType:z.type},S.topic=`Imported: ${z.name}`}else if(M==="TOPIC"){if(!S.topic.trim()){alert("Please enter a topic first.");return}S.importedFile=void 0}const{systemInstruction:A,prompt:j}=Sy(S),W=`SYSTEM:
${A}

USER PROMPT:
${j}`;ar(W),ft(!0),O(!1)}catch(S){console.error("Failed to build prompt",S)}},xi=async()=>{if(!s){alert(l.missingKey);return}C(!0),ft(!0),fe();try{let S;if(V&&h.entities.length>0){if(S=await iM(zi,h,s,E.model,r,V),V==="expand"){const j=new Set(h.entities.map(ee=>ee.name.toLowerCase())),W=S.entities.filter(ee=>!j.has(ee.name.toLowerCase()));if(W.length>0){const ee=r==="pt"?`

 Detectadas ${W.length} novas entidades. Buscando imagens automaticamente...`:`

 Detected ${W.length} new entities. Automatically fetching images...`;it(Z=>Z+ee);const oe=W.map(Z=>({name:Z.name,scientificName:Z.name}));try{const Z=await Md(oe,r,(De,Pe,Ue)=>{it(Ge=>Ge+`
 ${Ue}...`)});S.entities=S.entities.map(De=>{if(!j.has(De.name.toLowerCase())){const Pe=Z.get(De.name);if(Pe)return{...De,imageUrl:Pe}}return De});const ve=Array.from(Z.values()).filter(De=>De).length,ye=r==="pt"?`
 Imagens encontradas: ${ve}/${W.length}`:`
 Images found: ${ve}/${W.length}`;it(De=>De+ye)}catch(Z){console.error("Error auto-fetching images:",Z),it(ve=>ve+(r==="pt"?`
 Erro na busca de imagens.`:`
 Error fetching images.`))}}}const A=r==="pt"?`

 Operao concluda! ${S.entities.length} entidades processadas.`:`

 Operation complete! ${S.entities.length} entities processed.`;it(j=>j+A),re(null)}else{const A=await rM(zi,s,E.model,r);if(!(A&&A.entities&&A.entities.length>0&&A.features&&A.features.length>0)){console.error("[handleSendManualPrompt] AI returned invalid/empty response:",A),me();const W=r==="pt"?`

 ERRO: A IA retornou uma resposta vazia ou invlida. Os dados originais foram preservados. Tente novamente.`:`

 ERROR: AI returned empty or invalid response. Original data preserved. Please try again.`;it(ee=>ee+W),await new Promise(ee=>setTimeout(ee,3e3)),ft(!1);return}if(h.entities.length>0){const W=h.entities.reduce((oe,Z)=>oe+Object.values(Z.traits).reduce((ve,ye)=>ve+ye.length,0),0),ee=A.entities.reduce((oe,Z)=>oe+Object.values(Z.traits).reduce((ve,ye)=>ve+ye.length,0),0);if(W>10&&ee<W*.3){console.warn(`[handleSendManualPrompt] WARNING: Significant trait loss detected! Existing: ${W}, New: ${ee}`);const oe=r==="pt"?`

 AVISO: Detectada possvel perda de dados (${W}  ${ee} traits). Preservando dados originais.`:`

 WARNING: Possible data loss detected (${W}  ${ee} traits). Preserving original data.`;it(Z=>Z+oe)}}if(S=h.entities.length>0?lM(A,h):A,S===h){const W=r==="pt"?`

 Dados originais foram preservados devido a resposta incompleta da IA.`:`

 Original data was preserved due to incomplete AI response.`;it(ee=>ee+W)}}me(S),await new Promise(A=>setTimeout(A,2e3)),x(S),w("MATRIX"),ft(!1)}catch(S){console.error(S),me(),re(null);const A=(S==null?void 0:S.message)||String(S);let j;A.includes("503")||A.includes("overloaded")||A.includes("UNAVAILABLE")?j=r==="pt"?`

 ERRO: O servio de IA est sobrecarregado no momento. Por favor, aguarde alguns minutos e tente novamente.`:`

 ERROR: AI service is currently overloaded. Please wait a few minutes and try again.`:A.includes("429")||A.includes("quota")||A.includes("rate")?j=r==="pt"?`

 ERRO: Limite de requisies atingido. Por favor, aguarde um momento e tente novamente.`:`

 ERROR: Rate limit reached. Please wait a moment and try again.`:A.includes("401")||A.includes("API key")||A.includes("authentication")?j=r==="pt"?`

 ERRO: Chave de API invlida ou expirada. Por favor, verifique sua chave nas configuraes.`:`

 ERROR: Invalid or expired API key. Please check your key in settings.`:A.includes("network")||A.includes("fetch")||A.includes("connection")?j=r==="pt"?`

 ERRO: Falha na conexo. Verifique sua internet e tente novamente.`:`

 ERROR: Connection failed. Check your internet and try again.`:j=r==="pt"?`

 ERRO: No foi possvel gerar a chave. Por favor, tente novamente.`:`

 ERROR: Could not generate the key. Please try again.`,it(W=>W+j),await new Promise(W=>setTimeout(W,3e3))}finally{C(!1)}},Ur=()=>{rn.current&&(clearInterval(rn.current),rn.current=null),C(!1),B(""),it(""),mr(!1),ft(!1),O(!0)},xr=()=>{const S={id:Math.random().toString(36).substr(2,9),name:r==="pt"?"Nova Caracterstica":"New Feature",imageUrl:"",states:[{id:Math.random().toString(36).substr(2,9),label:r==="pt"?"Estado 1":"State 1"}]};x(A=>({...A,features:[S,...A.features]}))},sa=()=>{const S={id:Math.random().toString(36).substr(2,9),name:r==="pt"?"Nova Entidade":"New Entity",description:"...",links:[],traits:{}};x(A=>({...A,entities:[S,...A.entities]}))},Pn=(S,A,j)=>{x(W=>{const ee=W.entities.map(oe=>{if(oe.id!==S)return oe;const Z=oe.traits[A]||[],ve=Z.includes(j);let ye;return ve?ye=Z.filter(De=>De!==j):ye=[...Z,j],{...oe,traits:{...oe.traits,[A]:ye}}});return{...W,entities:ee}})},Cy=S=>S===1?l.detailSimple:S===3?l.detailExpert:M==="IMPORT"?l.detailOriginal:l.detailBalanced;return f.jsxs("div",{className:"flex flex-col h-full bg-white font-sans absolute inset-0",children:[f.jsxs("div",{className:"border-b px-4 py-3 flex justify-between items-center bg-slate-900 text-white shadow-md z-30 shrink-0",children:[f.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[f.jsx("button",{onClick:()=>ce(!ae),className:"md:hidden text-slate-300 hover:text-white",children:f.jsx(vT,{size:24})}),f.jsxs("h2",{className:"text-base md:text-xl font-bold flex items-center gap-2 truncate",children:[f.jsx("span",{className:"bg-emerald-500 text-[10px] md:text-xs text-white px-2 py-1 rounded uppercase tracking-wider shadow-sm hidden sm:inline-block",children:l.builder}),f.jsx("span",{className:"truncate max-w-[150px] md:max-w-[300px]",children:h.name})]}),f.jsx("div",{className:"h-6 w-px bg-slate-700 mx-2 hidden md:block"}),f.jsxs("div",{className:"hidden md:flex items-center gap-1 text-sm",children:[f.jsxs("button",{onClick:Io,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:l.save,children:[f.jsx(jl,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.save})]}),f.jsxs("button",{onClick:()=>se(!0),className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:l.open,children:[f.jsx(bs,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.open})]}),f.jsxs("button",{onClick:_,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:l.export,children:[f.jsx(gd,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.export})]}),f.jsxs("button",{onClick:b,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:l.exportXLSX,children:[f.jsx(xd,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.exportXLSX})]}),f.jsxs("button",{onClick:N,className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",title:l.exportHTML,children:[f.jsx($l,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.exportHTML})]}),f.jsxs("label",{className:"flex items-center gap-1.5 px-3 py-1.5 hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white cursor-pointer",title:l.import,children:[f.jsx(Ei,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.import}),f.jsx("input",{type:"file",accept:".json",onChange:I,className:"hidden"})]})]})]}),f.jsxs("div",{className:"flex gap-2 md:gap-3",children:[f.jsxs("button",{onClick:()=>O(!0),className:"flex items-center gap-2 px-3 py-1.5 md:px-4 md:py-2 bg-gradient-to-r from-amber-500 to-yellow-500 hover:from-amber-400 hover:to-yellow-400 text-white rounded-lg transition-all shadow-lg shadow-amber-900/30 text-xs md:text-sm font-bold border border-amber-400/20 group",children:[f.jsx(ks,{size:16,className:"text-white fill-white/20 group-hover:scale-110 transition-transform"})," ",f.jsx("span",{className:"hidden sm:inline",children:l.aiWizard}),f.jsx("span",{className:"sm:hidden",children:"IA"})]}),f.jsxs("button",{onClick:()=>t(h),className:"flex items-center gap-2 px-3 py-1.5 md:px-5 md:py-2 bg-emerald-600 hover:bg-emerald-500 rounded-lg transition-all text-xs md:text-sm font-semibold shadow-lg shadow-emerald-900/30 text-white",children:[f.jsx(Ed,{size:16})," ",f.jsx("span",{className:"hidden sm:inline",children:l.savePlay})]}),f.jsxs("button",{onClick:n,className:"px-2 py-1.5 md:px-4 md:py-2 text-slate-400 hover:text-white transition-colors text-xs md:text-sm font-medium",children:[f.jsx(Bt,{size:20,className:"md:hidden"})," ",f.jsx("span",{className:"hidden md:inline",children:l.exit})]})]})]}),ae&&f.jsxs("div",{className:"md:hidden bg-slate-800 text-slate-200 border-b border-slate-700 p-2 grid grid-cols-5 gap-2 text-xs font-medium z-20",children:[f.jsxs("button",{onClick:()=>{Io(),ce(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[f.jsx(jl,{size:18})," ",l.save]}),f.jsxs("button",{onClick:()=>{se(!0),ce(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[f.jsx(bs,{size:18})," ",l.open]}),f.jsxs("button",{onClick:()=>{_(),ce(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[f.jsx(gd,{size:18})," JSON"]}),f.jsxs("button",{onClick:()=>{b(),ce(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[f.jsx(xd,{size:18})," XLSX"]}),f.jsxs("button",{onClick:()=>{N(),ce(!1)},className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded",children:[f.jsx($l,{size:18})," HTML"]}),f.jsxs("label",{className:"flex flex-col items-center gap-1 p-2 hover:bg-slate-700 rounded cursor-pointer col-span-5",children:[f.jsx(Ei,{size:18})," ",l.import,f.jsx("input",{type:"file",accept:".json",onChange:I,className:"hidden"})]})]}),f.jsx("div",{className:"flex border-b bg-white overflow-x-auto whitespace-nowrap shrink-0",children:[{id:"GENERAL",label:l.general,icon:iT},{id:"FEATURES",label:l.features,icon:gT},{id:"ENTITIES",label:l.entities,icon:o1},{id:"MATRIX",label:l.matrix,icon:pc}].map(S=>f.jsxs("button",{onClick:()=>w(S.id),className:`flex items-center gap-2 px-4 py-3 md:py-4 text-xs md:text-sm font-medium transition-all border-b-2 relative top-[2px] min-w-fit ${v===S.id?"border-emerald-600 text-emerald-600 bg-emerald-50/50 rounded-t-lg":"border-transparent text-slate-500 hover:text-slate-800 hover:bg-slate-50/50"}`,children:[f.jsx(S.icon,{size:16})," ",S.label]},S.id))}),f.jsx("div",{className:"flex-1 overflow-auto bg-slate-50 p-4 md:p-6 pb-20 md:pb-6",children:f.jsxs("div",{className:`mx-auto bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden ${v==="MATRIX"?"max-w-none":"max-w-6xl"}`,children:[v==="GENERAL"&&f.jsx("div",{className:"p-6 md:p-8 space-y-8 max-w-2xl",children:f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 border-b pb-2",children:l.general}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1",children:l.projectName}),f.jsx("input",{value:h.name,onChange:S=>Ao({name:S.target.value}),className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all font-medium text-slate-800"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1",children:l.description}),f.jsx("textarea",{value:h.description,onChange:S=>Ao({description:S.target.value}),className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all h-32 text-slate-700"})]})]})]})}),v==="FEATURES"&&f.jsxs("div",{className:"p-4 md:p-8",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:l.definedFeatures}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 text-xs font-bold rounded-full",children:[h.features.length," ",r==="pt"?"car.":"feat."]}),f.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-xs font-bold rounded-full",children:[h.features.reduce((S,A)=>S+A.states.length,0)," ",r==="pt"?"estados":"states"]})]})]}),f.jsx("p",{className:"text-xs md:text-sm text-slate-500",children:l.definedFeaturesDesc})]}),f.jsxs("button",{onClick:xr,className:"flex items-center gap-2 text-sm bg-slate-900 text-white px-4 py-2 rounded-lg hover:bg-slate-700 shadow-md transition-all",children:[f.jsx(ga,{size:16})," ",f.jsx("span",{className:"hidden sm:inline",children:l.addFeature})]})]}),f.jsx("div",{className:"grid gap-6 md:grid-cols-2 xl:grid-cols-3",children:h.features.map((S,A)=>f.jsxs("div",{className:"border border-slate-200 rounded-xl p-5 bg-white relative group hover:border-emerald-300 hover:shadow-md transition-all",children:[f.jsx("button",{className:"absolute top-3 right-3 text-slate-300 hover:text-red-500 md:opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-red-50 rounded",onClick:()=>{const j=h.features.filter(W=>W.id!==S.id);x(W=>({...W,features:j}))},children:f.jsx(os,{size:16})}),f.jsxs("div",{className:"mb-4 space-y-2",children:[f.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:l.featureName}),f.jsx("input",{value:S.name,onChange:j=>{const W=[...h.features];W[A].name=j.target.value,x(ee=>({...ee,features:W}))},className:"font-bold text-lg text-slate-800 bg-transparent border-b border-transparent hover:border-slate-300 focus:border-emerald-500 outline-none w-full pb-1"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Ts,{size:14,className:"text-slate-400"}),f.jsx("input",{value:S.imageUrl||"",onChange:j=>{const W=[...h.features];W[A].imageUrl=j.target.value,x(ee=>({...ee,features:W}))},className:"text-xs flex-1 bg-slate-50 border border-slate-200 rounded px-2 py-1 outline-none focus:border-emerald-400",placeholder:l.imageURL})]})]}),f.jsxs("div",{className:"space-y-2 pl-3 border-l-2 border-slate-100",children:[f.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider block mb-1",children:l.states}),S.states.map((j,W)=>f.jsxs("div",{className:"group/state",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[j.imageUrl?f.jsx("button",{onClick:()=>D({url:j.imageUrl,label:j.label,featureName:S.name}),className:"w-6 h-6 rounded overflow-hidden border border-slate-200 hover:border-emerald-400 transition-colors shrink-0",title:l.viewImage,children:f.jsx("img",{src:j.imageUrl,alt:j.label,className:"w-full h-full object-cover"})}):f.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-300 group-focus-within/state:bg-emerald-400 shrink-0"}),f.jsx("input",{value:j.label,onChange:ee=>{const oe=[...h.features];oe[A].states[W].label=ee.target.value,x(Z=>({...Z,features:oe}))},className:"text-sm bg-transparent outline-none flex-1 text-slate-600 focus:text-slate-900 focus:font-medium"}),f.jsx("button",{onClick:()=>{const ee=j.imageUrl?"":prompt(l.stateImage+" URL:","");if(ee!==null){const oe=[...h.features];oe[A].states[W].imageUrl=ee||void 0,x(Z=>({...Z,features:oe}))}},className:`${j.imageUrl?"text-emerald-500":"text-slate-300 hover:text-slate-500"} md:opacity-0 group-hover/state:opacity-100 transition-opacity`,title:j.imageUrl?l.stateImage:l.addStateImage,children:f.jsx(Ts,{size:12})}),f.jsx("button",{onClick:()=>{const ee=[...h.features];ee[A].states=ee[A].states.filter(oe=>oe.id!==j.id),x(oe=>({...oe,features:ee}))},className:"text-slate-300 hover:text-red-400 md:opacity-0 group-hover/state:opacity-100 transition-opacity",children:f.jsx(Bt,{size:12})})]}),j.imageUrl&&f.jsx("div",{className:"ml-8 mt-1",children:f.jsx("input",{value:j.imageUrl,onChange:ee=>{const oe=[...h.features];oe[A].states[W].imageUrl=ee.target.value||void 0,x(Z=>({...Z,features:oe}))},className:"text-[10px] w-full text-slate-400 bg-slate-50 rounded px-2 py-0.5 outline-none focus:bg-white focus:text-slate-600 border border-transparent focus:border-slate-200",placeholder:"URL..."})})]},j.id)),f.jsxs("button",{onClick:()=>{const j=[...h.features];j[A].states.push({id:Math.random().toString(36).substr(2,9),label:"..."}),x(W=>({...W,features:j}))},className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium mt-3 flex items-center gap-1 bg-emerald-50 w-fit px-2 py-1 rounded",children:[f.jsx(ga,{size:10})," ",l.addState]})]})]},S.id))})]}),v==="ENTITIES"&&f.jsxs("div",{className:"p-4 md:p-8",children:[f.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:l.manageEntities}),f.jsx("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 text-xs font-bold rounded-full",children:ts?`${es.length} ${l.ofEntities} ${h.entities.length}`:`${h.entities.length} ${r==="pt"?"entidades":"entities"}`})]}),f.jsx("p",{className:"text-xs md:text-sm text-slate-500",children:l.manageEntitiesDesc})]}),f.jsxs("button",{onClick:sa,className:"flex items-center gap-2 text-sm bg-slate-900 text-white px-4 py-2 rounded-lg hover:bg-slate-700 shadow-md transition-all",children:[f.jsx(ga,{size:16})," ",f.jsx("span",{className:"hidden sm:inline",children:l.addEntity})]})]}),f.jsx("div",{className:"mb-6 p-4 bg-slate-50 rounded-xl border border-slate-200",children:f.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[f.jsx("div",{className:"flex-1 min-w-[200px]",children:f.jsxs("div",{className:"relative",children:[f.jsx(kp,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),f.jsx("input",{type:"text",value:ze.searchText,onChange:S=>qe(A=>({...A,searchText:S.target.value})),placeholder:l.searchPlaceholder,className:"w-full pl-9 pr-3 py-2 text-sm border border-slate-200 rounded-lg focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 outline-none"})]})}),Qi.length>0&&f.jsxs("select",{value:ze.family,onChange:S=>qe(A=>({...A,family:S.target.value})),className:"px-3 py-2 text-sm border border-slate-200 rounded-lg bg-white focus:border-emerald-500 outline-none min-w-[150px]",children:[f.jsx("option",{value:"",children:l.allFamilies}),Qi.map(S=>f.jsx("option",{value:S,children:S},S))]}),Zi.length>0&&f.jsxs("select",{value:ze.genus,onChange:S=>qe(A=>({...A,genus:S.target.value})),className:"px-3 py-2 text-sm border border-slate-200 rounded-lg bg-white focus:border-emerald-500 outline-none min-w-[150px]",children:[f.jsx("option",{value:"",children:l.allGenera}),Zi.map(S=>f.jsx("option",{value:S,children:S},S))]}),h.features.length>0&&f.jsxs("label",{className:`flex items-center gap-2 px-3 py-2 text-sm border rounded-lg cursor-pointer transition-colors ${ze.onlyWithGaps?"bg-amber-50 border-amber-300 text-amber-700":"bg-white border-slate-200 text-slate-600 hover:bg-slate-50"}`,title:l.onlyWithGapsDesc,children:[f.jsx("input",{type:"checkbox",checked:ze.onlyWithGaps,onChange:S=>qe(A=>({...A,onlyWithGaps:S.target.checked})),className:"w-4 h-4 text-amber-500 border-slate-300 rounded focus:ring-amber-500"}),f.jsx("span",{className:"whitespace-nowrap",children:l.onlyWithGaps})]}),ts&&f.jsxs("button",{onClick:No,className:"flex items-center gap-1 px-3 py-2 text-sm text-slate-600 hover:text-slate-800 hover:bg-slate-200 rounded-lg transition-colors",children:[f.jsx(Bt,{size:14}),l.clearFilters]})]})}),f.jsx("div",{className:"space-y-4",children:es.map(S=>{const A=h.entities.findIndex(j=>j.id===S.id);return f.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 items-start border border-slate-200 p-4 md:p-6 rounded-xl bg-white hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"w-full sm:w-48 space-y-2 flex-shrink-0",children:[f.jsx("div",{className:"aspect-[4/3] bg-slate-100 rounded-lg overflow-hidden border border-slate-200",children:S.imageUrl?f.jsx("img",{src:S.imageUrl,className:"w-full h-full object-cover",alt:"preview"}):f.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-300",children:f.jsx(Ts,{size:32})})}),f.jsx("input",{value:S.imageUrl||"",onChange:j=>{const W=[...h.entities];W[A].imageUrl=j.target.value,x(ee=>({...ee,entities:W}))},className:"text-xs w-full px-2 py-1.5 bg-slate-50 border border-slate-200 rounded outline-none focus:border-emerald-500 text-slate-600",placeholder:l.imageURL}),f.jsxs("button",{onClick:()=>Yi(S.id),className:"w-full flex items-center justify-center gap-2 text-xs bg-slate-100 hover:bg-slate-200 text-slate-700 py-3 md:py-2 rounded-lg font-medium transition-colors border border-slate-200",children:[f.jsx(qo,{size:12})," ",l.editTraits]})]}),f.jsxs("div",{className:"flex-1 space-y-4 w-full",children:[f.jsxs("div",{className:"flex justify-between items-start gap-2",children:[f.jsx("input",{value:S.name,onChange:j=>{const W=[...h.entities];W[A].name=j.target.value,x(ee=>({...ee,entities:W}))},className:"text-xl font-bold bg-transparent border-b border-transparent hover:border-slate-300 focus:border-emerald-500 outline-none w-full pb-1 text-slate-800"}),f.jsx("button",{onClick:()=>{const j=h.entities.filter(W=>W.id!==S.id);x(W=>({...W,entities:j}))},className:"text-slate-300 hover:text-red-500 p-2 hover:bg-red-50 rounded transition-colors",children:f.jsx(os,{size:18})})]}),f.jsxs("div",{className:"flex gap-3 flex-wrap md:flex-nowrap",children:[f.jsxs("div",{className:"flex-1 min-w-[140px]",children:[f.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:r==="pt"?"Nome Cientfico":"Scientific Name"}),f.jsx("input",{value:S.scientificName||"",onChange:j=>{const W=[...h.entities];W[A].scientificName=j.target.value,x(ee=>({...ee,entities:W}))},placeholder:r==="pt"?"Ex: Panthera leo":"e.g., Panthera leo",className:"text-sm italic text-slate-600 bg-slate-50 border border-slate-200 focus:bg-white focus:border-emerald-500 w-full outline-none rounded-lg px-3 py-2 transition-colors"})]}),f.jsxs("div",{className:"flex-1 min-w-[120px]",children:[f.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:r==="pt"?"Famlia":"Family"}),f.jsx("input",{value:S.family||"",onChange:j=>{const W=[...h.entities];W[A].family=j.target.value,x(ee=>({...ee,entities:W}))},placeholder:r==="pt"?"Ex: Felidae":"e.g., Felidae",className:"text-sm text-slate-600 bg-slate-50 border border-slate-200 focus:bg-white focus:border-emerald-500 w-full outline-none rounded-lg px-3 py-2 transition-colors"})]})]}),f.jsx("textarea",{value:S.description,onChange:j=>{const W=[...h.entities];W[A].description=j.target.value,x(ee=>({...ee,entities:W}))},className:"text-sm text-slate-600 bg-slate-50 border border-transparent focus:bg-white focus:border-emerald-500 w-full h-24 outline-none resize-none rounded-lg p-3 transition-colors"}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100",children:[f.jsxs("h5",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 flex items-center gap-2",children:[f.jsx(yd,{size:12})," ",l.links]}),f.jsxs("div",{className:"space-y-2",children:[(S.links||[]).map((j,W)=>f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{placeholder:"Label",value:j.label,onChange:ee=>{const oe=[...h.entities];oe[A].links||(oe[A].links=[]),oe[A].links[W].label=ee.target.value,x(Z=>({...Z,entities:oe}))},className:"text-xs flex-1 px-2 py-1 border border-slate-200 rounded outline-none focus:border-emerald-400"}),f.jsx("input",{placeholder:"URL",value:j.url,onChange:ee=>{const oe=[...h.entities];oe[A].links||(oe[A].links=[]),oe[A].links[W].url=ee.target.value,x(Z=>({...Z,entities:oe}))},className:"text-xs flex-[2] px-2 py-1 border border-slate-200 rounded outline-none focus:border-emerald-400"}),f.jsx("button",{onClick:()=>{const ee=[...h.entities];ee[A].links||(ee[A].links=[]),ee[A].links=ee[A].links.filter((oe,Z)=>Z!==W),x(oe=>({...oe,entities:ee}))},className:"text-slate-400 hover:text-red-500",children:f.jsx(Bt,{size:14})})]},j.id||W)),f.jsxs("button",{onClick:()=>{const j=[...h.entities];j[A].links||(j[A].links=[]),j[A].links.push({id:Math.random().toString(36).substr(2,9),label:"",url:""}),x(W=>({...W,entities:j}))},className:"text-xs flex items-center gap-1 text-emerald-600 hover:text-emerald-700 font-medium",children:[f.jsx(ga,{size:12})," ",l.addLink]})]})]})]})]},S.id)})})]}),v==="MATRIX"&&f.jsxs("div",{className:"flex flex-col h-full bg-slate-50 min-h-[500px]",children:[f.jsxs("div",{className:"p-4 border-b bg-white",children:[f.jsxs("div",{className:"flex justify-between items-center mb-3",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("h3",{className:"font-semibold text-slate-700",children:l.scoringMatrix}),ts&&f.jsxs("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 text-xs font-bold rounded-full",children:[es.length," ",l.ofEntities," ",h.entities.length]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-xs text-slate-400 hidden sm:inline",children:l.scoringMatrixDesc}),h.features.length>1&&f.jsxs("div",{className:"flex gap-1 border-l pl-2 ml-2",children:[f.jsx("button",{onClick:()=>Co("prev"),className:"p-1.5 hover:bg-slate-100 rounded transition-colors text-slate-600",title:"Caracterstica Anterior",children:f.jsx(oT,{size:16})}),f.jsx("button",{onClick:()=>Co("next"),className:"p-1.5 hover:bg-slate-100 rounded transition-colors text-slate-600",title:"Prxima Caracterstica",children:f.jsx(lT,{size:16})})]})]})]}),f.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3 pb-3 border-b border-slate-100",children:[f.jsxs("div",{className:"relative flex-1 min-w-[150px] max-w-[250px]",children:[f.jsx(kp,{size:14,className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-slate-400"}),f.jsx("input",{type:"text",value:ze.searchText,onChange:S=>qe(A=>({...A,searchText:S.target.value})),placeholder:l.searchPlaceholder,className:"w-full pl-8 pr-2 py-1.5 text-xs border border-slate-200 rounded-lg focus:border-emerald-500 outline-none"})]}),Qi.length>0&&f.jsxs("select",{value:ze.family,onChange:S=>qe(A=>({...A,family:S.target.value})),className:"px-2 py-1.5 text-xs border border-slate-200 rounded-lg bg-white focus:border-emerald-500 outline-none",children:[f.jsx("option",{value:"",children:l.allFamilies}),Qi.map(S=>f.jsx("option",{value:S,children:S},S))]}),Zi.length>0&&f.jsxs("select",{value:ze.genus,onChange:S=>qe(A=>({...A,genus:S.target.value})),className:"px-2 py-1.5 text-xs border border-slate-200 rounded-lg bg-white focus:border-emerald-500 outline-none",children:[f.jsx("option",{value:"",children:l.allGenera}),Zi.map(S=>f.jsx("option",{value:S,children:S},S))]}),h.features.length>0&&f.jsxs("label",{className:`flex items-center gap-1.5 px-2 py-1.5 text-xs border rounded-lg cursor-pointer transition-colors ${ze.onlyWithGaps?"bg-amber-50 border-amber-300 text-amber-700":"bg-white border-slate-200 text-slate-500 hover:bg-slate-50"}`,title:l.onlyWithGapsDesc,children:[f.jsx("input",{type:"checkbox",checked:ze.onlyWithGaps,onChange:S=>qe(A=>({...A,onlyWithGaps:S.target.checked})),className:"w-3.5 h-3.5 text-amber-500 border-slate-300 rounded focus:ring-amber-500"}),f.jsx("span",{className:"whitespace-nowrap",children:l.onlyWithGaps})]}),ts&&f.jsxs("button",{onClick:No,className:"flex items-center gap-1 px-2 py-1.5 text-xs text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:[f.jsx(Bt,{size:12}),l.clearFilters]})]}),f.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 custom-scrollbar",children:h.features.map((S,A)=>f.jsx("button",{onClick:()=>hi(S.id),className:`shrink-0 px-3 py-1.5 rounded-full text-xs font-medium transition-all ${gr===S.id?"bg-emerald-600 text-white shadow-md":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:S.name},S.id))})]}),f.jsx("div",{className:"flex-1 overflow-hidden bg-gradient-to-br from-slate-100 to-slate-200 relative",children:f.jsx("div",{ref:Ki,className:"absolute inset-0 overflow-auto custom-scrollbar",children:f.jsxs("table",{className:"border-collapse w-max",children:[f.jsxs("thead",{className:"sticky top-0 z-40",children:[f.jsxs("tr",{className:"bg-gradient-to-r from-slate-800 to-slate-900",children:[f.jsx("th",{rowSpan:2,className:"sticky left-0 z-50 bg-gradient-to-br from-slate-800 to-slate-900 text-white px-3 py-2 font-bold border-r border-b border-slate-600 text-left align-bottom",style:{minWidth:"180px",maxWidth:"180px"},children:f.jsx("span",{className:"text-xs font-semibold tracking-wide",children:l.taxaFeatures})}),h.features.map(S=>{const A=gr===S.id,j=A?S.states.length:1;return f.jsx("th",{colSpan:j,className:`px-1 py-1.5 font-semibold border-r border-b text-center align-middle cursor-pointer transition-all duration-200 ${A?"bg-gradient-to-br from-emerald-500 to-emerald-700 border-emerald-400 text-white shadow-lg":"bg-gradient-to-b from-slate-600 to-slate-700 border-slate-500 text-slate-100 hover:from-slate-500 hover:to-slate-600"}`,style:{minWidth:A?`${j*80}px`:"60px"},onClick:()=>hi(S.id),title:S.name,children:f.jsxs("div",{className:"flex items-center justify-center gap-1",children:[A&&f.jsx("button",{onClick:W=>{W.stopPropagation(),ia(null)},className:"p-0.5 hover:bg-emerald-400/50 rounded transition-colors flex-shrink-0",children:f.jsx(Bt,{size:12})}),f.jsx("span",{className:`font-semibold leading-tight ${A?"text-[10px]":"text-[9px]"}`,children:S.name})]})},`header-${S.id}`)})]}),f.jsx("tr",{children:h.features.map(S=>gr===S.id?S.states.map(j=>f.jsx("th",{className:"bg-gradient-to-b from-emerald-600 to-emerald-700 text-white px-1 py-1.5 border-r border-b border-emerald-500 text-center align-top",style:{minWidth:"80px",maxWidth:"100px"},title:j.label,children:f.jsx("div",{className:"text-[8px] font-medium leading-snug px-0.5 break-words",style:{wordBreak:"break-word",hyphens:"auto"},children:j.label})},`state-${j.id}`)):f.jsx("th",{className:"bg-gradient-to-b from-slate-500 to-slate-600 text-slate-200 px-1 py-1.5 border-r border-b border-slate-400 text-center cursor-pointer hover:from-slate-400 hover:to-slate-500 transition-all",style:{minWidth:"60px",maxWidth:"60px"},onClick:()=>hi(S.id),children:f.jsxs("div",{className:"flex flex-col items-center gap-0",children:[f.jsx("span",{className:"text-[8px] opacity-80",children:"expandir"}),f.jsxs("span",{className:"text-[10px] font-bold",children:["(",S.states.length,")"]})]})},`expand-${S.id}`))})]}),f.jsx("tbody",{children:es.map((S,A)=>f.jsxs("tr",{className:A%2===0?"bg-white":"bg-slate-50/80",children:[f.jsx("td",{className:`sticky left-0 z-20 px-2 py-1.5 border-r-2 border-b border-slate-200 ${A%2===0?"bg-white":"bg-slate-50"}`,style:{minWidth:"180px",maxWidth:"180px",boxShadow:"2px 0 6px rgba(0,0,0,0.08)"},children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-6 h-6 rounded bg-slate-200 overflow-hidden flex-shrink-0",children:S.imageUrl&&f.jsx("img",{src:S.imageUrl,className:"w-full h-full object-cover",alt:""})}),f.jsx("span",{className:"text-[11px] font-medium text-slate-700 line-clamp-2 leading-tight",title:S.name,children:S.name})]})}),h.features.map(j=>{const W=gr===j.id,ee=S.traits[j.id]||[],oe=ee.length;return W?j.states.map(Z=>{const ve=ee.includes(Z.id);return f.jsx("td",{className:`border-b border-r border-slate-200 text-center hover:bg-emerald-50 transition-colors p-1 ${A%2===0?"bg-white":"bg-slate-50/80"}`,style:{minWidth:"80px",maxWidth:"100px"},children:f.jsx("button",{onClick:()=>Pn(S.id,j.id,Z.id),className:`w-7 h-7 rounded-md flex items-center justify-center transition-all mx-auto ${ve?"bg-gradient-to-br from-emerald-400 to-emerald-600 text-white shadow-sm":"bg-slate-100 text-slate-300 hover:bg-slate-200"}`,children:ve&&f.jsx(pc,{size:14,strokeWidth:2.5})})},`${S.id}-${Z.id}`)}):f.jsx("td",{className:`border-b border-r border-slate-200 text-center cursor-pointer hover:bg-slate-100 transition-colors p-1 ${A%2===0?"bg-white":"bg-slate-50/80"}`,style:{minWidth:"60px",maxWidth:"60px"},onClick:()=>hi(j.id),title:`${oe} de ${j.states.length}`,children:f.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-bold mx-auto ${oe>0?"bg-gradient-to-br from-emerald-100 to-emerald-200 text-emerald-700":"bg-slate-100 text-slate-400"}`,children:oe})},`${S.id}-${j.id}-collapsed`)})]},S.id))})]})})})]})]})}),Ji&&f.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col max-h-[90vh] animate-in fade-in zoom-in-95 overflow-hidden",children:[f.jsxs("div",{className:"bg-slate-50 p-4 border-b flex justify-between items-center",children:[f.jsxs("h3",{className:"font-bold text-slate-800 text-lg flex items-center gap-2 truncate",children:[f.jsx(qo,{size:18,className:"text-emerald-600"}),f.jsxs("span",{className:"truncate",children:[l.traitEditor,": ",f.jsx("span",{className:"text-emerald-600",children:(l0=h.entities.find(S=>S.id===Ji))==null?void 0:l0.name})]})]}),f.jsx("button",{onClick:()=>Yi(null),className:"text-slate-400 hover:text-slate-600 p-1",children:f.jsx(Bt,{size:20})})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 space-y-6 custom-scrollbar",children:[h.features.map(S=>f.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4",children:[f.jsxs("h4",{className:"font-bold text-slate-700 mb-3 flex items-center gap-2",children:[S.name,S.imageUrl&&f.jsx("a",{href:S.imageUrl,target:"_blank",rel:"noopener noreferrer",className:"text-slate-400 hover:text-emerald-500",children:f.jsx(Gl,{size:12})})]}),f.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:S.states.map(A=>{var W,ee;const j=(ee=(W=h.entities.find(oe=>oe.id===Ji))==null?void 0:W.traits[S.id])==null?void 0:ee.includes(A.id);return f.jsxs("button",{onClick:()=>Pn(Ji,S.id,A.id),className:`text-sm px-3 py-3 md:py-2 rounded-lg border text-left flex items-center justify-between transition-all touch-manipulation active:scale-[0.98] ${j?"bg-emerald-600 text-white border-emerald-600 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:border-emerald-300 hover:text-emerald-600"}`,children:[f.jsx("span",{className:"truncate mr-2 text-xs md:text-sm",children:A.label}),j&&f.jsx(pc,{size:14})]},A.id)})})]},S.id)),h.features.length===0&&f.jsx("div",{className:"text-center text-slate-400 py-10",children:"Nenhuma caracterstica definida no projeto."})]}),f.jsx("div",{className:"p-4 border-t bg-slate-50 shrink-0",children:f.jsx("button",{onClick:()=>Yi(null),className:"w-full py-3 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-500 shadow-lg shadow-emerald-900/10",children:l.close})})]})}),R&&f.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full overflow-hidden animate-in fade-in zoom-in-95 duration-200 border border-slate-200 max-h-[90vh] flex flex-col",children:[f.jsxs("div",{className:"bg-gradient-to-r from-amber-500 to-yellow-500 p-4 md:p-6 text-white shrink-0",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:f.jsx(ks,{size:24,className:"text-white"})}),f.jsx("h3",{className:"text-xl md:text-2xl font-bold flex-1",children:l.aiTitle}),a&&f.jsx("button",{onClick:()=>{O(!1),a(!0)},className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",title:r==="pt"?"Configurar Chave de API":"Configure API Key",children:f.jsx(vd,{size:18,className:"text-white"})})]}),f.jsx("p",{className:"text-amber-50 text-xs md:text-sm font-medium drop-shadow-sm",children:l.aiDesc}),!s&&a&&f.jsxs("div",{className:"mt-3 flex items-center gap-2 bg-red-500/30 backdrop-blur-sm px-3 py-2 rounded-lg border border-red-300/50 animate-pulse",children:[f.jsx(vd,{size:16,className:"text-yellow-200"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-yellow-100 text-xs font-bold",children:l.apiKeyWarning}),f.jsx("p",{className:"text-yellow-200/80 text-[10px]",children:l.clickGear})]})]})]}),f.jsxs("div",{className:"flex border-b border-slate-200 bg-slate-50 shrink-0",children:[f.jsx("button",{onClick:()=>k("TOPIC"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${M==="TOPIC"?"border-amber-500 text-amber-600 bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:f.jsxs("span",{className:"flex items-center justify-center gap-1",children:[f.jsx(Dp,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.modeTopic}),f.jsx("span",{className:"sm:hidden",children:"Gerar"})]})}),f.jsx("button",{onClick:()=>k("IMPORT"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${M==="IMPORT"?"border-amber-500 text-amber-600 bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:f.jsxs("span",{className:"flex items-center justify-center gap-1",children:[f.jsx(fT,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.modeImport}),f.jsx("span",{className:"sm:hidden",children:"Importar"})]})}),f.jsx("button",{onClick:()=>k("REFINE"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${M==="REFINE"?"border-amber-500 text-amber-600 bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:f.jsxs("span",{className:"flex items-center justify-center gap-1",children:[f.jsx(Mp,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.modeRefine}),f.jsx("span",{className:"sm:hidden",children:"Refinar"})]})}),f.jsx("button",{onClick:()=>k("MERGE"),className:`flex-1 py-2 text-xs font-bold transition-colors border-b-2 ${M==="MERGE"?"border-amber-500 text-amber-600 bg-white":"border-transparent text-slate-500 hover:bg-slate-100"}`,children:f.jsxs("span",{className:"flex items-center justify-center gap-1",children:[f.jsx(_p,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:l.modeMerge}),f.jsx("span",{className:"sm:hidden",children:"Combinar"})]})})]}),f.jsxs("div",{className:"p-4 md:p-6 space-y-5 overflow-y-auto custom-scrollbar flex-1 bg-white",children:[M==="TOPIC"?f.jsxs(f.Fragment,{children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:l.topic}),f.jsx("input",{value:E.topic,onChange:S=>y(A=>({...A,topic:S.target.value})),placeholder:l.topicPlace,className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-amber-500 focus:border-amber-500 outline-none text-base md:text-lg",disabled:T})]}),f.jsxs("div",{className:"bg-emerald-50/50 p-3 rounded-xl border border-emerald-100",children:[f.jsxs("label",{className:"block text-xs font-bold text-emerald-700 uppercase mb-2 flex items-center gap-1",children:[f.jsx(Vl,{size:12})," ",l.taxonomyFilters]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:l.taxonomyFamily}),f.jsx("input",{value:E.taxonomyFamily,onChange:S=>y(A=>({...A,taxonomyFamily:S.target.value})),placeholder:r==="pt"?"ex: Fabaceae":"e.g. Fabaceae",className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 outline-none text-sm bg-white",disabled:T})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:l.taxonomyGenus}),f.jsx("input",{value:E.taxonomyGenus,onChange:S=>y(A=>({...A,taxonomyGenus:S.target.value})),placeholder:r==="pt"?"ex: Inga":"e.g. Inga",className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 outline-none text-sm bg-white",disabled:T})]})]})]}),f.jsxs("div",{className:"bg-blue-50/50 p-3 rounded-xl border border-blue-100",children:[f.jsxs("label",{className:"block text-xs font-bold text-blue-700 uppercase mb-2 flex items-center gap-1",children:[f.jsx(Np,{size:12})," ",l.geographyFilters]}),f.jsx("div",{className:"flex gap-2 mb-3",children:["global","national","regional"].map(S=>f.jsx("button",{onClick:()=>y(A=>({...A,scope:S})),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-lg transition-colors ${E.scope===S?"bg-blue-600 text-white":"bg-white text-slate-600 hover:bg-blue-100 border border-slate-200"}`,disabled:T,children:S==="global"?l.scopeGlobal:S==="national"?l.scopeNational:l.scopeRegional},S))}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:l.biome}),f.jsxs("select",{value:E.biome,onChange:S=>y(A=>({...A,biome:S.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm bg-white",disabled:T,children:[f.jsx("option",{value:"",children:r==="pt"?"Todos os biomas":"All biomes"}),f.jsx("option",{value:"Amaznia",children:"Amaznia"}),f.jsx("option",{value:"Mata Atlntica",children:"Mata Atlntica"}),f.jsx("option",{value:"Cerrado",children:"Cerrado"}),f.jsx("option",{value:"Caatinga",children:"Caatinga"}),f.jsx("option",{value:"Pampa",children:"Pampa"}),f.jsx("option",{value:"Pantanal",children:"Pantanal"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:l.stateUF}),f.jsxs("select",{value:E.stateUF,onChange:S=>y(A=>({...A,stateUF:S.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm bg-white",disabled:T,children:[f.jsx("option",{value:"",children:r==="pt"?"Todos os estados":"All states"}),f.jsx("option",{value:"AC",children:"Acre (AC)"}),f.jsx("option",{value:"AL",children:"Alagoas (AL)"}),f.jsx("option",{value:"AP",children:"Amap (AP)"}),f.jsx("option",{value:"AM",children:"Amazonas (AM)"}),f.jsx("option",{value:"BA",children:"Bahia (BA)"}),f.jsx("option",{value:"CE",children:"Cear (CE)"}),f.jsx("option",{value:"DF",children:"Distrito Federal (DF)"}),f.jsx("option",{value:"ES",children:"Esprito Santo (ES)"}),f.jsx("option",{value:"GO",children:"Gois (GO)"}),f.jsx("option",{value:"MA",children:"Maranho (MA)"}),f.jsx("option",{value:"MT",children:"Mato Grosso (MT)"}),f.jsx("option",{value:"MS",children:"Mato Grosso do Sul (MS)"}),f.jsx("option",{value:"MG",children:"Minas Gerais (MG)"}),f.jsx("option",{value:"PA",children:"Par (PA)"}),f.jsx("option",{value:"PB",children:"Paraba (PB)"}),f.jsx("option",{value:"PR",children:"Paran (PR)"}),f.jsx("option",{value:"PE",children:"Pernambuco (PE)"}),f.jsx("option",{value:"PI",children:"Piau (PI)"}),f.jsx("option",{value:"RJ",children:"Rio de Janeiro (RJ)"}),f.jsx("option",{value:"RN",children:"Rio Grande do Norte (RN)"}),f.jsx("option",{value:"RS",children:"Rio Grande do Sul (RS)"}),f.jsx("option",{value:"RO",children:"Rondnia (RO)"}),f.jsx("option",{value:"RR",children:"Roraima (RR)"}),f.jsx("option",{value:"SC",children:"Santa Catarina (SC)"}),f.jsx("option",{value:"SP",children:"So Paulo (SP)"}),f.jsx("option",{value:"SE",children:"Sergipe (SE)"}),f.jsx("option",{value:"TO",children:"Tocantins (TO)"})]})]})]}),f.jsxs("div",{className:"mt-3",children:[f.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:r==="pt"?"Regio especfica (opcional)":"Specific region (optional)"}),f.jsx("input",{value:E.geography,onChange:S=>y(A=>({...A,geography:S.target.value})),placeholder:r==="pt"?"ex: Serra do Mar, Bacia do Rio Doce":"e.g. Amazon Basin, Andes",className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm bg-white",disabled:T})]})]}),f.jsxs("div",{className:"bg-amber-50/50 p-3 rounded-xl border border-amber-100",children:[f.jsxs("label",{className:"block text-xs font-bold text-amber-700 uppercase mb-2 flex items-center gap-1",children:[" ",l.featureTypeLabel]}),f.jsx("p",{className:"text-xs text-amber-600/80 mb-2",children:l.featureTypeDesc}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs("button",{onClick:()=>y(S=>({...S,featureFocus:"vegetative"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${E.featureFocus==="vegetative"?"bg-emerald-500 text-white border-emerald-500":"bg-white text-slate-600 border-slate-200 hover:border-emerald-300"}`,disabled:T,children:[" ",l.featureTypeVegetative]}),f.jsxs("button",{onClick:()=>y(S=>({...S,featureFocus:"reproductive"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${E.featureFocus==="reproductive"?"bg-pink-500 text-white border-pink-500":"bg-white text-slate-600 border-slate-200 hover:border-pink-300"}`,disabled:T,children:[" ",l.featureTypeReproductive]}),f.jsxs("button",{onClick:()=>y(S=>({...S,featureFocus:"general"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${E.featureFocus==="general"?"bg-amber-500 text-white border-amber-500":"bg-white text-slate-600 border-slate-200 hover:border-amber-300"}`,disabled:T,children:[" ",l.featureTypeBoth]})]})]}),f.jsxs("div",{className:"bg-purple-50/50 p-3 rounded-xl border border-purple-100",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("label",{className:"block text-xs font-bold text-purple-700 uppercase flex items-center gap-1",children:[f.jsx(Ip,{size:12})," ",l.requiredSpecies]}),zn.trim()&&f.jsxs("span",{className:"text-xs font-bold text-purple-600 bg-purple-100 px-2 py-0.5 rounded",children:[zn.split(`
`).filter(S=>S.trim()).length," ",l.speciesCount]})]}),f.jsx("p",{className:"text-xs text-purple-600/80 mb-2",children:l.requiredSpeciesDesc}),f.jsx("textarea",{value:zn,onChange:S=>nn(S.target.value),placeholder:l.requiredSpeciesPlaceholder,className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none text-sm bg-white resize-none h-24 font-mono",disabled:T}),f.jsxs("div",{className:"flex items-center justify-between mt-2 gap-2",children:[f.jsxs("label",{className:"cursor-pointer flex items-center gap-2 text-xs text-purple-600 hover:text-purple-800 transition-colors",children:[f.jsx(Ei,{size:14}),f.jsx("span",{className:"font-medium",children:l.importSpeciesList}),f.jsx("input",{ref:Or,type:"file",className:"hidden",accept:".txt,.csv,.json,.doc,.docx",onChange:J,disabled:T})]}),zn.trim()&&f.jsxs("button",{onClick:()=>nn(""),className:"text-xs text-red-500 hover:text-red-700 font-medium flex items-center gap-1",disabled:T,children:[f.jsx(os,{size:12})," ",l.clearList]})]}),f.jsx("p",{className:"text-[10px] text-purple-400 mt-1",children:l.importSpeciesFormats})]})]}):M==="IMPORT"?f.jsxs("div",{className:"flex flex-col gap-4",children:[f.jsxs("div",{className:"text-center space-y-2 mb-2",children:[f.jsx("h4",{className:"font-bold text-slate-800 text-lg",children:l.uploadLabel}),f.jsx("p",{className:"text-slate-500 text-sm",children:l.uploadDesc})]}),f.jsx("div",{className:`border-2 border-dashed rounded-xl p-6 flex flex-col items-center justify-center transition-all ${ne?"border-amber-500 bg-amber-100 scale-[1.02]":z?"border-amber-500 bg-amber-50/30":"border-slate-300 hover:border-amber-400 bg-slate-50"}`,onDragOver:P,onDragEnter:P,onDragLeave:Y,onDrop:ie,children:z?f.jsxs("div",{className:"flex flex-col items-center gap-3",children:[f.jsx(dc,{size:48,className:"text-amber-600"}),f.jsx("span",{className:"font-bold text-slate-800 text-sm text-center break-all",children:z.name}),f.jsxs("span",{className:"text-xs text-slate-400",children:[(z.size/1024).toFixed(1)," KB"]}),f.jsxs("button",{onClick:()=>X(null),className:"mt-2 text-red-500 text-xs font-bold hover:underline flex items-center gap-1 p-2",children:[f.jsx(os,{size:12})," ",l.removeFile]})]}):f.jsxs("label",{className:"cursor-pointer flex flex-col items-center gap-3 w-full h-full",children:[f.jsx("div",{className:`p-4 bg-white rounded-full shadow-sm transition-transform ${ne?"scale-110":""}`,children:f.jsx(Ei,{size:24,className:`${ne?"text-amber-600":"text-amber-500"}`})}),f.jsx("span",{className:"font-bold text-slate-600",children:ne?r==="pt"?"Solte o arquivo aqui!":"Drop file here!":l.dropFile}),f.jsx("span",{className:"text-xs text-slate-400",children:l.supportedFormats}),f.jsx("input",{type:"file",className:"hidden",accept:".pdf,.txt,.jpg,.jpeg,.png",onChange:F})]})})]}):M==="REFINE"?f.jsxs("div",{className:"flex flex-col gap-4",children:[f.jsxs("div",{className:"bg-gradient-to-r from-emerald-50 to-teal-50 p-4 rounded-xl border border-emerald-200",children:[f.jsx("h5",{className:"text-xs font-bold text-emerald-700 uppercase mb-2",children:l.currentProject}),h.entities.length>0||h.features.length>0?f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-bold text-slate-800 truncate",children:h.name}),f.jsxs("p",{className:"text-xs text-slate-500",children:[h.entities.length," ",l.entitiesCount,"  ",h.features.length," ",l.featuresCount]})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("span",{className:"bg-emerald-100 text-emerald-700 text-xs font-bold px-2 py-1 rounded",children:h.entities.length}),f.jsx("span",{className:"bg-teal-100 text-teal-700 text-xs font-bold px-2 py-1 rounded",children:h.features.length})]})]}):f.jsx("p",{className:"text-sm text-amber-600 italic",children:l.noProjectLoaded})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("button",{onClick:()=>G("EXPAND"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${U==="EXPAND"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-lg ${U==="EXPAND"?"bg-amber-500 text-white":"bg-slate-100 text-slate-500"}`,children:f.jsx(xT,{size:20})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-bold text-slate-800",children:l.actionExpand}),f.jsx("p",{className:"text-xs text-slate-500",children:l.actionExpandDesc})]})]})}),f.jsx("button",{onClick:()=>G("REFINE"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${U==="REFINE"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-lg ${U==="REFINE"?"bg-amber-500 text-white":"bg-slate-100 text-slate-500"}`,children:f.jsx(_T,{size:20})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-bold text-slate-800",children:l.actionRefine}),f.jsx("p",{className:"text-xs text-slate-500",children:l.actionRefineDesc})]})]})}),f.jsx("button",{onClick:()=>G("CLEAN"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${U==="CLEAN"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-lg ${U==="CLEAN"?"bg-amber-500 text-white":"bg-slate-100 text-slate-500"}`,children:f.jsx(dT,{size:20})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-bold text-slate-800",children:l.actionClean}),f.jsx("p",{className:"text-xs text-slate-500",children:l.actionCleanDesc})]})]})}),f.jsx("button",{onClick:()=>G("PHOTOS"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${U==="PHOTOS"?"border-blue-500 bg-blue-50":"border-slate-200 hover:border-blue-300"}`,children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-lg ${U==="PHOTOS"?"bg-blue-500 text-white":"bg-slate-100 text-slate-500"}`,children:f.jsx(aT,{size:20})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-bold text-slate-800",children:l.actionPhotos}),f.jsx("p",{className:"text-xs text-slate-500",children:l.actionPhotosDesc})]})]})}),f.jsx("button",{onClick:()=>G("VALIDATE"),className:`w-full p-3 rounded-xl border-2 text-left transition-all ${U==="VALIDATE"?"border-emerald-500 bg-emerald-50":"border-slate-200 hover:border-emerald-300"}`,children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`p-2 rounded-lg ${U==="VALIDATE"?"bg-emerald-500 text-white":"bg-slate-100 text-slate-500"}`,children:f.jsx(Pp,{size:20})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-bold text-slate-800",children:l.actionValidate}),f.jsx("p",{className:"text-xs text-slate-500",children:l.actionValidateDesc})]})]})})]}),U==="EXPAND"&&f.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-4",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:l.expandCount}),f.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:H.expandCount})]}),f.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:H.expandCount,onChange:S=>de(A=>({...A,expandCount:parseInt(S.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500",disabled:T})]}),f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:H.keepExisting,onChange:S=>de(A=>({...A,keepExisting:S.target.checked})),className:"w-4 h-4 accent-amber-500"}),f.jsx("span",{className:"text-sm text-slate-700",children:l.keepExisting})]}),f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:H.addFeatures,onChange:S=>de(A=>({...A,addFeatures:S.target.checked})),className:"w-4 h-4 accent-amber-500"}),f.jsx("span",{className:"text-sm text-slate-700",children:l.addFeatures})]}),f.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[f.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase mb-3",children:l.expandFilters}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:l.expandFamily}),f.jsx("input",{type:"text",value:H.expandFamily,onChange:S=>de(A=>({...A,expandFamily:S.target.value})),placeholder:"Fabaceae",className:"w-full px-2 py-1.5 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-400 focus:outline-none"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:l.expandGenus}),f.jsx("input",{type:"text",value:H.expandGenus,onChange:S=>de(A=>({...A,expandGenus:S.target.value})),placeholder:"Inga",className:"w-full px-2 py-1.5 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-400 focus:outline-none"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:l.expandBiome}),f.jsxs("select",{value:H.expandBiome,onChange:S=>de(A=>({...A,expandBiome:S.target.value})),className:"w-full px-2 py-1.5 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-400 focus:outline-none bg-white",children:[f.jsx("option",{value:"",children:"--"}),f.jsx("option",{value:"Amaznia",children:"Amaznia"}),f.jsx("option",{value:"Mata Atlntica",children:"Mata Atlntica"}),f.jsx("option",{value:"Cerrado",children:"Cerrado"}),f.jsx("option",{value:"Caatinga",children:"Caatinga"}),f.jsx("option",{value:"Pantanal",children:"Pantanal"}),f.jsx("option",{value:"Pampa",children:"Pampa"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:l.expandStateUF}),f.jsxs("select",{value:H.expandStateUF,onChange:S=>de(A=>({...A,expandStateUF:S.target.value})),className:"w-full px-2 py-1.5 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-400 focus:outline-none bg-white",children:[f.jsx("option",{value:"",children:"--"}),f.jsx("option",{value:"AC",children:"AC"}),f.jsx("option",{value:"AL",children:"AL"}),f.jsx("option",{value:"AP",children:"AP"}),f.jsx("option",{value:"AM",children:"AM"}),f.jsx("option",{value:"BA",children:"BA"}),f.jsx("option",{value:"CE",children:"CE"}),f.jsx("option",{value:"DF",children:"DF"}),f.jsx("option",{value:"ES",children:"ES"}),f.jsx("option",{value:"GO",children:"GO"}),f.jsx("option",{value:"MA",children:"MA"}),f.jsx("option",{value:"MT",children:"MT"}),f.jsx("option",{value:"MS",children:"MS"}),f.jsx("option",{value:"MG",children:"MG"}),f.jsx("option",{value:"PA",children:"PA"}),f.jsx("option",{value:"PB",children:"PB"}),f.jsx("option",{value:"PR",children:"PR"}),f.jsx("option",{value:"PE",children:"PE"}),f.jsx("option",{value:"PI",children:"PI"}),f.jsx("option",{value:"RJ",children:"RJ"}),f.jsx("option",{value:"RN",children:"RN"}),f.jsx("option",{value:"RS",children:"RS"}),f.jsx("option",{value:"RO",children:"RO"}),f.jsx("option",{value:"RR",children:"RR"}),f.jsx("option",{value:"SC",children:"SC"}),f.jsx("option",{value:"SP",children:"SP"}),f.jsx("option",{value:"SE",children:"SE"}),f.jsx("option",{value:"TO",children:"TO"})]})]})]}),f.jsxs("div",{className:"mt-3",children:[f.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:l.expandScope}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>de(S=>({...S,expandScope:"global"})),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-lg transition-all ${H.expandScope==="global"?"bg-amber-500 text-white shadow-sm":"bg-white text-amber-700 border border-amber-200 hover:bg-amber-50"}`,children:l.scopeGlobal}),f.jsx("button",{onClick:()=>de(S=>({...S,expandScope:"national"})),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-lg transition-all ${H.expandScope==="national"?"bg-amber-500 text-white shadow-sm":"bg-white text-amber-700 border border-amber-200 hover:bg-amber-50"}`,children:l.scopeNational}),f.jsx("button",{onClick:()=>de(S=>({...S,expandScope:"regional"})),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-lg transition-all ${H.expandScope==="regional"?"bg-amber-500 text-white shadow-sm":"bg-white text-amber-700 border border-amber-200 hover:bg-amber-50"}`,children:l.scopeRegional})]})]})]}),f.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("label",{className:"block text-xs font-semibold text-amber-700 uppercase flex items-center gap-1",children:[f.jsx(Ip,{size:12})," ",l.expandRequiredSpecies]}),H.expandRequiredSpecies.trim()&&f.jsxs("span",{className:"text-xs font-bold text-amber-600 bg-amber-100 px-2 py-0.5 rounded",children:[H.expandRequiredSpecies.split(`
`).filter(S=>S.trim()).length," ",l.speciesCount]})]}),f.jsx("p",{className:"text-xs text-amber-600/80 mb-2",children:l.expandRequiredSpeciesDesc}),f.jsx("textarea",{value:H.expandRequiredSpecies,onChange:S=>de(A=>({...A,expandRequiredSpecies:S.target.value})),placeholder:l.expandRequiredSpeciesPlaceholder,className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-500 outline-none text-sm bg-white resize-none h-20 font-mono",disabled:T}),H.expandRequiredSpecies.trim()&&f.jsxs("button",{onClick:()=>de(S=>({...S,expandRequiredSpecies:""})),className:"mt-2 text-xs text-red-500 hover:text-red-700 font-medium flex items-center gap-1",disabled:T,children:[f.jsx(os,{size:12})," ",l.clearList]})]})]}),U==="REFINE"&&f.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-3",children:[f.jsxs("div",{className:"pb-3 border-b border-slate-200",children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-2",children:l.featureTypeLabel}),f.jsx("p",{className:"text-xs text-slate-400 mb-2",children:l.featureTypeDesc}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs("button",{onClick:()=>de(S=>({...S,featureType:"vegetative"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${H.featureType==="vegetative"?"bg-emerald-500 text-white border-emerald-500":"bg-white text-slate-600 border-slate-200 hover:border-emerald-300"}`,children:[" ",l.featureTypeVegetative]}),f.jsxs("button",{onClick:()=>de(S=>({...S,featureType:"reproductive"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${H.featureType==="reproductive"?"bg-pink-500 text-white border-pink-500":"bg-white text-slate-600 border-slate-200 hover:border-pink-300"}`,children:[" ",l.featureTypeReproductive]}),f.jsxs("button",{onClick:()=>de(S=>({...S,featureType:"both"})),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition-all ${H.featureType==="both"?"bg-amber-500 text-white border-amber-500":"bg-white text-slate-600 border-slate-200 hover:border-amber-300"}`,children:[" ",l.featureTypeBoth]})]})]}),f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:H.improveDescriptions,onChange:S=>de(A=>({...A,improveDescriptions:S.target.checked})),className:"w-4 h-4 accent-amber-500"}),f.jsx("span",{className:"text-sm text-slate-700",children:l.improveDescriptions})]}),f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:H.fillGaps,onChange:S=>de(A=>({...A,fillGaps:S.target.checked})),className:"w-4 h-4 accent-amber-500"}),f.jsx("span",{className:"text-sm text-slate-700",children:l.fillGaps})]}),f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:H.addFeatures,onChange:S=>de(A=>({...A,addFeatures:S.target.checked})),className:"w-4 h-4 accent-amber-500"}),f.jsx("span",{className:"text-sm text-slate-700",children:l.addFeatures})]}),H.addFeatures&&f.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[f.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase mb-2",children:l.refineRequiredFeaturesTitle}),f.jsx("p",{className:"text-xs text-slate-400 mb-3",children:l.refineRequiredFeaturesDesc}),H.refineRequiredFeatures.length>0&&f.jsx("div",{className:"flex flex-wrap gap-1.5 mb-3",children:H.refineRequiredFeatures.map((S,A)=>f.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-amber-100 text-amber-800 text-xs rounded-full",children:[S,f.jsx("button",{onClick:()=>de(j=>({...j,refineRequiredFeatures:j.refineRequiredFeatures.filter((W,ee)=>ee!==A)})),className:"hover:text-amber-600",children:f.jsx(Bt,{size:12})})]},A))}),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{onClick:()=>En(!Jt),className:"w-full px-3 py-2 text-sm text-left border border-slate-200 rounded-lg bg-white hover:border-amber-400 focus:ring-2 focus:ring-amber-400 focus:outline-none flex justify-between items-center",children:[f.jsx("span",{className:"text-slate-500",children:l.addRequiredFeature}),f.jsx(wp,{size:16,className:`text-slate-400 transition-transform ${Jt?"rotate-180":""}`})]}),Jt&&f.jsxs("div",{className:"absolute z-20 mt-1 w-full bg-white border border-slate-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[Hi.map((S,A)=>f.jsxs("div",{children:[f.jsx("div",{className:"px-3 py-1.5 bg-slate-50 text-xs font-semibold text-slate-500 uppercase sticky top-0",children:S.category}),S.items.map((j,W)=>f.jsx("button",{onClick:()=>{H.refineRequiredFeatures.includes(j)||de(ee=>({...ee,refineRequiredFeatures:[...ee.refineRequiredFeatures,j]})),En(!1)},disabled:H.refineRequiredFeatures.includes(j),className:`w-full px-3 py-2 text-sm text-left hover:bg-amber-50 ${H.refineRequiredFeatures.includes(j)?"text-slate-300":"text-slate-700"}`,children:j},W))]},A)),f.jsx("div",{className:"p-2 border-t border-slate-100",children:f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",value:ct,onChange:S=>Fn(S.target.value),placeholder:l.customFeature,className:"flex-1 px-2 py-1.5 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-amber-400 focus:outline-none",onKeyDown:S=>{S.key==="Enter"&&ct.trim()&&(de(A=>({...A,refineRequiredFeatures:[...A.refineRequiredFeatures,ct.trim()]})),Fn(""),En(!1))}}),f.jsx("button",{onClick:()=>{ct.trim()&&(de(S=>({...S,refineRequiredFeatures:[...S.refineRequiredFeatures,ct.trim()]})),Fn(""),En(!1))},className:"px-3 py-1.5 bg-amber-500 text-white text-sm rounded-lg hover:bg-amber-600",children:"+"})]})})]})]}),f.jsxs("div",{className:"mt-3",children:[f.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:r==="pt"?"Ou digite caractersticas manualmente (Enter para adicionar)":"Or type features manually (Enter to add)"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",value:ct,onChange:S=>Fn(S.target.value),placeholder:r==="pt"?"ex: Tipo de tricoma, Forma do ovrio...":"e.g. Trichome type, Ovary shape...",className:"flex-1 px-3 py-2 text-sm border border-slate-200 rounded-lg bg-white focus:ring-2 focus:ring-amber-400 focus:outline-none",onKeyDown:S=>{if(S.key==="Enter"&&ct.trim()){const A=ct.split(",").map(j=>j.trim()).filter(j=>j.length>0);de(j=>({...j,refineRequiredFeatures:[...j.refineRequiredFeatures,...A.filter(W=>!j.refineRequiredFeatures.includes(W))]})),Fn("")}}}),f.jsx("button",{onClick:()=>{if(ct.trim()){const S=ct.split(",").map(A=>A.trim()).filter(A=>A.length>0);de(A=>({...A,refineRequiredFeatures:[...A.refineRequiredFeatures,...S.filter(j=>!A.refineRequiredFeatures.includes(j))]})),Fn("")}},className:"px-3 py-2 bg-amber-500 text-white text-sm rounded-lg hover:bg-amber-600 font-bold",children:"+"})]}),f.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:r==="pt"?"Dica: separe mltiplas caractersticas com vrgula":"Tip: separate multiple features with comma"})]})]})]}),U==="CLEAN"&&f.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-3",children:[f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:H.removeRedundant,onChange:S=>de(A=>({...A,removeRedundant:S.target.checked})),className:"w-4 h-4 accent-amber-500"}),f.jsx("span",{className:"text-sm text-slate-700",children:l.removeRedundant})]}),f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:H.fixInconsistencies,onChange:S=>de(A=>({...A,fixInconsistencies:S.target.checked})),className:"w-4 h-4 accent-amber-500"}),f.jsx("span",{className:"text-sm text-slate-700",children:l.fixInconsistencies})]})]}),U==="PHOTOS"&&f.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-xl border border-blue-200 space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"text-sm font-medium text-blue-800",children:l.photosActionDesc}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>de(S=>({...S,photoTarget:"entities"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${H.photoTarget==="entities"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:l.photoTargetEntities}),f.jsx("button",{onClick:()=>de(S=>({...S,photoTarget:"features"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${H.photoTarget==="features"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:l.photoTargetFeatures}),f.jsx("button",{onClick:()=>de(S=>({...S,photoTarget:"both"})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-lg transition-all ${H.photoTarget==="both"?"bg-blue-500 text-white shadow-sm":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:l.photoTargetBoth})]})]}),f.jsx("div",{className:"space-y-2",children:f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:()=>de(S=>({...S,photoMode:"expand"})),className:`flex-1 py-2 px-3 rounded-lg transition-all ${H.photoMode==="expand"?"bg-emerald-500 text-white shadow-sm":"bg-white text-emerald-700 border border-emerald-200 hover:bg-emerald-50"}`,children:[f.jsx("div",{className:"text-xs font-medium",children:l.photoModeExpand}),f.jsx("div",{className:"text-[10px] opacity-80",children:l.photoModeExpandDesc})]}),f.jsxs("button",{onClick:()=>de(S=>({...S,photoMode:"replace"})),className:`flex-1 py-2 px-3 rounded-lg transition-all ${H.photoMode==="replace"?"bg-orange-500 text-white shadow-sm":"bg-white text-orange-700 border border-orange-200 hover:bg-orange-50"}`,children:[f.jsx("div",{className:"text-xs font-medium",children:l.photoModeReplace}),f.jsx("div",{className:"text-[10px] opacity-80",children:l.photoModeReplaceDesc})]})]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-xs font-medium text-blue-700",children:l.photoCustomSources}),f.jsx("textarea",{value:H.photoCustomSources||"",onChange:S=>de(A=>({...A,photoCustomSources:S.target.value})),placeholder:l.photoCustomSourcesPlaceholder,className:"w-full h-20 text-xs p-2 border border-blue-200 rounded-lg bg-white/50 focus:ring-2 focus:ring-blue-400 focus:outline-none resize-none"})]})]}),U==="VALIDATE"&&f.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 p-4 rounded-xl border border-emerald-200 space-y-4",children:[f.jsx("p",{className:"text-sm font-medium text-emerald-800",children:l.validateOptions}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-xs font-bold text-emerald-700 uppercase",children:l.validateReference}),f.jsx("div",{className:"grid grid-cols-2 gap-2",children:["floradobrasil","gbif","powo","custom"].map(S=>f.jsx("button",{onClick:()=>de(A=>({...A,validateReference:S})),className:`py-2 px-3 text-xs font-medium rounded-lg transition-all ${H.validateReference===S?"bg-emerald-600 text-white shadow-sm":"bg-white text-emerald-700 border border-emerald-200 hover:bg-emerald-50"}`,children:S==="floradobrasil"?l.validateFloradobrasil:S==="gbif"?l.validateGbif:S==="powo"?l.validatePowo:l.validateCustom},S))})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"flex items-start gap-2 cursor-pointer p-2 rounded-lg hover:bg-white/50 transition-colors",children:[f.jsx("input",{type:"checkbox",checked:H.validateFixNames,onChange:S=>de(A=>({...A,validateFixNames:S.target.checked})),className:"w-4 h-4 accent-emerald-500 mt-0.5"}),f.jsxs("div",{children:[f.jsx("span",{className:"text-sm font-medium text-slate-800",children:l.validateFixNames}),f.jsx("p",{className:"text-xs text-slate-500",children:l.validateFixNamesDesc})]})]}),f.jsxs("label",{className:"flex items-start gap-2 cursor-pointer p-2 rounded-lg hover:bg-white/50 transition-colors",children:[f.jsx("input",{type:"checkbox",checked:H.validateMergeSynonyms,onChange:S=>de(A=>({...A,validateMergeSynonyms:S.target.checked})),className:"w-4 h-4 accent-emerald-500 mt-0.5"}),f.jsxs("div",{children:[f.jsx("span",{className:"text-sm font-medium text-slate-800",children:l.validateMergeSynonyms}),f.jsx("p",{className:"text-xs text-slate-500",children:l.validateMergeSynonymsDesc})]})]}),f.jsxs("label",{className:"flex items-start gap-2 cursor-pointer p-2 rounded-lg hover:bg-white/50 transition-colors",children:[f.jsx("input",{type:"checkbox",checked:H.validateCheckGeography,onChange:S=>de(A=>({...A,validateCheckGeography:S.target.checked})),className:"w-4 h-4 accent-emerald-500 mt-0.5"}),f.jsxs("div",{children:[f.jsx("span",{className:"text-sm font-medium text-slate-800",children:l.validateCheckGeography}),f.jsx("p",{className:"text-xs text-slate-500",children:l.validateCheckGeographyDesc})]})]}),f.jsxs("label",{className:"flex items-start gap-2 cursor-pointer p-2 rounded-lg hover:bg-white/50 transition-colors",children:[f.jsx("input",{type:"checkbox",checked:H.validateCheckTaxonomy,onChange:S=>de(A=>({...A,validateCheckTaxonomy:S.target.checked})),className:"w-4 h-4 accent-emerald-500 mt-0.5"}),f.jsxs("div",{children:[f.jsx("span",{className:"text-sm font-medium text-slate-800",children:l.validateCheckTaxonomy}),f.jsx("p",{className:"text-xs text-slate-500",children:l.validateCheckTaxonomyDesc})]})]})]}),H.validateCheckTaxonomy&&f.jsxs("div",{className:"bg-white/50 p-3 rounded-lg border border-emerald-200 space-y-3",children:[f.jsxs("label",{className:"text-xs font-bold text-emerald-700 uppercase flex items-center gap-1",children:[f.jsx(Vl,{size:12})," ",l.taxonomyFilters]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx("input",{value:H.validateFamily,onChange:S=>de(A=>({...A,validateFamily:S.target.value})),placeholder:l.taxonomyFamily,className:"px-3 py-2 border border-emerald-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 outline-none"}),f.jsx("input",{value:H.validateGenus,onChange:S=>de(A=>({...A,validateGenus:S.target.value})),placeholder:l.taxonomyGenus,className:"px-3 py-2 border border-emerald-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 outline-none"})]})]}),H.validateCheckGeography&&f.jsxs("div",{className:"bg-white/50 p-3 rounded-lg border border-emerald-200 space-y-3",children:[f.jsxs("label",{className:"text-xs font-bold text-emerald-700 uppercase flex items-center gap-1",children:[f.jsx(Np,{size:12})," ",l.geographyFilters]}),f.jsx("div",{className:"flex gap-2",children:["global","national","regional"].map(S=>f.jsx("button",{onClick:()=>de(A=>({...A,validateScope:S})),className:`flex-1 py-1.5 px-2 text-xs font-medium rounded-lg transition-colors ${H.validateScope===S?"bg-emerald-600 text-white":"bg-white text-slate-600 hover:bg-emerald-100 border border-slate-200"}`,children:S==="global"?l.scopeGlobal:S==="national"?l.scopeNational:l.scopeRegional},S))}),H.validateScope!=="global"&&f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("select",{value:H.validateBiome,onChange:S=>de(A=>({...A,validateBiome:S.target.value})),className:"px-3 py-2 border border-emerald-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 outline-none bg-white",children:[f.jsx("option",{value:"",children:l.biome}),f.jsx("option",{value:"Amaznia",children:"Amaznia"}),f.jsx("option",{value:"Mata Atlntica",children:"Mata Atlntica"}),f.jsx("option",{value:"Cerrado",children:"Cerrado"}),f.jsx("option",{value:"Caatinga",children:"Caatinga"}),f.jsx("option",{value:"Pampa",children:"Pampa"}),f.jsx("option",{value:"Pantanal",children:"Pantanal"})]}),f.jsxs("select",{value:H.validateStateUF,onChange:S=>de(A=>({...A,validateStateUF:S.target.value})),className:"px-3 py-2 border border-emerald-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 outline-none bg-white",children:[f.jsx("option",{value:"",children:l.stateUF}),f.jsx("option",{value:"AC",children:"Acre (AC)"}),f.jsx("option",{value:"AL",children:"Alagoas (AL)"}),f.jsx("option",{value:"AP",children:"Amap (AP)"}),f.jsx("option",{value:"AM",children:"Amazonas (AM)"}),f.jsx("option",{value:"BA",children:"Bahia (BA)"}),f.jsx("option",{value:"CE",children:"Cear (CE)"}),f.jsx("option",{value:"DF",children:"Distrito Federal (DF)"}),f.jsx("option",{value:"ES",children:"Esprito Santo (ES)"}),f.jsx("option",{value:"GO",children:"Gois (GO)"}),f.jsx("option",{value:"MA",children:"Maranho (MA)"}),f.jsx("option",{value:"MT",children:"Mato Grosso (MT)"}),f.jsx("option",{value:"MS",children:"Mato Grosso do Sul (MS)"}),f.jsx("option",{value:"MG",children:"Minas Gerais (MG)"}),f.jsx("option",{value:"PA",children:"Par (PA)"}),f.jsx("option",{value:"PB",children:"Paraba (PB)"}),f.jsx("option",{value:"PR",children:"Paran (PR)"}),f.jsx("option",{value:"PE",children:"Pernambuco (PE)"}),f.jsx("option",{value:"PI",children:"Piau (PI)"}),f.jsx("option",{value:"RJ",children:"Rio de Janeiro (RJ)"}),f.jsx("option",{value:"RN",children:"Rio Grande do Norte (RN)"}),f.jsx("option",{value:"RS",children:"Rio Grande do Sul (RS)"}),f.jsx("option",{value:"RO",children:"Rondnia (RO)"}),f.jsx("option",{value:"RR",children:"Roraima (RR)"}),f.jsx("option",{value:"SC",children:"Santa Catarina (SC)"}),f.jsx("option",{value:"SP",children:"So Paulo (SP)"}),f.jsx("option",{value:"SE",children:"Sergipe (SE)"}),f.jsx("option",{value:"TO",children:"Tocantins (TO)"})]})]})]})]})]}):null,M==="MERGE"&&f.jsxs("div",{className:"flex flex-col gap-4",children:[f.jsxs("div",{className:"text-center space-y-2 mb-2",children:[f.jsx("h4",{className:"font-bold text-slate-800 text-lg",children:l.mergeTitle}),f.jsx("p",{className:"text-slate-500 text-sm",children:l.mergeDesc})]}),f.jsx("div",{className:`border-2 border-dashed rounded-xl p-4 flex flex-col items-center justify-center transition-all ${Ee?"border-amber-500 bg-amber-50/30":"border-slate-300 hover:border-amber-400 bg-slate-50"}`,children:Ee?f.jsxs("div",{className:"flex flex-col items-center gap-2 w-full",children:[f.jsx(dc,{size:32,className:"text-amber-600"}),f.jsx("span",{className:"font-bold text-slate-800 text-sm text-center",children:Ee.name||"Key 1"}),f.jsxs("span",{className:"text-xs text-slate-500",children:[((u0=Ee.entities)==null?void 0:u0.length)||0," ",l.entities,"  ",((c0=Ee.features)==null?void 0:c0.length)||0," ",l.features]}),f.jsx("button",{onClick:()=>Se(null),className:"text-xs text-red-500 hover:text-red-700 underline",children:l.remove})]}):f.jsxs("button",{onClick:()=>nt(1),className:"flex flex-col items-center gap-2 p-2 w-full",children:[f.jsx(Ei,{size:32,className:"text-slate-400"}),f.jsx("span",{className:"text-sm font-medium text-slate-600",children:l.uploadKey1})]})}),f.jsx("div",{className:`border-2 border-dashed rounded-xl p-4 flex flex-col items-center justify-center transition-all ${Le?"border-amber-500 bg-amber-50/30":"border-slate-300 hover:border-amber-400 bg-slate-50"}`,children:Le?f.jsxs("div",{className:"flex flex-col items-center gap-2 w-full",children:[f.jsx(dc,{size:32,className:"text-amber-600"}),f.jsx("span",{className:"font-bold text-slate-800 text-sm text-center",children:Le.name||"Key 2"}),f.jsxs("span",{className:"text-xs text-slate-500",children:[((d0=Le.entities)==null?void 0:d0.length)||0," ",l.entities,"  ",((f0=Le.features)==null?void 0:f0.length)||0," ",l.features]}),f.jsx("button",{onClick:()=>Ve(null),className:"text-xs text-red-500 hover:text-red-700 underline",children:l.remove})]}):f.jsxs("button",{onClick:()=>nt(2),className:"flex flex-col items-center gap-2 p-2 w-full",children:[f.jsx(Ei,{size:32,className:"text-slate-400"}),f.jsx("span",{className:"text-sm font-medium text-slate-600",children:l.uploadKey2})]})}),f.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 space-y-3",children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-2",children:l.mergeStrategy}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("button",{onClick:()=>je("union"),className:`w-full p-3 rounded-lg border-2 text-left transition-all ${yt==="union"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:[f.jsx("p",{className:"font-bold text-slate-800 text-sm",children:l.strategyUnion}),f.jsx("p",{className:"text-xs text-slate-500",children:l.strategyUnionDesc})]}),f.jsxs("button",{onClick:()=>je("intersection"),className:`w-full p-3 rounded-lg border-2 text-left transition-all ${yt==="intersection"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:[f.jsx("p",{className:"font-bold text-slate-800 text-sm",children:l.strategyIntersection}),f.jsx("p",{className:"text-xs text-slate-500",children:l.strategyIntersectionDesc})]}),f.jsxs("button",{onClick:()=>je("primary"),className:`w-full p-3 rounded-lg border-2 text-left transition-all ${yt==="primary"?"border-amber-500 bg-amber-50":"border-slate-200 hover:border-amber-300"}`,children:[f.jsx("p",{className:"font-bold text-slate-800 text-sm",children:l.strategyPrimary}),f.jsx("p",{className:"text-xs text-slate-500",children:l.strategyPrimaryDesc})]})]})]})]}),(M==="TOPIC"||M==="IMPORT")&&f.jsxs("div",{className:"pt-4 border-t border-slate-100 space-y-5",children:[f.jsxs("h5",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[f.jsx(bp,{size:12})," ",l.configSettings]}),f.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase flex items-center gap-1",children:[f.jsx(yT,{size:14})," ",l.detailLevel]}),f.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-100 px-2 py-1 rounded",children:Cy(E.detailLevel)})]}),f.jsx("input",{type:"range",min:"1",max:"3",step:"1",value:E.detailLevel,onChange:S=>y(A=>({...A,detailLevel:parseInt(S.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500 mb-2",disabled:T}),f.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 font-medium uppercase tracking-wide",children:[f.jsxs("span",{className:`flex flex-col items-center gap-1 ${E.detailLevel===1?"text-amber-600":""}`,children:[f.jsx(nT,{size:16})," Simple"]}),f.jsxs("span",{className:`flex flex-col items-center gap-1 ${E.detailLevel===2?"text-amber-600":""}`,children:[f.jsx(ks,{size:16})," Bal."]}),f.jsxs("span",{className:`flex flex-col items-center gap-1 ${E.detailLevel===3?"text-amber-600":""}`,children:[f.jsx(hT,{size:16})," Expert"]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-2",children:l.featureFocus}),f.jsx("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:["general","reproductive","vegetative"].map(S=>f.jsx("button",{onClick:()=>y(A=>({...A,featureFocus:S})),className:`flex-1 py-2 rounded-md text-[10px] md:text-xs font-medium transition-all ${E.featureFocus===S?"bg-white text-amber-600 shadow-sm":"text-slate-500 hover:text-slate-800"}`,disabled:T,children:S==="general"?l.focusGeneral:S==="reproductive"?l.focusRepro:l.focusVeg},S))})]}),M==="TOPIC"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:l.numEntities}),f.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:E.count})]}),f.jsx("input",{type:"range",min:"3",max:"30",step:"1",value:E.count,onChange:S=>y(A=>({...A,count:parseInt(S.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500",disabled:T})]}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:l.numFeatures}),f.jsx("span",{className:"text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded",children:E.featureCount})]}),f.jsx("input",{type:"range",min:"2",max:"10",step:"1",value:E.featureCount,onChange:S=>y(A=>({...A,featureCount:parseInt(S.target.value)})),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-500",disabled:T})]}),f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[f.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase",children:l.requiredFeatures}),Te.length>0&&f.jsxs("span",{className:"text-xs font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded",children:[Te.length," ",l.selectedFeatures]})]}),f.jsxs("button",{type:"button",onClick:()=>En(!Jt),className:"w-full px-3 py-2 text-left text-sm bg-white border border-slate-200 rounded-lg hover:border-amber-400 focus:outline-none focus:ring-2 focus:ring-amber-500/20 transition-colors flex items-center justify-between",disabled:T,children:[f.jsx("span",{className:Te.length>0?"text-slate-700":"text-slate-400",children:Te.length>0?Te.slice(0,2).join(", ")+(Te.length>2?` +${Te.length-2}`:""):l.requiredFeaturesDesc}),f.jsx(wp,{size:16,className:`text-slate-400 transition-transform ${Jt?"rotate-180":""}`})]}),Jt&&f.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-slate-200 rounded-lg shadow-xl max-h-64 overflow-y-auto custom-scrollbar",children:[f.jsx("div",{className:"sticky top-0 bg-white border-b p-2",children:f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",value:ct,onChange:S=>Fn(S.target.value),placeholder:l.addCustomFeature,className:"flex-1 px-2 py-1.5 text-sm border border-slate-200 rounded focus:outline-none focus:border-amber-400",onKeyDown:S=>{S.key==="Enter"&&ct.trim()&&(Te.includes(ct.trim())||It(A=>[...A,ct.trim()]),Fn(""))}}),f.jsx("button",{type:"button",onClick:()=>{ct.trim()&&!Te.includes(ct.trim())&&(It(S=>[...S,ct.trim()]),Fn(""))},className:"px-2 py-1 bg-amber-500 text-white rounded text-xs font-medium hover:bg-amber-600",children:f.jsx(ga,{size:14})})]})}),Te.length>0&&f.jsxs("div",{className:"p-2 border-b bg-emerald-50/50",children:[f.jsx("div",{className:"text-xs font-semibold text-emerald-700 mb-1.5 uppercase",children:r==="pt"?"Selecionadas":"Selected"}),f.jsx("div",{className:"flex flex-wrap gap-1",children:Te.map((S,A)=>f.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-emerald-100 text-emerald-700 text-xs rounded-full",children:[S,f.jsx("button",{type:"button",onClick:()=>It(j=>j.filter(W=>W!==S)),className:"hover:text-red-500",children:f.jsx(Bt,{size:12})})]},A))})]}),Hi.map((S,A)=>f.jsxs("div",{children:[f.jsx("div",{className:"px-3 py-1.5 bg-slate-50 text-xs font-semibold text-slate-500 uppercase sticky top-[52px]",children:S.category}),S.items.map((j,W)=>{const ee=Te.includes(j);return f.jsxs("button",{type:"button",onClick:()=>{It(ee?oe=>oe.filter(Z=>Z!==j):oe=>[...oe,j])},className:`w-full px-3 py-2 text-left text-sm hover:bg-amber-50 flex items-center justify-between transition-colors ${ee?"bg-emerald-50 text-emerald-700":"text-slate-600"}`,children:[f.jsx("span",{children:j}),ee&&f.jsx(a1,{size:14,className:"text-emerald-500"})]},W)})]},A))]})]})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Ts,{size:16,className:"text-slate-400 group-hover:text-amber-500 transition-colors"}),f.jsx("span",{className:"text-sm font-medium text-slate-700",children:l.fetchSpeciesImg})]}),f.jsx("div",{className:`w-11 h-6 flex items-center rounded-full p-1 transition-colors ${E.includeSpeciesImages?"bg-amber-500":"bg-slate-300"}`,children:f.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${E.includeSpeciesImages?"translate-x-5":""}`})}),f.jsx("input",{type:"checkbox",className:"hidden",checked:E.includeSpeciesImages,onChange:S=>y(A=>({...A,includeSpeciesImages:S.target.checked})),disabled:T})]}),f.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(bp,{size:16,className:"text-slate-400 group-hover:text-amber-500 transition-colors"}),f.jsx("span",{className:"text-sm font-medium text-slate-700",children:l.fetchFeatureImg})]}),f.jsx("div",{className:`w-11 h-6 flex items-center rounded-full p-1 transition-colors ${E.includeFeatureImages?"bg-amber-500":"bg-slate-300"}`,children:f.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${E.includeFeatureImages?"translate-x-5":""}`})}),f.jsx("input",{type:"checkbox",className:"hidden",checked:E.includeFeatureImages,onChange:S=>y(A=>({...A,includeFeatureImages:S.target.checked})),disabled:T})]}),f.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(yd,{size:16,className:"text-slate-400 group-hover:text-amber-500 transition-colors"}),f.jsx("span",{className:"text-sm font-medium text-slate-700",children:l.fetchLinks})]}),f.jsx("div",{className:`w-11 h-6 flex items-center rounded-full p-1 transition-colors ${E.includeLinks?"bg-amber-500":"bg-slate-300"}`,children:f.jsx("div",{className:`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${E.includeLinks?"translate-x-5":""}`})}),f.jsx("input",{type:"checkbox",className:"hidden",checked:E.includeLinks,onChange:S=>y(A=>({...A,includeLinks:S.target.checked})),disabled:T})]})]})]}),T&&f.jsxs("div",{className:"bg-amber-50 text-amber-700 p-3 rounded-lg text-sm flex items-center justify-center gap-2",children:[f.jsx(Rp,{className:"animate-spin",size:16})," ",L||(M==="IMPORT"?l.analyzing:l.generating)]})]}),f.jsxs("div",{className:"p-4 bg-slate-50 border-t flex gap-3 shrink-0 safe-area-bottom",children:[f.jsx("button",{onClick:Ne,className:"flex-none w-16 md:w-20 py-2.5 text-slate-600 font-medium hover:bg-slate-200 rounded-xl transition-colors text-center text-xs md:text-sm",children:l.cancel}),f.jsxs("button",{onClick:gi,className:"w-auto px-3 py-2 text-xs bg-white border border-slate-300 text-slate-700 font-bold rounded-xl hover:bg-slate-50 hover:border-amber-400 hover:text-amber-600 shadow-sm transition-all flex items-center justify-center gap-2",disabled:T||M==="TOPIC"&&!E.topic||M==="IMPORT"&&!z||M==="REFINE"&&h.entities.length===0||M==="MERGE"&&(!Ee||!Le),title:"View and edit the prompt before sending",children:[f.jsx(qo,{size:14})," ",f.jsx("span",{className:"hidden sm:inline",children:"View/Edit Prompt"})]}),M==="REFINE"?f.jsxs("button",{onClick:Rt,className:`flex-1 py-2.5 ${U==="VALIDATE"?"bg-emerald-500 hover:bg-emerald-600 shadow-emerald-900/20":"bg-amber-500 hover:bg-amber-600 shadow-amber-900/20"} text-white font-bold rounded-xl shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 text-sm`,disabled:T||h.entities.length===0,children:[U==="EXPAND"?l.actionExpand:U==="REFINE"?l.actionRefine:U==="CLEAN"?l.actionClean:U==="VALIDATE"?l.actionValidate:l.actionPhotos," ",U==="VALIDATE"?f.jsx(Pp,{size:16,className:"opacity-70"}):f.jsx(Mp,{size:16,className:"opacity-70"})]}):M==="MERGE"?f.jsxs("button",{onClick:st,className:"flex-1 py-2.5 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 text-sm",disabled:T||!Ee||!Le,children:[l.mergeAction," ",f.jsx(_p,{size:16,className:"opacity-70"})]}):f.jsxs("button",{onClick:he,className:"flex-1 py-2.5 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 text-sm",disabled:T||M==="TOPIC"&&!E.topic||M==="IMPORT"&&!z,children:[l.generate," ",f.jsx(Dp,{size:16,className:"opacity-70"})]})]})]})}),ra&&f.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-[60] flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col h-[80vh] max-h-[90vh] animate-in fade-in zoom-in-95 overflow-hidden",children:[f.jsxs("div",{className:"bg-slate-800 p-4 border-b border-slate-700 flex justify-between items-center text-white shrink-0",children:[f.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[f.jsx(qo,{size:18,className:"text-amber-400"}),"Prompt Editor"]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(zi),alert(l.promptCopied)},className:"flex items-center gap-1.5 px-3 py-1.5 text-xs hover:bg-slate-700 rounded transition-colors text-slate-300 hover:text-white",disabled:T,children:[f.jsx(cT,{size:12})," ",l.copyPrompt]}),f.jsx("button",{onClick:Ur,className:"text-slate-400 hover:text-white p-1",children:f.jsx(Bt,{size:20})})]})]}),f.jsxs("div",{className:"flex-1 p-2 bg-slate-100 min-h-0 flex flex-col gap-2",children:[!T&&f.jsx("textarea",{value:zi,onChange:S=>ar(S.target.value),className:"w-full flex-1 p-4 bg-slate-900 text-slate-200 font-mono text-sm rounded-lg resize-none outline-none border-2 border-transparent focus:border-amber-500",spellCheck:"false"}),T&&f.jsx("div",{ref:Wi,className:"w-full flex-1 p-4 bg-gradient-to-br from-slate-900 to-slate-800 text-slate-200 font-mono text-sm rounded-lg overflow-auto custom-scrollbar border-2 border-amber-500/30",children:f.jsxs("div",{className:"whitespace-pre-wrap",children:[qi,!_o&&f.jsx("span",{className:"inline-block w-2 h-4 bg-amber-400 animate-pulse ml-1 align-middle"})]})})]}),f.jsxs("div",{className:"p-4 border-t bg-slate-50 shrink-0 flex items-center justify-between gap-4",children:[T&&f.jsxs("div",{className:"flex items-center gap-2 text-amber-600",children:[f.jsxs("div",{className:"flex gap-1",children:[f.jsx("span",{className:"w-2 h-2 bg-amber-500 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),f.jsx("span",{className:"w-2 h-2 bg-amber-500 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),f.jsx("span",{className:"w-2 h-2 bg-amber-500 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),f.jsx("span",{className:"text-sm font-medium",children:r==="pt"?"IA processando...":"AI processing..."})]}),f.jsxs("div",{className:"flex items-center gap-4 ml-auto",children:[f.jsx("button",{onClick:Ur,className:"px-6 py-2 text-slate-600 font-medium hover:bg-slate-200 rounded-xl transition-colors",children:l.cancel}),f.jsx("button",{onClick:xi,className:"px-6 py-2 bg-amber-500 text-white font-bold rounded-xl hover:bg-amber-600 shadow-lg shadow-amber-900/20 disabled:opacity-50 flex items-center gap-2",disabled:T,children:T?f.jsxs(f.Fragment,{children:[f.jsx(Rp,{className:"animate-spin",size:16})," ",L||l.generating]}):f.jsx(f.Fragment,{children:l.generate})})]})]})]})}),Ce&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>D(null),children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full overflow-hidden animate-in fade-in zoom-in-95",onClick:S=>S.stopPropagation(),children:[f.jsxs("div",{className:"relative",children:[f.jsx("img",{src:Ce.url,alt:Ce.label,className:"w-full max-h-[60vh] object-contain bg-slate-100"}),f.jsx("button",{onClick:()=>D(null),className:"absolute top-3 right-3 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full transition-colors",children:f.jsx(Bt,{size:18})})]}),f.jsxs("div",{className:"p-4 bg-white",children:[f.jsx("h4",{className:"font-semibold text-slate-800",children:Ce.label}),f.jsx("p",{className:"text-sm text-slate-500",children:Ce.featureName})]})]})}),ke&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",children:[f.jsxs("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[f.jsx(bs,{className:"text-emerald-600",size:20}),l.open]}),f.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto mb-4 custom-scrollbar",children:q.length===0?f.jsx("p",{className:"text-slate-500 text-sm text-center py-8 border-2 border-dashed border-slate-200 rounded-lg",children:l.noSaved}):q.map(S=>f.jsxs("button",{onClick:()=>Ou(S),className:"w-full text-left p-3 hover:bg-emerald-50 rounded-lg border border-slate-100 hover:border-emerald-200 group transition-all",children:[f.jsx("div",{className:"font-medium text-slate-800 group-hover:text-emerald-700",children:S.name}),f.jsx("div",{className:"text-xs text-slate-400 truncate",children:S.description||"No description"})]},S.id))}),f.jsx("button",{onClick:()=>se(!1),className:"w-full py-2.5 bg-slate-100 text-slate-600 rounded-xl font-medium hover:bg-slate-200 transition-colors",children:l.close})]})})]})},cM=()=>{const[e,t]=Ie.useState("HOME"),[n,r]=Ie.useState(null),[i,s]=Ie.useState("pt"),[a,o]=Ie.useState([]),[u,c]=Ie.useState(!1),[l,m]=Ie.useState(!1),[h,g]=Ie.useState(!1),[x,v]=Ie.useState(!1),[w,E]=Ie.useState("ABOUT"),[y,T]=Ie.useState("gemini-2.5-flash"),[C,L]=Ie.useState(""),[B,R]=Ie.useState(!1);Ie.useEffect(()=>{const ae=localStorage.getItem("nozesia_settings");if(ae)try{const ce=JSON.parse(ae);ce.model&&T(ce.model),ce.apiKey&&L(ce.apiKey)}catch{console.error("Failed to load settings")}},[]),Ie.useEffect(()=>{if(e==="HOME"||e==="PLAYER"){const ae=localStorage.getItem("nozesia_projects");if(ae)try{o(JSON.parse(ae))}catch{console.error("Failed to load local projects")}}},[e]);const O=()=>{const ae=y.trim(),ce=C.trim();localStorage.setItem("nozesia_settings",JSON.stringify({model:ae,apiKey:ce})),m(!1)},M={id:"demo-1",name:"Exemplo: Grandes Felinos",description:"Identifique espcies comuns de grandes felinos.",features:[{id:"f1",name:"Padro da Pelagem",states:[{id:"s1",label:"Listras"},{id:"s2",label:"Manchas"},{id:"s3",label:"Liso"}]},{id:"f2",name:"Habitat",states:[{id:"s4",label:"Selva"},{id:"s5",label:"Savana"}]}],entities:[{id:"e1",name:"Tigre",description:"O maior dos felinos.",imageUrl:"https://picsum.photos/id/237/400/300",links:[],traits:{f1:["s1"],f2:["s4"]}},{id:"e2",name:"Leo",description:"O rei da selva.",imageUrl:"https://picsum.photos/id/1003/400/300",links:[],traits:{f1:["s3"],f2:["s5"]}},{id:"e3",name:"Leopardo",description:"Escalador especialista.",imageUrl:"https://picsum.photos/id/1074/400/300",links:[],traits:{f1:["s2"],f2:["s4","s5"]}}]},k={en:{subtitle:"v2.1 Tropical",tagline:"Biological Identification AI",desc:"Create and share professional matrix identification keys. Powered by Gemini AI for instant taxonomy generation.",createNew:"Create / Edit Key",openSaved:"Open Saved",importJson:"Import Project",demo:"Try Demo",savedProj:"Saved Projects",close:"Close",noSaved:"No saved projects found.",invalid:"Invalid project file.",settings:"Settings",aiModel:"AI Model",apiKey:"Gemini API Key",getKey:"Get Key",save:"Save",apiKeyNotice:"Your API Key is stored locally in your browser and used only to communicate with Google.",help:"About & Help",helpContent:{intro:"NOZES is an intelligent platform for creating and using matrix identification keys, designed for biologists, students, and nature enthusiasts.",step1Title:"1. NUTS AI Wizard",step1Desc:"Use the 'Nuts AI' button in the builder to automatically generate a key. You can describe a topic (e.g., 'Brazilian Cerrado Trees') OR upload a PDF/Image reference. The AI will study the material and create species, features, and the scoring matrix for you.",step2Title:"2. The Builder",step2Desc:"Refine your key manually. You can add new features, upload images for species, and adjust the matrix relationships between taxa and traits. Use the 'Export Project' button to save your work as a JSON file, which is essential for backups.",step3Title:"3. The Player",step3Desc:"This is the end-user view. Select observed features to filter down the list of species until you identify your specimen.",importExportTitle:"4. Import & Export",importExportDesc:"Always save your work by clicking 'Export Project'. This downloads a .json file. To resume work later or on another device, use 'Import Project' and select that file. You can also export to Excel (XLSX) for spreadsheets.",htmlExportTitle:"5. HTML Export",htmlExportDesc:"Export your key as a standalone HTML file that works offline! Click 'HTML' in the builder to generate a complete, self-contained webpage with all images embedded. Perfect for sharing with colleagues, publishing on websites, or using in field work without internet. The exported file includes the full Player interface with all filtering functionality.",aiToolsTitle:"6. Expand, Refine & Combine",aiToolsDesc:"Use the 'Expand/Refine' tab in the AI modal to enhance your keys: EXPAND adds new species to an existing list; REFINE improves descriptions and fills gaps; PHOTOS automatically searches for images; VALIDATE checks names against taxonomic catalogs. You can also MERGE keys by importing a new JSON, combining species from multiple projects into one.",warningTitle:" Important Warning",warningDesc:"AI-generated data may contain inaccuracies, outdated names, or incorrect trait assignments. ALWAYS review and verify all information before using or distributing identification keys. Cross-check scientific names with official catalogs (Flora do Brasil, GBIF, POWO) and validate geographic distributions. The user assumes full responsibility for the accuracy of the final content."}},pt:{subtitle:"v2.1 Tropical",tagline:"Inteligncia para Identificao Biolgica",desc:"Crie e compartilhe chaves de identificao matriciais profissionais. Poder da Gemini AI para gerao instantnea de taxonomia.",createNew:"Criar / Editar Chave",openSaved:"Abrir Chave",importJson:"Importar Projeto",demo:"Ver Demo",savedProj:"Projetos Salvos",close:"Fechar",noSaved:"Nenhum projeto salvo.",invalid:"Arquivo invlido.",settings:"Configuraes",aiModel:"Modelo IA",apiKey:"Chave API Gemini",getKey:"Obter Chave",save:"Salvar",apiKeyNotice:"Sua API Key  salva localmente no navegador e usada apenas para comunicar com o Google.",help:"Sobre e Ajuda",helpContent:{intro:"O NOZES  uma plataforma inteligente para criao e uso de chaves de identificao matriciais, projetada para bilogos, estudantes e entusiastas da natureza.",step1Title:"1. Assistente Nozes IA",step1Desc:"Use o boto 'Nozes IA' no construtor para gerar uma chave automaticamente. Voc pode descrever um tpico (ex: 'rvores do Cerrado') OU fazer upload de um PDF/Imagem de referncia. A IA estudar o material e criar espcies, caractersticas e a matriz para voc.",step2Title:"2. O Construtor",step2Desc:"Refine sua chave manualmente. Adicione novas caractersticas, insira imagens e ajuste a matriz. Use o boto 'Exportar Projeto' para salvar seu trabalho em arquivo JSON (backup essencial).",step3Title:"3. O Player",step3Desc:"Esta  a viso do usurio final. Selecione as caractersticas observadas para filtrar a lista de espcies at identificar seu espcime.",importExportTitle:"4. Importar & Exportar",importExportDesc:"Sempre salve seu trabalho clicando em 'Exportar Projeto'. Isso baixa um arquivo .json. Para continuar depois ou em outro dispositivo, use 'Importar Projeto' e selecione esse arquivo. Voc tambm pode exportar para Excel (XLSX).",htmlExportTitle:"5. Exportao HTML",htmlExportDesc:"Exporte sua chave como um arquivo HTML autnomo que funciona offline! Clique em 'HTML' no construtor para gerar uma pgina web completa e independente com todas as imagens embutidas. Perfeito para compartilhar com colegas, publicar em sites ou usar em trabalho de campo sem internet. O arquivo exportado inclui a interface completa do Player com toda a funcionalidade de filtragem.",aiToolsTitle:"6. Expandir, Refinar & Combinar",aiToolsDesc:"Use a aba 'Expandir/Refinar' no modal de IA para aprimorar suas chaves: EXPANDIR adiciona novas espcies a uma lista existente; REFINAR melhora descries e preenche lacunas; FOTOS busca imagens automaticamente; VALIDAR confere nomes com catlogos taxonmicos. Voc tambm pode COMBINAR chaves importando um novo JSON, mesclando espcies de mltiplos projetos em um s.",warningTitle:" Aviso Importante",warningDesc:"Dados gerados por IA podem conter imprecises, nomes desatualizados ou atribuies incorretas de caractersticas. SEMPRE revise e verifique todas as informaes antes de usar ou distribuir chaves de identificao. Confira nomes cientficos em catlogos oficiais (Flora do Brasil, GBIF, POWO) e valide distribuies geogrficas. O usurio assume total responsabilidade pela preciso do contedo final."}}}[i],z=()=>{R(!1),t("BUILDER")},X=()=>{R(!0),r(null),t("BUILDER")},ne=()=>{r(M),t("PLAYER")},Fe=ae=>{const ce=localStorage.getItem("nozesia_projects");let Ce=[];if(ce)try{Ce=JSON.parse(ce)}catch(U){console.error("Failed to parse projects",U)}const D=[ae,...Ce.filter(U=>U.id!==ae.id)];localStorage.setItem("nozesia_projects",JSON.stringify(D)),o(D),r(ae),t("PLAYER")},q=ae=>{r(ae),t("PLAYER"),c(!1)},ue=ae=>{const ce=new FileReader;ae.target.files&&ae.target.files[0]&&(ce.readAsText(ae.target.files[0],"UTF-8"),ce.onload=Ce=>{var D;try{const U=JSON.parse((D=Ce.target)==null?void 0:D.result);U.name&&U.features&&U.entities?(r(U),t("PLAYER")):alert(k.invalid)}catch{alert(k.invalid)}})},ke=()=>l&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[f.jsx(Fp,{className:"text-emerald-600",size:20}),k.settings]}),f.jsx("button",{onClick:()=>m(!1),className:"text-slate-400 hover:text-slate-600 p-2",children:f.jsx(Bt,{size:24})})]}),f.jsxs("div",{className:"space-y-4 mb-6",children:[f.jsxs("div",{children:[f.jsx("div",{className:"flex justify-between items-center mb-2",children:f.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:k.apiKey})}),f.jsxs("div",{className:"relative",children:[f.jsx(vd,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),f.jsx("input",{type:"password",value:C,onChange:ae=>L(ae.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none",placeholder:"AIzaSy..."})]}),f.jsxs("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"mt-3 flex items-center justify-center gap-2 w-full py-2.5 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg font-bold text-sm hover:from-blue-600 hover:to-indigo-700 transition-all shadow-md hover:shadow-lg",children:[f.jsx(Gl,{size:16}),k.getKey," - Google AI Studio"]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:k.aiModel}),f.jsx("input",{value:y,onChange:ae=>T(ae.target.value),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none",placeholder:"gemini-2.5-flash"}),f.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Default: gemini-2.5-flash"})]}),f.jsx("div",{className:"bg-amber-50 p-3 rounded-lg border border-amber-100",children:f.jsx("p",{className:"text-xs text-amber-700",children:k.apiKeyNotice})})]}),f.jsxs("button",{onClick:O,className:"w-full py-3 bg-emerald-600 text-white rounded-xl font-bold hover:bg-emerald-500 transition-colors flex items-center justify-center gap-2",children:[f.jsx(jl,{size:16})," ",k.save]})]})}),se=()=>u&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[f.jsx(bs,{className:"text-emerald-600",size:20}),k.openSaved]}),f.jsx("button",{onClick:()=>c(!1),className:"text-slate-400 hover:text-slate-600 p-1",children:f.jsx(Bt,{size:20})})]}),f.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto mb-4 custom-scrollbar",children:a.length===0?f.jsx("p",{className:"text-slate-500 text-sm text-center py-8 border-2 border-dashed border-slate-200 rounded-lg",children:k.noSaved}):a.map(ae=>f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:ce=>{if(ce.stopPropagation(),confirm(i==="pt"?`Excluir "${ae.name}"?`:`Delete "${ae.name}"?`)){const Ce=a.filter(D=>D.id!==ae.id);o(Ce),localStorage.setItem("nozesia_projects",JSON.stringify(Ce))}},className:"p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors shrink-0",title:i==="pt"?"Excluir":"Delete",children:f.jsx(os,{size:16})}),f.jsxs("button",{onClick:()=>q(ae),className:"flex-1 text-left p-3 hover:bg-emerald-50 rounded-lg border border-slate-100 hover:border-emerald-200 group transition-all min-w-0",children:[f.jsx("div",{className:"font-medium text-slate-800 group-hover:text-emerald-700 truncate",children:ae.name}),f.jsx("div",{className:"text-xs text-slate-400 truncate",children:ae.description||(i==="pt"?"Sem descrio":"No description")})]})]},ae.id))}),f.jsx("button",{onClick:()=>c(!1),className:"w-full py-3 bg-slate-100 text-slate-600 rounded-xl font-medium hover:bg-slate-200 transition-colors",children:k.close})]})});return e==="PLAYER"&&n?f.jsxs(f.Fragment,{children:[f.jsx(gR,{project:n,onBack:()=>t("HOME"),language:i,onOpenSaved:()=>c(!0),onEditKey:()=>t("BUILDER")}),ke(),se()]}):e==="BUILDER"?f.jsxs(f.Fragment,{children:[f.jsx(uM,{initialProject:n,onSave:Fe,onCancel:()=>t("HOME"),language:i,defaultModel:y,apiKey:C,onOpenSettings:ae=>{g(ae||!1),m(!0)},reopenAiModal:h&&!l||B,onAiModalOpened:()=>{g(!1),R(!1)},onProjectImported:ae=>{o(ce=>[ae,...ce.filter(Ce=>Ce.id!==ae.id)])}}),ke()]}):f.jsxs("div",{className:"min-h-screen bg-[#0f2e24] flex items-center justify-center p-4 md:p-6 relative overflow-hidden font-sans",children:[f.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden pointer-events-none",children:[f.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[400px] md:w-[600px] h-[400px] md:h-[600px] bg-emerald-600/20 rounded-full blur-[80px] md:blur-[120px]"}),f.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[300px] md:w-[500px] h-[300px] md:h-[500px] bg-teal-500/20 rounded-full blur-[80px] md:blur-[100px]"}),f.jsx(Vl,{className:"absolute top-[10%] right-[15%] text-emerald-800/20 w-20 h-20 md:w-32 md:h-32 rotate-12"}),f.jsx(TT,{className:"absolute bottom-[20%] left-[10%] text-emerald-800/20 w-32 h-32 md:w-48 md:h-48 -rotate-12"})]}),f.jsxs("div",{className:"max-w-6xl w-full grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12 items-center z-10",children:[f.jsxs("div",{className:"text-white space-y-6 md:space-y-8",children:[f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsx("div",{className:"inline-flex items-center gap-2 bg-emerald-900/50 text-emerald-300 px-3 py-1 rounded-full text-[10px] md:text-xs font-semibold tracking-wider uppercase border border-emerald-500/30 backdrop-blur-sm",children:k.subtitle}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("div",{className:"flex bg-emerald-900/50 rounded-lg p-1 border border-emerald-500/30 backdrop-blur-sm",children:[f.jsx("button",{onClick:()=>s("pt"),className:`px-3 py-1 rounded text-xs font-bold transition-colors ${i==="pt"?"bg-emerald-500 text-white":"text-emerald-400 hover:text-white"}`,children:"PT"}),f.jsx("button",{onClick:()=>s("en"),className:`px-3 py-1 rounded text-xs font-bold transition-colors ${i==="en"?"bg-emerald-500 text-white":"text-emerald-400 hover:text-white"}`,children:"EN"})]}),f.jsx("button",{onClick:()=>v(!0),className:"bg-emerald-900/50 rounded-lg p-1.5 border border-emerald-500/30 backdrop-blur-sm text-emerald-400 hover:text-white hover:bg-emerald-800/50 transition-colors",title:k.help,children:f.jsx(uT,{size:20})}),f.jsx("button",{onClick:()=>m(!0),className:`bg-emerald-900/50 rounded-lg p-1.5 border backdrop-blur-sm transition-colors ${C?"border-emerald-500/30 text-emerald-400 hover:text-white hover:bg-emerald-800/50":"border-amber-500 text-amber-500 animate-pulse"}`,title:k.settings,children:f.jsx(Fp,{size:20})})]})]}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-3 md:gap-4 mb-2",children:[f.jsx("div",{className:"bg-amber-800/20 p-2 md:p-3 rounded-2xl border-2 border-amber-600/30 backdrop-blur-md shadow-[0_0_30px_rgba(217,119,6,0.2)]",children:f.jsx(ks,{className:"text-amber-500 w-12 h-12 md:w-20 md:h-20",strokeWidth:1.5})}),f.jsx("h1",{className:"text-5xl md:text-7xl font-black tracking-tight leading-none text-transparent bg-clip-text bg-gradient-to-br from-amber-300 via-amber-500 to-orange-400 drop-shadow-sm",children:"NOZES"})]}),f.jsx("h2",{className:"text-lg md:text-2xl text-emerald-100/80 font-light pl-2",children:k.tagline})]}),f.jsx("p",{className:"text-slate-300 text-base md:text-lg leading-relaxed max-w-lg border-l-4 border-amber-500/50 pl-4 md:pl-6",children:k.desc}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 md:gap-4 pt-2",children:[f.jsxs("button",{onClick:X,className:"col-span-1 sm:col-span-2 flex items-center justify-center gap-3 px-8 py-4 bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-400 hover:to-orange-400 text-white rounded-xl font-bold transition-all shadow-xl shadow-amber-900/50 hover:scale-[1.02] text-lg border-t border-amber-300/30 active:scale-95 animate-pulse hover:animate-none",children:[f.jsx(ks,{className:"w-6 h-6"}),i==="pt"?"Nozes IA":"NUTS AI"]}),f.jsxs("button",{onClick:z,className:"col-span-1 sm:col-span-2 flex items-center justify-center gap-3 px-8 py-4 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white rounded-xl font-bold transition-all shadow-xl shadow-emerald-900/50 hover:scale-[1.02] text-lg border-t border-emerald-400/20 active:scale-95",children:[f.jsx(Ap,{className:"w-5 h-5"}),k.createNew]}),f.jsxs("button",{onClick:()=>c(!0),className:"flex items-center justify-center gap-2 px-6 py-3 bg-emerald-900/40 hover:bg-emerald-800/40 text-emerald-100 rounded-xl font-medium transition-all border border-emerald-500/20 hover:border-emerald-500/50 backdrop-blur-sm active:scale-95",children:[f.jsx(bs,{className:"w-4 h-4"}),k.openSaved]}),f.jsxs("label",{className:"flex items-center justify-center gap-2 px-6 py-3 bg-emerald-900/40 hover:bg-emerald-800/40 text-emerald-100 rounded-xl font-medium transition-all border border-emerald-500/20 hover:border-emerald-500/50 backdrop-blur-sm cursor-pointer active:scale-95",children:[f.jsx(Ei,{className:"w-4 h-4"}),k.importJson,f.jsx("input",{type:"file",accept:".json",onChange:ue,className:"hidden"})]}),f.jsxs("button",{onClick:ne,className:"col-span-1 sm:col-span-2 mt-2 text-sm text-emerald-400 hover:text-emerald-200 flex items-center justify-center gap-2 font-medium py-2",children:[f.jsx(Ed,{className:"w-3 h-3"}),k.demo]})]})]}),f.jsx("div",{className:"relative hidden lg:block transform perspective-1000 hover:rotate-y-2 transition-transform duration-700",children:f.jsxs("div",{className:"relative bg-gradient-to-br from-emerald-900/80 to-teal-900/80 backdrop-blur-md border border-emerald-500/20 p-8 rounded-3xl shadow-2xl",children:[f.jsx("div",{className:"absolute -top-10 -right-10 text-emerald-400/10",children:f.jsx(pT,{size:200})}),f.jsxs("div",{className:"flex items-center gap-3 mb-8 border-b border-emerald-500/20 pb-6",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-red-400/80"}),f.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-400/80"}),f.jsx("div",{className:"w-3 h-3 rounded-full bg-green-400/80"}),f.jsx("div",{className:"ml-auto text-xs text-amber-500/80 font-mono tracking-widest font-bold",children:"NOZES.IA-v2"})]}),f.jsx("div",{className:"space-y-6 opacity-90",children:f.jsxs("div",{className:"flex gap-6",children:[f.jsxs("div",{className:"w-1/3 space-y-3",children:[f.jsx("div",{className:"h-2 bg-emerald-700/50 rounded w-1/2 mb-4"}),f.jsxs("div",{className:"h-10 bg-emerald-500/20 border-l-2 border-emerald-400 rounded-r flex items-center px-3 text-emerald-200 text-xs gap-2",children:[f.jsx(Vl,{size:12})," Folhas"]}),f.jsx("div",{className:"h-10 bg-emerald-900/30 rounded flex items-center px-3 text-emerald-600/50 text-xs",children:"Flores"}),f.jsx("div",{className:"h-10 bg-emerald-900/30 rounded flex items-center px-3 text-emerald-600/50 text-xs",children:"Caule"})]}),f.jsx("div",{className:"w-2/3 grid grid-cols-2 gap-3",children:[1,2,3,4].map(ae=>f.jsxs("div",{className:"bg-emerald-950/50 rounded-lg p-3 border border-emerald-500/10 flex flex-col gap-2",children:[f.jsx("div",{className:"aspect-video bg-emerald-900/50 rounded flex items-center justify-center",children:f.jsx(sT,{className:"text-emerald-700/50",size:20})}),f.jsx("div",{className:"h-1.5 bg-emerald-800/50 rounded w-3/4"}),f.jsx("div",{className:"h-1.5 bg-emerald-800/30 rounded w-1/2"})]},ae))})]})}),f.jsxs("div",{className:"mt-8 pt-6 border-t border-emerald-500/20 flex justify-between items-center text-emerald-400/40 text-xs",children:[f.jsx("span",{children:"Gemini 2.5 Flash Integrated"}),f.jsx("span",{children:"100% Client-Side"})]})]})})]}),ke(),x&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-0 overflow-hidden animate-in fade-in zoom-in-95 flex flex-col max-h-[85vh]",children:[f.jsxs("div",{className:"p-4 md:p-6 border-b flex justify-between items-center bg-slate-50",children:[f.jsxs("div",{className:"flex gap-4 items-center",children:[f.jsxs("h3",{className:"text-lg md:text-xl font-bold text-slate-800 flex items-center gap-2",children:[f.jsx(l1,{className:"text-emerald-600",size:24}),k.help]}),f.jsxs("div",{className:"flex bg-slate-200/50 p-1 rounded-lg",children:[f.jsx("button",{onClick:()=>E("ABOUT"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${w==="ABOUT"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Sobre"}),f.jsx("button",{onClick:()=>E("HELP"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${w==="HELP"?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Ajuda"})]})]}),f.jsx("button",{onClick:()=>v(!1),className:"text-slate-400 hover:text-slate-600 p-2",children:f.jsx(Bt,{size:24})})]}),f.jsx("div",{className:"p-4 md:p-6 overflow-y-auto custom-scrollbar space-y-6 md:space-y-8",children:w==="ABOUT"?f.jsxs(f.Fragment,{children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:" Sobre o Criador"}),f.jsxs("div",{className:"creator-info space-y-4 text-slate-700",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-xl font-semibold text-emerald-700",children:"Diogo Bueno Kanoute"}),f.jsx("p",{className:"font-medium",children:"Parabotnico e Dendrlogo em Inventrio Florestal"}),f.jsx("p",{className:"text-sm md:text-base mt-2",children:"Desenvolvedor especializado em Tecnologias de Inteligncia Artificial e Banco de Dados para Inventrio Florestal, Ecologia, Botnica, Dendrometria e Dendrologia."})]}),f.jsx("h4",{className:"text-lg font-bold text-slate-800 mt-8 border-t pt-4",children:" Links e Contatos"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"bg-slate-800 p-3 rounded-lg border border-slate-700 hover:border-emerald-400 transition-colors col-span-full",children:[f.jsx("strong",{className:"block text-sm text-emerald-400 mb-1",children:" Projeto no GitHub"}),f.jsxs("a",{href:"https://github.com/DJHanDoom/Nozes",target:"_blank",rel:"noopener noreferrer",className:"text-white hover:text-emerald-300 font-medium flex items-center gap-2",children:["github.com/DJHanDoom/Nozes",f.jsx(Gl,{size:14})]})]}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[f.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:"Identificao Botnica"}),f.jsx("a",{href:"https://go.hotmart.com/G103222293V",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"Curso Online na Hotmart"})]}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[f.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" Fototeca DBK no SPLink"}),f.jsx("a",{href:"https://specieslink.net/col/FDBK",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"specieslink.net/col/FDBK"})]}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[f.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" Instagram Cientfico"}),f.jsx("a",{href:"https://instagram.com/fotografandomato",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"@fotografandomato"})]}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[f.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" Biblioteca Botnica"}),f.jsx("a",{href:"https://drive.google.com/drive/folders/0B4wGMi_KVTvOWm51UzNnNVJjaEk?resourcekey=0-8e69zvcLn2zMXuphNmC56A&usp=drive_link",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"PDFs e Material de Referncia"})]}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[f.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" E-mail"}),f.jsx("a",{href:"mailto:diogokanoute@gmail.com",className:"text-emerald-600 hover:underline font-medium",children:"diogokanoute@gmail.com"})]}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 hover:border-emerald-200 transition-colors",children:[f.jsx("strong",{className:"block text-sm text-emerald-600 mb-1",children:" WhatsApp Cientfico"}),f.jsx("a",{href:"https://wa.me/5521998501623",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 hover:underline font-medium",children:"+55 21 998501623"})]})]}),f.jsx("p",{className:"text-sm text-slate-500 italic mt-6 bg-amber-50 p-4 rounded-lg border border-amber-100",children:"Entre em contato para dvidas sobre o app, cursos de Identificao Botnica, tecnologias de IA aplicadas  Dendrologia ou servios de Inventrio Florestal (Mata Atlntica, Cerrado, Amaznia e Caatinga)."})]})]}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"bg-emerald-50 p-4 rounded-xl border border-emerald-100 text-slate-700 leading-relaxed text-sm md:text-base",children:k.helpContent.intro}),f.jsxs("div",{className:"grid gap-6",children:[f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"bg-amber-100 p-3 rounded-full h-fit text-amber-600 shrink-0",children:f.jsx(ks,{size:24})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:k.helpContent.step1Title}),f.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:k.helpContent.step1Desc})]})]}),f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"bg-blue-100 p-3 rounded-full h-fit text-blue-600 shrink-0",children:f.jsx(Ap,{size:24})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:k.helpContent.step2Title}),f.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:k.helpContent.step2Desc})]})]}),f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"bg-emerald-100 p-3 rounded-full h-fit text-emerald-600 shrink-0",children:f.jsx(Ed,{size:24})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:k.helpContent.step3Title}),f.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:k.helpContent.step3Desc})]})]}),f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"bg-purple-100 p-3 rounded-full h-fit text-purple-600 shrink-0",children:f.jsx(jl,{size:24})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:k.helpContent.importExportTitle}),f.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:k.helpContent.importExportDesc})]})]}),f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"bg-rose-100 p-3 rounded-full h-fit text-rose-600 shrink-0",children:f.jsx($l,{size:24})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:k.helpContent.htmlExportTitle}),f.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:k.helpContent.htmlExportDesc})]})]}),f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"bg-indigo-100 p-3 rounded-full h-fit text-indigo-600 shrink-0",children:f.jsx(mT,{size:24})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-slate-900 text-base md:text-lg mb-1",children:k.helpContent.aiToolsTitle}),f.jsx("p",{className:"text-slate-600 text-xs md:text-sm leading-relaxed",children:k.helpContent.aiToolsDesc})]})]}),f.jsx("div",{className:"mt-6 bg-amber-50 border-2 border-amber-300 rounded-xl p-4",children:f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"bg-amber-200 p-3 rounded-full h-fit text-amber-700 shrink-0",children:f.jsx(CT,{size:24})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-amber-800 text-base md:text-lg mb-1",children:k.helpContent.warningTitle}),f.jsx("p",{className:"text-amber-700 text-xs md:text-sm leading-relaxed",children:k.helpContent.warningDesc})]})]})})]})]})}),f.jsx("div",{className:"p-4 bg-slate-50 border-t",children:f.jsx("button",{onClick:()=>v(!1),className:"w-full py-3 bg-emerald-600 text-white rounded-xl font-bold hover:bg-emerald-500 transition-colors",children:k.close})})]})}),se()]})},_y=document.getElementById("root");if(!_y)throw new Error("Could not find root element to mount to");const dM=wc.createRoot(_y);dM.render(f.jsx($r.StrictMode,{children:f.jsx(cM,{})}));
